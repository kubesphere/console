(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1078:function(e,t,r){"use strict";r(17);var a=r(19);r(3),r(8),r(4),r(193),r(16),r(29),r(10),r(71),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31),r(3),r(30),r(8),r(4),r(193),r(21),r(16),r(40),r(29),r(10),r(71);var n=a(r(50)),o=a(r(42));r(36);var u,l,c,s=a(r(43)),i=a(r(62)),f=a(r(25)),d=a(r(28)),p=a(r(75)),m=a(r(38)),h=a(r(39)),v=a(r(35)),y=a(r(45)),g=(a(r(63)),r(18)),E=a(r(26)),_=r(56),b=a(r(848)),S=a(r(332));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,h.default)(this,r)}}var O=(u=function(e){(0,m.default)(h,e);var t,r,a,u=k(h);function h(){var e;(0,f.default)(this,h);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=u.call.apply(u,[this].concat(r)),(0,i.default)(e,"statistics",l,(0,p.default)(e)),(0,i.default)(e,"resourceMetrics",c,(0,p.default)(e)),e}return(0,d.default)(h,[{key:"fetchStatistics",value:(a=(0,s.default)(o.default.mark((function e(t){var r,a,n,u,l,c,s=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},a=r.cluster,this.statistics.isLoading=!0,n={type:"statistics"},u=this.getApi({workspace:t,cluster:a}),e.next=6,(0,_.to)(request.get(u,n));case 6:return l=e.sent,c=this.getResult(l),this.statistics={data:c,isLoading:!1},e.abrupt("return",c);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getDevopsCount",value:(r=(0,s.default)(o.default.mark((function e(t){var r,a,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new S.default,e.next=3,request.get(r.getBaseUrl({workspace:t}),{paging:"limit=Infinity"});case 3:return a=e.sent,n=a&&a.items.length>0?a.items.length:0,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"fetchApplicationResourceMetrics",value:(t=(0,s.default)(o.default.mark((function e(t){var r,a,u,l,c,s,i,f,d,p;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workspace,a=t.namespace,u=t.autoRefresh,l=void 0!==u&&u,c=(0,n.default)(t,["workspace","namespace","autoRefresh"]),l?c.last=!0:this.resourceMetrics.isLoading=!0,c.cluster&&(this.cluster=c.cluster),s=this.getParams(c),i=/^[a-zA-Z]+_/g,f=(0,E.default)(c.metrics,"[0]","").replace(i,"workspace_"),a&&"all"!==a&&(s.metrics_filter="".concat(f.replace(i,"namespace_"),"$")),e.next=9,(0,_.to)(request.get("".concat(this.getApi({cluster:this.cluster,workspace:r,namespace:a})),s));case 9:return d=e.sent,p=this.getResult(d),l&&(p=this.getRefreshResult(p,this.resourceMetrics.originData)),this.resourceMetrics={originData:p,data:(0,E.default)(Object.values(p),"[0].data.result",{}),isLoading:!1},e.abrupt("return",p);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),h}(b.default),l=(0,y.default)(u.prototype,"statistics",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:{},isLoading:!1}}}),c=(0,y.default)(u.prototype,"resourceMetrics",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{originData:{},data:{},isLoading:!1}}}),(0,y.default)(u.prototype,"fetchStatistics",[g.action],Object.getOwnPropertyDescriptor(u.prototype,"fetchStatistics"),u.prototype),(0,y.default)(u.prototype,"getDevopsCount",[g.action],Object.getOwnPropertyDescriptor(u.prototype,"getDevopsCount"),u.prototype),(0,y.default)(u.prototype,"fetchApplicationResourceMetrics",[g.action],Object.getOwnPropertyDescriptor(u.prototype,"fetchApplicationResourceMetrics"),u.prototype),u);t.default=O},1219:function(e,t,r){e.exports={formWrapper:"_1pBRQd8MUROqFmxPfuRYp4",form:"_3JzFPoQ34lgmNVkSRMBVIj",footer:"_2dvsRov11uCxYPRe1gYh4",selectWrapper:"_3BCOXYnEfkLvOAaUpEiz04",tip:"_2k3-LCgSYKTYu6hfQCCzYR"}},1220:function(e,r,a){"use strict";a(17);var n=a(19);a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(30),a(4),a(16),a(40),a(10);var o=n(a(318)),u=n(a(25)),l=n(a(28)),c=n(a(38)),s=n(a(39)),i=n(a(35)),f=n(a(0)),d=n(a(69)),p=n(a(914)),m=n(a(845)),h=n(a(1144)),v=n(a(1590));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var g=function(e){(0,c.default)(a,e);var r=y(a);function a(){return(0,u.default)(this,a),r.apply(this,arguments)}return(0,l.default)(a,[{key:"renderCustomFilter",value:function(){var e=this.props,t=e.showClusterSelect,r=e.clusters,a=e.cluster,n=e.onClusterChange;return t?f.default.createElement(v.default,{clusters:r,cluster:a,onChange:n}):null}},{key:"render",value:function(){var e=this.props.clusters;return globals.app.isMultiCluster&&(0,d.default)(e)?f.default.createElement(m.default,{icon:"cluster",title:t("NO_CLUSTER_AVAILABLE"),desc:t("WORKSPACE_NO_CLUSTER_TIP")}):f.default.createElement(p.default,(0,o.default)({customFilter:this.renderCustomFilter()},this.props))}}]),a}(f.default.Component),E=(0,h.default)(g);r.default=E},1221:function(e,t,r){"use strict";r(17);var a=r(163),n=r(19);r(14),r(4),r(16),r(10),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31),r(30),r(14),r(4),r(16),r(40),r(10);var o=n(r(25)),u=n(r(28)),l=n(r(38)),c=n(r(39)),s=n(r(35)),i=a(r(0)),f=n(r(1)),d=n(r(5)),p=r(192),m=r(874),h=r(956),v=n(r(3671));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var g=function(e){(0,l.default)(r,e);var t=y(r);function r(){return(0,o.default)(this,r),t.apply(this,arguments)}return(0,u.default)(r,[{key:"renderIcon",value:function(){var e=this.props.type,t=h.STATUS_TO_ICON[e]||e;return"draft"===t?i.default.createElement("label",{className:v.default.draft}):"review"===t?i.default.createElement("label",{className:v.default.review}):"passed"===t?i.default.createElement(p.Icon,{size:16,name:"success",className:v.default.passed}):"suspended"===t?i.default.createElement("label",{className:v.default.suspended},i.default.createElement(p.Icon,{size:13,name:"substract",className:v.default.substract})):"deleted"===t?i.default.createElement(p.Icon,{size:16,name:"error",className:v.default.deleted}):i.default.createElement("label",{className:v.default.review})}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.name,a=e.type,n=e.noIcon,o=e.noName,u=(0,m.transferVersionStatus)(r||a);return i.default.createElement("span",{className:(0,d.default)(v.default.status,t)},!n&&i.default.createElement("label",{className:v.default.icon},this.renderIcon()),!o&&i.default.createElement("label",{className:v.default.name},u))}}]),r}(i.PureComponent);t.default=g,g.propTypes={className:f.default.string,name:f.default.string,type:f.default.string,noIcon:f.default.bool,noName:f.default.bool},g.defaultProps={type:"",name:"",noIcon:!1,noName:!1}},1584:function(e,t,r){"use strict";r(17);var a=r(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"TreeNode",{enumerable:!0,get:function(){return o.default}}),t.default=void 0;var n=a(r(3638)),o=a(r(1587));n.default.TreeNode=o.default;var u=n.default;t.default=u},1585:function(e,t,r){"use strict";r(17);var a=r(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(1)),o={tree:n.default.shape({disabled:n.default.bool,onNodeClick:n.default.func,onNodeExpand:n.default.func,onNodeSelect:n.default.func})};t.default=o},1586:function(e,t,r){e.exports={tree:"_2iR3_B67AK8wTsW8XlU6CJ",treeNode:"_1gVuXvLPfQKYkr7_rsG-kT",treeChildren:"_1fKRWcElGHwByUJSVwVQyL",treeNodeWrap:"EQ6h8y47L5gzxnGy4JtFd",disabled:"U8QsDfwAsL0nqHBKIYV97",treeContent:"_2-IH7XvhLc_Guza4AaoCJ_",selected:"_38P9-lalO-DKNLVEr5nAwf",treeSwitch:"_10aJkrX4ji6C11I_WM7Og8",open:"_4C6_lJrd94tk1oaI0QIee",close:"XPBaBcTE8W6gn1gXjlLYc",noop:"_1pilQ6urMDMxl-tE-Jc7SL",showLine:"O-GDVrOhmQJ3ruI8ul438"}},1587:function(e,t,r){"use strict";r(21);var a=r(163),n=r(19);r(12),r(3),r(11),r(6),r(8),r(13),r(9),r(4),r(16),r(10),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(12),r(31),r(3),r(11),r(6),r(27),r(30),r(33),r(17),r(8),r(13),r(9),r(4),r(16),r(40),r(10),r(7);var o=n(r(32)),u=n(r(25)),l=n(r(28)),c=n(r(75)),s=n(r(38)),i=n(r(39)),f=n(r(35)),d=a(r(0)),p=n(r(1)),m=n(r(5)),h=n(r(458)),v=r(192),y=n(r(1585)),g=n(r(1586)),E=r(1588);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var S=function(e){(0,s.default)(r,e);var t=b(r);function r(){var e;(0,u.default)(this,r);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).getNodeChildren=function(){var t=e.props.children,r=(0,E.toArray)(t).filter((function(e){return e}));return(0,E.getNodeChildren)(r)},e.isLeaf=function(){var t=e.props.isLeaf,r=0!==e.getNodeChildren().length;return!1!==t&&(t||!r)},e.isDisabled=function(){var t=e.props.disabled,r=e.context.tree.disabled;return!1!==t&&!(!r&&!t)},e.onExpand=function(t){(0,e.context.tree.onNodeExpand)(t,(0,c.default)(e))},e.onSelect=function(t){if(!e.isDisabled()){var r=e.context.tree.onNodeSelect;t.preventDefault(),r(t,(0,c.default)(e))}},e.onSelectorClick=function(t){(0,e.context.tree.onNodeClick)(t,(0,c.default)(e)),e.onSelect(t)},e.renderSelector=function(){var t=e.props,r=t.title,a=t.selected;return d.default.createElement("div",{className:(0,m.default)(g.default.treeContent,a&&g.default.selected),onClick:e.onSelectorClick},r)},e.renderSwitcher=function(){var t=e.props.expanded,r=e.isLeaf();return d.default.createElement("span",{className:(0,m.default)(g.default.treeSwitch,t?g.default.open:g.default.close,r&&g.default.noop)},d.default.createElement(v.Icon,{onClick:r?h.default:e.onExpand,name:"triangle-right",size:16,type:"dark"}))},e.renderChildren=function(){var t=e.props,r=t.expanded,a=t.pos,n=e.context.tree.renderTreeNode,o=e.getNodeChildren();return r&&d.default.createElement("ul",{className:(0,m.default)(g.default.treeChildren,r&&g.default.open)},(0,E.mapChildren)(o,(function(e,t){return n(e,t,a)})))},e}return(0,l.default)(r,[{key:"getChildContext",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.context)}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.selected,a=this.isDisabled();return d.default.createElement("li",{className:(0,m.default)(g.default.treeNode,t)},d.default.createElement("div",{className:(0,m.default)(g.default.treeNodeWrap,!a&&r&&g.default.selected,a&&g.default.disabled)},this.renderSwitcher(),this.renderSelector()),this.renderChildren())}}]),r}(d.Component);t.default=S,S.isTreeNode=!0,S.propTypes={eventKey:p.default.string,className:p.default.string,style:p.default.object,root:p.default.object,isLeaf:p.default.bool,onSelect:p.default.func,expanded:p.default.bool,selected:p.default.bool,children:p.default.node,title:p.default.node,pos:p.default.string,disabled:p.default.bool},S.contextTypes=y.default,S.childContextTypes=y.default,S.defaultProps={title:"---"}},1588:function(e,t,r){"use strict";r(17),r(21);var a=r(163);r(3),r(11),r(6),r(88),r(20),r(87),r(51),r(195),r(9),r(29),r(139),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.getDataAndAria=t.conductExpandParent=t.convertTreeToEntities=t.calcSelectedKeys=t.mapChildren=t.traverseTreeNodes=t.getNodeChildren=t.isTreeNode=t.getPosition=t.posToArr=t.arrAdd=t.arrDel=t.toArray=void 0,r(3),r(11),r(6),r(88),r(20),r(27),r(87),r(51),r(195),r(9),r(4),r(978),r(7);var n=a(r(0)),o=function(e){var t=[];return n.default.Children.forEach(e,(function(e){t.push(e)})),t};t.toArray=o;t.arrDel=function(e,t){var r=e.slice(),a=r.indexOf(t);return a>=0&&r.splice(a,1),r};t.arrAdd=function(e,t){var r=e.slice();return-1===r.indexOf(t)&&r.push(t),r};t.posToArr=function(e){return e.split("-")};var u=function(e,t){return"".concat(e,"-").concat(t)};t.getPosition=u;var l=function(e){return e&&e.type&&e.type.isTreeNode};t.isTreeNode=l;var c=function(e){return o(e).filter(l)};t.getNodeChildren=c;var s=function(e,t){!function r(a,o,l){var s=a?a.props.children:e,i=a?u(l.pos,o):0,f=c(s);if(a){var d={node:a,index:o,pos:i,key:a.key||i,parentPos:l.node?l.pos:null};t(d)}n.Children.forEach(f,(function(e,t){r(e,t,{node:a,pos:i})}))}(null)};t.traverseTreeNodes=s;t.mapChildren=function(e,t){var r=o(e).map(t);return 1===r.length?r[0]:r};t.calcSelectedKeys=function(e,t){if(e)return t.multiple?e.slice():e.length?[e[0]]:e};t.convertTreeToEntities=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.initWrapper,a=t.processEntity,n=t.onProcessFinished,o={},u={},l={posEntities:o,keyEntities:u};return r&&(l=r(l)||l),s(e,(function(e){var t=e.node,r=e.index,n=e.pos,c=e.key,s=e.parentPos,i={node:t,index:r,key:c,pos:n};o[n]=i,u[c]=i,i.parent=o[s],i.parent&&(i.parent.children=i.parent.children||[],i.parent.children.push(i)),a&&a(i,l)})),n&&n(l),l};t.conductExpandParent=function(e,t){var r={};return(e||[]).forEach((function(e){!function e(a){if(!r[a]){var n=t[a];if(n){r[a]=!0;var o=n.parent;o&&e(o.key)}}}(e)})),Object.keys(r)};t.getDataAndAria=function(e){return Object.keys(e).reduce((function(t,r){var a=t;return"data-"!==r.substr(0,5)&&"aria-"!==r.substr(0,5)||(a[r]=e[r]),a}),{})}},1589:function(e,t,r){e.exports={userWrapper:"_1_DSXUIddmrce317bVesnR",scrollWrapper:"_3RmABpydi_HaIsEVQPfv7O",empty:"_3IRiVwO3Ga_hzwmja9vZkn",item:"_2R1k6eZF5XuN5Z_VYNSrnv",avatar:"_3Haf5uSfbNIZvhOiTYU_wQ",text:"_2rKvqdP00-aDZ26saG7UJl",tabPanel:"_3fckqAKJLvfi_g7Zecc65O",active:"Kan_4CNGC_U5jWhmFgUK3"}},1590:function(e,r,a){"use strict";a(17);var n=a(163),o=a(19);a(3),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(30),a(4),a(16),a(40),a(10);var u=o(a(25)),l=o(a(28)),c=o(a(38)),s=o(a(39)),i=o(a(35)),f=n(a(0)),d=a(192),p=o(a(982)),m=a(56),h=o(a(3654));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var y=function(e){(0,c.default)(a,e);var r=v(a);function a(){var e;(0,u.default)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=r.call.apply(r,[this].concat(o))).valueRenderer=function(e){return f.default.createElement("div",{title:(0,m.showNameAndAlias)(e.cluster)},t("CLUSTER_VALUE",{value:(0,m.showNameAndAlias)(e.cluster)}))},e.optionRenderer=function(e){var t=(0,m.showNameAndAlias)(e.cluster);return f.default.createElement("div",{title:t},f.default.createElement("div",null,t),!e.cluster.isReady&&f.default.createElement("div",null,f.default.createElement(p.default,{data:e.cluster,noTip:!0})))},e}return(0,l.default)(a,[{key:"render",value:function(){var e=this.props,t=e.cluster,r=e.clusters,a=e.onChange;return f.default.createElement(d.Select,{className:h.default.select,value:t,onChange:a,options:r,valueRenderer:this.valueRenderer,optionRenderer:this.optionRenderer,showTip:!0})}}]),a}(f.Component);r.default=y},1591:function(e,t,r){"use strict";r(17);var a=r(19);r(3),r(4),r(16),r(10),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31),r(3),r(30),r(4),r(16),r(40),r(10);var n=a(r(25)),o=a(r(38)),u=a(r(39)),l=a(r(35));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,l.default)(e);if(t){var n=(0,l.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,u.default)(this,r)}}var s=function(e){(0,o.default)(r,e);var t=c(r);function r(){var e;(0,n.default)(this,r);for(var a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];return(e=t.call.apply(t,[this].concat(o))).resourceName="audits",e.sortKey="status_time",e}return r}(a(r(460)).default);t.default=s},1592:function(e,r,a){"use strict";var n=a(19);a(12),a(11),a(6),a(20),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(198),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(11),a(6),a(20),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(198),a(7);var o,u=n(a(32)),l=n(a(25)),c=n(a(28)),s=n(a(38)),i=n(a(39)),f=n(a(35)),d=n(a(0)),p=n(a(5)),m=a(245),h=n(a(26)),v=n(a(69)),y=a(192),g=n(a(802)),E=n(a(1590)),_=n(a(1073)),b=n(a(3680)),S=n(a(1593));function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,u.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var P=(0,m.observer)(o=function(e){(0,s.default)(a,e);var r=w(a);function a(e){var n;return(0,l.default)(this,a),(n=r.call(this,e)).fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.props,r=t.appId,a=t.versionId,o=t.workspace,u=n.state.cluster;n.store.fetchList(O({app_id:r,version_id:a,workspace:o,cluster:u},e))},n.getPagination=function(){var e=n.store.list;return{page:e.page,limit:e.limit,total:e.total}},n.handleSearch=function(e){n.searchValue=e,n.fetchData({keyword:e})},n.handleRefresh=function(){var e=n.searchValue?{keyword:n.searchValue}:{};n.fetchData(e)},n.handlePage=function(e){n.fetchData({page:e})},n.handleClusterChange=function(e){n.setState({cluster:e},(function(){n.fetchData()}))},n.renderHeader=function(){return d.default.createElement("div",{className:S.default.header},n.renderClusters(),d.default.createElement(y.InputSearch,{className:S.default.search,name:"search",placeholder:t("SEARCH_BY_NAME"),onSearch:n.handleSearch}),d.default.createElement("div",{className:S.default.actions},d.default.createElement(y.Button,{type:"flat",icon:"refresh",onClick:n.handleRefresh})))},n.renderFooter=function(){var e=n.getPagination(),r=e.total,a=e.page,o=e.limit;return d.default.createElement(y.Level,{className:S.default.footer},d.default.createElement(y.LevelLeft,null,t("TOTAL_ITEMS",{num:r})),d.default.createElement(y.LevelRight,null,d.default.createElement(y.Pagination,{page:a,total:r,limit:o,onChange:n.handlePage})))},n.state={uploadModal:!1,cluster:(0,h.default)(e,"clusters[0].name","")},n.store=new _.default,n}return(0,c.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"renderClusters",value:function(){var e=this.props.clusters;if((0,v.default)(e))return null;var t=e.map((function(e){return{label:e.name,value:e.name,disabled:!e.isReady,cluster:e}}));return d.default.createElement(E.default,{clusters:t,cluster:this.state.cluster,onChange:this.handleClusterChange})}},{key:"renderContent",value:function(){var e=this.props.versionId,r=this.store.list,a=r.data;return r.isLoading?d.default.createElement(y.Loading,{className:S.default.loading}):d.default.createElement("div",{className:S.default.body},(0,v.default)(a)?d.default.createElement("div",{className:S.default.empty},t("NO_RESOURCE_FOUND")):a.map((function(t){return d.default.createElement(b.default,{key:t.name,detail:t,showVersion:!e})})))}},{key:"render",value:function(){var e=this.props,r=e.className,a=e.title,n=e.hideHeader,o=e.hideFooter;return d.default.createElement(g.default,{className:(0,p.default)(S.default.main,r),title:a||t("APP_INSTANCES")},d.default.createElement("div",{className:S.default.inner},!n&&this.renderHeader(),this.renderContent(),!o&&this.renderFooter()))}}]),a}(d.default.Component))||o;r.default=P},1593:function(e,t,r){e.exports={main:"_3RsBOPqTSIO9U8W9rw7FXZ",header:"_12Agkrs2qKEvnlsCQuk1P7",search:"_3wEHtyer-RmdQNShfTnjwy",actions:"_2LnUPnba8kGi5ojNnufTwt",footer:"HMFMVptmxZyx8kO6TTV_s",item:"j7bcnGZE6qCsukA72vMci",itemMain:"_3_sYqp1scWFI8xP1zi_C1M",content:"_2OVcaaDJfwLdTObXoW1Qsf",more:"_3Co3dwP_Q9vMPyZrkvWpC3",loading:"_3xRw369cTNAcOPS2tUiGBv",empty:"a73qxVl2KPDTuAaZfRhvz"}},1594:function(e,t,r){e.exports={main:"VCMz8Hvdx9QgwfqLBYxPD",inner:"_2duoQ3UI4nja9dVo5Tg6Gu",header:"_1ujEwOD8918eEmngftbE-m",search:"_2W8Nr8NQnrxEQ2OdUFu5Xc",actions:"_3rEgDuHImvyhfRvoItgVGa",body:"_1XFrIa2I7UREilolWDQxqn",footer:"tgtIGSTEm1TCZFeiKkxfr",item:"_3P8oPqxESDZBnojf9VjE16",itemMain:"_3juNmtluJH9n446teuR_C9",icon:"_1Zvv7LvLsTEIen0tCC3Ilz",status:"XqSQXZRHKWjcLvllQIDuo",content:"_1IAefV34zduIcEv3RyPzF0",more:"_3Y-jHnJCq-JnxpS5CZzSgw",itemExtra:"_3S4VI1sg0-UwM0-oTnhysO",expanded:"_36Bum4cJKwtY3pzfp-wlas",instances:"_3Jb0lzRYd1l_Wzc43lAhgD",loading:"_2s-2yo1WGoImJofeVFj_hy",empty:"_16rfxAHXWQIGauFhE4yfGa"}},1595:function(e,r,a){"use strict";var n=a(19);a(12),a(11),a(6),a(20),a(14),a(8),a(13),a(9),a(4),a(16),a(10),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(11),a(6),a(20),a(27),a(249),a(861),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(21),a(16),a(40),a(10),a(7);var o=n(a(318)),u=n(a(42));a(36);var l,c,s,i=n(a(43)),f=n(a(32)),d=n(a(25)),p=n(a(28)),m=n(a(38)),h=n(a(39)),v=n(a(35)),y=n(a(0)),g=a(18),E=a(245),_=n(a(1)),b=n(a(69)),S=n(a(26)),k=a(56),O=a(804),w=n(a(441)),P=n(a(893)),R=a(192),C=a(821),D=n(a(1553)),T=n(a(3701));function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,f.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,h.default)(this,r)}}var I={times:100,step:"5m"},M=(0,E.observer)((s=c=function(e){(0,m.default)(n,e);var r,a=j(n);function n(e){var t;return(0,d.default)(this,n),(t=a.call(this,e)).fetchNamespaces=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.state.cluster;e.name&&(e.nameAndAlias=e.name,delete e.name),r&&t.projectStore.fetchList(A({cluster:r,workspace:t.props.workspace},e))},t.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.monitorStore.fetchApplicationResourceMetrics(A(A({metrics:[t.metricType],workspace:t.props.workspace,cluster:t.state.cluster},t.state),e))},t.handleClusterChange=function(e){t.workspaceStore&&t.workspaceStore.selectCluster(e),t.setState({cluster:e},t.fetchNamespaces)},t.handleNamespaceChange=function(e){t.setState({namespace:e})},t.handleSubmit=function(){var e=t.state,r=e.times,a=e.step,n=t.formRef.current&&t.formRef.current.getData();t.setState(n,(function(){t.fetchData(A(A({},n),{},{times:r,step:a}))}))},t.onCancel=function(){t.setState(A(A({},I),{},{namespace:"all",metrics_filter:void 0}),(function(){t.props.onCancel()}))},t.updateMonitorOptions=function(e){var r=e.times,a=e.step;t.setState({times:r,step:a})},t.projectOptionRenderer=function(e){return y.default.createElement("span",{className:T.default.option},e.isFedManaged?y.default.createElement("img",{className:T.default.indicator,src:"/extensions-static/ks-console-embed/dist/v3dist/assets/cluster.svg"}):y.default.createElement(R.Icon,{name:"project"}),e.label)},t.clusterOptionRenderer=function(e){return y.default.createElement("span",{className:T.default.option},y.default.createElement(R.Icon,{name:"cluster",type:"light"}),e.label)},t.clusterValueRenderer=function(e){return y.default.createElement("span",{className:T.default.option},y.default.createElement(R.Icon,{name:"cluster"}),e.label)},t.workspaceStore=e.workspaceStore,t.state=A(A({cluster:t.workspaceStore?t.workspaceStore.cluster:(0,S.default)(e,"cluster",""),namespace:(0,S.default)(e.detail,"namespace","all")},I),{},{metrics_filter:void 0}),t.projectStore=new w.default,t.monitorStore=new P.default,t.formRef=y.default.createRef(),t}return(0,p.default)(n,[{key:"componentDidUpdate",value:(r=(0,i.default)(u.default.mark((function e(t){var r,a,n=this;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.props.visible)&&r!==t.visible&&(a=this.props.workspaceStore,this.setState({cluster:a?a.cluster:(0,S.default)(this.props,"cluster","")},(0,i.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchNamespaces();case 2:return e.next=4,n.fetchData();case 4:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"renderFilterForm",value:function(){var e=this,r=this.state,a=r.cluster,n=r.namespace,o=A({},this.state),u=this.projectStore.list,l={total:u.total,page:u.page,limit:u.limit};return y.default.createElement(R.Form,{className:T.default.form,ref:this.formRef,data:o},this.props.workspace&&y.default.createElement(R.Form.Item,{label:t("CLUSTER")},y.default.createElement(R.Select,{name:"cluster",placeholder:" ",defaultValue:a,options:this.clusters,onChange:this.handleClusterChange,valueRenderer:this.clusterValueRenderer,optionRenderer:this.clusterOptionRenderer,showTip:!0})),y.default.createElement(R.Form.Item,{label:t("PROJECT")},y.default.createElement(R.Select,{name:"namespace",placeholder:" ",defaultValue:n,options:this.namespaces,onFetch:this.fetchNamespaces,onChange:this.handleNamespaceChange,valueRenderer:this.projectOptionRenderer,optionRenderer:this.projectOptionRenderer,isLoading:this.projectStore.list.isLoading,pagination:l,searchable:!0,clearable:!0})),this.isPvc&&this.props.detail.filters&&y.default.createElement(R.Form.Item,{label:t("storageclasses")},y.default.createElement(R.Select,{name:"metrics_filter",defaultValue:"workspace_pvc_bytes_used",onChange:function(t){e.setState({metrics_filter:t})},options:this.props.detail.filters.options.map((function(t){return{label:t.label,value:e.props.detail.filters.getMetricsFilter(t.value)}}))})),y.default.createElement(R.Form.Item,null,y.default.createElement(R.Button,{type:"control",onClick:this.handleSubmit},t("OK"))))}},{key:"renderChart",value:function(){var e=A(A({},this.props.detail),{},{data:this.monitoringData}),t=(0,O.getAreaChartOps)(e);return y.default.createElement("div",{className:T.default.chart},(0,b.default)(t.data)?y.default.createElement("div",{className:T.default.empty},y.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/empty-card.svg"})):y.default.createElement(C.SimpleArea,(0,o.default)({width:"100%",height:"100%"},t)))}},{key:"renderTable",value:function(){var e=this.props.detail.title,r=A({},this.props.detail),a=r.unitType,n=r.unit,o=((0,S.default)(this.monitoringData,"[0].values")||[]).reverse().map((function(e){return{time:1e3*(0,S.default)(e,"[0]",0),value:(0,O.getSuitableValue)((0,S.default)(e,"[1]",0),a||n)}})),u=[{key:"time",title:t("TIME"),dataIndex:"time",width:"30%",render:function(e){return(0,k.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"usage",title:t("USAGE"),dataIndex:"value"}];return y.default.createElement("div",{className:T.default.table},y.default.createElement("div",{className:T.default.box},y.default.createElement("div",{className:T.default.title},t(e)||t("RESOURCE_USAGE")),y.default.createElement(R.Table,{columns:u,dataSource:o,scroll:{y:200},expandIconAsCell:!1,rowKey:"time"})))}},{key:"render",value:function(){var e=this.state,t=e.times,r=e.step,a=this.props.visible,n=this.monitorStore.resourceMetrics,o=n.isLoading,u=n.isRefreshing;return a?y.default.createElement(D.default,{visible:a,onFetch:this.fetchData,onCancel:this.onCancel,loading:o,refreshing:u,times:t,step:r,updateMonitorOptions:this.updateMonitorOptions},y.default.createElement("div",{className:T.default.content},this.renderFilterForm(),this.renderChart(),this.renderTable())):null}},{key:"metrics",get:function(){return(0,g.toJS)(this.monitorStore.resourceMetrics.data)}},{key:"metricType",get:function(){var e;return this.isPvc&&null!==(e=this.state.metrics_filter)&&void 0!==e?e:this.props.detail.metricType}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data.map((function(e){return{label:(0,k.showNameAndAlias)(e),value:e.name,cluster:e,disabled:!e.isReady}}))}},{key:"namespaces",get:function(){var e=(0,g.toJS)(this.projectStore.list.data).map((function(e){return{label:(0,k.getDisplayName)(e),value:e.name,isFedManaged:e.isFedManaged}}));return e.unshift({label:t("ALL"),value:"all"}),e}},{key:"monitoringData",get:function(){return(0,g.toJS)(this.monitorStore.resourceMetrics.data)}},{key:"isPvc",get:function(){return"pvc"===this.props.detail.type}}]),n}(y.default.Component),c.propTypes={visible:_.default.bool,detail:_.default.object,onCancel:_.default.func},c.defaultProps={visible:!1,detail:{},onCancel:function(){}},l=s))||l;r.default=M},3624:function(e,t,r){"use strict";r(17);var a=r(19);r(3),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(3);var n=a(r(58)),o=a(r(3625)),u=a(r(3626)),l=a(r(3629)),c=a(r(3633)),s=a(r(3634)),i=a(r(3635)),f=a(r(3653)),d=a(r(3655)),p=a(r(3657)),m=a(r(3658)),h=a(r(3694)),v="/workspaces/:workspace",y=[].concat((0,n.default)(m.default),[{path:v,component:o.default,routes:[].concat((0,n.default)(h.default),[{path:"".concat(v,"/projects"),component:f.default,exact:!0},{path:"".concat(v,"/apps"),component:d.default,exact:!0},{path:"".concat(v,"/base-info"),component:u.default,exact:!0},{path:"".concat(v,"/repos"),component:p.default,exact:!0},{path:"".concat(v,"/quota"),component:l.default,exact:!0},{path:"".concat(v,"/roles"),component:c.default,exact:!0},{path:"".concat(v,"/members"),component:s.default,exact:!0},{path:"".concat(v,"/groups"),component:i.default,exact:!0}])}]);t.default=y},3625:function(e,t,r){"use strict";r(17);var a=r(19),n=r(163);r(3),r(4),r(16),r(29),r(10),r(66),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31),r(3),r(27),r(30),r(4),r(21),r(16),r(40),r(29),r(10),r(66);var o=a(r(58)),u=a(r(42));r(36);var l,c=a(r(43)),s=a(r(25)),i=a(r(28)),f=a(r(38)),d=a(r(39)),p=a(r(35)),m=a(r(26)),h=r(245),v=n(r(0)),y=a(r(448)),g=r(319);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var _=(0,h.inject)("rootStore","workspaceStore")(l=(0,h.observer)(l=function(e){(0,f.default)(r,e);var t=E(r);function r(e){var a;return(0,s.default)(this,r),(a=t.call(this,e)).state={fetchFin:!1},a.enterWorkspace=function(){var e=(0,c.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.routing.push("/workspaces/".concat(t,"/")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.store=new y.default,a}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props.route,t=e.routes,r=void 0===t?[]:t,a=e.path,n=globals.app.getWorkspaceNavs(this.workspace),u=(0,m.default)(n,"[0].items[0].name");return v.default.createElement(v.default.Fragment,null,u&&(0,g.renderRoutes)([].concat((0,o.default)(r),[(0,g.getIndexRoute)({path:a,to:"".concat(a,"/").concat(u),exact:!0}),(0,g.getIndexRoute)({path:"*",to:"/404",exact:!0})])))}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),r}(v.Component))||l)||l;t.default=_},3626:function(e,r,a){"use strict";a(17);var n=a(19);a(12),a(137),a(3),a(11),a(41),a(6),a(67),a(20),a(14),a(99),a(4),a(16),a(29),a(10),a(74),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(137),a(31),a(3),a(11),a(41),a(6),a(67),a(20),a(27),a(30),a(14),a(99),a(4),a(16),a(40),a(29),a(10),a(74),a(66),a(7);var o,u=n(a(58)),l=n(a(97)),c=n(a(25)),s=n(a(28)),i=n(a(38)),f=n(a(39)),d=n(a(35)),p=a(192),m=n(a(802)),h=n(a(859)),v=n(a(801)),y=n(a(847)),g=n(a(26)),E=n(a(69)),_=n(a(70)),b=a(18),S=a(245),k=n(a(1214)),O=n(a(0)),w=n(a(1078)),P=a(56),R=a(805),C=n(a(3627)),D=n(a(3628));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,f.default)(this,r)}}var N=(0,S.inject)("rootStore","workspaceStore")(o=(0,S.observer)(o=(0,R.trigger)(o=function(e){(0,i.default)(a,e);var r=T(a);function a(){var e;(0,c.default)(this,a);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=r.call.apply(r,[this].concat(o))).monitorStore=new w.default,e.getMetrics=function(){var t=(0,b.toJS)(e.monitorStore.statistics.data),r={};return Object.entries(t).forEach((function(e){var t=(0,l.default)(e,2),a=t[0],n=t[1];r[a]=(0,g.default)(n,"data.result[0].value[1]",0)})),r},e.fetchMetrics=function(){e.monitorStore.fetchStatistics(e.workspace,{})},e.fetchDetail=function(){e.store.fetchDetail({workspace:e.workspace})},e.showEdit=function(){e.trigger("resource.baseinfo.edit",{detail:(0,b.toJS)(e.store.detail),modal:C.default,success:e.fetchDetail})},e.handleNetworkChange=function(t){return function(){var r=(0,b.toJS)(e.store.detail),a=(0,b.toJS)(e.store.detail._originData),n=(0,g.default)(a,"overrides",[]),o=r.overrides,l=o.find((function(e){return e.clusterName===t}));l||(l={clusterName:t,clusterOverrides:[]},o.push(l));var c=l.clusterOverrides.find((function(e){return"/spec/networkIsolation"===e.path}));c||(c={path:"/spec/networkIsolation"},l.clusterOverrides.push(c)),c.value=!(0,g.default)(r,"clusterTemplates[".concat(t,"].spec.networkIsolation"));var s=n.filter((function(e){return e.clusterName!==t}));e.store.patch(r,[{op:"replace",path:"/metadata/name",value:r.name},{op:"add",path:"/spec/overrides",value:[].concat((0,u.default)(s),(0,u.default)(o))}]).then((function(){return e.fetchDetail()}))}},e.handleSingleClusterNetworkChange=function(){var t=(0,b.toJS)(e.store.detail),r=(0,g.default)(t._originData,"spec.template.spec",{});(0,_.default)(r,"networkIsolation",!t.networkIsolation),e.store.patch(t,[{op:"add",path:"/spec/template/spec",value:r}]).then((function(){return e.fetchDetail()}))},e.handleDelete=function(){var t=e.store.detail;e.trigger("workspace.delete",{type:"WORKSPACE",resource:t.name,detail:t,success:function(){return e.props.rootStore.routing.push("/")}})},e.getResourceOptions=function(){var r=e.getMetrics();return[{name:"1"===r.workspace_namespace_count?t("PROJECT"):t("PROJECTS"),icon:"project",value:r.workspace_namespace_count},{name:"1"===r.workspace_devops_project_count?t("DEVOPS_PROJECT_LOW"):t("DEVOPS_PROJECT_LOW_PL"),icon:"strategy-group",value:r.workspace_devops_project_count,hidden:!globals.app.hasKSModule("devops")},{name:"1"===r.workspace_member_count?t("WS_MEMBER_SCAP"):t("WS_MEMBER_SCAP_PL"),icon:"human",value:r.workspace_member_count}]},e.manageButtonClick=function(t,r){var a=e.enableManageAction.filter((function(e){return e.actionName===r}))[0];a&&a.onClick()},e.renderManageButton=function(){var t=e.enableManageAction,r=O.default.createElement(p.Menu,{onClick:e.manageButtonClick},t.map((function(e){return O.default.createElement(p.Menu.MenuItem,{key:e.actionName},O.default.createElement(p.Icon,{name:e.icon,type:"light"}),e.text)})));return t.length>0&&O.default.createElement(k.default,{className:D.default.manage,content:r})},e}return(0,s.default)(a,[{key:"componentDidMount",value:function(){this.canViewWorkspaceProjects&&this.fetchMetrics()}},{key:"renderBaseInfo",value:function(){var e=this.store.detail,r=this.getResourceOptions();return O.default.createElement(m.default,{title:t("WORKSPACE_INFO")},O.default.createElement("div",{className:D.default.header},O.default.createElement(v.default,{className:D.default.title,icon:"enterprise",title:(0,P.getDomTitle)((0,P.showNameAndAlias)(e)),description:(0,P.getDomTitle)(e.description||t("WORKSPACE")),ellipsis:!0}),O.default.createElement(v.default,{title:e.manager,description:t("MANAGER")}),O.default.createElement(v.default,{title:(0,P.getLocalTime)(e.createTime).format("YYYY-MM-DD HH:mm:ss"),description:t("CREATION_TIME")}),this.renderManageButton()),this.canViewWorkspaceProjects&&O.default.createElement("div",{className:D.default.content},r.filter((function(e){return!e.hidden})).map((function(e){return O.default.createElement(v.default,{key:e.name,icon:e.icon,title:e.value,description:t(e.name)})}))))}},{key:"renderNetwork",value:function(){var e=this,r=this.store.detail;if(!globals.app.isMultiCluster){if(!globals.app.hasExtensionModuleAnnotation("network","network.kubesphere.io/enable-network-policy"))return null;var a=r.networkIsolation||!1;return O.default.createElement(m.default,{className:D.default.network,title:t("NETWORK_ISOLATION")},O.default.createElement("div",{className:D.default.item},O.default.createElement(v.default,{icon:"firewall",title:t(a?"ON":"OFF"),description:t("WS_NETWORK_ISOLATION")}),this.enabledActionsNetwork.includes("manage")&&O.default.createElement(h.default,{className:D.default.switch,text:t(a?"ON":"OFF"),onChange:this.handleSingleClusterNetworkChange,checked:a})))}var n=(0,b.toJS)(this.store.clusters),o=n.data,u=n.isLoading;return O.default.createElement(m.default,{className:D.default.network,title:t("NETWORK_ISOLATION")},(0,E.default)(o)&&!u&&O.default.createElement("div",{className:D.default.empty},t("NO_CLUSTER_AVAILABLE")),o.map((function(a){var n=(0,g.default)(r,"clusterTemplates[".concat(a.name,"]"))||{},o=(0,g.default)(n,"spec.networkIsolation",r.networkIsolation)||!1;return O.default.createElement("div",{className:D.default.item,key:a.name},O.default.createElement(y.default,{cluster:a,className:D.default.clusterTitle}),O.default.createElement(v.default,{icon:"firewall",title:t(o?"ON":"OFF"),description:t("WS_NETWORK_ISOLATION")}),e.enabledActions.includes("manage")&&((0,g.default)(a,"configz.network")?O.default.createElement(h.default,{className:D.default.switch,text:t(o?"ON":"OFF"),onChange:e.handleNetworkChange(a.name),checked:o}):O.default.createElement("span",{className:D.default.noModule},t("NETWORK_POLICY_UNINSATLLED_DESC"))))})))}},{key:"render",value:function(){return O.default.createElement("div",null,this.renderBaseInfo(),this.renderNetwork())}},{key:"store",get:function(){return this.props.workspaceStore}},{key:"module",get:function(){return"BaseInfo"}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"isMultiCluster",get:function(){return!(0,E.default)(this.store.detail.clusters)}},{key:"tips",get:function(){return[{title:t("WORKSPACE_BASE_INFO_Q1"),description:t("WORKSPACE_BASE_INFO_A1")}]}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"workspace-settings",workspace:this.workspace})}},{key:"enabledActionsNetwork",get:function(){return globals.app.getActions({module:"networkpolicies",workspace:this.workspace})}},{key:"canViewWorkspaceProjects",get:function(){return globals.app.hasPermission({module:"projects",action:"view",workspace:this.workspace})}},{key:"enableManageAction",get:function(){var e=this.enabledActions,r=[];return e.includes("manage")&&r.push({actionName:"resource.baseinfo.edit",onClick:this.showEdit,icon:"pen",text:t("EDIT_INFORMATION")}),e.includes("manage")&&"member"!==globals.clusterRole&&r.push({actionName:"workspace.delete",onClick:this.handleDelete,icon:"trash",text:t("DELETE_WORKSPACE")}),r}}]),a}(O.default.Component))||o)||o)||o;r.default=N},3627:function(e,r,a){"use strict";var n=a(19);a(12),a(194),a(11),a(6),a(20),a(8),a(13),a(9),a(4),a(16),a(10),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(194),a(11),a(6),a(20),a(27),a(861),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(10),a(7);var o,u,l,c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=a(192),h=n(a(799)),v=n(a(829)),y=n(a(809)),g=n(a(26)),E=n(a(246)),_=n(a(197)),b=a(245),S=n(a(1)),k=n(a(0)),O=n(a(325)),w=a(61);function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var C=(0,b.observer)((l=u=function(e){(0,f.default)(a,e);var r=R(a);function a(e){var t;return(0,s.default)(this,a),(t=r.call(this,e)).fetchUsers=function(e){return t.userStore.fetchList(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e))},t.handleOk=function(e){var r=t.props.onOk;(0,_.default)(e,"spec.clusters"),r(e)},t.handleScrollToBottom=function(){!t.scrolling&&t.userStore.list.total>t.userStore.list.data.length&&(t.scrolling=!0,t.userStore.fetchList({more:!0,page:t.userStore.list.page+1}).then((function(){t.scrolling=!1})))},t.handleInputChange=(0,y.default)((function(e){e||!t._select?(t._search=!0,t.userStore.fetchList({name:e})):t._select=!1}),300),t.handleChange=function(e){t._select=!0,!e&&t._search&&(t.userStore.fetchList(),t._search=!1)},t.state={formData:(0,v.default)(e.detail._originData)},t.userStore=new O.default,t.fetchUsers(),t}return(0,i.default)(a,[{key:"render",value:function(){var e=this.props,r=e.visible,a=e.isSubmitting,n=e.onCancel,o=this.state.formData;return k.default.createElement(h.default.Form,{data:o,width:691,title:t("EDIT_INFORMATION"),icon:"enterprise",onOk:this.handleOk,okText:t("OK"),onCancel:n,visible:r,isSubmitting:a},k.default.createElement(m.Form.Item,{label:t("NAME"),desc:t("NAME_DESC")},k.default.createElement(m.Input,{name:"metadata.name",disabled:!0})),k.default.createElement(m.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:w.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},k.default.createElement(m.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),k.default.createElement(m.Form.Item,{label:t("ADMINISTRATOR")},k.default.createElement(m.Select,{name:"spec.template.spec.manager",options:this.users,pagination:(0,E.default)(this.userStore.list,["page","limit","total"]),isLoading:this.userStore.list.isLoading,onFetch:this.fetchUsers,defaultValue:globals.user.username,onChange:this.handleChange,searchable:!0})),k.default.createElement(m.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},k.default.createElement(m.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256,rows:"3"})))}},{key:"users",get:function(){var e=(0,g.default)(this.props.detail,"spec.template.spec.manager"),t=this.userStore.list.data.map((function(e){return{label:e.username,value:e.username}}));return t.every((function(t){return t.value!==e}))&&t.unshift({label:e,value:e}),t}}]),a}(k.default.Component),u.propTypes={detail:S.default.object,visible:S.default.bool,onOk:S.default.func,onCancel:S.default.func,isSubmitting:S.default.bool},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1},o=l))||o;r.default=C},3628:function(e,t,r){e.exports={header:"ySm_ubJyVUm8S8LbY2yIF",content:"_139KIcEdEKcJdiKUxOqkBa",tip:"_2Nsgzcsm1k-rqXu_VCsTgU",unbind:"_3Xy-as7N1JZ76WQrIXW9F1",action:"_1k9OCp058x4lIqafSr3xeN",item:"_3nvLCxrnjQ0KCiQeasoj7e",network:"_1jG_6R5BVNP1PJv9PQ6lh_",switch:"_2yn3vw2Pw0_JHStn5v03Hx",clusterTitle:"_2CKiDprsEk_4HcVvgH0rU3",empty:"_2f9pUp6DAKwVHDHqrnBOrX",title:"tvu2xaZOvMMQGFltqJ7xT",noModule:"_2uWU6vMT5mcHI5dpr1JJ4P",manage:"_3d5Sr8q7rZjE2qXijscb7s"}},3629:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(41),a(20),a(14),a(4),a(16),a(29),a(10),a(66),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(41),a(20),a(30),a(14),a(4),a(16),a(40),a(29),a(10),a(66);var o,u=n(a(318)),l=n(a(25)),c=n(a(28)),s=n(a(38)),i=n(a(39)),f=n(a(35)),d=n(a(0)),p=a(18),m=a(245),h=n(a(26)),v=n(a(3630)),y=n(a(3632));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var E=(0,m.inject)("workspaceStore")(o=function(e){(0,s.default)(a,e);var r=g(a);function a(){var e;(0,l.default)(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).getData=function(){e.store.fetchDetail(e.params)},e.handleMoreMenuClick=function(t,r){var a=e.enabledItemActions.find((function(e){return e.key===r}));a&&a.onClick&&a.onClick()},e}return(0,c.default)(a,[{key:"render",value:function(){var e=this,r=(0,p.toJS)(this.store.clusters.data);return d.default.createElement("div",null,d.default.createElement("div",{className:y.default.title},t("RESOURCE_QUOTA_PL")),r.map((function(t){return d.default.createElement(v.default,(0,u.default)({key:t.name,cluster:t},e.props.match.params,{canEdit:e.canEdit}))})))}},{key:"store",get:function(){return this.props.workspaceStore}},{key:"params",get:function(){return(0,h.default)(this.props.match,"params",{})}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"workspace-settings",workspace:this.params.workspace})}},{key:"canEdit",get:function(){return globals.app.isPlatformAdmin}}]),a}(d.default.Component))||o;r.default=E},3630:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(11),a(67),a(88),a(68),a(20),a(51),a(14),a(24),a(99),a(9),a(4),a(193),a(16),a(29),a(10),a(74),a(139),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(11),a(67),a(88),a(68),a(20),a(51),a(30),a(14),a(24),a(99),a(9),a(4),a(193),a(16),a(40),a(10),a(74);var o,u=n(a(58)),l=n(a(32)),c=n(a(97)),s=n(a(318)),i=n(a(25)),f=n(a(28)),d=n(a(38)),p=n(a(39)),m=n(a(35)),h=n(a(0)),v=a(18),y=a(245),g=n(a(444)),E=n(a(26)),_=n(a(846)),b=n(a(69)),S=n(a(837)),k=n(a(143)),O=a(192),w=a(56),P=a(61),R=n(a(802)),C=n(a(847)),D=a(805),T=n(a(889)),N=n(a(453)),A=n(a(1580)),j=n(a(1579)),I=n(a(3631));function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,p.default)(this,r)}}var L=["limits.cpu","limits.memory"],x=["requests.storage","persistentvolumeclaims"],U="storageclass.storage.k8s.io/requests.storage",V="storageclass.storage.k8s.io/persistentvolumeclaims",F=(0,y.inject)("rootStore")(o=(0,y.observer)(o=(0,D.trigger)(o=function(e){(0,d.default)(a,e);var r=M(a);function a(){var e;(0,i.default)(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).store=new T.default,e.storageClassStore=new N.default,e.showEdit=function(){var t=e.props,r=t.workspace,a=t.cluster;e.trigger("workspace.quota.edit",{detail:{name:r,workspace:r,cluster:a.name},success:e.fetchData,isFederated:!0})},e.fetchStorageClass=function(){var t=e.props.cluster;e.storageClassStore.fetchList({cluster:t.name})},e.fetchData=function(){var t=e.props,r=t.workspace,a=t.cluster;t.needUpgrade||e.store.fetchDetail({workspace:r,name:r,cluster:a.name})},e}return(0,f.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this,r=this.props,a=r.cluster,n=r.canEdit;if(this.needUpgrade)return h.default.createElement(R.default,null,h.default.createElement("div",{className:I.default.cluster},h.default.createElement(C.default,{cluster:a,theme:"light",noStatus:!globals.app.isMultiCluster})),h.default.createElement("div",{className:I.default.disabledTip},t("CLUSTER_UPGRADE_REQUIRED",{version:this.requiredVersion})));var o=this.items;return h.default.createElement(R.default,null,h.default.createElement("div",{className:I.default.cluster},h.default.createElement(C.default,{cluster:a,theme:"light",noStatus:!globals.app.isMultiCluster})),n&&h.default.createElement("div",{className:I.default.actions},h.default.createElement(O.Button,{onClick:this.showEdit},t("EDIT_QUOTAS"))),h.default.createElement("div",{className:I.default.content},o.map((function(e){return h.default.createElement(A.default,e)})),this.storageClassResource.map((function(e){var t=-1!==e.name.indexOf("requests.storage"),r=e.used,a=e.total;return t&&(0,k.default)(e.used)&&(r=(0,w.memoryFormat)(e.used,"Gi")),t&&(0,k.default)(e.total)&&(a=(0,w.memoryFormat)(e.total,"Gi")),(isNaN(a)||(0,S.default)(a))&&(a=void 0),h.default.createElement(A.default,(0,s.default)({iconName:"storage"},e,{used:r,total:a}))})),!(0,b.default)(this.relateStorageClass)&&Object.entries(this.relateStorageClass).map((function(t){var r=(0,c.default)(t,2),a=r[0],n=r[1];return h.default.createElement(j.default,{key:a,name:a,data:n,allStorageClass:e.allStorageClass})}))))}},{key:"requiredVersion",get:function(){return"v3.1.0"}},{key:"needUpgrade",get:function(){return(0,w.compareVersion)(globals.app.isMultiCluster?this.props.cluster.configz.ksVersion:(0,E.default)(globals,"ksConfig.ksVersion"),this.requiredVersion)<0}},{key:"items",get:function(){var e=(0,v.toJS)(this.store.detail);return Object.entries(P.WORKSPACE_QUOTAS_MAP).map((function(t){var r=(0,c.default)(t,2),a=r[0],n=r[1];return{key:a,name:a,total:(0,E.default)(e,'spec.quota.hard["'.concat(n.name,'"]')),used:(0,E.default)(e,'status.total.used["'.concat(n.name,'"]'),0)}})).filter((function(e){var t=e.total,r=e.used,a=e.name;return!(!t&&!Number(r)&&-1===L.indexOf(a))}))}},{key:"storageClassResource",get:function(){var e=(0,v.toJS)(this.store.detail);return x.map((function(t){var r=(0,E.default)(e,'spec.quota.hard["'.concat(t,'"]')),a=(0,E.default)(e,'status.total.used["'.concat(t,'"]'),t.includes("claims")?"0":"0Gi");return{key:t,name:t,total:-1!==t.indexOf("requests.storage")?"".concat((0,w.memoryFormat)(r,"Gi"),"Gi"):r,used:a}}))}},{key:"relateStorageClass",get:function(){var e=(0,v.toJS)(this.store.detail),t=(0,E.default)(e,"spec.quota.hard",{}),r=(0,E.default)(e,"status.total.used",{}),a=Object.entries(t).filter((function(e){var t=(0,c.default)(e,1)[0];return(0,g.default)(t,U)||(0,g.default)(t,V)})).map((function(e){var t=(0,c.default)(e,2),r=t[0],a=t[1];return(0,l.default)({},r,a)})),n=a.map((function(e){return(0,l.default)({},Object.keys(e)[0],(0,E.default)(r,["".concat(Object.keys(e)[0])]))})),o={total:(0,u.default)(a),used:(0,u.default)(n)};if(o.total.length>0){var s,i=(0,_.default)((0,u.default)(o.total),(function(e){return Object.keys(e)[0].split(".").slice(1).join(".")}));return s={},(0,l.default)(s,U,(0,E.default)(i,[U],[]).map((function(e){var t=Object.keys(e)[0],r=o.used.filter((function(e){return Object.keys(e)[0]===t}))[0];return{name:t,total:Object.values(e)[0],used:Object.values(r)[0]}}))),(0,l.default)(s,V,(0,E.default)(i,[V],[]).map((function(e){var t=Object.keys(e)[0],r=o.used.filter((function(e){return Object.keys(e)[0]===t}))[0];return{name:t,total:Object.values(e)[0],used:Object.values(r)[0]}}))),s}return{}}},{key:"allStorageClass",get:function(){return(0,v.toJS)(this.storageClassStore.list.data)}}]),a}(h.default.Component))||o)||o)||o;r.default=F},3631:function(e,t,r){e.exports={cluster:"_33bgBT87JaEVqJ0uzIjyFv",content:"_26wvITmEcN_9yGRcxyHvtB",actions:"FTCmPDXSK-8qQ7nF3OPEd",disabledTip:"_174Yw8pkPiTR9UrQjf7p84"}},3632:function(e,t,r){e.exports={title:"_2EN2HBaXv57LG6KaZxnUk0"}},3633:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(3),a(11),a(6),a(67),a(51),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(74),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(67),a(27),a(51),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(74),a(66),a(7);var u,l=n(a(32)),c=n(a(318)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=a(18),v=n(a(803)),y=n(a(811)),g=o(a(807)),E=a(56),_=a(61),b=n(a(324));function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var w=(0,g.default)({store:new b.default("workspaceroles"),module:"workspaceroles",authKey:"roles",name:"WORKSPACE_ROLE",injectStores:["rootStore","workspaceStore"]})(u=function(e){(0,f.default)(a,e);var r=O(a);function a(){var e;(0,s.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).showAction=function(t){return!globals.config.presetWorkspaceRoles.includes(t.name.slice(e.workspace.length+1))},e.getColumns=function(){var r=e.props.getSortOrder,a=e.props.match.params.workspace;return[{title:t("NAME"),dataIndex:"name",width:"25%",render:function(t,r){return m.default.createElement(v.default,{icon:_.ICON_TYPES[e.module],to:"/workspaces/".concat(a,"/roles/").concat(t),title:(0,E.getDisplayName)(r)})}},{title:t("DESCRIPTION"),key:"description",dataIndex:"description",isHideable:!0,width:"55%"},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:"19%",render:function(e){return(0,E.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var r=e.props,a=r.match,n=r.trigger,o=r.getData,u=r.store;return n("role.create",{title:t("CREATE_WORKSPACE_ROLE"),roleTemplates:e.roleTemplates,workspace:a.params.workspace,roleModules:(0,h.toJS)(u.roleCategory),success:o})},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){this.props.store.fetchRoleTemplates("workspace"),this.props.store.fetchTemplatesCategory("workspace")}},{key:"render",value:function(){var e=this.props.tableProps;return m.default.createElement(g.ListPage,(0,c.default)({},this.props,{noWatch:!0}),m.default.createElement(y.default,(0,c.default)({},e,{emptyProps:this.emptyProps,tableActions:this.tableActions,itemActions:this.itemActions,columns:this.getColumns(),searchType:"name"})))}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"itemActions",get:function(){var e=this,r=this.props,a=r.trigger,n=r.store,o=r.name,u=r.module,l=r.routing;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",show:this.showAction,onClick:function(e){return a("resource.baseinfo.edit",{detail:e,success:l.query})}},{key:"editRole",icon:"pen",text:t("EDIT_PERMISSIONS"),action:"edit",show:this.showAction,onClick:function(e){return a("role.edit",{module:u,detail:e,roleTemplates:(0,h.toJS)(n.roleTemplates.data),roleModules:(0,h.toJS)(n.roleCategory),success:l.query})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",show:this.showAction,onClick:function(t){return a("role.delete",{detail:t,type:o,workspace:e.props.match.params.workspace,success:l.query})}}]}},{key:"tableActions",get:function(){var e=this.props.tableProps,t={onCreate:this.showCreate};return k(k({},e.tableActions),{},{selectActions:[]},t)}},{key:"roleTemplates",get:function(){return(0,h.toJS)(this.props.store.roleTemplates.data)}},{key:"emptyProps",get:function(){return{desc:t("WORKSPACE_ROLE_EMPTY_DESC")}}}]),a}(m.default.Component))||u;r.default=w},3634:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(3),a(11),a(6),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(66),a(7);var u,l=n(a(318)),c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=a(18),v=n(a(325)),y=n(a(324)),g=n(a(803)),E=n(a(808)),_=n(a(811)),b=o(a(807)),S=a(56);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var P=(0,b.default)({store:new v.default,module:"users",authKey:"members",name:"WORKSPACE_MEMBER"})(u=function(e){(0,f.default)(a,e);var r=w(a);function a(){var e;(0,s.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).roleStore=new y.default("workspaceroles"),e.getColumns=function(){var r=e.props.prefix;return[{title:t("USERNAME"),dataIndex:"username",width:"40%",render:function(e,t){return m.default.createElement(g.default,{to:"".concat(r,"/").concat(e),avatar:t.avatar_url||"/extensions-static/ks-console-embed/dist/v3dist/assets/default-user.svg",title:e,desc:t.email})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"19%",render:function(e){return m.default.createElement(E.default,{type:e,name:t("USER_".concat(e.toUpperCase()))})}},{title:t("ROLE"),dataIndex:"workspacerole",isHideable:!0,width:"19%"},{title:t("LAST_LOGIN"),dataIndex:"lastLoginTime",isHideable:!0,width:"19%",render:function(e){return m.default.createElement("p",null,e?(0,S.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"):t("NOT_LOGIN_YET"))}}]},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){this.canViewRoles&&this.roleStore.fetchList(O(O({},this.props.match.params),{},{limit:-1}))}},{key:"showAction",value:function(e){return globals.user.username!==e.name}},{key:"render",value:function(){var e=this.props.tableProps;return m.default.createElement(b.ListPage,(0,l.default)({},this.props,{noWatch:!0}),m.default.createElement(_.default,(0,l.default)({},e,{tableActions:this.tableActions,itemActions:this.itemActions,columns:this.getColumns(),searchType:"name"})))}},{key:"canViewRoles",get:function(){var e=this.props.match.params.workspace;return globals.app.hasPermission({workspace:e,module:"roles",action:"view"})}},{key:"itemActions",get:function(){var e=this,r=this.props,a=r.trigger,n=r.getData;return[{key:"modify",icon:"pen",text:t("CHANGE_ROLE"),action:"edit",show:this.showAction,onClick:function(t){return a("member.edit",O(O({detail:t},e.props.match.params),{},{roles:(0,h.toJS)(e.roleStore.list.data),role:t.workspacerole,success:n}))}},{key:"delete",icon:"trash",text:t("REMOVE"),action:"delete",show:this.showAction,onClick:function(t){return a("member.remove",O({detail:t,success:n},e.props.match.params))}}]}},{key:"tableActions",get:function(){var e=this,r=this.props,a=r.tableProps,n=r.routing,o=r.getData,u=r.trigger;return O(O({},a.tableActions),{},{actions:[{key:"invite",type:"control",text:t("INVITE"),action:"create",onClick:function(){return u("member.invite",O(O({},e.props.match.params),{},{roleModule:e.roleStore.module,roles:(0,h.toJS)(e.roleStore.list.data),title:t("INVITE_MEMBER"),desc:t("INVITE_WORKSPACE_MEMBER_DESC"),searchPlaceholder:t("SEARCH_BY_NAME"),success:n.query}))}}],selectActions:[{key:"delete",type:"danger",text:t("REMOVE"),action:"delete",onClick:function(){return u("member.remove.batch",O(O({},e.props.match.params),{},{success:o}))}}],getCheckboxProps:function(t){return{disabled:!e.showAction(t),name:t.name}},emptyProps:{desc:t("WORKSPACE_MEMBER_EMPTY_DESC")}})}}]),a}(m.default.Component))||u;r.default=P},3635:function(e,r,a){"use strict";var n=a(19);a(12),a(3),a(11),a(6),a(67),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(74),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(67),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(74),a(66),a(7);var o,u=n(a(318)),l=n(a(58)),c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=a(245),v=a(18),y=n(a(5)),g=n(a(26)),E=n(a(809)),_=n(a(860)),b=a(192),S=n(a(814)),k=n(a(333)),O=n(a(325)),w=n(a(1480)),P=n(a(3636)),R=n(a(3648)),C=n(a(3650)),D=n(a(3652));function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var A=(0,h.inject)("rootStore","workspaceStore")(o=(0,h.observer)(o=function(e){(0,f.default)(a,e);var r=N(a);function a(e){var n;return(0,s.default)(this,a),(n=r.call(this,e)).initWebsocket=function(){var e=n.store.getWatchListUrl(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},n.props.match.params));if(e){n.websocket.watch(e);var t=(0,E.default)(n.fetchGroup,1e3);n.disposer=(0,v.reaction)((function(){return n.websocket.message}),(function(e){n.silentLoading=!0,"MODIFIED"!==e.type&&"ADDED"!==e.type||t(),"DELETED"===e.type&&t(!0)}))}},n.fetchGroup=function(e){var t=n.props.match.params.workspace;n.store.fetchGroup({workspace:t}).then((function(){if(!n.unmount&&e){var t=n.store.treeData;n.setState((function(e){return{refreshFlag:!e.refrseshFlag,group:(0,g.default)(t[0],"children[0].key",""),groupTitle:(0,g.default)(t[0],"children[0].group_name","")}}))}}))},n.handleRefresh=(0,_.default)((function(){n.fetchGroup(!0)}),1e3),n.handleSelectTree=function(e,t){var r=t.selectedNodes;n.setState({group:e[0],groupTitle:r[0].props.title,selectUserKeys:[]})},n.handleSelectUser=function(e){n.setState((function(t){return{selectUserKeys:[].concat((0,l.default)(t.selectUserKeys),[e.name])}}))},n.handleCancelSelect=function(){n.setState({selectUserKeys:[]})},n.handleAddGroup=function(){var e=n.props.match.params.workspace,r=n.state,a=r.selectUserKeys,o=r.group;n.store.addGroupBinding({userList:a,group:o,workspace:e}).then((function(){b.Notify.success({content:"".concat(t("ADDED_SUCCESS_DESC"))}),n.setState((function(e){return{refreshFlag:!e.refreshFlag,selectUserKeys:[]}}))}))},n.showEditModal=function(){n.setState({showModal:!0})},n.hideModal=function(){n.setState({showModal:!1})},n.store=new w.default,n.userStore=new O.default,n.websocket=new k.default,n.silentLoading=!1,n.state={group:"",groupTitle:"",selectUserKeys:[],refreshFlag:!1,showModal:!1},n}return(0,i.default)(a,[{key:"componentDidMount",value:function(){this.fetchGroup(!0),this.initWebsocket()}},{key:"componentWillUnmount",value:function(){this.unmount=!0,this.websocket.close(),this.disposer&&this.disposer()}},{key:"renderBanner",value:function(){return m.default.createElement(S.default,{icon:"group",title:t("DEPARTMENT_PL"),description:t("DEPARTMENT_DESC")})}},{key:"renderTitle",value:function(){var e=this.state.selectUserKeys.length>0;return this.enabledActions.includes("manage")?m.default.createElement("div",{className:(0,y.default)(D.default.contentHeader,e&&D.default.hasSelected)},e?this.renderSelectedTitle():this.renderToolBar()):null}},{key:"renderToolBar",value:function(){return m.default.createElement(b.Level,null,m.default.createElement(b.LevelLeft,null),m.default.createElement(b.LevelRight,null,m.default.createElement(b.Button,{type:"flat",onClick:this.handleRefresh},m.default.createElement(b.Icon,{name:"refresh"})),m.default.createElement(b.Button,{type:"control",onClick:this.showEditModal},t("SET_DEPARTMENTS"))))}},{key:"renderSelectedTitle",value:function(){return m.default.createElement(b.Level,null,m.default.createElement(b.LevelLeft,null,1===this.state.selectUserKeys.length?t.html("ADD_MEMBER_TIP_SI",{group:this.state.groupTitle}):t.html("ADD_MEMBER_TIP_PL",{group:this.state.groupTitle})),m.default.createElement(b.LevelRight,null,m.default.createElement(b.Button,{type:"primary",onClick:this.handleAddGroup},t("OK")),m.default.createElement(b.Button,{onClick:this.handleCancelSelect},t("CANCEL"))))}},{key:"render",value:function(){var e=(0,v.toJS)(this.store),r=e.treeData,a=e.rowTreeData,n=e.total,o=e.isLoading,l=this.state,c=l.group,s=l.selectUserKeys,i=l.refreshFlag,f=l.showModal;return m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:D.default.wrapper},this.renderTitle(),m.default.createElement("div",{className:D.default.content},m.default.createElement("div",{className:D.default.container},m.default.createElement(R.default,{treeData:r,group:c,total:n,isLoading:!this.silentLoading&&o,onSelect:this.handleSelectTree}),m.default.createElement(C.default,(0,u.default)({groupStore:this.store,userStore:this.userStore,group:c,refreshFlag:i,selectedKeys:s,onSelect:this.handleSelectUser,enabledActions:this.enabledActions},this.props))))),f&&m.default.createElement(P.default,(0,u.default)({visible:f,title:t("SET_DEPARTMENTS"),treeData:r,rowTreeData:a,store:this.store,workspaceStore:this.props.workspaceStore,onCancel:this.hideModal},this.props.match.params)))}},{key:"enabledActions",get:function(){var e=this.props.match.params.workspace;return globals.app.getActions({module:"groups",workspace:e})}}]),a}(m.default.Component))||o)||o;r.default=A},3636:function(e,r,a){"use strict";a(17);var n=a(19);a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(30),a(4),a(16),a(40),a(10);var o,u,l,c=n(a(318)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=n(a(1)),v=a(245),y=n(a(26)),g=n(a(799)),E=n(a(3637)),_=n(a(3640)),b=n(a(3647));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var k=(0,v.observer)((l=u=function(e){(0,f.default)(a,e);var r=S(a);function a(e){var t;return(0,s.default)(this,a),(t=r.call(this,e)).toggleForm=function(){t.setState((function(e){return{showForm:!e.showForm}}))},t.handleSelect=function(e){t.setState({showForm:!1,groupId:e[0],treeNodeId:e[0]})},t.handleTreeNodeIdChange=function(e){t.setState({treeNodeId:e})},t.store=e.store,t.state={showForm:!1,groupId:"",treeNodeId:"root"},t}return(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.treeData;(0,y.default)(e[0],"children",[]).length>0?this.setState({groupId:e[0].group_id}):this.setState({showForm:!0})}},{key:"render",value:function(){var e=this.props,r=e.visible,a=e.title,n=e.onCancel,o=e.treeData,u=this.state,l=u.showForm,s=u.groupId,i=u.treeNodeId;return m.default.createElement(g.default,{width:1162,title:a,closable:!1,cancelText:t("CLOSE"),visible:r,onCancel:n,bodyClassName:b.default.modalBody,footerClassName:b.default.modalFooter},m.default.createElement("div",{className:b.default.content},m.default.createElement(E.default,{treeData:o,groupId:this.groupId,onSelect:this.handleSelect}),m.default.createElement(_.default,(0,c.default)({},this.props,{showForm:l,toggleForm:this.toggleForm,onChange:this.handleTreeNodeIdChange,groupId:s,treeNodeId:i}))))}}]),a}(m.default.Component),u.propTypes={visible:h.default.bool,title:h.default.string,onCancel:h.default.func},u.defaultProps={visible:!1},o=l))||o;r.default=k},3637:function(e,r,a){"use strict";var n=a(19);a(12),a(11),a(6),a(8),a(13),a(9),a(4),a(16),a(10),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(11),a(6),a(27),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(10),a(7);var o,u,l,c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(1584)),h=a(245),v=n(a(1)),y=n(a(0)),g=a(56),E=n(a(3639));function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var k=(0,h.observer)((l=u=function(e){(0,f.default)(a,e);var r=S(a);function a(){return(0,s.default)(this,a),r.apply(this,arguments)}return(0,i.default)(a,[{key:"render",value:function(){var e,r,a=this.props,n=a.treeData,o=a.groupId,u=a.onSelect;return y.default.createElement("div",{className:E.default.wrapper},y.default.createElement("div",{className:E.default.treeWrapper},(null===(e=n[0])||void 0===e||null===(r=e.children)||void 0===r?void 0:r.length)>0?y.default.createElement(m.default,{className:E.default.tree,showLine:!0,defaultExpandedKeys:[o||"root"],defaultSelectedKeys:[o||"root"],onSelect:u,treeData:n,processor:{processProps:function(e){return"root"===e.key?b(b({},e),{},{title:(0,g.showNameAndAlias)(e.title,"workspace")}):b(b({},e),{},{title:(0,g.getDisplayName)(e)})}}}):y.default.createElement("p",null,t("NO_DEPARTMENT_TIP"))))}}]),a}(y.default.Component),u.propTypes={treeData:v.default.array},o=l))||o;r.default=k},3638:function(e,t,r){"use strict";r(17),r(21);var a=r(163),n=r(19);r(3),r(11),r(6),r(88),r(20),r(9),r(4),r(16),r(10),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(318)),u=n(r(32)),l=n(r(25)),c=n(r(28)),s=n(r(38)),i=n(r(39)),f=n(r(35)),d=n(r(50));r(31),r(3),r(11),r(6),r(88),r(120),r(20),r(30),r(9),r(4),r(16),r(40),r(10),r(7);var p=n(r(5)),m=n(r(1)),h=a(r(0)),v=n(r(1585)),y=n(r(1586)),g=n(r(1587)),E=r(1588);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var b=function(e){(0,s.default)(r,e);var t=_(r);function r(){var e;(0,l.default)(this,r);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={keyEntities:{},treeNode:[],selectedKeys:[]},e.setUncontrolledState=function(t,r){var a=!1,n={};Object.keys(t).forEach((function(r){r in e.props||(a=!0,n[r]=t[r])})),a&&e.setState(n,r)},e.onNodeClick=function(t,r){var a=e.props.onClick;a&&a(t,r)},e.onNodeSelect=function(t,r){var a=e.state.selectedKeys,n=e.state.keyEntities,o=e.props,u=o.toggleNodeSelect,l=o.onSelect,c=r.props,s=c.selected,i=c.eventKey,f=!s,d=(a=!f&&u?(0,E.arrDel)(a,i):[i]).map((function(e){var t=n[e];return t?t.node:null})).filter((function(e){return e}));(e.setUncontrolledState({selectedKeys:a}),l)&&l(a,{event:"select",selected:f,node:r,selectedNodes:d,nativeEvent:t.nativeEvent})},e.getTreeNodes=function(t){return e.state.keyEntities[t].node},e.onNodeExpand=function(t,r){var a=e.state.expandedKeys,n=e.props.onExpand,o=r.props,u=o.eventKey,l=!o.expanded;return a=l?(0,E.arrAdd)(a,u):(0,E.arrDel)(a,u),e.setUncontrolledState({expandedKeys:a}),n&&n(a,{node:r,expanded:l,nativeEvent:t.nativeEvent}),null},e.renderTreeNode=function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.state,o=n.keyEntities,u=n.expandedKeys,l=void 0===u?[]:u,c=n.selectedKeys,s=void 0===c?[]:c,i=(0,E.getPosition)(a,r),f=t.key||i;return o[f]?h.default.cloneElement(t,{key:f,eventKey:f,pos:i,expanded:-1!==l.indexOf(f),selected:-1!==s.indexOf(f)}):null},e}return(0,c.default)(r,[{key:"getChildContext",value:function(){return{tree:{disabled:this.props.disabled,renderTreeNode:this.renderTreeNode,onNodeClick:this.onNodeClick,onNodeExpand:this.onNodeExpand,onNodeSelect:this.onNodeSelect}}}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,a=t.showLine,n=this.state.treeNode,l=(0,E.getDataAndAria)(this.props);return h.default.createElement("ul",(0,o.default)({},l,{className:(0,p.default)(y.default.tree,r,(0,u.default)({},y.default.showLine,a)),role:"tree",unselectable:"on"}),(0,E.mapChildren)(n,(function(t,r){return e.renderTreeNode(t,r)})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=t.prevProps,a=e.expandedKeys,n=e.defaultExpandedKeys,o={prevProps:e},u=function(t){return!r&&t in e||!(!r||r[t]===e[t])},l=null;if(u("treeData")?l=function e(t,r){if(!t)return[];var a=(r||{}).processProps,n=void 0===a?function(e){return e}:a;return(Array.isArray(t)?t:[t]).map((function(t){var a=t.children,o=(0,d.default)(t,["children"]),u=e(a,r);return h.default.createElement(g.default,n(o),u)}))}(e.treeData,e.processor):u("children")&&(l=(0,E.toArray)(e.children)),l){o.treeNode=l;var c=(0,E.convertTreeToEntities)(l);o.posEntities=c.posEntities,o.keyEntities=c.keyEntities}var s=o.keyEntities||t.keyEntities;return u("expandedKeys")?o.expandedKeys=r?a:(0,E.conductExpandParent)(a,s):r||(o.expandedKeys=(0,E.conductExpandParent)(n,s)),u("selectedKeys")?o.selectedKeys=(0,E.calcSelectedKeys)(e.selectedKeys,e):!r&&e.defaultSelectedKeys&&(o.selectedKeys=(0,E.calcSelectedKeys)(e.defaultSelectedKeys,e)),o}}]),r}(h.Component);t.default=b,b.popTypes={className:m.default.className,treeData:m.default.array,showLine:m.default.bool,children:m.default.any,defaultExpandedKeys:m.default.arrayOf(m.default.string),defaultSelectedKeys:m.default.arrayOf(m.default.string),toggleNodeSelect:m.default.bool,onSelect:m.default.func,onClick:m.default.func,onExpand:m.default.func,disabled:m.default.bool},b.DefaultProps={showLine:!1,disabled:!1,toggleNodeSelect:!1,defaultExpandedKeys:[],defaultSelectedKeys:[]},b.contextTypes=v.default,b.childContextTypes=v.default},3639:function(e,t,r){e.exports={wrapper:"XWdVrGyDyVjTP6y5MMGS-",treeWrapper:"_2Vpq9xIPtc8ByYb17OEYOB"}},3640:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(3),a(11),a(41),a(6),a(20),a(8),a(13),a(9),a(4),a(16),a(10),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(41),a(6),a(20),a(27),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(21),a(16),a(40),a(10),a(7);var u=n(a(318)),l=n(a(32)),c=n(a(42)),s=n(a(58));a(36);var i,f,d,p=n(a(43)),m=n(a(25)),h=n(a(28)),v=n(a(38)),y=n(a(39)),g=n(a(35)),E=n(a(164)),_=n(a(823)),b=n(a(118)),S=n(a(455)),k=n(a(26)),O=n(a(69)),w=n(a(70)),P=n(a(254)),R=a(245),C=n(a(1)),D=o(a(0)),T=a(56),N=a(1481),A=n(a(3641)),j=n(a(3643)),I=n(a(3646));function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,g.default)(e);if(t){var n=(0,g.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,y.default)(this,r)}}var U=(0,R.observer)((d=f=function(e){(0,v.default)(a,e);var r=x(a);function a(e){var n;return(0,m.default)(this,a),(n=r.call(this,e)).handleAdd=function(){n.setState({mode:"create",formTemplate:(0,b.default)(n.initialFormTemplate)}),n.props.toggleForm()},n.handleDelete=function(e){n.setState({showConfirm:!0,resource:e})},n.handleConfirm=function(){var e=n.props.workspace,r=n.state.resource.group_id;n.store.deleteGroup(r,{workspace:e}).then((function(){n.setState({showConfirm:!1,deleteKeys:[r]}),E.default.success({content:t("DELETED_SUCCESSFULLY")}),n.store.fetchGroup({workspace:e})}))},n.hideConfirm=function(){n.setState({showConfirm:!1})},n.handleEdit=function(){var e=(0,p.default)(c.default.mark((function e(t){var r,a,o,u,l,i;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,b.default)(t._originData),a=(0,T.safeParseJSON)((0,k.default)(r,'metadata.annotations["kubesphere.io/project-roles"]',[])),o=(0,T.safeParseJSON)((0,k.default)(r,'metadata.annotations["kubesphere.io/devops-roles"]',[])),u=n.props.workspace,l=(0,P.default)([].concat((0,s.default)(a),(0,s.default)(o)).map((function(e){return e.cluster}))),e.next=7,n.store.fetchRoleBinding(t.group_id,{workspace:u,clusters:l});case 7:i=e.sent,(0,w.default)(r,'metadata.annotations["kubesphere.io/project-roles"]',n.getRoleJSON(a,i)),(0,w.default)(r,'metadata.annotations["kubesphere.io/devops-roles"]',n.getRoleJSON(o,i)),n.setState({mode:"edit",formTemplate:r}),n.props.onChange(t.group_id),n.props.toggleForm();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSave=function(){var e=(0,p.default)(c.default.mark((function e(r,a){var o;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.props.workspace,!a){e.next=7;break}return e.next=4,n.store.update(r,a,{workspace:o});case 4:E.default.success({content:t("UPDATE_SUCCESSFUL")}),e.next=10;break;case 7:return e.next=9,n.store.createGroup(r,{workspace:o});case 9:E.default.success({content:"".concat(t("ADDED_SUCCESS_DESC"))});case 10:n.props.toggleForm(),n.store.fetchGroup({workspace:o});case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),n.handleCancel=function(){var e=n.props,t=e.onChange,r=e.toggleForm,a=e.onCancel,o=n.getTreeNode(n.props);n.isEmptyTreeNode(o)?a():(t(n.props.groupId),r())},n.store=e.store,n.initialFormTemplate={apiVersion:"iam.kubesphere.io/v1beta1",kind:"Group",metadata:{annotations:{"kubesphere.io/workspace-role":"".concat(e.workspace,"-regular")},labels:{"kubesphere.io/workspace":"wsp1"}}},n.state={treeNode:n.getTreeNode(e),mode:"create",formTemplate:(0,b.default)(n.initialFormTemplate),showConfirm:!1,resource:"",deleteKeys:[]},n}return(0,h.default)(a,[{key:"componentDidUpdate",value:function(e){this.props.treeNodeId===e.treeNodeId&&this.props.rowTreeData===e.rowTreeData||this.setState({treeNode:this.getTreeNode(this.props)})}},{key:"getTreeNode",value:function(e){var t=e.treeNodeId;return e.rowTreeData[t]||{}}},{key:"isEmptyTreeNode",value:function(e){return!e.group_id||"root"===e.group_id&&!e.children.length}},{key:"getRoleJSON",value:function(e,t){return e.map((function(e){var r=(0,S.default)(t).find((function(t){return(0,k.default)(t,"metadata.namespace")===e.namespace&&(0,k.default)(t,"roleRef.name")===e.role}));return L(L({},e),{},{name:(0,k.default)(r,"metadata.name"),disabled:!0})}))}},{key:"renderBreadcrumbs",value:function(){var e=this.props,r=e.showForm,a=e.treeNodeId,n=this.state.mode,o=(0,N.getBreadCrumbData)(a,this.props.rowTreeData).map((function(e,t){return t?e.aliasName?"".concat(e.aliasName,"(").concat(e.group_name,")"):e.group_name:(0,T.showNameAndAlias)(e.group_name,"workspace")}));return r&&"create"===n&&(o=[].concat((0,s.default)(o),[t("CREATE_DEPARTMENT")])),D.default.createElement("ul",{className:I.default.breadcrumbs},o.map((function(e,t){return D.default.createElement("li",{key:"".concat(e,"-").concat(t)},D.default.createElement("span",null,e),t!==o.length-1&&D.default.createElement("span",{className:I.default.separator},">"))})))}},{key:"render",value:function(){var e=this.state,r=e.formTemplate,a=e.mode,n=e.showConfirm,o=e.resource,l=o.group_name,c=o.children,s=e.treeNode,i=e.deleteKeys,f=this.props,d=f.groupId,p=f.showForm,m=(0,O.default)(c)?t.html("DELETE_GROUP_TIP",{group_name:l}):t.html("DELETE_PARENT_GROUP_TIP",{group_name:l});return D.default.createElement("div",{className:I.default.detailWrapper},this.renderBreadcrumbs(),p?D.default.createElement(j.default,(0,u.default)({},this.props,{formTemplate:r,mode:a,groupId:d,onCancel:this.handleCancel,onSave:this.handleSave})):D.default.createElement(A.default,{treeNode:s,deleteKeys:i,onAdd:this.handleAdd,onEdit:this.handleEdit,onDelete:this.handleDelete}),D.default.createElement(_.default,{visible:n,onOk:this.handleConfirm,onCancel:this.hideConfirm,resource:l,desc:m}))}}]),a}(D.Component),f.propTypes={rowTreeData:C.default.object,groupId:C.default.string},i=d))||i;r.default=U},3641:function(e,r,a){"use strict";a(17);var n=a(19);a(67),a(20),a(4),a(16),a(10),a(74),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(67),a(20),a(30),a(4),a(16),a(40),a(10),a(74);var o=n(a(25)),u=n(a(28)),l=n(a(38)),c=n(a(39)),s=n(a(35)),i=n(a(0)),f=n(a(1)),d=n(a(26)),p=a(192),m=n(a(803)),h=a(56),v=n(a(3642));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var g=function(e){(0,l.default)(a,e);var r=y(a);function a(){return(0,o.default)(this,a),r.apply(this,arguments)}return(0,u.default)(a,[{key:"renderContent",value:function(){var e=this.props,r=e.treeNode.children,a=void 0===r?[]:r,n=e.deleteKeys,o=e.onEdit,u=e.onDelete;if(a.length>0)return a.map((function(e){var r=e.props||e;return i.default.createElement("div",{className:v.default.item,key:r.group_id},i.default.createElement(m.default,{className:v.default.avatar,icon:"group",iconSize:32,title:(0,h.getDisplayName)({name:r.group_name,aliasName:r.alias_name}),desc:(0,d.default)(r._originData,'metadata.annotations.["kubesphere.io/workspace-role"]')}),i.default.createElement("div",null,i.default.createElement("span",{className:"text-second padding-20"},n.includes(r.group_id)&&t("DELETING")),i.default.createElement(p.Button,{icon:"pen",type:"flat",onClick:function(){return o(r)}}),i.default.createElement(p.Button,{icon:"trash",type:"flat",onClick:function(){return u(r)}})))}))}},{key:"render",value:function(){var e=this.props.onAdd;return i.default.createElement("div",{className:v.default.cardWrapper},this.renderContent(),i.default.createElement("div",{className:v.default.empty,onClick:e},i.default.createElement("span",{className:v.default.icon}),i.default.createElement("span",null,t("CREATE_DEPARTMENT"))))}}]),a}(i.default.Component);r.default=g,g.propTypes={treeNode:f.default.object,onAdd:f.default.func,onEdit:f.default.func,onDelete:f.default.func}},3642:function(e,t,r){e.exports={cardWrapper:"_3wF5NYA-Pi8X_0xsiht8V9",item:"_1qqN7IfnNUInTkOWcdk8ey",avatar:"_3xx69JpMHTSALna5hG8YmR",empty:"_3bZ6AeTCOSxEEm34n0HTdu",icon:"_2F7y69hUXoCD7F961yZ0S5"}},3643:function(e,r,a){"use strict";a(17);var n=a(19);a(20),a(98),a(14),a(8),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(20),a(98),a(30),a(14),a(8),a(4),a(16),a(40),a(10);var o,u,l,c,s=n(a(318)),i=n(a(25)),f=n(a(28)),d=n(a(38)),p=n(a(39)),m=n(a(35)),h=n(a(45)),v=a(192),y=n(a(825)),g=n(a(118)),E=n(a(26)),_=n(a(70)),b=a(18),S=a(245),k=n(a(1)),O=n(a(0)),w=n(a(324)),P=a(56),R=a(61),C=n(a(3644)),D=n(a(1219)),T=n(a(3645));function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,p.default)(this,r)}}var A=(0,S.observer)((c=l=function(e){(0,d.default)(a,e);var r=N(a);function a(e){var n;return(0,i.default)(this,a),(n=r.call(this,e)).nameValidator=function(e,r,a){var o=n.props,u=o.workspace,l=o.mode;if(!r||"edit"===l)return a();n.props.store.checkName({name:r,workspace:u}).then((function(r){if(r.exist)return a({message:t("NAME_EXIST_DESC"),field:e.field});a()}))},n.checkItemValid=function(e){return e.role},n.handleSave=function(){var e=n.props,t=e.onSave,r=e.groupId,a=e.mode,o=(0,g.default)(n.state.formTemplate),u=n.formRef.current;u&&u.validate((function(){r&&(0,_.default)(o,'metadata.labels["iam.kubesphere.io/group-parent"]',r),"edit"===a?t(o,n.props.formTemplate):t(o)}))},n.formRef=O.default.createRef(),n.workspaceStore=e.workspaceStore,n.workspaceRoleStore=new w.default("workspaceroles"),n.state={formTemplate:(0,g.default)(e.formTemplate)},n}return(0,f.default)(a,[{key:"componentDidUpdate",value:function(e){this.props.formTemplate!==e.formTemplate&&this.setState({formTemplate:(0,g.default)(this.props.formTemplate)})}},{key:"componentDidMount",value:function(){this.fetchWorkspaceRoles()}},{key:"fetchWorkspaceRoles",value:function(){this.workspaceRoleStore.fetchList({workspace:this.props.workspace,limit:-1,sortBy:"createTime"})}},{key:"render",value:function(){var e=this.props,r=e.onCancel,a=e.mode,n=this.state.formTemplate;return O.default.createElement("div",{className:D.default.formWrapper},O.default.createElement(v.Form,{data:n,className:D.default.form,ref:this.formRef},O.default.createElement(v.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:R.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.nameValidator}]},O.default.createElement(v.Input,{name:"metadata.name",autoFocus:!0,maxLength:63,autoComplete:"off",disabled:"edit"===a})),O.default.createElement(v.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:R.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},O.default.createElement(v.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63,autoComplete:"off"})),O.default.createElement(v.Form.Item,{label:t("WORKSPACE_ROLE"),desc:t("GROUP_WORKSPACE_ROLE_DESC")+(this.needUpgrade?t("MEMBER_CLUSTER_UPGRADE_TIP",{version:"v3.1.0"}):"")},O.default.createElement(v.Select,{name:"metadata.annotations['kubesphere.io/workspace-role']",options:this.workspaceRoles,onChange:this.handleRolesChange})),O.default.createElement(v.Form.Group,{label:t("PROJECT_ROLE")},O.default.createElement(v.Form.Item,null,O.default.createElement(y.default,{name:"metadata.annotations['kubesphere.io/project-roles']",itemType:"object",addText:t("ADD_PROJECT"),checkItemValid:this.checkItemValid},O.default.createElement(T.default,(0,s.default)({clusters:this.clusters,showClusterSelect:globals.app.isMultiCluster},this.props))))),globals.app.hasKSModule("devops")&&O.default.createElement(v.Form.Group,{label:t("DEVOPS_PROJECT_ROLE")},O.default.createElement(v.Form.Item,null,O.default.createElement(y.default,{name:"metadata.annotations['kubesphere.io/devops-roles']",itemType:"object",addText:t("ADD_DEVOPS_PROJECT"),checkItemValid:this.checkItemValid},O.default.createElement(C.default,(0,s.default)({clusters:this.clusters,showClusterSelect:globals.app.isMultiCluster},this.props)))))),O.default.createElement("div",{className:D.default.footer},O.default.createElement(v.Button,{onClick:r},t("CANCEL")),O.default.createElement(v.Button,{type:"primary",onClick:this.handleSave},t("OK"))))}},{key:"needUpgrade",get:function(){return this.workspaceStore.clusters.data.some((function(e){return(0,P.compareVersion)(globals.app.isMultiCluster?(0,E.default)(e,"configz.ksVersion",""):(0,E.default)(globals,"ksConfig.ksVersion"),"v3.1.0")<0}))}},{key:"workspaceRoles",get:function(){return this.workspaceRoleStore.list.data.map((function(e){return{label:e.name,value:e.name,item:e}}))}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data.map((function(e){var t=(0,P.compareVersion)(globals.app.isMultiCluster?(0,E.default)(e,"configz.ksVersion",""):(0,E.default)(globals,"ksConfig.ksVersion"),"v3.1.0")<0;return{label:e.name,value:e.name,disabled:!e.isReady||t,needUpgrade:t,item:e}}))}}]),a}(O.default.Component),l.propTypes={workspace:k.default.string,groupId:k.default.string},u=c,(0,h.default)(u.prototype,"workspaceRoles",[b.computed],Object.getOwnPropertyDescriptor(u.prototype,"workspaceRoles"),u.prototype),(0,h.default)(u.prototype,"clusters",[b.computed],Object.getOwnPropertyDescriptor(u.prototype,"clusters"),u.prototype),o=u))||o;r.default=A},3644:function(e,r,a){"use strict";a(17);var n=a(19),o=a(163);a(194),a(11),a(20),a(14),a(8),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(194),a(11),a(20),a(30),a(14),a(8),a(4),a(16),a(40),a(10);var u,l,c,s,i=n(a(25)),f=n(a(28)),d=n(a(38)),p=n(a(39)),m=n(a(35)),h=n(a(45)),v=o(a(0)),y=n(a(1)),g=a(18),E=a(245),_=n(a(812)),b=n(a(69)),S=a(192),k=a(56),O=n(a(324)),w=n(a(332)),P=n(a(1219));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,p.default)(this,r)}}var C=(0,E.observer)((s=c=function(e){(0,d.default)(a,e);var r=R(a);function a(e){var n;return(0,i.default)(this,a),(n=r.call(this,e)).handleChange=function(){var e=n.state,t=e.cluster,r=e.namespace,a=e.role;n.props.onChange({cluster:t,namespace:r,role:a})},n.handleClusterChange=function(e){n.setState({cluster:e,namespace:"",role:""},(function(){n.handleChange(),n.fetchDevops(),n.devopsRoleStore.list.update({data:[]})}))},n.handleDevopsChange=function(e){n.setState({namespace:e,role:""},(function(){n.handleChange(),n.fetchDevopsRoles()}))},n.handleRoleChange=function(e){n.setState({role:e},(function(){return n.handleChange()}))},n.clusterRenderer=function(e){return v.default.createElement("span",null,v.default.createElement("span",null,(0,k.showNameAndAlias)(e.item)),e.needUpgrade&&v.default.createElement(S.Tooltip,{content:t("CLUSTER_UPGRADE_REQUIRED",{version:"v3.1.0"}),placement:"bottom"},v.default.createElement(S.Icon,{name:"update",className:P.default.tip,color:{primary:"#ffc781",secondary:"#f5a623"}})))},n.devopsStore=new w.default,n.devopsRoleStore=new O.default,n.state={cluster:(0,b.default)(e.value)?"":e.value.cluster,namespace:(0,b.default)(e.value)?"":e.value.namespace,role:(0,b.default)(e.value)?"":e.value.role},n}return(0,f.default)(a,[{key:"componentDidMount",value:function(){this.fetchDevops(),this.fetchDevopsRoles()}},{key:"componentDidUpdate",value:function(e){var t=this;(0,_.default)(e.value,this.props.value)||this.setState({cluster:this.props.value.cluster||"",namespace:this.props.value.namespace||"",role:this.props.value.role||""},(function(){t.fetchDevops(),t.fetchDevopsRoles()}))}},{key:"fetchDevops",value:function(){var e=this.state.cluster,t=this.props.showClusterSelect;!e&&t||this.devopsStore.fetchList({workspace:this.props.workspace,cluster:e,limit:-1,sortBy:"createTime"})}},{key:"fetchDevopsRoles",value:function(){var e=this.state,t=e.cluster,r=e.namespace;r&&this.devopsRoleStore.fetchList({devops:r,cluster:t,limit:-1,sortBy:"createTime"})}},{key:"render",value:function(){var e=this,r=this.props,a=r.clusters,n=r.value,o=r.showClusterSelect,u=this.state,l=u.cluster,c=u.namespace,s=u.role,i=!(0,b.default)(n)&&n.disabled;return v.default.createElement("div",{className:P.default.selectWrapper},o&&v.default.createElement(S.Select,{name:"cluster",value:l,disabled:i,options:a,placeholder:t("CLUSTER"),valueRenderer:function(e){return t("CLUSTER_VALUE",{value:(0,k.showNameAndAlias)(e.item)})},optionRenderer:this.clusterRenderer,prefixIcon:v.default.createElement(S.Icon,{name:"cluster",size:16}),onChange:this.handleClusterChange,showTip:!0}),v.default.createElement(S.Select,{name:"namespace",value:c,disabled:i,options:this.devops,placeholder:" ",valueRenderer:function(r){var a,n=(null===(a=(0,g.toJS)(e.devopsStore.list).data)||void 0===a?void 0:a.filter((function(e){return e.devops===r.value}))[0])||"";return t("PROJECT_VALUE",{value:(0,k.showNameAndAlias)(n)})},prefixIcon:v.default.createElement(S.Icon,{name:"strategy-group",size:16}),onChange:this.handleDevopsChange}),v.default.createElement(S.Select,{name:"role",value:s,disabled:i,options:this.roles,valueRenderer:function(e){return t("DEVOPS_PROJECT_ROLES_VALUE",{value:e.value})},prefixIcon:v.default.createElement(S.Icon,{name:"role",size:16}),placeholder:t("ROLE"),onChange:this.handleRoleChange}))}},{key:"devops",get:function(){var e=this,t=this.props.arrayValue,r=void 0===t?[]:t;return(0,g.toJS)(this.devopsStore.list).data.filter((function(t){return r.every((function(r){return r.cluster!==e.state.cluster||r.namespace!==t.devops}))})).map((function(e){return{label:(0,k.showNameAndAlias)(e),value:e.devops,item:e}}))}},{key:"roles",get:function(){return this.devopsRoleStore.list.data.map((function(e){return{label:e.name,value:e.name,item:e}}))}}]),a}(v.Component),c.propTypes={clusters:y.default.array},l=s,(0,h.default)(l.prototype,"devops",[g.computed],Object.getOwnPropertyDescriptor(l.prototype,"devops"),l.prototype),(0,h.default)(l.prototype,"roles",[g.computed],Object.getOwnPropertyDescriptor(l.prototype,"roles"),l.prototype),u=l))||u;r.default=C},3645:function(e,r,a){"use strict";a(17);var n=a(19),o=a(163);a(194),a(11),a(20),a(14),a(8),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(194),a(11),a(20),a(30),a(14),a(8),a(4),a(16),a(40),a(10);var u,l,c,s,i=n(a(25)),f=n(a(28)),d=n(a(38)),p=n(a(39)),m=n(a(35)),h=n(a(45)),v=o(a(0)),y=n(a(1)),g=a(18),E=a(245),_=n(a(812)),b=n(a(69)),S=a(192),k=a(56),O=n(a(324)),w=n(a(441)),P=n(a(1219));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,p.default)(this,r)}}var C=(0,E.observer)((s=c=function(e){(0,d.default)(a,e);var r=R(a);function a(e){var n;return(0,i.default)(this,a),(n=r.call(this,e)).handleChange=function(){var e=n.state,t=e.cluster,r=e.namespace,a=e.role;n.props.onChange({cluster:t,namespace:r,role:a})},n.handleClusterChange=function(e){n.setState({cluster:e,namespace:"",role:""},(function(){n.handleChange(),n.fetchProjects(),n.roleStore.list.update({data:[]})}))},n.handleProjectsChange=function(e){n.setState({namespace:e,role:""},(function(){n.handleChange(),n.fetchRoles()}))},n.handleRoleChange=function(e){n.setState({role:e},(function(){return n.handleChange()}))},n.clusterRenderer=function(e){return v.default.createElement("span",null,v.default.createElement("span",null,(0,k.showNameAndAlias)(e.item)),e.needUpgrade&&v.default.createElement(S.Tooltip,{content:t("CLUSTER_UPGRADE_REQUIRED",{version:"v3.1.0"}),placement:"bottom"},v.default.createElement(S.Icon,{name:"update",className:P.default.tip,color:{primary:"#ffc781",secondary:"#f5a623"}})))},n.workspaceStore=e.workspaceStore,n.projectStore=new w.default,n.roleStore=new O.default,n.state={cluster:(0,b.default)(e.value)?"":e.value.cluster,namespace:(0,b.default)(e.value)?"":e.value.namespace,role:(0,b.default)(e.value)?"":e.value.role},n}return(0,f.default)(a,[{key:"componentDidMount",value:function(){this.fetchProjects(),this.fetchRoles()}},{key:"componentDidUpdate",value:function(e){var t=this;(0,_.default)(e.value,this.props.value)||this.setState({cluster:this.props.value.cluster||"",namespace:this.props.value.namespace||"",role:this.props.value.role||""},(function(){t.fetchProjects(),t.fetchRoles()}))}},{key:"fetchProjects",value:function(){var e=this.state.cluster,t=this.props.showClusterSelect;!e&&t||this.projectStore.fetchList({workspace:this.props.workspace,cluster:e,limit:-1,sortBy:"createTime"})}},{key:"fetchRoles",value:function(){var e=this.state,t=e.cluster,r=e.namespace;r&&this.roleStore.fetchList({workspace:this.props.workspace,cluster:t,namespace:r,limit:-1,sortBy:"createTime"})}},{key:"render",value:function(){var e=this,r=this.props,a=r.clusters,n=r.value,o=r.showClusterSelect,u=this.state,l=u.cluster,c=u.namespace,s=u.role,i=!(0,b.default)(n)&&n.disabled;return v.default.createElement("div",{className:P.default.selectWrapper},o&&v.default.createElement(S.Select,{name:"cluster",value:l,disabled:i,options:a,placeholder:t("CLUSTER"),valueRenderer:function(e){return t("CLUSTER_VALUE",{value:(0,k.showNameAndAlias)(e.item)})},optionRenderer:this.clusterRenderer,prefixIcon:v.default.createElement(S.Icon,{name:"cluster",size:16}),onChange:this.handleClusterChange,showTip:!0}),v.default.createElement(S.Select,{name:"namespace",value:c,disabled:i,options:this.projects,placeholder:t("PROJECT"),valueRenderer:function(r){var a=e.projectStore.list.data.filter((function(e){return e.name===r.value}))[0]||"";return t("PROJECT_VALUE",{value:(0,k.showNameAndAlias)(a)})},prefixIcon:v.default.createElement(S.Icon,{name:"project",size:16}),onChange:this.handleProjectsChange}),v.default.createElement(S.Select,{name:"role",value:s,disabled:i,options:this.roles,valueRenderer:function(e){return t("PROJECT_ROLE_VALUE",{value:e.value})},prefixIcon:v.default.createElement(S.Icon,{name:"role",size:16}),placeholder:t("ROLE"),onChange:this.handleRoleChange}))}},{key:"projects",get:function(){var e=this,t=this.props.arrayValue,r=void 0===t?[]:t;return this.projectStore.list.data.filter((function(t){return r.every((function(r){return r.cluster!==e.state.cluster||r.namespace!==t.name}))})).map((function(e){return{label:(0,k.showNameAndAlias)(e),value:e.name,item:e}}))}},{key:"roles",get:function(){return this.roleStore.list.data.map((function(e){return{label:e.name,value:e.name,item:e}}))}}]),a}(v.Component),c.propTypes={clusters:y.default.array},l=s,(0,h.default)(l.prototype,"projects",[g.computed],Object.getOwnPropertyDescriptor(l.prototype,"projects"),l.prototype),(0,h.default)(l.prototype,"roles",[g.computed],Object.getOwnPropertyDescriptor(l.prototype,"roles"),l.prototype),u=l))||u;r.default=C},3646:function(e,t,r){e.exports={detailWrapper:"_1S1C__bXDtYMZ6xPU4u9FD",breadcrumbs:"sXboNxn0VlO0e8ZxzvJ9m",separator:"_2KeuD0ObNijSwq5odIg9DE"}},3647:function(e,t,r){e.exports={modalBody:"_3-5Nz5JgV2fPz1zNyGcO5c",content:"_3EgUH5MLx3S1cM-9DVdDVC",modalFooter:"_3_Z5HTlLEz3aoecExFXAxd"}},3648:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(3),a(11),a(6),a(8),a(13),a(9),a(4),a(16),a(10),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(27),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(10),a(7);var u,l,c,s=n(a(32)),i=n(a(25)),f=n(a(28)),d=n(a(38)),p=n(a(39)),m=n(a(35)),h=a(192),v=n(a(1584)),y=n(a(118)),g=n(a(26)),E=n(a(70)),_=a(245),b=n(a(1)),S=o(a(0)),k=a(56),O=n(a(3649));function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,p.default)(this,r)}}var C=(0,_.observer)((c=l=function(e){(0,d.default)(a,e);var r=R(a);function a(){var e;(0,i.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).renderTree=function(){var t=e.props,r=t.treeData,a=t.onSelect,n=t.group,o=(0,E.default)((0,y.default)(r)[0],"disabled",!0),u=(0,g.default)(r[0].children[0],"key","root");return S.default.createElement("div",{className:O.default.treeWrapper},S.default.createElement(v.default,{showLine:!0,defaultExpandedKeys:[u],defaultSelectedKeys:[u],treeData:o,selectedKeys:[n],onSelect:a,processor:{processProps:function(e){return"root"===e.key?P(P({},e),{},{title:(0,k.showNameAndAlias)(e.title,"workspace")}):P(P({},e),{},{title:(0,k.getDisplayName)(e)})}}}))},e.renderPlaceHolder=function(){return S.default.createElement("div",{className:O.default.empty},t("DEPARTMENT_EMPTY_DESC"))},e}return(0,f.default)(a,[{key:"render",value:function(){var e=this.props,t=e.isLoading,r=e.total;return S.default.createElement("div",{className:O.default.wrapper},t&&S.default.createElement("div",{className:O.default.loading},S.default.createElement(h.Loading,{spinning:t})),0===r&&!t&&this.renderPlaceHolder(),r>0&&this.renderTree())}}]),a}(S.Component),l.propTypes={treeData:b.default.array,total:b.default.number,isLoading:b.default.bool,onSelect:b.default.func},u=c))||u;r.default=C},3649:function(e,t,r){e.exports={wrapper:"_2iCTOipXFP82e41v-tZzEf",empty:"_3DQ5W3kiOrYnwnIm04s7WS",loading:"_3428Y_KBOws7FcaUlX1sks",treeWrapper:"m0r6YLradu_GH2NXkD7sy"}},3650:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(3),a(11),a(41),a(6),a(67),a(20),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(74),a(66),a(198),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(41),a(6),a(67),a(20),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(74),a(66),a(198),a(7);var u,l,c,s=n(a(32)),i=n(a(25)),f=n(a(28)),d=n(a(38)),p=n(a(39)),m=n(a(35)),h=o(a(0)),v=n(a(1)),y=a(245),g=n(a(5)),E=a(18),_=a(192),b=n(a(890)),S=a(805),k=n(a(3651)),O=n(a(1589));function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,p.default)(this,r)}}var C=(0,y.inject)("rootStore")(u=(0,y.observer)(u=(0,S.trigger)((c=l=function(e){(0,d.default)(a,e);var r=R(a);function a(e){var n;return(0,i.default)(this,a),(n=r.call(this,e)).getConfigs=function(){return[{type:"notingroup",title:t("NOT_ASSIGNED_TCAP"),onFetch:"fetchNotingroupData"},{type:"ingroup",title:t("ASSIGNED"),onFetch:"fetchIngroupData"}]},n.getCount=function(e){return n.userStore[e].total||0},n.getColor=function(e){return e===n.state.type?"#55bc8a":"#c1c9d1"},n.fetchNotingroupData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.state,r=t.group,a=t.search;n.userStore.fetchGroupUser(P(P({},e),{},{name:a,type:"notingroup",labelSelector:"!iam.kubesphere.io/groups-".concat(r),limit:10}))},n.fetchIngroupData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.state,r=t.group,a=t.search;n.userStore.fetchGroupUser(P(P({},e),{},{name:a,labelSelector:"iam.kubesphere.io/groups-".concat(r),type:"ingroup",limit:10}))},n.handleTypeChange=function(e){n.setState({type:e});try{var t=n.configs.find((function(t){return t.type===e}));n[t.onFetch]()}catch(e){console.error(e,"fetchError")}},n.handleSearch=function(e){n.setState({search:e},(function(){n.fetchIngroupData(),n.fetchNotingroupData()}))},n.handleSelect=function(e){n.props.onSelect(e)},n.handleDelete=function(e){n.trigger("group.user.remove",P({store:n.props.groupStore,detail:(0,E.toJS)(P(P({},e),{},{group:n.state.group})),success:function(){n.fetchIngroupData({page:1}),n.fetchNotingroupData({page:1})}},n.props.match.params))},n.renderPlaceHolder=function(){return h.default.createElement("div",{className:O.default.item},t("DEPARTMENT_EMPTY_DESC"))},n.userStore=e.userStore,n.groupStore=e.groupStore,n.state={type:"ingroup",group:e.group,search:""},n.configs=n.getConfigs(),n}return(0,f.default)(a,[{key:"componentDidUpdate",value:function(e){var t=this;e.refreshFlag===this.props.refreshFlag&&e.group===this.props.group||this.setState({group:this.props.group},(function(){t.fetchIngroupData(),t.fetchNotingroupData()}))}},{key:"renderToolBar",value:function(){var e=this;return h.default.createElement("div",{className:"level"},h.default.createElement("div",{className:"level-left"},h.default.createElement(_.RadioGroup,{mode:"button",value:this.state.type,onChange:this.handleTypeChange},this.configs.map((function(t){var r=t.type,a=t.title;return h.default.createElement(_.RadioButton,{key:r,value:r},a,h.default.createElement(_.Tag,{color:e.getColor(r)},e.getCount(r)))}))),this.state.group&&h.default.createElement(_.InputSearch,{className:O.default.search,onSearch:this.handleSearch,placeholder:t("SEARCH_BY_NAME")})))}},{key:"renderUserItem",value:function(e){var t=this,r=e.type,a=e.onFetch,n=(0,E.toJS)(this.userStore[r]),o=n.data,u=void 0===o?[]:o,l=n.total,c=n.page,s=n.isLoading,i=this.props,f=i.selectedKeys,d=i.enabledActions,p=this.state.group;return p||"ingroup"!==r?h.default.createElement(b.default,{data:u,total:l,page:c,loading:s,onFetch:this[a]},u.map((function(e){return h.default.createElement(k.default,{key:"".concat(r,"-").concat(e.name),type:r,user:e,group:p,groupStore:t.groupStore,enabledActions:d,selected:f.includes(e.name),onSelect:function(){return t.handleSelect(e)},onDelete:function(){return t.handleDelete(e)}})}))):this.renderPlaceHolder()}},{key:"render",value:function(){var e=this,t=this.state.type;return h.default.createElement("div",{className:O.default.userWrapper},this.renderToolBar(),h.default.createElement("div",{className:O.default.scrollWrapper},this.configs.map((function(r){return h.default.createElement("div",{className:(0,g.default)(O.default.tabPanel,t===r.type&&O.default.active),key:r.type},e.renderUserItem(r))}))))}}]),a}(h.Component),l.propTypes={group:v.default.string,enabledActions:v.default.array,selectedKeys:v.default.array,refreshFlag:v.default.bool,onSelect:v.default.func},u=c))||u)||u)||u;r.default=C},3651:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(11),a(41),a(67),a(68),a(20),a(14),a(4),a(16),a(10),a(74),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(11),a(41),a(67),a(68),a(20),a(30),a(14),a(4),a(16),a(40),a(10),a(74);var o=n(a(25)),u=n(a(28)),l=n(a(38)),c=n(a(39)),s=n(a(35)),i=a(192),f=n(a(803)),d=n(a(801)),p=a(18),m=n(a(1)),h=n(a(0)),v=n(a(1589));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var g=function(e){(0,l.default)(a,e);var r=y(a);function a(){var e;(0,o.default)(this,a);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=r.call.apply(r,[this].concat(n))).getGroupName=function(t){var r=(0,p.toJS)(e.props.groupStore.list).data,a=void 0===r?[]:r;return t.map((function(e){return a.find((function(t){return t.group_id===e}))})).filter(Boolean).map((function(e){return e.aliasName?"".concat(e.group_name,"(").concat(e.aliasName,")"):e.group_name})).join(", ")},e}return(0,u.default)(a,[{key:"renderButton",value:function(){var e=this.props,t=e.enabledActions,r=e.group,a=e.type,n=e.onDelete;return t.includes("manage")&&r?"notingroup"===a?this.renderSelectedButton():h.default.createElement(i.Button,{type:"flat",onClick:n},h.default.createElement(i.Icon,{name:"trash",size:16})):null}},{key:"renderSelectedButton",value:function(){var e=this.props,t=e.selected,r=e.onSelect;return t?h.default.createElement(i.Button,{type:"flat",icon:"check",disabled:!0}):h.default.createElement(i.Button,{type:"control",icon:"add",iconType:"light",onClick:r})}},{key:"render",value:function(){var e=this.props,r=e.user,a=e.type;return h.default.createElement("div",{className:v.default.item,"data-user":r.username},h.default.createElement(f.default,{className:v.default.avatar,avatar:r.avatar_url||"/extensions-static/ks-console-embed/dist/v3dist/assets/default-user.svg",iconSize:32,title:r.name,desc:r.email}),"ingroup"===a&&h.default.createElement(d.default,{className:v.default.text,title:this.getGroupName(r.groups),description:t("DEPARTMENT")}),this.renderButton())}}]),a}(h.default.Component);r.default=g,g.propTypes={user:m.default.object,enabledActions:m.default.array,selected:m.default.bool,onSelect:m.default.func,onDelete:m.default.func}},3652:function(e,t,r){e.exports={wrapper:"_1yXwqB3fw3UDOjtZGaGmR0",contentHeader:"_3-bnIfVfDnD-ZVmgIyAL_9",hasSelected:"qeVmvDg0ZbuDwMxIi8GEj",content:"_1ZvzvmRjazeU28M2k50fck",container:"_2H3fqMFGgZ8y3cCUPvF74K"}},3653:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(137),a(3),a(11),a(41),a(6),a(20),a(14),a(8),a(13),a(9),a(4),a(193),a(16),a(29),a(10),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(137),a(31),a(3),a(11),a(41),a(6),a(20),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(193),a(21),a(16),a(40),a(29),a(10),a(66),a(7);var u=n(a(318)),l=n(a(42)),c=n(a(32)),s=n(a(50));a(36);var i,f,d=n(a(43)),p=n(a(25)),m=n(a(28)),h=n(a(38)),v=n(a(39)),y=n(a(35)),g=n(a(45)),E=n(a(0)),_=n(a(26)),b=a(18),S=a(192),k=n(a(803)),O=n(a(808)),w=o(a(807)),P=n(a(1220)),R=a(56),C=a(804),D=n(a(441)),T=n(a(942));function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,y.default)(e);if(t){var n=(0,y.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,v.default)(this,r)}}var I={cpu:"namespace_cpu_usage",memory:"namespace_memory_usage_wo_cache",gpu:"namespace_gpu_usage",gpu_memory:"namespace_gpu_memory_usage",pod:"namespace_pod_count"},M=(0,w.default)({store:new D.default,name:"PROJECT",module:"projects",injectStores:["rootStore","workspaceStore"]})((f=function(e){(0,h.default)(a,e);var r=j(a);function a(){var e;(0,p.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).workspaceStore=e.props.workspaceStore,e.monitoringStore=new T.default,e.state={nodeCount:"",nodeGroupCount:""},e.handleTabChange=function(t){var r=e.props.match.params.workspace;e.props.routing.push("/workspaces/".concat(r,"/").concat(t))},e.handleClusterChange=function(t){e.workspaceStore.selectCluster(t)},e.getData=(0,d.default)(l.default.mark((function t(){var r,a,n,o,u,c,i=arguments;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i.length>0&&void 0!==i[0]?i[0]:{},a=r.silent,n=(0,s.default)(r,["silent"]),o=e.props.store,a&&(o.list.silent=!0),!(u=e.workspaceStore.cluster)){t.next=11;break}return t.next=7,o.fetchList(A(A({cluster:u},e.props.match.params),n));case 7:if(!((c=o.list.data.map((function(e){return e.name}))).length>0)){t.next=11;break}return t.next=11,e.monitoringStore.fetchMetrics(A(A({cluster:u,resources:c},e.props.match.params),{},{metrics:Object.values((0,R.hideGPUByLicense)(I,u)),last:!0}));case 11:o.list.silent=!1;case 12:case"end":return t.stop()}}),t)}))),e.getLastValue=function(t,r){var a=e.monitoringStore.data,n=((0,_.default)(a,"".concat(r,".data.result"))||[]).find((function(e){return(0,_.default)(e,"metric.namespace")===t.name}));return(0,_.default)(n,"value[1]",0)},e.getCheckboxProps=function(e){return{disabled:"Terminating"===e.status,name:e.name}},e.getColumns=function(){var r=e.props.getSortOrder,a={Active:"ACTIVE",Terminating:"TERMINATING"},n=[{title:t("NAME"),dataIndex:"name",key:"name",sorter:!0,sortOrder:r("name"),render:function(t,r){return E.default.createElement(k.default,{to:"Terminating"===r.status||r.isFedHostNamespace?null:"/".concat(e.workspace,"/clusters/").concat(r.cluster,"/projects/").concat(t),icon:"project",iconSize:40,desc:r.description||"-",title:(0,R.getDisplayNameNew)(r)})}},{title:t("STATUS"),dataIndex:"status",key:"status",isHideable:!0,render:function(e){return E.default.createElement(O.default,{type:e,name:t(a[e]),flicker:!0})}}];return globals.app.hasClusterModule(e.workspaceStore.cluster,"whizard-monitoring")&&n.push({title:t("CPU_USAGE"),key:"namespace_cpu_usage",isHideable:!0,render:function(t){return(0,C.getSuitableValue)(e.getLastValue(t,I.cpu),"cpu","-")}},{title:t("MEMORY_USAGE"),key:"namespace_memory_usage_wo_cache",isHideable:!0,render:function(t){return(0,C.getSuitableValue)(e.getLastValue(t,I.memory),"memory","-")}},{title:t("GPU_USAGE"),key:"namespace_gpu_usage",isHideable:!0,render:function(t){return(0,C.getSuitableValue)(e.getLastValue(t,I.gpu),"gpu","-")}},{title:t("GPU_MEMORY_USAGE"),key:"namespace_gpu_memory_usage",isHideable:!0,render:function(t){return(0,C.getSuitableValue)(e.getLastValue(t,I.gpu_memory),"memory","-")}},{title:t("POD_COUNT"),key:"namespace_pod_count",isHideable:!0,render:function(t){return e.getLastValue(t,I.pod)}}),n.push({title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",isHideable:!0,sorter:!0,render:function(e){return(0,R.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}),n},e.showCreate=function(){e.props.trigger("project.create",A(A({},e.props.match.params),{},{type:"ks",defaultCluster:e.workspaceStore.cluster,success:function(t){t&&e.workspaceStore.selectCluster(t),e.getData({silent:!0})}}))},e}return(0,m.default)(a,[{key:"renderTitle",value:function(e){return e.isFedHostNamespace?E.default.createElement("span",null,E.default.createElement("span",{className:"margin-r8"},(0,R.getDisplayNameNew)(e)),E.default.createElement(S.Tooltip,{content:t("FED_HOST_NAMESPACE_TIP")},E.default.createElement(S.Icon,{name:"information"}))):(0,R.getDisplayNameNew)(e)}},{key:"render",value:function(){var e=this.props,t=e.match,r=e.tableProps,a=A(A({},t),{},{params:A(A({},t.params),{},{cluster:this.workspaceStore.cluster})}),n=this.monitoringStore.isLoading,o=(0,R.hideGPUByLicense)(this.getColumns(),t.params.cluster);return E.default.createElement(w.ListPage,(0,u.default)({},this.props,{match:a,getData:this.getData,module:"namespaces"}),E.default.createElement(P.default,(0,u.default)({className:"table-2-7"},r,{itemActions:this.itemActions,columns:o,columnSearch:this.columnSearch,onCreate:this.showCreate},this.clusterProps,{isLoading:r.isLoading||n,getCheckboxProps:this.getCheckboxProps})))}},{key:"tabs",get:function(){return{value:this.props.module,onChange:this.handleTabChange,options:[{value:"projects",label:t("PROJECT_PL")},{value:"federatedprojects",label:t("MULTI_CLUSTER_PROJECT_PL")}]}}},{key:"isClusterManage",get:function(){return globals.app.isPlatformAdmin||globals.app.hasPermission({module:"clusters",action:"manage"})}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data.map((function(e){return{label:e.name,value:e.name,disabled:!e.isReady,cluster:e}}))}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"clusterProps",get:function(){return{clusters:this.clusters,cluster:this.workspaceStore.cluster,onClusterChange:this.handleClusterChange,showClusterSelect:globals.app.isMultiCluster}}},{key:"columnSearch",get:function(){var e=this.workspaceStore.cluster,r=(0,R.compareVersion)((0,R.getClusterVersion)(e),"3.4.0")>=0;return[{dataIndex:"name",title:t("NAME"),search:!0},{dataIndex:"alias",title:t("ALIAS"),search:r}]}},{key:"itemActions",get:function(){var e=this,r=this.props,a=r.trigger,n=r.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return a("resource.baseinfo.edit",{detail:e})}},{key:"edit-annotations",icon:"pen",text:t("EDIT_ANNOTATIONS"),action:"manage",show:function(){return e.isClusterManage},onClick:function(e){return a("resource.annotations.edit",{detail:e})}},{key:"quotaEdit",icon:"pen",text:t("EDIT_QUOTAS"),action:"edit",onClick:function(e){return a("project.quota.edit",{type:t("PROJECT"),detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{type:n,detail:e})}}]}}]),a}(E.default.Component),(0,g.default)(f.prototype,"clusters",[b.computed],Object.getOwnPropertyDescriptor(f.prototype,"clusters"),f.prototype),i=f))||i;r.default=M},3654:function(e,t,r){e.exports={select:"_3C0SbiQqjs3fZQjiw1yHWo"}},3655:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(137),a(3),a(11),a(6),a(67),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(74),a(66),a(72),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(137),a(31),a(3),a(11),a(6),a(67),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(74),a(66),a(72),a(7);var u,l=n(a(318)),c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=a(192),v=n(a(808)),y=n(a(977)),g=n(a(814)),E=n(a(811)),_=o(a(807)),b=a(56),S=a(874),k=n(a(468));function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var R=(0,_.default)({store:new k.default,module:"apps",authKey:"app-templates",name:"APP_TEMPLATE",rowKey:"app_id"})(u=function(e){(0,f.default)(a,e);var r=P(a);function a(){var e;(0,s.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).getData=function(t){e.props.store.fetchList(w({workspace:e.workspace,statistics:!0},t))},e.showCreate=function(){e.props.trigger("openpitrix.template.create",{success:e.showUpload})},e.showUpload=function(){e.props.trigger("openpitrix.template.upload",{workspace:e.workspace,success:e.props.routing.query})},e.getColumns=function(){return[{title:t("NAME"),dataIndex:"app_id",render:function(t,r){var a=e.getAvatar(r.icon);return m.default.createElement(y.default,{isApp:!0,to:"/workspaces/".concat(e.workspace,"/apps/").concat(t),avatarType:"appIcon",avatar:a,iconLetter:r.name,iconSize:40,title:(0,b.getDisplayName)(r),desc:r.description})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"20%",render:function(e){return m.default.createElement(v.default,{type:e,name:(0,S.transferAppStatus)(e)})}},{title:t("LATEST_VERSION"),dataIndex:"latest_app_version.name",isHideable:!0,width:"20%"},{title:t("UPDATE_TIME_TCAP"),dataIndex:"update_time",isHideable:!0,width:"120",render:function(e,t){return(0,b.getLocalTime)(e||t.status_time).fromNow()}}]},e.getAvatar=function(t){var r=e.props.store.baseUrl;return String(t).startsWith("att-")?"/".concat(r,"/attachments/").concat(t,"?filename=raw"):t},e}return(0,i.default)(a,[{key:"render",value:function(){var e=this.props,t=e.bannerProps,r=e.tableProps;return m.default.createElement(_.ListPage,(0,l.default)({},this.props,{getData:this.getData,noWatch:!0}),m.default.createElement(g.default,(0,l.default)({},t,{tips:this.tips})),m.default.createElement(E.default,(0,l.default)({},r,{tableActions:this.tableActions,itemActions:this.itemActions,columns:this.getColumns(),searchType:"keyword"})))}},{key:"tips",get:function(){var e=this.props.enabledActions;return[{title:t("DEVELOP_APP_TITLE"),description:t("DEVELOP_APP_DESC"),operation:e.includes("create")?m.default.createElement(h.Button,{type:"flat",onClick:this.showUpload},t("UPLOAD_TEMPLATE")):null,closable:!1},{title:t("HOW_PUBLISH_APP_TITLE"),description:t("HOW_PUBLISH_APP_DESC")}]}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"itemActions",get:function(){return[]}},{key:"tableActions",get:function(){return w(w({},this.props.tableProps.tableActions),{},{onCreate:this.showCreate,selectActions:[]})}}]),a}(m.default.Component))||u;r.default=R},3657:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(137),a(3),a(11),a(6),a(67),a(37),a(20),a(51),a(14),a(8),a(13),a(9),a(4),a(21),a(16),a(29),a(10),a(46),a(66),a(198),a(7),a(44),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(137),a(31),a(3),a(11),a(6),a(67),a(37),a(20),a(27),a(51),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(21),a(16),a(40),a(29),a(10),a(46),a(66),a(198),a(7),a(44);var u=n(a(318)),l=n(a(32)),c=n(a(42));a(36);var s,i=n(a(43)),f=n(a(25)),d=n(a(28)),p=n(a(38)),m=n(a(39)),h=n(a(35)),v=n(a(0)),y=a(250),g=n(a(809)),E=n(a(164)),_=n(a(803)),b=n(a(808)),S=n(a(814)),k=n(a(811)),O=o(a(807)),w=n(a(1184));function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,m.default)(this,r)}}var D=(0,O.default)({store:new w.default,module:"repos",authKey:"app-repos",name:"APP_REPOSITORY",rowKey:"repo_id"})(s=function(e){(0,p.default)(a,e);var r=C(a);function a(){var e;(0,f.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).handleIndex=(0,i.default)(c.default.mark((function r(){return c.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Promise.all(e.props.store.list.selectedRowKeys.map(function(){var r=(0,i.default)(c.default.mark((function r(a){var n;return c.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.props.store.index({repo_id:a,workspace:e.workspace});case 2:n=r.sent,"success"===n.message&&E.default.success(t("UPDATE_SUCCESSFUL"));case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()));case 2:e.props.store.setSelectRowKeys([]);case 3:case"end":return r.stop()}}),r)}))),e.getColumns=function(){return[{title:t("NAME"),dataIndex:"name",width:"25%",render:function(t,r){return v.default.createElement(_.default,{icon:"catalog",iconSize:40,title:t,desc:r.description||"-",to:"".concat(e.props.match.url,"/").concat(r.repo_id)})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"15%",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"syncing";return v.default.createElement(b.default,{type:e,name:t("APP_REPO_STATUS_".concat(e.toUpperCase())),flicker:!0})}},{title:t("URL"),dataIndex:"url"}]},e.handleFetch=(0,g.default)((function(t){var r=e.props,a=r.store,n=r.getData;if(!a.list.isLoading)return n(R(R(R({},(0,y.parse)(location.search.slice(1))),t),{},{silent:!0}))}),1e3),e.handleWatch=function(t){"HelmRepo"===t.object.kind&&["MODIFIED","DELETED","ADDED"].includes(t.type)&&e.handleFetch()},e}return(0,d.default)(a,[{key:"render",value:function(){var e=this.props,r=e.bannerProps,a=e.tableProps;return v.default.createElement(O.ListPage,(0,u.default)({},this.props,{onMessage:this.handleWatch}),v.default.createElement(S.default,(0,u.default)({},r,{tips:this.tips,title:t("APP_REPO"),description:t("APP_REPO_DESC")})),v.default.createElement(k.default,(0,u.default)({},a,{tableActions:this.tableActions,itemActions:this.itemActions,columns:this.getColumns(),searchType:"keyword"})))}},{key:"tips",get:function(){return[{title:t("HOW_TO_USE_APP_REPO_Q"),description:t.html("HOW_TO_USE_APP_REPO_A")}]}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"itemActions",get:function(){var e=this,r=this.props,a=r.trigger,n=r.name,o=r.routing;return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:function(t){return a("openpitrix.repo.edit",{detail:t,workspace:e.workspace,success:o.query})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{detail:e,type:n,success:o.query})}}]}},{key:"tableActions",get:function(){var e=this,r=this.props,a=r.trigger,n=r.routing;return R(R({},r.tableProps.tableActions),{},{searchType:"keyword",actions:[{key:"create",type:"control",text:t("ADD"),action:"manage",onClick:function(){return a("openpitrix.repo.add",{workspace:e.workspace,success:n.query})}}],selectActions:[{key:"index",type:"primary",text:t("SYNC"),action:"manage",onClick:this.handleIndex}]})}}]),a}(v.default.Component))||s;r.default=D},3658:function(e,t,r){"use strict";r(17);var a=r(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(3659)),o=a(r(3665)),u=a(r(3667)),l=a(r(3690)),c="/workspaces/:workspace",s=[{path:"".concat(c,"/members/:name"),component:n.default},{path:"".concat(c,"/roles/:name"),component:o.default},{path:"".concat(c,"/apps/:appId"),component:u.default},{path:"".concat(c,"/repos/:repo_id"),component:l.default}];t.default=s},3659:function(e,r,a){"use strict";var n=a(19);a(12),a(3),a(11),a(6),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(66),a(7);var o,u=n(a(318)),l=n(a(32)),c=n(a(25)),s=n(a(28)),i=n(a(38)),f=n(a(39)),d=n(a(35)),p=n(a(0)),m=a(18),h=a(245),v=n(a(69)),y=a(192),g=a(805),E=n(a(325)),_=n(a(443)),b=n(a(904)),S=n(a(3660));function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,f.default)(this,r)}}var P=(0,h.inject)("rootStore")(o=(0,h.observer)(o=(0,g.trigger)(o=function(e){(0,i.default)(a,e);var r=w(a);function a(){var e;(0,c.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).store=new E.default,e.workspaceStore=new _.default,e.fetchData=function(){e.store.fetchDetail(e.props.match.params)},e.getOperations=function(){return[{key:"delete",icon:"trash",text:t("REMOVE"),action:"delete",type:"danger",show:e.store.detail.name!==globals.user.username,onClick:function(){return e.trigger("member.remove",O({detail:(0,m.toJS)(e.store.detail),success:function(){return e.routing.push(e.listUrl)}},e.props.match.params))}}]},e.getAttrs=function(){var r=(0,m.toJS)(e.store.detail);if(!(0,v.default)(r))return[{name:t("WORKSPACE"),value:e.workspace},{name:t("WORKSPACE_ROLE"),value:r.workspacerole},{name:t("EMAIL"),value:r.email}]},e}return(0,s.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e={detailStore:this.store,workspaceStore:this.workspaceStore};if(this.store.isLoading&&!this.store.detail.name)return p.default.createElement(y.Loading,{className:"ks-page-loading"});var r={module:this.module,authKey:this.authKey,name:this.store.detail.name,desc:this.store.detail.email,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("WORKSPACE_MEMBER_PL"),url:this.listUrl}]};return p.default.createElement(b.default,(0,u.default)({stores:e,routes:S.default},r))}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"module",get:function(){return this.store.module}},{key:"authKey",get:function(){return"members"}},{key:"name",get:function(){return"WORKSPACE_MEMBER"}},{key:"listUrl",get:function(){return"/workspaces/".concat(this.workspace,"/members")}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),a}(p.default.Component))||o)||o)||o;r.default=P},3660:function(e,t,r){"use strict";r(17);var a=r(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(319),o=a(r(3661)),u=a(r(3663)),l="/workspaces/:workspace/members/:name",c=[{path:"".concat(l,"/projects"),title:"PROJECT_PL",component:o.default,exact:!0},{path:"".concat(l,"/devops"),title:"DEVOPS_PROJECT_PL",component:u.default,ksModule:"devops",exact:!0},(0,n.getIndexRoute)({path:l,to:"".concat(l,"/projects"),exact:!0})];t.default=c},3661:function(e,r,a){"use strict";var n=a(19);a(12),a(3),a(11),a(6),a(20),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(20),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(66),a(7);var o,u,l=n(a(318)),c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(45)),h=n(a(0)),v=a(18),y=a(245),g=a(56),E=n(a(1220)),_=n(a(824)),b=n(a(441)),S=n(a(3662));function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var P=(0,y.inject)("detailStore","workspaceStore")(o=(0,y.observer)((u=function(e){(0,f.default)(a,e);var r=w(a);function a(){var e;(0,s.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).projectStore=new b.default,e.getColumns=function(){return[{title:t("NAME"),dataIndex:"name",width:"33%",render:function(e,t){return(0,g.getDisplayName)(t)}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",width:"33%",render:function(e){return h.default.createElement("p",null,(0,g.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"))}}]},e.getData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.projectStore.fetchListByUser(O({workspace:e.workspace,cluster:e.workspaceStore.cluster,username:e.props.detailStore.detail.name},t))},e.handleClusterChange=function(t){e.workspaceStore.selectCluster(t),e.getData()},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.workspaceStore.fetchClusters({workspace:this.workspace,limit:-1}).then((function(){e.getData()}))}},{key:"render",value:function(){var e=(0,v.toJS)(this.projectStore.list),r=e.data,a=e.page,n=e.limit,o=e.total,u=e.isLoading,c=e.filters,s={page:a,limit:n,total:o};return h.default.createElement(_.default,{title:t("PROJECTS")},h.default.createElement(E.default,(0,l.default)({className:S.default.table,data:r,columns:this.getColumns(),isLoading:u||this.workspaceStore.clusters.isLoading,onFetch:this.getData,pagination:s},this.clusterProps,{name:"PROJECT",hideSearch:!0,hideCustom:!0,filters:c})))}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data.map((function(e){return{label:e.name,value:e.name,disabled:!e.isReady,cluster:e}}))}},{key:"workspaceStore",get:function(){return this.props.workspaceStore}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"clusterProps",get:function(){return{clusters:this.clusters,cluster:this.workspaceStore.cluster,onClusterChange:this.handleClusterChange,showClusterSelect:globals.app.isMultiCluster}}}]),a}(h.default.Component),(0,m.default)(u.prototype,"clusters",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"clusters"),u.prototype),o=u))||o)||o;r.default=P},3662:function(e,t,r){e.exports={table:"WRBc98bwWPsApBMpVDYJk"}},3663:function(e,r,a){"use strict";var n=a(19);a(12),a(3),a(11),a(6),a(20),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(20),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(66),a(7);var o,u,l=n(a(318)),c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(45)),h=n(a(0)),v=a(18),y=a(245),g=a(56),E=n(a(1220)),_=n(a(824)),b=n(a(332)),S=n(a(3664));function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var P=(0,y.inject)("detailStore","workspaceStore")(o=(0,y.observer)((u=function(e){(0,f.default)(a,e);var r=w(a);function a(){var e;(0,s.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).devopsStore=new b.default,e.getColumns=function(){return[{title:t("NAME"),dataIndex:"name",width:"33%",render:function(e,t){return(0,g.getDisplayName)(t)}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",width:"33%",render:function(e){return h.default.createElement("p",null,(0,g.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"))}}]},e.getData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.devopsStore.fetchListByUser(O({workspace:e.workspace,cluster:e.workspaceStore.cluster,username:e.props.detailStore.detail.name},t))},e.handleClusterChange=function(t){e.workspaceStore.selectCluster(t),e.getData({filters:{cluster:t}})},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.workspaceStore.fetchClusters({workspace:this.workspace,limit:-1}).then((function(){e.getData()}))}},{key:"render",value:function(){var e=(0,v.toJS)(this.devopsStore.list),r=e.data,a=e.isLoading,n=e.page,o=e.limit,u=e.total,c=e.filters,s={page:n,limit:o,total:u};return h.default.createElement(_.default,{title:t("DEVOPS_PROJECTS")},h.default.createElement(E.default,(0,l.default)({className:S.default.table,data:r,columns:this.getColumns(),isLoading:a,onFetch:this.getData},this.clusterProps,{pagination:s,name:"DEVOPS_PROJECT",hideSearch:!0,hideCustom:!0,filters:c})))}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data.map((function(e){return{label:e.name,value:e.name,disabled:!e.isReady,cluster:e}}))}},{key:"workspaceStore",get:function(){return this.props.workspaceStore}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"clusterProps",get:function(){return{clusters:this.clusters,cluster:this.workspaceStore.cluster,onClusterChange:this.handleClusterChange,showClusterSelect:globals.app.isMultiCluster}}}]),a}(h.default.Component),(0,m.default)(u.prototype,"clusters",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"clusters"),u.prototype),o=u))||o)||o;r.default=P},3664:function(e,t,r){e.exports={table:"_1igO6MeCqz0zQKLfLayoUI"}},3665:function(e,r,a){"use strict";a(17);var n=a(19);a(12),a(137),a(3),a(67),a(51),a(14),a(4),a(16),a(29),a(10),a(74),a(66),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(137),a(31),a(3),a(67),a(27),a(51),a(30),a(14),a(4),a(16),a(40),a(29),a(10),a(74),a(66);var o,u=n(a(318)),l=n(a(25)),c=n(a(28)),s=n(a(38)),i=n(a(39)),f=n(a(35)),d=n(a(0)),p=a(18),m=a(245),h=n(a(69)),v=a(192),y=a(56),g=a(805),E=n(a(324)),_=n(a(904)),b=n(a(3666));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var k=(0,m.inject)("rootStore")(o=(0,m.observer)(o=(0,g.trigger)(o=function(e){(0,s.default)(a,e);var r=S(a);function a(){var e;(0,l.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).store=new E.default("workspaceroles"),e.fetchData=function(){e.store.fetchDetail(e.props.match.params)},e.getOperations=function(){return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",show:e.showEdit,onClick:function(){return e.trigger("resource.baseinfo.edit",{type:e.name,detail:(0,p.toJS)(e.store.detail),success:e.fetchData})}},{key:"editRole",icon:"pen",text:t("EDIT_PERMISSIONS"),action:"edit",show:e.showEdit,onClick:function(){return e.trigger("role.edit",{module:e.module,detail:(0,p.toJS)(e.store.detail),roleTemplates:(0,p.toJS)(e.store.roleTemplates.data),roleModules:(0,p.toJS)(e.store.roleCategory),success:e.fetchData})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",type:"danger",show:e.showEdit,onClick:function(){return e.trigger("role.delete",{type:e.name,detail:(0,p.toJS)(e.store.detail),workspace:e.props.match.params.workspace,success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var r=(0,p.toJS)(e.store.detail);if(!(0,h.default)(r))return[{name:t("CREATION_TIME_TCAP"),value:(0,y.getLocalTime)(r.createTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:r.creator}]},e}return(0,c.default)(a,[{key:"componentDidMount",value:function(){this.fetchData(),this.store.fetchRoleTemplates("workspace"),this.store.fetchTemplatesCategory("workspace")}},{key:"render",value:function(){var e={detailStore:this.store};if(this.store.isLoading&&!this.store.detail.name)return d.default.createElement(v.Loading,{className:"ks-page-loading"});var r={module:this.module,authKey:this.authKey,name:this.store.detail.name,desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("WORKSPACE_ROLE_PL"),url:this.listUrl}]};return d.default.createElement(_.default,(0,u.default)({stores:e,routes:b.default},r))}},{key:"module",get:function(){return this.store.module}},{key:"authKey",get:function(){return"roles"}},{key:"name",get:function(){return"WORKSPACE_ROLE"}},{key:"listUrl",get:function(){var e=this.props.match.params.workspace;return"/workspaces/".concat(e,"/roles")}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"showEdit",get:function(){var e=this.props.match.params,t=e.workspace,r=e.name;return!globals.config.presetWorkspaceRoles.includes(r.slice(t.length+1))}}]),a}(d.default.Component))||o)||o)||o;r.default=k},3666:function(e,t,r){"use strict";r(17);var a=r(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(319),o=a(r(1076)),u=a(r(1077)),l="/workspaces/:workspace/roles/:name",c=[{path:"".concat(l,"/authorizations"),title:"PERMISSION_PL",component:o.default,exact:!0},{path:"".concat(l,"/users"),title:"AUTHORIZED_USER_PL",component:u.default,exact:!0},(0,n.getIndexRoute)({path:l,to:"".concat(l,"/authorizations"),exact:!0})];t.default=c},3667:function(e,r,a){"use strict";var n=a(19);a(12),a(137),a(3),a(11),a(6),a(14),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(66),a(71),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(137),a(31),a(3),a(11),a(6),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(66),a(71),a(7);var o,u=n(a(318)),l=n(a(32)),c=n(a(25)),s=n(a(28)),i=n(a(38)),f=n(a(39)),d=n(a(35)),p=n(a(0)),m=a(18),h=a(245),v=n(a(26)),y=a(192),g=a(805),E=n(a(904)),_=n(a(827)),b=n(a(468)),S=n(a(891)),k=a(874),O=a(56),w=n(a(3668)),P=n(a(3689));function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,f.default)(this,r)}}var T=(0,h.inject)("rootStore")(o=(0,h.observer)(o=(0,g.trigger)(o=function(e){(0,i.default)(a,e);var r=D(a);function a(){var e;(0,c.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).store=new b.default,e.versionStore=new S.default,e.fetchData=function(){e.store.fetchDetail(e.props.match.params)},e.getOperations=function(){var r=(0,m.toJS)(e.store.detail);return[{key:"editApp",type:"control",text:t("EDIT"),action:"manage",onClick:function(){return e.trigger("openpitrix.template.edit",{detail:r,title:t("EDIT_INFORMATION"),description:t("EDIT_APP_DESC"),icon:"pen",success:function(){return e.fetchData()}})}},{key:"appDeploy",icon:"snapshot",text:t("INSTALL"),action:"manage",onClick:function(){return e.trigger("openpitrix.template.deploy",C(C({},e.props.match.params),{},{app:r}))}},{key:"addVersion",icon:"tag",text:t("UPLOAD_NEW_VERSION"),action:"manage",onClick:function(){return e.trigger("openpitrix.template.addVersion",{title:t("UPLOAD_NEW_VERSION"),description:t("UPLOAD_NEW_VERSION_DESC"),icon:"templet",appId:r.app_id,type:"ADD_VERSION",workspace:r.workspace,versionStore:e.versionStore,success:function(){return e.fetchData()}})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"manage",onClick:function(){return e.trigger("openpitrix.template.delete",{detail:r,versions:e.versionStore.list.data,success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var r=(0,m.toJS)(e.store.detail),a=(0,v.default)(r,"create_time",new Date);return[{name:t("STATUS"),value:(0,k.transferAppStatus)(r.status)},{name:t("TYPE"),value:(0,k.getVersionTypesName)((0,v.default)(r,"app_version_types",""))},{name:t("CATEGORY"),value:t("APP_CATE_".concat((0,k.getAppCategoryNames)((0,v.default)(r,"category_set",[])).toUpperCase().replace(/[^A-Z]+/g,"_")),{defaultValue:(0,k.getAppCategoryNames)((0,v.default)(r,"category_set",[]))})},{name:t("WORKSPACE"),value:(0,v.default)(r,"isv","-")},{name:t("CREATION_TIME_TCAP"),value:(0,O.getLocalTime)(a).format("YYYY-MM-DD HH:mm:ss")}]},e.renderIcon=function(){var t=e.store.detail;return p.default.createElement("div",{className:P.default.appName},p.default.createElement(_.default,{iconSize:32,iconLetter:t.name,src:t.icon,alt:""}))},e}return(0,s.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e={detailStore:this.store,versionStore:this.versionStore};if(this.store.isLoading&&!this.store.detail.name)return p.default.createElement(y.Loading,{className:"ks-page-loading"});var r={icon:this.renderIcon(),module:this.module,authKey:this.authKey,name:this.store.detail.name,desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("APP_TEMPLATE_PL"),url:this.listUrl}]};return p.default.createElement(E.default,(0,u.default)({stores:e,routes:w.default},r))}},{key:"module",get:function(){return this.store.module}},{key:"authKey",get:function(){return"app-templates"}},{key:"name",get:function(){return"APP"}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"listUrl",get:function(){return"/workspaces/".concat(this.workspace,"/apps")}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),a}(p.default.Component))||o)||o)||o;r.default=T},3668:function(e,t,r){"use strict";r(17);var a=r(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(319),o=a(r(3669)),u=a(r(3670)),l=a(r(3673)),c=a(r(3688)),s="/workspaces/:workspace/apps/:appId",i=[{path:"".concat(s,"/versions"),title:"VERSIONS",component:l.default,exact:!0},{path:"".concat(s,"/app-information"),title:"APP_INFORMATION",component:o.default,exact:!0},{path:"".concat(s,"/audit-records"),title:"APP_REVIEW",component:u.default,exact:!0},{path:"".concat(s,"/app-instances"),title:"APP_INSTANCES",component:c.default,exact:!0},(0,n.getIndexRoute)({path:s,to:"".concat(s,"/versions"),exact:!0})];t.default=i},3669:function(e,r,a){"use strict";a(17);var n=a(19);a(4),a(16),a(29),a(10),a(66),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(30),a(4),a(16),a(40),a(29),a(10),a(66);var o,u=n(a(25)),l=n(a(28)),c=n(a(38)),s=n(a(39)),i=n(a(35)),f=n(a(0)),d=a(245),p=a(18),m=n(a(26)),h=n(a(802)),v=n(a(1465));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var g=(0,d.inject)("detailStore","versionStore")(o=(0,d.observer)(o=function(e){(0,c.default)(a,e);var r=y(a);function a(){return(0,u.default)(this,a),r.apply(this,arguments)}return(0,l.default)(a,[{key:"componentDidMount",value:function(){var e=(0,m.default)(this.props.match,"params.appId","");0===(0,m.default)(this.props.versionStore,"list.data",[]).length&&this.props.versionStore.fetchList({app_id:e})}},{key:"render",value:function(){var e=(0,m.default)(this.props.detailStore,"detail",{}),r=(0,m.default)(this.props.versionStore,"list.data",[]);return f.default.createElement(h.default,{title:t("APP_INFORMATION")},f.default.createElement(v.default,{app:e,versions:(0,p.toJS)(r)}))}}]),a}(f.default.Component))||o)||o;r.default=g},3670:function(e,r,a){"use strict";var n=a(19),o=a(163);a(12),a(3),a(11),a(6),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(27),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(66),a(7);var u,l=n(a(318)),c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=n(a(811)),v=o(a(807)),y=n(a(1221)),g=n(a(1591)),E=a(56),_=n(a(3672));function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var O=(0,v.default)({store:new g.default,module:"apps",name:"RELEASE_RECORD",rowKey:"status_time"})(u=function(e){(0,f.default)(a,e);var r=k(a);function a(){var e;(0,s.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).getData=function(t){var r=e.props.match.params.appId;e.props.store.fetchList(S({app_id:r},t))},e.getColumns=function(){return[{title:t("TIME"),dataIndex:"status_time",width:"20%",render:function(e){return(0,E.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"15%",render:function(e){return m.default.createElement(y.default,{type:e,name:e})}},{title:t("VERSION"),dataIndex:"version_name",isHideable:!0,width:"15%"},{title:t("REJECTION_REASON"),key:"reject",isHideable:!0,width:"40%",render:function(e,t){return t.message||"-"}},{title:t("OPERATOR"),dataIndex:"operator",isHideable:!0,width:"10%"}]},e}return(0,i.default)(a,[{key:"render",value:function(){var e=this.props.tableProps;return m.default.createElement(v.ListPage,(0,l.default)({},this.props,{getData:this.getData,noWatch:!0}),m.default.createElement("div",{className:_.default.title},t("APP_REVIEW")),m.default.createElement(h.default,(0,l.default)({},e,{tableActions:this.tableActions,itemActions:[],columns:this.getColumns(),hideSearch:!0})))}},{key:"tableActions",get:function(){return S(S({},this.props.tableProps.tableActions),{},{onCreate:null,selectActions:[]})}}]),a}(m.default.Component))||u;r.default=O},3671:function(e,t,r){e.exports={status:"A5rVBP55qeIAO91DaF9Yv",icon:"_1oXA-t3U_cCctqjXsQnXv7",draft:"_14HEzQmww9_9HawfVhm7CE",review:"_2OGhlK9n82bUF5ehbn7lm8",passed:"_1morbl3ceK_aX-QMXaNMya",suspended:"_1IMQRXNvIYz50xJYrs2BTg",substract:"_2B7Wxt5CSW2JbBvP2gqqUH",deleted:"_1uXd24XYFfycfU5NlCnJYG"}},3672:function(e,t,r){e.exports={wrapper:"MVdLzzHokdMzDHMJ9cEh8",title:"_2HWYuhPBoqwON9OjfDPkrb"}},3673:function(e,t,r){"use strict";r(17);var a=r(19);r(4),r(16),r(29),r(10),r(66),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31),r(30),r(4),r(16),r(40),r(29),r(10),r(66);var n,o=a(r(25)),u=a(r(28)),l=a(r(38)),c=a(r(39)),s=a(r(35)),i=a(r(0)),f=r(245),d=a(r(3674));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var m=(0,f.inject)("detailStore","versionStore","workspaceStore")(n=function(e){(0,l.default)(r,e);var t=p(r);function r(){return(0,o.default)(this,r),t.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,t=e.detailStore,r=e.versionStore,a=e.workspaceStore,n=e.match;return i.default.createElement(d.default,{appStore:t,versionStore:r,clusters:a.clusters.data,match:n})}}]),r}(i.default.Component))||n;t.default=m},3674:function(e,r,a){"use strict";var n=a(19);a(12),a(11),a(6),a(67),a(20),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(74),a(66),a(198),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(11),a(6),a(67),a(20),a(27),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(74),a(66),a(198),a(7);var o,u,l,c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=a(245),v=n(a(1)),y=n(a(69)),g=n(a(26)),E=a(192),_=n(a(164)),b=n(a(802)),S=n(a(1461)),k=a(331),O=n(a(3675)),w=n(a(1594));function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var D=(0,h.observer)((l=u=function(e){(0,f.default)(a,e);var r=C(a);function a(e){var n;return(0,s.default)(this,a),(n=r.call(this,e)).fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.props.match.params,r=t.appId,a=t.workspace,o=n.props.appStore.isAdmin,u=o?k.STORE_QUERY_STATUS:n.store.defaultStatus;n.store.fetchList(R({app_id:r,workspace:a,status:u},e))},n.getPagination=function(){var e=n.store.list;return{page:e.page,limit:e.limit,total:e.total}},n.handleExpandExtra=function(e){var t=(0,g.default)(n.store,"list.data",[]);n.store.list.data=t.map((function(t){return R(R({},t),{},{isExpand:t.version_id===e&&!t.isExpand})}))},n.handleSearch=function(e){n.searchValue=e,n.fetchData({keyword:e})},n.handleRefresh=function(){var e=n.searchValue?{keyword:n.searchValue}:{};n.fetchData(e)},n.handlePage=function(e){n.fetchData({page:e})},n.addVersion=function(){return n.setState({uploadModal:!0})},n.hideModal=function(){return n.setState({uploadModal:!1})},n.handleCreate=function(e){n.store.create(e).then((function(){n.setState({uploadModal:!1}),_.default.success({content:t("CREATE_SUCCESSFUL")}),n.fetchData()}))},n.renderHeader=function(){var e=n.props.appStore.isAdmin;return m.default.createElement("div",{className:w.default.header},m.default.createElement(E.InputSearch,{className:w.default.search,name:"search",placeholder:t("SEARCH_BY_NAME"),onSearch:n.handleSearch}),m.default.createElement("div",{className:w.default.actions},m.default.createElement(E.Button,{type:"flat",icon:"refresh",onClick:n.handleRefresh}),!e&&n.enabledActions.includes("manage")&&m.default.createElement(E.Button,{onClick:n.addVersion},t("UPLOAD_NEW_VERSION")," ")))},n.renderFooter=function(){var e=n.getPagination(),r=e.total,a=e.page,o=e.limit;return m.default.createElement(E.Level,{className:w.default.footer},m.default.createElement(E.LevelLeft,null,t("TOTAL_ITEMS",{num:r})),m.default.createElement(E.LevelRight,null,m.default.createElement(E.Pagination,{page:a,total:r,limit:o,onChange:n.handlePage})))},n.state={uploadModal:!1},n.store=n.props.versionStore,n}return(0,i.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"renderContent",value:function(){var e=this,r=this.store.list,a=r.data,n=r.isLoading,o=this.props,u=o.match.params,l=o.appStore,c=o.clusters,s=l.isAdmin,i=l.detail||{};return n?m.default.createElement(E.Loading,{className:w.default.loading}):m.default.createElement("div",{className:w.default.body},(0,y.default)(a)?m.default.createElement("div",{className:w.default.empty},t("NO_RESOURCE_FOUND")):a.map((function(t){return m.default.createElement(O.default,{key:t.version_id,isAdmin:s,appDetail:i,detail:t,params:u,store:e.store,appStore:l,clusters:c,enabledActions:e.enabledActions,handleExpandExtra:e.handleExpandExtra})})))}},{key:"renderModals",value:function(){var e=this.props.match.params,r=e.appId,a=e.workspace,n=this.store.isSubmitting;return m.default.createElement("div",null,m.default.createElement(S.default,{title:t("UPLOAD_NEW_VERSION"),description:t("UPLOAD_NEW_VERSION_DESC"),icon:"templet",visible:this.state.uploadModal,appId:r,workspace:a,isSubmitting:n,type:"ADD_VERSION",onOk:this.handleCreate,onCancel:this.hideModal}))}},{key:"render",value:function(){var e=this.props,r=e.hideHeader,a=e.hideFooter;return m.default.createElement(b.default,{className:w.default.main,title:t("VERSIONS")},m.default.createElement("div",{className:w.default.inner},!r&&this.renderHeader(),this.renderContent(),!a&&this.renderFooter(),this.renderModals()))}},{key:"enabledActions",get:function(){return this.props.match.params.workspace?globals.app.getActions({workspace:this.props.match.params.workspace,module:"app-templates"}):["manage"]}}]),a}(m.default.Component),u.propTypes={versionStore:v.default.object,appStore:v.default.object,match:v.default.object,hideHeader:v.default.bool,hideFooter:v.default.bool,onSearch:v.default.func,onRefresh:v.default.func,onPage:v.default.func},u.defaultProps={versionStore:{},appStore:{},match:{},hideHeader:!1,hideFooter:!1,onSearch:function(){},onRefresh:function(){},onPage:function(){}},o=l))||o;r.default=D},3675:function(e,r,a){"use strict";var n=a(19);a(12),a(11),a(6),a(67),a(14),a(8),a(13),a(9),a(4),a(16),a(10),a(74),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(11),a(6),a(67),a(27),a(30),a(14),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(10),a(74),a(7);var o,u,l,c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=a(18),v=n(a(1)),y=n(a(5)),g=a(245),E=a(192),_=n(a(164)),b=n(a(823)),S=n(a(1463)),k=n(a(1221)),O=n(a(3676)),w=n(a(3678)),P=n(a(1592)),R=n(a(3681)),C=a(56),D=a(805),T=a(817),N=a(956),A=a(331),j=n(a(1594));function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var x=E.Tabs.TabPanel,U=(0,g.inject)("rootStore")(o=(0,D.trigger)((l=u=function(e){(0,f.default)(a,e);var r=L(a);function a(e){var n;return(0,s.default)(this,a),(n=r.call(this,e)).handleTabChange=function(e){n.setState({tab:e})},n.handleExpandExtra=function(){if(!n.isRadonDB){var e=n.props.detail;n.props.handleExpandExtra(e.version_id)}},n.showDeploy=function(){n.trigger("openpitrix.template.deploy",M(M({},n.props.params),{},{store:n.props.appStore,app:n.props.appDetail,versionId:n.props.detail.version_id}))},n.showDeleteModel=function(){n.setState({deleteShow:!0,handleType:"delete"})},n.showHandleModel=function(e){return function(){if("view"===e){var t=n.props.detail.app_id;n.props.rootStore.routing.push("/apps/".concat(t))}else"submit"===e?n.setState({submitShow:!0,handleType:"submit"}):n.setState({confirmShow:!0,handleType:e})}},n.hideHandleModal=function(){n.setState({deleteShow:!1,confirmShow:!1,submitShow:!1,appDeploy:!1})},n.deleteVersion=function(){var e=n.props.detail,r=e.version_id,a=e.app_id;n.store.delete({app_id:a,version_id:r}).then((function(){n.hideHandleModal(),_.default.success({content:t("DELETED_SUCCESSFULLY")}),n.store.fetchList({app_id:a})}))},n.handleVersion=function(){var e=n.props,r=e.detail,a=e.isAdmin,o=r.version_id,u=r.app_id,l=n.state.handleType,c={app_id:u,version_id:o,action:l};n.store.handle(c).then((function(){var e=N.HANDLE_TYPE_TO_SHOW[l]||l;n.hideHandleModal(),_.default.success({content:"".concat(t("".concat(e.toUpperCase(),"_SUCCESSFUL")))});var r=a?A.STORE_QUERY_STATUS:n.store.defaultStatus;N.APP_STORE_ACTIONS.includes(l)?n.props.appStore.fetchDetail({app_id:u}):n.store.fetchList({app_id:u,status:r})}))},n.handleSubmit=function(e){n.store.update(e).then((function(){n.handleVersion()}))},n.store=n.props.store,n.state={tab:"configFile",handleType:""},n.appId=e.detail.app_id,n}return(0,i.default)(a,[{key:"renderContent",value:function(){var e=this.props.detail;return m.default.createElement("div",{className:j.default.content},m.default.createElement("dl",null,m.default.createElement("dt",null,m.default.createElement(k.default,{type:e.status,noIcon:!0})),m.default.createElement("dd",null,t("STATUS"))),m.default.createElement("dl",null,m.default.createElement("dt",null,e.name),m.default.createElement("dd",null,t("VERSION"))),m.default.createElement("dl",null,m.default.createElement("dt",null,e.owner),m.default.createElement("dd",null,t("DEVELOPER"))),m.default.createElement("dl",null,m.default.createElement("dt",null,(0,C.getLocalTime)(e.update_time||e.status_time).format("YYYY-MM-DD HH:mm:ss")),m.default.createElement("dd",null,t("UPDATE_TIME_SCAP"))),!this.isRadonDB&&m.default.createElement("dl",{className:j.default.more},m.default.createElement(E.Icon,{name:"chevron-down",size:20})))}},{key:"renderVersionActions",value:function(){var e=this.props,r=e.isAdmin,a=e.enabledActions,n=this.props.detail.status,o=r?N.STATUS_TO_ACTION_ADMIN[n]:N.STATUS_TO_ACTION[n];return a.includes("manage")?m.default.createElement("div",{className:j.default.actions},N.CAN_DELETE_STATUS.includes(n)&&!r&&m.default.createElement(E.Button,{onClick:this.showDeleteModel,type:"danger"},t("DELETE")),!r&&m.default.createElement(E.Button,{onClick:this.showDeploy,type:"default"},t("INSTALL")),o&&m.default.createElement(E.Button,{onClick:this.showHandleModel(o),type:"control"},t(N.ACTION_TO_NAME[o]))):null}},{key:"renderExtraContent",value:function(){var e=this.props,r=e.detail,a=e.appDetail,n=e.clusters,o=this.state.tab;return m.default.createElement("div",{className:j.default.itemExtra},m.default.createElement(E.Tabs,{type:"button",activeName:o,onChange:this.handleTabChange},m.default.createElement(x,{label:t("CHART_FILES"),name:"configFile"},m.default.createElement(O.default,{appId:r.app_id,versionId:r.version_id,appName:a.name})),m.default.createElement(x,{label:t("APP_REVIEW"),name:"auditRecord"},m.default.createElement(w.default,{appId:r.app_id,versionId:r.version_id})),m.default.createElement(x,{label:t("APP_INSTANCES"),name:"deployInstances"},m.default.createElement(P.default,{title:t("APP_INSTANCES"),className:j.default.instances,appId:a.app_id,versionId:r.version_id,workspace:a.workspace,clusters:n}))),this.renderVersionActions())}},{key:"renderModals",value:function(){var e=this.props.detail,r=this.state.handleType;return m.default.createElement("div",null,m.default.createElement(S.default,{content:t.html("VERSION_".concat(r.toUpperCase(),"_TIP"),{name:e.name}),visible:this.state.confirmShow,onOk:this.handleVersion,onCancel:this.hideHandleModal,isSubmitting:this.store.isSubmitting}),m.default.createElement(b.default,{detail:e,desc:t.html("VERSION_".concat(r.toUpperCase(),"_TIP"),{name:e.name}),visible:this.state.deleteShow,onOk:this.deleteVersion,onCancel:this.hideHandleModal,isSubmitting:this.store.isSubmitting}),m.default.createElement(R.default,{visible:this.state.submitShow,onOk:this.handleSubmit,onCancel:this.hideHandleModal,isSubmitting:this.store.isSubmitting,detail:(0,h.toJS)(e)}))}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.detail;return m.default.createElement("div",{className:(0,y.default)(j.default.item,t,(0,c.default)({},j.default.expanded,r.isExpand))},m.default.createElement("div",{className:j.default.itemMain,onClick:this.handleExpandExtra},m.default.createElement("div",{className:j.default.icon},m.default.createElement(E.Icon,{name:"cloud",size:40}),m.default.createElement(k.default,{className:j.default.status,type:r.status,noName:!0})),this.renderContent()),r.isExpand&&this.renderExtraContent(),this.renderModals())}},{key:"isRadonDB",get:function(){return T.RadonDBAppIds.includes(this.appId)}}]),a}(m.default.PureComponent),u.propTypes={className:v.default.string,isAdmin:v.default.bool,appDetail:v.default.object,detail:v.default.object,params:v.default.object,store:v.default.object,appStore:v.default.object,handleExpandExtra:v.default.func,enabledActions:v.default.array},u.defaultProps={isAdmin:!1,appDetail:{},detail:{},params:{},store:{},appStore:{},enabledActions:[],handleExpandExtra:function(){}},o=l))||o)||o;r.default=U},3676:function(e,r,a){"use strict";a(17);var n=a(19);a(12),a(137),a(3),a(67),a(14),a(4),a(16),a(10),a(74),a(72),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(137),a(31),a(3),a(67),a(30),a(14),a(4),a(21),a(16),a(40),a(10),a(74),a(72);var o=n(a(42));a(36);var u,l,c,s=n(a(43)),i=n(a(25)),f=n(a(28)),d=n(a(38)),p=n(a(39)),m=n(a(35)),h=n(a(0)),v=a(245),y=n(a(1)),g=n(a(164)),E=n(a(1186)),_=n(a(891)),b=n(a(888)),S=a(956),k=n(a(3677));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,p.default)(this,r)}}var w=(0,v.observer)((c=l=function(e){(0,d.default)(a,e);var r=O(a);function a(e){var n;return(0,i.default)(this,a),(n=r.call(this,e)).fetchData=function(){var e=n.props,t=e.appId,r=e.versionId;t&&r&&n.store.fetchDetail({app_id:t,version_id:r})},n.getPackageName=function(){var e=n.props.appName,t=n.store.detail,r=t.package_name,a=t.name,o=void 0===a?"":a;return!r||r.startsWith("att-")?"".concat(e,"-").concat(o):r},n.modifyPackage=function(){var e=(0,s.default)(o.default.mark((function e(r){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.store.update(r);case 2:return g.default.success({content:"".concat(t("MODIFY_SUCCESSFUL"))}),e.next=5,n.fetchData();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.store=new _.default,n.fileStore=new b.default,n}return(0,f.default)(a,[{key:"hasPermission",get:function(){return globals.app.hasPermission({module:"app-templates",actions:["manage","edit"]})}}]),(0,f.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e){e.versionId!==this.props.versionId&&this.fetchData()}},{key:"renderUpdate",value:function(){var e=this.store.detail;return e.description?h.default.createElement("div",{className:k.default.updateInfo},h.default.createElement("div",{className:k.default.title},t("VERSION_INFO")),h.default.createElement("pre",null,e.description)):h.default.createElement("div",{className:k.default.updateInfo},h.default.createElement("pre",null,t("NO_VERSION_INFO_DESC")))}},{key:"render",value:function(){var e=this.store.detail;return h.default.createElement("div",{className:k.default.main},h.default.createElement(E.default,{fileStore:this.fileStore,onOk:this.modifyPackage,packageName:this.getPackageName(),updateTime:e.update_time||e.status_time,type:"MODIFY_VERSION",appId:e.app_id,versionId:e.version_id,canEdit:this.hasPermission&&S.CAN_EDIT_STATUS.includes(e.status),className:k.default.uploadInfo,hasPackage:!0}),this.renderUpdate())}}]),a}(h.default.Component),l.propTypes={appId:y.default.string,versionId:y.default.string,appName:y.default.string},l.defaultProps={appId:"",versionId:"",appName:""},u=c))||u;r.default=w},3677:function(e,t,r){e.exports={uploadInfo:"_2TBkOA6EPgHJSKY_LJ1A79",updateInfo:"_3lTlGecpAmXPFFP2lgjUc_",title:"_8_Kx8et880iMQA4lWLngM"}},3678:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(20),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(20),a(30),a(4),a(16),a(40),a(10);var o,u,l,c=n(a(25)),s=n(a(28)),i=n(a(38)),f=n(a(39)),d=n(a(35)),p=n(a(0)),m=a(245),h=n(a(1)),v=n(a(5)),y=n(a(69)),g=a(192),E=n(a(1221)),_=n(a(1591)),b=a(56),S=n(a(3679));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,f.default)(this,r)}}var O=(0,m.observer)((l=u=function(e){(0,i.default)(a,e);var r=k(a);function a(e){var t;return(0,c.default)(this,a),(t=r.call(this,e)).store=new _.default,t}return(0,s.default)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.appId,r=e.versionId;this.store.fetchList({app_id:t,version_id:r,noLimit:!0})}},{key:"renderItem",value:function(e,t){return p.default.createElement("ul",{key:"".concat(t,"-").concat(e.status_time)},p.default.createElement("li",null,p.default.createElement(E.default,{type:e.status,name:e.status})),p.default.createElement("li",null,e.operator),p.default.createElement("li",null,e.message||e.review_id||"-"),p.default.createElement("li",{className:S.default.time},(0,b.getLocalTime)(e.status_time).format("YYYY-MM-DD HH:mm:ss")))}},{key:"renderContent",value:function(){var e=this,r=this.store.list.data;return p.default.createElement("div",{className:S.default.itemMain},(0,y.default)(r)?p.default.createElement("div",{className:S.default.empty},t("NO_RESOURCE_FOUND")):r.map((function(t,r){return e.renderItem(t,r)})))}},{key:"render",value:function(){var e=this.props.className,t=this.store.list.isLoading;return p.default.createElement("div",{className:(0,v.default)(S.default.main,e)},t?p.default.createElement(g.Loading,{className:S.default.loading}):this.renderContent())}}]),a}(p.default.Component),u.propTypes={className:h.default.string,appId:h.default.string,versionId:h.default.string},u.defaultProps={appId:"",versionId:""},o=l))||o;r.default=O},3679:function(e,t,r){e.exports={main:"_38GTvlHNujNM1_aRIaIdJr",loading:"_86asWtZtb30MvWhILM9Ck",empty:"_2KqIYb9NCFfVzz6bj_gi6n",itemMain:"QQf-9K3jDaguGtq6kQ9Cd",time:"_2BsPSz4AdSNwEmjoj0PRAY"}},3680:function(e,r,a){"use strict";a(17);var n=a(19);a(14),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(30),a(14),a(4),a(16),a(40),a(10);var o=n(a(25)),u=n(a(28)),l=n(a(38)),c=n(a(39)),s=n(a(35)),i=n(a(0)),f=n(a(1)),d=n(a(5)),p=n(a(808)),m=a(56),h=n(a(1593));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var y=function(e){(0,l.default)(a,e);var r=v(a);function a(){return(0,o.default)(this,a),r.apply(this,arguments)}return(0,u.default)(a,[{key:"renderContent",value:function(){var e=this.props,r=e.detail,a=e.showVersion,n=r.version;return i.default.createElement("div",{className:h.default.content},i.default.createElement("dl",null,i.default.createElement("dt",null,r.name),i.default.createElement("dd",null,t("NAME"))),i.default.createElement("dl",null,i.default.createElement("dt",null,i.default.createElement(p.default,{className:h.default.status,type:r.status,name:t(r.status)})),i.default.createElement("dd",null,t("STATUS"))),a&&i.default.createElement("dl",null,i.default.createElement("dt",null,n.name),i.default.createElement("dd",null,t("VERSION"))),i.default.createElement("dl",null,i.default.createElement("dt",null,r.zone),i.default.createElement("dd",null,t("PROJECT"))),i.default.createElement("dl",null,i.default.createElement("dt",null,r.cluster||r.runtime_id),i.default.createElement("dd",null,t("CLUSTER"))),i.default.createElement("dl",null,i.default.createElement("dt",null,(0,m.getLocalTime)(r.upgrade_time||r.create_time).format("YYYY-MM-DD HH:mm:ss")),i.default.createElement("dd",null,t("CREATION_TIME"))))}},{key:"render",value:function(){var e=this.props.className;return i.default.createElement("div",{className:(0,d.default)(h.default.item,e)},i.default.createElement("div",{className:h.default.itemMain},this.renderContent()))}}]),a}(i.default.PureComponent);r.default=y,y.propTypes={className:f.default.string,detail:f.default.object,showVersion:f.default.bool},y.defaultProps={detail:{},showVersion:!1}},3681:function(e,r,a){"use strict";a(17);var n=a(19);a(194),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(194),a(30),a(4),a(21),a(16),a(40),a(10);var o=n(a(42));a(36);var u=n(a(43)),l=n(a(25)),c=n(a(28)),s=n(a(38)),i=n(a(39)),f=n(a(35)),d=n(a(0)),p=n(a(1)),m=n(a(70)),h=n(a(809)),v=n(a(246)),y=a(192),g=n(a(799)),E=n(a(1099)),_=n(a(3682)),b=n(a(3687));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var k=function(e){(0,s.default)(a,e);var r=S(a);function a(e){var t;return(0,l.default)(this,a),(t=r.call(this,e)).versionChange=(0,h.default)((function(e,r){(0,m.default)(t.props.detail,r,e)}),200),t.handleOk=(0,u.default)(o.default.mark((function e(){var r,a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.formRef.current,a=(0,v.default)(t.props.detail,["name","description","app_id","version_id"]),r&&r.validate((function(){return t.props.onOk(a)}));case 3:case"end":return e.stop()}}),e)}))),t.handleNext=function(){var e=_.default.length;t.setState((function(t){var r=t.currentStep;return{currentStep:Math.min(r+1,e-1)}}))},t.handlePrev=function(){t.setState((function(e){var t=e.currentStep,r=e.subRoute;return{currentStep:Math.max(t-1,0),subRoute:r}}))},t.formRef=d.default.createRef(),t.state={currentStep:0,formTemplate:e.formTemplate},t}return(0,c.default)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.visible,a=t.formTemplate;r&&r!==e.visible&&this.setState({currentStep:0,formTemplate:a})}},{key:"renderTabs",value:function(){var e=this.state.currentStep;return _.default.length<2?null:d.default.createElement("div",{className:b.default.tabs},d.default.createElement(E.default,{steps:_.default,current:e}))}},{key:"renderContent",value:function(){var e=this.state.currentStep,t=_.default[e].component;return t?"updateLog"===_.default[e].value?d.default.createElement("div",{className:b.default.content},d.default.createElement(t,{versionChange:this.versionChange,formData:this.props.detail,formRef:this.formRef})):d.default.createElement("div",{className:b.default.content},d.default.createElement(t,null)):null}},{key:"renderFooter",value:function(){var e=this.props.isSubmitting,r=this.state.currentStep,a=_.default||[],n=a.every((function(e,t){return!e.required||r>=t})),o=r<a.length-1;return d.default.createElement("div",{className:b.default.footer},r?d.default.createElement(y.Button,{type:"default",onClick:this.handlePrev},t("PREVIOUS")):null,o&&d.default.createElement(y.Button,{type:"control",onClick:this.handleNext},t("NEXT")),n&&d.default.createElement(y.Button,{type:"control",loading:e,disabled:e,onClick:this.handleOk},t("OK")))}},{key:"render",value:function(){var e=this.props,r=e.visible,a=e.onCancel;return d.default.createElement(g.default,{width:960,title:t("SUBMIT_FOR_REVIEW"),description:t("SUBMIT_REVIEW_DESC"),icon:"templet",bodyClassName:b.default.body,onCancel:a,visible:r,hideFooter:!0},d.default.createElement("div",null,this.renderTabs(),this.renderContent(),this.renderFooter()))}}]),a}(d.default.Component);r.default=k,k.propTypes={formTemplate:p.default.object,detail:p.default.object,visible:p.default.bool,isSubmitting:p.default.bool,onOk:p.default.func,onCancel:p.default.func},k.defaultProps={formTemplate:{},detail:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},3682:function(e,t,r){"use strict";r(17);var a=r(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(3683)),o=a(r(3685)),u=[{title:"TEST_STEPS",icon:"cdn",component:n.default,value:"testSteps",required:!0},{title:"UPDATE_LOG",icon:"update",component:o.default,value:"updateLog",required:!0}];t.default=u},3683:function(e,r,a){"use strict";a(17);var n=a(19);a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(30),a(4),a(16),a(40),a(10);var o,u,l,c=n(a(25)),s=n(a(28)),i=n(a(38)),f=n(a(39)),d=n(a(35)),p=n(a(0)),m=a(245),h=n(a(1)),v=n(a(891)),y=n(a(888)),g=n(a(3684));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,f.default)(this,r)}}var _=(0,m.observer)((l=u=function(e){(0,i.default)(a,e);var r=E(a);function a(e){var t;return(0,c.default)(this,a),(t=r.call(this,e)).state={},t.store=new v.default,t.fileStore=new y.default,t}return(0,s.default)(a,[{key:"render",value:function(){return p.default.createElement("div",{className:g.default.main},p.default.createElement("p",{className:g.default.note},t("VERSION_SUBMIT_NOTE")),p.default.createElement("div",{className:g.default.steps},t.html("VERSION_SUBMIT_TEST_STEPS")))}}]),a}(p.default.Component),u.propTypes={detail:h.default.object,appId:h.default.string,appName:h.default.string},u.defaultProps={detail:{},appId:"",appName:""},o=l))||o;r.default=_},3684:function(e,t,r){e.exports={main:"hFWh-mSL02iKI7WKdR_5l",note:"_2rSD6cuK5KVFAbsMqd0GqL",steps:"_2n7zO2w6NOvjkpI2oX-qrw",banLink:"_1kJpW6GW1QpubDrOBsrLGy"}},3685:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(30),a(4),a(16),a(40),a(10);var o,u,l,c=n(a(25)),s=n(a(28)),i=n(a(38)),f=n(a(39)),d=n(a(35)),p=n(a(0)),m=a(245),h=n(a(1)),v=a(192),y=a(61),g=n(a(3686));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,f.default)(this,r)}}var _=(0,m.observer)((l=u=function(e){(0,i.default)(a,e);var r=E(a);function a(){var e;(0,c.default)(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).handleChange=function(t,r){e.props.handleChange(t,r)},e}return(0,s.default)(a,[{key:"render",value:function(){var e=this,r=this.props,a=r.formData,n=r.formRef;return p.default.createElement(v.Form,{data:a,ref:n,className:g.default.editForm},p.default.createElement(v.Form.Item,{label:t("VERSION_NUMBER"),rules:[{required:!0,message:t("ENTER_VERSION_NUMBER_TIP")},{pattern:y.PATTERN_APPTEMPLATE_VERSION,message:t("INVALID_VERSION_TIP")}]},p.default.createElement(v.Input,{name:"name",autoFocus:!0,maxLength:30,onChange:function(t){return e.handleChange(t,"name")}})),p.default.createElement(v.Form.Item,{label:t("UPDATE_LOG"),desc:t("UPDATE_LOG_DESC")},p.default.createElement(v.TextArea,{name:"description",onChange:function(t){return e.handleChange(t,"description")}})))}}]),a}(p.default.Component),u.propTypes={formData:h.default.object,handleChange:h.default.func},u.defaultProps={formData:{},handleChange:function(){}},o=l))||o;r.default=_},3686:function(e,t,r){e.exports={editForm:"_3TQUkGWZsmTCWNtSyWo28f"}},3687:function(e,t,r){e.exports={body:"_1yBJEkjOyZax6iUKNs2ZjR",content:"_2wAy1hhb5zvoo1HyEOReik",footer:"_1gu2-SPZVczenZTAKg50A1",typeWrapper:"_10Telf9vCj8lRctNBxf3kE",type:"_2l6XbaMnVqIsUKpw-rt3f-",text:"_19XzP_QXK5InywFsshTNwB",bottomImage:"ZltLk9szDTBzU-0Jlm4vq"}},3688:function(e,t,r){"use strict";r(17);var a=r(19);r(4),r(16),r(29),r(10),r(66),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31),r(30),r(4),r(16),r(40),r(29),r(10),r(66);var n,o=a(r(25)),u=a(r(28)),l=a(r(38)),c=a(r(39)),s=a(r(35)),i=a(r(0)),f=r(245),d=a(r(1592));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var m=(0,f.inject)("workspaceStore")(n=function(e){(0,l.default)(r,e);var t=p(r);function r(){return(0,o.default)(this,r),t.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props.workspaceStore,t=this.props.match.params,r=t.appId,a=t.workspace;return i.default.createElement(d.default,{appId:r,workspace:a,clusters:e.clusters.data})}}]),r}(i.default.Component))||n;t.default=m},3689:function(e,t,r){e.exports={appName:"GsJ7ssUa6T4vB2JYEwVn4"}},3690:function(e,r,a){"use strict";a(17);var n=a(19);a(12),a(137),a(3),a(67),a(51),a(14),a(4),a(16),a(29),a(10),a(74),a(66),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(137),a(31),a(3),a(67),a(27),a(51),a(30),a(14),a(4),a(16),a(40),a(29),a(10),a(74),a(66);var o,u=n(a(318)),l=n(a(25)),c=n(a(28)),s=n(a(38)),i=n(a(39)),f=n(a(35)),d=n(a(0)),p=a(18),m=a(245),h=n(a(69)),v=a(192),y=a(56),g=a(805),E=n(a(1184)),_=n(a(904)),b=n(a(3691));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var k=(0,m.inject)("rootStore")(o=(0,m.observer)(o=(0,g.trigger)(o=function(e){(0,s.default)(a,e);var r=S(a);function a(){var e;(0,l.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).store=new E.default,e.fetchData=function(){e.store.fetchDetail(e.props.match.params)},e.getOperations=function(){return[{key:"edit",icon:"pen",type:"control",text:t("EDIT"),action:"edit",onClick:function(){return e.trigger("openpitrix.repo.edit",{detail:(0,p.toJS)(e.store.detail),workspace:e.workspace,success:e.fetchData})}},{key:"delete",icon:"trash",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){return e.trigger("resource.delete",{type:e.name,detail:(0,p.toJS)(e.store.detail),success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var r=(0,p.toJS)(e.store.detail);if(!(0,h.default)(r))return[{name:t("CREATION_TIME_TCAP"),value:(0,y.getLocalTime)(r.createTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:r.creator}]},e}return(0,c.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e={detailStore:this.store};if(this.store.isLoading&&!this.store.detail.name)return d.default.createElement(v.Loading,{className:"ks-page-loading"});var r={module:this.module,authKey:this.authKey,name:this.store.detail.name,desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("APP_REPOSITORY_PL"),url:this.listUrl}]};return d.default.createElement(_.default,(0,u.default)({stores:e,routes:b.default},r))}},{key:"module",get:function(){return this.store.module}},{key:"authKey",get:function(){return"app-repos"}},{key:"name",get:function(){return"APP_REPOSITORY"}},{key:"listUrl",get:function(){var e=this.props.match.params.workspace;return"/workspaces/".concat(e,"/repos")}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"showEdit",get:function(){var e=this.props.match.params,t=e.workspace,r=e.name;return!globals.config.presetWorkspaceRoles.includes(r.slice(t.length+1))}},{key:"workspace",get:function(){return this.props.match.params.workspace}}]),a}(d.default.Component))||o)||o)||o;r.default=k},3691:function(e,t,r){"use strict";r(17);var a=r(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(319),o=a(r(3692)),u="/workspaces/:workspace/repos/:repo_id",l=[{path:"".concat(u,"/events"),title:"EVENT_PL",component:o.default,exact:!0},(0,n.getIndexRoute)({path:u,to:"".concat(u,"/events"),exact:!0})];t.default=l},3692:function(e,r,a){"use strict";var n=a(19);a(12),a(11),a(6),a(8),a(13),a(9),a(4),a(16),a(29),a(10),a(66),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(11),a(6),a(27),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(16),a(40),a(29),a(10),a(66),a(7);var o,u=n(a(32)),l=n(a(25)),c=n(a(28)),s=n(a(38)),i=n(a(39)),f=n(a(35)),d=n(a(0)),p=a(18),m=a(245),h=a(192),v=n(a(802)),y=n(a(808)),g=a(56),E=n(a(3693));function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var S=(0,m.inject)("detailStore")(o=(0,m.observer)(o=function(e){(0,s.default)(a,e);var r=b(a);function a(e){var n;return(0,l.default)(this,a),(n=r.call(this,e)).getColumns=function(){return[{title:t("CREATION_TIME_TCAP"),dataIndex:"create_time",width:"24%",render:function(e){return(0,g.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{title:t("STATUS"),dataIndex:"status",width:"16%",render:function(e){return d.default.createElement(y.default,{type:e,name:t(e)})}},{title:t("MESSAGE"),dataIndex:"result",render:function(e){return e||"-"}}]},n.store=e.detailStore,n}return(0,c.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){this.store.fetchEvents(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,u.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.props.match.params))}},{key:"render",value:function(){var e=this.store.events,r=e.data,a=e.isLoading;return d.default.createElement(v.default,{title:t("EVENT_PL")},d.default.createElement(h.Table,{className:E.default.table,dataSource:(0,p.toJS)(r),columns:this.getColumns(),loading:a,rowKey:"create_time"}))}}]),a}(d.default.Component))||o)||o;r.default=S},3693:function(e,t,r){e.exports={table:"_3Csg6xeDZoaKp2IqfgJf9v"}},3694:function(e,t,r){"use strict";r(17);var a=r(19);r(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(11),r(4);var n=r(319),o=a(r(3695)),u=a(r(3697)),l=a(r(3710)),c=a(r(3713)),s="/workspaces/:workspace/overview",i=[{name:"usage",title:"RESOURCE_USAGE",component:u.default},{name:"ranking",title:"USAGE_RANKING",component:l.default},{name:"clusters",title:"CLUSTER_INFORMATION",component:c.default,multiCluster:!0}],f=[{path:s,component:o.default,routes:(0,n.getChildRoutes)(i.filter((function(e){return!e.multiCluster||globals.app.isMultiCluster})),s)}];t.default=f},3695:function(e,r,a){"use strict";a(17);var n=a(19);a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(30),a(4),a(16),a(40),a(10);var o,u=n(a(25)),l=n(a(28)),c=n(a(38)),s=n(a(39)),i=n(a(35)),f=n(a(0)),d=a(245),p=a(319),m=n(a(3696));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var v=(0,d.inject)("rootStore","workspaceStore")(o=(0,d.observer)(o=function(e){(0,c.default)(a,e);var r=h(a);function a(){return(0,u.default)(this,a),r.apply(this,arguments)}return(0,l.default)(a,[{key:"render",value:function(){return f.default.createElement("div",{className:m.default.wrapper},f.default.createElement("div",{className:m.default.main},(0,p.renderRoutes)(this.routes)))}},{key:"tips",get:function(){return[{title:t("HOW_TO_APPLY_MORE_CLUSTER_Q"),description:t("HOW_TO_APPLY_MORE_CLUSTER_A")}]}},{key:"routes",get:function(){return this.props.route.routes}}]),a}(f.default.Component))||o)||o;r.default=v},3696:function(e,t,r){e.exports={banner:"_3M6mEQMl67G4LdDB4x_1QL",main:"_34tJ8qtGKb0zosyG14u9HN"}},3697:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(20),a(14),a(4),a(16),a(29),a(10),a(66),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(20),a(30),a(14),a(4),a(16),a(40),a(29),a(10),a(66);var o,u=n(a(318)),l=n(a(25)),c=n(a(28)),s=n(a(38)),i=n(a(39)),f=n(a(35)),d=n(a(982)),p=n(a(845)),m=a(245),h=n(a(0)),v=a(56),y=n(a(3698)),g=n(a(3699)),E=n(a(3703)),_=n(a(3707));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,i.default)(this,r)}}var S=(0,m.inject)("rootStore","workspaceStore")(o=(0,m.observer)(o=function(e){(0,s.default)(a,e);var r=b(a);function a(){var e;(0,l.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).workspaceStore=e.props.workspaceStore,e.valueRenderer=function(e){return h.default.createElement("div",{title:e.label},t("CLUSTER_VALUE",{value:e.label}))},e.optionRenderer=function(e){return h.default.createElement("div",null,h.default.createElement("div",null,(0,v.getDomTitle)(e.label)),!e.cluster.isReady&&h.default.createElement("div",null,h.default.createElement(d.default,{data:e.cluster,noTip:!0})))},e.handleClusterChange=function(t){e.workspaceStore.selectCluster(t)},e}return(0,c.default)(a,[{key:"renderEmpty",value:function(){return h.default.createElement(p.default,{icon:"cluster",title:t("NO_CLUSTER_AVAILABLE"),desc:t("WORKSPACE_NO_CLUSTER_TIP")})}},{key:"render",value:function(){return h.default.createElement("div",null,!globals.app.isMultiCluster&&h.default.createElement(E.default,{workspace:this.workspace}),this.props.workspaceStore.clusters.data.length>0?h.default.createElement(h.default.Fragment,null,h.default.createElement(g.default,(0,u.default)({workspace:this.workspace},this.clusterProps)),h.default.createElement(_.default,(0,u.default)({workspace:this.workspace},this.clusterProps))):this.renderEmpty())}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data}},{key:"clustersOpts",get:function(){return this.clusters.map((function(e){return{label:(0,v.getDisplayNameNew)(e),value:e.name,disabled:!e.isReady,cluster:e}}))}},{key:"clusterProps",get:function(){return{className:y.default.clusterSelector,cluster:this.workspaceStore.cluster,options:this.clustersOpts,onChange:this.handleClusterChange,valueRenderer:this.valueRenderer,optionRenderer:this.optionRenderer,workspaceStore:this.workspaceStore}}}]),a}(h.default.Component))||o)||o;r.default=S},3698:function(e,t,r){e.exports={clusterSelector:"_2CN59clY1qGTKeYHNEaPKx"}},3699:function(e,r,a){"use strict";var n=a(19);a(12),a(3),a(11),a(6),a(8),a(13),a(9),a(4),a(193),a(16),a(10),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(12),a(31),a(3),a(11),a(6),a(27),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(193),a(16),a(40),a(10),a(7);var o,u=n(a(318)),l=n(a(50)),c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=a(245),h=n(a(26)),v=n(a(0)),y=a(192),g=n(a(1078)),E=a(56),_=a(3700);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var O={cpu_usage:"workspace_cpu_usage",memory_usage:"workspace_memory_usage_wo_cache",gpu_usage:"workspace_gpu_usage",gpu_memory_usage:"workspace_gpu_memory_usage",disk_usage:"workspace_disk_size_usage",pvc_usage:"workspace_pvc_bytes_used",pvc_useage_block:"workspace_block_storage_pvc_bytes_used",pvc_useage_file:"workspace_file_storage_pvc_bytes_used",pvc_useage_object:"workspace_object_storage_pvc_bytes_used",pvc_useage_undefined:"workspace_undefined_pvc_bytes_used"},w=(0,m.inject)("rootStore")(o=(0,m.observer)(o=function(e){(0,f.default)(a,e);var r=k(a);function a(){var e;(0,s.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).state={storageClass:"pvc_usage"},e.getMonitoringCfgs=function(){return[{type:"cpu",title:"CPU_USAGE",unitType:"cpu",legend:["CPU"],metricType:O.cpu_usage},{type:"memory",title:"MEMORY_USAGE",unitType:"memory",legend:["MEMORY"],metricType:O.memory_usage},{type:"pvc",title:"PVC_BYTES_USED_TCAP",unitType:"memory",legend:["PVC_BYTES_USED_TCAP"],metricType:O[e.state.storageClass],filters:{key:"storageClass",options:[{value:"pvc_usage",label:t("ALL")},{value:"pvc_useage_block",label:t("BLOCK_STORAGE")},{value:"pvc_useage_file",label:t("OBJECT_STORAGE")},{value:"pvc_useage_object",label:t("FILE_STORAGE")},{value:"pvc_useage_undefined",label:t("UNCLASSIFIED")}],onChange:function(t){e.setState({storageClass:t})},getMetricsFilter:function(e){return O[e]||O.pvc_usage}}},{type:"gpu",title:"GPU_USAGE",unitType:"gpu",legend:["GPU"],metricType:O.gpu_usage},{type:"gpu_memory",title:"GPU_MEMORY_USAGE",unitType:"memory",legend:["GPU_MEMORY"],metricType:O.gpu_memory_usage}]},e.getControllerProps=function(){return{title:t("PHYSICAL_RESOURCES"),createTime:e.createTime,customAction:e.renderClusters()}},e.fetchData=function(t){e.monitorStore.cluster=e.props.cluster,e.monitorStore.fetchMetrics(S({workspace:e.workspace,metrics:Object.values((0,E.hideGPUByLicense)(O,e.props.cluster))},t))},e}return(0,i.default)(a,[{key:"componentDidUpdate",value:function(e){e.cluster!==this.props.cluster&&this.fetchData()}},{key:"init",value:function(){this.monitorStore=new g.default}},{key:"renderClusters",value:function(){var e=this.props,t=(e.workspace,e.cluster),r=(0,l.default)(e,["workspace","cluster"]);if(r.options.length)return v.default.createElement(y.Select,(0,u.default)({value:t},r))}},{key:"workspace",get:function(){return this.props.workspace}},{key:"createTime",get:function(){return(0,h.default)(this.props.rootStore,"workspace.detail.createTime")}}]),a}(_.Component))||o)||o;r.default=w},3700:function(e,r,a){"use strict";var n=a(19);a(12),a(194),a(11),a(6),a(20),a(138),a(8),a(13),a(9),a(4),a(193),a(16),a(10),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.Component=r.default=void 0,a(12),a(31),a(194),a(11),a(6),a(20),a(27),a(30),a(138),a(33),a(17),a(8),a(13),a(9),a(4),a(193),a(16),a(40),a(10),a(7);var o=n(a(318)),u=n(a(32)),l=n(a(25)),c=n(a(28)),s=n(a(75)),i=n(a(38)),f=n(a(39)),d=n(a(35)),p=n(a(0)),m=a(245),h=n(a(5)),v=n(a(69)),y=n(a(165)),g=n(a(26)),E=n(a(141)),_=a(56),b=a(804),S=n(a(893)),k=a(976),O=a(821),w=n(a(1595)),P=n(a(3702));function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,u.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,f.default)(this,r)}}var T={cpu_usage:"cluster_cpu_usage",memory_usage:"cluster_memory_usage_wo_cache",gpu_usage:"cluster_gpu_usage",gpu_memory_usage:"cluster_gpu_memory_usage",disk_usage:"cluster_disk_size_usage"},N=function(e){(0,i.default)(a,e);var r=D(a);function a(e){var t;return(0,l.default)(this,a),(t=r.call(this,e)).fetchData=function(e){t.monitorStore.fetchMetrics(C({metrics:Object.values((0,_.hideGPUByLicense)(T,t.cluster))},e))},t.isEmptyData=function(e){return!!(0,v.default)(e)||Object.values(e).every((function(e){return(0,v.default)((0,g.default)(e,"data.result"))}))},t.showModal=function(e){return(0,_.cacheFunc)("_showModal_".concat(e.type),(function(){t.props.workspace&&(e.workspace=t.props.workspace),t.setState({showModal:!0,selectItem:C({},e)})}),(0,s.default)(t))},t.hideModal=function(){t.setState({showModal:!1,selectItem:{}})},t.getControllerProps=function(){return{}},t.getMonitoringCfgs=function(){return[{type:"cpu",title:"CPU",unitType:"cpu",legend:["USAGE"],metricType:T.cpu_usage},{type:"memory",title:"MEMORY",unitType:"memory",legend:["USAGE"],metricType:T.memory_usage},{type:"gpu",title:"GPU",unitType:"gpu",legend:["USAGE"],metricType:T.gpu_usage},{type:"gpu_memory",title:"GPU_MEMORY",unitType:"memory",legend:["USAGE"],metricType:T.gpu_memory_usage}]},t.state={showModal:!1,selectItem:{}},t.init(),t}return(0,c.default)(a,[{key:"init",value:function(){this.monitorStore=new S.default({cluster:this.cluster})}},{key:"renderCard",value:function(){var e=this,r=this.monitorStore,a=r.isLoading,n=r.isRefreshing,l=(0,_.hideGPUByLicense)(this.getMonitoringCfgs(),this.cluster);return p.default.createElement(k.Controller,(0,o.default)({title:t("CLUSTER_RESOURCE_USAGE"),step:"1h",times:24,onFetch:this.fetchData,loading:a,refreshing:n,isEmpty:this.isEmptyData(this.metrics)},this.getControllerProps()),p.default.createElement("div",{className:P.default.content},l.map((function(t){var r,a,n=(0,E.default)(t,["onClick"]),l=(0,y.default)(t.onClick)?e.showModal(n):t.onClick&&t.onClick(n),c=(0,g.default)(e.metrics,"".concat(t.metricType,".data.result"))||[],s=(0,b.getAreaChartOps)(C(C({},n),{},{data:(0,v.default)(c)?[{values:(0,b.getZeroValues)()}]:c})),i=t.filters;i&&Object.assign(s,{filters:C(C({},i),{},{value:null!==(r=e.state[i.key])&&void 0!==r?r:"all",onChange:null!==(a=i.onChange)&&void 0!==a?a:function(t){e.setState((0,u.default)({},i.key,"all"===t?void 0:t)),e.fetchData((0,u.default)({},i.key,"all"===t?void 0:t))}})});return p.default.createElement("div",{key:t.type,className:(0,h.default)(P.default.item,(0,u.default)({},P.default.cursor,!!l)),onClick:l},p.default.createElement(O.MediumArea,(0,o.default)({width:"100%",height:100},s)))}))))}},{key:"renderModal",value:function(){var e=this.state,t=e.showModal,r=e.selectItem;return p.default.createElement("div",null,p.default.createElement(w.default,{visible:t,detail:r,cluster:this.cluster,workspace:this.workspace,workspaceStore:this.props.workspaceStore,onCancel:this.hideModal}))}},{key:"render",value:function(){return p.default.createElement("div",null,this.renderCard(),this.renderModal())}},{key:"metrics",get:function(){return this.monitorStore.data}},{key:"cluster",get:function(){return(0,g.default)(this.props,"match.params.cluster")}}]),a}(p.default.Component),A=(0,m.inject)("rootStore")((0,m.observer)(N));r.default=A;var j=N;r.Component=j},3701:function(e,t,r){e.exports={content:"mI2LtgMFaq0E-mDZTwhJ1",form:"_33uYjplMUXxS2dtpxqyk0Y",chart:"_1UHGGr7yokFO9-MAG-bp9b",table:"_1fZ9ZeVdoF2LVtsjPgXf3e",box:"_30iU9X8YZtOpSyIPS3fDT0",title:"qsGGqGaCVg1q10yzj6eml",empty:"_2Ar2Yi5B35znFPy-ETKrkw",option:"_3WZM55TzrzwmmDd3kO13dM",tip:"_2Kqo0ZWDW1WX-ofCLGtM1w"}},3702:function(e,t,r){e.exports={content:"_1flyCDLTNgroopAvztgY0S",item:"_1zl1DvMLX2YtTTQuvirldX",cursor:"_2VKG6VdQYqW_Jfgf_sdPTq"}},3703:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(6),a(67),a(99),a(4),a(16),a(10),a(74),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(6),a(67),a(30),a(99),a(4),a(21),a(16),a(40),a(10),a(74),a(7);var o=n(a(97)),u=n(a(42));a(36);var l,c=n(a(43)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=n(a(0)),h=a(18),v=a(245),y=n(a(26)),g=a(61),E=n(a(1078)),_=a(192),b=n(a(824)),S=n(a(3704)),k=n(a(3706));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var w=(0,v.inject)("rootStore")(l=(0,v.observer)(l=function(e){(0,f.default)(a,e);var r=O(a);function a(e){var t;return(0,s.default)(this,a),(t=r.call(this,e)).fetchData=(0,c.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.monitorStore.fetchStatistics(t.workspace);case 1:case"end":return e.stop()}}),e)}))),t.getLink=function(e){var r=globals.app.getActions({module:e,workspace:t.workspace});return r.includes("view")||r.includes("manage")?"/workspaces/".concat(t.workspace,"/").concat(e):null},t.getMetrics=function(){var e=(0,h.toJS)(t.monitorStore.statistics.data),r={};return Object.entries(e).forEach((function(e){var t=(0,o.default)(e,2),a=t[0],n=t[1];r[a]=(0,y.default)(n,"data.result[0].value[1]",0)})),r},t.workspace=e.workspace,t.monitorStore=new E.default,t.fetchData(),t}return(0,i.default)(a,[{key:"render",value:function(){var e=this.monitorStore.statistics.isLoading,r=this.getMetrics();return m.default.createElement(_.Loading,{spinning:e},m.default.createElement(b.default,{className:k.default.card},m.default.createElement(_.Columns,null,m.default.createElement(_.Column,null,m.default.createElement(S.default,{icon:g.ICON_TYPES.projects,desc:"1"===r.workspace_namespace_count?t("PROJECT"):t("PROJECT_PL"),title:r.workspace_namespace_count,url:this.getLink("projects"),size:"large"})),globals.app.hasKSModule("devops")&&m.default.createElement(_.Column,null,m.default.createElement(S.default,{icon:g.ICON_TYPES.devops,desc:"1"===r.workspace_devops_project_count?t("DEVOPS_PROJECT_TCAP"):t("DEVOPS_PROJECT_TCAP_PL"),title:r.workspace_devops_project_count,url:this.getLink("devops"),size:"large"})),m.default.createElement(_.Column,null,m.default.createElement(S.default,{icon:g.ICON_TYPES.roles,desc:"1"===r.workspace_role_count?t("ROLE"):t("ROLE_PL"),title:r.workspace_role_count,url:this.getLink("roles"),size:"large"})),m.default.createElement(_.Column,null,m.default.createElement(S.default,{icon:g.ICON_TYPES.members,desc:"1"===r.workspace_member_count?t("WORKSPACE_MEMBER_TCAP"):t("WORKSPACE_MEMBER_TCAP_PL"),title:r.workspace_member_count,url:this.getLink("members"),size:"large"})))))}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),a}(m.default.Component))||l)||l;r.default=w},3704:function(e,t,r){"use strict";r(17);var a=r(19);r(4),r(16),r(10),r(917),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(31),r(30),r(4),r(16),r(40),r(10),r(917);var n=a(r(318)),o=a(r(25)),u=a(r(28)),l=a(r(38)),c=a(r(39)),s=a(r(35)),i=a(r(0)),f=a(r(1)),d=a(r(5)),p=r(438),m=r(192),h=a(r(3705));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var y=function(e){(0,l.default)(r,e);var t=v(r);function r(){return(0,o.default)(this,r),t.apply(this,arguments)}return(0,u.default)(r,[{key:"renderContent",value:function(){var e=this.props,t=e.icon,r=e.iconProps,a=e.image,o=e.title,u=e.desc,l=e.extra;return i.default.createElement("div",null,i.default.createElement("div",{className:h.default.icon},a?i.default.createElement("img",{src:a,alt:""}):i.default.createElement(m.Icon,(0,n.default)({name:t,size:40,type:"dark"},r))),i.default.createElement("div",{className:h.default.text},i.default.createElement("div",null,o),i.default.createElement("p",null,u)),l)}},{key:"render",value:function(){var e=this.props,t=e.url,r=e.size,a=e.className;return t?i.default.createElement(p.Link,{className:(0,d.default)(h.default.info,h.default.link,h.default[r],a),to:t},this.renderContent()):i.default.createElement("div",{className:(0,d.default)(h.default.info,h.default[r],a)},this.renderContent())}}]),r}(i.default.Component);t.default=y,y.propTypes={icon:f.default.string,iconProps:f.default.object,image:f.default.string,title:f.default.any,desc:f.default.any,size:f.default.string,width:f.default.number,url:f.default.string},y.defaultProps={icon:"",iconProps:{},title:"",desc:"",size:"default",width:0}},3705:function(e,t,r){e.exports={info:"_19mYgWKuxc3opetAtSpZ8s",icon:"qxkZsU9tqSvifJxefLtUx",text:"-inyb5ARVzbHUbOax0Rz8",link:"_22Id0T409og0B_FDFhNx9P",large:"_1qTjUUGzpX3FNb9rnveJzC"}},3706:function(e,t,r){e.exports={card:"_2Mzfc-V26H6p6iBCIfz7hD"}},3707:function(e,t,r){"use strict";var a=r(19);r(12),r(3),r(11),r(6),r(8),r(13),r(9),r(4),r(193),r(16),r(10),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(12),r(31),r(3),r(11),r(6),r(27),r(30),r(33),r(17),r(8),r(13),r(9),r(4),r(193),r(16),r(40),r(10),r(7);var n,o=a(r(32)),u=a(r(25)),l=a(r(28)),c=a(r(38)),s=a(r(39)),i=a(r(35)),f=r(245),d=a(r(26)),p=a(r(1078)),m=r(3708);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var g={deployment_count:"workspace_deployment_count",statefulset_count:"workspace_statefulset_count",daemonset_count:"workspace_daemonset_count",job_count:"workspace_job_count",cronjob_count:"workspace_cronjob_count",pvc_count:"workspace_pvc_count",service_count:"workspace_service_count",route_count:"workspace_ingresses_extensions_count",pod_running_count:"workspace_pod_running_count"},E=(0,f.inject)("rootStore")(n=(0,f.observer)(n=function(e){(0,c.default)(r,e);var t=y(r);function r(){var e;(0,u.default)(this,r);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).getMonitoringCfgs=function(){return[{type:"deployment",title:"DEPLOYMENT",legend:["DEPLOYMENT_PL"],metricType:g.deployment_count},{type:"statefulset",title:"STATEFULSET",legend:["STATEFULSET_PL"],metricType:g.statefulset_count,isHidden:!1},{type:"daemonset",title:"DAEMONSET",legend:["DAEMONSET_PL"],metricType:g.daemonset_count,isHidden:!1},{type:"job",title:"JOB",legend:["JOB_PL"],metricType:g.job_count},{type:"cronjob",title:"CRONJOB",legend:["CRONJOB_PL"],metricType:g.cronjob_count},{type:"pvc",title:"PERSISTENT_VOLUME_CLAIM",legend:["PERSISTENT_VOLUME_CLAIM_PL"],metricType:g.pvc_count,isHidden:!1},{type:"service",title:"SERVICE",legend:["SERVICE_PL"],metricType:g.service_count,isHidden:!1},{type:"routes",title:"ROUTE",legend:["ROUTE_PL"],metricType:g.route_count,isHidden:!1},{type:"pod",title:"POD",legend:["RUNNING_PODS"],metricType:g.pod_running_count}].filter((function(e){return!e.isHidden}))},e.fetchData=function(t){e.monitorStore.cluster=e.props.cluster,e.monitorStore.fetchMetrics(v({workspace:e.workspace,metrics:Object.values(g)},t))},e}return(0,l.default)(r,[{key:"componentDidUpdate",value:function(e){e.cluster!==this.props.cluster&&this.fetchData()}},{key:"init",value:function(){this.monitorStore=new p.default}},{key:"workspace",get:function(){return this.props.workspace}},{key:"createTime",get:function(){return(0,d.default)(this.props.rootStore,"workspace.detail.createTime")}}]),r}(m.Component))||n)||n;t.default=E},3708:function(e,r,a){"use strict";var n=a(19);a(12),a(194),a(11),a(6),a(20),a(8),a(13),a(9),a(4),a(193),a(16),a(10),a(7),Object.defineProperty(r,"__esModule",{value:!0}),r.Component=r.default=void 0,a(12),a(31),a(194),a(11),a(6),a(20),a(27),a(30),a(33),a(17),a(8),a(13),a(9),a(4),a(193),a(16),a(40),a(10),a(7);var o=n(a(318)),u=n(a(32)),l=n(a(25)),c=n(a(28)),s=n(a(75)),i=n(a(38)),f=n(a(39)),d=n(a(35)),p=n(a(0)),m=a(245),h=n(a(5)),v=n(a(69)),y=n(a(165)),g=n(a(26)),E=n(a(141)),_=a(56),b=a(804),S=n(a(893)),k=a(976),O=a(821),w=n(a(1595)),P=n(a(3709));function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,u.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,f.default)(this,r)}}var T={deployment_count:"cluster_deployment_count",statefulset_count:"cluster_statefulset_count",daemonset_count:"cluster_daemonset_count",job_count:"cluster_job_count",cronjob_count:"cluster_cronjob_count",pvc_count:"cluster_pvc_count",service_count:"cluster_service_count",route_count:"cluster_ingresses_extensions_count",pod_running_count:"cluster_pod_running_count"},N=function(e){(0,i.default)(a,e);var r=D(a);function a(e){var t;return(0,l.default)(this,a),(t=r.call(this,e)).fetchData=function(e){t.monitorStore.fetchMetrics(C({metrics:Object.values(T)},e))},t.isEmptyData=function(e){return!!(0,v.default)(e)||Object.values(e).every((function(e){return(0,v.default)((0,g.default)(e,"data.result"))}))},t.showModal=function(e){return(0,_.cacheFunc)("_showModal_".concat(e.type),(function(){t.props.workspace&&(e.workspace=t.props.workspace),t.setState({showModal:!0,selectItem:(0,E.default)(e,["data"])})}),(0,s.default)(t))},t.hideModal=function(){t.setState({showModal:!1,selectItem:{}})},t.getControllerProps=function(){return{}},t.getMonitoringCfgs=function(){return[{type:"deployment",title:"DEPLOYMENT",legend:["DEPLOYMENT_PL"],metricType:T.deployment_count},{type:"statefulset",title:"STATEFULSET",legend:["STATEFULSET_PL"],metricType:T.statefulset_count},{type:"daemonset",title:"DAEMONSET",legend:["DAEMONSET_PL"],metricType:T.daemonset_count},{type:"job",title:"JOB",legend:["JOB_PL"],metricType:T.job_count},{type:"cronjob",title:"CRONJOB",legend:["CRONJOB_PL"],metricType:T.cronjob_count},{type:"pvc",title:"PERSISTENT_VOLUME_CLAIM",legend:["PERSISTENT_VOLUME_CLAIM_PL"],metricType:T.pvc_count},{type:"service",title:"SERVICE",legend:["SERVICE_PL"],metricType:T.service_count},{type:"routes",title:"ROUTE",legend:["ROUTE_PL"],metricType:T.route_count},{type:"pod",title:"POD",legend:["RUNNING_PODS"],metricType:T.pod_running_count}]},t.state={showModal:!1,selectItem:{}},t.init(),t}return(0,c.default)(a,[{key:"init",value:function(){this.monitorStore=new S.default({cluster:this.cluster})}},{key:"renderCard",value:function(){var e=this,r=this.monitorStore,a=r.isLoading,n=r.isRefreshing,l=this.getMonitoringCfgs();return p.default.createElement(k.Controller,(0,o.default)({title:t("APPLICATION_RESOURCE_USAGE"),step:"1h",times:24,onFetch:this.fetchData,loading:a,refreshing:n,isEmpty:this.isEmptyData(this.metrics)},this.getControllerProps()),p.default.createElement("div",{className:P.default.content},l.map((function(t){var r=C(C({},t),{},{unit:""}),a=(0,y.default)(t.onClick)?e.showModal(r):t.onClick&&t.onClick(r),n=(0,g.default)(e.metrics,"".concat(t.metricType,".data.result"))||[],l=(0,b.getAreaChartOps)(C(C({},r),{},{data:(0,v.default)(n)?[{values:(0,b.getZeroValues)()}]:n}));return p.default.createElement("div",{key:t.type,className:P.default.wrapper},p.default.createElement("div",{className:(0,h.default)(P.default.item,(0,u.default)({},P.default.cursor,!!a)),onClick:a},p.default.createElement(O.MediumArea,(0,o.default)({width:"100%",height:100},l))))}))))}},{key:"renderModal",value:function(){var e=this.state,t=e.showModal,r=e.selectItem;return p.default.createElement("div",null,p.default.createElement(w.default,{visible:t,detail:r,cluster:this.cluster,workspace:this.workspace,workspaceStore:this.props.workspaceStore,onCancel:this.hideModal}))}},{key:"render",value:function(){return p.default.createElement("div",null,this.renderCard(),this.renderModal())}},{key:"metrics",get:function(){return this.monitorStore.data}},{key:"cluster",get:function(){return(0,g.default)(this.props,"match.params.cluster")}}]),a}(p.default.Component),A=(0,m.inject)("rootStore")((0,m.observer)(N));r.default=A;var j=N;r.Component=j},3709:function(e,t,r){e.exports={content:"_22oShqErzb7Zg62dSiR6cY",wrapper:"RRB2IIfXIPCzlpPCDoj-S",item:"Nd0Z8L7XQ1dllBxOFf5cb",cursor:"_3HIXxDWa4EOcHJnJEhIv6L"}},3710:function(e,r,a){"use strict";a(17);var n=a(19);a(20),a(14),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(20),a(30),a(14),a(4),a(16),a(40),a(10);var o,u=n(a(25)),l=n(a(28)),c=n(a(38)),s=n(a(39)),i=n(a(35)),f=n(a(0)),d=a(245),p=n(a(5)),m=n(a(26)),h=n(a(1205)),v=a(192),y=n(a(845)),g=n(a(3711)),E=n(a(982)),_=a(56),b=n(a(3712));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var k=(0,d.inject)("rootStore","workspaceStore")(o=(0,d.observer)(o=function(e){(0,c.default)(a,e);var r=S(a);function a(e){var n;return(0,u.default)(this,a),(n=r.call(this,e)).valueRenderer=function(e){return t("CLUSTER_VALUE",{value:(0,_.showNameAndAlias)(e.cluster)})},n.optionRenderer=function(e){return f.default.createElement("div",null,f.default.createElement("div",null,(0,_.showNameAndAlias)(e.cluster)),!e.cluster.isReady&&f.default.createElement("div",null,f.default.createElement(E.default,{data:e.cluster,noTip:!0})))},n.export=function(){n.store.download("project.usage.rank.json")},n.fetchMetrics=function(){n.workspaceStore.cluster&&(n.store.cluster=n.workspaceStore.cluster,n.store.fetchAll())},n.handleClusterChange=function(e){n.workspaceStore.selectCluster(e),n.fetchMetrics()},n.store=new h.default({workspace:n.workspace,limit:10,sort_type:"desc"}),n.workspaceStore=n.props.workspaceStore,n}return(0,l.default)(a,[{key:"componentDidMount",value:function(){this.fetchMetrics()}},{key:"render",value:function(){return this.workspaceStore.clusters.data.length>0?f.default.createElement("div",{className:b.default.wrapper},this.renderToolbar(),this.renderList()):f.default.createElement(y.default,{icon:"cluster",title:t("NO_CLUSTER_AVAILABLE"),desc:t("WORKSPACE_NO_CLUSTER_TIP")})}},{key:"renderToolbar",value:function(){var e=this;return f.default.createElement("div",{className:(0,p.default)(b.default.toolbar,b.default.pane__toolbar,b.default.pane)},f.default.createElement("div",{className:b.default.toolbar_filter},f.default.createElement(v.Select,{options:this.clusters,value:this.workspaceStore.cluster,onChange:this.handleClusterChange,valueRenderer:this.valueRenderer,optionRenderer:this.optionRenderer,showTip:!0}),f.default.createElement(v.Select,{value:this.store.sort_metric,onChange:this.store.changeSortMetric,options:this.options}),f.default.createElement("span",{className:b.default.sort_button},f.default.createElement(v.Icon,{name:"desc"===this.store.sort_type?"sort-descending":"sort-ascending",type:"coloured",size:"small",onClick:function(){return e.store.changeSortType()}}))),f.default.createElement("div",{className:b.default.toolbar_buttons},f.default.createElement(v.Button,{onClick:this.export},t("EXPORT"))))}},{key:"renderList",value:function(){return f.default.createElement(v.Loading,{spinning:this.store.isLoading},f.default.createElement("div",null,f.default.createElement(g.default,{store:this.store,cluster:this.workspaceStore.cluster,workspace:this.workspace}),this.renderPagination()))}},{key:"renderPagination",value:function(){var e=this.store,t=e.page,r=e.total_page,a=this.store.limit;return f.default.createElement("div",{className:(0,p.default)(b.default.pane,b.default.pane__pagination)},f.default.createElement(v.Level,null,f.default.createElement(v.LevelLeft,null),f.default.createElement(v.LevelRight,null,f.default.createElement(v.Pagination,{page:t,total:r,limit:a,onChange:this.store.changePagination}))))}},{key:"workspace",get:function(){return(0,m.default)(this.props,"match.params.workspace")}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data.map((function(e){return{label:e.name,value:e.name,disabled:!e.isReady,cluster:e}}))}},{key:"options",get:function(){return this.store.sort_metric_options.map((function(e){return{value:e,label:t("SORT_BY_".concat(e.toUpperCase()))}}))}}]),a}(f.default.Component))||o)||o;r.default=k},3711:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(24),a(4),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(30),a(24),a(4),a(16),a(40),a(10);var o,u=n(a(25)),l=n(a(28)),c=n(a(38)),s=n(a(39)),i=n(a(35)),f=n(a(803)),d=n(a(855)),p=n(a(1206)),m=a(245),h=n(a(0)),v=a(56),y=a(804);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var E=(0,m.inject)("rootStore")(o=(0,m.observer)(o=function(e){(0,c.default)(a,e);var r=g(a);function a(){var e;(0,u.default)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=r.call.apply(r,[this].concat(o))).IconWidth=40,e.rankTdWidth=124,e.columns=[{dataIndex:"namespace",title:t("PROJECT"),key:"avatar",render:function(t){return h.default.createElement(f.default,{icon:"project",iconSize:40,title:(0,v.showNameAndAlias)(t,"project",{cluster:e.props.cluster}),to:"".concat(e.prefix,"/").concat(t)})}},{sort_metric:"namespace_cpu_usage",key:"cpu",width:e.rankTdWidth,title:h.default.createElement("div",null,t("CPU_USAGE")),render:function(e){return h.default.createElement("div",null,h.default.createElement("h3",null,(0,y.getSuitableValue)(e.namespace_cpu_usage,"cpu","-")),h.default.createElement("div",null,t("QUOTA_VALUE",{value:(0,y.getSuitableValue)(e.namespace_cpu_limit_hard,"cpu","-")})))}},{sort_metric:"namespace_memory_usage_wo_cache",width:e.rankTdWidth,title:h.default.createElement("div",null,t("MEMORY_USAGE")),key:"memory",render:function(e){return h.default.createElement("div",null,h.default.createElement("h3",null,(0,y.getSuitableValue)(e.namespace_memory_usage_wo_cache,"memory","-")),h.default.createElement("div",null,t("QUOTA_VALUE",{value:(0,y.getSuitableValue)(e.namespace_memory_limit_hard,"memory","-")})))}},{sort_metric:"namespace_gpu_usage",key:"gpu",width:e.rankTdWidth,title:h.default.createElement("div",null,t("GPU_USAGE")),render:function(e){return h.default.createElement("div",null,h.default.createElement("h3",null,(0,y.getSuitableValue)(e.namespace_gpu_usage,"gpu","-")),h.default.createElement("div",null,t("QUOTA_VALUE",{value:(0,y.getSuitableValue)(e.namespace_gpu_limit_hard,"gpu","-")})))}},{sort_metric:"namespace_gpu_memory_usage",width:e.rankTdWidth,title:h.default.createElement("div",null,t("GPU_MEMORY_USAGE")),key:"gpu_memory",render:function(e){return h.default.createElement("div",null,h.default.createElement("h3",null,(0,y.getSuitableValue)(e.namespace_gpu_memory_usage,"memory","-")))}},{sort_metric:"namespace_pod_count",title:t("POD_COUNT"),key:"pod",width:e.rankTdWidth,render:function(e){return h.default.createElement("div",null,h.default.createElement("h3",null,e.namespace_pod_count||"-"),h.default.createElement("div",null,t("QUOTA_VALUE",{value:e.namespace_pods_hard||"-"})))}},{sort_metric:"namespace_net_bytes_transmitted",title:t("OUTBOUND_TRAFFIC"),key:"namespace_net_bytes_transmitted",width:e.rankTdWidth,render:function(e){return h.default.createElement("div",null,h.default.createElement("h3",null,(0,y.getSuitableValue)(e.namespace_net_bytes_transmitted,"bandwidth","-")))}},{sort_metric:"namespace_net_bytes_received",title:t("INBOUND_TRAFFIC"),key:"namespace_net_bytes_received",width:e.rankTdWidth,render:function(e){return h.default.createElement("div",null,h.default.createElement("h3",null,(0,y.getSuitableValue)(e.namespace_net_bytes_received,"bandwidth","-")))}}],e}return(0,l.default)(a,[{key:"toPercentage",value:function(e){var t=Number(e)||0;return"".concat(Math.ceil(100*t),"%")}},{key:"toUnit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return isNaN(e)?"-":"".concat(e," ").concat(t)}},{key:"render",value:function(){var e=this.props,t=e.theme,r=e.store,a=e.cluster,n=this.props.store.data,o=(0,v.hideGPUByLicense)(this.columns,a);return h.default.createElement(p.default,{rowKey:"namespace",theme:t,columns:o,store:r,dataSource:n.toJS(),emptyText:h.default.createElement(d.default,null)})}},{key:"prefix",get:function(){var e=this.props,t=e.workspace,r=e.cluster;return"".concat(t?"/".concat(t):"","/clusters/").concat(r,"/projects")}}]),a}(h.default.Component))||o)||o;r.default=E},3712:function(e,t,r){e.exports={wrapper:"XOE-cnCpkLiQnK1LYj76R",pane:"_4eoZyoK8wFINAqkdJQ85x",pane__toolbar:"_3ogot8SmW5Z_9xeDNnNw8J",pane__pagination:"_2-8FIJLuwzuIKSrqxMesHO",title:"_2qPKz_yI2dQANE7cinRpOJ",toolbar:"_2RBEsIiZKKZgDZ3u7LiRAo",toolbar_buttons:"_2GVcDXuuqPn-Rp4lv0T62i",toolbar_filter:"_3bcXJxC0OcAscveuS8z8n-",sort_button:"_1GoQ0ktQ1tHaIYZStCYuNK",table:"_3wbjOUhTYzkXtBKPWT2gII",table_rank:"_3nh1u6G_H7ukc5exwtqOVD",table_no_border:"_33558CkQNEGbVwy7lI_Qpn",rankList_row:"_3VpL4zRLxPNKDne3b1JfS5",rankLink__sort_col:"FenZscoqAaPoaSyYYOCPb"}},3713:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(20),a(14),a(4),a(16),a(29),a(10),a(66),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(20),a(30),a(14),a(4),a(16),a(40),a(29),a(10),a(66);var o,u=n(a(25)),l=n(a(28)),c=n(a(38)),s=n(a(39)),i=n(a(35)),f=n(a(0)),d=n(a(69)),p=a(18),m=a(245),h=n(a(845)),v=n(a(893)),y=n(a(3714));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var E=(0,m.inject)("rootStore","workspaceStore")(o=(0,m.observer)(o=function(e){(0,c.default)(a,e);var r=g(a);function a(){var e;(0,u.default)(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).monitorStore=new v.default,e.state={confirm:!1,workspaces:{}},e}return(0,l.default)(a,[{key:"render",value:function(){if(!globals.app.isMultiCluster)return null;var e=(0,p.toJS)(this.store.clusters),r=e.data,a=e.isLoading;return(0,d.default)(r)&&!a?f.default.createElement(h.default,{icon:"cluster",title:t("NO_CLUSTER_AVAILABLE"),desc:t("WORKSPACE_NO_CLUSTER_TIP")}):r.map((function(e){return f.default.createElement(y.default,{key:e.name,cluster:e})}))}},{key:"store",get:function(){return this.props.workspaceStore}},{key:"module",get:function(){return"BaseInfo"}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"workspace",get:function(){return this.props.match.params.workspace}}]),a}(f.default.Component))||o)||o;r.default=E},3714:function(e,r,a){"use strict";a(17);var n=a(19),o=a(163);a(3),a(20),a(14),a(4),a(193),a(16),a(10),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,a(31),a(3),a(20),a(30),a(14),a(4),a(193),a(16),a(40),a(10);var u,l=n(a(318)),c=n(a(32)),s=n(a(25)),i=n(a(28)),f=n(a(38)),d=n(a(39)),p=n(a(35)),m=o(a(0)),h=a(245),v=n(a(26)),y=a(192),g=n(a(1123)),E=n(a(1122)),_=n(a(3715)),b=n(a(3716)),S=n(a(1596)),k=n(a(801)),O=n(a(802)),w=n(a(847)),P=n(a(3717)),R=n(a(893)),C=a(804),D=a(56),T=n(a(5)),N=n(a(3719));function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var j={cpu_usage:"cluster_cpu_usage",cpu_total:"cluster_cpu_total",memory_usage:"cluster_memory_usage_wo_cache",memory_total:"cluster_memory_total",gpu_usage:"cluster_gpu_usage",gpu_total:"cluster_gpu_total",gpu_memory_usage:"cluster_gpu_memory_usage",gpu_memory_total:"cluster_gpu_memory_total",disk_size_usage:"cluster_disk_size_usage",disk_size_capacity:"cluster_disk_size_capacity",pod_count:"cluster_pod_running_count",pod_capacity:"cluster_pod_quota"},I=(0,h.observer)(u=function(e){(0,f.default)(a,e);var r=A(a);function a(){var e;(0,s.default)(this,a);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return(e=r.call.apply(r,[this].concat(o))).monitorStore=new R.default({cluster:e.props.cluster.name}),e.getValue=function(e){return(0,v.default)(e,"value[1]",0)},e.fetchData=function(){e.isReady?e.monitorStore.fetchMetrics({metrics:Object.values((0,D.hideGPUByLicense)(j,e.props.cluster.name)),last:!0}):e.monitorStore.isLoading=!1},e.getResourceOptions=function(){var t=(0,C.getLastMonitoringData)(e.metrics);return[{name:"CPU",unitType:"cpu",used:e.getValue(t[j.cpu_usage]),total:e.getValue(t[j.cpu_total])},{name:"GPU",unitType:"gpu",used:e.getValue(t[j.gpu_usage]),total:e.getValue(t[j.gpu_total])},{name:"MEMORY",unitType:"memory",used:e.getValue(t[j.memory_usage]),total:e.getValue(t[j.memory_total])},{name:"GPU_MEMORY",unitType:"memory",used:e.getValue(t[j.gpu_memory_usage]),total:e.getValue(t[j.gpu_memory_total])},{name:"POD",unitType:"",used:e.getValue(t[j.pod_count]),total:e.getValue(t[j.pod_capacity])},{name:"DISK",unitType:"disk",used:e.getValue(t[j.disk_size_usage]),total:e.getValue(t[j.disk_size_capacity])}]},e.getRadarOptions=function(e){return e.map((function(e){return{name:t(e.name),usage:Math.round(100*e.used/(e.total||e.used))}}))},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props.cluster,r=(0,D.hideGPUByLicense)(this.getResourceOptions(),e.name),a=this.getRadarOptions(r),n=this.showLicenseTip?{cx:200,cy:100,width:400,height:200}:{cx:180,cy:90,width:300,height:180};return m.default.createElement(O.default,{key:e.name},m.default.createElement(y.Loading,{spinning:this.monitorStore.isLoading},m.default.createElement("div",{className:N.default.cluster},m.default.createElement("div",{className:N.default.info},m.default.createElement("div",{className:N.default.title},m.default.createElement(w.default,{cluster:e})),m.default.createElement("div",{className:N.default.desc},m.default.createElement(k.default,{title:e.kubernetesVersion,description:t("KUBERNETES_VERSION")}),m.default.createElement(k.default,{title:e.provider||"-",description:t("PROVIDER")})),this.isReady&&m.default.createElement("div",{className:(0,T.default)(N.default.chartNoGPU,(0,c.default)({},N.default.chart,!this.showLicenseTip))},m.default.createElement(b.default,(0,l.default)({},n,{data:a}),m.default.createElement(_.default,{gridType:"circle"}),m.default.createElement(E.default,{dataKey:"name"}),m.default.createElement(g.default,{domain:[0,100]}),m.default.createElement(S.default,{dataKey:"usage",stroke:"#329DCE",fill:"rgba(126, 184, 220, 0.2)"}))),m.default.createElement(y.Icon,{name:"cluster",size:200,className:N.default.cornerIcon})),this.isReady&&m.default.createElement("div",{className:(0,T.default)(N.default.monitorNoGPU,(0,c.default)({},N.default.monitor,!this.showLicenseTip))},r.map((function(e){return m.default.createElement(P.default,(0,l.default)({key:e.name},e))}))))))}},{key:"metrics",get:function(){return this.monitorStore.data}},{key:"isReady",get:function(){return this.props.cluster.isReady}},{key:"showLicenseTip",get:function(){var e;return(null===(e=globals.licenseInfo)||void 0===e?void 0:e.showLicenseTip)||!(0,v.default)(globals,'ksConfig["gpu.monitoring"]',!1)}}]),a}(m.Component))||u;r.default=I},3717:function(e,r,a){"use strict";a(17);var n=a(19);a(3),a(14),Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var r=t(e.name),a=(0,c.getSuitableUnit)(e.total,e.unitType)||a,n=(0,c.getValueByUnit)(e.used,a),f=(0,c.getValueByUnit)(e.total,a)||n,d=Math.round(100*n/f);return o.default.createElement("div",{className:i.default.item},o.default.createElement("div",{className:i.default.pie},o.default.createElement(l.PieChart,{width:48,height:48,data:[{name:"Used",itemStyle:{fill:"#329dce"},value:n},{name:"Left",itemStyle:{fill:"#c7deef"},value:f-n}]})),o.default.createElement(u.default,{title:"".concat(isNaN(d)?0:d,"%"),description:r}),o.default.createElement(u.default,{title:"".concat(n," ").concat(t((0,s.coreUnitTS)(n,a))),description:t("USED")}),o.default.createElement(u.default,{title:"".concat(f," ").concat(t((0,s.coreUnitTS)(f,a))),description:t("TOTAL")}))},a(3),a(14);var o=n(a(0)),u=n(a(801)),l=a(821),c=a(804),s=a(56),i=n(a(3718))},3718:function(e,t,r){e.exports={item:"_38IET-_Z40mlRDDt2dc9oo",pie:"_2Z0HAgrVH_0VYI2TXLkevV"}},3719:function(e,t,r){e.exports={cluster:"eIIpL5gXsD7eYCN4jObmc",info:"_1SeIIfdo7pfeyRVJA_rTXY",title:"_11TQrQLFxw07VUuS6Ml-Jg",desc:"_1SEi1Y-s-7o5h5MTWWWd8Z",cornerIcon:"_337F40HqvDwpzPZ7SW0wPc",chart:"hMmFTXs1YpaU1RsZsL23Q",monitor:"_3YJouPHvRAOZLmlSQsKIUv",chartNoGPU:"FTvcEV2ifW6WDEX3eteoZ",monitorNoGPU:"_2fbzCktZJ-4TBQdFttivUC"}},796:function(e,t,r){"use strict";var a=r(19),n=r(163);r(12),r(11),r(6),r(37),r(98),r(8),r(13),r(9),r(4),r(21),r(16),r(29),r(10),r(46),r(66),r(7),r(44),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(12),r(31),r(11),r(6),r(37),r(27),r(98),r(30),r(33),r(17),r(8),r(13),r(9),r(4),r(21),r(16),r(40),r(29),r(10),r(46),r(66),r(7),r(44);var o=a(r(42)),u=a(r(32));r(36);var l,c=a(r(43)),s=a(r(25)),i=a(r(28)),f=a(r(38)),d=a(r(39)),p=a(r(35)),m=n(r(0)),h=r(245),v=a(r(26)),y=a(r(70)),g=a(r(246)),E=r(192),_=r(319),b=a(r(443)),S=a(r(3624));function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,u.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,d.default)(this,r)}}var P=(0,h.inject)("rootStore")(l=(0,h.observer)(l=function(e){(0,f.default)(a,e);var t,r=w(a);function a(e){var t;return(0,s.default)(this,a),(t=r.call(this,e)).store=new b.default,t.init(e.match.params),t}return(0,i.default)(a,[{key:"componentDidUpdate",value:function(e){e.match.params.workspace!==this.workspace&&this.init(this.props.match.params)}},{key:"init",value:(t=(0,c.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.initializing=!0,e.next=3,Promise.all([this.store.fetchDetail(t),this.store.fetchClusters(O(O({},t),{},{limit:-1})),this.props.rootStore.getRules(t)]);case 3:globals.app.isMultiCluster&&(0,y.default)(globals.ksConfig,"devops",this.store.clusters.data.some((function(e){return(0,v.default)(e,"configz.devops")}))),globals.app.cacheHistory(this.props.match.url,O({type:"Workspace"},(0,g.default)(this.store.detail,["name","aliasName"]))),this.store.initializing=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){return this.store.initializing?m.default.createElement(E.Loading,{className:"ks-page-loading"}):m.default.createElement(h.Provider,{workspaceStore:this.store},(0,_.renderRoutes)(S.default))}},{key:"workspace",get:function(){return this.props.match.params.workspace}}]),a}(m.Component))||l)||l;t.default=P}}]);