(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1078:function(e,a,r){"use strict";var n=r(19),o=r(162);r(12),r(3),r(10),r(6),r(70),r(194),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(27),r(194),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(69),r(7);var c,s=n(r(317)),l=n(r(31)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=o(r(0)),h=r(189),v=n(r(813)),_=r(56),g=r(804),y=r(243),E=n(r(1012)),b=n(r(26));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var k=(0,y.inject)("rootStore","projectStore")(c=(0,y.observer)(c=(0,g.trigger)(c=function(e){(0,d.default)(r,e);var a=R(r);function r(){var e;(0,i.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).store=new E.default,e.handleTabChange=function(t){var a=e.props.match.params,r=a.workspace,n=a.cluster,o=a.namespace;e.props.rootStore.routing.push("/".concat(r,"/clusters/").concat(n,"/projects/").concat(o,"/applications/").concat(t))},e.showDeploySampleApp=function(){var t=e.props,a=t.rootStore,r=t.projectStore,n=t.match;e.trigger("crd.app.create",O(O({sampleApp:"bookinfo",module:"applications"},n.params),{},{store:e.store,projectDetail:r.detail,success:function(e){return a.routing.push(e)}}))},e}return(0,u.default)(r,[{key:"render",value:function(){return m.default.createElement(v.default,(0,s.default)({},this.props,{description:t("APPLICATIONS_DESC"),tabs:globals.app.hasKSModule("openpitrix")?this.tabs:void 0,tips:this.tips}))}},{key:"canDeployComposingApp",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace,n=globals.app.getActions({workspace:t,cluster:a,project:r,module:"deployments"}).includes("create"),o=globals.app.getActions({workspace:t,cluster:a,project:r,module:"services"}).includes("create");return n&&o}},{key:"tabs",get:function(){var e=this.props.type,a=[];"composing"!==e&&a.push({value:"template",label:t("TEMPLATE_BASED_APP_PL")});var r={value:"database",label:t("RADONDB_APPS")};return(0,_.isHasRadonDBAuthorized)()&&a.splice(1,0,r),(0,b.default)(globals,"ksConfig.nativehelmrelease",!1)&&a.push({value:"others",label:t("OTHER_APP_PL")}),{value:e,onChange:this.handleTabChange,options:a}}},{key:"tips",get:function(){return"database"===this.props.type?[{title:t("WHAT_ARE_RADONDB_APPS"),description:t("RADONDB_APPS_DESC")}]:"template"===this.props.type?[{title:t("APP_TYPES_Q"),description:t("APP_TYPES_A")}]:[{title:t("HOW_TO_USE_APP_GOVERN_Q"),description:t("HOW_TO_USE_APP_GOVERN_A"),operation:this.canDeployComposingApp?m.default.createElement(h.Button,{onClick:this.showDeploySampleApp},t("DEPLOY_SAMPLE_APP")):null,closable:!1}]}}]),r}(m.Component))||c)||c)||c;a.default=k},1085:function(e,t,a){"use strict";function r(e){var t=e.toLowerCase();return t.includes("g")?1024*parseFloat(t):(t.includes("m"),parseFloat(t))}a(16),a(70),a(36),a(1627),a(4),a(21),a(30),a(73),a(139),a(79),a(1628),a(1631),a(1632),a(1633),a(1634),a(1635),a(1636),a(1637),a(1638),a(1639),a(1640),a(1641),a(1642),a(1643),a(1644),a(1645),a(1646),a(1647),a(1648),a(1649),a(1650),a(1651),a(1652),a(1653),Object.defineProperty(t,"__esModule",{value:!0}),t.copyToClipboard=function(e){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e);var t=document.createElement("textarea");return t.value=e,t.style.position="absolute",t.style.opacity=0,t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),new Promise((function(e,a){document.execCommand("copy")?e():a(),t.remove()}))},t.binaryStringToBlob=function(e){var t=e.length,a=new Uint8Array(t);for(;t--;)a[t]=e.charCodeAt(t);return new Blob([a])},t.convertToMebiBytes=r,t.convertJVMToMemoryMebiBytes=function(e){var t=e.split(" ")[0];if(t.startsWith("-Xms")){return r(t.substring(4))}return 0},a(70),a(36),a(1627),a(3946),a(3948),a(3949),a(3951),a(4),a(440),a(21),a(73),a(79),a(1628),a(3952),a(1631),a(1632),a(1633),a(1634),a(1635),a(1636),a(3953),a(3954),a(1637),a(1638),a(1639),a(1640),a(1641),a(1642),a(1643),a(1644),a(1645),a(1646),a(1647),a(1648),a(1649),a(1650),a(1651),a(1652),a(3955),a(3957),a(1653),a(3958)},1089:function(e,t,a){e.exports={triggerBox:"_18oz9jJspnnTzmxdiMcTvO",itemBox:"_19wJV0VwUuABLlpoGuI5RR",itemBoxTitle:"_2Ek20yzPmLZbe0Zvz_kewY",itemBoxBody:"TjVoqR4KzT6ZJhlj7F0Yb",itemBoxBody2Column:"_1wisn1exfeWbdYIMAjLveK",itemBoxBodyItem:"_2C0_4pcZsWPa06pViyMLVD",authentication:"_1SFJk2XAG7XOTNVKgWXTT6"}},1221:function(e,t,a){"use strict";var r=a(19);a(12),a(109),a(3),a(10),a(44),a(6),a(70),a(36),a(20),a(320),a(194),a(14),a(24),a(138),a(8),a(13),a(9),a(4),a(21),a(18),a(30),a(11),a(73),a(46),a(139),a(79),a(7),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.isAppRunning=function(e){var t=(0,T.default)(e,"resourceState"),a=q[t]||t;return z.includes(a)},t.default=t.RunningStatus=t.DMPStatus=void 0;var n=r(a(38)),o=r(a(58)),c=r(a(50));a(35);var s=r(a(39)),l=r(a(62)),i=r(a(25)),u=r(a(28)),d=r(a(74)),f=r(a(41)),p=r(a(42)),m=r(a(37)),h=r(a(45)),v=(r(a(63)),r(a(31)));a(12),a(109),a(32),a(3),a(10),a(44),a(6),a(70),a(36),a(20),a(27),a(247),a(320),a(194),a(860),a(141),a(29),a(14),a(120),a(24),a(138),a(33),a(16),a(8),a(13),a(9),a(4),a(440),a(321),a(21),a(18),a(43),a(11),a(73),a(46),a(79),a(1013),a(7),a(40),a(1014),a(1015),a(1016);var _,g,y,E,b,S,O,R,k,C,A=r(a(68)),T=r(a(26)),D=r(a(67)),P=r(a(456)),N=a(17),I=a(324),w=a(56),x=r(a(245)),M=r(a(460)),L=a(815),j=r(a(3718)),U=a(934),B=r(a(1222)),F=a(1320),Y=a(1321);function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?G(Object(a),!0).forEach((function(t){(0,v.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var q={Creating:"Creating",Initializing:"Creating",Updating:"Updating",InProgress:"Updating",ScaleIn:"Updating",ScaleOut:"Updating",Completed:"Completed",Running:"Running",Ready:"Running",Closed:"Closed","pgcluster Shutdown":"Closed",CreateFailed:"Create Failed",UpdateFailed:"Update Failed",Terminating:"Terminating",FailedInvalidConfig:"Failed",FailedServiceConfig:"Failed",FailedTLSConfig:"Failed",FailedUserConfig:"Failed",FailedRBACConfig:"Failed",FailedDeployment:"Failed",FailedReset:"Failed",TLSNotValidYet:"Updating",ApplyingChanges:"Updating",MigratingData:"Updating",Stalled:"Updating",Invalid:"Failed","True-Ready":"Running","True-NotReady":"Creating",Expanding:"Updating"};t.DMPStatus={"Create Failed":"Failed","Update Failed":"Failed",Restoring:"Updating",Bootstapping:"Updating",Bootstapped:"Running","In The Backup":"Updating"};var z=[q.Running,q.Completed];t.RunningStatus=z;var K=function(e,t){var a;try{a=JSON.parse(e.customResource)}catch(e){a={}}var r=(0,L.getAppIdByKind)(a.kind),n=e.resourceState,o=e.creationTimestamp,c=e.appVersion,s=e.description,l=q[n]||n,i=H(H(H({},a.metadata),a),{},{workspace:t,creationTimestamp:o,app_id:r,version:c,description:s,status:l,isRunning:z.includes(l),app_name:(0,L.convertAppIdToName)(r)});switch(r){case L.RadonDBAppId.ClickHouse:var u=(0,T.default)(a,"spec.configuration.clusters[0].layout",{}),d=u.replicasCount,f=u.shardsCount,p=(0,T.default)(a,"spec.templates.podTemplates[0].spec.containers[0].resources.requests"),m=p.cpu,h=p.memory,v=(0,T.default)(a,"spec.templates.volumeClaimTemplates[0].spec.storageClassName");return H(H({},i),{},{icon:"/extensions-static/ks-console-embed/dist/v3dist/assets/click-house.svg",replicasCount:d,shardsCount:f,cpu:m,memory:h,storage:(0,T.default)(a,"spec.templates.volumeClaimTemplates[0].spec.resources.requests.storage"),storageclass:(0,T.default)(a,"spec.reources.storageClassName")||v,update_time:(0,T.default)(a,"metadata.managedFields[1].time")});case L.RadonDBAppId.PostgreSQL:var _=(0,T.default)(a,"spec.postgresql.readwriteinstance.podspec.containers[0].resources.requests"),g=_.cpu,y=_.memory,E=(0,T.default)(a,"spec.autofailover.podspec.containers[0].image",""),b=(0,T.default)(E.split(":"),"[1]","").split(".")[0];return H(H({},i),{},{icon:"/extensions-static/ks-console-embed/dist/v3dist/assets/postgre.svg",cpu:g,memory:y,storage:(0,T.default)(a,"spec.postgresql.readwriteinstance.volumeClaimTemplates[0].spec.resources.requests.storage"),storageclass:(0,T.default)(a,"spec.postgresql.readwriteinstance.volumeClaimTemplates[0].spec.storageClassName"),shardsCount:(0,T.default)(a,"spec.postgresql.readwriteinstance.replicas"),backupSchedule:(0,T.default)(a,"spec.fullBackupSchedule"),databaseVersion:b,databaseVersionText:"PostgreSQL ".concat(b)});case L.RadonDBAppId.MySQL:var S=(0,T.default)(a,"spec.mysqlOpts.resources.requests"),O=S.cpu,R=S.memory,k=(0,T.default)(a,"spec.replicas");return H(H({},i),{},{icon:"/extensions-static/ks-console-embed/dist/v3dist/assets/mysql-qkcp.svg",cpu:O,memory:R,shardsCount:k,storage:(0,T.default)(a,"spec.persistence.size"),storageclass:(0,T.default)(a,"spec.persistence.storageClass"),backupSchedule:(0,T.default)(a,"spec.backupSchedule","").substring(2),databaseVersion:(0,T.default)(a,"spec.mysqlVersion"),databaseVersionText:"MySQL ".concat((0,T.default)(a,"spec.mysqlVersion")),sidecarImage:(0,T.default)(a,"spec.podPolicy.sidecarImage")});case L.RadonDBAppId.RedisCluster:var C={master:(0,T.default)(a,"spec.redisLeader.replicas")};return"hostname"!==(0,T.default)(a,"spec.kubernetesConfig.endpointType")&&(C.proxy=(0,T.default)(a,"spec.redisProxy.replicas",0)),H(H({},i),{},{icon:"/extensions-static/ks-console-embed/dist/v3dist/assets/radondb_redis.svg",cpu:(0,T.default)(a,"spec.kubernetesConfig.resources.requests.cpu"),memory:(0,T.default)(a,"spec.kubernetesConfig.resources.requests.memory"),storage:(0,T.default)(a,"spec.storage.volumeClaimTemplate.spec.resources.requests.storage"),storageclass:(0,T.default)(a,"spec.storage.volumeClaimTemplate.spec.storageClassName"),shardsCount:(0,T.default)(a,"spec.redisLeader.replicas",0),replicasCount:(0,T.default)(a,"spec.redisFollower.replicas",0),specifications:{master:(0,T.default)(a,"spec.kubernetesConfig.resources.requests"),proxy:(0,T.default)(a,"spec.redisProxy.resources.requests")},nodes:C,databaseVersionText:"Redis ".concat((0,T.default)(a,"spec.kubernetesConfig.redisVersion"))});case L.RadonDBAppId.RedisSentinel:return H(H({},i),{},{icon:"/extensions-static/ks-console-embed/dist/v3dist/assets/radondb_redis.svg",cpu:(0,T.default)(a,"spec.kubernetesConfig.resources.requests.cpu"),memory:(0,T.default)(a,"spec.kubernetesConfig.resources.requests.memory"),storage:(0,T.default)(a,"spec.storage.volumeClaimTemplate.spec.resources.requests.storage"),storageclass:(0,T.default)(a,"spec.storage.volumeClaimTemplate.spec.storageClassName"),shardsCount:(0,T.default)(a,"spec.clusterSize",0),replicasCount:(0,T.default)(a,"spec.clusterSize",1)-1,databaseVersionText:"Redis ".concat((0,T.default)(a,"spec.kubernetesConfig.redisVersion"))});case L.RadonDBAppId.MongoDB:return H(H({},i),{},{icon:"/extensions-static/ks-console-embed/dist/v3dist/assets/mongo-db.svg",cpu:(0,T.default)(a,"spec.statefulSet.spec.template.spec.containers[0].resources.requests.cpu"),memory:(0,T.default)(a,"spec.statefulSet.spec.template.spec.containers[0].resources.requests.memory"),storage:(0,T.default)(a,"spec.statefulSet.spec.volumeClaimTemplates[0].spec.resources.requests.storage"),storageclass:(0,T.default)(a,"spec.statefulSet.spec.volumeClaimTemplates[0].spec.storageClassName"),shardsCount:(0,T.default)(a,"spec.members",0),databaseVersionText:"MongoDB ".concat((0,T.default)(a,"spec.version"))});case L.RadonDBAppId.Elasticsearch:var A=(0,T.default)(a,"spec.nodeSets",[]).map((function(e){return{name:e.name,count:e.count,specifications:(0,T.default)(e,"podTemplate.spec.containers[0].resources.requests"),storage:(0,T.default)(e,"volumeClaimTemplates[0].spec.resources.requests.storage")}})),D={count:0,specifications:{memory:"4Gi",cpu:"2000m"},storage:"20Gi"},P=A.find((function(e){return e.name.includes("master")}))||H(H({},D),{},{specifications:{memory:"1Gi",cpu:"2000m"}}),N=A.find((function(e){return e.name.includes("hot")}))||D,I=A.find((function(e){return e.name.includes("warm")}))||D,w=A.find((function(e){return e.name.includes("cold")}))||D;return H(H({},i),{},{icon:"/extensions-static/ks-console-embed/dist/v3dist/assets/eck.svg",app_name:"ECK",databaseVersionText:"ES ".concat((0,T.default)(a,"spec.version")),nodes:{master:P.count,hot:N.count,warm:I.count,cold:w.count},specifications:{master:P.specifications,hot:N.specifications,warm:I.specifications,cold:w.specifications,kibana:{}},storages:{hot:N.storage,warm:I.storage,cold:w.storage},storageclass:(0,T.default)(a,"spec.nodeSets[0].volumeClaimTemplates[0].spec.storageClassName")});case L.RadonDBAppId.Kafka:var x=(0,T.default)(a,"spec.kafka.listeners[0].authentication.type"),M=l?"Running"===l||"Creating"===l?l:"Failed":"Unknown";return H(H({},i),{},{status:M,icon:"/extensions-static/ks-console-embed/dist/v3dist/assets/radondb_kafka.svg",databaseVersionText:"Kafka ".concat((0,T.default)(a,"spec.kafka.version")),authentication:x,tls:(0,T.default)(a,"spec.kafka.listeners[0].tls"),nodes:{kafka:(0,T.default)(a,"spec.kafka.replicas"),zookeeper:(0,T.default)(a,"spec.zookeeper.replicas")},specifications:{kafka:(0,T.default)(a,"spec.kafka.resources.requests"),zookeeper:(0,T.default)(a,"spec.zookeeper.resources.requests")},storages:{kafka:(0,T.default)(a,"spec.kafka.storage.volumes[0].size"),zookeeper:(0,T.default)(a,"spec.zookeeper.storage.size")},storageclass:(0,T.default)(a,"spec.kafka.storage.volumes[0].class")});case L.RadonDBAppId.OpenSearch:var j=(0,T.default)(a,"spec.nodePools",[]).map((function(e){return{name:(0,T.default)(e,'additionalConfig["node.attr.datatier"]'),count:e.replicas,specifications:(0,T.default)(e,"resources.requests"),storage:(0,T.default)(e,"diskSize")}})),U={count:0,specifications:{memory:"4Gi",cpu:"2000m"},storage:"20Gi"},B=j.find((function(e){return e.name.includes("master")}))||H(H({},U),{},{specifications:{memory:"2Gi",cpu:"1000m"}}),F=j.find((function(e){return e.name.includes("hot")}))||U,Y=j.find((function(e){return e.name.includes("warm")}))||U,V=j.find((function(e){return e.name.includes("cold")}))||U;return H(H({},i),{},{databaseVersionText:"OpenSearch ".concat((0,T.default)(a,"spec.general.version")),nodes:{master:B.count,hot:F.count,warm:Y.count,cold:V.count,dashboard:(0,T.default)(a,"spec.dashboards.replicas",0)},specifications:{master:B.specifications,hot:F.specifications,warm:Y.specifications,cold:V.specifications,dashboard:(0,T.default)(a,"spec.dashboards.resources.requests",{memory:"2Gi",cpu:"1000m"}),logstash:{}},storages:{hot:F.storage,warm:Y.storage,cold:V.storage},storageclass:(0,T.default)(a,"spec.nodePools[0].persistence.pvc.storageClass")});default:return H({},i)}},W=(_=function(e){(0,f.default)(a,e);var t=V(a);function a(){var e;(0,i.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).serviceStore=new j.default,e.podStore=new B.default,e.getWatchListUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cluster,a=e.namespace;return"apis/application.kubesphere.io/v1alpha1/watch/manifests?labelSelector=".concat((0,w.joinSelector)({"kubesphere.io/cluster":globals.app.isMultiCluster?t:null,"kubesphere.io/namespace":a}))},e.getWatchUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name;return"apis/application.kubesphere.io/v1alpha1/watch/manifests/".concat(t)},(0,l.default)(e,"fetchList",g,(0,d.default)(e)),(0,l.default)(e,"fetchDetail",y,(0,d.default)(e)),e.updateDetailService=function(e,t){if(0!==t.length){var a=(0,T.default)(t,"[0]",{});if(e.app_id===L.RadonDBAppId.ClickHouse)e.services=[{label:"READ_AND_WRITE_ADDRESS",value:"http://".concat(a.address),type:a.type},{label:"READ_AND_WRITE_ADDRESS",value:"http://".concat(a.serviceName,".").concat(a.namespace,":").concat(a.tcpPort),type:"ClusterIP"}];else if(e.app_id===L.RadonDBAppId.MySQL||e.app_id===L.RadonDBAppId.PostgreSQL){e.services=[{label:"READ_AND_WRITE_ADDRESS",value:a.address,type:a.type}];var r=(0,T.default)(t,"[1]");r&&e.services.push({label:"READ_ONLY_ADDRESS",value:r.address,type:r.type})}else if(e.app_id===L.RadonDBAppId.Elasticsearch){var n=(0,T.default)(t,"[1]");if(n){var o=[{label:"READ_AND_WRITE_ADDRESS",value:a.address,type:a.type}];o.push({label:"KIBANA_ADDRESS",value:n.address,type:n.type}),e.services=o}}else if(e.app_id===L.RadonDBAppId.RedisSentinel){var c=(0,T.default)(t,"[1]",{});e.services=[{label:"PRIMARY_ADDRESS",value:a.address,type:a.type},{label:"STANDBY_ADDRESS",value:c.address,type:a.type}]}else if(e.app_id===L.RadonDBAppId.RedisCluster){var s=[],l=t.length,i=t[l-1];if(i.serviceName.includes("proxy")?(t.splice(-1,1),l--):i=null,l>2)s=t.filter((function(e){return"NodePort"===e.type})).map((function(e){var t=(0,T.default)(e,'_originData.metadata.labels["statefulset.kubernetes.io/pod-name"]');return{label:["master","leader"].includes(e.role)?"PRIMARY_ADDRESS":"STANDBY_ADDRESS",value:t?"".concat(e.serviceName,".").concat(t,".").concat(e.namespace,".svc:").concat(e.tcpPort):e.address,type:e.type}}));else{var u=(0,T.default)(t,"[1]",{});s=[{label:"PRIMARY_ADDRESS",value:a.address,type:a.type},{label:"STANDBY_ADDRESS",value:u.address,type:a.type}]}i&&s.unshift({label:"READ_AND_WRITE_ADDRESS",value:i.address,type:i.type}),e.services=s}else if(e.app_id===L.RadonDBAppId.Kafka){var d=[{label:"READ_AND_WRITE_ADDRESS",value:a.address,type:a.type||"ClusterIP"}];"NodePort"===a.type&&d.push({label:"READ_AND_WRITE_ADDRESS",value:"".concat(a.serviceName,".").concat(a.namespace,":").concat(a.tcpPort),type:"NodePort"}),e.services=d}else if(e.app_id===L.RadonDBAppId.OpenSearch&&t.length>1){e.services=[{label:"READ_AND_WRITE_ADDRESS",value:a.address,type:a.type}];var f=(0,T.default)(t,"[1]");f&&e.services.push({label:"DASHBOARD_ADDRESS",value:f.address,type:f.type})}else e.services=[{label:"READ_AND_WRITE_ADDRESS",value:a.address,type:a.type||"ClusterIP"}]}else e.services=[]},(0,l.default)(e,"delete",E,(0,d.default)(e)),(0,l.default)(e,"batchDelete",b,(0,d.default)(e)),(0,l.default)(e,"patch",S,(0,d.default)(e)),(0,l.default)(e,"updateVersion",O,(0,d.default)(e)),(0,l.default)(e,"updateShardsCount",R,(0,d.default)(e)),(0,l.default)(e,"updateStorage",k,(0,d.default)(e)),(0,l.default)(e,"updateSpecifications",C,(0,d.default)(e)),e}return(0,u.default)(a,[{key:"getSecretUrl",value:function(e,t,a){return"/api".concat(globals.app.isMultiCluster&&e?"/clusters/".concat(e):"","/v1/namespaces/").concat(t,"/secrets/").concat(a)}},{key:"updateDetail",value:function(e){var t=e.detail,a=e.namespace,r=e.cluster,n=e.workspace;this.detail=H(H(H({},this.detail),K(t,n)),{},{namespace:a,cluster:r})}},{key:"getECKKibanaUrl",value:function(e,t,a){return"/apis".concat(globals.app.isMultiCluster&&e?"/clusters/".concat(e):"","/kibana.k8s.elastic.co/v1/namespaces/").concat(t,"/kibanas").concat(a?"/".concat(a):"")}},{key:"getLogstashUrl",value:function(e,t,a){return"/apis".concat(globals.app.isMultiCluster&&e?"/clusters/".concat(e):"","/opensearch.opster.io/v1/namespaces/").concat(t,"/logstashes").concat(a?"/".concat(a):"")}}]),a}(M.default),g=(0,h.default)(_.prototype,"fetchList",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,s.default)(n.default.mark((function t(){var a,r,s,l,i,u,d,f,p,m,h,v,_,g,y,E=arguments;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=E.length>0&&void 0!==E[0]?E[0]:{},r=a.limit,s=a.page,l=a.workspace,i=a.cluster,u=a.namespace,d=a.more,f=a.status,p=a.reverse,m=(0,c.default)(a,["limit","page","workspace","cluster","namespace","more","status","reverse"]),e.list.isLoading=!0,h={conditions:(0,w.getFilterString)({status:f||e.defaultStatus})},(0,D.default)(m)||(v=(0,w.getFilterString)(m),h.conditions+=v?",".concat(v):""),r!==1/0&&(h.paging="limit=".concat(r||10,",page=").concat(s||1)),t.next=7,request.get((0,U.getManifestApi)({workspace:l,namespace:u,cluster:i}),h);case 7:return _=t.sent,(g=(_.items||[]).map((function(e){return H(H({},K(e,l)),{},{cluster:i})}))).sort((function(e,t){return m.ascending?(0,x.default)(e.creationTimestamp).isSameOrBefore(t.creationTimestamp)?-1:1:(0,x.default)(e.creationTimestamp).isSameOrBefore(t.creationTimestamp)?1:-1})),y=g.map((function(t){return e.serviceStore.fetchList({cluster:i,namespace:u,chi:t.name,app_id:t.app_id})})),t.next=13,Promise.all(y);case 13:return t.sent.forEach((function(t,a){e.updateDetailService(g[a],t)})),Object.assign(e.list,{data:d?[].concat((0,o.default)(e.list.data),(0,o.default)(g)):g,total:_.total_count||g.length,limit:Number(r)||10,page:Number(s)||1,reverse:p,filters:m,isLoading:!1,selectedRowKeys:[]}),t.abrupt("return",g);case 17:case"end":return t.stop()}}),t)})))}}),y=(0,h.default)(_.prototype,"fetchDetail",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,s.default)(n.default.mark((function t(a){var r,o,c,s,l,i,u,d,f,p,m,h,v,_,g,y,E,b,S;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,o=a.namespace,c=a.cluster,s=a.id,e.isLoading=!0,t.next=4,request.get((0,U.getManifestApi)({workspace:r,namespace:o,cluster:c,cluster_id:s}));case 4:return l=t.sent,e.updateDetail({detail:l,namespace:o,cluster:c,workspace:r}),t.next=8,e.podStore.fetchList({workspace:r,namespace:o,cluster:c,chi:s,app_id:e.detail.app_id});case 8:return i=t.sent,t.next=11,e.serviceStore.fetchList({cluster:c,namespace:o,chi:s,app_id:e.detail.app_id});case 11:return u=t.sent,t.next=14,request.get("/kapis".concat(globals.app.isMultiCluster?"/clusters/".concat(c):"","/resources.kubesphere.io/v1alpha3/storageclasses?sortBy=createTime"));case 14:if(d=t.sent,f=d.items.map((function(e){return{name:e.metadata.name,allowVolumeExpansion:e.allowVolumeExpansion}})),p=(0,T.default)(f.find((function(t){return t.name===e.detail.storageclass})),"allowVolumeExpansion",!1),m=(0,T.default)(i,"[0].capacity",e.detail.storage),e.detail.app_id!==L.RadonDBAppId.PostgreSQL){t.next=22;break}m=(0,T.default)(i.find((function(e){return e.name.includes("postgresql")})),"capacity",e.detail.storage),t.next=44;break;case 22:if(e.detail.app_id!==L.RadonDBAppId.Elasticsearch){t.next=36;break}return e.detail.realStorages={hot:(0,T.default)(i.find((function(e){return!0===(0,T.default)(e,'metadata.labels["elasticsearch.k8s.elastic.co/node-hot"]')})),"capacity",e.detail.storages.hot),warm:(0,T.default)(i.find((function(e){return!0===(0,T.default)(e,'metadata.labels["elasticsearch.k8s.elastic.co/node-warm"]')})),"capacity",e.detail.storages.warm),cold:(0,T.default)(i.find((function(e){return!0===(0,T.default)(e,'metadata.labels["elasticsearch.k8s.elastic.co/node-cold"]')})),"capacity",e.detail.storages.cold)},h={},t.next=27,request.get(e.getECKKibanaUrl(c,o,s));case 27:h=t.sent,v=(0,T.default)(h,"spec.count",0),e.detail.nodes.kibana=v,_=(0,T.default)(h,"spec.podTemplate.spec.containers[0].resources.requests"),parseInt(_.cpu,10)<100&&(_.cpu="".concat(1e3*parseInt(_.cpu,10),"m")),e.detail.specifications.kibana=_,p=!0,t.next=44;break;case 36:if(e.detail.app_id!==L.RadonDBAppId.OpenSearch){t.next=44;break}return t.next=39,request.get(e.getLogstashUrl(c,o,s));case 39:g=t.sent,e.detail.nodes.logstash=(0,T.default)(g,"spec.replicas",0),y=(0,T.default)(g,"spec.podTemplate.spec.containers[0].resources.requests"),parseInt(y.cpu,10)<100&&(y.cpu="".concat(1e3*parseInt(y.cpu,10),"m")),e.detail.specifications.logstash=y;case 44:if(e.updateDetailService(e.detail,u),E=null,e.detail.app_id!==L.RadonDBAppId.Kafka||!e.detail.tls){t.next=52;break}return t.next=49,request.get(e.getSecretUrl(c,o,"".concat(s,"-cluster-ca-cert")));case 49:b=t.sent,S=window.atob||I.safeAtob,E={cert:S((0,T.default)(b,'data["ca.p12"]',"")),password:S((0,T.default)(b,'data["ca.password"]',"")),validDate:(0,w.getLocalTime)((0,T.default)(b,"metadata.creationTimestamp")).add(3650,"d").format("YYYY.MM.DD")};case 52:e.detail=H(H({},e.detail),{},{allowVolumeExpansion:p,realStorage:m,secret:E}),e.isLoading=!1;case 54:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),E=(0,h.default)(_.prototype,"delete",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.workspace,r=t.cluster_id,n=t.cluster,o=t.namespace,c=t.name;return e.submitting(request.delete((0,U.getManifestApi)({workspace:a,namespace:o,cluster_id:r||c,cluster:n})))}}}),b=(0,h.default)(_.prototype,"batchDelete",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var r=a.workspace,n=a.namespace,o=a.cluster;return e.submitting(Promise.all(t.map((function(e){return request.delete((0,U.getManifestApi)({workspace:r,namespace:n,cluster:o,cluster_id:e}))}))))}}}),S=(0,h.default)(_.prototype,"patch",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,s.default)(n.default.mark((function t(a,r){var o,c,s,l,i,u;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.workspace,c=r.cluster_id,s=r.cluster,l=r.namespace,i=r.description,t.next=3,request.get((0,U.getManifestApi)({workspace:o,namespace:l,cluster_id:c,cluster:s}));case 3:return(u=t.sent).description=i,u.version+=1,t.next=8,request.put((0,U.getManifestApi)({workspace:o,namespace:l,cluster_id:c,cluster:s}),u);case 8:e.updateDetail({detail:u,namespace:l,cluster:s,workspace:o});case 9:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}}),O=(0,h.default)(_.prototype,"updateVersion",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,s.default)(n.default.mark((function t(a){var r,o,c,s,l,i,u,d,f,p;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,o=a.cluster_id,c=a.workspace,s=a.namespace,t.next=3,request.get((0,U.getManifestApi)({workspace:c,namespace:s,cluster_id:o,cluster:r}));case 3:l=t.sent,i=JSON.parse(l.customResource),t.t0=a.app_id,t.next=t.t0===L.RadonDBAppId.OpenSearch?8:22;break;case 8:return(0,A.default)(i,"spec.general.version","2.8.0"),(0,A.default)(i,"spec.dashboards.version","2.8.0"),(0,A.default)(i,"spec.confMgmt.forceRestart",!0),u=e.getLogstashUrl(r,s,o),t.next=14,request.get(u);case 14:return d=t.sent,f={name:"exporter",resources:{requests:{memory:"400Mi",cpu:"200m"},limits:{memory:"400Mi",cpu:"200m"}}},p=(0,T.default)(d,"spec.podTemplate.spec.containers"),(0,P.default)(p,(function(e){return"exporter"===e.name}))||(p.push(f),(0,A.default)(d,"spec.podTemplate.spec.containers",p)),t.next=21,request.put(u,d);case 21:case 22:return t.abrupt("break",23);case 23:return l.customResource=JSON.stringify(i),l.version+=1,t.next=27,request.put((0,U.getManifestApi)({workspace:c,namespace:s,cluster_id:o,cluster:r}),l);case 27:e.updateDetail({detail:l,namespace:s,cluster:r,workspace:c});case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),R=(0,h.default)(_.prototype,"updateShardsCount",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,s.default)(n.default.mark((function t(a){var r,c,s,l,i,u,d,f,p,m,h,v,_,g,y,E,b,S,O,R,k,C,D,P;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,c=a.cluster_id,s=a.cluster,l=a.namespace,i=a.shardsCount,u=a.nodeRole,d=a.specifications,f=a.storage,t.next=3,request.get((0,U.getManifestApi)({workspace:r,namespace:l,cluster_id:c,cluster:s}));case 3:p=t.sent,m=JSON.parse(p.customResource),t.t0=e.detail.app_id,t.next=t.t0===L.RadonDBAppId.ClickHouse?8:t.t0===L.RadonDBAppId.PostgreSQL?11:t.t0===L.RadonDBAppId.MySQL?13:t.t0===L.RadonDBAppId.RedisCluster?15:t.t0===L.RadonDBAppId.RedisSentinel?18:t.t0===L.RadonDBAppId.MongoDB?21:t.t0===L.RadonDBAppId.Elasticsearch?23:t.t0===L.RadonDBAppId.Kafka?51:t.t0===L.RadonDBAppId.OpenSearch?53:78;break;case 8:return h=(0,T.default)(m,"spec.configuration.clusters[0].layout"),(0,A.default)(m,"spec.configuration.clusters[0].layout",H(H({},h),{},{shardsCount:i})),t.abrupt("break",79);case 11:return(0,A.default)(m,"spec.postgresql.readwriteinstance.replicas",i),t.abrupt("break",79);case 13:return(0,A.default)(m,"spec.replicas",i),t.abrupt("break",79);case 15:return v=(0,L.getCpuAndMemoryFromSpecifications)(d),"proxy"===u?((0,A.default)(m,"spec.redisProxy.replicas",i),(0,A.default)(m,"spec.redisProxy.resources.requests",v),(0,A.default)(m,"spec.redisProxy.resources.limits",v),i>0&&(0,A.default)(m,"spec.redisProxy.enabled",!0)):((0,A.default)(m,"spec.clusterSize",i),(0,A.default)(m,"spec.redisLeader.replicas",i),(0,A.default)(m,"spec.redisFollower.replicas",i)),t.abrupt("break",79);case 18:return(0,A.default)(m,"spec.clusterSize",i),(0,A.default)(m,"spec.redisReplica.replicas",i),t.abrupt("break",79);case 21:return(0,A.default)(m,"spec.members",i),t.abrupt("break",79);case 23:if(_=(0,L.getCpuAndMemoryFromSpecifications)(d),"kibana"!==u){t.next=36;break}return g=e.getECKKibanaUrl(s,l,c),t.next=28,request.get(g);case 28:return y=t.sent,(0,A.default)(y,"spec.count",i),(0,A.default)(y,"spec.podTemplate.spec.containers[0].resources.requests",_),(0,A.default)(y,"spec.podTemplate.spec.containers[0].resources.limits",_),t.next=34,request.put(g,y);case 34:return e.detail.nodes.kibana=i,t.abrupt("return");case 36:if(E=(0,T.default)(m,"spec.nodeSets",[]),b=E.find((function(e){return e.name.startsWith(u)}))){t.next=46;break}if(S=(0,T.default)(F.eckYaml.resources,"spec.nodeSets",[]),b=S.find((function(e){return e.name.startsWith(u)}))){t.next=43;break}return t.abrupt("break",79);case 43:b=JSON.parse(JSON.stringify(b)),(0,A.default)(b,"volumeClaimTemplates[0].spec.storageClassName",(0,T.default)(E,"[0].volumeClaimTemplates[0].spec.storageClassName")),(0,A.default)(m,"spec.nodeSets",[].concat((0,o.default)(E),[b]));case 46:return(0,A.default)(b,"count",i),(0,A.default)(b,"podTemplate.spec.containers[0].resources",{limits:_,requests:_}),(0,A.default)(b,"podTemplate.spec.containers[0].env[0].value","-Xms".concat(parseInt(_.memory,10)/2,"g -Xmx").concat(parseInt(_.memory,10)/2,"g")),(0,A.default)(b,"volumeClaimTemplates[0].spec.resources.requests.storage",f),t.abrupt("break",79);case 51:return(0,A.default)(m,"spec.".concat(u,".replicas"),i),t.abrupt("break",79);case 53:if(O=(0,L.getCpuAndMemoryFromSpecifications)(d),"logstash"!==u){t.next=66;break}return R=e.getLogstashUrl(s,l,c),t.next=58,request.get(R);case 58:return k=t.sent,(0,A.default)(k,"spec.replicas",i),(0,A.default)(k,"spec.podTemplate.spec.containers[0].resources",{requests:O,limits:O}),t.next=63,request.put(R,k);case 63:return e.detail.nodes.logstash=i,e.detail=H({},e.detail),t.abrupt("return");case 66:if("dashboard"!==u){t.next=71;break}return i>0&&(0,A.default)(m,"spec.dashboards.enable",!0),(0,A.default)(m,"spec.dashboards.replicas",i),(0,A.default)(m,"spec.dashboards.resources",{requests:O,limits:O}),t.abrupt("break",79);case 71:return C=(0,T.default)(m,"spec.nodePools",[]),(D=C.find((function(e){return(0,T.default)(e,'additionalConfig["node.attr.datatier"]')===u})))||(P=(0,T.default)(C,"[0].persistence.pvc.storageClass"),D=JSON.parse(JSON.stringify(Y.opensearchYaml.node)),(0,A.default)(D,'additionalConfig["node.attr.datatier"]',u),(0,A.default)(D,"component","data-node-".concat(u)),(0,A.default)(D,"persistence.pvc.storageClass",P),(0,A.default)(m,"spec.nodePools",[].concat((0,o.default)(C),[D]))),(0,A.default)(D,"replicas",i),(0,A.default)(D,"resources",{limits:O,requests:O}),(0,A.default)(D,"diskSize",f),t.abrupt("break",79);case 78:return t.abrupt("break",79);case 79:return p.customResource=JSON.stringify(m),p.version+=1,t.next=83,request.put((0,U.getManifestApi)({workspace:r,namespace:l,cluster_id:c,cluster:s}),p);case 83:e.updateDetail({detail:p,namespace:l,cluster:s,workspace:r});case 84:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),k=(0,h.default)(_.prototype,"updateStorage",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,s.default)(n.default.mark((function t(a){var r,o,c,s,l,i,u,d,f,p,m,h;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,o=a.cluster_id,c=a.cluster,s=a.namespace,l=a.storage,i=a.nodeRole,t.next=3,request.get((0,U.getManifestApi)({workspace:r,namespace:s,cluster_id:o,cluster:c}));case 3:u=t.sent,d=JSON.parse(u.customResource),parseFloat(l)<10&&(l="10Gi"),t.t0=e.detail.app_id,t.next=t.t0===L.RadonDBAppId.ClickHouse?9:t.t0===L.RadonDBAppId.PostgreSQL?11:t.t0===L.RadonDBAppId.MySQL?13:t.t0===L.RadonDBAppId.RedisCluster||t.t0===L.RadonDBAppId.RedisSentinel?15:t.t0===L.RadonDBAppId.MongoDB?17:t.t0===L.RadonDBAppId.Elasticsearch?19:t.t0===L.RadonDBAppId.Kafka?23:t.t0===L.RadonDBAppId.OpenSearch?25:29;break;case 9:return(0,A.default)(d,"spec.templates.volumeClaimTemplates[0].spec.resources.requests.storage",l),t.abrupt("break",30);case 11:return(0,A.default)(d,"spec.postgresql.readwriteinstance.volumeClaimTemplates[0].spec.resources.requests.storage",l),t.abrupt("break",30);case 13:return(0,A.default)(d,"spec.persistence.size",l),t.abrupt("break",30);case 15:return(0,A.default)(d,"spec.storage.volumeClaimTemplate.spec.resources.requests.storage",l),t.abrupt("break",30);case 17:return(0,A.default)(d,"spec.statefulSet.spec.volumeClaimTemplates[0].spec.resources.requests.storage",l),t.abrupt("break",30);case 19:return f=(0,T.default)(d,"spec.nodeSets",[]),(p=f.find((function(e){return e.name.startsWith(i)})))&&((0,A.default)(p,"volumeClaimTemplates[0].spec.resources.requests.storage",l),(0,A.default)(p,"name","".concat(i,"-").concat(l.toLowerCase()))),t.abrupt("break",30);case 23:return"kafka"===i?(0,A.default)(d,"spec.kafka.storage.volumes[0].size",l):(0,A.default)(d,"spec.zookeeper.storage.size",l),t.abrupt("break",30);case 25:return m=(0,T.default)(d,"spec.nodePools",[]),h=m.find((function(e){return(0,T.default)(e,'additionalConfig["node.attr.datatier"]')===i})),(0,A.default)(h,"diskSize",l),t.abrupt("break",30);case 29:return t.abrupt("break",30);case 30:return u.customResource=JSON.stringify(d),u.version+=1,t.next=34,request.put((0,U.getManifestApi)({workspace:r,namespace:s,cluster_id:o,cluster:c}),u);case 34:i?(0,A.default)(e.detail,"realStorages[".concat(i,"]"),l):e.detail.realStorage=l,e.updateDetail({detail:u,namespace:s,cluster:c,workspace:r});case 36:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),C=(0,h.default)(_.prototype,"updateSpecifications",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,s.default)(n.default.mark((function t(a){var r,o,c,s,l,i,u,d,f,p,m,h,v,_,g,y,E;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,o=a.cluster_id,c=a.cluster,s=a.namespace,l=a.specifications,i=a.nodeRole,u=(0,L.getCpuAndMemoryFromSpecifications)(l),t.next=4,request.get((0,U.getManifestApi)({workspace:r,namespace:s,cluster_id:o,cluster:c}));case 4:d=t.sent,f=JSON.parse(d.customResource),t.t0=e.detail.app_id,t.next=t.t0===L.RadonDBAppId.ClickHouse?9:t.t0===L.RadonDBAppId.PostgreSQL?12:t.t0===L.RadonDBAppId.MySQL?14:t.t0===L.RadonDBAppId.RedisCluster?17:t.t0===L.RadonDBAppId.RedisSentinel?19:t.t0===L.RadonDBAppId.MongoDB?22:t.t0===L.RadonDBAppId.Elasticsearch?25:t.t0===L.RadonDBAppId.Kafka?40:t.t0===L.RadonDBAppId.OpenSearch?43:60;break;case 9:return(0,A.default)(f,"spec.templates.podTemplates[0].spec.containers[0].resources.limits",u),(0,A.default)(f,"spec.templates.podTemplates[0].spec.containers[0].resources.requests",u),t.abrupt("break",61);case 12:return(0,A.default)(f,"spec.postgresql.readwriteinstance.podspec.containers[0].resources",{requests:u,limits:u}),t.abrupt("break",61);case 14:return(0,A.default)(f,"spec.mysqlOpts.resources.requests",u),(0,A.default)(f,"spec.mysqlOpts.resources.limits",u),t.abrupt("break",61);case 17:return"proxy"===i?((0,A.default)(f,"spec.redisProxy.resources.requests",u),(0,A.default)(f,"spec.redisProxy.resources.limits",u)):((0,A.default)(f,"spec.kubernetesConfig.resources.requests",u),(0,A.default)(f,"spec.kubernetesConfig.resources.limits",u)),t.abrupt("break",61);case 19:return(0,A.default)(f,"spec.kubernetesConfig.resources.requests",u),(0,A.default)(f,"spec.kubernetesConfig.resources.limits",u),t.abrupt("break",61);case 22:return(0,A.default)(f,"spec.statefulSet.spec.template.spec.containers[0].resources.requests",u),(0,A.default)(f,"spec.statefulSet.spec.template.spec.containers[0].resources.limits",u),t.abrupt("break",61);case 25:if("kibana"!==i){t.next=36;break}return p=e.getECKKibanaUrl(c,s,o),t.next=29,request.get(p);case 29:return m=t.sent,(0,A.default)(m,"spec.podTemplate.spec.containers[0].resources.requests",u),(0,A.default)(m,"spec.podTemplate.spec.containers[0].resources.limits",u),t.next=34,request.put(p,m);case 34:return e.detail.specifications.kibana=u,t.abrupt("return");case 36:return h=(0,T.default)(f,"spec.nodeSets",[]),(v=h.find((function(e){return e.name.startsWith(i)})))&&((0,A.default)(v,"podTemplate.spec.containers[0].resources",{limits:u,requests:u}),(0,A.default)(v,"podTemplate.spec.containers[0].env[0].value","-Xms".concat(parseInt(u.memory,10)/2,"g -Xmx").concat(parseInt(u.memory,10)/2,"g"))),t.abrupt("break",61);case 40:return(0,A.default)(f,"spec.".concat(i,".resources.requests"),u),(0,A.default)(f,"spec.".concat(i,".resources.limits"),u),t.abrupt("break",61);case 43:if("logstash"!==i){t.next=53;break}return _=e.getLogstashUrl(c,s,o),t.next=47,request.get(_);case 47:return g=t.sent,(0,A.default)(g,"spec.podTemplate.spec.containers[0].resources",{requests:u,limits:u}),t.next=51,request.put(_,g);case 51:return e.detail=H({},e.detail),t.abrupt("return");case 53:if("dashboard"!==i){t.next=56;break}return(0,A.default)(f,"spec.dashboards.resources",{requests:u,limits:u}),t.abrupt("break",61);case 56:return y=(0,T.default)(f,"spec.nodePools",[]),E=y.find((function(e){return(0,T.default)(e,'additionalConfig["node.attr.datatier"]')===i})),(0,A.default)(E,"resources",{limits:u,requests:u}),t.abrupt("break",61);case 60:return t.abrupt("break",61);case 61:return d.customResource=JSON.stringify(f),d.version+=1,t.next=65,request.put((0,U.getManifestApi)({workspace:r,namespace:s,cluster_id:o,cluster:c}),d);case 65:e.updateDetail({detail:d,namespace:s,cluster:c,workspace:r});case 66:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),_);t.default=W},1222:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(70),r(20),r(51),r(14),r(24),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(51),r(29),r(14),r(24),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(73),r(7);var o=n(r(38)),c=n(r(31)),s=n(r(50));r(35);var l,i,u,d=n(r(39)),f=n(r(62)),p=n(r(25)),m=n(r(28)),h=n(r(74)),v=n(r(41)),_=n(r(42)),g=n(r(37)),y=n(r(45)),E=(n(r(63)),n(r(26))),b=r(17),S=n(r(49)),O=r(439),R=r(815);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,g.default)(e);if(t){var n=(0,g.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,_.default)(this,a)}}var T=(l=function(e){(0,v.default)(a,e);var t=A(a);function a(){var e;(0,p.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).resourceName="db_services",(0,f.default)(e,"data",i,(0,h.default)(e)),e.getUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.cluster,r=t.namespace,n=t.chi,o=t.app_id,c="".concat(e.baseUrl).concat(e.getPath({cluster:a,namespace:r}),"/pods?labelSelector=");return c+=e.getLabelSelector(o,n)},e.getWatchListUrl=function(t){var a=t.namespace,r=t.cluster,n=t.app_id,o=t.chi;return"api/v1/watch/klusters/".concat(r,"/namespaces/").concat(a,"/pods?labelSelector=").concat(e.getLabelSelector(n,o))},(0,f.default)(e,"fetchList",u,(0,h.default)(e)),e}return(0,m.default)(a,[{key:"getPath",value:function(e){var t=e.namespace,a=e.cluster,r="";return globals.app.isMultiCluster&&a&&(r+="/clusters/".concat(a)),r+="/v1",t&&(r+="/namespaces/".concat(t)),r}},{key:"getCapacityUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cluster,a=e.namespace,r=e.chi,n=e.app_id,o="".concat(this.baseUrl).concat(this.getPath({cluster:t,namespace:a}),"/persistentvolumeclaims?labelSelector=");return o+=this.getLabelSelector(n,r,!0)}},{key:"getLabelSelector",value:function(e,t,a){switch(e){case R.RadonDBAppId.ClickHouse:return"clickhouse.radondb.com/zooKeeper!=zookeeper,clickhouse.radondb.com/chi=".concat(t);case R.RadonDBAppId.PostgreSQL:return"app-name=".concat(t);case R.RadonDBAppId.RedisCluster:case R.RadonDBAppId.RedisSentinel:return"redis.radondb.com/name=".concat(t);case R.RadonDBAppId.Elasticsearch:return"elasticsearch.k8s.elastic.co/cluster-name=".concat(t);case R.RadonDBAppId.Kafka:return"app.kubernetes.io/instance=".concat(t,"".concat(a?"":",strimzi.io/controller=strimzipodset"));default:return"app.kubernetes.io/instance=".concat(t)}}},{key:"baseUrl",get:function(){return"/api"}}]),a}(S.default),i=(0,y.default)(l.prototype,"data",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u=(0,y.default)(l.prototype,"fetchList",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,d.default)(o.default.mark((function a(){var r,n,c,l,i,u,d,f,p,m,h,v,_,g,y,b,S,k=arguments;return o.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=k.length>0&&void 0!==k[0]?k[0]:{},n=r.esKibana,c=(0,s.default)(r,["esKibana"]),a.next=3,request.get(e.getUrl(c));case 3:return l=a.sent,a.next=6,request.get(e.getCapacityUrl(c));case 6:if(i=a.sent,e.isLoading=!0,u=c.dataFilters||{},d=u.limit,f=void 0===d?10:d,p=u.page,m=void 0===p?1:p,h=(0,s.default)(u,["limit","page"]),v={items:[]},_={items:[]},!n){a.next=19;break}return g=c.cluster,y=c.namespace,b=c.chi,a.next=15,request.get("".concat(e.baseUrl).concat(e.getPath({cluster:g,namespace:y}),"/pods?labelSelector=common.k8s.elastic.co/type=kibana,kibana.k8s.elastic.co/name=").concat(b));case 15:return v=a.sent,a.next=18,request.get("".concat(e.baseUrl).concat(e.getPath({cluster:g,namespace:y}),"/persistentvolumeclaims?labelSelector=common.k8s.elastic.co/type=kibana,kibana.k8s.elastic.co/name=").concat(b));case 18:_=a.sent;case 19:return S=l.items.concat(v.items||[]).map((function(e){var a=(0,E.default)(e,"metadata.labels.role"),r="",n=["leader","master","LEADER","primary"].includes(a)?t("PRIMARY_NODE"):t("STANDBY_NODE");if(c.app_id===R.RadonDBAppId.PostgreSQL)"autofailover"===(r=(0,E.default)(e,'metadata.labels["node-name"]'))&&(n=t("MANAGEMENT_NODE"));else if(c.app_id===R.RadonDBAppId.RedisSentinel)"master"===(0,E.default)(e,'metadata.labels["redis.radondb.com/role"]')&&(n=t("PRIMARY_NODE")),"sentinel"===a&&(n=t("SENTINEL_NODE"));else if(c.app_id===R.RadonDBAppId.Elasticsearch)"true"===(0,E.default)(e,'metadata.labels["elasticsearch.k8s.elastic.co/node-master"]')?(n=t("PRIMARY_NODE"),r="master"):"true"===(0,E.default)(e,'metadata.labels["elasticsearch.k8s.elastic.co/node-data_hot"]')?(n=t("HOT_NODE"),r="hot"):"true"===(0,E.default)(e,'metadata.labels["elasticsearch.k8s.elastic.co/node-data_warm"]')?(n=t("WARM_NODE"),r="warm"):"true"===(0,E.default)(e,'metadata.labels["elasticsearch.k8s.elastic.co/node-data_cold"]')?(n=t("COLD_NODE"),r="cold"):"kibana"===(0,E.default)(e,'metadata.labels["common.k8s.elastic.co/type"]')&&(n=t("KIBANA_NODE"),r="kibana");else if(c.app_id===R.RadonDBAppId.Kafka)"kafka"===(0,E.default)(e,'metadata.labels["app.kubernetes.io/name"]')?(n=t("KAFKA_NODE"),r="kafka"):"zookeeper"===(0,E.default)(e,'metadata.labels["app.kubernetes.io/name"]')&&(n=t("ZOOKEEPER_NODE"),r="zookeeper");else if(c.app_id===R.RadonDBAppId.OpenSearch){var o=(0,E.default)(e,'metadata.labels["opster.io/opensearch-nodepool"]');"data-node-hot"===o?(n=t("HOT_NODE"),r="hot"):"data-node-warm"===o?(n=t("WARM_NODE"),r="warm"):"data-node-cold"===o?(n=t("COLD_NODE"),r="cold"):"masters"===o&&(n=t("PRIMARY_NODE"),r="master"),(0,E.default)(e,'metadata.labels["opensearch.opster.io/logstash"]')&&(r="logstash",n=t("LOGSTASH_NODE")),(0,E.default)(e,'metadata.labels["opensearch.cluster.dashboards"]')&&(r="dashboard",n=t("DASHBOARD_NODE"),v.items.push(e))}var s="proxy"===(0,E.default)(e,"metadata.labels.redis_setup_type","");s&&(n=t("PROXY_NODE"));var l=(0,O.getPodStatusAndRestartCount)(e);return{name:e.metadata.name,creationTimestamp:e.metadata.creationTimestamp,status:(0,E.default)(l,"type","creating"),ip:e.status.podIP,spec:(0,E.default)(e,"spec.containers[0].resources.limits",{cpu:"",memory:""}),serviceName:e.spec.subdomain,capacity:(0,E.default)(i.items.concat(_.items||[]).find((function(t){return t.metadata.name.includes(e.metadata.name)||t.metadata.name===(0,E.default)(e,"metadata.labels[deployment-name]")})),"status.capacity.storage"),canDelete:c.app_id!==R.RadonDBAppId.ClickHouse,deploymentName:(0,E.default)(e,"metadata.labels[deployment-name]"),noMonitoring:(0,E.default)(v,"items",[]).includes(e),isPredixy:s,roleText:n,nodeRole:r}})).filter((function(e){var t=!0;if(c.app_id===R.RadonDBAppId.Elasticsearch&&e.name.includes("exporter")&&(t=!1),h)for(var a in h)if(e[a]&&!(t=e[a].includes(h[a])))break;return t})),e.list.update(C({data:S.slice((m-1)*f,m*f),total:S.length||0,filters:h,limit:Number(f),page:Number(m),isLoading:!1},e.list.silent?{}:{selectedRowKeys:[]})),e.data=S,e.isLoading=!1,a.abrupt("return",S);case 24:case"end":return a.stop()}}),a)})))}}),l);a.default=T},1229:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var o,c,s,l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(67)),v=r(243),_=r(189),g=n(r(801)),y=n(r(325)),E=r(56),b=n(r(3843)),S=n(r(1608));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var R=(0,v.observer)((s=c=function(e){(0,u.default)(r,e);var a=O(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).store=new y.default,e.getData=function(){var t=e.props,a=t.selector,r=t.cluster,n=t.namespace;(0,h.default)(a)||e.store.fetchListByK8s({cluster:r,namespace:n,labelSelector:(0,E.joinSelector)(a)})},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.getData()}},{key:"renderContent",value:function(){var e=this.props.prefix,a=this.store.list,r=a.data,n=a.isLoading;return(0,h.default)(r)&&!n?p.default.createElement("div",{className:S.default.empty},t("EMPTY_WRAPPER",{resource:t("SERVICE")})):p.default.createElement(_.Loading,{spinning:n},p.default.createElement("div",{className:S.default.content},r.map((function(t){return p.default.createElement(b.default,{key:t.uid,prefix:e,detail:t})}))))}},{key:"render",value:function(){var e=this.props.className;return p.default.createElement(g.default,{className:e,title:t("SERVICE_PL")},this.renderContent())}}]),r}(p.default.Component),c.propTypes={className:m.default.string,prefix:m.default.string,selector:m.default.object},c.defaultProps={prefix:"",selector:{}},o=s))||o;a.default=R},1230:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var o=n(r(38));r(35);var c,s,l,i=n(r(39)),u=n(r(25)),d=n(r(28)),f=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=n(r(1)),_=r(243),g=n(r(67)),y=n(r(456)),E=n(r(801)),b=r(56),S=n(r(464)),O=n(r(912)),R=n(r(3845));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var C=(0,_.observer)((l=s=function(e){(0,f.default)(r,e);var a=k(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return(e=a.call.apply(a,[this].concat(n))).state={gateway:{}},e.store=new S.default,e.gatewayStore=new O.default,e.getData=(0,i.default)(o.default.mark((function t(){var a,r,n,c,s,l;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props,r=a.cluster,n=a.namespace,c=a.selector,(0,g.default)(c)){t.next=8;break}return s={cluster:r,namespace:n,labelSelector:(0,b.joinSelector)(c)},t.next=5,e.gatewayStore.getNewGatewayByProject({cluster:r,namespace:n});case 5:l=t.sent,e.setState({gateway:l}),e.store.fetchListByK8s(s);case 8:case"end":return t.stop()}}),t)}))),e}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.getData()}},{key:"renderContent",value:function(){var e=this.props.prefix,t=this.store.list.data,a=this.state.gateway;return(0,g.default)(t)?null:t.map((function(t){var r=(0,y.default)(a,(function(e){return e.ingressClass===t.ingressClassName}));return h.default.createElement(R.default,{key:t.name,prefix:e,detail:t,gateway:r})}))}},{key:"render",value:function(){var e=this.props,a=e.className,r=e.title,n=this.renderContent();return n?h.default.createElement(E.default,{className:a,title:r||t("ROUTE_PL")},n):null}}]),r}(h.default.Component),s.propTypes={className:v.default.string,prefix:v.default.string,selector:v.default.object,title:v.default.string},s.defaultProps={prefix:""},c=l))||c;a.default=C},1231:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var o,c,s,l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(67)),v=r(243),_=n(r(451)),g=n(r(801)),y=r(56),E=n(r(3847)),b=n(r(1609));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var O=(0,v.observer)((s=c=function(e){(0,u.default)(r,e);var a=S(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).store=new _.default,e.getData=function(){var t=e.props,a=t.selector,r=t.cluster,n=t.namespace;(0,h.default)(a)||e.store.fetchListByK8s({cluster:r,namespace:n,labelSelector:(0,y.joinSelector)(a)})},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.getData()}},{key:"renderContent",value:function(){var e=this.props.prefix,t=this.store.list.data;return(0,h.default)(t)?null:p.default.createElement("div",{className:b.default.content},t.map((function(t,a){return p.default.createElement(E.default,{key:a,volume:t,prefix:e})})))}},{key:"render",value:function(){var e=this.props,a=e.className,r=e.title,n=this.renderContent();return n?p.default.createElement(g.default,{className:a,title:r||t("VOLUME_PL")},n):null}}]),r}(p.default.Component),c.propTypes={className:m.default.string,title:m.default.string,selector:m.default.object},c.defaultProps={className:""},o=s))||o;a.default=O},1232:function(e,t,a){e.exports={title:"_23ICmTFZPZciTzxk6GwlL7",workloads:"_2pydmsXzGwPczsCCJ75una",trafficCard:"_1IK6lET9gevbaUDSF49pYC"}},1233:function(e,t,a){e.exports={tag:"_3TU-AgwZKhTYBj4DFyGaYd",title:"_369ph_E2DAX2y_NpgwxabT",chart:"_277fRQi2DOGBy4yI3roVrO",chartDetail:"U6o8umlM6uCM_XaU0JaNm",circle:"_1xjLL8SyJTU8mVCMJafm71",leftPane:"_3De3dzq3-ZtBdXNIpWKeK7",selected:"_1Rq06DmTF8zwtDrYhm_Jm4",tip:"_2_wSsLRObqXFZ_kT0eXPhg"}},1234:function(e,t,a){e.exports={wrapper:"NIYOp_3ZpxtucxFOhGDxS",image:"_12zpgu_3ah3oONNKLDWl4c",footer:"_2R2JnOZA8qwhANxwDqziDW",items:"_3HAAkylLBWtyi2Ulicm5mP",item:"_3ap2A7wsdNinxlpfOJWRN8",icon:"_1dvmRmxMSb9SuqZATuQ3M4",iconExtra:"-pMYsB5LXpaiC807PW5sd",title:"_33LJI1QvrcWsEKm2a6JbX1",left:"_3u7seBT_Bxszz6-KADL9rG",right:"_1CV-q62afWGICi54uwkQM-",versions:"_1N38nS5eFjvxklmLdiNBJi",tag:"_10BSpN1wSXatPsR4gumtiH",loading:"_3oncm8IhLXZJiwMH55s8mf",chart:"_20slDQ31DTSOgN5QFZMsWa",chartDetail:"bGmKWnw69cnOMBg1gKklH",circle:"_2au74k5NIUPy1uZMIhmp4j",tip:"_6o9I9WEuv9Q3iooA87p-2"}},1596:function(e,t,a){"use strict";a(16);var r=a(19);a(66),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(66),a(29),a(4),a(18),a(43),a(11);var n,o,c,s,l=r(a(62)),i=r(a(25)),u=r(a(28)),d=r(a(74)),f=r(a(41)),p=r(a(42)),m=r(a(37)),h=r(a(45)),v=(r(a(63)),a(17)),_=a(56),g=r(a(1017));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var E=["workload_cpu_usage","workload_memory_usage_wo_cache","workload_gpu_usage","workload_gpu_memory_usage","workload_net_bytes_transmitted","workload_net_bytes_received"],b=["workload_cpu_usage","workload_memory_usage_wo_cache","workload_gpu_usage","workload_gpu_memory_usage","workload_net_bytes_transmitted","workload_net_bytes_received"],S=(n=function(e){(0,f.default)(a,e);var t=y(a);function a(e){var r;return(0,i.default)(this,a),r=t.call(this,e),(0,l.default)(r,"namespaces",o,(0,d.default)(r)),(0,l.default)(r,"sort_metric",c,(0,d.default)(r)),(0,l.default)(r,"changeNamespace",s,(0,d.default)(r)),r.sort_metric_options=(0,_.hideGPUByLicense)(e.sort_metric_options||E,r.cluster),r.metrics_filter=(0,_.hideGPUByLicense)(b,r.cluster).join("|"),r}return(0,u.default)(a,[{key:"fetchUrl",get:function(){return"".concat(this.apiVersion,"/workload_metrics")}}]),a}(g.default),o=(0,h.default)(n.prototype,"namespaces",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=(0,h.default)(n.prototype,"sort_metric",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return E[0]}}),s=(0,h.default)(n.prototype,"changeNamespace",[v.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.namespaces=t,e.fetchAll()}}}),n);t.default=S},1597:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(36),a(20),a(14),a(24),a(138),a(8),a(13),a(9),a(4),a(21),a(18),a(11),a(46),a(7),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(38)),o=r(a(58)),c=r(a(50));a(35);var s=r(a(39)),l=r(a(62)),i=r(a(25)),u=r(a(28)),d=r(a(74)),f=r(a(41)),p=r(a(42)),m=r(a(37)),h=r(a(45));r(a(63));a(12),a(32),a(3),a(10),a(6),a(36),a(20),a(27),a(247),a(29),a(14),a(24),a(138),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(46),a(7),a(40);var v,_,g,y,E,b=r(a(31)),S=r(a(26)),O=r(a(67)),R=a(17),k=a(56),C=r(a(460));function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,b.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var P={creating:"Creating",created:"Creating",active:"Running",failed:"Failed",deleting:"Deleting",upgrading:"Upgrading",upgraded:"Upgrading",deployed:"Running"},N=function(e){var t=(0,S.default)(e,"cluster.status");return D(D(D({},e),e.cluster),{},{selector:{"application.kubesphere.io/instance":e.cluster.name},status:P[t]})},I=(v=function(e){(0,f.default)(a,e);var t=A(a);function a(){var e;(0,i.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).getWatchListUrl=function(t){var a=t.cluster,r=t.namespace;return"".concat(e.baseUrl).concat(e.getPath({namespace:r,cluster:a}),"/releases?watch=true")},e.getUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.namespace,r=t.cluster,n=t.name,o="".concat(e.baseUrl).concat(e.getPath({namespace:a,cluster:r}),"/applications");return n?"".concat(o,"/").concat(n):o},e.getDeleteUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.workspace,r=t.namespace,n=t.cluster,o=t.name,c="".concat(e.baseUrl).concat(e.getDeletePath({workspace:a,namespace:r,cluster:n}),"/applications");return o?"".concat(c,"/").concat(o):c},(0,l.default)(e,"fetchList",_,(0,d.default)(e)),(0,l.default)(e,"fetchDetail",g,(0,d.default)(e)),(0,l.default)(e,"delete",y,(0,d.default)(e)),(0,l.default)(e,"batchDelete",E,(0,d.default)(e)),e}return(0,u.default)(a,[{key:"getPath",value:function(e){var t=e.cluster,a=e.namespace,r="";return globals.app.isMultiCluster&&t&&(r+="/klusters/".concat(t)),a&&(r+="/namespaces/".concat(a)),r}},{key:"getDeletePath",value:function(e){var t=e.workspace,a=e.cluster,r=e.namespace,n="";return t&&(n+="/workspaces/".concat(t)),globals.app.isMultiCluster&&a&&(n+="/clusters/".concat(a)),r&&(n+="/namespaces/".concat(r)),n}},{key:"baseUrl",get:function(){return"kapis/native.helm/v1alpha1"}}]),a}(C.default),_=(0,h.default)(v.prototype,"fetchList",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,s.default)(n.default.mark((function t(){var a,r,s,l,i,u,d,f,p,m,h,v,_,g,y,E=arguments;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=E.length>0&&void 0!==E[0]?E[0]:{},r=a.limit,s=a.page,l=a.cluster,i=a.namespace,u=a.workspace,d=a.more,f=a.status,p=a.sortBy,m=a.reverse,h=(0,c.default)(a,["limit","page","cluster","namespace","workspace","more","status","sortBy","reverse"]),e.list.isLoading=!0,v={conditions:(0,k.getFilterString)({status:f})||void 0},p||void 0!==m||(p="status_time"),(0,O.default)(h)||(_=(0,k.getFilterString)(h))&&(v.conditions+=",".concat(_)),r!==1/0&&(v.paging="limit=".concat(r||10,",page=").concat(s||1)),p&&(v.orderBy=p),m&&(v.reverse=!0),t.next=10,request.get(e.getUrl({namespace:i,cluster:l}),v);case 10:return g=t.sent,y=(g.items||[]).map((function(e){return D(D({},N(e)),{},{workspace:u,cluster:l})})),Object.assign(e.list,{data:d?[].concat((0,o.default)(e.list.data),(0,o.default)(y)):y,total:g.total_count||0,limit:Number(r)||10,page:Number(s)||1,order:p,reverse:m,filters:h,selectedRowKeys:[]}),e.list.isLoading=!1,t.abrupt("return",y);case 15:case"end":return t.stop()}}),t)})))}}),g=(0,h.default)(v.prototype,"fetchDetail",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,s.default)(n.default.mark((function t(a){var r,o,c,s,l;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,o=a.namespace,c=a.cluster,s=a.name,e.isLoading=!0,t.next=4,request.get(e.getUrl({namespace:o,cluster:c,name:s}));case 4:l=t.sent,e.detail=D(D({},N(l)),{},{workspace:r,namespace:o,cluster:c}),e.isLoading=!1;case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),y=(0,h.default)(v.prototype,"delete",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.name,r=t.cluster,n=t.workspace,o=t.zone;return e.submitting(request.delete(e.getDeleteUrl({namespace:o,name:a,cluster:r,workspace:n})))}}}),E=(0,h.default)(v.prototype,"batchDelete",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var r=a.namespace,n=a.cluster,o=a.workspace;return e.submitting(Promise.all(t.map((function(t){return request.delete(e.getDeleteUrl({namespace:r,cluster:n,workspace:o,name:t}))}))))}}}),v);t.default=I},1608:function(e,t,a){e.exports={content:"s1iKHdiKYS2KAnOGr2xOi",item:"_3B11hCO238i0BN6mQcovhe"}},1609:function(e,t,a){e.exports={content:"_3EopWXM9d6_WAtA5H6rBsx",item:"DU1A13TYH9JFcLds2K7oM"}},1610:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=n(r(1)),f=r(189),p=n(r(1232));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var h=function(e){(0,s.default)(r,e);var a=m(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props.metrics;return u.default.createElement("div",{className:p.default.trafficCard},e.map((function(e){return u.default.createElement("div",{key:e.title},u.default.createElement("div",{className:"h5"},isNaN(e.data)?t("NO_DATA"):"".concat(e.data," ").concat(e.unit)),u.default.createElement("p",null,u.default.createElement(f.Icon,{name:e.icon}),t(e.title)))})))}}]),r}(u.default.Component);a.default=h,h.propTypes={metrics:d.default.array},h.defaultProps={metrics:[]}},1611:function(e,t,a){e.exports={title:"_3S8MQxb58sffym2et4n8QF",version:"_2JU6qDgSBfI1iYZtZVS3Ws",pods:"_1V_HSvgrXsa_TiulD8Xlhb",podItem:"_3LZMf_ISZNdvla2uknihgd",text:"_2ENvj_CljI53fH7AjUd3G7",icon:"_9VjTrVcUD9REGBJOtXHIr",status:"_3FU1QZhF2PEUekQrlD8kWP",running:"_3VnQpTLNm8LOyirY48l7qy",updating:"aqJNY2GpnZtzUBeTTSdxF"}},1612:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(36),a(20),a(14),a(8),a(13),a(9),a(4),a(21),a(18),a(11),a(46),a(7),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(36),a(20),a(27),a(29),a(14),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(46),a(7),a(40);var n=r(a(38)),o=r(a(31)),c=r(a(50));a(35);var s,l,i,u=r(a(39)),d=r(a(62)),f=r(a(25)),p=r(a(28)),m=r(a(74)),h=r(a(41)),v=r(a(42)),_=r(a(37)),g=r(a(45)),y=(r(a(63)),r(a(26))),E=r(a(68)),b=r(a(201)),S=r(a(67)),O=r(a(845)),R=r(a(487)),k=a(17),C=a(56),A=a(61),T=r(a(92));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,_.default)(e);if(t){var n=(0,_.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var I=(s=function(e){(0,h.default)(s,e);var t,a,r=N(s);function s(){var e;(0,f.default)(this,s);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return e=r.call.apply(r,[this].concat(a)),(0,d.default)(e,"isComponentsLoading",l,(0,m.default)(e)),(0,d.default)(e,"components",i,(0,m.default)(e)),e.module="strategies",e}return(0,p.default)(s,[{key:"fetchList",value:(a=(0,u.default)(n.default.mark((function e(t){var a,r,o,s,l,i,u=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.cluster,r=t.namespace,o=t.selector,s=(0,c.default)(t,["cluster","namespace","selector"]),this.list.isLoading=!0,r){e.next=5;break}return this.list.isLoading=!1,e.abrupt("return");case 5:return l=s,(0,S.default)(o)||(l.labelSelector=(0,C.joinSelector)(o)),e.next=9,request.get(this.getListUrl({cluster:a,namespace:r}),l);case 9:i=e.sent,this.list.update({data:i.items.map((function(e){return P(P({},u.mapper(e)),{},{cluster:a})})),total:i.items.length,isLoading:!1});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchMetrics",value:function(e){var t=e.cluster,a=e.namespace,r=e.newWorkloadName,n=e.oldWorkloadName,o=e.protocol,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=Math.floor((new Date).getTime()/1e3),l=P({queryTime:s,duration:300,step:30,rateInterval:"30s","filters[]":["request_count","request_duration","request_error_count","tcp_sent","tcp_received"],direction:"inbound",reporter:"destination"},c);return"http"===o&&(l.requestProtocol="http"),Promise.all([request.get("kapis/servicemesh.kubesphere.io/v1alpha2".concat(this.getPath({cluster:t,namespace:a}),"/workloads/").concat(r,"/metrics"),l),request.get("kapis/servicemesh.kubesphere.io/v1alpha2".concat(this.getPath({cluster:t,namespace:a}),"/workloads/").concat(n,"/metrics"),l)])}},{key:"fetchHealth",value:function(e){var t=e.cluster,a=e.namespace,r=e.newWorkloadName,n=e.oldWorkloadName,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=P({rateInterval:"30s"},o);return Promise.all([request.get("kapis/servicemesh.kubesphere.io/v1alpha2".concat(this.getPath({cluster:t,namespace:a}),"/workloads/").concat(r,"/health"),c),request.get("kapis/servicemesh.kubesphere.io/v1alpha2".concat(this.getPath({cluster:t,namespace:a}),"/workloads/").concat(n,"/health"),c)])}},{key:"fetchComponents",value:(t=(0,u.default)(n.default.mark((function e(t){var a,r,s,l,i,u,d,f,p,m,h,v,_,g,y;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.cluster,s=t.namespace,l=t.labelSelector,i=t.newVersion,u=t.oldVersion,d=t.service,f=t.silent,p=(0,c.default)(t,["cluster","namespace","labelSelector","newVersion","oldVersion","service","silent"]),!f&&(this.isComponentsLoading=!0),s){e.next=5;break}return this.isComponentsLoading=!1,e.abrupt("return");case 5:return m=p,(0,S.default)(l)||(m.labelSelector=l),e.next=9,request.get("api/v1".concat(this.getPath({cluster:r,namespace:s}),"/pods"),m);case 9:h=e.sent,v=h.items.map(T.default.pods),_=(0,O.default)(v,"labels.version"),g=_[i]||[],y=_[u]||[],this.components.data=(a={},(0,o.default)(a,i,{name:d,version:i,pods:g,desire:g.length,available:g.filter((function(e){return"Running"===e.status.phase})).length}),(0,o.default)(a,u,{name:d,version:u,pods:y,desire:y.length,available:y.filter((function(e){return"Running"===e.status.phase})).length}),a),this.isComponentsLoading=!1;case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"create",value:function(e,t){var a,r=t.cluster,n=t.namespace;if((0,b.default)(e,"strategy")&&(a=request.post(this.getListUrl({cluster:r,namespace:n}),e.strategy)),(0,b.default)(e,"workload")){var o=(0,y.default)(e,"workload.kind","Deployment"),c=(0,R.default)(A.MODULE_KIND_MAP,(function(e){return e===o}))||"deployments";a.then(request.post("apis/apps/v1".concat(this.getPath({cluster:r,namespace:n}),"/").concat(c),e.workload))}return this.submitting(a)}},{key:"update",value:function(e,t){var a=e.name,r=e.cluster,n=e.namespace,o=e.newWorkloadName,c=e.newVersion,s=e.resourceVersion,l=[],i="";if((0,b.default)(t,"workload")){var u=(0,y.default)(t,"workload.kind","Deployment"),d=(0,R.default)(A.MODULE_KIND_MAP,(function(e){return e===u}))||"deployments";if((i=(0,y.default)(t.workload,"metadata.labels.version"))===c){var f=(0,y.default)(t.workload,"metadata.name");l.push(request.put("apis/apps/v1".concat(this.getPath({cluster:r,namespace:n}),"/").concat(d,"/").concat(f),t.workload))}else l.push(request.delete("apis/apps/v1".concat(this.getPath({cluster:r,namespace:n}),"/").concat(d,"/").concat(o)),request.post("apis/apps/v1".concat(this.getPath({cluster:r,namespace:n}),"/").concat(d),t.workload))}if((0,b.default)(t,"strategy")){if((0,E.default)(t.strategy,"metadata.resourceVersion",s),i&&i!==c)(0,y.default)(t.strategy,"spec.governor")===c&&(0,E.default)(t.strategy,"spec.governor",i),((0,y.default)(t.strategy,"spec.template.spec.http")||(0,y.default)(t.strategy,"spec.template.spec.tcp",[])).forEach((function(e){e.route&&e.route.length>0&&e.route.forEach((function(e){(0,y.default)(e,"destination.subset")===c&&(0,E.default)(e,"destination.subset",i)})),e.mirror&&e.mirror.subset===c&&(e.mirror.subset=i)}));l.push(request.put(this.getDetailUrl({name:a,cluster:r,namespace:n}),t.strategy))}return this.submitting(Promise.all(l))}}]),s}(r(a(49)).default),l=(0,g.default)(s.prototype,"isComponentsLoading",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),i=(0,g.default)(s.prototype,"components",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:{}}}}),(0,g.default)(s.prototype,"fetchList",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchList"),s.prototype),(0,g.default)(s.prototype,"fetchMetrics",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchMetrics"),s.prototype),(0,g.default)(s.prototype,"fetchHealth",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchHealth"),s.prototype),(0,g.default)(s.prototype,"fetchComponents",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchComponents"),s.prototype),(0,g.default)(s.prototype,"create",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"create"),s.prototype),(0,g.default)(s.prototype,"update",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"update"),s.prototype),s);t.default=I},1613:function(e,t,a){e.exports={wrapper:"_1FRrrBxl8UqvsswigK4p6Z",header:"_17yDbHoZkGlCh5TkvVpYH0",title:"_1ND4Co3PGwICLYv_4P9q5o",right:"_3DW67iu4ZbODnkFe0_ZzTW",pods:"_2dJagf8ndTpszvQ1fnOpg_",metric:"_3MWAAAkSCUGt62thgWlL4o",icon:"_22V6MJt30xmcn4CU7xZ5Es",status:"_22doJB7j2BHvCiBEcyoKJO",running:"_3UPN8mbj93pxkXP4kJvdXs",updating:"S6AbHUgraNCIVXqWPgLCD",offline:"_15G7mRB5qpNeQrLLnQFLb5"}},1614:function(e,t,a){e.exports={list:"_1y7srBKDMimPCBz1ivcnXL",card:"_1CNnvTpcwGUSGgDJtaTxgE",inputs:"_3JM-KVcZd0CJ9NCBQTJ3r",limits:"_36BBL6z_siYtS2MY-CTltL",limit:"qFBDqsZYRUQVnqH4lnOAL"}},1615:function(e,t,a){e.exports={tracing:"_2_q0DNdfMx9e5W7v9Si6gS",cardHeader:"_2p8zOOtwLXH4_1SstvLyYC",operations:"_2us2jWBpu0J5F5mLDoSYKh",cardContent:"bLd4-qXNqLMQXv55Rfooi",item:"_21M_0IBeqI3nFGS2xCskvz",header:"_30mNlGFkJHDVCiuEle9Ybl",title:"_1uRSfn8aYD8zmip-xjiUj",duration:"_2L_QSvChdOUhq425WQf0_B",durationBar:"_11R8VXXwf7HPMdd1k9DQWM",content:"_2q0NQ67t-oUZqLh5nHriY7",spanWrapper:"_2fWwhM3oMmksqBHDHXuTay",spans:"IrkUrsjvAGNLoRT_t4qj3",errorSpans:"_1oP4nMdyHintWuioJtC3oY",services:"Chnawuf8D5gcAjmZdcHNf",tag:"_1x47CjJvQTrdcFR4n-KgRt",startTime:"ywM5JVADUKn9T8f8Qohhv",empty:"_1dvYFA65StoQjFB8gJLX2L",icon:"_3dAwFztjwyNQJw8galB6Iz"}},1616:function(e,t,a){e.exports={graph:"_2QbHXodqDd2IHEjwUROIxT",cursorGuide:"_1lrCeprU84WiOS_4fpCBLg",scrubber:"iItn2qK_qu11_u1UURlwm",scrubberLine:"_3dtf14S4FmvMYN0TvYQuTv",coord:"_1BgtGWk2uDGdq2RVungzLU",coordLine:"_2aJZBiYerxhhnS1OUc4TKA",range:"_1GZb6kcnvOlH-_rFwzxFz3",hoverBlock:"cJtJ8Gc3yfaiFf3Uxr42t",clearBlock:"_2ljlMynj0Xv2Wkx50Vxjp3"}},1624:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(70),a(66),a(20),a(51),a(320),a(14),a(24),a(138),a(8),a(13),a(9),a(4),a(18),a(11),a(73),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(38)),o=r(a(50));a(35);var c=r(a(39)),s=r(a(62)),l=r(a(25)),i=r(a(28)),u=r(a(74)),d=r(a(41)),f=r(a(42)),p=r(a(37)),m=r(a(45)),h=(r(a(63)),r(a(31)));a(12),a(32),a(3),a(10),a(6),a(70),a(66),a(20),a(27),a(247),a(51),a(320),a(442),a(141),a(29),a(14),a(120),a(24),a(138),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(73),a(1013),a(7),a(1014),a(1015),a(1016);var v,_,g,y,E,b,S=a(17),O=r(a(26)),R=r(a(68)),k=r(a(445)),C=r(a(196)),A=r(a(49)),T=a(324),D=a(815),P=a(934);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,h.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x={apiVersion:"mysql.radondb.com/v1alpha1",kind:"Backup",metadata:{annotations:{"kubesphere.io/alias-name":""},name:"",namespace:""},spec:{clusterName:"",image:"larryhuang142/mysql57-sidecar:v202205301443"}},M={Started:"Creating",Complete:"Success"},L=function(e,t){var a=t.app_id,r=t.workspace,n=t.namespace,o=t.cluster,c={name:(0,O.default)(e,"metadata.name"),createAt:(0,O.default)(e,"metadata.creationTimestamp"),app_id:a,workspace:r,namespace:n,cluster:o},s=(0,k.default)((0,O.default)(e,"status.conditions"),"lastTransitionTime").reverse();switch(a){case D.RadonDBAppId.MySQL:return w(w({},c),{},{status:M[(0,O.default)(s,"[0].type","Creating")]||"Failed",completeAt:(0,O.default)(s,"[0].lastTransitionTime"),restoreParams:{restoreFrom:(0,O.default)(e,"status.backupName")}});case D.RadonDBAppId.PostgreSQL:return w(w({},c),{},{name:e.backup_id,createAt:new Date(e.begin_time),size:e.size,repoPath:e.repoPath,status:"Success",completeAt:new Date(e.end_time),restoreParams:{restoreFrom:e.repoPath,restoreTarget:e.name},specifications:"".concat((0,O.default)(e,"cpu"),", ").concat((0,O.default)(e,"memory")),volume:(0,O.default)(e,"pvc_size"),nodes:(0,O.default)(e,"replicas")});default:return c}},j=(v=function(e){(0,d.default)(a,e);var t=N(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).yamlJSONObj=void 0,e.getUrl=function(t){switch(t.app_id){case D.RadonDBAppId.MySQL:return e.getMysqlBackupUrl(t);case D.RadonDBAppId.PostgreSQL:return e.getPGBackupUrl(t);default:return""}},e.getWatchListUrl=function(e){var t=e.cluster_id,a=e.cluster,r=e.name,n=e.app_id,o=e.namespace;switch(n){case D.RadonDBAppId.MySQL:return"/apis".concat(globals.app.isMultiCluster&&a?"/clusters/".concat(a):"","/mysql.radondb.com/v1alpha1/watch/namespaces/").concat(o,"/backups").concat(r?"/".concat(r):"?labelSelector=cluster=".concat(t));default:return""}},(0,s.default)(e,"fetchList",_,(0,u.default)(e)),(0,s.default)(e,"add",g,(0,u.default)(e)),(0,s.default)(e,"delete",y,(0,u.default)(e)),(0,s.default)(e,"batchDelete",E,(0,u.default)(e)),(0,s.default)(e,"autoBackup",b,(0,u.default)(e)),e}return(0,i.default)(a,[{key:"getMysqlBackupUrl",value:function(e){var t=e.cluster_id,a=e.cluster,r=e.namespace,n=e.name;return"/apis".concat(globals.app.isMultiCluster&&a?"/clusters/".concat(a):"","/mysql.radondb.com/v1alpha1/namespaces/").concat(r,"/backups").concat(n?"/".concat(n):"?labelSelector=cluster=".concat(t))}},{key:"getPGBackupUrl",value:function(e){var t=e.cluster_id,a=e.cluster,r=e.namespace;return"/apis".concat(globals.app.isMultiCluster&&a?"/clusters/".concat(a):"","/postgres.radondb.io/v1/namespaces/").concat(r,"/postgresqls").concat(t?"/".concat(t):"")}}]),a}(A.default),_=(0,m.default)(v.prototype,"fetchList",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,c.default)(n.default.mark((function t(){var a,r,c,s,l,i,u,d,f,p,m,h,v,_,g,y,E=arguments;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=E.length>0&&void 0!==E[0]?E[0]:{},r=a.limit,c=void 0===r?10:r,s=a.page,l=void 0===s?1:s,i=a.workspace,u=a.cluster,d=a.namespace,a.more,a.status,f=a.reverse,p=a.id,m=a.app_id,h=(0,o.default)(a,["limit","page","workspace","cluster","namespace","more","status","reverse","id","app_id"]),e.list.isLoading=!0,v=[],m!==D.RadonDBAppId.PostgreSQL){t.next=10;break}return t.next=6,request.get(e.getUrl({app_id:m,workspace:i,namespace:d,cluster:u,cluster_id:p}));case 6:_=t.sent,v=(0,O.default)(_,"status.backups_list",[]).reverse(),t.next=14;break;case 10:return t.next=12,request.get(e.getUrl({app_id:m,workspace:i,namespace:d,cluster:u,cluster_id:p}));case 12:g=t.sent,v=g.items?g.items.sort((function(e,t){return new Date(t.metadata.creationTimestamp).getTime()-new Date(e.metadata.creationTimestamp).getTime()})):[];case 14:return y=v.map((function(e){return w(w({},L(e,{app_id:m,workspace:i,namespace:d,cluster:u})),{},{cluster:u})})).filter((function(e){return!h.keyword||(0,O.default)(e,"name","").includes(h.keyword)})),Object.assign(e.list,{data:y.slice((l-1)*c,l*c),total:y.length,limit:Number(c)||10,page:Number(l)||1,reverse:f,filters:h,selectedRowKeys:[]}),e.list.isLoading=!1,t.abrupt("return",y);case 18:case"end":return t.stop()}}),t)})))}}),g=(0,m.default)(v.prototype,"add",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,c.default)(n.default.mark((function t(a){var r,o,c,s,l,i,u,d,f,p,m,h,v,_,g;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a.name,o=a.namespace,c=a.cluster_id,s=a.alias,l=a.image,t.t0=a.app_id,t.next=t.t0===D.RadonDBAppId.MySQL?4:t.t0===D.RadonDBAppId.PostgreSQL?14:38;break;case 4:return i=JSON.parse(JSON.stringify(x)),(0,R.default)(i,"metadata.name","".concat(c.substring(0,30),"-").concat(r)),(0,R.default)(i,"metadata.namespace",o),(0,R.default)(i,'metadata.annotations["kubesphere.io/alias-name"]',s),(0,R.default)(i,"spec.clusterName",c),(0,R.default)(i,'metadata.labels["cluster"]',c),(0,R.default)(i,"spec.image",l),t.next=13,request.post(e.getUrl(a),i);case 13:return t.abrupt("break",39);case 14:return u=window.atob||T.safeAtob,t.next=17,request.get((0,P.getManifestApi)(a));case 17:return d=t.sent,t.next=20,request.get((0,P.getDmpSecrets)({namespace:"dmp-system",cluster_id:"dmp-managed-s3-secret"}));case 20:return f=t.sent,p=u((0,O.default)(f,"data.s3-access-key")),m=u((0,O.default)(f,"data.s3-secret-key")),h=u((0,O.default)(f,"data.pg-s3-bucket")),v=u((0,O.default)(f,"data.s3-endpoint")),_=JSON.parse(d.customResource),g=(0,O.default)(_,"spec.backupCluster.backupToS3.manual.trigger-id",1),(0,R.default)(_,"spec.S3.ACCESS_KEY",p),(0,R.default)(_,"spec.S3.SECRET_KEY",m),(0,R.default)(_,"spec.S3.BUCKET",h),(0,R.default)(_,"spec.S3.ENDPOINT",v),(0,R.default)(_,"spec.S3.PATH","".concat(o,"/backup")),(0,R.default)(_,"spec.backupCluster.backupToS3.manual.trigger-id",g+1),d.customResource=JSON.stringify(_),d.version+=1,t.next=37,request.put((0,P.getManifestApi)(a),d);case 37:case 38:return t.abrupt("break",39);case 39:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),y=(0,m.default)(v.prototype,"delete",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,c.default)(n.default.mark((function t(a){var r,o,c;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a.app_id,t.next=t.t0===D.RadonDBAppId.MySQL?3:t.t0===D.RadonDBAppId.PostgreSQL?6:17;break;case 3:return t.next=5,request.delete(e.getUrl(a));case 5:return t.abrupt("break",18);case 6:return r=(0,P.getManifestApi)(w(w({},a),{},{cluster_id:a.id})),t.next=9,request.get(r);case 9:return o=t.sent,c=JSON.parse(o.customResource),(0,R.default)(c,"spec.backupToDelete","".concat(Date.now(),"|").concat(a.name)),o.customResource=JSON.stringify(c),o.version+=1,t.next=16,request.put(r,o);case 16:case 17:return t.abrupt("break",18);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),E=(0,m.default)(v.prototype,"batchDelete",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,c.default)(n.default.mark((function e(t){var a,r,c,s,l,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.selectedItems,r=void 0===a?[]:a,c=(0,o.default)(t,["selectedItems"]),s=(0,P.getManifestApi)(w(w({},c),{},{cluster_id:c.id})),e.next=4,request.get(s);case 4:l=e.sent,e.t0=c.app_id,e.next=e.t0===D.RadonDBAppId.PostgreSQL?8:15;break;case 8:return i=JSON.parse(l.customResource),(0,R.default)(i,"spec.backupToDelete","".concat(Date.now(),"|").concat(r.map((function(e){return e.name})).join("|"))),l.customResource=JSON.stringify(i),l.version+=1,e.next=14,request.put(s,l);case 14:case 15:return e.abrupt("break",16);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),b=(0,m.default)(v.prototype,"autoBackup",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=(0,c.default)(n.default.mark((function e(t){var a,r,c,s,l,i,u;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.backupSchedule,r=t.retentionTime,c=(0,o.default)(t,["backupSchedule","retentionTime"]),s=(0,P.getManifestApi)(c),e.next=4,request.get(s);case 4:l=e.sent,e.t0=c.app_id,e.next=e.t0===D.RadonDBAppId.PostgreSQL?8:e.t0===D.RadonDBAppId.MySQL?15:22;break;case 8:return i=JSON.parse(l.customResource),""!==a?((0,R.default)(i,"spec.backupCluster.backupToS3.cron.enable",!0),(0,R.default)(i,"spec.backupCluster.backupToS3.cron.schedule",a),(0,R.default)(i,"spec.backupCluster.backupToS3.policy.retention","RECOVERY WINDOW OF ".concat(r," DAYS"))):((0,C.default)(i,"spec.backupCluster.backupToS3.cron"),(0,R.default)(i,"spec.backupCluster.backupToS3.policy.retention","REDUNDANCY 10")),l.customResource=JSON.stringify(i),l.version+=1,e.next=14,request.put(s,l);case 14:return e.abrupt("break",23);case 15:return u=JSON.parse(l.customResource),(0,R.default)(u,"spec.backupSchedule",a?"0 ".concat(a):""),l.customResource=JSON.stringify(u),l.version+=1,e.next=21,request.put(s,l);case 21:case 22:return e.abrupt("break",23);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),v);t.default=j},1625:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(44),a(6),a(70),a(66),a(20),a(87),a(51),a(14),a(24),a(886),a(138),a(99),a(8),a(13),a(9),a(4),a(18),a(30),a(11),a(73),a(71),a(139),a(79),a(817),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(250),a(32),a(3),a(10),a(44),a(6),a(70),a(66),a(20),a(27),a(87),a(51),a(141),a(29),a(14),a(120),a(24),a(886),a(138),a(33),a(16),a(99),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(30),a(195),a(11),a(73),a(71),a(79),a(817),a(7);var n=r(a(50)),o=r(a(97)),c=r(a(31)),s=r(a(38));a(35);var l,i,u,d=r(a(39)),f=r(a(62)),p=r(a(25)),m=r(a(28)),h=r(a(74)),v=r(a(41)),_=r(a(42)),g=r(a(37)),y=r(a(45)),E=(r(a(63)),a(17)),b=r(a(26)),S=r(a(68)),O=r(a(140)),R=r(a(67)),k=r(a(872)),C=r(a(862)),A=r(a(1011)),T=r(a(3933)),D=r(a(3934)),P=r(a(196)),N=r(a(163)),I=r(a(460)),w=a(1085),x=a(815),M=a(3960),L=a(934),j=a(992);function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,g.default)(e);if(t){var n=(0,g.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,_.default)(this,a)}}var Y=(l=function(e){(0,v.default)(_,e);var t,a,r,c,l=F(_);function _(){var e;(0,p.default)(this,_);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=l.call.apply(l,[this].concat(a))).resourceName="params",e.app_id="",e.getUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.workspace,a=e.namespace,r=e.cluster,n=e.cluster_id;return(0,L.getManifestApi)({workspace:t,namespace:a,cluster:r,cluster_id:n})},(0,f.default)(e,"fetchList",i,(0,h.default)(e)),(0,f.default)(e,"updateParams",u,(0,h.default)(e)),e.updateCKParams=function(){var t=(0,d.default)(s.default.mark((function t(a){var r,n,o,c,l,i,u,d,f;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,n=a.cluster_id,o=a.cluster,c=a.namespace,l=a.params,t.next=3,request.get(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}));case 3:if(i=t.sent,u=JSON.parse(i.customResource),!(0,R.default)(l)){t.next=7;break}return t.abrupt("return");case 7:return d=l.max_memory_usage,(f=l.max_server_memory_usage)&&(0,S.default)(u,"spec.configuration.settings.max_server_memory_usage",f),d&&(0,S.default)(u,'spec.configuration.profiles["default/max_memory_usage"]',d),i.customResource=JSON.stringify(u),i.version+=1,t.next=14,request.put(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}),i);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updatePGParams=function(){var t=(0,d.default)(s.default.mark((function t(a){var r,n,c,l,i,u,d,f,p,m,h;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,n=a.cluster_id,c=a.cluster,l=a.namespace,i=a.params,t.next=3,request.get(e.getUrl({workspace:r,namespace:l,cluster:c,cluster_id:n}));case 3:if(u=t.sent,d=JSON.parse(u.customResource),f=(0,b.default)(d,"spec.postgresql.configs"),p=e.getPGParamsByConfig(f),55555!==(m=B({},i)).port){t.next=10;break}throw new Error("PG_PORT_FORBIDDEN_ERROR");case 10:return m.port&&m.port!==p.port&&((0,S.default)(d,"spec.services[1].spec.ports[0].port",m.port),(0,S.default)(d,"spec.services[2].spec.ports[0].port",m.port)),["shared_buffers","temp_buffers","work_mem","wal_buffers","maintenance_work_mem","wal_writer_flush_after"].forEach((function(e){m[e]&&(m[e]+="MB")})),["bgwriter_flush_after"].forEach((function(e){m[e]&&(m[e]+="kB")})),h=Object.entries(B(B({},p),m)).map((function(e){var t=(0,o.default)(e,2),a=t[0],r=t[1];return"".concat(a,"=").concat(r)})),(0,S.default)(d,"spec.postgresql.configs",h),u.customResource=JSON.stringify(d),u.version+=1,t.next=21,request.put(e.getUrl({workspace:r,namespace:l,cluster:c,cluster_id:n}),u);case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateMySQLParams=function(){var t=(0,d.default)(s.default.mark((function t(a){var r,n,o,c,l,i,u,d;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,n=a.cluster_id,o=a.cluster,c=a.namespace,l=a.params,t.next=3,request.get(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}));case 3:return i=t.sent,u=JSON.parse(i.customResource),d=(0,b.default)(u,"spec.mysqlOpts.mysqlConf"),Object.keys(l).forEach((function(e){l[e]=l[e].toString()})),(0,S.default)(u,"spec.mysqlOpts.mysqlConf",B(B({},d),l)),i.customResource=JSON.stringify(u),i.version+=1,t.next=12,request.put(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}),i);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getParamsFromMongoYaml=function(e){return{port:(0,b.default)(e,"spec.additionalMongodConfig.net.port"),oplogSizeMB:(0,b.default)(e,"spec.additionalMongodConfig.replication.oplogSizeMB"),maxIncomingConnections:(0,b.default)(e,"spec.additionalMongodConfig.net.maxIncomingConnections"),cursorTimeoutMillis:(0,b.default)(e,"spec.additionalMongodConfig.setParameter.cursorTimeoutMillis"),profilingMode:(0,b.default)(e,"spec.additionalMongodConfig.operationProfiling.mode"),slowOpThresholdMs:(0,b.default)(e,"spec.additionalMongodConfig.operationProfiling.slowOpThresholdMs"),enableMajorityReadConcern:(0,b.default)(e,"spec.additionalMongodConfig.replication.enableMajorityReadConcern",!0).toString(),commandVerbosity:(0,b.default)(e,"spec.additionalMongodConfig.systemLog.component.command.verbosity",0).toString(),indexVerbosity:(0,b.default)(e,"spec.additionalMongodConfig.systemLog.component.index.verbosity",0).toString(),queryVerbosity:(0,b.default)(e,"spec.additionalMongodConfig.systemLog.component.query.verbosity",0).toString(),networkVerbosity:(0,b.default)(e,"spec.additionalMongodConfig.systemLog.component.network.verbosity",0).toString(),writeVerbosity:(0,b.default)(e,"spec.additionalMongodConfig.systemLog.component.write.verbosity",0).toString()}},e.updateMongoParams=function(){var t=(0,d.default)(s.default.mark((function t(a){var r,n,o,c,l,i,u,d,f,p,m,h,v,_,g,y,E,b,O,R,k;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,n=a.cluster_id,o=a.cluster,c=a.namespace,l=a.params,t.next=3,request.get(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}));case 3:return i=t.sent,u=JSON.parse(i.customResource),d=e.getParamsFromMongoYaml(u),f=B(B({},d),l),p=f.port,m=f.oplogSizeMB,h=f.maxIncomingConnections,v=f.cursorTimeoutMillis,_=f.profilingMode,g=f.slowOpThresholdMs,y=f.enableMajorityReadConcern,E=f.commandVerbosity,b=f.indexVerbosity,O=f.queryVerbosity,R=f.networkVerbosity,k=f.writeVerbosity,(0,S.default)(u,"spec.additionalMongodConfig.net.port",p),(0,S.default)(u,"spec.additionalMongodConfig.replication.oplogSizeMB",m),(0,S.default)(u,"spec.additionalMongodConfig.net.maxIncomingConnections",h),(0,S.default)(u,"spec.additionalMongodConfig.setParameter.cursorTimeoutMillis",v),(0,S.default)(u,"spec.additionalMongodConfig.operationProfiling.mode",_),(0,S.default)(u,"spec.additionalMongodConfig.operationProfiling.slowOpThresholdMs",g),(0,S.default)(u,"spec.additionalMongodConfig.replication.enableMajorityReadConcern","true"===y),(0,S.default)(u,"spec.additionalMongodConfig.systemLog.component.command.verbosity",Number(E)),(0,S.default)(u,"spec.additionalMongodConfig.systemLog.component.index.verbosity",Number(b)),(0,S.default)(u,"spec.additionalMongodConfig.systemLog.component.query.verbosity",Number(O)),(0,S.default)(u,"spec.additionalMongodConfig.systemLog.component.network.verbosity",Number(R)),(0,S.default)(u,"spec.additionalMongodConfig.systemLog.component.write.verbosity",Number(k)),i.customResource=JSON.stringify(u),i.version+=1,t.next=23,request.put(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}),i);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateECKParams=function(){var t=(0,d.default)(s.default.mark((function t(a){var r,n,o,c,l,i,u;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,n=a.cluster_id,o=a.cluster,c=a.namespace,l=a.params,t.next=3,request.get(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}));case 3:return i=t.sent,u=JSON.parse(i.customResource),Object.keys(l).forEach((function(e){["action.destructive_requires_name","http.cors.enabled"].includes(e)&&(l[e]="true"===l[e])})),(0,b.default)(u,"spec.nodeSets",[]).forEach((function(e){var t=(0,b.default)(e,"config",{});(0,S.default)(e,"config",B(B({},t),l))})),i.customResource=JSON.stringify(u),i.version+=1,t.next=12,request.put(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}),i);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateLogStashConfig=function(){var t=(0,d.default)(s.default.mark((function t(a,r){var n,o,c,l,i,u,d,f,p,m,h,v,_,g,y;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.namespace,o=r.cluster,c=r.cluster_id,l={},i=/^logstash./,(0,C.default)(a,(function(e,t){if(i.test(t)){var r=t.replace(i,"");l[r]=e,delete a[t]}})),!(0,A.default)(l)){t.next=19;break}return t.next=7,e.getLogstashParams({namespace:n,cluster:o,cluster_id:c});case 7:return u=t.sent,d=u.oldConfig,f=u.configMap,p=(0,k.default)({},d.logstash,l),(m=(0,b.default)(p,"jvm",0))&&(h=(0,b.default)(f,"spec.podTemplate.spec.containers[0].resources.limits.memory"),v=(0,w.convertToMebiBytes)(h),_=(0,T.default)(v*(m/100)),(0,S.default)(f,"spec.config.jvm","-Xms".concat(_,"m -Xmx").concat(_,"m")),delete p.jvm),g=[],(0,C.default)(p,(function(e,t){g.push({name:t,value:String(e)})})),(0,S.default)(f,"spec.config.logstashConfig",g),y="apis".concat(globals.app.isMultiCluster&&o?"/clusters/".concat(o):"","/opensearch.opster.io/v1/namespaces/").concat(n,"/logstashes/").concat(c),t.next=19,request.put(y,f);case 19:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.updateOpenSearchParams=function(){var t=(0,d.default)(s.default.mark((function t(a){var r,n,o,c,l,i,u,d;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,n=a.cluster_id,o=a.cluster,c=a.namespace,l=a.params,t.next=3,request.get(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}));case 3:return i=t.sent,u=JSON.parse(i.customResource),Object.keys(l).forEach((function(e){["action.destructive_requires_name","http.cors.enabled"].includes(e)&&(l[e]="true"===l[e])})),Object.keys(l).forEach((function(e){["thread_pool.write.queue_size","thread_pool.search.queue_size","action.destructive_requires_name","http.cors.enabled"].includes(e)&&(l[e]=String(l[e]))})),d=(0,b.default)(u,"spec.general.additionalConfig",{}),t.next=10,e.updateLogStashConfig(l,{namespace:c,cluster:o,cluster_id:n});case 10:return(0,S.default)(u,"spec.general.additionalConfig",B(B({},d),l)),i.customResource=JSON.stringify(u),i.version+=1,t.next=15,request.put(e.getUrl({workspace:r,namespace:c,cluster:o,cluster_id:n}),i);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateKafkaParams=function(){var t=(0,d.default)(s.default.mark((function t(a){var r,o,c,l,i,u,d,f,p,m,h,v,_,g,y,E,O,R;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,o=a.cluster_id,c=a.cluster,l=a.namespace,i=a.nodeRole,u=a.params,t.next=3,request.get(e.getUrl({workspace:r,namespace:l,cluster:c,cluster_id:o}));case 3:if(d=t.sent,f=JSON.parse(d.customResource),p=u.tls,m=u.authentication,h=u.nodePort,v=u.jmxOptions,_=(0,n.default)(u,["tls","authentication","nodePort","jmxOptions"]),!(g=(0,b.default)(f,"spec.kafka.listeners[0"))){t.next=25;break}if(y=(0,b.default)(g,"authentication.type"),E=m||y,!p){t.next=14;break}if("false"!==p||"tls"!==E){t.next=13;break}throw new Error("KAFKA_EDIT_PARAMS_ERROR");case 13:(0,S.default)(g,"tls","true"===p);case 14:if(!m){t.next=24;break}if("no"!==m){t.next=20;break}delete g.authentication,delete f.spec.kafka.authorization,t.next=24;break;case 20:if("tls"!==m||g.tls){t.next=22;break}throw new Error("KAFKA_EDIT_PARAMS_ERROR");case 22:(0,S.default)(f,"spec.kafka.authorization",(0,b.default)(j.kafkaYaml.resources,"spec.kafka.authorization")),(0,S.default)(g,"authentication.type",m);case 24:h&&(0,S.default)(g,"type","true"===h?"nodeport":"internal");case 25:return Object.keys(_).forEach((function(e){"log.cleaner.enable"===e&&(_[e]="true"===_[e])})),"kafka"===i?(O=(0,b.default)(f,"spec.kafka.config",{}),(0,S.default)(f,"spec.kafka.config",B(B({},O),_)),"password"===v?(0,S.default)(f,"spec.kafka.jmxOptions.authentication.type","password"):"enable"===v?(0,S.default)(f,"spec.kafka.jmxOptions",{}):(0,P.default)(f,"spec.kafka.jmxOptions")):(R=(0,b.default)(f,"spec.zookeeper.config",{}),(0,S.default)(f,"spec.zookeeper.config",B(B({},R),_)),"password"===v?(0,S.default)(f,"spec.zookeeper.jmxOptions.authentication.type","password"):"enable"===v?(0,S.default)(f,"spec.zookeeper.jmxOptions",{}):(0,P.default)(f,"spec.zookeeper.jmxOptions")),d.customResource=JSON.stringify(f),d.version+=1,t.next=31,request.put(e.getUrl({workspace:r,namespace:l,cluster:c,cluster_id:o}),d);case 31:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return(0,m.default)(_,[{key:"getParamsFromYamlJSON",value:(c=(0,d.default)(s.default.mark((function e(t,a){var r,n,c,l,i,u,d,f,p,m,h,v,_,g,y,E,S,O,R,C,A,T,D,P,I,w;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.app_id=(0,x.getAppIdByKind)(t.kind),e.t0=this.app_id,e.next=e.t0===x.RadonDBAppId.ClickHouse?4:e.t0===x.RadonDBAppId.PostgreSQL?11:e.t0===x.RadonDBAppId.MySQL?16:e.t0===x.RadonDBAppId.MongoDB?17:e.t0===x.RadonDBAppId.RedisCluster||e.t0===x.RadonDBAppId.RedisSentinel?18:e.t0===x.RadonDBAppId.Elasticsearch?26:e.t0===x.RadonDBAppId.Kafka?28:e.t0===x.RadonDBAppId.OpenSearch?38:45;break;case 4:return r=(0,b.default)(t,"spec.templates.serviceTemplates[0].spec.ports"),n=(0,b.default)(t,"spec.configuration.clusters[0].layout"),c=n.replicasCount,l=r.find((function(e){return"http"===e.name})),i=r.find((function(e){return"tcp"===e.name})),u=(0,b.default)(t,"spec.configuration.settings.max_server_memory_usage",18e8),d=(0,b.default)(t,'spec.configuration.profiles["default/max_memory_usage"]',2e8),e.abrupt("return",(0,M.getCKParams)({replicasCount:c,httpPort:l,tcpPort:i,max_server_memory_usage:u,max_memory_usage:d}));case 11:return f=(0,b.default)(t,"spec.postgresql.configs",[]),p=(0,b.default)(t,"spec.autofailover.podspec.containers[0].image",""),m=(0,b.default)(Object.entries(x.PGImage).find((function(e){var t=(0,o.default)(e,2)[1];return p.startsWith(t)})),"[0]"),h=this.getPGParamsByConfig(f),e.abrupt("return",(0,M.getPGParams)(B(B({},h),{},{pgVersion:m})));case 16:return e.abrupt("return",(0,M.getMySQLParams)((0,b.default)(t,"spec.mysqlOpts.mysqlConf")));case 17:return e.abrupt("return",(0,M.getMongoDBParams)(this.getParamsFromMongoYaml(t)));case 18:return e.next=20,this.getRedisParams(a);case 20:if(v=e.sent,"7.0.4"!==(0,b.default)(t,"spec.kubernetesConfig.redisVersion")){e.next=25;break}return _="hostname"===(0,b.default)(t,"spec.kubernetesConfig.endpointType"),e.abrupt("return",(0,M.getRedisParams)(B(B({},v),{},{endpointType:_})));case 25:return e.abrupt("return",(0,M.getRedisParams)(v).slice(1,-1));case 26:return g=(0,b.default)(t,"spec.nodeSets[0].config",{}),e.abrupt("return",(0,M.getECKParams)(g));case 28:return y=a.nodeRole,E=(0,b.default)(t,"spec.".concat(y,".config"),{}),S=(0,b.default)(t,"spec.kafka.listeners[0]",{}),O=S.tls,R=S.authentication?S.authentication.type:"no",C="nodeport"===S.type,A=(0,b.default)(t,"spec.".concat(y,".jmxOptions")),T="disable",T="password"===(0,b.default)(A,"authentication.type")?"password":(0,N.default)(A)?"disable":"enable",e.abrupt("return",(0,M.getKafkaParams)(B(B({},E),{},{tls:O,authentication:R,nodePort:C,jmxOptions:T}),y));case 38:return D=(0,b.default)(t,"spec.general.additionalConfig",{}),e.next=41,this.getLogstashParams(a);case 41:return P=e.sent,I=P.oldConfig,w=(0,k.default)({},I,D),e.abrupt("return",(0,M.getOpenSearchParams)(w));case 45:return e.abrupt("return",[]);case 46:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"getPGParamsByConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=t.trim().split("="),r=(0,o.default)(a,2),n=r[0],c=r[1];if(n){var s=Number(c);e[n]=Number.isNaN(s)?c:s}return e}),{})}},{key:"getRedisParams",value:(r=(0,d.default)(s.default.mark((function e(t){var a,r,n,o,c,l;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,r=t.cluster,n=t.cluster_id,o="api".concat(globals.app.isMultiCluster&&r?"/clusters/".concat(r):"","/v1/namespaces/").concat(a,"/configmaps/").concat(n,"-external-config"),e.next=4,request.get(o);case 4:return c=e.sent,l=(0,b.default)(c,'data["redis-external.conf"]',""),e.abrupt("return",this.configMapToObject(l));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getLogstashParams",value:(a=(0,d.default)(s.default.mark((function e(t){var a,r,n,o,c,l,i,u,d,f,p,m,h;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,r=t.cluster,n=t.cluster_id,o="apis".concat(globals.app.isMultiCluster&&r?"/clusters/".concat(r):"","/opensearch.opster.io/v1/namespaces/").concat(a,"/logstashes/").concat(n),e.next=4,request.get(o);case 4:return c=e.sent,l=(0,b.default)(c,"spec.config",{}),i=(0,b.default)(l,"logstashConfig",[]),u=(0,b.default)(l,"jvm",""),d=(0,b.default)(c,"spec.podTemplate.spec.containers[0].resources.limits.memory"),f=(0,w.convertToMebiBytes)(d),p=(0,w.convertJVMToMemoryMebiBytes)(u),m={},(0,C.default)(i,(function(e){var t=(0,b.default)(e,"name",""),a=(0,b.default)(e,"value","");m[t]=a})),(0,S.default)(m,"jvm",(0,D.default)(p/f*100)||50),h=(0,k.default)({},{logstash:m}),e.abrupt("return",{oldConfig:h,configMap:c});case 17:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"configMapToObject",value:function(e){var t={};return e.split("\n").forEach((function(e){var a=e.toString().trim().split(" "),r=(0,o.default)(a,2),n=r[0],c=r[1];n&&(t[n]=c)})),t}},{key:"updateRedisParam",value:(t=(0,d.default)(s.default.mark((function e(t){var a,r,n,o,c,l,i,u,d,f,p,m,h,v,_;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.workspace,r=t.cluster_id,n=t.cluster,o=t.namespace,c=t.params,l="api".concat(globals.app.isMultiCluster&&n?"/clusters/".concat(n):"","/v1/namespaces/").concat(o,"/configmaps/").concat(r,"-external-config"),e.next=4,request.get(l);case 4:if(i=e.sent,u=(0,b.default)(i,'data["redis-external.conf"]',""),d=this.configMapToObject(u),"number"==typeof(f=c.maxmemory)&&(c.maxmemory="".concat(f,"MB")),"number"==typeof(p=c["repl-backlog-size"])&&(c["repl-backlog-size"]="".concat(p,"mb")),!c.endpointType){e.next=27;break}return e.next=14,request.get(this.getUrl({workspace:a,namespace:o,cluster:n,cluster_id:r}));case 14:if(m=e.sent,h=JSON.parse(m.customResource),"true"!==c.endpointType){e.next=22;break}if(!((0,b.default)(h,"spec.redisProxy.replicas")>0)){e.next=19;break}throw new Error("ENDPOINT_TYPE_ERROR");case 19:(0,S.default)(h,"spec.kubernetesConfig.endpointType","hostname"),e.next=23;break;case 22:(0,S.default)(h,"spec.kubernetesConfig",(0,O.default)((0,b.default)(h,"spec.kubernetesConfig"),"endpointType"));case 23:return m.customResource=JSON.stringify(h),m.version+=1,e.next=27,request.put(this.getUrl({workspace:a,namespace:o,cluster:n,cluster_id:r}),m);case 27:return v=B(B({},d),(0,O.default)(c,"endpointType")),_=Object.entries(v).map((function(e){return e.join(" ")})).join("\n"),(0,S.default)(i,'data["redis-external.conf"]',_),e.next=32,request.put(l,i);case 32:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),_}(I.default),i=(0,y.default)(l.prototype,"fetchList",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,d.default)(s.default.mark((function t(a){var r,n,o,c,l,i,u,d,f,p;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.workspace,n=a.namespace,o=a.cluster,c=a.cluster_id,l=a.keyword,i=a.nodeRole,e.list.isLoading=!0,t.next=4,request.get(e.getUrl({workspace:r,namespace:n,cluster:o,cluster_id:c}));case 4:return u=t.sent,d=JSON.parse(u.customResource),t.next=8,e.getParamsFromYamlJSON(d,{workspace:r,namespace:n,cluster:o,cluster_id:c,nodeRole:i});case 8:f=t.sent,p={},l&&(f=f.filter((function(e){return e.name.includes(l)})),p={keyword:l}),Object.assign(e.list,{data:f,total:f.length,filters:p,isLoading:!1,selectedRowKeys:[]});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),u=(0,y.default)(l.prototype,"updateParams",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,d.default)(s.default.mark((function t(a){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.app_id||a.app_id,t.next=t.t0===x.RadonDBAppId.ClickHouse?3:t.t0===x.RadonDBAppId.PostgreSQL?6:t.t0===x.RadonDBAppId.MySQL?9:t.t0===x.RadonDBAppId.MongoDB?12:t.t0===x.RadonDBAppId.RedisCluster||t.t0===x.RadonDBAppId.RedisSentinel?15:t.t0===x.RadonDBAppId.Elasticsearch?18:t.t0===x.RadonDBAppId.Kafka?21:t.t0===x.RadonDBAppId.OpenSearch?24:27;break;case 3:return t.next=5,e.updateCKParams(a);case 5:return t.abrupt("break",28);case 6:return t.next=8,e.updatePGParams(a);case 8:return t.abrupt("break",28);case 9:return t.next=11,e.updateMySQLParams(a);case 11:return t.abrupt("break",28);case 12:return t.next=14,e.updateMongoParams(a);case 14:return t.abrupt("break",28);case 15:return t.next=17,e.updateRedisParam(a);case 17:return t.abrupt("break",28);case 18:return t.next=20,e.updateECKParams(a);case 20:return t.abrupt("break",28);case 21:return t.next=23,e.updateKafkaParams(a);case 23:return t.abrupt("break",28);case 24:return t.next=26,e.updateOpenSearchParams(a);case 26:case 27:return t.abrupt("break",28);case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),l);t.default=Y},1659:function(e,t,a){e.exports={attributes:"_1qLfwlSNMUvx_q8t-EGpKu",item:"_2ImD6g_VbE6ZdbovBHYIpG",name:"_3oXgWAWaKT0svZ3eswccyw",value:"_1b7KLypukIC6d3iPAamFVA"}},1660:function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(20),a(8),a(13),a(9),a(4),a(190),a(18),a(30),a(11),a(69),a(71),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(10),a(6),a(20),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(190),a(18),a(43),a(30),a(195),a(11),a(69),a(71),a(7);var n,o,c=r(a(317)),s=r(a(31)),l=r(a(25)),i=r(a(28)),u=r(a(41)),d=r(a(42)),f=r(a(37)),p=r(a(0)),m=a(243),h=r(a(67)),v=r(a(26)),_=r(a(68)),g=r(a(119)),y=r(a(1011)),E=a(189),b=a(803),S=r(a(3969)),O=a(820),R=a(55),k=a(17),C=r(a(3970)),A=a(815),T=r(a(3972)),D=r(a(3983)),P=a(3984);function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var w=(n=(0,m.inject)("detailStore"),(0,R.withRouter)(o=n(o=(0,m.observer)(o=function(e){(0,u.default)(a,e);var t=I(a);function a(e){var r;return(0,l.default)(this,a),(r=t.call(this,e)).fetchData=function(e){r.step=e.step,r.times=e.times,r.monitorStore.fetchMetrics(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({config:r.getConfig(),metrics:[],fillZero:!1,cluster:r.cluster,namespace:r.namespace},e))},r.getMonitoringCfgs=function(){return r.chartConfig.getMonitoringCfgs(r.metrics)},r.renderSimpleArea=function(e){for(var t=r.props.columns||1,a=Math.ceil(e.length/t),n=[],o=0;o<a;o++){for(var s=[],l=0;l<t;l++){var i=e[o+l];i.dot=i.dot?i.dot:0;var u=(0,b.getAreaChartOps)(i);s.push(p.default.createElement(E.Column,null,p.default.createElement(O.SimpleArea,(0,c.default)({showAll:!0,key:u.title,width:"100%",isTranslate:!1},u))))}n.push(p.default.createElement(E.Columns,null,s))}return n},r.monitorStore=new S.default({cluster:r.cluster}),r.step="10m",r.times=30,r}return(0,i.default)(a,[{key:"componentDidUpdate",value:function(e){e.monitorDbNode===this.props.monitorDbNode&&e.nodeRole===this.props.nodeRole||this.fetchData({step:this.step,times:this.times})}},{key:"getConfig",value:function(){var e=this.props,t=e.monitorDbNode,a=e.detailStore;return this.chartConfig.getConfig(a,t)}},{key:"render",value:function(){var e=this.monitorStore,t=e.isLoading,a=e.isRefreshing,r=this.getMonitoringCfgs(),n=this.props,o=n.exitHandler,c=n.customSelect;return p.default.createElement(C.default,{onFetch:this.fetchData,loading:t,refreshing:a,closeBtn:o?p.default.createElement(E.Button,{className:D.default.button,type:"control",icon:"close",iconType:"light",onClick:o}):null,step:this.step,times:this.times,isEmpty:(0,h.default)(this.metrics),customSelect:c},this.renderSimpleArea(r))}},{key:"cluster",get:function(){return this.props.match.params.cluster}},{key:"metrics",get:function(){var e=(0,g.default)((0,v.default)((0,k.toJS)(this.monitorStore),"data",{}));return Object.values(e).map((function(e){var t=(0,v.default)(e,"data.result",[]);if((0,y.default)(t)){var a=(0,P.mergerValues)(t);(0,_.default)(e,"data.result",[a])}return e})),e}},{key:"namespace",get:function(){var e=this.props.detailStore;return(0,v.default)(e,"detail.namespace","")}},{key:"chartConfig",get:function(){var e=this.props,t=e.detailStore,a=e.monitorDbNode,r=void 0===a?{}:a,n=e.nodeRole;if((0,v.default)(r,"isPredixy"))return T.default.predixy;var o="";switch((0,v.default)(t,"detail.app_id")){case A.RadonDBAppId.ClickHouse:o="ck";break;case A.RadonDBAppId.PostgreSQL:return o="pg.".concat(r.nodeRole||"postgresql"),(0,v.default)(T.default,o);case A.RadonDBAppId.MySQL:o="mysql";break;case A.RadonDBAppId.RedisCluster:case A.RadonDBAppId.RedisSentinel:o="redis";break;case A.RadonDBAppId.MongoDB:o="mongo";break;case A.RadonDBAppId.Elasticsearch:o="eck.pod";break;case A.RadonDBAppId.Kafka:o="".concat(n,".pod");break;case A.RadonDBAppId.OpenSearch:var c=(0,v.default)(r,"name");o=/^oslst/.test(c)?"opensearch.logstash":"opensearch.pod"}return(0,h.default)(r)&&(o=o.replace(".pod",".main")),(0,v.default)(T.default,o)}}]),a}(p.default.Component))||o)||o)||o);t.default=w},1671:function(e,t,a){e.exports={container:"_3-ZkTbqukj22B-pJzneW6n",content:"_3U8DBG0oSm5MXPDbku5MVv","search-box":"knY_VVSNv5AHBYkq5g0CT","monitor-btn":"_236daVZSbHdsGL_zC_owf7",item:"u6oOOhm6ovvflYDM-HgwK",empty:"_2iYjjPU8G3gJgqGLKwJlqZ",fullScreen:"Fcv9QgUXVv4TMVIGDPRk5"}},1673:function(e,a,r){"use strict";r(16);var n=r(162),o=r(19);r(837),r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.password,r=e.color,n=(0,s.useState)(!1),o=(0,c.default)(n,2),d=o[0],f=o[1];return s.default.createElement(s.default.Fragment,null,d?s.default.createElement("span",null,a):Array(10).fill("").map((function(e,t){return s.default.createElement(l.Icon,{key:t,size:12,name:"dot",style:{marginRight:-6},color:r})})),a&&s.default.createElement(s.default.Fragment,null,s.default.createElement(l.Icon,{name:"eye",onClick:function(){return f(!d)},style:{margin:"0 4px 0 6px"}}),s.default.createElement("a",{href:"#",style:{color:"#329dce"},onClick:function(e){e.preventDefault(),(0,u.copyToClipboard)(a).then((function(){i.default.success({content:t("COPY_SUCCESSFUL")})}))}},t("COPY"))))},r(837),r(20);var c=o(r(97)),s=n(r(0)),l=r(189),i=o(r(191)),u=r(1085)},1674:function(e,t,a){"use strict";a(16),a(3),a(44),a(66),a(20),a(14),a(30),a(71),a(79),Object.defineProperty(t,"__esModule",{value:!0}),t.ALERTING_STATUS=t.getAlertingResource=t.getQuery=void 0,a(3),a(44),a(66),a(20),a(14),a(4),a(30),a(71),a(79);var r=a(4017);t.getQuery=function(e){var t=e.kind,a=e.rule,n=e.resources,o="",c=a._metricType,s=a.thresholds,l=a.condition_type;switch(t){case"Node":o=c.replace("$1","node=".concat(n.length>1?"~":"",'"').concat(n.join("|"),'"'));break;case"Deployment":case"StatefulSet":case"DaemonSet":o=c.replace("$1","workload=".concat(n.length>1?"~":"",'"').concat(n.map((function(e){return"".concat(t,":").concat(e)})).join("|"),'"')).replace("$2",t.toLowerCase())}var i=s,u=r.ALL_METRICS_CONFIG[c].ruleConfig.find((function(e){return"thresholds"===e.name}));return u&&u.converter&&(i=u.converter(s)),o+=" ".concat(l," ").concat(i)};var n={Deployment:"deployments",StatefulSet:"statefulsets",DaemonSet:"daemonsets",Pod:"pods"};t.getAlertingResource=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(e,t){var a=e.pod;return a&&a.startsWith(e[t])?{module:"pods",name:e.pod,namespace:e.namespace}:{module:"job_name"===t?"jobs":"".concat(t,"s"),name:e[t],namespace:e.namespace}};if(e.node)return{module:"nodes",name:e.node};if(e.namespace){if(e.workload)return{module:n[e.owner_kind],name:e.workload.replace("".concat(e.owner_kind,":"),""),namespace:e.namespace};if(e.job_name)return t(e,"job_name");if(e.cronjob)return t(e,"cronjob");if(e.hpa)return{module:"hpas",name:e.hpa,namespace:e.namespace};if(e.deployment)return t(e,"deployment");if(e.statefulset)return t(e,"statefulset");if(e.daemonset)return t(e,"daemonset");if(e.pod)return{module:"pods",name:e.pod,namespace:e.namespace};if(e.service)return{module:"services",name:e.service,namespace:e.namespace}}return{}};t.ALERTING_STATUS=["disabled","inactive","pending","firing"]},1676:function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(70),r(20),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(70),r(20),r(27),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7),r(110);var o=n(r(38)),c=n(r(31));r(35);var s,l,i,u=n(r(39)),d=n(r(25)),f=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),_=r(243),g=n(r(1)),y=n(r(5)),E=n(r(67)),b=n(r(482)),S=r(189),O=n(r(4046)),R=n(r(4048));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var T=(0,_.observer)((i=l=function(e){(0,p.default)(r,e);var a=A(r);function r(e){var n;return(0,d.default)(this,r),(n=a.call(this,e)).setAutoRefresh=function(){var e=n.store.list.data;clearInterval(n.timer),e.some((function(e){return!["successful","failed"].includes(e.status)||(0,E.default)(e.status)}))&&(n.timer=setInterval(n.fetchData,4e3))},n.fetchData=(0,u.default)(o.default.mark((function e(){var t,a,r,c,s=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},a=n.props,r=a.limit,c=a.params,e.next=4,n.store.fetchS2IRunRecords(C(C({limit:r},c),t));case 4:n.setAutoRefresh();case 5:case"end":return e.stop()}}),e)}))),n.getPagination=function(){var e=n.store.list;return{page:e.page,limit:e.limit,total:e.total}},n.handleSearch=function(e){n.searchValue=e,n.fetchData({name:e}).then((function(){n.props.onSearch(e)}))},n.handlePage=function(e){n.fetchData({page:e}).then((function(){n.props.onPage(e)}))},n.renderFooter=function(){var e=n.getPagination(),a=e.total,r=e.page,o=e.limit;return v.default.createElement(S.Level,{className:R.default.footer},v.default.createElement(S.LevelLeft,null,t("TOTAL_ITEMS",{num:a})),v.default.createElement(S.LevelRight,null,v.default.createElement(S.Pagination,{page:r,total:a,limit:o,onChange:n.handlePage})))},n.store=new b.default,n}return(0,f.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"renderContent",value:function(){var e=this,a=this.store.list,r=a.data,n=a.isLoading,o=v.default.createElement("div",{className:R.default.body},(0,E.default)(r)?v.default.createElement("div",{className:R.default.empty},t("NO_DATA")):r.map((function(t){return e.renderItem(t)})));return this.isTable?v.default.createElement(S.Loading,{spinning:n},o):o}},{key:"renderItem",value:function(e){var t=this.store.list.isLoading;return v.default.createElement(O.default,{key:e.name,runDetail:e,loading:t,store:this.store,isB2i:this.props.isB2i})}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.hideFooter;return v.default.createElement("div",{className:(0,y.default)(t,R.default.content)},this.renderContent(),!a&&this.renderFooter())}},{key:"isTable",get:function(){var e=this.props,t=e.hideHeader,a=e.hideFooter;return!t||!a}}]),r}(v.default.Component),l.propTypes={prefix:g.default.string,title:g.default.string,detail:g.default.object,hideHeader:g.default.bool,hideFooter:g.default.bool,onSearch:g.default.func,onRefresh:g.default.func,onPage:g.default.func,limit:g.default.number},l.defaultProps={isB2i:!1,detail:{},hideHeader:!1,hideFooter:!1,onSearch:function(){},onRefresh:function(){},onPage:function(){}},s=i))||s;a.default=T},1677:function(e,a,r){"use strict";r(16);var n=r(19),o=r(162);r(10),r(20),r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(10),r(20),r(9),r(4);var c=o(r(0)),s=n(r(67)),l=r(189),i=n(r(4066)),u=function(e){var a=e.data;return(0,s.default)(a)?c.default.createElement("ul",{className:i.default.annotations},c.default.createElement("li",null,t("NO_DATA"))):c.default.createElement("ul",{className:i.default.annotations},Object.keys(a).filter((function(e){return!(0,s.default)(a[e])})).map((function(e){return c.default.createElement("li",{key:e},c.default.createElement(l.Columns,null,c.default.createElement(l.Column,{className:"is-narrow"},c.default.createElement("p",{style:{width:317}},e)),c.default.createElement(l.Column,null,c.default.createElement("p",null,a[e]))))})))},d=(0,c.memo)(u);a.default=d},1678:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a,r=e.status,n=e.toEvent,u=null!==(a=null==r?void 0:r.conditions)&&void 0!==a?a:[],d=function(e){return o.default.createElement(c.Icon,{className:"close"===l[e].name?s.default.closeIcon:"",name:l[e].name,size:15,color:{primary:"#fff",secondary:l[e].color}})};return o.default.createElement(c.Tooltip,{content:o.default.createElement("div",null,o.default.createElement("div",null,t("STATUS_INFORMATION")),u.map((function(e,a){return o.default.createElement("div",{className:s.default.textItem,key:a},o.default.createElement("div",{className:s.default.textItemTitle},d(e.status),o.default.createElement("span",null,i[e.type])),o.default.createElement("ul",null,o.default.createElement("li",null,t("STATUS_VALUE",{value:e.status})),o.default.createElement("li",null,e.reason&&t("REASON_VALUE",{value:e.reason})),o.default.createElement("li",null,e.message&&t("MESSAGE_VALUE",{value:e.message}))))})),o.default.createElement(c.Button,{type:"primary",onClick:n,className:"width-full"},t("VIEW_EVENTS"))),placement:"right"},o.default.createElement("div",{className:s.default.container},u.map((function(e,t){return o.default.createElement("div",{className:s.default.item,key:t},d(e.status))}))))},a.STATUS_TITLE=a.ICON_TYPES=void 0,r(20),r(14);var o=n(r(0)),c=r(189),s=n(r(4069)),l={False:{name:"close",color:"#AB2F29"},True:{name:"success",color:"#55BC8A"},Unknown:{name:"question",color:"#E0992C"}};a.ICON_TYPES=l;var i={Ready:t("STRETCH_OBJECT_READY"),Active:t("TRIGGER_ACTIVE"),Fallback:t("RETRACTOR_FALLBACK")};a.STATUS_TITLE=i},3716:function(e,t,a){"use strict";a(16);var r=a(19);a(3),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(3);var n=r(a(58)),o=a(318),c=r(a(3717)),s=r(a(3720)),l=r(a(3721)),i=r(a(3745)),u=r(a(3746)),d=r(a(3747)),f=r(a(3748)),p=r(a(3749)),m=r(a(3750)),h=r(a(3751)),v=r(a(3753)),_=r(a(3754)),g=r(a(3755)),y=r(a(3756)),E=r(a(3825)),b=r(a(3826)),S=r(a(3828)),O=r(a(3830)),R=r(a(3833)),k=r(a(3834)),C=r(a(3835)),A=r(a(3837)),T=r(a(3838)),D=r(a(3839)),P=r(a(4071)),N="/:workspace/clusters/:cluster/projects/:namespace",I=[].concat((0,n.default)((0,D.default)(N)),[{path:N,component:s.default,routes:[{path:"".concat(N,"/overview"),component:l.default,exact:!0},{path:"".concat(N,"/applications/others"),component:d.default,exact:!0},{path:"".concat(N,"/applications/database"),component:c.default,exact:!0},{path:"".concat(N,"/applications/template"),component:u.default,exact:!0},{path:"".concat(N,"/deployments"),component:f.default,exact:!0},{path:"".concat(N,"/statefulsets"),component:p.default,exact:!0},{path:"".concat(N,"/daemonsets"),component:m.default,exact:!0},{path:"".concat(N,"/pods"),component:h.default,exact:!0},{path:"".concat(N,"/jobs"),component:v.default,exact:!0},{path:"".concat(N,"/s2ibuilders"),component:_.default,exact:!0},{path:"".concat(N,"/cronjobs"),component:g.default,exact:!0},{path:"".concat(N,"/services"),component:y.default,exact:!0},{path:"".concat(N,"/grayrelease"),component:E.default,exact:!0},{path:"".concat(N,"/composing"),component:i.default,exact:!0},{path:"".concat(N,"/ingresses"),component:b.default,exact:!0},{path:"".concat(N,"/volumes"),component:S.default,exact:!0},{path:"".concat(N,"/base-info"),component:O.default,exact:!0},{path:"".concat(N,"/configmaps"),component:R.default,exact:!0},{path:"".concat(N,"/serviceaccounts"),component:k.default,exact:!0},{path:"".concat(N,"/secrets"),component:C.default,exact:!0},{path:"".concat(N,"/roles"),component:A.default,exact:!0},{path:"".concat(N,"/members"),component:T.default,exact:!0},{path:"".concat(N,"/custom-scaling"),component:P.default,exact:!0},(0,o.getIndexRoute)({path:"".concat(N,"/workloads"),to:"".concat(N,"/deployments"),exact:!0}),(0,o.getIndexRoute)({path:"".concat(N,"/applications"),to:"".concat(N,"/applications/template"),exact:!0}),(0,o.getIndexRoute)({path:N,to:"".concat(N,"/overview"),exact:!0}),(0,o.getIndexRoute)({path:"*",to:"/404",exact:!0})]}]);t.default=I},3717:function(e,a,r){"use strict";var n=r(19),o=r(162);r(12),r(109),r(3),r(10),r(44),r(6),r(70),r(20),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(71),r(197),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(69),r(71),r(197),r(7);var c,s=n(r(317)),l=n(r(31)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(248),v=n(r(808)),_=n(r(26)),g=r(437),y=r(189),E=n(r(807)),b=n(r(826)),S=n(r(976)),O=r(806),R=n(r(810)),k=r(56),C=o(r(1221)),A=r(815),T=n(r(1078)),D=n(r(3719));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var w=(0,O.withProjectList)({store:new C.default,module:"applications",name:"APP"})(c=function(e){(0,d.default)(r,e);var a=I(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).type="database",e.state={appList:[]},e.getColumns=function(){var a=e.props.getSortOrder;return[{title:t("NAME"),dataIndex:"name",render:function(t,a){return m.default.createElement(S.default,{isApp:!0,to:"".concat(e.prefix,"/").concat(t),avatar:(0,_.default)(a,"icon"),iconLetter:a.kind,iconSize:40,title:t,desc:a.description})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,render:e.renderStatus},{title:t("APP_TEMPLATE"),dataIndex:"app_name",isHideable:!0,render:function(e,t){return m.default.createElement(g.Link,{to:"/apps/".concat(t.app_id)},"RadonDB ",e)}},{title:t("VERSION"),dataIndex:"version",isHideable:!0},{title:t("ACCESS_ADDRESS_PL"),dataIndex:"services",isHideable:!0,width:"272px",render:function(e,a){var r="",n=(0,_.default)(a,"services.length",0);if(n>1){var o=e.filter((function(e){return"ClusterIP"===e.type})),c=e.filter((function(e){return"NodePort"===e.type}));r=m.default.createElement("div",{className:D.default.tooltips},o.length>0&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:D.default.tooltipTitle},"ClusterIP"),o.map((function(e){var a=e.label,r=e.value;return m.default.createElement("div",{key:r},m.default.createElement("div",null,t(a),": ",r))}))),c.length>0&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:D.default.tooltipTitle},"NodePort"),c.map((function(e){var a=e.label,r=e.value;return m.default.createElement("div",{key:r},m.default.createElement("div",null,t(a),": ",r))}))))}return m.default.createElement("div",null,m.default.createElement("span",null,(0,_.default)(e,"[0].value",(0,_.default)(e,"[1].value"))),n>1&&m.default.createElement(y.Tooltip,{content:r,style:{top:"-8px"}},m.default.createElement("span",{className:D.default.tag},n)))}},{title:t("CREATION_TIME_TCAP"),dataIndex:"creationTimestamp",sorter:!0,sortOrder:a("creationTimestamp"),isHideable:!0,width:180,render:function(e,t){return(0,k.getLocalTime)(t.creationTimestamp||t.status_time).format("YYYY-MM-DD HH:mm:ss")}}]},e.renderStatus=function(e,a){return e?a.additional_info?m.default.createElement(y.Tooltip,{content:a.additional_info},m.default.createElement(E.default,{name:t("DATABASE_STATUS_".concat(e.replace(/[-\s]/g,"_").toUpperCase())),type:e,flicker:!0})):m.default.createElement(E.default,{name:t("DATABASE_STATUS_".concat(e.replace(/[-\s]/g,"_").toUpperCase())),type:C.DMPStatus[e]||e,flicker:!0}):"-"},e.showDeploy=function(t,a){var r=e.props,n=r.match,o=r.module,c=r.projectStore,s=r.trigger;return e.props.trigger("openpitrix.db.app.create",{module:o,app_id:a,detail:e.state.appList.find((function(e){return e.app_id===a})),namespace:n.params.namespace,cluster:n.params.cluster,workspace:(0,_.default)(c,"detail.workspace"),routing:e.props.rootStore.routing,success:e.handleFetch,trigger:s})},e.handleFetch=(0,v.default)((function(t){var a=e.props,r=a.store,n=a.getData;if(!r.list.isLoading)return n(N(N(N({},(0,h.parse)(location.search.slice(1))),t),{},{silent:!0}))}),1e3),e.handleWatch=function(t){"Manifest"===t.object.kind&&["MODIFIED","DELETED","ADDED"].includes(t.type)&&e.handleFetch()},e.getApplist=function(){request.get("/kapis/application.kubesphere.io/v2/apps",{orderBy:"create_time",conditions:"status=active,repo_id=repo-helm,category_id=radondb",reverse:!0}).then((function(t){e.setState({appList:t.items})}))},e}return(0,u.default)(r,[{key:"getTableProps",value:function(){var e=this,a=this.props,r=a.tableProps,n=a.store,o=m.default.createElement(y.Menu,{onClick:this.showDeploy},this.state.appList.map((function(e){return m.default.createElement(y.Menu.MenuItem,{key:e.app_id},m.default.createElement(b.default,{width:"16px",style:{marginRight:"8px"},src:e.icon,iconLetter:e.name,iconSize:12}),e.name)}))),c=(0,_.default)(n,"list.data.length",0)>0?"bottomRight":"bottom",s=this.canCreate?[{key:"deploy",type:"control",customDom:m.default.createElement(y.Dropdown,{key:"app-list",className:D.default.appCreate,positionFixed:!0,content:o,placement:c},m.default.createElement(y.Button,{key:"deploy",type:"control",disabled:this.state.appList<1},m.default.createElement("div",{className:D.default.deployButton},m.default.createElement("span",null,t("INSTALL")),m.default.createElement(y.Icon,{name:"caret-down",color:{primary:"#fff",secondary:"#fff"},style:{marginLeft:"4px"}}))))}]:[],l=[{key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){return e.props.trigger("resource.batch.delete",N(N({type:"APP",rowKey:r.rowKey,success:e.handleFetch},e.props.match.params),e.props.query))}}];return{tableActions:N(N({},r.tableActions),{},{actions:s,onCreate:null}),selectActions:l,emptyProps:{desc:t("CREATE_APP_TEMPLATE_DESC")},searchType:"keyword"}}},{key:"componentDidMount",value:function(){this.getApplist()}},{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps,r=e.match;return m.default.createElement(O.ListPage,(0,s.default)({},this.props,{onMessage:this.handleWatch}),m.default.createElement(T.default,(0,s.default)({},t,{match:r,type:this.type})),m.default.createElement(R.default,(0,s.default)({className:D.default.DBApps},a,this.getTableProps(),{itemActions:this.itemActions,columns:this.getColumns(),rowKey:"name",alwaysUpdate:!0})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r,"/applications/").concat(this.type)}},{key:"canCreate",get:function(){var e=this.props.match.params,t=e.cluster,a=e.namespace;return globals.app.hasPermission({cluster:t,project:a,module:"applications",action:"create"})}},{key:"itemActions",get:function(){var e=this,a=this.props.trigger,r=this.props.match.params,n=r.cluster,o=r.namespace,c=r.workspace;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(t){return a("openpitrix.db.app.edit",{detail:{cluster:n,namespace:o,workspace:c,cluster_id:t.name,name:t.name,description:t.description},success:e.handleFetch})}},{key:"update",icon:"update",text:t("UPDATE_VERSION"),action:"edit",show:function(e){return!(e.app_id!==A.RadonDBAppId.OpenSearch||!e.databaseVersionText.includes("2.3.0"))},onClick:function(r){return a("openpitrix.db.app.update",{resource:r.name,title:t("UPDATE_VERSION"),detail:{cluster:n,namespace:o,workspace:c,cluster_id:r.name,app_id:r.app_id},success:e.handleFetch})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(t){return a("resource.delete",{type:"APP",detail:{name:t.name,cluster:n,namespace:o,workspace:c},success:e.handleFetch})}}]}}]),r}(m.default.Component))||c;a.default=w},3718:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(44),a(6),a(70),a(20),a(320),a(14),a(8),a(13),a(9),a(4),a(18),a(11),a(111),a(73),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(44),a(6),a(70),a(20),a(27),a(320),a(29),a(14),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(111),a(73),a(7);var n=r(a(38)),o=r(a(58)),c=r(a(97)),s=r(a(31));a(35);var l,i,u,d=r(a(39)),f=r(a(62)),p=r(a(25)),m=r(a(28)),h=r(a(74)),v=r(a(41)),_=r(a(42)),g=r(a(37)),y=r(a(45)),E=(r(a(63)),r(a(26))),b=r(a(68)),S=a(17),O=r(a(325)),R=r(a(454)),k=a(815);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,g.default)(e);if(t){var n=(0,g.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,_.default)(this,a)}}var D=(l=function(e){(0,v.default)(a,e);var t=T(a);function a(){var e;(0,p.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).resourceName="db_services",e.nodeStore=new R.default,(0,f.default)(e,"data",i,(0,h.default)(e)),e.getUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.namespace,r=t.chi,n=t.app_id,o=t.cluster,c="".concat(e.baseUrl).concat(e.getPath({cluster:o,namespace:a}),"/services?labelSelector=");switch(n){case k.RadonDBAppId.ClickHouse:c="".concat(c,"clickhouse.radondb.com/chi=").concat(r,",clickhouse.radondb.com/Service=chi ");break;case k.RadonDBAppId.MySQL:c="".concat(c,"app.kubernetes.io/instance=").concat(r,",mysql.radondb.com/service-type+in+(leader-service,follower-service)");break;case k.RadonDBAppId.PostgreSQL:c="".concat(c,"app-name=").concat(r);break;case k.RadonDBAppId.RedisCluster:c="".concat(c,"redis.radondb.com/name=").concat(r,",role+in+(leader,follower,proxy)");break;case k.RadonDBAppId.RedisSentinel:c="".concat(c,"redis.radondb.com/name=").concat(r,",redis.radondb.com/role+in+%28master%2Cslave%29");break;case k.RadonDBAppId.Elasticsearch:c="".concat(c,"elasticsearch.k8s.elastic.co/cluster-name=").concat(r);break;case"kibana":c="".concat(c,"common.k8s.elastic.co/type=kibana,kibana.k8s.elastic.co/name=").concat(r);break;case k.RadonDBAppId.OpenSearch:c="".concat(c,"app.kubernetes.io/service=").concat(r);break;default:c="".concat(c,"app.kubernetes.io/instance=").concat(r)}return c},e.dataFormatter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=(0,E.default)(e,"spec.ports[0].port",""),r=e.spec.type,n=(0,E.default)(e,"spec.ports[0].nodePort",""),o=e.metadata.namespace,c=e.metadata.name,s=e.spec.clusterIP;return{serviceName:c,namespace:o,role:(0,E.default)(e,"metadata.labels.role",""),uid:e.metadata.uid,tcpPort:a,httpPort:n,nodeIP:t,type:r,clusterIP:s,address:"NodePort"===r?"".concat(t,":").concat(n):"".concat(c,".").concat(o,":").concat(a),_originData:e}},(0,f.default)(e,"fetchList",u,(0,h.default)(e)),e}return(0,m.default)(a,[{key:"getPath",value:function(e){var t=e.namespace,a=e.cluster,r="";return globals.app.isMultiCluster&&a&&(r+="/clusters/".concat(a)),r+="/v1",t&&(r+="/namespaces/".concat(t)),r}},{key:"baseUrl",get:function(){return"/api"}}]),a}(O.default),i=(0,y.default)(l.prototype,"data",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u=(0,y.default)(l.prototype,"fetchList",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,d.default)(n.default.mark((function t(a){var r,s,l,i,u,d,f,p,m,h,v,_,g,y;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.nodeStore.fetchList({cluster:a.cluster,namespace:a.namespace,workspace:a.workspace});case 2:return r=(0,E.default)(e.nodeStore,"list.data[0].ip",location.hostname),s=(0,E.default)(e.nodeStore.list.data.find((function(e){return"master"===(0,E.default)(e,"role[1]")})),"ip",r),t.next=6,request.get(e.getUrl(a));case 6:if(l=t.sent,i=[],i=l.items.map((function(t){return e.dataFormatter(t,s)})),a.app_id!==k.RadonDBAppId.MySQL){t.next=13;break}i.sort((function(e){return e.serviceName.endsWith("leader")?-1:0})),t.next=31;break;case 13:if(a.app_id!==k.RadonDBAppId.PostgreSQL){t.next=18;break}(u=i.find((function(e){return e.serviceName.endsWith("readwrite")})))?(d=i.find((function(e){return e.serviceName.endsWith("standby-readonly")})),i=[u],d&&i.push(d)):i=[],t.next=31;break;case 18:if(a.app_id!==k.RadonDBAppId.MongoDB){t.next=22;break}i=i.filter((function(e){return!e.serviceName.endsWith("arb-svc")})),t.next=31;break;case 22:if(a.app_id!==k.RadonDBAppId.Elasticsearch){t.next=30;break}return t.next=25,request.get(e.getUrl(A(A({},a),{},{app_id:"kibana"})));case 25:f=t.sent,p=f.items.map((function(t){return e.dataFormatter(t,s)})),i=i.filter((function(e){return e.serviceName.endsWith("es-http")})).concat(p),t.next=31;break;case 30:a.app_id===k.RadonDBAppId.RedisCluster?(i=i.filter((function(e){return!("ClusterIP"===e.type&&"None"===e.clusterIP)})),m=i.filter((function(e){return"proxy"===e.role})),h=(0,c.default)(m,1),v=h[0],_=i.filter((function(e){return["master","leader"].includes(e.role)})),g=i.filter((function(e){return["slave","follower"].includes(e.role)})),i=[].concat((0,o.default)(_),(0,o.default)(g)),v&&i.push(v)):a.app_id===k.RadonDBAppId.Kafka?((y=i.find((function(e){return e.serviceName==="".concat(a.chi,"-kafka-external-bootstrap")})))||((y=i.find((function(e){return e.serviceName==="".concat(a.chi,"-kafka-bootstrap")})))?((0,b.default)(y,"tcpPort",9092),(0,b.default)(y,"address","".concat(y.serviceName,".").concat(y.namespace,":").concat(y.tcpPort))):y={}),i=[y]):a.app_id===k.RadonDBAppId.OpenSearch&&(i=i.filter((function(e){return["".concat(a.chi,"-dashboards"),a.chi].includes(e.serviceName)})));case 31:return e.data=i,t.abrupt("return",i);case 33:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),l);t.default=D},3719:function(e,t,a){e.exports={DBApps:"_3-0tmC5ougAAijdgdXVLxt",appCreate:"s7pbKzK7DM6633M7NaihK",deployButton:"_23Ikqf30Vp5V0MKr2gVpMY",tooltips:"_1gRd-xJ4oMIOrNkh9Sqwe2",tooltipTitle:"_1nGcPtm4xUo0acXoJoML88",tag:"_1938FqkHFBzXN_r2XiKL0N"}},3720:function(e,t,a){"use strict";a(16);var r=a(19),n=a(162);a(3),a(6),a(14),a(4),a(18),a(30),a(11),a(69),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(6),a(27),a(29),a(14),a(4),a(18),a(43),a(30),a(11),a(69),a(7);var o,c=r(a(25)),s=r(a(28)),l=r(a(41)),i=r(a(42)),u=r(a(37)),d=n(a(0)),f=a(243),p=r(a(26)),m=a(318),h=r(a(443));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=(0,f.inject)("rootStore","workspaceStore","projectStore")(o=(0,f.observer)(o=function(e){(0,l.default)(a,e);var t=v(a);function a(e){var r;return(0,c.default)(this,a),(r=t.call(this,e)).workspaceStore=new h.default,r.state={fetchFin:!1},r.handleChange=function(e){return r.props.rootStore.routing.push(e)},r.workspaceStore=new h.default,r}return(0,s.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.match;this.workspaceStore.fetchDetail(e.params)}},{key:"getRoutes",value:function(e){var t=this.props.route,a=t.routes,r=t.path,n=(0,p.default)(e,"[0]",{}),o=(0,p.default)(n.children,"[0].name")||n.name;return o?(a&&a.forEach((function(e){e.path===r&&e.redirect&&(e.redirect.to="".concat(r,"/").concat(o))})),a):[]}},{key:"render",value:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace,n=globals.app.getProjectNavs({cluster:a,workspace:t,project:r,licenseInfo:this.licenseInfo});return d.default.createElement(d.default.Fragment,null,(0,m.renderRoutes)(this.getRoutes(n)))}},{key:"licenseInfo",get:function(){return this.props.rootStore.licenseInfo}}]),a}(d.Component))||o)||o;t.default=_},3721:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(31)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=r(243),m=r(189),h=n(r(26)),v=n(r(874)),_=r(17),g=n(r(3722)),y=n(r(3723)),E=n(r(3725)),b=n(r(3727)),S=n(r(3729)),O=n(r(3731)),R=n(r(3733)),k=n(r(3735)),C=n(r(3737)),A=n(r(3741));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var N=(0,p.inject)("rootStore","workspaceStore","projectStore")(o=(0,p.observer)(o=function(e){(0,i.default)(r,e);var a=P(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).state={rankModalVisible:!1},e.quotaStore=new v.default,e.showRankModal=function(){e.setState({rankModalVisible:!0})},e.hideRankModal=function(){e.setState({rankModalVisible:!1})},e}return(0,l.default)(r,[{key:"componentDidMount",value:function(){this.quotaStore.fetch(this.params)}},{key:"render",value:function(){var e=this.project.detail;return f.default.createElement("div",{className:g.default.container},f.default.createElement("div",{className:g.default.header},f.default.createElement("div",{className:g.default.title},t("OVERVIEW"))),f.default.createElement("div",{className:g.default.content},f.default.createElement(m.Columns,{className:g.default["margin-t0"]},f.default.createElement(m.Column,{className:"is-8"},f.default.createElement(y.default,{currentResource:this.props.match.params}),this.hasMonitoring&&f.default.createElement(E.default,{currentResource:this.props.match.params}),f.default.createElement(C.default,{detail:(0,_.toJS)(this.quotaStore.data),isLoading:(0,_.toJS)(this.quotaStore.isLoading),currentResource:this.props.match.params}),this.hasAlerting&&f.default.createElement(O.default,{currentResource:this.props.match.params}),this.hasMonitoring&&f.default.createElement(b.default,{currentResource:this.props.match.params})),f.default.createElement(m.Column,{className:"is-4"},f.default.createElement(S.default,{detail:e}),this.hasRolesAndMembersPermission&&f.default.createElement(k.default,{currentResource:this.props.match.params}),this.hasMonitoring&&f.default.createElement(R.default,{currentResource:this.props.match.params,showRankModal:this.showRankModal})))),f.default.createElement(A.default,{visible:this.state.rankModalVisible,currentResource:this.props.match.params,onCancel:this.hideRankModal}))}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"namespace",get:function(){return(0,h.default)(this.props.match,"params.namespace")}},{key:"project",get:function(){return this.props.projectStore}},{key:"hasMonitoring",get:function(){return globals.app.hasClusterModule(this.params.cluster,"whizard-monitoring")}},{key:"hasAlerting",get:function(){return globals.app.hasClusterModule(this.params.cluster,"whizard-alerting")}},{key:"hasRolesAndMembersPermission",get:function(){return globals.app.hasPermission(D(D({module:"members",action:"view"},this.props.match.params),{},{project:this.namespace}))&&globals.app.hasPermission(D(D({module:"roles",action:"view"},this.props.match.params),{},{project:this.namespace}))}},{key:"params",get:function(){return(0,h.default)(this.props.match,"params",{})}}]),r}(f.default.Component))||o)||o;a.default=N},3722:function(e,t,a){e.exports={header:"_1Um9mkZMhZpKEABScgLNpJ",title:"_2wVmDmuR6LGiOpXlQeUi-x","margin-t0":"_1pISvCPNfllVcAULglinkQ",padding12:"nfkKAFwB8GcBcPniXLbts",clusterTitle:"_2cHhlQr83260nQS0tPEMWW",content:"BtcrYnedHHxDgD_5bJQiz"}},3723:function(e,a,r){"use strict";r(16);var n=r(162),o=r(19);r(10),r(20),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=o(r(31)),s=o(r(38));r(35);var l=o(r(39)),i=o(r(97));r(10),r(20),r(14),r(4),r(21);var u=n(r(0)),d=o(r(802)),f=o(r(823)),p=o(r(26)),m=r(189),h=o(r(5)),v=o(r(941)),_=o(r(3724)),g=(0,u.memo)((function(e){var a=e.currentResource,r=[{name:"pod",icon:"pod",title:"POD"},{name:"deployment",icon:"backup",title:"DEPLOYMENT"},{name:"statefulset",icon:"stateful-set",title:"STATEFULSET"},{name:"daemonset",icon:"deamon-set",title:"DAEMONSET"},{name:"job",icon:"backup",title:"JOB"},{name:"cronjob",icon:"backup",title:"CRONJOB"},{name:"persistentvolumeclaim",icon:"storage",title:"PERSISTENT_VOLUME_CLAIM"},{name:"service",icon:"appcenter",title:"SERVICE"},{name:"ingress",icon:"loadbalancer",title:"ROUTE"}].filter((function(e){return!e.isHidden})),n=(0,u.useState)({}),o=(0,i.default)(n,2),g=o[0],y=o[1],E=(0,u.useState)(!1),b=(0,i.default)(E,2),S=b[0],O=b[1],R=(0,u.useCallback)(function(){var e=(0,l.default)(s.default.mark((function e(t){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,t.getBaseResourcesSummary({namespace:a.namespace,cluster:a.cluster});case 3:r=e.sent,y(r),O(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return(0,u.useEffect)((function(){var e=new v.default({cluster:a.cluster});R(e)}),[]),u.default.createElement(f.default,{className:_.default.resourceSummary},u.default.createElement(m.Loading,{spinning:S},u.default.createElement("div",{className:_.default.wrapper},r.map((function(e){var a="namespace_".concat(e.name,"_count"),r=(0,p.default)(g,"".concat(a,".value.[1]"),0);return u.default.createElement("div",{className:(0,h.default)(_.default.wrapperItem,(0,c.default)({},_.default.wrapperItemHover,e.more)),key:e.name},u.default.createElement(d.default,{noLink:!0,className:_.default.avatar,icon:e.icon,title:r,desc:t("1"===r?e.title:"".concat(e.title,"_PL")),iconSize:40}))})))))}));a.default=g},3724:function(e,t,a){e.exports={resourceSummary:"Nagl9ihmr1bayFuDkeBTn",wrapper:"EAT7YapwWYDVekN6Fo34-",wrapperItem:"_3yhyyvQSH9XcDKt6IZuCjV",wrapperItemHover:"_3VfNpdurl4SNdOlghpDW5n",avatar:"_2nEc5ZKsZzGv3jSQ1W7_Co"}},3725:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(193),r(8),r(13),r(9),r(4),r(190),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(193),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(440),r(21),r(18),r(43),r(11),r(7);var o=n(r(317)),c=n(r(38)),s=n(r(31));r(35);var l,i=n(r(39)),u=n(r(25)),d=n(r(28)),f=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=r(189),_=n(r(941)),g=n(r(892)),y=r(820),E=r(243),b=n(r(5)),S=n(r(26)),O=r(56),R=n(r(1533)),k=r(803),C=n(r(3726));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var P={cpu_usage:"namespace_cpu_usage",gpu_usage:"namespace_gpu_usage",gpu_memory_usage:"namespace_gpu_memory_usage",memory_usage:"namespace_memory_usage",limit_memory_usage:"namespace_memory_requests_hard",limit_cpu_usage:"namespace_cpu_requests_hard",storage_size_usage:"namespace_pvc_bytes_used",storage_size_usage_block:"namespace_block_storage_pvc_bytes_used",storage_size_usage_file:"namespace_file_storage_pvc_bytes_used",storage_size_usage_object:"namespace_object_storage_pvc_bytes_used",storage_size_usage_undefined:"namespace_undefined_pvc_bytes_used",storage_size_total:"namespace_pvc_bytes_total",storage_size_total_block:"namespace_block_storage_pvc_bytes_total",storage_size_total_file:"namespace_file_storage_pvc_bytes_total",storage_size_total_object:"namespace_object_storage_pvc_bytes_total",storage_size_total_undefined:"namespace_undefined_pvc_bytes_total"},N={cpu_total:"cluster_cpu_total",gpu_total:"cluster_gpu_total",gpu_memory_total:"cluster_gpu_memory_total",memory_total:"cluster_memory_total"},I={BlockStorage:{total:"storage_size_total_block",usage:"storage_size_usage_block"},FileStorage:{total:"storage_size_total_file",usage:"storage_size_usage_file"},ObjectStorage:{total:"storage_size_total_object",usage:"storage_size_usage_object"},UndefinedStorage:{total:"storage_size_total_undefined",usage:"storage_size_usage_undefined"},all:{total:"storage_size_total",usage:"storage_size_usage"}},w=(0,E.observer)(l=function(e){(0,f.default)(r,e);var a=D(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=a.call.apply(a,[this].concat(o))).state={active:"cpu",params:{times:10,step:"48m"},storageClass:"all"},e.monitorStore=new _.default({cluster:e.cluster}),e.clusterMonitorStore=new g.default({cluster:e.cluster}),e.fetchData=function(){var t=(0,i.default)(c.default.mark((function t(a){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.monitorStore.fetchMetrics(T(T({metrics:Object.values((0,O.hideGPUByLicense)(P,e.cluster))},e.state.params),a));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.fetchClusterData=function(){var t=(0,i.default)(c.default.mark((function t(a){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.clusterMonitorStore.fetchMetrics(T(T({metrics:Object.values((0,O.hideGPUByLicense)(N,e.cluster))},e.state.params),a));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getValue=function(e){return(0,S.default)(e,"value[1]",0)},e.handleSelect=function(t){e.setState({active:t})},e.renderTabItem=function(a){var r,n,o=a.type,c=a.icon,l=a.name,i=a.unit,u=a.used,d=a.total,f=a.unitType,p=a.filters,m=(0,k.getSuitableUnit)(d||u,f)||i,_=(0,k.getValueByUnit)(u,m),g=(0,k.getValueByUnit)(d,m),y="core"===m?"CORE_PL":m,E=e.state.active===o,S=_&&g?_/g*100:0,O=e.tabOptions.length,A="PERSISTENT_VOLUME"===l;return h.default.createElement("div",{className:(0,b.default)(C.default.tabItem,(0,s.default)({},C.default.checked,E)),key:o,onClick:function(){return e.handleSelect(o)}},h.default.createElement("div",{className:C.default.labelRow},h.default.createElement("div",{className:C.default.label},h.default.createElement(v.Icon,{name:c,size:20,type:E?"light":"dark"}),h.default.createElement("span",{className:A&&5===O?C.default.text:"",title:t(l)},t(l)),h.default.createElement("span",null,t(y)),A&&h.default.createElement(v.Tooltip,{content:t("PVC_USAGE_TOOLTIP_MESSAGE")},h.default.createElement(v.Icon,{name:"question",size:20}))),p&&h.default.createElement("div",{onClick:function(e){e.stopPropagation()}},h.default.createElement(v.Select,{size:"small",options:p.options,value:null!==(r=e.state[p.key])&&void 0!==r?r:"all",onChange:null!==(n=p.onChange)&&void 0!==n?n:function(t){e.setState({params:T(T({},e.state.params),{},(0,s.default)({},p.key,"all"===t?void 0:t))})}}))),h.default.createElement("div",{className:C.default.value},h.default.createElement("span",null,_),h.default.createElement("span",null,"/",g)),h.default.createElement("div",{className:C.default.progress},h.default.createElement(R.default,{className:(0,b.default)((0,s.default)({},C.default.progressActive,E)),percent:parseFloat(S.toFixed(2)),content:h.default.createElement("div",{className:C.default.tabItem_tooltip},h.default.createElement("div",null,t(l)),h.default.createElement("p",null,h.default.createElement("i",null),"core"===m?t("USED_VALUE_CORES_PERCENTAGE",{value:_,percentage:0!==S?"".concat(S.toFixed(2),"%"):"0%"}):t("USED_VALUE_UNIT_PERCENTAGE",{value:_,unit:m,percentage:0!==S?"".concat(S.toFixed(2),"%"):"0%"})),h.default.createElement("p",null,h.default.createElement("i",null),"core"===m?t("TOTAL_VALUE_CORES",{value:g}):t("TOTAL_VALUE_UNIT",{value:g,unit:m})))})))},e}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.fetchData({namespace:this.namespace}),this.fetchClusterData()}},{key:"renderChart",value:function(){var e=this,t=this.renderChartOption.filter((function(t){return t.category===e.state.active}))[0],a={key:t.title,width:"100%",height:"100%",referenceLineColor:"yellow",showReferenceLabel:!1},r=(0,k.getAreaChartOps)(t);return h.default.createElement(y.SimpleArea,(0,o.default)({},a,r))}},{key:"render",value:function(){var e=this,a=this.monitorStore.isLoading,r=this.clusterMonitorStore.isLoading;return h.default.createElement("div",{className:C.default.container},h.default.createElement("div",{className:C.default.header},h.default.createElement("div",{className:C.default.title},t("RESOURCE_USAGE"))),h.default.createElement(v.Loading,{spinning:a||r},h.default.createElement(h.default.Fragment,null,h.default.createElement("div",{className:C.default.tabs},h.default.createElement("div",{className:C.default.tabsHeader},this.tabOptions.map((function(t){return e.renderTabItem(t)}))),h.default.createElement("div",{className:C.default.tabsBody})),h.default.createElement("div",{className:C.default.chartContainer},this.renderChart()))))}},{key:"cluster",get:function(){return this.props.currentResource.cluster}},{key:"workspace",get:function(){return this.props.currentResource.workspace}},{key:"namespace",get:function(){return this.props.currentResource.namespace}},{key:"metrics",get:function(){return this.monitorStore.data}},{key:"clusterMetrics",get:function(){return this.clusterMonitorStore.data}},{key:"showLicenseTip",get:function(){var e;return(null===(e=globals.licenseInfo)||void 0===e?void 0:e.showLicenseTip)||!(0,S.default)(globals,'ksConfig["gpu.monitoring"]',!1)}},{key:"tabOptions",get:function(){var e,a,r=this,n=(0,k.getLastMonitoringData)(this.metrics),o=(0,k.getLastMonitoringData)(this.clusterMetrics),c=[{icon:"cpu",type:"cpu",name:"CPU",unitType:"cpu",used:this.getValue(n[P.cpu_usage]),total:this.getValue(o[N.cpu_total])},{icon:"memory",type:"memory",name:"MEMORY",unitType:"memory",used:this.getValue(n[P.memory_usage]),total:this.getValue(o[N.memory_total])},{icon:"gpu",type:"gpu",name:"GPU",used:this.getValue(n[P.gpu_usage]),total:this.getValue(o[N.gpu_total])},{icon:"computing",type:"gpu_merrory",name:"GPU_MEMORY",unitType:"memory",used:this.getValue(n[P.gpu_memory_usage]),total:this.getValue(o[N.gpu_memory_total])},{icon:"storage",type:"storage",name:"PERSISTENT_VOLUME",unitType:"memory",used:this.getValue(n[P[null===(e=I[this.state.storageClass])||void 0===e?void 0:e.usage]]),total:this.getValue(n[P[null===(a=I[this.state.storageClass])||void 0===a?void 0:a.total]]),filters:{key:"storageClass",onChange:function(e){r.setState({storageClass:e})},options:[{value:"all",label:t("ALL")},{value:"BlockStorage",label:t("BLOCK_STORAGE")},{value:"ObjectStorage",label:t("OBJECT_STORAGE")},{value:"FileStorage",label:t("FILE_STORAGE")},{value:"UndefinedStorage",label:t("UNCLASSIFIED")}]}}].filter((function(e){return!e.isHidden}));return(0,O.hideGPUByLicense)(c,this.cluster)}},{key:"renderChartOption",get:function(){var e,t=(0,k.getLastMonitoringData)(this.metrics),a=[{key:"CPU_USAGE",title:"CPU_USAGE",category:"cpu",unitType:"cpu",legend:["CPU_USAGE"],alert:{name:"requests.cpu",value:this.getValue(t[P.limit_cpu_usage])},data:(0,S.default)(this.metrics,"".concat(P.cpu_usage,".data.result"))},{key:"MEMORY_USAGE",title:"MEMORY_USAGE",category:"memory",unitType:"memory",legend:["MEMORY_USAGE"],alert:{name:"requests.memory",value:this.getValue(t[P.limit_memory_usage])},data:(0,S.default)(this.metrics,"".concat(P.memory_usage,".data.result"))},{key:"GPU_USAGE",title:"GPU_USAGE",category:"gpu",unitType:"gpu",legend:["GPU_USAGE"],data:(0,S.default)(this.metrics,"".concat(P.gpu_usage,".data.result"))},{key:"GPU_MEMORY_USAGE",title:"GPU_MEMORY_USAGE",category:"gpu_merrory",unitType:"memory",legend:["GPU_MEMORY_USAGE"],data:(0,S.default)(this.metrics,"".concat(P.gpu_memory_usage,".data.result"))},{key:"PERSISTENT_VOLUME_CLAIM_LOW_PL",title:"PVC_BYTES_USED_TCAP",category:"storage",unitType:"memory",legend:["PVC_BYTES_USED_TCAP"],data:(0,S.default)(this.metrics,"".concat(P[null===(e=I[this.state.storageClass])||void 0===e?void 0:e.usage],".data.result"))}];return(0,O.hideGPUByLicense)(a,this.cluster)}}]),r}(h.default.Component))||l;a.default=w},3726:function(e,t,a){e.exports={container:"_3GuPSynBq8zocA9pvy1Ig2",header:"_3Dn5F_MUwQCpUIP-qze0DY",title:"_8mdqHiY75DhNe5P25vG85",timeSelector:"_362USm0EEQ8y-vsnwJMRuW",tabs:"DocLdUqTU7qlKQSKxZ84H",tabsHeader:"_2mdJ7e7ovp9QabPEipj61I",tabItem:"EQVjl0TkIG5YrcLYxVMlM",labelRow:"_1FXNPHdAzjtEzGkjNVUgm-",label:"_1ew8X41G8sAUSHeKM0UQVU",text:"_1xJXV3bC0Z_kKsuoSmgXJm",value:"mpWStIWpNScCj7BFebtwK",progress:"DCbpfvNsqaAkYqdLwMSPL",progressActive:"_21ll_AQdCEgk4kmSUvBN3v",checked:"_3tH3fb2Mc5dAo6pB3sVl3P",chartContainer:"_3FExDcARUBT0TG2-IX5Cwz",tabItem_tooltip:"_1-P_-DA076FbC5a-z4z9MY"}},3727:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(192),r(10),r(6),r(20),r(8),r(13),r(9),r(4),r(190),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(192),r(10),r(6),r(20),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(440),r(21),r(18),r(43),r(11),r(7);var o=n(r(317)),c=n(r(38)),s=n(r(31));r(35);var l,i=n(r(39)),u=n(r(25)),d=n(r(28)),f=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=r(243),_=n(r(941)),g=r(189),y=r(820),E=n(r(5)),b=n(r(26)),S=n(r(67)),O=r(803),R=n(r(3728));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var T={oomkilled:"namespace_pod_oomkilled_count",pending:"namespace_pod_pending_count",evict:"namespace_pod_evicted_count",pod_total:"namespace_pod_count",pod_running:"namespace_pod_running_count",pod_pending:"namespace_pod_pending_count",pod_succeeded:"namespace_pod_succeeded_count",pod_failed:"namespace_pod_failed_count",pod_unknown:"namespace_pod_unknown_count",guaranteed:"namespace_pod_qos_guaranteed_count",burstable:"namespace_pod_qos_burstable_count",bestEffort:"namespace_pod_qos_besteffort_count"},D=(0,v.observer)(l=function(e){(0,f.default)(r,e);var a=A(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=a.call.apply(a,[this].concat(o))).monitorStore=new _.default({cluster:e.props.currentResource.cluster}),e.state={params:{times:10,step:"48m"}},e.fetchData=function(){var t=(0,i.default)(c.default.mark((function t(a){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.monitorStore.fetchMetrics(C(C({metrics:Object.values(T)},e.state.params),a));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getValue=function(e){return parseFloat((0,b.default)(e,"value[1]",0))},e.renderChartTitle=function(e){var a=e.icon,r=e.used,n=e.title;return h.default.createElement("div",{className:R.default.chartTitle},h.default.createElement(g.Icon,{name:a,size:42}),h.default.createElement("div",{className:R.default.chartInfo},h.default.createElement("p",null,r),h.default.createElement("p",null,t(n))))},e.renderTooltipQos=function(){var e=h.default.createElement("div",{className:R.default.qosContent},h.default.createElement("p",null,t.html("QOS_GUARANTEED")),h.default.createElement("br",null),h.default.createElement("p",null,t.html("QOS_BURSTABLE")),h.default.createElement("br",null),h.default.createElement("p",null,t.html("QOS_BESTEFFORT")));return h.default.createElement(g.Tooltip,{content:e},h.default.createElement(g.Icon,{name:"question",size:16}))},e}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.fetchData({namespace:this.props.currentResource.namespace})}},{key:"renderChart",value:function(e){var a=(0,O.getAreaChartOps)(e);return(0,S.default)(a.data)?h.default.createElement("p",{className:R.default.noData},t("NO_DATA")):h.default.createElement(y.MediumArea,(0,o.default)({},a,{noTitle:!0,top:4,width:"100%",height:48,key:e.title}))}},{key:"renderPie",value:function(e){return h.default.createElement(y.MultiPie,{legendClassName:R.default.legendClassName,dataList:e.dataList,wrapperStyle:{display:"flex",left:"166px",justifyContent:"space-between",width:"calc(100% - 166px)"}})}},{key:"render",value:function(){var e=this,a=this.monitorStore.isLoading;return h.default.createElement("div",{className:R.default.container},h.default.createElement("div",{className:R.default.header},h.default.createElement("div",{className:R.default.title},t("POD_PL"))),h.default.createElement(g.Loading,{spinning:a},h.default.createElement("div",{className:R.default.flexcontainer},h.default.createElement("div",{className:(0,E.default)(R.default.chartbox,R.default.status)},this.renderPieOption.map((function(a,r){var n=a.dataList.every((function(e){return e.data.every((function(e){return 0===e.value}))}));return h.default.createElement("div",{className:(0,E.default)(R.default.item_pie,R.default.item),key:r},h.default.createElement("div",{className:R.default.pie_title},t(a.title),h.default.createElement("span",{className:R.default.pie_title_tooltip},"QoS"===a.title&&e.renderTooltipQos())),h.default.createElement("div",{className:R.default.pie_box},n?h.default.createElement("div",{className:R.default.pieNoData},h.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/doughnut_chart_duotone.svg"}),h.default.createElement("p",null,t("NO_DATA"))):h.default.createElement(h.default.Fragment,null,e.renderPie(a),h.default.createElement("div",{className:R.default.summary},h.default.createElement("p",null,a.total),h.default.createElement("p",null,t("ALL"))))))}))),h.default.createElement("div",{className:R.default.chartbox},this.renderChartOption.map((function(t,a){return h.default.createElement("div",{className:(0,E.default)(R.default.item,R.default.areaChartItem),key:a},e.renderChartTitle(t),h.default.createElement("div",{className:R.default.chartBox},e.renderChart(t)))}))))))}},{key:"metrics",get:function(){return this.monitorStore.data}},{key:"renderChartOption",get:function(){var e=(0,O.getLastMonitoringData)(this.metrics);return[{category:"oomkilled",title:"OOM_KILL_PODS",icon:"error",unit:"",legend:["OOM_KILL_PODS"],data:(0,b.default)(this.metrics,"".concat(T.oomkilled,".data.result")),used:this.getValue(e[T.oomkilled])},{category:"pending",title:"PENDING_PODS",icon:"history-duotone",unit:"",legend:["PENDING_PODS"],data:(0,b.default)(this.metrics,"".concat(T.pending,".data.result")),used:this.getValue(e[T.pending])},{category:"evict",title:"EVICTED_PODS",unit:"",legend:["EVICTED_PODS"],icon:"logout-right-duotone",data:(0,b.default)(this.metrics,"".concat(T.evict,".data.result")),used:this.getValue(e[T.evict])}]}},{key:"renderPieOption",get:function(){var e=(0,O.getLastMonitoringData)(this.metrics);return[{title:"POD_STATUS",total:this.getValue(e[T.pod_total]),dataList:[{dataKey:"value",innerRadius:45,outerRadius:60,colors:["#55BC8A","#F5A623","#79879C","#CA2621","#E3E9EF","#EFF4F9"],data:[{name:t("RUNNING"),value:this.getValue(e[T.pod_running])},{name:t("PENDING"),value:this.getValue(e[T.pod_pending])},{name:t("COMPLETED"),value:this.getValue(e[T.pod_succeeded])},{name:t("FAILED"),value:this.getValue(e[T.pod_failed])},{name:t("UNKNOWN"),value:this.getValue(e[T.pod_unknown])}]}]},{title:"QoS",total:this.getValue(e[T.pod_total]),dataList:[{dataKey:"value",innerRadius:45,outerRadius:60,colors:["#55BC8A","#329DCE","#F5A623","#EFF4F9"],data:[{name:"Guaranteed",value:this.getValue(e[T.guaranteed])},{name:"Burstable",value:this.getValue(e[T.burstable])},{name:"BestEffort",value:this.getValue(e[T.bestEffort])}]}]}]}}]),r}(h.default.Component))||l;a.default=D},3728:function(e,t,a){e.exports={container:"J7tCTUkswYRzJsO0NgZZu",flexcontainer:"_3CbN5d3vZaXavemUVHDVQS",header:"_6ghRiiHWXvLKQ5w0BO8NR",title:"_32H4kdJD2BX6Z8o7AeuUd1",chartbox:"_1RvtU7HdY8e0s8UfhruFyB",status:"sqJBrDv3OrN6212SdDYj2",item:"WpOtBbMQ3nE17kvQjxi94",chartTitle:"_23OWBoKYAh-Alfe0hAkvd3",chartInfo:"mK8cfzKDGDLdtPHDIGMnV",areaChartItem:"_1OtGRViD8iWgPVGEtUp0b9",chartBox:"_2ECTbwKe_aXrhhQPEVcpUY",noData:"_1XiL3NmVhlR-30vmZL-FtS",item_pie:"_25d6HtFivLrIB_26I9aCIg",pie_title:"_3tCIO14zcjmn8h0GItIWRO",pie_title_tooltip:"_322njTecIZj8AZPp2RM7ni",pie_box:"_3yq5IiX8rFrsIuGBLEWU85",legendClassName:"_2AY_MsBBZmz9Mjg-PL2mmZ",pieNoData:"_1UTXz37gIdPgjcVmeHitIF",summary:"_3Fu0ReLngxrRaQYLgK7HXi"}},3729:function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109);var o=n(r(5)),c=n(r(802)),s=n(r(245)),l=n(r(0)),i=r(437),u=r(56),d=n(r(3730)),f=function(e){var a=e.className,r=e.detail,n=void 0===r?{}:r;return l.default.createElement("div",{className:(0,o.default)(d.default.wrapper,a)},l.default.createElement("div",{className:d.default.header},l.default.createElement(c.default,{noLink:!0,className:d.default.avatar,icon:"project",title:(0,u.showNameAndAlias)(n),desc:n.description||"-",iconSize:48,iconType:"light"})),l.default.createElement("div",{className:d.default.content},l.default.createElement("div",{className:d.default.title},t("BASIC_INFORMATION")),l.default.createElement("div",{className:d.default.infoList},l.default.createElement("div",{className:d.default.text},l.default.createElement("div",null,(0,u.showNameAndAlias)(n.cluster,"cluster",{},!1,void 0,!0)||"-"),l.default.createElement("p",null,t("CLUSTER"))),l.default.createElement("div",{className:d.default.text},l.default.createElement("div",null,n.workspace?l.default.createElement(i.Link,{to:"/workspaces/".concat(n.workspace,"/overview")},(0,u.showNameAndAlias)(n.workspace,"workspace",{},void 0,void 0,!0)):"-"),l.default.createElement("p",null,t("WORKSPACE"))),l.default.createElement("div",{className:d.default.text},l.default.createElement("div",null,n.creator||"-"),l.default.createElement("p",null,t("CREATOR"))),l.default.createElement("div",{className:d.default.text},l.default.createElement("div",null,n.createTime?(0,s.default)(n.createTime).format("YYYY-MM-DD HH:mm:ss"):"-"),l.default.createElement("p",null,t("CREATION_TIME"))))))};a.default=f},3730:function(e,t,a){e.exports={wrapper:"_3krx7rpQbk7J9P3x6V9xc7",header:"_1yX2Zr69asT3KEERbB2lgG",avatar:"_1JgmWPB54tUdOiiCFwAi6J",content:"JgySaCSUzjxdMRSTvyDYm",title:"_2y8D379qMiuJoM7xfn2fJ1",infoList:"_1nNWjTTGqcG024P7VX7kB7",text:"j5DVVp4LaRGIfr1uYxeNt"}},3731:function(e,a,r){"use strict";var n=r(162),o=r(19);r(12),r(192),r(10),r(6),r(20),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(192),r(10),r(6),r(20),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(440),r(21),r(7);var c=o(r(317)),s=o(r(38)),l=o(r(31));r(35);var i=o(r(39)),u=o(r(97)),d=n(r(0)),f=r(820),p=o(r(26)),m=r(803),h=r(17),v=o(r(941)),_=o(r(3732));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function E(e){var a=e.currentResource,r=(0,d.useState)({data:[],isLoading:!1}),n=(0,u.default)(r,2),o=n[0],l=n[1],g=(0,d.useCallback)(function(){var e=(0,i.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l({isLoading:!0,data:[]}),e.next=3,t.fetchAlertData(y({},a));case 3:l((0,h.toJS)(t.alertData));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);(0,d.useEffect)((function(){var e=new v.default({cluster:a.cluster});g(e)}),[]);var E=(0,d.useCallback)((function(e){return parseFloat((0,p.default)(e,"value[1]",0))}),[]),b=(0,d.useCallback)((function(){var e=(0,h.toJS)(o.data),a=(0,m.getLastMonitoringData)(e);return[{category:"criticalAlert",data:(0,p.default)(e,"namespace_alerts_critical_total.data.result"),title:t("CRITICAL_ALERT"),unit:"",legend:[t("CRITICAL_ALERT")],used:E(a.namespace_alerts_critical_total),areaColors:["red"]},{category:"errorAlert",data:(0,p.default)(e,"namespace_alerts_error_total.data.result"),title:t("ERROR_ALERT"),unit:"",legend:[t("ERROR_ALERT")],used:E(a.namespace_alerts_error_total),areaColors:["yellow"]},{category:"warningAlert",data:(0,p.default)(e,"namespace_alerts_warning_total.data.result"),title:t("WARNING_ALERT"),legend:[t("WARNING_ALERT")],unit:"",used:E(a.namespace_alerts_warning_total),areaColors:["darkGray"]}]}),[o.data]),S=(0,d.useCallback)((function(){var e=(0,h.toJS)(o.data),a=(0,m.getLastMonitoringData)(e);return{title:"PROJECT_ALERTS",total:E(a.namespace_alerts_total),dataList:[{dataKey:"value",innerRadius:45,outerRadius:60,cx:55,colors:["#CA2621","#F5A623","#EFF4F9"],data:[{name:t("ALERT_RULE_FIRING"),value:E(a.namespace_alerts_firing_total)},{name:t("ALERT_RULE_PENDING"),value:E(a.namespace_alerts_pending_total)}]}]}}),[o.data]),O=S().dataList.every((function(e){return e.data.every((function(e){return 0===e.value}))}));return d.default.createElement("div",{className:_.default.alertStatus},d.default.createElement("div",{className:_.default.alertWrapper},d.default.createElement("div",{className:_.default.title},t("PROJECT_ALERTS")),d.default.createElement("div",{className:_.default.charts},d.default.createElement("div",{className:_.default.pieCharts},O?d.default.createElement("div",{className:_.default.noData},d.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/doughnut_chart_duotone.svg"}),d.default.createElement("p",null,t("NO_DATA"))):d.default.createElement(d.default.Fragment,null,d.default.createElement(f.MultiPie,{legendClassName:_.default.legendClassName,dataList:S().dataList}),d.default.createElement("div",{className:_.default.summary},d.default.createElement("p",null,S().total),d.default.createElement("p",null,1===S().total?t("ALERTING_MESSAGE"):t("ALERTING_MESSAGE_PL"))))),d.default.createElement("div",{className:_.default.lineCharts},b().map((function(e){return d.default.createElement("div",{className:_.default.areaCharts,key:e.category},d.default.createElement(f.MediumArea,(0,c.default)({},(0,m.getAreaChartOps)(e),{key:e.title,width:"100%",height:60,renderTitle:function(){return d.default.createElement("div",{className:_.default.areaTitle},d.default.createElement("p",null,e.title),d.default.createElement("b",null,e.used))},top:4})))}))))))}var b=(0,d.memo)(E);a.default=b},3732:function(e,t,a){e.exports={alertStatus:"_3dwBaTednocPLrn9rhgL8d",noData:"_7rCUIvCK2KPNOwS8marRR",alertWrapper:"_3w0Dx88mSxOKG62IcyzWwh",title:"_2onnfl9VLXp4j7v9x3ePPe",charts:"BZTFs8T-Zj404Ew_fXEtP",pieCharts:"_2yHipYWAgbMVOGoeVtjJeV",legendClassName:"_1QFVzVgmxZsOq-F-qQG2bH",summary:"_3DRhpNtWePmNT1fAMAzHSI",lineCharts:"_1GPbpz08yeTbzekF6RMRcI",areaCharts:"VDO6ylkIcklOvCsyEC_B-",areaTitle:"_3rOImp328502JDkKwFnKdk"}},3733:function(e,a,r){"use strict";var n=r(19),o=r(162);r(12),r(3),r(10),r(6),r(20),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(71),r(7);var c,s,l,i=n(r(62)),u=n(r(31)),d=n(r(25)),f=n(r(28)),p=n(r(74)),m=n(r(41)),h=n(r(42)),v=n(r(37)),_=n(r(45)),g=(n(r(63)),r(189)),y=n(r(5)),E=n(r(1151)),b=n(r(800)),S=n(r(26)),O=n(r(67)),R=r(17),k=r(243),C=o(r(0)),A=r(437),T=n(r(1596)),D=r(61),P=r(803),N=n(r(3734));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var M={limit:10,page:1,sort_type:"desc"},L=(0,k.observer)((s=function(e){(0,m.default)(r,e);var a=x(r);function r(){var e;(0,d.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).sourceMap={workload:{store:new T.default(w(w({},M),{},{cluster:e.cluster,namespaces:e.namespace})),icon:"backup",name:"workload"},deployment:{store:new T.default(w(w({},M),{},{cluster:e.cluster,namespaces:e.namespace,kind:"deployment"})),icon:"backup",name:"deployment",url:function(t){return e.getLink(t,"Deployment")}},statefulset:{store:new T.default(w(w({},M),{},{cluster:e.cluster,namespaces:e.namespace,kind:"statefulset"})),icon:"stateful-set",name:"statefulset",url:function(t){return e.getLink(t,"StatefulSet")}},daemonset:{store:new T.default(w(w({},M),{},{cluster:e.cluster,namespaces:e.namespace,kind:"daemonset"})),icon:"deamon-set",name:"daemonset",url:function(t){return e.getLink(t,"DaemonSet")}}},e.getLink=function(t,a){var r=e.props.currentResource,n=r.workspace,o=r.cluster,c=r.namespace,s="".concat(n?"/".concat(n):"","/clusters/").concat(o,"/projects/").concat(c);return{Deployment:"".concat(s,"/deployments/").concat(t),StatefulSet:"".concat(s,"/statefulsets/").concat(t),DaemonSet:"".concat(s,"/daemonsets/").concat(t)}[a]},e.transData=function(a){var r="",n="",o=(0,S.default)(a,e.store.sort_metric,0),c=D.MONITOR_RANK_UNIT_MAP[e.store.sort_metric];return"%"===c?r="".concat((0,P.getValueByUnit)(o,c),"%"):""===c?r=Math.round(100*o)/100:(n=(0,P.getSuitableUnit)(o,c),r=(0,P.getValueByUnit)(o,n)),"".concat("gpu"===n?"".concat(r," GPU"):"core"===n?t("VALUE_CORES",{value:r}):t("VALUE_UNIT",{value:r,unit:n}))},(0,i.default)(e,"store",l,(0,p.default)(e)),e.state={sourceType:"workload",data:[],sortType:"desc",isFold:!0},e.getMetrics=function(t){e.store.fetchAll(w({},t))},e.handleChangeSource=function(t){e.setState({sourceType:t,sortType:"desc"}),e.store=e.sourceMap[t].store,e.getMetrics()},e.handleChangeSortMetric=function(t){e.setState({sortType:"desc"}),e.store.changeSortMetric(t)},e.handleTypeChange=function(t){e.setState({sortType:t}),e.getMetrics({sort_type:t})},e.renderPanelHeader=function(){var a=e.state.sortType;return C.default.createElement("div",{className:N.default.title},C.default.createElement("div",null,t("RESOURCE_USAGE_RANKING")),C.default.createElement(g.RadioGroup,{mode:"button",value:a,onChange:e.handleTypeChange},C.default.createElement(g.RadioButton,{value:"desc"},C.default.createElement(g.Icon,{name:"sort-descending",size:16})),C.default.createElement(g.RadioButton,{value:"asc"},C.default.createElement(g.Icon,{name:"sort-ascending",size:16}))))},e.renderListItems=function(a,r){return(0,O.default)(a)?C.default.createElement(E.default,null):C.default.createElement(C.default.Fragment,null,a.map((function(a,n){var o,c,s,l=e.sourceMap[r].icon,i=null===(o=(c=e.sourceMap[r]).url)||void 0===o?void 0:o.call(c),d=(0,S.default)(a,e.sourceMap[r].name,"-");return a.workload_type&&(i=e.getWorkloadLink(a),d=a.workload.replace(/\w+:/,""),l=D.PROJECT_RANK_RESOURCE_ICON_MAP[a.workload_type]),C.default.createElement("div",{key:"".concat(d,"-").concat(n),className:N.default.listItem},C.default.createElement(g.Icon,{style:{width:52},name:l,size:40,className:"margin-r12"}),C.default.createElement(b.default,{className:N.default.textBox,title:C.default.createElement("div",{className:(0,y.default)(N.default.text,(0,u.default)({},N.default.noLabel,"master"!==a.role))},C.default.createElement(A.Link,{to:i},d),"master"===a.role&&C.default.createElement("span",{className:N.default.label},t("CONTROL_PLANE"))),description:t(null==a||null===(s=a.workload_type)||void 0===s?void 0:s.toUpperCase())}),C.default.createElement("p",{className:N.default.cpu},e.transData(a)))})))},e.toggleFold=function(){e.setState({isFold:!e.state.isFold})},e.showMoreModal=function(){var t,a;null===(t=(a=e.props).showRankModal)||void 0===t||t.call(a)},e}return(0,f.default)(r,[{key:"getWorkloadLink",value:function(e){var t,a=e.workload_type;if("Pod"!==a){var r=null!==(t=null==e?void 0:e.workload.replace(/\w+:/,""))&&void 0!==t?t:"-";return this.getLink(r,a)}}},{key:"componentDidMount",value:function(){this.getMetrics()}},{key:"render",value:function(){var e=this.store,a=e.data,r=e.isLoading,n=this.state,o=n.sourceType,c=n.isFold,s=a.length>5,l=c?a.slice(0,5):a;return C.default.createElement("div",{className:N.default.container},this.renderPanelHeader(),C.default.createElement(g.Loading,{spinning:r},C.default.createElement(C.default.Fragment,null,C.default.createElement("div",{className:N.default.header},C.default.createElement(g.Select,{className:N.default.select,value:o,onChange:this.handleChangeSource,options:this.sourceOptions}),C.default.createElement(g.Select,{className:N.default.select,value:this.store.sort_metric,onChange:this.handleChangeSortMetric,options:this.options})),C.default.createElement("div",{className:N.default.list,style:{height:s&&!c?"auto":"392px"}},this.renderListItems(l,o),s&&C.default.createElement(g.Button,{className:N.default.fold,icon:c?"chevron-down":"chevron-up",onClick:this.toggleFold},c?t("UNFOLD"):t("FOLD"))),C.default.createElement("div",{className:N.default.more},C.default.createElement(g.Button,{onClick:this.showMoreModal},t("VIEW_MORE"))))))}},{key:"cluster",get:function(){return this.props.currentResource.cluster}},{key:"namespace",get:function(){return this.props.currentResource.namespace}},{key:"options",get:function(){return this.store.sort_metric_options.map((function(e){return{value:e,label:t("SORT_BY_".concat(e.toUpperCase()))}}))}},{key:"sourceOptions",get:function(){return[{label:t("WORKLOAD_PL"),value:"workload",isHidden:!1},{label:t("DEPLOYMENT_PL"),value:"deployment"},{label:t("STATEFULSET_PL"),value:"statefulset",isHidden:!1},{label:t("DAEMONSET_PL"),value:"daemonset",isHidden:!1}].filter((function(e){return!e.isHidden}))}}]),r}(C.Component),l=(0,_.default)(s.prototype,"store",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.sourceMap[this.state.sourceType].store}}),c=s))||c;a.default=L},3734:function(e,t,a){e.exports={container:"WUp_s1gsgr3xjZE-TLfFy",title:"MNoZg4Uw3ghathQUO2qdn",header:"_3DIgkOu1Z8XQBOuX5B5BmC",select:"_1uhE3pKI5LOTwAz5aKaXut",list:"_1X4T38f6yd41_Mmkb7iXLq",listItem:"_3OESwUwGF8C2r8cGijHadO",textBox:"_2rZn3DZLuvGRkQFYI0Cp07",text:"_1WsQhhK0Q2NkjFsa4sUdHf",label:"_3bvLV4piiuVGDzdqk8LNKo",noLabel:"_3chFFPAM6DHtOQoayA5y84",cpu:"fcQo8oVv314LZAog_r8Jx",fold:"dFUpEkr3fe7F_Vw_73JhR",more:"_3F8y08pFovou8ARGvzXVlh"}},3735:function(e,a,r){"use strict";r(16);var n=r(162),o=r(19);r(3),r(10),r(20),r(194),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a,r,n=e.currentResource,o=n.cluster,g=n.workspace,y=n.namespace,E=(0,i.useState)(0),b=(0,l.default)(E,2),S=b[0],O=b[1],R=(0,i.useState)({data:[]}),k=(0,l.default)(R,2),C=k[0],A=k[1];(0,i.useEffect)((function(){var e=new m.default,t=new h.default;T(t),D(e)}),[]);var T=(0,i.useCallback)(function(){var e=(0,s.default)(c.default.mark((function e(t){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchList({cluster:o,workspace:g,namespace:y,limit:-1});case 2:O(t.list.total);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),D=(0,i.useCallback)(function(){var e=(0,s.default)(c.default.mark((function e(t){var a,r,n;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchList({cluster:o,workspace:g,namespace:y,limit:-1});case 2:a=(0,f.toJS)(t.list),r=a.data.filter((function(e){return void 0!==e.lastLoginTime&&""!==e.lastLoginTime})),n=(0,v.default)(r,(function(e){e.lastLoginTime})).splice(0,3),a.data=n,A((0,f.toJS)(a));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return i.default.createElement("div",{className:_.default.container},i.default.createElement("div",{className:_.default.title},t("PROJECT_MEMBERS_AND_ROLES")),i.default.createElement("div",{className:_.default.body},i.default.createElement(d.Loading,{spinning:!1},i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:_.default.summary},i.default.createElement("div",{className:_.default.item},i.default.createElement(u.default,{icon:"human",iconSize:40,title:C.total,className:_.default.avatar,desc:1===C.total?t("PROJECT_MEMBER_SCAP"):t("PROJECT_MEMBER_SCAP_PL"),noLink:!0})),i.default.createElement("div",{className:_.default.item},i.default.createElement(u.default,{icon:"role",iconSize:40,title:S,className:_.default.avatar,desc:1===S?t("PROJECT_ROLE_SCAP"):t("PROJECT_ROLE_SCAP_PL"),noLink:!0}))),i.default.createElement("div",{className:_.default.bolderText},t("RECENTLY_LOGGED_IN_MEMBERS")),i.default.createElement("div",{className:_.default.memberList},i.default.createElement("div",{className:_.default.item},null!==(a=null==C||null===(r=C.data)||void 0===r?void 0:r.map((function(e){return i.default.createElement(u.default,{key:e.name,className:_.default.memberListAvatarItem,avatar:e.avatar_url||"/extensions-static/ks-console-embed/dist/v3dist/assets/default-user.svg",title:e.name,desc:e.email,noLink:!0})})))&&void 0!==a?a:t("NO_DATA"))),i.default.createElement("div",{className:_.default.more},i.default.createElement(p.Link,{to:"/".concat(g,"/clusters/").concat(o,"/projects/").concat(y,"/members")},i.default.createElement(d.Button,null,t("VIEW_MORE"))))))))},r(3),r(10),r(20),r(194),r(14),r(4),r(21);var c=o(r(38));r(35);var s=o(r(39)),l=o(r(97)),i=n(r(0)),u=o(r(802)),d=r(189),f=r(17),p=r(437),m=o(r(323)),h=o(r(322)),v=o(r(445)),_=o(r(3736))},3736:function(e,t,a){e.exports={container:"_3PyNLKna1UJr9RGqCXq2PN",title:"_36c75SV8VUsbaSkzmcoJJe",summary:"_2jDNzW5aPH0rkDq6Evp0wY",bolderText:"_3oZ257HLpDJNyVLhz1wlOq",item:"_3LVmb3Jpwh_n7D82NQHHOz",memberListAvatarItem:"_2EQzaqbgYPQUUGY_pVhor",more:"RTaiJ5yZDpXcpzO5uW90D",avatar:"_3NvIlrVaMhliCGGQxahanO"}},3737:function(e,a,r){"use strict";var n=r(162),o=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(99),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.detail,r=e.isLoading,n=e.currentResource,o=n.cluster,v=n.workspace,_=n.namespace,g=(0,l.useState)([]),y=(0,s.default)(g,2),E=y[0],b=y[1];return(0,l.useEffect)((function(){var e=Object.entries(d.ONLY_CPU_MEMORY_QUOTAS_MAP).map((function(e){var t=(0,s.default)(e,2);return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({label:t[0]},t[1])}));b(e)}),[]),l.default.createElement("div",{className:m.default.container},l.default.createElement("div",{className:m.default.title},t("PROJECT_QUOTA_PL")),l.default.createElement(f.Loading,{spinning:r},l.default.createElement(l.default.Fragment,null,l.default.createElement("div",{className:m.default.quotaList},E.map((function(e,t){var r=e.label,n=e.name;return l.default.createElement(p.default,{key:"".concat(r,"-").concat(t),name:r,total:(0,u.default)(a,'hard["'.concat(n,'"]')),used:(0,u.default)(a,'used["'.concat(n,'"]'),0),left:(0,u.default)(a,'left["'.concat(n,'"]'))})}))),l.default.createElement("div",{className:m.default.more},l.default.createElement(i.Link,{to:"/".concat(v,"/clusters/").concat(o,"/projects/").concat(_,"/base-info")},l.default.createElement(f.Button,null,t("VIEW_MORE")))))))},r(12),r(3),r(10),r(6),r(20),r(27),r(14),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(7);var c=o(r(31)),s=o(r(97)),l=n(r(0)),i=r(437),u=o(r(26)),d=r(61),f=r(189),p=o(r(3738)),m=o(r(3740));function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}},3738:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(6),r(88),r(14),r(24),r(193),r(9),r(30),r(69),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(97));r(3),r(6),r(88),r(14),r(24),r(193),r(9),r(4),r(440),r(30),r(69),r(71),r(7);var c=n(r(0)),s=n(r(26)),l=n(r(163)),i=r(189),u=n(r(999)),d=r(56),f=r(61),p=n(r(3739)),m=["limits.cpu","limits.memory","pods"],h={Ti:Math.pow(1024,4),Gi:Math.pow(1024,3),Mi:Math.pow(1024,2),Ki:1024,TB:Math.pow(1e3,4),GB:Math.pow(1e3,3),MB:Math.pow(1e3,2),KB:1e3,T:Math.pow(1e3,4),G:Math.pow(1e3,3),M:Math.pow(1e3,2),K:1e3,Bytes:1,B:1},v=function(e){var a=e.name,r=e.total,n=e.used;if(!r&&!Number(n)&&-1===m.indexOf(a))return null;var v=0,_="",g="",y=function(e){return function(e,t){return e?[e,parseFloat(t)*(f.ICON_TYPES[a]||!h[e]?1:h[e])]:["",parseFloat(t)]}(function(e){var t=Object.keys(h),a=(0,s.default)(e.match(/[0-9]+([a-zA-Z]+)/),"1","");return t.forEach((function(e){if(a.indexOf(e)>-1)return a=e,!1})),a}(e),e)};if("limits.cpu"===a||"requests.cpu"===a)r&&(v=Number((0,d.cpuFormat)(n))/Number((0,d.cpuFormat)(r)),n="".concat((0,d.cpuFormat)(n)," Core"),r="".concat((0,d.cpuFormat)(r)," Core"));else if("limits.memory"===a||"requests.memory"===a)r&&(v=Number((0,d.memoryFormat)(n))/Number((0,d.memoryFormat)(r)),n="".concat((0,d.memoryFormat)(n,"Gi")," Gi"),r="".concat((0,d.memoryFormat)(r,"Gi")," Gi"));else if(r){var E=y(n),b=(0,o.default)(E,2),S=b[0],O=b[1],R=y(r),k=(0,o.default)(R,2),C=k[0],A=k[1];_=S,g=C,v=O/A}v=Math.min(Math.max(v,0),1);var T=a.indexOf("gpu")>-1?"gpu":a,D="gpu"===T?"".concat(T,".limit"):T;return c.default.createElement("div",{className:p.default.quota},c.default.createElement("div",{className:p.default.quotaItem},c.default.createElement(i.Icon,{name:f.ICON_TYPES[T]||"resource",size:40}),c.default.createElement("div",{className:p.default.item},c.default.createElement("div",null,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.ICON_TYPES[T]?t(e.replace(/[. ]/g,"_").toUpperCase()):e}(D)),c.default.createElement("p",null,t("RESOURCE_TYPE_SCAP"))),c.default.createElement("div",{className:p.default.item},c.default.createElement("div",null,function(e){if(g&&!_){var t=f.ICON_TYPES[a]||!h[g]?1:h[g];return"".concat(e/t).concat(e>0?g:"")}return e}(n)),c.default.createElement("p",null,t("USED"))),c.default.createElement("div",{className:p.default.item},c.default.createElement("div",null,(0,l.default)(r)?t("NO_LIMIT_TCAP"):r),c.default.createElement("p",null,t("QUOTA")))),c.default.createElement(u.default,{value:Math.min(v,1),className:p.default.bar,rightText:r?"":t("NO_LIMIT"),text:t("USED_PERCENT",{percent:Number((100*v).toFixed(2))})}))};a.default=v},3739:function(e,t,a){e.exports={quota:"wPXTphh_v2X9WNrzqgEp2",quotaItem:"_1LGCyv1ogf6UGeQWOrXqPh",item:"_39N8hvK9R02dew_Ly7Lk0F",bar:"_1a14YNWybcwkUtp0TtLUbx"}},3740:function(e,t,a){e.exports={container:"_3QcJZz9OQTZg1pRtfi0S_9",title:"_2DVNlEQK6CzxXnKQFB0ete",quotaList:"_1NUnZVruuUa7Evki-XrV1m",more:"_2TZLtWlWRQzWFUpCzBhAE_"}},3741:function(e,a,r){"use strict";r(16);var n=r(162),o=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=o(r(97)),s=n(r(0)),l=o(r(798)),i=o(r(3742)),u=o(r(3744));function d(e){var a=e.visible,r=void 0===a||a,n=e.onCancel,o=e.currentResource,d=(0,s.useState)(!1),f=(0,c.default)(d,2),p=f[0],m=f[1];(0,s.useEffect)((function(){m(r)}),[r]);var h=(0,s.useCallback)((function(){m(!1),null==n||n()}),[]);return s.default.createElement(l.default,{bodyClassName:u.default.body,title:t("RESOURCE_USAGE_RANKING"),visible:p,onCancel:h,fullScreen:!0,hideFooter:!0},s.default.createElement(i.default,{currentResource:o}))}var f=(0,s.memo)(d);a.default=f},3742:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(18),r(30),r(11),r(73),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(73),r(71),r(7);var o,c,s,l,i,u,d=n(r(58)),f=n(r(31)),p=n(r(62)),m=n(r(25)),h=n(r(28)),v=n(r(74)),_=n(r(41)),g=n(r(42)),y=n(r(37)),E=n(r(45)),b=(n(r(63)),n(r(0))),S=r(17),O=r(243),R=n(r(5)),k=n(r(1596)),C=n(r(802)),A=n(r(854)),T=r(189),D=n(r(1141)),P=n(r(1142)),N=r(61),I=r(803),w=r(56),x=n(r(1205)),M=n(r(3743));function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){(0,f.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,y.default)(e);if(t){var n=(0,y.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,g.default)(this,a)}}var B={limit:10,page:1,sort_type:"desc"},F=(0,O.inject)("rootStore")(o=(0,O.observer)((c=function(e){(0,_.default)(r,e);var a=U(r);function r(){var e;(0,m.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return e=a.call.apply(a,[this].concat(o)),(0,p.default)(e,"hideColumns",s,(0,v.default)(e)),(0,p.default)(e,"type",l,(0,v.default)(e)),e.sourceMap={workload:{store:new k.default(j(j({},B),{},{cluster:e.cluster,namespaces:e.namespace})),icon:"backup",name:"workload"},deployment:{store:new k.default(j(j({},B),{},{cluster:e.cluster,namespaces:e.namespace,kind:"deployment"})),icon:"backup",name:"deployment",url:function(t){return e.getLink(t,"Deployment")}},statefulset:{store:new k.default(j(j({},B),{},{cluster:e.cluster,namespaces:e.namespace,kind:"statefulset"})),icon:"stateful-set",name:"statefulset",url:function(t){return e.getLink(t,"StatefulSet")}},daemonset:{store:new k.default(j(j({},B),{},{cluster:e.cluster,namespaces:e.namespace,kind:"daemonset"})),icon:"deamon-set",name:"daemonset",url:function(t){return e.getLink(t,"DaemonSet")}}},e.transData=function(e,a){var r,n="",o="",c=null!==(r=null==e?void 0:e[a])&&void 0!==r?r:0,s=N.MONITOR_RANK_UNIT_MAP[a];return"%"===s?n="".concat((0,I.getValueByUnit)(c,s),"%"):""===s?n=Math.round(100*c)/100:(o=(0,I.getSuitableUnit)(c,s),n=(0,I.getValueByUnit)(c,o)),"".concat(n," ").concat("core"===o?t("CORE_PL"):o)},e.getLink=function(t,a){var r=e.props.currentResource,n=r.workspace,o=r.cluster,c=r.namespace,s="".concat(n?"/".concat(n):"","/clusters/").concat(o,"/projects/").concat(c);return{Deployment:"".concat(s,"/deployments/").concat(t),StatefulSet:"".concat(s,"/statefulsets/").concat(t),DaemonSet:"".concat(s,"/daemonsets/").concat(t)}[a]},e.fetchRankData=function(t){e.store.fetchAll(j({},t))},(0,p.default)(e,"onChange",i,(0,v.default)(e)),(0,p.default)(e,"handleColumnsHide",u,(0,v.default)(e)),e}return(0,h.default)(r,[{key:"componentDidMount",value:function(){this.fetchRankData()}},{key:"getWorkloadLink",value:function(e){var t,a=e.workload_type;if("Pod"!==a){var r=null!==(t=null==e?void 0:e.workload.replace(/\w+:/,""))&&void 0!==t?t:"-";return this.getLink(r,a)}}},{key:"renderToolbar",value:function(){return b.default.createElement("div",{className:(0,R.default)(M.default.toolbar,M.default.pane__toolbar,M.default.pane)},b.default.createElement(T.RadioGroup,{wrapClassName:"radio-group-button",value:this.type,onChange:this.onChange},b.default.createElement(T.RadioButton,{value:"workload"},t("WORKLOAD")),b.default.createElement(T.RadioButton,{value:"deployment"},t("DEPLOYMENT")),b.default.createElement(T.RadioButton,{value:"statefulset"},t("STATEFULSET")),b.default.createElement(T.RadioButton,{value:"daemonset"},t("DAEMONSET"))),b.default.createElement("div",{className:M.default.toolbar_filter},b.default.createElement(D.default,{className:M.default.columnMenu,title:t("CUSTOM_COLUMNS"),columns:this.columns,value:(0,S.toJS)(this.hideColumns),onChange:this.handleColumnsHide}),b.default.createElement(T.Select,{value:this.store.sort_metric,onChange:this.store.changeSortMetric,options:this.options}),b.default.createElement(T.Select,{className:M.default.sortTypeSelect,value:this.store.sort_type,onChange:this.store.changeSortType,options:[{value:"desc",label:t("SORT_BY_DESC")},{value:"asc",label:t("SORT_BY_ASC")}]})))}},{key:"renderList",value:function(){var e=this.store.data.toJS();return b.default.createElement("div",{className:M.default.listContainer},b.default.createElement(x.default,{columns:this.filteredColumns,dataSource:e,emptyText:b.default.createElement(A.default,null),loading:this.store.isLoading,store:this.store}),this.renderPagination())}},{key:"renderPagination",value:function(){var e=this.store,t=e.page,a=e.total,r=e.limit;return b.default.createElement("div",{className:(0,R.default)(M.default.pane,M.default.pane__pagination)},b.default.createElement(P.default,{page:t,total:a,limit:r,onChange:this.store.changePagination}))}},{key:"render",value:function(){return b.default.createElement("div",{className:M.default.wrapper},this.renderToolbar(),this.renderList())}},{key:"store",get:function(){return this.sourceMap[this.type].store}},{key:"cluster",get:function(){return this.props.currentResource.cluster}},{key:"namespace",get:function(){return this.props.currentResource.namespace}},{key:"options",get:function(){var e=this,a=this.sourceMap[this.type].name;return this.store.sort_metric_options.filter((function(t){return!(0,S.toJS)(e.hideColumns).includes("".concat(t,"-").concat(a))})).map((function(e){return{value:e,label:t("SORT_BY_".concat(e.toUpperCase()))}}))}},{key:"columns",get:function(){var e,a=this,r=this.sourceMap[this.type],n=r.store,o=r.url,c=r.name,s=r.icon,l=null===(e=n.sort_metric_options)||void 0===e?void 0:e.map((function(e){return{key:"".concat(e,"-").concat(c),sort_metric:e,title:t(N.MONITOR_RANK_METERIC_LOCALS[e]),isHideable:!0,render:function(t){return b.default.createElement("div",null,b.default.createElement("h3",null,a.transData(t,e)))}}})),i=[{title:t("namespace"===c?"PROJECT":c.toUpperCase()),width:"15%",key:c,render:function(e){var r,n=null==o?void 0:o(),l=null==e?void 0:e[c],i=s;return e.workload_type&&(n=a.getWorkloadLink(e),l=e.workload.replace(/\w+:/,""),i=N.PROJECT_RANK_RESOURCE_ICON_MAP[e.workload_type]),b.default.createElement(C.default,{className:M.default.avatar,icon:i,title:l,desc:t(null==e||null===(r=e.workload_type)||void 0===r?void 0:r.toUpperCase()),iconSize:40,to:n})}}];return(0,w.hideGPUByLicense)([].concat(i,(0,d.default)(l)),this.cluster)}},{key:"filteredColumns",get:function(){var e=this;return this.columns.filter((function(t){return!e.hideColumns.includes(t.key||t.dataIndex)}))}}]),r}(b.default.Component),s=(0,E.default)(c.prototype,"hideColumns",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=(0,E.default)(c.prototype,"type",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"workload"}}),i=(0,E.default)(c.prototype,"onChange",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.store.sort_metric=e.store.sort_metric_options[0],e.hideColumns=[],new Promise((function(a){e.type=t,a()})).then((function(){e.fetchRankData()}))}}}),u=(0,E.default)(c.prototype,"handleColumnsHide",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.hideColumns=t;var a=e.sourceMap[e.type].name;if(t.includes("".concat(e.store.sort_metric,"-").concat(a))){var r,n=e.store.sort_metric_options.filter((function(e){return!t.includes("".concat(e,"-").concat(a))}));e.store.changeSortMetric(null!==(r=n[0])&&void 0!==r?r:"")}}}}),o=c))||o)||o;a.default=F},3743:function(e,t,a){e.exports={wrapper:"_39um7aZUG1pnR-CKIcu1TN",pane:"_2iDnSjq4uXAZJyGIrOmhoL",pane__toolbar:"_3QFk5Yaj49gXPFxd7kynrv",title:"_3LWzfDEgM4lCz09h7NPAsH",toolbar:"xWikrJmPVeNPguM3lAc3A",toolbar_buttons:"_2YCWXwPUPJ8xdyxkK1Jcdc",toolbar_filter:"aChO9CzgvR6ufSgZRgumH",sortTypeSelect:"_1i3fvIhSh6hddUE-Y-V616",sort_button:"_3Lzj6vN-NcuiW0iw0XUQ4z",table:"_1hYG_xXdPmjYe0wvfjKsdZ",table_rank:"_2vY8rDr9oLjdfQQLnSfv8M",table_no_border:"mWcvW9frLws6x7CQhOK-t",rankList_row:"_1wfX3qYkv1mSNgL0Ull9Dm",rankCol:"_22R2n2cWUIc23KL1SWzfz4",listContainer:"_3OWzoUJkfgC7VdrEOKGDNE",pane__pagination:"_1dyu7s2DExSUjbsEGTQCRR",avatar:"_2vxFx2PXwkoT-UTdRZVLV1"}},3744:function(e,t,a){e.exports={body:"_28-dXCzEhnCMuP6T-4CzDY"}},3745:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(69),r(7);var o,c=n(r(317)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=n(r(26)),h=n(r(807)),v=n(r(976)),_=r(806),g=n(r(810)),y=r(56),E=n(r(1012)),b=n(r(1078));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var k=(0,_.withProjectList)({store:new E.default,module:"applications",name:"APP"})(o=function(e){(0,u.default)(r,e);var a=R(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).type="composing",e.getColumns=function(){var a=e.props.getSortOrder;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:a("name"),search:!0,render:function(t,a){return p.default.createElement(v.default,{title:(0,y.getDisplayName)(a),avatar:a.icon||"/extensions-static/ks-console-embed/dist/v3dist/assets/default-app.svg",to:"".concat(e.props.match.url,"/").concat(t),desc:(0,m.default)(a,'annotations["kubesphere.io/description"]',"-")})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"20%",render:function(e){return p.default.createElement(h.default,{name:t(e.toUpperCase()),type:e,flicker:!0})}},{title:t("VERSION"),dataIndex:"version",isHideable:!0,width:"20%"},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:a("createTime"),isHideable:!0,width:180,render:function(e){return(0,y.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore,o=t.getData;return e.props.trigger("crd.app.create",O(O({module:r},a.params),{},{projectDetail:n.detail,success:o}))},e}return(0,i.default)(r,[{key:"getTableProps",value:function(){var e=this.props.tableProps,a=this.canCreate?[{key:"create",type:"control",text:t("CREATE"),onClick:this.showCreate}]:[];return{tableActions:O(O({},e.tableActions),{},{actions:a,onCreate:null}),emptyProps:{title:t("NO_COMPOSED_APP_FOUND"),desc:t("COMPOSED_APP_EMPTY_DESC")},searchType:"name"}}},{key:"render",value:function(){var e=this.props,a=e.tableProps,r=e.bannerProps,n=e.match;return p.default.createElement(_.ListPage,this.props,p.default.createElement(b.default,(0,c.default)({},r,{title:t("COMPOSED_APP_PL"),match:n,type:this.type})),p.default.createElement(g.default,(0,c.default)({},a,this.getTableProps(),{columns:this.getColumns()})))}},{key:"canCreate",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace,n=globals.app.getActions({workspace:t,cluster:a,project:r,module:"deployments"}).includes("create"),o=globals.app.getActions({workspace:t,cluster:a,project:r,module:"services"}).includes("create");return n&&o}}]),r}(p.default.Component))||o;a.default=k},3746:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(70),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(197),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(70),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(197),r(7);var o,c=n(r(317)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=r(248),h=n(r(808)),v=n(r(26)),_=r(437),g=r(189),y=n(r(807)),E=n(r(976)),b=r(806),S=n(r(810)),O=r(56),R=n(r(1072)),k=n(r(1078));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var D=(0,b.withProjectList)({store:new R.default,module:"applications",name:"APP"})(o=function(e){(0,u.default)(r,e);var a=T(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).type="template",e.getColumns=function(){var a=e.props.getSortOrder;return[{title:t("NAME"),dataIndex:"name",render:function(t,a){return p.default.createElement(E.default,{isApp:!0,to:"".concat(e.prefix,"/").concat(a.cluster_id),avatar:(0,v.default)(a,"app.icon"),iconLetter:t,iconSize:40,title:t,desc:a.description})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"16%",render:e.renderStatus},{title:t("APP_TEMPLATE"),dataIndex:"app.name",isHideable:!0,width:"16%",render:function(e,t){return p.default.createElement(_.Link,{to:"/apps/".concat((0,v.default)(t,"version.app_id"))},e)}},{title:t("VERSION"),dataIndex:"version.name",isHideable:!0,width:"16%"},{title:t("UPDATE_TIME_TCAP"),dataIndex:"status_time",sorter:!0,sortOrder:a("status_time"),isHideable:!0,width:180,render:function(e,t){return(0,O.getLocalTime)(t.update_time||t.status_time).format("YYYY-MM-DD HH:mm:ss")}}]},e.renderStatus=function(e,a){return a.additional_info?p.default.createElement(g.Tooltip,{content:a.additional_info},p.default.createElement(y.default,{name:t(e.toUpperCase()),type:e,flicker:!0})):p.default.createElement(y.default,{name:t(e),type:e,flicker:!0})},e.showDeploy=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore,o=t.trigger;return e.props.trigger("app.deploy",{module:r,namespace:a.params.namespace,cluster:a.params.cluster,workspace:(0,v.default)(n,"detail.workspace"),routing:e.props.rootStore.routing,trigger:o})},e.handleFetch=(0,h.default)((function(t){var a=e.props,r=a.store,n=a.getData;if(!r.list.isLoading)return n(A(A(A({},(0,m.parse)(location.search.slice(1))),t),{},{silent:!0}))}),1e3),e.handleWatch=function(t){"HelmRelease"===t.object.kind&&["MODIFIED","DELETED","ADDED"].includes(t.type)&&e.handleFetch()},e}return(0,i.default)(r,[{key:"getTableProps",value:function(){var e=this.props.tableProps,a=this.canCreate?[{key:"deploy",type:"control",text:t("CREATE"),onClick:this.showDeploy}]:[];return{tableActions:A(A({},e.tableActions),{},{actions:a,onCreate:null}),emptyProps:{title:t("NO_TEMPLATE_BASED_APP_FOUND"),desc:t("TEMPLATE_BASED_APP_EMPTY_DESC")},searchType:"keyword"}}},{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps,r=e.match;return p.default.createElement(b.ListPage,(0,c.default)({},this.props,{onMessage:this.handleWatch}),p.default.createElement(k.default,(0,c.default)({},t,{match:r,type:this.type})),p.default.createElement(S.default,(0,c.default)({},a,this.getTableProps(),{itemActions:this.itemActions,columns:this.getColumns()})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r,"/applications/").concat(this.type)}},{key:"canCreate",get:function(){var e=this.props.match.params,t=e.cluster,a=e.namespace;return globals.app.hasKSModule("openpitrix")&&globals.app.hasPermission({cluster:t,project:a,module:"applications",action:"create"})}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.name;return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:function(e){return a("openpitrix.app.edit",{detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{type:r,detail:e})}}]}}]),r}(p.default.Component))||o;a.default=D},3747:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(70),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(197),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(70),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(197),r(7);var o,c=n(r(317)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=n(r(26)),h=n(r(808)),v=r(437),_=r(189),g=n(r(807)),y=n(r(976)),E=r(806),b=n(r(810)),S=r(248),O=r(56),R=n(r(1597)),k=n(r(1078));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var D=(0,E.withProjectList)({store:new R.default,module:"applications",name:"APP"})(o=function(e){(0,u.default)(r,e);var a=T(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).type="others",e.getColumns=function(){var a=e.props.getSortOrder;return[{title:t("NAME"),dataIndex:"name",render:function(t,a){return p.default.createElement(y.default,{isApp:!0,to:"".concat(e.prefix,"/").concat(a.name),avatar:(0,m.default)(a,"app.icon"),iconLetter:t,iconSize:40,title:t,desc:a.description})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"16%",render:e.renderStatus},{title:t("APP"),dataIndex:"app.name",isHideable:!0,width:"16%",render:function(e,t){return p.default.createElement(v.Link,{to:"/apps/".concat((0,m.default)(t,"version.app_id"))},e)}},{title:t("VERSION"),dataIndex:"version.name",isHideable:!0,width:"16%"},{title:t("UPDATE_TIME_TCAP"),dataIndex:"status_time",sorter:!0,sortOrder:a("status_time"),isHideable:!0,width:180,render:function(e,t){return(0,O.getLocalTime)(t.update_time||t.status_time).format("YYYY-MM-DD HH:mm:ss")}}]},e.renderStatus=function(e,a){return a.additional_info?p.default.createElement(_.Tooltip,{content:a.additional_info},p.default.createElement(g.default,{name:t(e),type:e,flicker:!0})):p.default.createElement(g.default,{name:t(e),type:e,flicker:!0})},e.handleFetch=(0,h.default)((function(t){var a=e.props,r=a.store,n=a.getData;if(!r.list.isLoading)return n(A(A(A({},(0,S.parse)(location.search.slice(1))),t),{},{silent:!0}))}),1e3),e.handleWatch=function(t){"HelmRelease"===t.object.kind&&["MODIFIED","DELETED","ADDED"].includes(t.type)&&e.handleFetch()},e}return(0,i.default)(r,[{key:"getTableProps",value:function(){return{tableActions:A(A({},this.props.tableProps.tableActions),{},{actions:[],onCreate:null}),emptyProps:{desc:t("OTHER_APP_EMPTY_DESC")},searchType:"keyword"}}},{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps,r=e.match;return p.default.createElement(E.ListPage,(0,c.default)({},this.props,{onMessage:this.handleWatch}),p.default.createElement(k.default,(0,c.default)({},t,{match:r,type:this.type})),p.default.createElement(b.default,(0,c.default)({},a,this.getTableProps(),{itemActions:this.itemActions,columns:this.getColumns()})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r,"/applications/").concat(this.type)}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.name;return[{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{type:r,detail:e})}}]}}]),r}(p.default.Component))||o;a.default=D},3748:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(88),r(20),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(88),r(20),r(27),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(31)),s=n(r(58)),l=n(r(317)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(26)),v=r(243),_=n(r(802)),g=n(r(813)),y=r(806),E=n(r(810)),b=n(r(833)),S=n(r(901)),O=n(r(319)),R=r(56),k=r(61),C=r(17),A=r(439);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var N=(0,y.withProjectList)({store:new O.default("deployments"),module:"deployments",name:"DEPLOYMENT",rowKey:"uid"})(o=(0,v.inject)("workspaceStore")(o=(0,v.observer)(o=function(e){(0,d.default)(r,e);var a=P(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).handleTabChange=function(t){e.props.routing.push("".concat(e.prefix,"/").concat(t))},e.disableStopButton=function(){var t=e.props.tableProps,a=t.data,r=t.selectedRowKeys;return(0,C.toJS)(a).filter((function(e){return-1!==r.indexOf(e.uid)})).some((function(e){return"Stopped"===(0,A.getDeployStatus)(e)}))},e.disableStopButton=function(){var t=e.props.tableProps,a=t.data,r=t.selectedRowKeys;return(0,C.toJS)(a).filter((function(e){return-1!==r.indexOf(e.uid)})).some((function(e){return"Stopped"===(0,A.getDeployStatus)(e)}))},e.getItemDesc=function(a){var r=(0,A.getWorkloadStatus)(a,e.props.module),n=r.status,o=r.reason;return o?m.default.createElement(b.default,{status:n,reason:t(o),data:a}):a.description||"-"},e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.getFilteredValue,o=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),search:!0,render:function(t,a){return m.default.createElement(_.default,{icon:k.ICON_TYPES[o],iconSize:40,title:(0,R.getDisplayName)(a),desc:e.getItemDesc(a),to:"".concat(e.prefix,"/").concat(o,"/").concat(t),isMultiCluster:a.isFedManaged})}},{title:t("STATUS"),dataIndex:"status",filters:e.getStatus(),filteredValue:n("status"),isHideable:!0,search:!0,width:"22%",render:function(e,t){return m.default.createElement(S.default,{data:t,module:o})}},{title:t("APP"),dataIndex:"app",isHideable:!0,search:!0,width:"22%",render:function(e,t){var a,r,n=null===(a=t.annotations)||void 0===a?void 0:a["application.kubesphere.io/app-alias-name"],o=null===(r=t.labels)||void 0===r?void 0:r["application.kubesphere.io/app-id"];return n?"".concat(n,"").concat(o,""):o||"-"}},{title:t("UPDATE_TIME_TCAP"),dataIndex:"updateTime",sorter:!0,sortOrder:r("updateTime"),isHideable:!0,width:150,render:function(e){return(0,R.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("workload.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster,supportGpuSelect:!0,workspace:a.params.workspace,supportNodeGroupSelect:!0,isProject:!0,rootStore:e.props.rootStore})},e}return(0,u.default)(r,[{key:"getStatus",value:function(){return k.WORKLOAD_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps;return m.default.createElement(y.ListPage,this.props,m.default.createElement(g.default,(0,l.default)({},a,{title:t("WORKLOAD_PL"),description:t("WORKLOAD_DESC"),tabs:this.tabs})),m.default.createElement(E.default,(0,l.default)({},r,{itemActions:this.itemActions,tableActions:this.tableActions,selectActions:this.selectActions,columns:this.getColumns(),onCreate:this.showCreate})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.namespace,r=e.cluster;return"/".concat(t,"/clusters/").concat(r,"/projects/").concat(a)}},{key:"k8sVersion",get:function(){var e,t,a=this.props.match.params.cluster;return null===(e=globals.clusterConfig)||void 0===e||null===(t=e[a])||void 0===t?void 0:t.k8sVersion}},{key:"tabs",get:function(){return{value:this.props.module,onChange:this.handleTabChange,options:[{value:"deployments",label:t("DEPLOYMENTS")},{value:"statefulsets",label:t("STATEFULSETS")},{value:"daemonsets",label:t("DAEMONSETS")}].filter(Boolean)}}},{key:"selectActions",get:function(){var e=this,a=this.props,r=a.tableProps,n=a.trigger,o=a.name,c=a.rootStore,l=this.disableStopButton();return(0,s.default)((0,h.default)(r,"tableActions.selectActions",{})).filter((function(e){return"delete"!==e.key})).concat([{key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){n("workload.batch.delete",{type:o,rowKey:"uid",k8sVersion:e.k8sVersion})}},{key:"stop",text:t("STOP"),disabled:l,action:"edit",onClick:function(){return n("resource.batch.stop",{type:o,rowKey:"uid",success:c.routing.query()})}}])}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.module,n=a.trigger,o=a.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return n("resource.baseinfo.edit",{detail:e})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return n("resource.yaml.edit",{detail:e})}},{key:"redeploy",icon:"restart",text:t("RECREATE"),action:"edit",onClick:function(e){return n("workload.redeploy",{module:r,detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(t){n("workload.delete",{type:o,detail:t,k8sVersion:e.k8sVersion})}}]}},{key:"tableActions",get:function(){var e=this,a=this.props,r=a.trigger,n=a.name,o=a.rowKey;return D(D({},a.tableProps.tableActions),{},{selectActions:[{key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){return r("workload.batch.delete",{type:n,rowKey:o,k8sVersion:e.k8sVersion})}}]})}}]),r}(m.default.Component))||o)||o)||o,I=(0,v.inject)()((function(e){var t,a,r=e.match.params.cluster,n=null===(t=globals.clusterConfig)||void 0===t||null===(a=t[r])||void 0===a?void 0:a.k8sVersion;return m.default.createElement(N,(0,l.default)({k8sVersion:n},e))}));a.default=I},3749:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(88),r(20),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(88),r(20),r(27),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(31)),s=n(r(58)),l=n(r(317)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(26)),v=r(243),_=n(r(802)),g=n(r(813)),y=r(806),E=n(r(810)),b=n(r(833)),S=n(r(901)),O=r(17),R=r(56),k=r(61),C=r(439),A=n(r(319));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var N=(0,y.withProjectList)({store:new A.default("statefulsets"),module:"statefulsets",name:"STATEFULSET",rowKey:"uid"})(o=(0,v.inject)("workspaceStore")(o=(0,v.observer)(o=function(e){(0,d.default)(r,e);var a=P(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).handleTabChange=function(t){e.props.routing.push("".concat(e.prefix,"/").concat(t))},e.disableStopButton=function(){var t=e.props.tableProps,a=t.data,r=t.selectedRowKeys;return(0,O.toJS)(a).filter((function(e){return-1!==r.indexOf(e.uid)})).some((function(e){return"Stopped"===(0,C.getStatefulSetStatus)(e)}))},e.getItemDesc=function(a){var r=(0,C.getWorkloadStatus)(a,e.props.module),n=r.status,o=r.reason;return o?m.default.createElement(b.default,{status:n,reason:t(o),data:a}):a.description||"-"},e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.getFilteredValue,o=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),search:!0,render:function(t,a){return m.default.createElement(_.default,{icon:k.ICON_TYPES[o],iconSize:40,title:(0,R.getDisplayName)(a),desc:e.getItemDesc(a),to:"".concat(e.prefix,"/").concat(o,"/").concat(t),isMultiCluster:a.isFedManaged})}},{title:t("STATUS"),dataIndex:"status",filters:e.getStatus(),filteredValue:n("status"),isHideable:!0,search:!0,width:"22%",render:function(e,t){return m.default.createElement(S.default,{data:t,module:o})}},{title:t("APP"),dataIndex:"app",isHideable:!0,search:!0,width:"22%"},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:150,render:function(e){return(0,R.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("workload.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster,rootStore:e.props.rootStore,workspace:a.params.workspace,supportNodeGroupSelect:!0})},e}return(0,u.default)(r,[{key:"getStatus",value:function(){return k.WORKLOAD_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps,n={onCreate:this.showCreate};return m.default.createElement(y.ListPage,this.props,m.default.createElement(g.default,(0,l.default)({},a,{title:t("WORKLOAD_PL"),description:t("WORKLOAD_DESC"),tabs:this.tabs})),m.default.createElement(E.default,(0,l.default)({},r,{itemActions:this.itemActions,tableActions:this.tableActions,selectActions:this.selectActions,columns:this.getColumns()},n)))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.namespace,r=e.cluster;return"/".concat(t,"/clusters/").concat(r,"/projects/").concat(a)}},{key:"tabs",get:function(){return{value:this.props.module,onChange:this.handleTabChange,options:[{value:"deployments",label:t("DEPLOYMENTS")},{value:"statefulsets",label:t("STATEFULSETS")},{value:"daemonsets",label:t("DAEMONSETS")}]}}},{key:"k8sVersion",get:function(){var e,t,a=this.props.match.params.cluster;return null===(e=globals.clusterConfig)||void 0===e||null===(t=e[a])||void 0===t?void 0:t.k8sVersion}},{key:"selectActions",get:function(){var e=this,a=this.props,r=a.tableProps,n=a.trigger,o=a.name,c=a.rootStore,l=this.disableStopButton();return(0,s.default)((0,h.default)(r,"tableActions.selectActions",{})).filter((function(e){return"delete"!==e.key})).concat([{key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){n("workload.batch.delete",{type:o,rowKey:"uid",k8sVersion:e.k8sVersion})}},{key:"stop",text:t("STOP"),disabled:l,action:"edit",onClick:function(){return n("resource.batch.stop",{type:o,rowKey:"uid",success:c.routing.query()})}}])}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.module,n=a.trigger,o=a.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return n("resource.baseinfo.edit",{detail:e})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return n("resource.yaml.edit",{detail:e})}},{key:"redeploy",icon:"restart",text:t("RECREATE"),action:"edit",onClick:function(e){return n("workload.redeploy",{module:r,detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(t){return n("workload.delete",{type:o,detail:t,k8sVersion:e.k8sVersion})}}]}},{key:"tableActions",get:function(){var e=this,a=this.props,r=a.trigger,n=a.name,o=a.rowKey;return D(D({},a.tableProps.tableActions),{},{selectActions:[{key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){return r("workload.batch.delete",{type:n,rowKey:o,k8sVersion:e.k8sVersion})}}]})}}]),r}(m.default.Component))||o)||o)||o,I=(0,v.inject)()((function(e){var t,a,r=e.match.params.cluster,n=null===(t=globals.clusterConfig)||void 0===t||null===(a=t[r])||void 0===a?void 0:a.k8sVersion;return m.default.createElement(N,(0,l.default)({k8sVersion:n},e))}));a.default=I},3750:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(88),r(20),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(88),r(20),r(27),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(31)),s=n(r(58)),l=n(r(317)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(26)),v=r(243),_=n(r(802)),g=n(r(813)),y=r(806),E=n(r(901)),b=n(r(833)),S=n(r(810)),O=r(56),R=r(17),k=r(439),C=r(61),A=n(r(319));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var N=(0,y.withProjectList)({store:new A.default("daemonsets"),module:"daemonsets",name:"DAEMONSET",rowKey:"uid"})(o=(0,v.inject)("workspaceStore")(o=(0,v.observer)(o=function(e){(0,d.default)(r,e);var a=P(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).handleTabChange=function(t){e.props.routing.push("".concat(e.prefix,"/").concat(t))},e.disableStopButton=function(){var t=e.props.tableProps,a=t.data,r=t.selectedRowKeys;return(0,R.toJS)(a).filter((function(e){return-1!==r.indexOf(e.uid)})).some((function(e){return"Stopped"===(0,k.getDaemonSetStatus)(e)}))},e.getItemDesc=function(a){var r=(0,k.getWorkloadStatus)(a,e.props.module),n=r.status,o=r.reason;return o?m.default.createElement(b.default,{status:n,reason:t(o),data:a}):a.description||"-"},e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.getFilteredValue,o=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),search:!0,render:function(t,a){return m.default.createElement(_.default,{icon:C.ICON_TYPES[o],iconSize:40,title:(0,O.getDisplayName)(a),desc:e.getItemDesc(a),to:"".concat(e.prefix,"/").concat(o,"/").concat(t)})}},{title:t("STATUS"),dataIndex:"status",filters:e.getStatus(),filteredValue:n("status"),isHideable:!0,search:!0,width:"22%",render:function(e,t){return m.default.createElement(E.default,{data:t,module:o})}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:150,render:function(e){return(0,O.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("workload.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster,rootStore:e.props.rootStore,workspace:a.params.workspace,supportNodeGroupSelect:!0})},e}return(0,u.default)(r,[{key:"getStatus",value:function(){return C.WORKLOAD_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps,n={onCreate:this.showCreate};return m.default.createElement(y.ListPage,this.props,m.default.createElement(g.default,(0,l.default)({},a,{title:t("WORKLOAD_PL"),description:t("WORKLOAD_DESC"),tabs:this.tabs})),m.default.createElement(S.default,(0,l.default)({},r,{itemActions:this.itemActions,tableActions:this.tableActions,selectActions:this.selectActions,columns:this.getColumns()},n)))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.namespace,r=e.cluster;return"/".concat(t,"/clusters/").concat(r,"/projects/").concat(a)}},{key:"tabs",get:function(){return{value:this.props.module,onChange:this.handleTabChange,options:[{value:"deployments",label:t("DEPLOYMENTS")},{value:"statefulsets",label:t("STATEFULSETS")},{value:"daemonsets",label:t("DAEMONSETS")}]}}},{key:"selectActions",get:function(){var e=this.props,a=e.tableProps,r=e.trigger,n=e.name,o=e.rootStore,c=this.disableStopButton();return[].concat((0,s.default)((0,h.default)(a,"tableActions.selectActions",{})),[{key:"stop",text:t("STOP"),disabled:c,action:"edit",onClick:function(){return r("resource.batch.stop",{type:n,rowKey:"uid",success:o.routing.query()})}}])}},{key:"itemActions",get:function(){var e=this.props,a=e.module,r=e.trigger,n=e.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return r("resource.baseinfo.edit",{detail:e})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return r("resource.yaml.edit",{detail:e})}},{key:"redeploy",icon:"restart",text:t("RECREATE"),action:"edit",onClick:function(e){return r("workload.redeploy",{module:a,detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return r("resource.delete",{type:n,detail:e})}}]}},{key:"tableActions",get:function(){var e=this.props,a=e.trigger,r=e.name,n=e.rowKey;return D(D({},e.tableProps.tableActions),{},{selectActions:[{key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){return a("workload.batch.delete",{type:r,rowKey:n})}}]})}}]),r}(m.default.Component))||o)||o)||o;a.default=N},3751:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=r(437),m=r(189),h=n(r(863)),v=n(r(813)),_=n(r(810)),g=r(806),y=n(r(833)),E=r(56),b=r(61),S=n(r(452)),O=r(243),R=n(r(3752));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var C=(0,g.withProjectList)({store:new S.default,module:"pods",name:"POD"})(o=(0,O.inject)("workspaceStore")(o=function(e){(0,i.default)(r,e);var a=k(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).getItemDesc=function(e){var a=e.podStatus,r=a.status,n=a.type;return"running"!==n&&"completed"!==n?f.default.createElement(y.default,{status:n,reason:t(r),data:e,type:"pod"}):t(n)},e.getColumns=function(){var a=e.props.getSortOrder;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:a("name"),search:!0,render:e.renderAvatar},{title:t("STATUS"),dataIndex:"status",filters:e.getPodsStatus(),isHideable:!0,search:!0,render:function(e,a){var r=a.podStatus;return f.default.createElement("span",null,t(r.type.toUpperCase()))}},{title:t("NODE"),dataIndex:"node",isHideable:!0,width:"18%",render:e.renderNode},{title:t("POD_IP_ADDRESS"),dataIndex:"podIP",search:!0,isHideable:!0,width:"15%",render:function(e,t){var a=t.podIp;return f.default.createElement("span",null,a)}},{title:t("APP"),dataIndex:"app",isHideable:!0,search:!0,width:"15%"},{title:t("UPDATE_TIME_TCAP"),dataIndex:"startTime",sorter:!0,sortOrder:a("startTime"),isHideable:!0,width:150,render:function(e){return(0,E.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.renderAvatar=function(t,a){var r=e.props.module,n=e.props.match.params,o=n.workspace,c=n.cluster,s=n.namespace,l=a.podStatus;return f.default.createElement("div",{className:R.default.avatar},f.default.createElement("div",{className:R.default.icon},f.default.createElement(m.Icon,{name:b.ICON_TYPES[r],size:40}),f.default.createElement(h.default,{className:R.default.indicator,type:l.type,flicker:!0})),f.default.createElement("div",null,f.default.createElement(p.Link,{className:R.default.title,to:"/".concat(o,"/clusters/").concat(c,"/projects/").concat(s,"/").concat(r,"/").concat(t)},t),f.default.createElement("div",{className:R.default.desc},e.getItemDesc(a))))},e.renderNode=function(a,r){var n=e.props.match.params.cluster,o=r.node,c=r.nodeIp;if(!o)return"-";var s=t("NODE_IP",{node:o,ip:c});return f.default.createElement(p.Link,{to:"/clusters/".concat(n,"/nodes/").concat(o)},s)},e.renderStatus=function(e){return f.default.createElement(Status,{type:e.type,name:t(e.type),flicker:!0})},e}return(0,l.default)(r,[{key:"componentDidMount",value:function(){localStorage.setItem("pod-detail-referrer",location.pathname)}},{key:"getStatus",value:function(){return b.POD_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"getPodsStatus",value:function(){return b.PODS_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps;return f.default.createElement(g.ListPage,this.props,f.default.createElement(v.default,t),f.default.createElement(_.default,(0,c.default)({},a,{itemActions:this.itemActions,columns:this.getColumns(),hideColumn:["status"],onCreate:null})))}},{key:"itemActions",get:function(){var e=this.props,a=e.getData,r=e.trigger,n=e.name;return[{key:"viewYaml",icon:"eye",text:t("VIEW_YAML"),action:"view",onClick:function(e){return r("resource.yaml.edit",{detail:e,readOnly:!0})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return r("resource.delete",{type:n,detail:e,success:a})}}]}}]),r}(f.default.Component))||o)||o;a.default=C},3752:function(e,t,a){e.exports={avatar:"_18wjE6YwKuGCc6QtMtarcr",icon:"asHVqalQGd7LEpy4uq86g",indicator:"Hf_3Y6V-3PISqkpZmPeSG",title:"_3C8yRkma8RNtyONr5I2J0t",desc:"_2Xm1Gh4UKoaBZc2amYMF34"}},3753:function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(20),r(14),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(20),r(27),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=r(243),m=n(r(802)),h=n(r(813)),v=r(806),_=n(r(1207)),g=n(r(833)),y=n(r(810)),E=r(56),b=r(439),S=r(61),O=n(r(319));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var k=(0,v.withProjectList)({store:new O.default("jobs"),module:"jobs",name:"JOB"})(o=(0,p.inject)("workspaceStore")(o=function(e){(0,i.default)(r,e);var a=R(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).handleTabChange=function(t){e.props.routing.push("".concat(e.prefix,"/").concat(t))},e.getItemDesc=function(a){var r=(0,b.getWorkloadStatus)(a,e.props.module),n=r.status,o=r.reason;return o?f.default.createElement(g.default,{status:n,reason:t(o),data:a}):a.description||"-"},e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.getFilteredValue,o=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),search:!0,render:function(t,a){return f.default.createElement(m.default,{icon:S.ICON_TYPES[o],iconSize:40,title:(0,E.getDisplayName)(a),desc:e.getItemDesc(a),to:"".concat(e.prefix,"/").concat(o,"/").concat(t),isMultiCluster:a.isFedManaged})}},{title:t("STATUS"),dataIndex:"status",filters:e.getStatus(),filteredValue:n("status"),isHideable:!0,search:!0,width:"20%",render:function(e,t){return f.default.createElement(_.default,{data:t,module:o})}},{title:t("UPDATE_TIME_TCAP"),dataIndex:"updateTime",sorter:!0,sortOrder:r("updateTime"),isHideable:!0,width:"20%",render:function(e){return(0,E.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("workload.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster,supportGpuSelect:!0,isProject:!0,rootStore:e.props.rootStore,workspace:a.params.workspace,supportNodeGroupSelect:!0})},e}return(0,l.default)(r,[{key:"getStatus",value:function(){return S.JOB_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps;return f.default.createElement(v.ListPage,this.props,f.default.createElement(h.default,(0,c.default)({},t,{tabs:this.tabs})),f.default.createElement(y.default,(0,c.default)({},a,{itemActions:this.itemActions,columns:this.getColumns(),onCreate:this.showCreate})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.namespace,r=e.cluster;return"/".concat(t,"/clusters/").concat(r,"/projects/").concat(a)}},{key:"tabs",get:function(){return{value:this.props.module,onChange:this.handleTabChange,options:[{value:"jobs",label:t("JOB_PL")},{value:"cronjobs",label:t("CRONJOB_PL")}]}}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.store,n=e.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return a("resource.baseinfo.edit",{detail:e})}},{key:"rerun",icon:"refresh",text:t("RERUN"),action:"edit",onClick:function(e){return r.rerun(e)}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",type:"danger",onClick:function(e){return a("resource.delete",{type:n,detail:e})}}]}}]),r}(f.default.Component))||o)||o;a.default=k},3754:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(98),r(14),r(4),r(18),r(30),r(11),r(69),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(98),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(69),r(110);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=r(17),m=r(437),h=n(r(26)),v=n(r(802)),_=n(r(807)),g=n(r(813)),y=r(806),E=n(r(810)),b=r(56),S=r(61),O=n(r(459));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var k=(0,y.withProjectList)({store:new O.default("s2ibuilders"),module:"s2ibuilders",name:"IMAGE_BUILDER"})(o=function(e){(0,i.default)(r,e);var a=R(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).getColumns=function(){var a=e.props,r=a.prefix,n=a.module;return[{title:t("NAME"),dataIndex:"name",render:function(e,a){return f.default.createElement(v.default,{icon:S.ICON_TYPES[n],iconSize:40,title:(0,b.getDisplayName)(a),desc:a.serviceName?t("BUILD_IMAGE_FOR_SERVICE",{service:a.serviceName}):"-",to:"".concat(r,"/").concat(e)})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"15%",render:function(e){var a=(0,h.default)(e,"lastRunState","");return a="Running"===a?"Building":a,f.default.createElement(_.default,{name:t(a.toUpperCase()||"NOT_RUNNING_YET"),type:a||"Unknown",flicker:!0})}},{title:t("TYPE"),dataIndex:"type",isHideable:!0,width:"15%",render:function(e){return e&&t(e.toUpperCase())}},{title:t("SERVICE"),dataIndex:"serviceName",isHideable:!0,width:"15%",render:function(e){return e?f.default.createElement(m.Link,{to:"./services/".concat(e,"/")},e):"-"}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",isHideable:!0,width:150,render:function(e){return(0,b.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("imagebuilder.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster})},e}return(0,l.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.freshDisposer=(0,p.reaction)((function(){return e.store.list.isLoading}),(function(){var t=e.store.list.data.some((function(e){return"Running"===(0,h.default)(e,"status.lastRunState","Running")}));clearTimeout(e.freshTimer),t&&(e.freshTimer=setTimeout(e.handleFresh,4e3))}),{fireImmediately:!0})}},{key:"componentWillUnmount",value:function(){this.freshDisposer&&this.freshDisposer(),clearTimeout(this.freshTimer)}},{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps;return f.default.createElement(y.ListPage,this.props,f.default.createElement(g.default,(0,c.default)({},a,{description:t("IMAGE_BUILDER_DESC")})),f.default.createElement(E.default,(0,c.default)({},r,{itemActions:this.itemActions,columns:this.getColumns(),onCreate:this.showCreate})))}},{key:"store",get:function(){return this.props.store}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return a("resource.baseinfo.edit",{detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{type:r,detail:e})}}]}}]),r}(f.default.Component))||o;a.default=k},3755:function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(20),r(14),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(20),r(27),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=r(243),m=n(r(802)),h=n(r(807)),v=n(r(813)),_=r(806),g=n(r(833)),y=n(r(810)),E=r(56),b=r(439),S=r(61),O=n(r(319));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var k=(0,_.withProjectList)({store:new O.default("cronjobs"),module:"cronjobs",name:"CRONJOB"})(o=(0,p.inject)("workspaceStore")(o=function(e){(0,i.default)(r,e);var a=R(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).handleTabChange=function(t){e.props.routing.push("".concat(e.prefix,"/").concat(t))},e.handleSwitch=function(t,a){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.props.store.switch(t,a,r).then((function(){e.props.routing.query()}))},e.getItemDesc=function(a){var r=(0,b.getWorkloadStatus)(a,e.props.module),n=r.status,o=r.reason;return o?f.default.createElement(g.default,{status:n,reason:t(o),data:a}):a.description||"-"},e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.getFilteredValue,o=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),search:!0,render:function(t,a){return f.default.createElement(m.default,{icon:S.ICON_TYPES[o],iconSize:40,title:(0,E.getDisplayName)(a),desc:e.getItemDesc(a),to:"".concat(e.prefix,"/").concat(o,"/").concat(t)})}},{title:t("STATUS"),dataIndex:"status",filters:e.getStatus(),filteredValue:n("status"),isHideable:!0,search:!0,width:"15%",render:function(e,a){var r=(0,b.getWorkloadStatus)(a,o).status;return f.default.createElement(h.default,{type:r,name:t("CRONJOB_".concat(r.toUpperCase()))})}},{title:t("SCHEDULE"),dataIndex:"spec.schedule",isHideable:!0,width:"15%"},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:150,render:function(e){return(0,E.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("workload.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster,supportGpuSelect:!0,workspace:a.params.workspace,supportNodeGroupSelect:!0,isProject:!0,k8sVersion:e.k8sVersion,success:function(){return e.props.routing.query()},rootStore:e.props.rootStore})},e}return(0,l.default)(r,[{key:"getStatus",value:function(){return S.CRONJOB_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps;return f.default.createElement(_.ListPage,this.props,f.default.createElement(v.default,(0,c.default)({},t,{tabs:this.tabs})),f.default.createElement(y.default,(0,c.default)({},a,{itemActions:this.itemActions,columns:this.getColumns(),onCreate:this.showCreate})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.namespace,r=e.cluster;return"/".concat(t,"/clusters/").concat(r,"/projects/").concat(a)}},{key:"k8sVersion",get:function(){var e,t,a=this.props.match.params.cluster;return null===(e=globals.clusterConfig)||void 0===e||null===(t=e[a])||void 0===t?void 0:t.k8sVersion}},{key:"tabs",get:function(){return{value:this.props.module,onChange:this.handleTabChange,options:[{value:"jobs",label:t("JOB_PL")},{value:"cronjobs",label:t("CRONJOB_PL")}]}}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.trigger,n=a.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(t){r("resource.baseinfo.edit",{detail:t,k8sVersion:e.k8sVersion,success:function(){return e.props.routing.query()}})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(t){r("resource.yaml.edit",{detail:t,k8sVersion:e.k8sVersion,success:function(){return e.props.routing.query()}})}},{show:function(e){return e.suspend},key:"start",icon:"start",text:t("START"),action:"edit",onClick:function(t){e.handleSwitch(t,!0,e.k8sVersion)}},{show:function(e){return!e.suspend},key:"pause",icon:"stop",text:t("PAUSE"),action:"edit",onClick:function(t){e.handleSwitch(t,!1,e.k8sVersion)}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(t){r("resource.delete",{type:n,detail:t,k8sVersion:e.k8sVersion,success:function(){return e.props.routing.query()}})}}]}}]),r}(f.default.Component))||o)||o,C=(0,p.inject)()((function(e){var t,a,r=e.match.params.cluster,n=null===(t=globals.clusterConfig)||void 0===t||null===(a=t[r])||void 0===a?void 0:a.k8sVersion;return f.default.createElement(k,(0,c.default)({k8sVersion:n},e))}));a.default=C},3756:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(66),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(31)),s=n(r(317)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=r(243),h=n(r(26)),v=n(r(802)),_=n(r(800)),g=n(r(813)),y=r(806),E=n(r(810)),b=r(189),S=r(56),O=r(61),R=n(r(325)),k=n(r(3757));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var D=(0,y.withProjectList)({store:new R.default,module:"services",name:"SERVICE",searchByApp:!0})(o=(0,m.inject)("workspaceStore")(o=function(e){(0,u.default)(r,e);var a=T(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).state={type:"list"},e.handleTabChange=function(t){e.setState({type:t})},e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),search:!0,width:"20%",render:function(t,a){return p.default.createElement(v.default,{icon:O.ICON_TYPES[n],iconSize:40,title:(0,S.getDisplayName)(a),desc:a.description||"-",to:"".concat(e.props.match.url,"/").concat(t),isMultiCluster:a.isFedManaged})}},{title:t("SERVICE_TYPE_TCAP"),dataIndex:'annotations["kubesphere.io/serviceType"]',isHideable:!0,width:"15%",render:function(e,a){return p.default.createElement(_.default,{title:e?t("SERVICE_TYPE_".concat(e.toUpperCase())):t("CUSTOM_SERVICE"),description:t(a.type)||"-"})}},{title:t("APP"),dataIndex:"app",isHideable:!0,search:!0,width:"15%",render:function(e,t){var a=(0,h.default)(t,'labels["application.kubesphere.io/instance"]'),r=(0,h.default)(t,'labels["app.kubernetes.io/name"]');return a||r||e||"-"}},{title:t("INTERNAL_ACCESS"),dataIndex:"clusterIP",isHideable:!0,width:"15%",render:function(e,a){return p.default.createElement(_.default,{title:a.clusterIP||"",description:t("".concat(a.type))})}},{title:t("EXTERNAL_ACCESS"),dataIndex:"specType",isHideable:!0,width:"20%",render:function(t,a){return e.renderExternalService(a)}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:"15%",render:function(e){return(0,S.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.renderExternalService=function(e){var a={des:"-",title:"-"};return"NodePort"===e.specType&&(a.des=t("NODE_PORTS_SCAP"),a.title=e.ports.filter((function(e){return e.nodePort})).map((function(e){return"".concat(e.nodePort,"/").concat(e.protocol)})).join("; ")),"LoadBalancer"===e.specType&&(a.des=e.loadBalancerIngress.length>1?t("LOAD_BALANCERS_SCAP"):t("LOAD_BALANCER_SCAP"),a.title=e.loadBalancerIngress.join("; ")),e.externalName?p.default.createElement(_.default,{description:a.des,title:function(){return p.default.createElement(b.Tooltip,{content:e.externalName},p.default.createElement("span",null,a.title))}}):p.default.createElement(_.default,{description:t("".concat(a.des)),title:a.title})},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("service.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster,workspace:a.params.workspace,supportNodeGroupSelect:!0})},e}return(0,i.default)(r,[{key:"render",value:function(){var e=this.state.type,t=this.props,a=t.bannerProps,r=t.tableProps,n=t.match,o={onCreate:this.showCreate};return p.default.createElement(y.ListPage,this.props,p.default.createElement(g.default,(0,s.default)({},a,{tabs:this.tabs,tips:this.tips})),"topology"===e?p.default.createElement(k.default,{match:n}):p.default.createElement(E.default,(0,s.default)({},r,{itemActions:this.itemActions,tableActions:this.tableActions,columns:this.getColumns()},o)))}},{key:"tabs",get:function(){var e=this.props.match.params.cluster;return globals.app.hasClusterModule(e,"network.topology")?{value:this.state.type,onChange:this.handleTabChange,options:[{value:"list",label:t("SERVICE_LIST")},{value:"topology",label:t("SERVICE_TOPOLOGY")}]}:{}}},{key:"tips",get:function(){return[{title:t("SERVICE_TYPES_Q"),description:t("SERVICE_TYPES_A")},{title:t("SCENARIOS_FOR_SERVICES_Q"),description:t("SCENARIOS_FOR_SERVICES_A")}]}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return a("resource.baseinfo.edit",{detail:e})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return a("resource.yaml.edit",{detail:e})}},{key:"editService",icon:"network-router",text:t("EDIT_SERVICE"),action:"edit",onClick:function(e){return a("service.edit",{detail:e})}},{key:"editGateway",icon:"ip",text:t("EDIT_EXTERNAL_ACCESS"),action:"edit",show:function(e){return e.type===O.SERVICE_TYPES.VirtualIP},onClick:function(e){return a("service.gateway.edit",{detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("service.delete",{type:r,detail:e})}}]}},{key:"tableActions",get:function(){var e=this.props,a=e.tableProps,r=e.name,n=e.rowKey,o=e.trigger;return A(A({},a.tableActions),{},{selectActions:[{key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){return o("service.batch.delete",{type:r,rowKey:n})}}]})}}]),r}(p.default.Component))||o)||o;a.default=D},3757:function(e,t,a){"use strict";var r=a(19),n=a(162);a(12),a(3),a(10),a(6),a(20),a(8),a(13),a(9),a(4),a(18),a(30),a(11),a(69),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(30),a(11),a(69),a(7);var o,c=r(a(31)),s=r(a(25)),l=r(a(28)),i=r(a(74)),u=r(a(41)),d=r(a(42)),f=r(a(37)),p=n(a(0)),m=r(a(5)),h=a(243),v=a(189),_=a(4566),g=a(857),y=r(a(801)),E=r(a(3758)),b=a(803),S=r(a(3804)),O=r(a(3806)),R=r(a(3808)),k=r(a(3810)),C=r(a(3824));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var P=(0,h.observer)(o=function(e){(0,u.default)(a,e);var t=D(a);function a(){var e;(0,s.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={type:"pause",selectService:null,fullscreen:!1},e.store=new E.default,e.handleZoom=function(){var t=g.event.transform;e.transPan.attr("transform","scale(".concat(t.k,") translate(").concat(t.x/t.k,", ").concat(t.y/t.k,")"))},e.fetchData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.store.fetchList(T(T({},e.props.match.params),t))},e.handleChange=function(t){e.setState({type:t},(function(){"auto"===e.state.type?(0,b.startAutoRefresh)((0,i.default)(e),{method:"fetchData",leading:!1,interval:1e4}):(0,b.stopAutoRefresh)((0,i.default)(e))}))},e.handleRefresh=function(){e.fetchData()},e.handleServiceClick=function(t){e.setState((function(e){var a=e.selectService;return{selectService:a&&a.id===t.id?null:t}}))},e.handleDetailClose=function(){e.setState({selectService:null})},e.toggleFullscreen=function(){e.setState((function(e){return{fullscreen:!e.fullscreen}}))},e}return(0,l.default)(a,[{key:"componentDidMount",value:function(){this.fetchData(),this.svg=(0,g.select)("#canvas").call((0,_.zoom)().extent([[0,0],[9999,9999]]).scaleExtent([.1,1.5]).on("zoom",this.handleZoom)),this.transPan=this.svg.select("g.transform")}},{key:"componentWillUnmount",value:function(){(0,b.stopAutoRefresh)(this)}},{key:"render",value:function(){var e=this,t=this.state,a=t.type,r=t.fullscreen,n=t.selectService,o=this.store,s=o.topologies,l=s.nodes,i=void 0===l?[]:l,u=s.edges,d=void 0===u?[]:u,f=o.isLoading;return p.default.createElement(y.default,{className:(0,m.default)((0,c.default)({},C.default.fullscreen,r))},p.default.createElement("div",{className:C.default.toolbar},p.default.createElement(S.default,{value:a,options:this.options,onChange:this.handleChange}),p.default.createElement("div",{className:C.default.right},p.default.createElement(v.Button,{type:"flat",icon:"refresh",onClick:this.handleRefresh}),p.default.createElement(v.Button,{type:"flat",icon:r?"minimize":"maximize",onClick:this.toggleFullscreen}))),p.default.createElement("div",{className:C.default.content},p.default.createElement("svg",{id:"canvas"},p.default.createElement("g",{className:"transform"},p.default.createElement("g",{className:"chart"},d.map((function(e){return p.default.createElement(R.default,{key:e.v+e.w,data:e})})),i.map((function(t){return p.default.createElement(O.default,{key:t.id,data:t,isSelected:n&&n.id===t.id,onClick:e.handleServiceClick})}))))),f&&p.default.createElement(v.Loading,{className:C.default.loading}),!!n&&p.default.createElement(k.default,{data:n,store:this.store,match:this.props.match,onClose:this.handleDetailClose})))}},{key:"options",get:function(){return[{label:"AUTO_REFRESH",icon:"start",value:"auto"},{label:"PAUSE",icon:"pause",value:"pause"}]}}]),a}(p.Component))||o;t.default=P},3758:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(14),a(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(3),a(14),a(8),a(4),a(21);var n=r(a(38));a(35);var o,c,s,l,i=r(a(39)),u=r(a(62)),d=r(a(25)),f=r(a(28)),p=r(a(45)),m=(r(a(63)),r(a(26))),h=a(17),v=a(3759),_=(o=function(){function e(t){var a=this;(0,d.default)(this,e),this.topologies={},(0,u.default)(this,"detail",c,this),(0,u.default)(this,"isLoading",s,this),(0,u.default)(this,"isSubmitting",l,this),this.getListUrl=function(e){return"kapis/network.kubesphere.io/v1alpha2".concat(a.getPath(e),"/topology")},this.getDetailUrl=function(e){return"".concat(a.getListUrl(e),"/").concat(e.name)},this.module=t}var t,a;return(0,f.default)(e,[{key:"getPath",value:function(e){var t=e.cluster,a=e.namespace,r="";return t&&(r+="/klusters/".concat(t)),a&&(r+="/namespaces/".concat(a)),r}},{key:"fetchList",value:(a=(0,i.default)(n.default.mark((function e(t){var a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,request.get(this.getListUrl(t),t);case 3:a=e.sent,this.topologies=(0,v.processTopology)((0,m.default)(a,"nodes",{})),this.isLoading=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchDetail",value:(t=(0,i.default)(n.default.mark((function e(t){var a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,request.get(this.getDetailUrl(t));case 3:a=e.sent,this.detail=a,this.isLoading=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),c=(0,p.default)(o.prototype,"detail",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),s=(0,p.default)(o.prototype,"isLoading",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),l=(0,p.default)(o.prototype,"isSubmitting",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),(0,p.default)(o.prototype,"fetchList",[h.action],Object.getOwnPropertyDescriptor(o.prototype,"fetchList"),o.prototype),(0,p.default)(o.prototype,"fetchDetail",[h.action],Object.getOwnPropertyDescriptor(o.prototype,"fetchDetail"),o.prototype),o);t.default=_},3759:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(44),a(6),a(20),a(138),a(8),a(13),a(9),a(190),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.processTopology=void 0,a(12),a(3),a(10),a(44),a(6),a(20),a(27),a(138),a(33),a(16),a(8),a(13),a(9),a(4),a(190),a(7);var n=r(a(31)),o=r(a(1600)),c=r(a(1310)),s=r(a(1123)),l=r(a(445));function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.processTopology=function(e){var t=new o.default.graphlib.Graph;t.setGraph({ranksep:"100",marginx:20,marginy:20}),t.setDefaultEdgeLabel((function(){return{}})),Object.keys(e).forEach((function(a){t.setNode(a,{label:e[a].label,width:150,height:100}),e[a].adjacency&&e[a].adjacency.forEach((function(e){var r=a===e?1:0;t.setEdge(a,e,{id:"".concat(a,"-").concat(e),minlen:r})}))})),o.default.layout(t),t.nodes().forEach((function(a){var r=t.node(a);e[a].x=r.x,e[a].y=r.y,e[a].degree=0})),t.edges().forEach((function(t){t.v===t.w?e[t.v].degree+=1:(e[t.v].degree+=1,e[t.w].degree+=1)}));var a=t.edges().map((function(e){var a=t.edge(e).points;return u(u({},e),{},{points:a})})),r=t.graph(),n=r.width,i=r.height,d={width:n,height:i,gWidth:n,gHeight:i,nodes:Object.values(e),edges:a};return d=function(e){var t=u({},e),a=0,r=0,n=e.gHeight||e.height,o=e.gWidth||e.width,i=n?o/n:1,d=e.nodes,f=d.filter((function(e){return 0===e.degree}));if(f.length){var p,m,h=d.filter((function(e){return 0!==e.degree}));h.length>0&&(i<1?(p=(0,c.default)(h,(function(e){return e.x})).x,m=(0,s.default)(h,(function(e){return e.y})).y,p&&(p+=200)):(p=(0,s.default)(h,(function(e){return e.x})).x,(m=(0,c.default)(h,(function(e){return e.y})).y)&&(m+=150))),p=p||(a+150)/2,m=m||(r+100)/2;var v,_,g=Math.ceil(Math.sqrt(f.length)),y=0,E=0;d=(d=(0,l.default)(d,(function(e){return e.rank}))).map((function(e){return f.find((function(t){return t.id===e.id}))?(E===g&&(E=0,y+=1),v=200*E+p,_=150*y+m,E+=1,Object.assign(e,{x:v,y:_})):e})),t.width=Math.max(e.width,v+75+50),t.height=Math.max(e.height,_+50+50),t.nodes=d}return t}(d)}},3804:function(e,a,r){"use strict";r(16);var n=r(162),o=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var c=o(r(25)),s=o(r(28)),l=o(r(41)),i=o(r(42)),u=o(r(37)),d=n(r(0)),f=r(189),p=o(r(3805));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var h=function(e){(0,l.default)(r,e);var a=m(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleClick=function(t){e.props.onChange(t.currentTarget.dataset.value)},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.value,n=a.options;return d.default.createElement("div",{className:p.default.buttons},n.map((function(a){return d.default.createElement(f.Button,{key:a.value,icon:a.icon,iconType:r===a.value?"light":"dark",type:r===a.value?"control":"default","data-value":a.value,onClick:e.handleClick},t(a.label))})))}}]),r}(d.Component);a.default=h},3805:function(e,t,a){e.exports={buttons:"_3ikNc9_I9L02SEeuiDIB8K"}},3806:function(e,a,r){"use strict";r(16);var n=r(162),o=r(19);r(12),r(109),r(3),r(44),r(4),r(18),r(30),r(11),r(71),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(44),r(29),r(4),r(18),r(43),r(30),r(11),r(71);var c=o(r(31)),s=o(r(25)),l=o(r(28)),i=o(r(41)),u=o(r(42)),d=o(r(37)),f=n(r(0)),p=o(r(5)),m=r(189),h=o(r(3807));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var _={cloud:"cloud",heptagon:"appcenter"},g=function(e){(0,i.default)(r,e);var a=v(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleClick=function(){var t=e.props;(0,t.onClick)(t.data)},e}return(0,l.default)(r,[{key:"render",value:function(){var e,a=this.props,r=a.data,n=a.isSelected,o=r.label,s=r.labelMinor,l=r.x,i=r.y;if(r&&r.metadata){var u=r.metadata.find((function(e){return"kubernetes_ip"===e.id}));u&&(e=u.value)}return f.default.createElement("g",{className:h.default.wrapper,transform:"translate(".concat(l-75,", ").concat(i-50,")")},f.default.createElement("rect",{width:150,height:100,rx:4}),f.default.createElement("foreignObject",{width:150,height:100},f.default.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",className:(0,p.default)(h.default.service,(0,c.default)({},h.default.selected,n)),onClick:this.handleClick},f.default.createElement("div",{className:h.default.header},f.default.createElement("div",{className:h.default.icon},f.default.createElement(m.Icon,{name:_[r.shape],size:40})),f.default.createElement("div",{className:h.default.text},f.default.createElement("div",{className:h.default.title,title:o},o),f.default.createElement("div",{className:h.default.description},t("POD_COUNT_VALUE",{value:s.replace(/[ a-z]/g,"")})))),f.default.createElement("div",{className:h.default.footer},e?t(e.toUpperCase()):o))))}}]),r}(f.Component);a.default=g},3807:function(e,t,a){e.exports={wrapper:"_2mbWHDU8BXHZcz5hAFRFT9",service:"cDzX6CWqX8JTPvK7XG_V-",selected:"_17O1b_bi1TWkvP4qUDXe-l",footer:"_1snnFCQH5RtnJZWYAqZUcF",header:"_2SWMK_i9x7vbpLW_jXhnsr",icon:"_3ymyQLD4nmoQzxCPoBEAlA",text:"_3TjppLQqLTe5Q1mwo9qwg9",title:"_31AGol0Nr3rJCWoc_NeyPk",description:"_2rjNLpcCtfELHU6J_2NRp-"}},3808:function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var o=n(a(25)),c=n(a(28)),s=n(a(41)),l=n(a(42)),i=n(a(37)),u=r(a(0)),d=a(1094),f=n(a(3809));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var m=function(e){(0,s.default)(a,e);var t=p(a);function a(){return(0,o.default)(this,a),t.apply(this,arguments)}return(0,c.default)(a,[{key:"render",value:function(){var e=this.props.data,t=void 0===e?{}:e,a=(0,d.line)().curve(d.curveBasis).x((function(e){return e.x})).y((function(e){return e.y})),r=t.v+t.w;return u.default.createElement("g",{className:f.default.wrapper},u.default.createElement("defs",null,u.default.createElement("marker",{id:"triangle-".concat(r),viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},u.default.createElement("path",{d:"M 0 0 L 10 5 L 0 10 z"}))),u.default.createElement("path",{d:a(t.points),markerEnd:"url(#triangle-".concat(r,")")}))}}]),a}(u.Component);t.default=m},3809:function(e,t,a){e.exports={wrapper:"_3Q_ifBkTTIHEBmNsHEApJj"}},3810:function(e,t,a){"use strict";a(16);var r=a(19),n=a(162);a(3),a(4),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(30),a(11),a(69);var o,c,s,l=r(a(25)),i=r(a(28)),u=r(a(41)),d=r(a(42)),f=r(a(37)),p=n(a(0)),m=a(17),h=a(243),v=a(189),_=r(a(3811)),g=r(a(3813)),y=r(a(3816)),E=r(a(3819)),b=r(a(3821)),S=r(a(3823));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var R=v.Collapse.CollapseItem,k=(0,h.observer)((s=c=function(e){(0,u.default)(a,e);var t=O(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={activeKey:["Info"]},e.handleJump=function(t){e.fetchDetail(t.id)},e.handleCollapseChange=function(t){e.setState({activeKey:t})},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){this.fetchDetail(this.props.data.id)}},{key:"componentDidUpdate",value:function(e){e.data.id!==this.props.data.id&&this.fetchDetail(this.props.data.id)}},{key:"fetchDetail",value:function(e){var t=this.props,a=t.store,r=t.match.params,n=r.cluster,o=r.namespace;e&&a.fetchDetail({cluster:n,namespace:o,name:e})}},{key:"render",value:function(){var e=this.props.onClose,t=(0,m.toJS)(this.props.store.detail).node,a=void 0===t?{}:t,r=this.props.match;return p.default.createElement("div",{className:S.default.wrapper},p.default.createElement("div",{className:S.default.header},p.default.createElement("div",{className:S.default.icon},p.default.createElement(v.Icon,{name:"appcenter",size:40})),p.default.createElement("div",{className:S.default.title},a.label),p.default.createElement(v.Button,{className:S.default.close,icon:"close",iconType:"light",type:"control",onClick:e,"data-test":"modal-close"})),p.default.createElement("div",{className:S.default.content},p.default.createElement(v.Collapse,{activeKey:this.state.activeKey,onChange:this.handleCollapseChange,accordion:!0},p.default.createElement(R,{label:"info",key:"info"},p.default.createElement(_.default,{detail:a})),p.default.createElement(R,{label:"Traffic",key:"traffic"},p.default.createElement(g.default,{detail:a,jumpTo:this.handleJump})),p.default.createElement(R,{label:"Pods",key:"pods"},p.default.createElement(y.default,{detail:a})),p.default.createElement(R,{label:"Containers",key:"containers"},p.default.createElement(E.default,{detail:a,match:r})),p.default.createElement(R,{label:"Kubernetes labels",key:"labels"},p.default.createElement(b.default,{detail:a})))))}}]),a}(p.Component),c.defaultProps={data:{}},o=s))||o;t.default=k},3811:function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(6),a(20),a(4),a(18),a(30),a(11),a(71),a(817),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(6),a(20),a(29),a(4),a(18),a(43),a(30),a(11),a(71),a(817),a(7);var o=n(a(25)),c=n(a(28)),s=n(a(41)),l=n(a(42)),i=n(a(37)),u=r(a(0)),d=n(a(26)),f=n(a(67)),p=a(56),m=n(a(3812));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var v=function(e){(0,s.default)(a,e);var t=h(a);function a(){return(0,o.default)(this,a),t.apply(this,arguments)}return(0,c.default)(a,[{key:"getValue",value:function(e){return"datetime"===e.type?(0,p.getLocalTime)(e.value).format("YYYY-MM-DD HH:mm:ss"):e.value}},{key:"render",value:function(){var e=this,t=(0,d.default)(this.props.detail,"metadata",[]);return(0,f.default)(t)?null:(t.forEach((function(e){"Created"===e.label&&(e.value=(0,p.getLocalTime)(e.value).format("YYYY-MM-DD HH:mm:ss")),"pod"===e.id&&(e.label=e.label.replace(/#/g,"").trim())})),u.default.createElement("div",{className:m.default.info},t.map((function(t){return u.default.createElement("dl",{key:t.id},u.default.createElement("dd",null,t.label,":"),u.default.createElement("dd",null,e.getValue(t)))}))))}}]),a}(u.Component);t.default=v},3812:function(e,t,a){e.exports={info:"_1VN50mOqkK2M8SD1iavjaj"}},3813:function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(3),a(10),a(6),a(20),a(87),a(24),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(87),a(29),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var o=n(a(31)),c=n(a(58)),s=n(a(25)),l=n(a(28)),i=n(a(41)),u=n(a(42)),d=n(a(37)),f=r(a(0)),p=n(a(26)),m=n(a(67)),h=n(a(3814));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var y=function(e){(0,i.default)(a,e);var t=g(a);function a(){var e;(0,s.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).format=function(e){return"number"!==e.dataType&&"count"!==e.id&&"port"!==e.id||(e.value=Number(e.value)),e},e}return(0,l.default)(a,[{key:"getColumns",value:function(e){var t=this.props.jumpTo;return[{id:"label",label:e.label,defaultSort:!1,render:function(e,a){return f.default.createElement("a",{onClick:function(){return t(a)}},e)}}].concat((0,c.default)(e.columns))}},{key:"getData",value:function(e){var t=this;return e.connections.map((function(e){return _({id:e.nodeId,label:{value:e.label}},e.metadata.reduce((function(e,a){return _(_({},e),{},(0,o.default)({},a.id,t.format(a)))}),{}))}))}},{key:"render",value:function(){var e=this,t=(0,p.default)(this.props.detail,"connections",[]);return(0,m.default)(t)?null:t.map((function(t){return f.default.createElement(h.default,{key:t.id,columns:e.getColumns(t),data:e.getData(t)})}))}}]),a}(f.Component);t.default=y},3814:function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(44),a(20),a(4),a(18),a(11),a(79),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a(25)),c=n(a(28)),s=n(a(41)),l=n(a(42)),i=n(a(37));a(32),a(3),a(44),a(20),a(247),a(29),a(4),a(18),a(43),a(11),a(79);var u=n(a(445)),d=n(a(67)),f=r(a(0)),p=a(189),m=a(803),h=n(a(3815));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var _=function(e){(0,s.default)(a,e);var t=v(a);function a(e){var r;(0,o.default)(this,a),(r=t.call(this,e)).handleTitleClick=function(e){var t=e.currentTarget.dataset.id;r.setState((function(e){var a=e.sortKey,r=e.order;return{sortKey:t,order:a!==t?"asc":"asc"===r?"desc":"asc"}}))};var n=r.props.columns.find((function(e){return e.defaultSort}));return r.state={sortKey:n?n.id:"",order:"asc"},r}return(0,c.default)(a,[{key:"componentDidUpdate",value:function(e,t){if(!t.sortKey&&e.columns!==this.props.columns){var a=this.props.columns.find((function(e){return e.defaultSort}));a&&this.setState({sortKey:a.id,order:"asc"})}}},{key:"getValue",value:function(e){return(0,d.default)(e)?"":"percent"===e.format?"".concat(e.value,"%"):"filesize"===e.format?"".concat((0,m.getSuitableValue)(e.value,"disk")):e.value}},{key:"render",value:function(){var e=this,t=this.props,a=t.columns,r=t.data,n=this.state,o=n.sortKey,c=n.order,s=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc";if(!t)return e;var r=(0,u.default)(e,"".concat(t,".value"));return"asc"===a&&(r=r.reverse()),r}(r,o,c);return f.default.createElement("table",{className:h.default.table},f.default.createElement("thead",null,f.default.createElement("tr",null,a.map((function(t){return f.default.createElement("th",{key:t.id,title:t.label,"data-id":t.id,onClick:e.handleTitleClick},"number"===t.dataType&&t.label.startsWith("#")?"#":t.label,o===t.id&&f.default.createElement(p.Icon,{name:"asc"===c?"caret-down":"caret-up"}))})))),f.default.createElement("tbody",null,s.map((function(t,r){return f.default.createElement("tr",{key:"".concat(t.id,"-").concat(r)},a.map((function(a){var r=e.getValue(t[a.id]);return f.default.createElement("td",{key:a.id,title:r},a.render?a.render(r,t):r)})))}))))}}]),a}(f.Component);t.default=_},3815:function(e,t,a){e.exports={table:"_3_MT8fZBjSbHX5gZjAySbf"}},3816:function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(3),a(10),a(6),a(20),a(87),a(24),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(87),a(29),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var o=n(a(31)),c=n(a(58)),s=n(a(25)),l=n(a(28)),i=n(a(41)),u=n(a(42)),d=n(a(37)),f=r(a(0)),p=n(a(26)),m=n(a(67)),h=n(a(3817));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var y=function(e){(0,i.default)(a,e);var t=g(a);function a(){var e;(0,s.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).format=function(e){return"number"!==e.dataType&&"count"!==e.id&&"port"!==e.id||(e.value=Number(e.value)),e},e}return(0,l.default)(a,[{key:"getColumns",value:function(e){return[{id:"label",label:e.label,defaultSort:!1,render:function(e){return f.default.createElement("strong",null,e)}}].concat((0,c.default)(e.columns))}},{key:"getData",value:function(e){var t=this;return e.nodes.map((function(e){return _({id:e.id,label:{value:e.label}},[].concat((0,c.default)(e.metadata||[]),(0,c.default)(e.metrics||[])).reduce((function(e,a){return _(_({},e),{},(0,o.default)({},a.id,t.format(a)))}),{}))}))}},{key:"render",value:function(){var e=this,t=(0,p.default)(this.props.detail,"children",[]);return(0,m.default)(t)?null:t.filter((function(e){return"Pods"===e.label})).map((function(t){return f.default.createElement(h.default,{key:t.topologyId,data:e.getData(t)})}))}}]),a}(f.Component);t.default=y},3817:function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(20),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),l=r(a(37)),i=r(a(0)),u=r(a(828)),d=r(a(3818));function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,l.default)(e);if(t){var n=(0,l.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var p=function(e){(0,c.default)(a,e);var t=f(a);function a(){return(0,n.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"getDetails",value:function(e){return[{title:this.props.data.length,description:"COUNT",className:d.default.texts},{title:e.kubernetes_ip.value||"-",description:"IP",className:d.default.texts}]}},{key:"render",value:function(){var e=this,t=this.props.data;return i.default.createElement(u.default,null,t.map((function(t){return i.default.createElement(u.default.Item,{key:t.id,className:d.default.wrapper,titleClass:d.default.title,icon:"pod",status:t.kubernetes_state.value,title:t.label.value,description:t.kubernetes_state.value,details:e.getDetails(t)})})))}}]),a}(i.default.PureComponent);t.default=p},3818:function(e,t,a){e.exports={wrapper:"_3SzOUWHncKQV9RIjkdt7-i",title:"_25QmO4RglXBi95C7a6fl1M",texts:"_3kLVYFdpQWZpML2WX7CNie"}},3819:function(e,t,a){"use strict";a(16);var r=a(19),n=a(162);a(10),a(88),a(20),a(4),a(190),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(10),a(88),a(20),a(27),a(29),a(4),a(190),a(18),a(43),a(30),a(11),a(69);var o,c=r(a(58)),s=r(a(25)),l=r(a(28)),i=r(a(41)),u=r(a(42)),d=r(a(37)),f=n(a(0)),p=r(a(26)),m=a(189),h=r(a(1573)),v=a(243),_=r(a(3820)),g=r(a(1575));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var E={cpu_usage:"container_cpu_usage",memory_usage:"container_memory_usage_wo_cache"},b=(0,v.observer)(o=function(e){(0,i.default)(a,e);var t=y(a);function a(e){var r;return(0,s.default)(this,a),(r=t.call(this,e)).fetchData=function(){var e=r.state.containerName,t=r.props.match.params,a=t.cluster,n=t.namespace;r.monitorStore.fetchMetrics({cluster:a,namespace:n,container:e,podName:r.podName,metrics:Object.values(E)})},r.handleContainerChange=function(e){r.setState({containerName:e},(function(){r.fetchData()}))},r.state={podsId:"",containerName:""},r.monitorStore=new h.default,r}return(0,l.default)(a,[{key:"getOptions",value:function(e){if(e.length>0){var t=["POD"];e[0].nodes=e[0].nodes.filter((function(e){return-1===t.indexOf(e.label)}))}for(var a=e.length>0?(0,c.default)(e[0].nodes.map((function(e){return{label:e.label,value:e.label,icon:"docker"}}))):[],r=[],n={},o=0;o<a.length;o++)n[a[o].label]||(r.push(a[o]),n[a[o].label]=!0);return r}},{key:"render",value:function(){var e=this.monitorStore,t=e.isLoading,a=e.isRefreshing,r=this.state.containerName;return f.default.createElement("div",{className:_.default.container},f.default.createElement(m.Select,{className:_.default.containerSelect,options:this.getOptions(this.containers),onChange:this.handleContainerChange,value:r}),f.default.createElement("div",null,f.default.createElement(g.default,{type:"cpu",title:"CPU Usage(m)",metrics:this.cpuMetric,isLoading:t||a,showDay:172800}),f.default.createElement(g.default,{type:"memory",title:"Memory Usage(Mi)",metrics:this.memoryMetric,isLoading:t||a,showDay:172800})))}},{key:"podName",get:function(){var e=(0,p.default)(this.props.detail,"children",[]).filter((function(e){return"Pods"===e.label}));return e.length>0?e[0].nodes[0].label:""}},{key:"containers",get:function(){return(0,p.default)(this.props.detail,"children",[]).filter((function(e){return"Containers"===e.label}))}},{key:"cpuMetric",get:function(){var e=this.state.containerName,t=this.monitorStore.data;return""===e?[]:(0,p.default)(t,"".concat(E.cpu_usage,".data.result"))}},{key:"memoryMetric",get:function(){var e=this.state.containerName,t=this.monitorStore.data;return""===e?[]:(0,p.default)(t,"".concat(E.memory_usage,".data.result"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=(0,p.default)(e.detail,"id","");return a!==t.podsId?{containerName:"",podsId:a}:null}}]),a}(f.Component))||o;t.default=b},3820:function(e,t,a){e.exports={container:"_1OCYhwQxIVBiwoZgjC9Vt2",containerSelect:"x2gN32eQq4Fk7DwDRYlMt"}},3821:function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(36),a(20),a(4),a(18),a(11),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(36),a(20),a(29),a(4),a(18),a(43),a(11),a(40);var o=n(a(25)),c=n(a(28)),s=n(a(41)),l=n(a(42)),i=n(a(37)),u=r(a(0)),d=n(a(26)),f=n(a(67)),p=n(a(1e3)),m=n(a(3822));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var v=function(e){(0,s.default)(a,e);var t=h(a);function a(){return(0,o.default)(this,a),t.apply(this,arguments)}return(0,c.default)(a,[{key:"render",value:function(){var e=(0,d.default)(this.props.detail,"tables",[]);return(0,f.default)(e)?null:e.map((function(e){return u.default.createElement("div",{key:e.id,className:m.default.info},e.rows.map((function(e){return u.default.createElement(p.default,{key:e.id,name:e.entries.label,value:e.entries.value})})))}))}}]),a}(u.Component);t.default=v},3822:function(e,t,a){e.exports={info:"_7d5WNeWa0X-J5GxQTmMvl"}},3823:function(e,t,a){e.exports={wrapper:"lu0R0_JuvYcj7r7Qy0otO",header:"_26TkzcTc5C6Em8vDEeBJEz",icon:"_1NAGSmlNiebgr8p6Cjjxsn",title:"_31yHnayK288K6G7r3t0WIm",close:"BBrUJQnPG4Qc4u1_NstsV",content:"_1SDKhZ-aItpEmZbrbTYtRJ"}},3824:function(e,t,a){e.exports={toolbar:"_2GsMGEQTK2HjeeJMHK207X",right:"_18ABRRL3yE8zHX7GNA-zgr",content:"_1SRN7Iw9zGbVNj2koryPUT",loading:"_3B7Ub5NbMtv9vH9XEk3Jyc",fullscreen:"_2ocL9fqKky1rPQumdGqZaN"}},3825:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(27),r(29),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(26)),f=n(r(0)),p=r(243),m=r(318),h=n(r(1012)),v=n(r(813)),_=n(r(1327));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var y=(0,p.inject)("rootStore")(o=(0,p.observer)(o=function(e){(0,l.default)(r,e);var a=g(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).state={showDeployApp:!1,sampleApp:""},e.store=new h.default,e.hideDeployAppModal=function(){e.setState({showDeployApp:!1,sampleApp:""})},e.handleDeployApp=function(t){var a=e.props.match.params,r=a.workspace,n=a.cluster,o=a.namespace;e.store.create(t).then((function(){e.hideDeployAppModal(),e.routing.push("/".concat(r,"/clusters/").concat(n,"/projects/").concat(o,"/composing/").concat((0,d.default)(t,"application.metadata.name")))}))},e.showDeploySampleApp=function(){e.setState({showDeployApp:!0,sampleApp:"bookinfo"})},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props.route,a=this.state,r=a.showDeployApp,n=a.sampleApp,o=this.props.match.params,c=o.cluster,s=o.namespace;return f.default.createElement("div",null,f.default.createElement(v.default,{icon:"bird",module:"grayrelease",title:t("GRAYSCALE_RELEASE"),description:t("GRAYSCALE_RELEASE_DESC"),tips:this.tips,routes:e.routes}),(0,m.renderRoutes)(e.routes),f.default.createElement(_.default,{store:this.store,visible:r,namespace:s,cluster:c,sampleApp:n,onOk:this.handleDeployApp,onCancel:this.hideDeployAppModal,isSubmitting:this.store.isSubmitting}))}},{key:"tips",get:function(){return[{title:t("PREREQUEST_FOR_USE_GRAYRELEASE_Q"),description:t("PREREQUEST_FOR_USE_GRAYRELEASE_A")}]}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),r}(f.default.Component))||o)||o;a.default=y},3826:function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(66),r(14),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(66),r(27),r(29),r(14),r(4),r(21),r(18),r(43),r(30),r(11),r(69);var o=n(r(317)),c=n(r(38));r(35);var s,l=n(r(39)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(67)),v=r(189),_=n(r(191)),g=n(r(802)),y=n(r(800)),E=n(r(801)),b=n(r(813)),S=n(r(810)),O=r(806),R=r(56),k=r(61),C=n(r(464)),A=n(r(912)),T=n(r(3827));function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var P=(0,O.withProjectList)({store:new C.default,module:"ingresses",name:"ROUTE"})(s=function(e){(0,d.default)(r,e);var a=D(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=a.call.apply(a,[this].concat(o))).gatewayStore=new A.default,e.state={ingressClassScopes:[]},e.getGateway=(0,l.default)(c.default.mark((function t(){var a,r,n,o;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params,r=a.cluster,n=a.namespace,t.next=3,e.gatewayStore.getNewGatewayByProject({cluster:r,namespace:n});case 3:o=t.sent,e.setState({ingressClassScopes:o});case 5:case"end":return t.stop()}}),t)}))),e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),search:!0,render:function(t,a){return m.default.createElement(g.default,{icon:k.ICON_TYPES[n],iconSize:40,title:(0,R.getDisplayName)(a),desc:a.description||"-",to:"".concat(e.props.match.url,"/").concat(t)})}},{title:t("GATEWAY_ADDRESS_TCAP"),dataIndex:"loadBalancerIngress",isHideable:!0,width:"22%",render:function(e){return e.join("; ")}},{title:t("APP"),dataIndex:"app",isHideable:!0,search:!0,width:"22%"},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:150,render:function(e){return(0,R.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var a=e.props,r=a.match,n=a.module,o=a.projectStore;if(globals.app.hasKSModule("gateway"))return e.props.trigger("router.create",{module:n,projectDetail:o.detail,namespace:r.params.namespace,cluster:r.params.cluster,gatewayStore:e.gatewayStore});_.default.warning({content:t("PLEASE_INSTALL_GATEWAY")})},e.showAddGateway=function(){var a=e.props.rootStore,r=e.props.match.params,n=r.cluster,o=r.workspace,c=r.namespace;globals.app.hasKSModule("gateway")?a.routing.push("/".concat(o,"/clusters/").concat(n,"/projects/").concat(c,"/gateways")):_.default.warning({content:t("PLEASE_INSTALL_GATEWAY")})},e}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.getGateway()}},{key:"renderCreateGateway",value:function(){return m.default.createElement(E.default,{className:"margin-t12 margin-b12"},m.default.createElement("div",{className:"flexbox"},m.default.createElement(v.Icon,{className:"margin-r12",name:"loadbalancer",size:40}),m.default.createElement(y.default,{className:T.default.text,title:t("GATEWAY_NOT_ENABLED"),description:t("ENT_ENABLE_GATEWAY_TIP")}),this.canSetGateway&&m.default.createElement(v.Button,{className:T.default.button,type:"control",onClick:this.showAddGateway},t("ENABLE_GATEWAY"))))}},{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps,r=this.state.ingressClassScopes;return m.default.createElement(O.ListPage,this.props,m.default.createElement(b.default,(0,o.default)({},t,{tips:this.tips})),(0,h.default)(r)&&this.renderCreateGateway(),m.default.createElement(S.default,(0,o.default)({},a,{itemActions:this.itemActions,columns:this.getColumns(),onCreate:this.showCreate})))}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"canSetGateway",get:function(){return globals.app.hasPermission({module:"project-settings",action:"manage",cluster:this.props.match.params.cluster,project:this.props.match.params.namespace})}},{key:"tips",get:function(){return[{title:t("PREREQUESTS_FOR_USE_ROUTE_Q"),description:t("PREREQUESTS_FOR_USE_ROUTE_A")},{title:t("ACCESS_TYPES_OF_ROUTE_Q"),description:t("ACCESS_TYPES_OF_ROUTE_A")}]}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.name,n=this.props.match.params.namespace;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return a("resource.baseinfo.edit",{detail:e})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return a("resource.yaml.edit",{detail:e})}},{key:"editRules",icon:"firewall",text:t("EDIT_ROUTING_RULES"),action:"edit",onClick:function(e){return a("router.rules.edit",{detail:e,namespace:n})}},{key:"editAnnotations",icon:"firewall",text:t("EDIT_ANNOTATIONS"),action:"edit",onClick:function(e){return a("router.annotations.edit",{detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{type:r,detail:e})}}]}}]),r}(m.default.Component))||s;a.default=P},3827:function(e,t,a){e.exports={text:"_2UwflePCO7DX0nbD3YecbW",button:"_3d_LjjEdrEtEXU2IB6YRTZ"}},3828:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(66),r(20),r(194),r(14),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(66),r(20),r(194),r(29),r(14),r(4),r(21),r(18),r(43),r(30),r(11),r(69);var o=n(r(317)),c=n(r(38));r(35);var s,l=n(r(39)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=r(189),h=n(r(67)),v=n(r(0)),_=n(r(467)),g=n(r(451)),y=r(56),E=r(61),b=r(439),S=n(r(833)),O=n(r(802)),R=n(r(807)),k=n(r(813)),C=r(806),A=n(r(810)),T=n(r(1208)),D=n(r(3829));function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var N=(0,C.withProjectList)({store:new g.default,module:"persistentvolumeclaims",authKey:"persistentvolumeclaims",name:"PERSISTENT_VOLUME_CLAIM",rowKey:"uid"})(s=function(e){(0,d.default)(r,e);var a=P(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=a.call.apply(a,[this].concat(o))).pvStore=new _.default,e.getItemDesc=function(e){var t=(0,b.getVolumeStatus)(e);return(0,h.default)(t)?e.storageClassName||"-":v.default.createElement(S.default,{reason:t,data:e,type:"volume"})},e.renderAccessTitle=function(){var e=v.default.createElement("div",null,v.default.createElement("div",null,t("RWO_DESC")),v.default.createElement("div",null,t("ROX_DESC")),v.default.createElement("div",null,t("RWX_DESC")));return v.default.createElement("div",{className:D.default.mode_title},t("ACCESS_MODE_TCAP"),v.default.createElement(m.Tooltip,{content:e},v.default.createElement(m.Icon,{name:"question",size:16,className:D.default.question})))},e.mapperAccessMode=function(e){var t=(0,y.map_accessModes)(e);return v.default.createElement("span",null,t.join(","))},e.pvYamlView=function(){var t=(0,l.default)(c.default.mark((function t(a){var r,n;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.spec.volumeName,n=e.props.match.params.cluster,t.next=4,e.pvStore.fetchDetail({cluster:n,name:r});case 4:return t.abrupt("return",e.props.trigger("resource.yaml.edit",{detail:e.pvStore.detail,yaml:e.pvStore.detail._originData,readOnly:!0}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore,o=t.store;return e.props.trigger("volume.create",{module:r,store:o,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster,onAddPv:function(){return e.props.trigger("pv.create",{store:e.pvStore})}})},e}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.props.store.getKsVersion(this.props.match.params)}},{key:"getStatus",value:function(){return E.VOLUME_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"getColumns",value:function(){var e=this,a=this.props,r=a.getSortOrder,n=a.getFilteredValue,o={title:t("PERSISTENT_VOLUME"),dataIndex:"_originData",isHideable:!0,search:!1,width:"28.5%",render:function(a){return v.default.createElement("div",{id:"pvColumn",className:D.default.pv_content},a.spec.volumeName,a.spec.volumeName&&v.default.createElement(m.Tooltip,{content:t("VIEW_YAML")},v.default.createElement(m.Icon,{className:D.default.yaml,name:"log",size:20,onClick:function(){return e.pvYamlView(a)}})))}},c=[{title:t("NAME"),dataIndex:"name",sortOrder:r("name"),search:!0,sorter:!0,render:function(t,a){return v.default.createElement(O.default,{icon:"storage",iconSize:40,to:"".concat(e.props.match.url,"/").concat(t),desc:e.getItemDesc(a),title:(0,y.getDisplayName)(a)})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,search:!0,filters:this.getStatus(),filteredValue:n("status"),width:"10.6%",render:function(e,a){var r=a.phase;return v.default.createElement(R.default,{type:r,className:D.default.status,name:t("VOLUME_STATUS_".concat(r.toUpperCase())),flicker:!0})}},{title:this.renderAccessTitle(),dataIndex:"accessModes",isHideable:!1,width:"12.3%",render:function(t){return e.mapperAccessMode(t)}},{title:t("MOUNT_STATUS"),dataIndex:"inUse",isHideable:!0,width:"7.7%",render:function(e,t){return v.default.createElement(T.default,{namespace:t.namespace,cluster:t.cluster,name:t.name})}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:140,render:function(e){return(0,y.getLocalTime)(e).format("YYYY-MM-DD HH:mm")}}];return this.props.store.ksVersion>=3.2&&c.splice(2,0,o),c}},{key:"render",value:function(){var e=this.props,t=e.query,a=e.match,r=e.bannerProps,n=e.tableProps;return v.default.createElement(C.ListPage,this.props,v.default.createElement(k.default,(0,o.default)({},r,{tips:this.tips})),v.default.createElement(A.default,(0,o.default)({},n,{className:"table-2-6",itemActions:this.itemActions,namespace:t.namespace,columns:this.getColumns(),onCreate:this.showCreate,cluster:a.params.cluster})))}},{key:"tips",get:function(){return[{title:t("WHAT_IS_STORAGE_CLASS_Q"),description:t("WHAT_IS_STORAGE_CLASS_A")},{title:t("WHAT_IS_LOCAL_VOLUME_Q"),description:t("WHAT_IS_LOCAL_VOLUME_A")}]}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return a("resource.baseinfo.edit",{detail:e})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return a("resource.yaml.edit",{detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{type:r,detail:e})}}]}}]),r}(v.default.Component))||s;a.default=N},3829:function(e,t,a){e.exports={capacity:"_243L3gRj5L4Y9ESqEZMwQ5",pv_content:"_3H1A5jhLvHEPU7G5_KY0o6",yaml:"_2OW8dgKGOIskdPsJxUWKrg",status:"_3XGLspL44wlb4JRFycBpB6"}},3830:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(70),r(66),r(20),r(51),r(194),r(14),r(99),r(8),r(13),r(9),r(4),r(190),r(18),r(30),r(11),r(73),r(69),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(66),r(20),r(27),r(51),r(194),r(29),r(14),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(190),r(18),r(43),r(30),r(11),r(73),r(69),r(7);var o,c=n(r(58)),s=n(r(31)),l=n(r(97)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(17),v=r(243),_=n(r(444)),g=n(r(26)),y=n(r(845)),E=r(56),b=n(r(322)),S=n(r(323)),O=n(r(874)),R=n(r(1042)),k=r(804),C=n(r(813)),A=n(r(1542)),T=n(r(453)),D=n(r(3831)),P=n(r(1577)),N=n(r(1576));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var M="storageclass.storage.k8s.io/requests.storage",L="storageclass.storage.k8s.io/persistentvolumeclaims",j=["requests.storage","persistentvolumeclaims"],U=(0,v.inject)("rootStore","workspaceStore","projectStore")(o=(0,v.observer)(o=(0,k.trigger)(o=function(e){(0,d.default)(r,e);var a=x(r);function r(){var e;(0,i.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).roleStore=new b.default,e.memberStore=new S.default,e.quotaStore=new O.default,e.limitRangeStore=new R.default,e.storageClassStore=new T.default,e.state={showEdit:!1,showDelete:!1,showEditQuota:!1,showEditDefaultResource:!1},e.getData=function(){e.store.fetchDetail(e.params)},e.handleMoreMenuClick=function(t,a){var r=e.enabledItemActions.find((function(e){return e.key===a}));r&&r.onClick&&r.onClick()},e}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.canViewMembers&&this.memberStore.fetchList(this.params),this.canViewRoles&&this.roleStore.fetchList(this.params),this.quotaStore.fetch(this.params),this.limitRangeStore.fetchListByK8s(this.params),this.storageClassStore.fetchList({cluster:this.params.cluster})}},{key:"render",value:function(){var e=(0,h.toJS)(this.store.detail),a=this.roleStore.list.total,r=this.memberStore.list.total,n=(0,g.default)(this.quotaStore,'data.used["count/services"]',0),o=(0,h.toJS)(this.limitRangeStore.list.data)[0],c=(0,h.toJS)(this.quotaStore.data);return m.default.createElement("div",null,m.default.createElement(C.default,{icon:"cdn",title:t("BASIC_INFORMATION"),description:t("PROJECT_BASIC_INFO_DESC"),module:"project_base_info",tips:this.tips}),m.default.createElement(D.default,{detail:e,roleCount:a,memberCount:r,serviceCount:n,workspace:this.workspace,actions:this.enabledItemActions,onMenuClick:this.handleMoreMenuClick,showDetail:this.canViewMembers&&this.canViewRoles}),m.default.createElement(N.default,{detail:o}),m.default.createElement(P.default,{detail:c,storageClassResource:this.storageClassResource,relateStorageClass:this.relateStorageClass,allStorageClass:this.allStorageClass}),m.default.createElement(A.default,{annotations:e.annotations,hiddenKeys:globals.config.preservedAnnotations}))}},{key:"allStorageClass",get:function(){return(0,h.toJS)(this.storageClassStore.list.data)}},{key:"storageClassResource",get:function(){var e=(0,h.toJS)(this.quotaStore.data.hard),t=(0,h.toJS)(this.quotaStore.data.used);return j.map((function(a){var r=(0,g.default)(e,[a],a.includes("claims")?"0":"0Gi"),n=(0,g.default)(t,[a],a.includes("claims")?"0":"0Gi"),o=a.includes("claims")?r:(0,E.memoryFormat)(r,"Gi");return{key:a,name:a,total:o>0?a.includes("claims")?o:"".concat(o,"Gi"):void 0,used:a.includes("claims")?n:(0,E.memoryFormat)(n,"Gi")}}))}},{key:"relateStorageClass",get:function(){var e=(0,h.toJS)(this.quotaStore.data),t=(0,g.default)(e,"hard",{}),a=(0,g.default)(e,"used",{}),r=Object.entries(t).filter((function(e){var t=(0,l.default)(e,1)[0];return(0,_.default)(t,M)||(0,_.default)(t,L)})).map((function(e){var t=(0,l.default)(e,2),a=t[0],r=t[1];return(0,s.default)({},a,r)})),n=r.map((function(e){var t=Object.keys(e)[0];return(0,s.default)({},t,(0,g.default)(a,t))})),o={total:(0,c.default)(r),used:(0,c.default)(n)};if(o.total.length>0){var i,u=(0,y.default)((0,c.default)(o.total),(function(e){return Object.keys(e)[0].split(".").slice(1).join(".")}));return i={},(0,s.default)(i,M,(0,g.default)(u,[M],[]).map((function(e){var t=Object.keys(e)[0],a=o.used.filter((function(e){return Object.keys(e)[0]===t}))[0];return{name:t,total:Object.values(e)[0],used:Object.values(a)[0]}}))),(0,s.default)(i,L,(0,g.default)(u,[L],[]).map((function(e){var t=Object.keys(e)[0],a=o.used.filter((function(e){return Object.keys(e)[0]===t}))[0];return{name:t,total:Object.values(e)[0],used:Object.values(a)[0]}}))),i}return{}}},{key:"isClusterManage",get:function(){return globals.app.isPlatformAdmin||globals.app.hasPermission({module:"clusters",action:"manage"})}},{key:"store",get:function(){return this.props.projectStore}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"params",get:function(){return(0,g.default)(this.props.match,"params",{})}},{key:"workspace",get:function(){return this.params.workspace}},{key:"tips",get:function(){return[{title:t("HOW_TO_USE_QUOTA_Q"),description:t.html("HOW_TO_USE_QUOTA_A")},{title:t("WHAT_ARE_DEFAULT_CONTAINER_QUOTAS_Q"),description:t("WHAT_ARE_DEFAULT_CONTAINER_QUOTAS_A")}]}},{key:"enabledActions",get:function(){return globals.app.getActions(w(w({module:"project-settings"},this.params),{},{project:this.params.namespace}))}},{key:"canViewRoles",get:function(){return globals.app.hasPermission(w(w({module:"roles",action:"view"},this.params),{},{project:this.params.namespace}))}},{key:"canViewMembers",get:function(){return globals.app.hasPermission(w(w({module:"members",action:"view"},this.params),{},{project:this.params.namespace}))}},{key:"itemActions",get:function(){var e=this,a=this.props.rootStore.routing,r=this.store.detail,n=this.limitRangeStore.list.data,o=[{key:"edit",icon:"pen",action:"edit",text:t("EDIT_INFORMATION"),onClick:function(){return e.trigger("resource.baseinfo.edit",{detail:r,success:e.getData})}},{key:"edit-default-resource",icon:"pen",action:"edit",text:t("EDIT_DEFAULT_CONTAINER_QUOTAS"),onClick:function(){return e.trigger("project.default.resource",w(w({},e.props.match.params),{},{store:e.limitRangeStore,detail:n[0],supportGpuSelect:!0,success:function(){return e.limitRangeStore.fetchListByK8s(e.params)}}))}},{key:"delete",icon:"trash",action:"delete",text:t("DELETE_PROJECT"),onClick:function(){return e.trigger("resource.delete",{detail:r,desc:t.html("DELETE_PROJECT_TIP",{resource:r.name}),success:function(){(0,E.removeV4DashboardHistory)(globals.user.username,r.uid),a.push("/workspaces/".concat(e.params.workspace,"/projects"))}})}}];return globals.app.hasPermission({workspace:this.workspace,module:"projects",action:"manage"})&&o.splice(1,0,{key:"edit-quota",icon:"pen",action:"edit",text:t("EDIT_PROJECT_QUOTAS"),onClick:function(){return e.trigger("project.quota.edit",{detail:r,success:function(){return e.quotaStore.fetch(e.params)}})}}),this.isClusterManage&&o.splice(1,0,{key:"edit-annotations",icon:"pen",action:"manage",text:t("EDIT_ANNOTATIONS"),onClick:function(){return e.trigger("resource.annotations.edit",{detail:r,success:e.getData})}}),o}},{key:"enabledItemActions",get:function(){var e=this;return this.itemActions.filter((function(t){return(!t.action||e.enabledActions.includes(t.action))&&!t.isHidden}))}}]),r}(m.default.Component))||o)||o)||o;a.default=U},3831:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(4),r(18),r(43),r(11);var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=r(189),f=n(r(5)),p=n(r(801)),m=n(r(800)),h=n(r(26)),v=n(r(67)),_=n(r(1213)),g=n(r(0)),y=r(437),E=r(56),b=n(r(3832));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var O=function(e){(0,l.default)(r,e);var a=S(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"renderMoreMenu",value:function(){var e=this.props,t=e.actions,a=e.onMenuClick;return g.default.createElement(d.Menu,{onClick:a},t.map((function(e){return g.default.createElement(d.Menu.MenuItem,{key:e.key},g.default.createElement(d.Icon,{name:e.icon,type:"light"})," ",e.text)})))}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.workspace,n=e.serviceCount,c=e.memberCount,s=e.roleCount,l=e.actions,i=e.showDetail;return g.default.createElement(p.default,{className:(0,f.default)(b.default.wrapper,(0,o.default)({},b.default.single,!i)),title:t("PROJECT_INFO")},g.default.createElement("div",{className:b.default.header},g.default.createElement(m.default,{icon:"project",title:(0,E.getDomTitle)((0,E.getDisplayNameNew)(a)),description:t("NAME"),ellipsis:!0}),g.default.createElement("div",{className:(0,f.default)(b.default.item,"ellipsis")},g.default.createElement("div",null,g.default.createElement(y.Link,{to:"/workspaces/".concat(r),className:"ellipsis block"},(0,E.showNameAndAlias)(r,"workspace"))),g.default.createElement("p",null,t("WORKSPACE"))),g.default.createElement("div",{className:b.default.item},g.default.createElement("div",null,(0,h.default)(a,"creator")||"-"),g.default.createElement("p",null,t("CREATOR"))),g.default.createElement("div",{className:b.default.item},g.default.createElement("div",null,(0,E.getLocalTime)(a.createTime).format("YYYY-MM-DD HH:mm:ss")),g.default.createElement("p",null,t("CREATION_TIME"))),!(0,v.default)(l)&&g.default.createElement(_.default,{content:this.renderMoreMenu()})),i&&g.default.createElement("div",{className:b.default.content},g.default.createElement("div",{className:b.default.contentItem},g.default.createElement(d.Icon,{name:"appcenter",size:40}),g.default.createElement("div",{className:b.default.item},g.default.createElement("div",null,n),g.default.createElement("p",null,"1"===n?t("SERVICE"):t("SERVICE_PL")))),g.default.createElement("div",{className:b.default.contentItem},g.default.createElement(d.Icon,{name:"role",size:40}),g.default.createElement("div",{className:b.default.item},g.default.createElement("div",null,s),g.default.createElement("p",null,"1"===s?t("PROJECT_ROLE_SCAP"):t("PROJECT_ROLE_SCAP_PL")))),g.default.createElement("div",{className:b.default.contentItem},g.default.createElement(d.Icon,{name:"group",size:40}),g.default.createElement("div",{className:b.default.item},g.default.createElement("div",null,c),g.default.createElement("p",null,1===c?t("PROJECT_MEMBER_SCAP"):t("PROJECT_MEMBER_SCAP_PL"))))))}}]),r}(g.default.Component);a.default=O},3832:function(e,t,a){e.exports={wrapper:"y1eLrGpaohxMQDmsuRFMf",single:"_3rv-wCj02PzvuQG7qSSKZM",header:"_363Ff0hbZt6NBtRrxtkMAZ",item:"_2DA2psiwLtN9ceOhO9r16S",content:"nMtAhiQIHvZlW09dFBhY7",contentItem:"_2NiYmn1-SSZjJzHwbNSDOf",button:"_1mI2OrNuD9gi0be-QgMLGw"}},3833:function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(66),r(14),r(9),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(66),r(29),r(14),r(9),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=n(r(802)),m=n(r(813)),h=r(806),v=n(r(810)),_=r(56),g=r(61),y=n(r(476));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var b=(0,h.withProjectList)({store:new y.default,module:"configmaps",name:"CONFIGMAP"})(o=function(e){(0,i.default)(r,e);var a=E(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),render:function(t,a){return f.default.createElement(p.default,{icon:g.ICON_TYPES[n],iconSize:40,title:(0,_.getDisplayName)(a),desc:a.description||"-",to:"".concat(e.props.match.url,"/").concat(t),isMultiCluster:a.isFedManaged})}},{title:t("FIELDS"),dataIndex:"data",isHideable:!0,width:"33%",render:function(e){return Object.keys(e).join(",")}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:150,render:function(e){return(0,_.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("configmap.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster})},e}return(0,l.default)(r,[{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps;return f.default.createElement(h.ListPage,this.props,f.default.createElement(m.default,(0,c.default)({},t,{tabs:this.tabs})),f.default.createElement(v.default,(0,c.default)({},a,{itemActions:this.itemActions,columns:this.getColumns(),onCreate:this.showCreate,searchType:"name"})))}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return a("resource.baseinfo.edit",{detail:e})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return a("resource.yaml.edit",{detail:e})}},{key:"editConfigMap",icon:"pen",text:t("EDIT_SETTINGS"),action:"edit",onClick:function(e){return a("configmap.edit",{detail:e})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{type:r,detail:e})}}]}}]),r}(f.default.Component))||o;a.default=b},3834:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(31)),s=n(r(317)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=r(437),h=n(r(802)),v=r(806),_=n(r(813)),g=n(r(810)),y=r(56),E=r(61),b=n(r(488));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var k=(0,v.withProjectList)({store:new b.default,module:"serviceaccounts",name:"SERVICE_ACCOUNT"})(o=function(e){(0,u.default)(r,e);var a=R(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),render:function(t,a){return p.default.createElement(h.default,{icon:E.ICON_TYPES[n],iconSize:40,title:(0,y.getDisplayName)(a),desc:a.description||"-",to:"".concat(e.props.match.url,"/").concat(t),isMultiCluster:a.isFedManaged})}},{title:t("ROLE"),dataIndex:"role",isHideable:!0},{title:t("SECRET"),dataIndex:"secrets",isHideable:!0,render:function(t){return t.map((function(t){return p.default.createElement("div",null,p.default.createElement(m.Link,{to:"".concat(e.prefix,"/secrets/").concat(t.name)},t.name))}))}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:150,render:function(e){return(0,y.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module,n=t.projectStore;return e.props.trigger("serviceaccount.create",{module:r,projectDetail:n.detail,namespace:a.params.namespace,cluster:a.params.cluster})},e}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps;return p.default.createElement(v.ListPage,this.props,p.default.createElement(_.default,t),p.default.createElement(g.default,(0,s.default)({},a,{columns:this.getColumns(),itemActions:this.itemActions,onCreate:this.showCreate,searchType:"name"})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.cluster,a=e.workspace,r=e.namespace;return"".concat(a?"/".concat(a):"","/clusters/").concat(t,"/projects/").concat(r)}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.trigger,n=a.name;return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:function(t){return r("serviceaccount.edit",O({detail:t},e.props.match.params))}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return r("resource.yaml.edit",{detail:e})}},{key:"modify",icon:"pen",text:t("CHANGE_ROLE"),action:"edit",onClick:function(t){return r("serviceaccount.role.edit",O({detail:t},e.props.match.params))}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return r("resource.delete",{type:n,detail:e})}}]}}]),r}(p.default.Component))||o;a.default=k},3835:function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(14),r(9),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(29),r(14),r(9),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=n(r(802)),m=n(r(813)),h=r(806),v=n(r(810)),_=r(56),g=r(61),y=n(r(447)),E=n(r(3836));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var S=(0,h.withProjectList)({store:new y.default,module:"secrets",name:"SECRET"})(o=function(e){(0,i.default)(r,e);var a=b(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).showSetDefault=function(e){return"kubernetes.io/dockerconfigjson"===e.type&&!e.isDefault},e.getDefaultLabel=function(e,a){return a.isDefault?f.default.createElement("div",{className:E.default.titleRow},f.default.createElement("span",{className:E.default.title},e),f.default.createElement("span",{className:E.default.tag},t("DEFAULT_IMAGE_REGISTRY"))):e},e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),render:function(t,a){return f.default.createElement(p.default,{icon:g.ICON_TYPES[n],iconSize:40,title:e.getDefaultLabel((0,_.getDisplayName)(a),a),desc:a.description||"-",to:"".concat(e.props.match.url,"/").concat(t),isMultiCluster:a.isFedManaged})}},{title:t("TYPE"),dataIndex:"type",isHideable:!0,width:"24%",render:function(e){return g.SECRET_TYPES[e]?t(g.SECRET_TYPES[e]):e}},{title:t("SECRET_FIELD_COUNT"),dataIndex:"data",isHideable:!0,width:"20%",render:function(e){return Object.keys(e).length}},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:150,render:function(e){return(0,_.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.module;return e.props.trigger("secret.create",{module:r,namespace:a.params.namespace,cluster:a.params.cluster})},e}return(0,l.default)(r,[{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps;return f.default.createElement(h.ListPage,this.props,f.default.createElement(m.default,(0,c.default)({},t,{tabs:this.tabs})),f.default.createElement(v.default,(0,c.default)({},a,{itemActions:this.itemActions,columns:this.getColumns(),onCreate:this.showCreate,searchType:"name"})))}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.getData,n=a.trigger,o=a.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return n("resource.baseinfo.edit",{detail:e})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return n("resource.yaml.edit",{detail:e})}},{key:"editSecret",icon:"pen",text:t("EDIT_SETTINGS"),action:"edit",onClick:function(e){return n("secret.edit",{detail:e,success:r})}},{key:"default",icon:"star",text:t("SET_AS_DEFAULT"),action:"edit",show:this.showSetDefault,onClick:function(t){var a=e.props.match;n("secret.default",{detail:t,cluster:a.params.cluster,success:r})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return n("resource.delete",{type:o,detail:e})}}]}}]),r}(f.default.Component))||o;a.default=S},3836:function(e,t,a){e.exports={baseTag:"_2PDb7M6nc6OgOrIC5Sn3jg",titleRow:"_281TM-PGi2UlyVdRmWW2Ew",tag:"_2K1ZZc95tRXTDHms3yur8J",title:"nbmekP5IrfJL_HpfH_KOw"}},3837:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(69),r(7);var o,c=n(r(31)),s=n(r(317)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=r(17),h=n(r(802)),v=n(r(813)),_=r(806),g=n(r(810)),y=r(56),E=r(61),b=n(r(322));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var k=(0,_.withProjectList)({store:new b.default,module:"roles",name:"PROJECT_ROLE"})(o=function(e){(0,u.default)(r,e);var a=R(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).showAction=function(e){return!globals.config.presetRoles.includes(e.name)},e.getColumns=function(){var a=e.props,r=a.getSortOrder,n=a.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:r("name"),render:function(t,a){return p.default.createElement(h.default,{icon:E.ICON_TYPES[n],title:t,desc:a.aliasName,iconSize:40,to:"".concat(e.props.match.url,"/").concat(t)})}},{title:t("DESCRIPTION"),key:"description",dataIndex:"description",isHideable:!0,width:"40%"},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:r("createTime"),isHideable:!0,width:150,render:function(e){return(0,y.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},e.showCreate=function(){var t=e.props,a=t.match,r=t.getData,n=t.store;return e.props.trigger("role.create",{namespace:a.params.namespace,cluster:a.params.cluster,roleTemplates:(0,m.toJS)(n.roleTemplates.data),roleModules:(0,m.toJS)(n.roleCategory),basicRoleTemplates:(0,m.toJS)(n.basicRoleTemplates.data),success:r})},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.props.store.fetchRoleTemplates("namespace","iam.kubesphere.io/scope=namespace,iam.kubesphere.io/hidden-role-template!=true,kubesphere.io/managed=true"),this.props.store.fetchBasicRoleTemplates("namespace","iam.kubesphere.io/scope=namespace,iam.kubesphere.io/basic-role-template=true,kubesphere.io/managed=true"),this.props.store.fetchTemplatesCategory("namespace")}},{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps;return p.default.createElement(_.ListPage,(0,s.default)({},this.props,{noWatch:!0}),p.default.createElement(v.default,(0,s.default)({},a,{tabs:this.tabs,description:t("PROJECT_ROLE_DESC")})),p.default.createElement(g.default,(0,s.default)({},r,{emptyProps:this.emptyProps,tableActions:this.tableActions,itemActions:this.itemActions,columns:this.getColumns(),searchType:"name"})))}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.routing,n=a.trigger,o=a.store,c=a.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",show:this.showAction,onClick:function(e){return n("resource.baseinfo.edit",{detail:e,success:r.query})}},{key:"editRole",icon:"pen",text:t("EDIT_PERMISSIONS"),action:"edit",show:this.showAction,onClick:function(e){return n("role.edit",{detail:e,roleTemplates:(0,m.toJS)(o.roleTemplates.data),basicRoleTemplates:(0,m.toJS)(o.basicRoleTemplates.data),roleModules:(0,m.toJS)(o.roleCategory),success:r.query})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",show:this.showAction,onClick:function(t){return n("role.delete",{detail:t,type:c,cluster:e.props.match.params.cluster,namespace:e.props.match.params.namespace,success:r.query})}}]}},{key:"tableActions",get:function(){return O(O({},this.props.tableProps.tableActions),{},{onCreate:this.showCreate,selectActions:[]})}},{key:"emptyProps",get:function(){return{desc:t("PROJECT_ROLE_EMPTY_DESC")}}}]),r}(p.default.Component))||o;a.default=k},3838:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(317)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=n(r(26)),h=r(17),v=n(r(802)),_=n(r(807)),g=n(r(813)),y=r(806),E=n(r(810)),b=r(56),S=n(r(323)),O=n(r(322));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var A=(0,y.withProjectList)({store:new S.default,module:"users",authKey:"members",name:"PROJECT_MEMBER",rowKey:"username"})(o=function(e){(0,u.default)(r,e);var a=C(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).roleStore=new O.default,e.getColumns=function(){return[{title:t("NAME"),dataIndex:"username",sorter:!0,render:function(e,t){return p.default.createElement(v.default,{avatar:t.avatar_url||"/extensions-static/ks-console-embed/dist/v3dist/assets/default-user.svg",title:t.aliasName?"".concat(t.aliasName,"").concat(e,""):e,desc:t.email||"-",noLink:!0})}},{title:t("STATUS"),dataIndex:"status",isHideable:!0,width:"19%",render:function(e){return p.default.createElement(_.default,{type:e,name:t("USER_".concat(e.toUpperCase()))})}},{title:t("ROLE"),dataIndex:"role",isHideable:!0,width:"19%"},{title:t("LAST_LOGIN"),dataIndex:"lastLoginTime",isHideable:!0,width:150,render:function(e){return p.default.createElement("p",null,e?(0,b.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"):t("NOT_LOGIN_YET"))}}]},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.canViewRoles&&this.roleStore.fetchList(k(k({},this.props.match.params),{},{limit:-1}))}},{key:"showAction",value:function(e){return globals.user.username!==e.name}},{key:"render",value:function(){var e=this.props,a=e.bannerProps,r=e.tableProps;return p.default.createElement(y.ListPage,(0,c.default)({},this.props,{noWatch:!0}),p.default.createElement(g.default,(0,c.default)({},a,{tabs:this.tabs,description:t("PROJECT_MEMBER_DESC")})),p.default.createElement(E.default,(0,c.default)({},r,{searchType:"name",tableActions:this.tableActions,itemActions:this.itemActions,columns:this.getColumns()})))}},{key:"canViewRoles",get:function(){return globals.app.hasPermission(k(k({},this.props.match.params),{},{project:this.props.match.params.namespace,module:"roles",action:"view"}))}},{key:"tips",get:function(){return[{title:t("HOW_TO_INVITE_MEMBER_Q"),description:t("HOW_TO_INVITE_MEMBER_A")}]}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.getData,n=a.trigger;return[{key:"modify",icon:"pen",text:t("CHANGE_ROLE"),action:"edit",show:this.showAction,onClick:function(t){return n("member.edit",k(k({detail:t},e.props.match.params),{},{roles:(0,h.toJS)(e.roleStore.list.data),role:t.role,success:r}))}},{key:"delete",icon:"trash",text:t("REMOVE"),action:"delete",show:this.showAction,onClick:function(t){return n("member.remove",k({detail:t,success:r},e.props.match.params))}}]}},{key:"tableActions",get:function(){var e=this,a=this.props,r=a.routing,n=a.getData,o=a.trigger;return k(k({},a.tableProps.tableActions),{},{actions:[{key:"invite",type:"control",text:t("INVITE"),action:"create",onClick:function(){return o("member.invite",k(k({},e.props.match.params),{},{roles:(0,h.toJS)(e.roleStore.list.data),roleModule:e.roleStore.module,workspace:(0,m.default)(e.props,"projectStore.detail.workspace"),title:t("INVITE_MEMBER"),desc:t("INVITE_MEMBER_DESC"),searchPlaceholder:t("SEARCH_BY_NAME"),success:r.query}))}}],selectActions:[{key:"delete",type:"danger",text:t("REMOVE"),action:"delete",onClick:function(){return o("member.remove.batch",k({success:n},e.props.match.params))}}],getCheckboxProps:function(t){return{disabled:!e.showAction(t),name:t.name}},emptyProps:{desc:t("PROJECT_MEMBER_EMPTY_DESC")}})}}]),r}(p.default.Component))||o;a.default=A},3839:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1537)),o=r(a(1553)),c=r(a(1554)),s=r(a(1555)),l=r(a(1558)),i=r(a(1567)),u=r(a(1572)),d=r(a(1559)),f=r(a(1561)),p=r(a(1574)),m=r(a(1563)),h=r(a(1564)),v=r(a(1565)),_=r(a(3840)),g=r(a(3922)),y=r(a(3930)),E=r(a(4030)),b=r(a(4036)),S=r(a(4038)),O=r(a(4058));t.default=function(e){return[{path:"".concat(e,"/deployments/:name"),component:n.default},{path:"".concat(e,"/statefulsets/:name"),component:o.default},{path:"".concat(e,"/daemonsets/:name"),component:c.default},{path:"".concat(e,"/jobs/:name"),component:s.default},{path:"".concat(e,"/cronjobs/:name"),component:l.default},{path:"".concat(e,"/pods/:podName/containers/:containerName"),component:u.default},{path:"".concat(e,"/pods/:podName"),component:i.default},{path:"".concat(e,"/services/:name"),component:d.default},{path:"".concat(e,"/ingresses/:name"),component:f.default},{path:"".concat(e,"/volumes/:name"),component:p.default},{path:"".concat(e,"/secrets/:name"),component:m.default},{path:"".concat(e,"/configmaps/:name"),component:h.default},{path:"".concat(e,"/serviceAccounts/:name"),component:v.default},{path:"".concat(e,"/composing/:name"),component:_.default},{path:"".concat(e,"/applications/template/:id"),component:g.default},{path:"".concat(e,"/applications/database/:id"),component:y.default},{path:"".concat(e,"/applications/others/:name"),component:E.default},{path:"".concat(e,"/roles/:name"),component:b.default},{path:"".concat(e,"/project-roles/:name"),component:b.default},{path:"".concat(e,"/s2ibuilders/:name"),component:S.default},{path:"".concat(e,"/custom-scaling/:name"),component:O.default}]}},3840:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(317)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=r(17),h=r(243),v=n(r(26)),_=n(r(67)),g=r(189),y=r(56),E=r(804),b=n(r(1012)),S=n(r(807)),O=n(r(834)),R=n(r(3841));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var T=(0,h.inject)("rootStore")(o=(0,h.observer)(o=(0,E.trigger)(o=function(e){(0,u.default)(r,e);var a=A(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).store=new b.default,e.fetchData=function(){var t=e.props.match.params;e.store.fetchDetail(t)},e.getOperations=function(){return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(){return e.trigger("resource.baseinfo.edit",{type:e.name,detail:(0,m.toJS)(e.store.detail),success:e.fetchData})}},{key:"addComponent",icon:"add",text:t("ADD_SERVICE"),action:"edit",onClick:function(){return e.trigger("crd.app.addservice",C({success:e.fetchComponents,detail:(0,m.toJS)(e.store.detail)},e.props.match.params))}},{key:"addRoute",icon:"add",text:t("ADD_ROUTE"),action:"edit",onClick:function(){return e.trigger("crd.app.addroute",C({success:e.fetchData,detail:(0,m.toJS)(e.store.detail)},e.props.match.params))}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",type:"danger",onClick:function(){return e.trigger("resource.delete",{type:e.name,detail:e.store.detail,success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var a=(0,m.toJS)(e.store.detail),r=e.props.match.params,n=r.cluster,o=r.namespace;if(!(0,_.default)(a))return[{name:t("CLUSTER"),value:(0,y.showNameAndAlias)(n,"cluster")},{name:t("PROJECT"),value:(0,y.showNameAndAlias)(o,"project")},{name:t("STATUS"),value:p.default.createElement(S.default,{name:t(a.status),type:a.status})},{name:t("VERSION"),value:a.version},{name:t("CREATION_TIME_TCAP"),value:(0,y.getLocalTime)(a.createTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("UPDATE_TIME_TCAP"),value:(0,y.getLocalTime)(a.updateTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:a.creator},{name:t("APPLICATION_GOVERNANCE_SCAP"),value:"true"===(0,v.default)(a,'annotations["servicemesh.kubesphere.io/enabled"]')?t("ON"):t("OFF")}]},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e={detailStore:this.store};if(this.store.isLoading&&!this.store.detail.name)return p.default.createElement(g.Loading,{className:"ks-page-loading"});var a={module:this.module,name:(0,y.getDisplayName)(this.store.detail),desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("APP_PL"),url:this.listUrl}]};return p.default.createElement(O.default,(0,c.default)({stores:e},a,{routes:R.default}))}},{key:"module",get:function(){return"applications"}},{key:"name",get:function(){return"APP"}},{key:"listUrl",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r,"/composing")}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),r}(p.default.Component))||o)||o)||o;a.default=T},3841:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(318),o=r(a(3842)),c=r(a(3849)),s=r(a(3873)),l=r(a(3909)),i="/:workspace/clusters/:cluster/projects/:namespace/composing/:name",u=[{path:"".concat(i,"/components"),title:"RESOURCE_STATUS",component:o.default,exact:!0},{path:"".concat(i,"/traffic"),title:"TRAFFIC_MONITORING",component:c.default,clusterModule:"servicemesh",exact:!0},{path:"".concat(i,"/grayrelease"),title:"GRAYSCALE_RELEASE",component:s.default,clusterModule:"servicemesh",exact:!0},{path:"".concat(i,"/tracing"),title:"TRACING",component:l.default,clusterModule:"servicemesh",exact:!0},(0,n.getIndexRoute)({path:i,to:"".concat(i,"/components"),exact:!0})];t.default=u},3842:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(30),a(11),a(69);var n,o=r(a(25)),c=r(a(28)),s=r(a(41)),l=r(a(42)),i=r(a(37)),u=r(a(0)),d=a(243),f=r(a(1229)),p=r(a(1074)),m=r(a(1230)),h=r(a(1231)),v=r(a(3848));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var g=(0,d.inject)("detailStore")(n=(0,d.observer)(n=function(e){(0,s.default)(a,e);var t=_(a);function a(e){var r;return(0,o.default)(this,a),(r=t.call(this,e)).store=e.detailStore,r.module=e.module,r}return(0,c.default)(a,[{key:"render",value:function(){var e=this.store.detail,t=e.cluster,a=e.namespace,r=e.selector;return u.default.createElement("div",{className:v.default.main},u.default.createElement(m.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(f.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(p.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(h.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r)}}]),a}(u.default.Component))||n)||n;t.default=g},3843:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(26)),d=n(r(0)),f=n(r(1)),p=r(437),m=n(r(5)),h=r(189),v=n(r(800)),_=n(r(3844)),g=r(56),y=n(r(1608));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var b=function(e){(0,s.default)(r,e);var a=E(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.className,r=e.detail,n=e.prefix;if(!r)return null;var o=(0,u.default)(r,"monitor.name"),c=(0,g.getDisplayName)(r);return d.default.createElement("div",{className:(0,m.default)(y.default.item,a)},d.default.createElement(v.default,{icon:"network-router",title:d.default.createElement(d.default.Fragment,null,d.default.createElement(p.Link,{to:"".concat(n,"/services/").concat(r.name)},c),o&&d.default.createElement(h.Tooltip,{content:t("MONITORING_EXPORTER_VALUE",{value:o})},d.default.createElement(h.Icon,{className:"margin-l8",name:"monitor",size:20}))),description:t(r.type)}),d.default.createElement(_.default,{data:r}))}}]),r}(d.default.Component);a.default=b,b.propTypes={className:f.default.string,prefix:f.default.string,detail:f.default.object},b.defaultProps={prefix:"",detail:{}}},3844:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(66),r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.data;if("ClusterIP"===a.specType)return o.default.createElement(c.default,{description:t("VIRTUAL_IP_ADDRESS"),title:a.clusterIP});if("NodePort"===a.specType)return o.default.createElement(c.default,{description:t("PORT_PL"),title:a.ports.filter((function(e){return e.nodePort})).map((function(e){return"".concat(e.port,":").concat(e.nodePort,"/").concat(e.protocol)})).join("; ")});if("LoadBalancer"===a.specType)return o.default.createElement(c.default,{description:a.loadBalancerIngress.length>1?t("LOAD_BALANCERS_SCAP"):t("LOAD_BALANCER_SCAP"),title:a.loadBalancerIngress.join("; ")});return o.default.createElement(c.default,{description:a.specType,title:a.externalName})},r(3),r(10),r(66),r(20),r(4);var o=n(r(0)),c=n(r(800))},3845:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(6),r(70),r(66),r(20),r(14),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(6),r(70),r(66),r(20),r(14),r(4),r(73),r(7);var o=n(r(26)),c=n(r(67)),s=n(r(0)),l=n(r(1)),i=r(437),u=r(189),d=r(56),f=n(r(3846)),p=function(e){var a=e.detail,r=e.gateway,n=e.prefix,l={},p=(0,o.default)(r,"service",[]);if((0,c.default)(p)||null==p||p.forEach((function(e){"http"===e.name&&80!==e.nodePort&&(l.http=e.nodePort),"https"===e.name&&443!==e.nodePort&&(l.https=e.nodePort)})),(0,c.default)(a.rules))return null;var m=a.tls||[],h=(0,d.getDisplayName)(a);return s.default.createElement("div",{className:f.default.card},s.default.createElement("div",{className:f.default.content},s.default.createElement(u.Icon,{name:"loadbalancer",size:40}),s.default.createElement("div",{className:f.default.text},s.default.createElement(i.Link,{to:"".concat(n,"/ingresses/").concat(a.name)},h),s.default.createElement("p",null,t("DOMAIN_NAME_VALUE",{value:a.rules.map((function(e){return e.host})).join(", ")})))),s.default.createElement("ul",{className:f.default.rules},a.rules.map((function(e){var a=m.hosts&&m.hosts.includes(e.host)?"https":"http",r="".concat(a,"://").concat(e.host);return l[a]&&(r="".concat(r,":").concat(l[a])),e.http.paths.map((function(a){return s.default.createElement("li",{key:"".concat(e.host).concat(a.path)},s.default.createElement("span",null,"URL:"),s.default.createElement("span",null,s.default.createElement("strong",null,r,a.path)),s.default.createElement("a",{href:"".concat(r).concat(a.path),target:"_blank",rel:"noreferrer noopener"},s.default.createElement(u.Button,{className:f.default.access},t("ACCESS_SERVICE"))))}))}))))};p.propTypes={rule:l.default.object};var m=p;a.default=m},3846:function(e,t,a){e.exports={card:"_1cG8fQKm3-Tkqa6zrOyoAt",content:"_2K1EVvQAkTRqBliWP9y_UW",text:"_1y1LWjMboGREreksS8-Bre",rules:"_2flmPvDu28-zUq_VX5ZqEy",access:"yZPxinr4XZvaHAzm7Wr-V",empty:"NmU26TG_b_FLHQfw9ynFW"}},3847:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(317));r(3),r(20),r(14);var c=n(r(26)),s=n(r(0)),l=n(r(1)),i=r(437),u=n(r(800)),d=n(r(1609)),f=function(e){var a=e.volume,r=e.prefix,n=t("STORAGE_CLASS_VALUE",{value:(0,c.default)(a,"storageClassName","-")}),l=[{title:(0,c.default)(a,"capacity","-"),description:t("CAPACITY")},{title:(0,c.default)(a,"accessMode","-"),description:t("ACCESS_MODE_TCAP")}];return s.default.createElement("div",{className:d.default.item},s.default.createElement(u.default,{icon:"storage",title:s.default.createElement(i.Link,{to:"".concat(r,"/volumes/").concat(a.name)},a.name),description:n}),l.map((function(e,t){return s.default.createElement(u.default,(0,o.default)({key:t},e))})))};f.propTypes={container:l.default.object};var p=f;a.default=p},3848:function(e,t,a){e.exports={ports:"_1pZVLp9qAjWNtg0beO2Nnr",card:"_21H0IPfRMqfBUSQXZqjFaQ",content:"_1g_x-Rf6m671ilDIqQ7dij",title:"_3wM7e49lglrGDX6Nvyt8Fb",path:"_1AKuvdVsWBs2vcilYDQefn",access:"_2TU8aTcZX_e1mhZBihzVpA"}},3849:function(e,a,r){"use strict";r(16);var n=r(19);r(14),r(4),r(18),r(30),r(11),r(69),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(69),r(110);var o,c=n(r(50)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(67)),p=n(r(0)),m=r(243),h=r(189),v=n(r(844)),_=n(r(954)),g=r(847),y=n(r(3850)),E=n(r(3872));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var S=(0,m.inject)("detailStore")(o=(0,m.observer)(o=function(e){(0,i.default)(r,e);var a=b(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).handleRefresh=function(){n.getData()},n.handleAutoFetch=function(){var e=n.state.autoFetch;n.setState({autoFetch:!e},(function(){n.state.autoFetch?n.interval=setInterval((function(){n.getData()}),1e4):n.interval&&clearInterval(n.interval)}))},n.handleLookbackChange=function(e){var t=e.step,a=e.times,r=(0,c.default)(e,["step","times"]),o=(0,g.getTimeRange)({step:(0,g.getMinuteValue)(t),times:a}),s=o.start,l=o.end,i=r.start||s,u=r.end||l,d=Math.floor(u-i);n.setState({duration:d},(function(){n.getData()}))},n.operations=function(){var e=n.state.autoFetch;return p.default.createElement("div",{className:E.default.operations},p.default.createElement(_.default,{className:E.default.timeSelect,onChange:n.handleLookbackChange,showStep:!1,dark:!0,arrowIcon:"chevron-down",step:"1m",times:1}),p.default.createElement(h.Button,{type:"flat",icon:e?"pause":"start",onClick:n.handleAutoFetch}),p.default.createElement(h.Button,{type:"flat",icon:"refresh",onClick:n.handleRefresh}))},n.renderHeader=function(){return p.default.createElement("div",{className:E.default.cardHeader},n.operations(),t("TRAFFIC_MONITORING"))},n.state={isGraphLoading:!0,duration:60,autoFetch:!1},n.store=e.detailStore,n.module=e.module,n}return(0,l.default)(r,[{key:"componentDidMount",value:function(){this.getData()}},{key:"componentWillUnmount",value:function(){this.unmount=!0,this.interval&&clearInterval(this.interval)}},{key:"getData",value:function(){var e=this,t=this.props.match.params,a=t.cluster,r=t.namespace,n=t.name,o=this.state.duration;this.setState({isGraphLoading:!0}),this.store.fetchGraph({cluster:a,namespace:r,app:n,duration:o}).then((function(){e.unmount||e.setState({isGraphLoading:!1})}))}},{key:"renderContent",value:function(){var e=this.state.isGraphLoading,a=this.store.graph,r=a.data,n=a.health;return(0,f.default)(r)||(0,f.default)(r.nodes)?e?p.default.createElement(h.Loading,{className:E.default.loading}):p.default.createElement(v.default,{className:E.default.emptyList,image:"/extensions-static/ks-console-embed/dist/v3dist/assets/traffic-management.svg",title:t("NO_DATA"),desc:t("TRAFFIC_MONITORING_UNAVAILABLE_DESC")}):p.default.createElement("div",{className:E.default.main},p.default.createElement(y.default,{className:E.default.graph,data:r,health:n,store:this.store,loading:e,onFetch:this.handleRefresh}))}},{key:"render",value:function(){return p.default.createElement(p.default.Fragment,null,this.renderHeader(),this.renderContent())}}]),r}(p.default.Component))||o)||o;a.default=S},3850:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(44),a(70),a(20),a(14),a(4),a(18),a(11),a(73),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(44),a(70),a(20),a(29),a(14),a(4),a(18),a(43),a(11),a(73);var n=r(a(31)),o=r(a(58)),c=r(a(25)),s=r(a(28)),l=r(a(41)),i=r(a(42)),u=r(a(37)),d=r(a(0)),f=r(a(1)),p=r(a(5)),m=r(a(830)),h=a(189),v=a(461),_=r(a(1150)),g=a(3851),y=r(a(3852)),E=r(a(3854)),b=r(a(3858)),S=r(a(3871));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var R=function(e){(0,l.default)(a,e);var t=O(a);function a(e){var r;return(0,c.default)(this,a),(r=t.call(this,e)).handleWrapperClick=function(e){if(e&&null===(0,v.findParent)(e.target,"ks-app-component")&&"app"===r.state.selectedType){var t=r.draggerRef.current.content.querySelector("[data-component='".concat(r.state.selectedData.name,"']"));t&&!t.contains(e.target)&&r.setState({selectedData:{},selectedType:"",selectedEdges:[]})}},r.toggleFullScreen=function(){r.setState((function(e){return{fullScreen:!e.fullScreen}}))},r.handleRefresh=function(){r.props.onFetch()},r.handleSelect=function(e,t){r.setState({selectedData:e,selectedType:t,selectedEdges:[].concat((0,o.default)(e.edges.in.map((function(e){return e.data.id}))),(0,o.default)(e.edges.out.map((function(e){return e.data.id}))))})},r.state={graph:(0,g.processData)(e.data,e.health),selectedData:{},selectedEdges:[],selectedType:"",fullScreen:!1},r.draggerRef=d.default.createRef(),r}return(0,s.default)(a,[{key:"getChildContext",value:function(){return{selectedData:this.state.selectedData,selectedType:this.state.selectedType,onSelectApp:this.handleSelect}}}]),(0,s.default)(a,[{key:"componentDidUpdate",value:function(e){var t=this;if(!(0,m.default)(this.props.data,e.data)||!(0,m.default)(this.props.health,e.health)){var a=(0,g.processData)(this.props.data,this.props.health);if(this.setState({graph:a}),this.state.selectedData&&this.state.selectedData.name){var r=a.nodes.find((function(e){return e.name===t.state.selectedData.name}));this.setState({selectedData:r})}}}},{key:"render",value:function(){var e=this.props,t=e.store,a=e.loading,r=e.className,o=this.state,c=o.graph,s=o.selectedType,l=o.selectedData,i=o.selectedEdges,u=o.fullScreen;return d.default.createElement("div",{className:(0,p.default)(r,S.default.graph,(0,n.default)({},S.default.fullScreen,u))},d.default.createElement("div",{className:S.default.loading},d.default.createElement(h.Loading,{spinning:a})),d.default.createElement(_.default,{className:S.default.dragger,contentClassName:S.default.mainContent,ref:this.draggerRef,onClick:this.handleWrapperClick,initialScale:.6,onFullScreen:this.toggleFullScreen,controlStyle:{right:s?420:20},onRefresh:this.handleRefresh},d.default.createElement("div",{className:S.default.graphContent},c.nodes.map((function(e){return d.default.createElement(E.default,{key:e.name,data:e})})),d.default.createElement("svg",{className:S.default.edgeWrapper},c.edges.map((function(e){return d.default.createElement(y.default,{key:e.data.id,data:e,selected:i.includes(e.data.id)})}))))),s&&d.default.createElement(b.default,{className:S.default.detail,type:s,data:l,store:t,fullScreen:u}))}}]),a}(d.default.Component);t.default=R,R.propTypes={data:f.default.shape({nodes:f.default.arrayOf(f.default.object),edges:f.default.arrayOf(f.default.object)}),health:f.default.object},R.defaultProps={data:{nodes:[],edges:[]},health:{}},R.childContextTypes={wrapperRef:f.default.object,selectedData:f.default.object,selectedType:f.default.string,onSelectApp:f.default.func}},3851:function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(44),a(6),a(70),a(88),a(20),a(14),a(24),a(193),a(8),a(13),a(9),a(190),a(73),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.processEdges=t.processData=void 0;var n=r(a(31));a(12),a(10),a(44),a(6),a(70),a(88),a(20),a(27),a(14),a(24),a(193),a(33),a(16),a(8),a(13),a(9),a(4),a(190),a(73),a(7);var o=r(a(26)),c=r(a(68)),s=r(a(67)),l=r(a(845)),i=r(a(326)),u=r(a(1600));function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={rankdir:"LR",nodesep:"60",ranksep:"240"};t.processData=function(e,t){return e&&e.edges&&(e.edges=m(e.edges)),function(e){var t=new u.default.graphlib.Graph({multigraph:!0,compound:!0});t.setGraph(p),t.setDefaultEdgeLabel((function(){return{}})),t.setDefaultNodeLabel((function(){return{}}));var a=(0,i.default)(e,"name"),r={};e.forEach((function(a){var n=a.nodes.filter((function(e){return e.data.workload})),o=203*n.length+12*(n.length-1)+56,c=-1!==a.name.indexOf("kubesphere")||"unknown"===a.name;c&&(o=52),n.length>0&&t.setNode(a.name,{name:a.name,width:226,height:o,workloadNum:n.length,isGateway:c}),a.workloads=n,a.edges.out.forEach((function(n){var o=e.find((function(e){return e.ids.includes(n.data.target)}));o&&o.name&&(t.setEdge(a.name,o.name,{id:n.data.id,out:a.edges.out,name:a.name,targetName:o.name}),r[n.data.id]=n)}))})),u.default.layout(t);var n=[],o=[];return t.nodes().forEach((function(e){var r=t.node(e);r.workloadNum>1&&(r.y-=110*(r.workloadNum-1)),n.push(f(f({},a[e]),{},{position:r}))})),t.edges().forEach((function(e){var n=t.edge(e),c=t.node(n.name),s=t.node(n.targetName),l=r[n.id],i=n.out.filter((function(e){return e.data.target===l.data.target})),u=n.points.length;if(u>0)if(3===u&&(n.points=[n.points[0],n.points[u-1]],u=n.points.length),c.isGateway)o.push(f(f({},l),{},{position:{points:[{x:c.x+c.width+-20,y:c.y+c.height/2+36},{x:s.x,y:s.y+s.height/2+36}]}}));else{var d=a[n.name].workloads.map((function(e){return e.data.id}));i.forEach((function(e){var t=d.indexOf(e.data.source),a={points:[{x:c.x+c.width,y:c.y+220*(t+.5)+36},{x:s.x,y:s.y+s.height/2+30*(t+1)}]};o.push(f(f({},e),{},{position:a}))}))}})),{nodes:n,edges:o}}(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.nodes,a=void 0===t?[]:t,r=e.edges,n=void 0===r?[]:r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,s.default)(a))return[];for(var c=[],i={},u=0;u<a.length;u++)a[u].data.isRoot&&c.push(a[u]),i[a[u].data.id]=a[u];var d=[],f=(0,l.default)(a,"data.app");return Object.keys(f).forEach((function(e){for(var t=f[e],a=t.map((function(e){return e.data.id})),r=[],c=[],s=[],l=0;l<n.length;l++){var i=n[l],u=i.data,p=u.source,m=u.target;a.includes(p)&&a.includes(m)?s.push(i):!a.includes(p)&&a.includes(m)?r.push(i):a.includes(p)&&!a.includes(m)&&c.push(i)}d.push({name:e,ids:a,nodes:t,health:o[e]||{},edges:{in:r,out:c,inner:s}})})),d}(e,t))};var m=function(e){if((0,s.default)(e))return[];var t={};return e.forEach((function(e){if(t[e.data.id]){var a=(0,o.default)(t[e.data.id],"data.traffic",{}),r=(0,o.default)(e,"data.traffic",{});if("tcp"===a.protocol||"tcp"===r.protocol){var n=Number((0,o.default)(a,"rates.tcp",0)),s=Number((0,o.default)(r,"rates.tcp",0));(0,c.default)(a,"rates.tcp",(n+s).toFixed(2))}}else t[e.data.id]=e})),Object.values(t)};t.processEdges=m},3852:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(70),a(88),a(87),a(24),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(70),a(88),a(87),a(29),a(24),a(4),a(18),a(43),a(11);var n=r(a(31)),o=r(a(97)),c=r(a(25)),s=r(a(28)),l=r(a(41)),i=r(a(42)),u=r(a(37)),d=r(a(0)),f=r(a(5)),p=r(a(26)),m=r(a(163)),h=r(a(3853));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=function(e){(0,l.default)(a,e);var t=v(a);function a(e){var r;return(0,c.default)(this,a),(r=t.call(this,e)).handleMouseover=function(){var e=r.props.data;document.getElementById(e.data.id).classList.add(h.default.selected)},r.handleMouseout=function(){var e=r.props.data;document.getElementById(e.data.id).classList.remove(h.default.selected)},r.getStatus=function(){var e=r.props.data,t=(0,p.default)(e,"data.traffic");if(!t||!t.rates)return"nodata";if(t.rates.tcp>0)return"tcpActive";var a=0,n=0;return t.rates.http>0?(a=Number(t.rates.http),n=t.rates.httpPercentErr>0?Number(t.rates.httpPercentErr):0):t.rates.grpc>0&&(a=Number(t.rates.grpc),n=t.rates.grpcPercentErr>0?Number(t.rates.grpcPercentErr):0),0===a?"nodata":n>20?"error":n>.1?"degrade":"active"},r.getPath=function(){var e,t=r.props.data;if(t.position.points.length<=2){var a=(0,o.default)(t.position.points,2),n=a[0],c=a[1],s=(n.x+c.x)/2,l=(c.y-n.y)/4;e="M".concat(n.x,",").concat(n.y," C").concat(s,",").concat(n.y+l," ").concat(s,",").concat(c.y-l," ").concat(c.x,",").concat(c.y)}else e=t.position.points.reduce((function(e,t){return""===e?"M".concat(t.x,",").concat(t.y):-1!==e.indexOf("C")?"".concat(e,", ").concat(t.x," ").concat(t.y):"".concat(e," C").concat(t.x," ").concat(t.y)}),"");return e},r.hoverRef=d.default.createRef(),r}return(0,s.default)(a,[{key:"componentDidMount",value:function(){this.hoverRef.current&&(this.hoverRef.current.addEventListener("mouseover",this.handleMouseover),this.hoverRef.current.addEventListener("mouseout",this.handleMouseout))}},{key:"componentWillUnmount",value:function(){this.hoverRef.current&&(this.hoverRef.current.removeEventListener("mouseover",this.handleMouseover),this.hoverRef.current.removeEventListener("mouseout",this.handleMouseout))}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.selected,r=this.getPath(),o=this.getStatus(),c=(0,f.default)(h.default.path,h.default[o],(0,n.default)({},h.default.selected,a)),s=(0,f.default)(h.default.marker,h.default[o]);return d.default.createElement("g",null,d.default.createElement("defs",null,d.default.createElement("marker",{id:"triangle-".concat(o),viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},d.default.createElement("path",{d:"M 0 0 L 10 5 L 0 10 z",className:s})),d.default.createElement("marker",{id:"dot-".concat(o),viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5"},d.default.createElement("circle",{cx:"5",cy:"5",r:"5",className:s}))),d.default.createElement("path",{className:c,id:t.data.id,d:r,markerStart:"url(#dot-".concat(o,")"),markerEnd:"url(#triangle-".concat(o,")")}),d.default.createElement("path",{ref:this.hoverRef,d:r,fill:"none",stroke:"transparent",strokeWidth:"30"}),["active","tcpActive"].includes(o)&&d.default.createElement("circle",{r:"6",className:s},d.default.createElement("animateMotion",{dur:"6s",repeatCount:"indefinite"},d.default.createElement("mpath",{xlinkHref:"#".concat(t.data.id)}))),d.default.createElement("text",{width:"500",className:s,transform:"translate(0 -20)"},d.default.createElement("textPath",{xlinkHref:"#".concat(t.data.id),startOffset:"50%",textAnchor:"middle"},this.traffic)))}},{key:"traffic",get:function(){var e=this.props.data,t=(0,p.default)(e,"data.traffic"),a=(0,p.default)(t,"rates.tcp");if(!(0,m.default)(a))return"".concat(a," B/s");var r=(0,p.default)(t,"rates.http",0);return"".concat(r," RPS")}}]),a}(d.default.Component);t.default=_},3853:function(e,t,a){e.exports={path:"f-qkOuFPRte0_-Z7QO_at",error:"C5K1TNQ2EeQCuscsvuVBr",active:"q8TR7qYUjNW5At4k1uzji",tcpActive:"_3s88I6Eoh7DqzdiCvZUuG9",selected:"_3Y5xaV3Vvhnr7rlXGL7l8q",marker:"_3q-X0_f1j8nrDn4cbDKE9b"}},3854:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(87),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(87),r(29),r(14),r(4),r(18),r(43),r(11);var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=n(r(1)),p=n(r(26)),m=n(r(326)),h=n(r(845)),v=n(r(5)),_=n(r(3855)),g=n(r(3857));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var E=function(e){(0,l.default)(r,e);var a=y(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleClick=function(){var t=e.props.data;(0,e.context.onSelectApp)(t,"app")},e}return(0,s.default)(r,[{key:"render",value:function(){var e,a=this.props,r=a.data,n=a.store,c=this.context,s=c.selectedData,l=c.selectedType;if(!r.nodes)return null;var i=(0,h.default)(r.nodes,(function(e){return"unknown"===e.data.nodeType?"app":e.data.nodeType})),u=(0,p.default)(i,"service.length")>0,f=(0,p.default)(r,"health.workloadStatuses",[]).reduce((function(e,t){return e+(t.replicas||t.availableReplicas||0)}),0),y=(0,p.default)(r,"health.workloads",{}),E=(0,m.default)((0,p.default)(r,"edges.inner",[]),"data.target");return d.default.createElement("div",{className:"ks-app-component",onClick:u?this.handleClick:null,"data-component":r.name,style:{position:"absolute",top:r.position.y,left:r.position.x,zIndex:2}},u&&d.default.createElement("p",{className:g.default.title},r.name),d.default.createElement("div",{className:(0,v.default)((e={},(0,o.default)(e,g.default.group,u),(0,o.default)(e,g.default.selected,"app"===l&&s.name===r.name),(0,o.default)(e,g.default.error,(0,p.default)(r,"health.requests.errorRatio")>0||(0,p.default)(r,"health.service.requests.errorRatio")>0),e))},u&&d.default.createElement("p",{className:g.default.pods},d.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/health.svg",alt:""}),t("PODS"),": ",f),i.service&&i.service.map((function(e){return d.default.createElement("div",{key:e.data.id,"data-service":e.data.service,"data-service-id":e.data.id})})),i.app&&i.app.map((function(e){return d.default.createElement(_.default,{className:g.default.app,key:e.data.id,data:e.data,edge:E[e.data.id],health:y[e.data.workload],inGroup:u,store:n})}))))}}]),r}(d.default.Component);a.default=E,E.propTypes={data:f.default.object},E.contextTypes={selectedData:f.default.object,selectedType:f.default.string,onSelectApp:f.default.func}},3855:function(e,a,r){"use strict";r(16);var n=r(19);r(88),r(193),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(88),r(29),r(193),r(4),r(18),r(43),r(11);var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(26)),f=n(r(0)),p=n(r(1)),m=n(r(5)),h=r(189),v=n(r(3856));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=function(e){(0,l.default)(r,e);var a=_(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"renderHTTPMetrics",value:function(){var e=this.props,a=e.health,r=e.edge,n=(0,d.default)(a,"requests.errorRatio"),o=(0,d.default)(r,"data.traffic.rates.http",0),c=-1===n?NaN:(100-n).toFixed(2),s=(0,d.default)(r,"data.responseTime",NaN);return f.default.createElement("div",{className:v.default.detail},f.default.createElement("p",null,f.default.createElement(h.Icon,{name:"changing-over",size:16})," ","".concat(o," RPS")),f.default.createElement("p",null,f.default.createElement(h.Icon,{name:"check",size:16})," ",isNaN(c)?t("NO_DATA_SCAP"):"".concat(c,"%")),f.default.createElement("p",null,f.default.createElement(h.Icon,{name:"timed-task",size:16})," ",isNaN(s)||"0"===s?t("NO_DATA_SCAP"):"".concat(s," ms")),f.default.createElement("p",null,f.default.createElement(h.Icon,{name:"pod",size:16})," ",(0,d.default)(a,"workloadStatus.available")||(0,d.default)(a,"workloadStatus.availableReplicas")," ","/"," ",(0,d.default)(a,"workloadStatus.replicas")||(0,d.default)(a,"workloadStatus.desiredReplicas")))}},{key:"renderTCPMetrics",value:function(){var e=this.props,a=e.data,r=e.health,n=(0,d.default)(a,"traffic[0].rates.tcpIn"),o=(0,d.default)(a,"traffic[0].rates.tcpOut");return f.default.createElement("div",{className:v.default.detail},f.default.createElement("p",null,f.default.createElement(h.Icon,{name:"next",size:16})," ",isNaN(n)?t("NO_DATA_SCAP"):"".concat(n," B/s")),f.default.createElement("p",null,f.default.createElement(h.Icon,{name:"previous",size:16})," ",isNaN(o)?t("NO_DATA_SCAP"):"".concat(o," B/s")),f.default.createElement("p",null,f.default.createElement(h.Icon,{name:"pod",size:16})," ",(0,d.default)(r,"workloadStatus.availableReplicas")," /"," ",(0,d.default)(r,"workloadStatus.desiredReplicas")))}},{key:"renderDetail",value:function(){var e=this.props.edge;return"http"===((0,d.default)(e,"data.traffic.protocol")||"http")?this.renderHTTPMetrics():this.renderTCPMetrics()}},{key:"render",value:function(){var e=this.props,a=e.data,r=e.health,n=e.className,c=e.inGroup;if(-1!==a.app.indexOf("kubesphere")||"unknown"===a.app)return f.default.createElement("div",{className:(0,m.default)(v.default.card,n),"data-workload":a.workload,"data-workload-id":a.id,"data-group":c},f.default.createElement("div",{className:v.default.type},t("TRAFFIC_ENTRY")),f.default.createElement("div",{className:v.default.wrapper},f.default.createElement("div",{className:v.default.gatewayName},f.default.createElement(h.Icon,{name:"project",size:16}),a.targetNamespace)));var s=(0,d.default)(r,"requests.errorRatio");return f.default.createElement("div",{className:(0,m.default)(v.default.card,n,(0,o.default)({},v.default.error,s>0)),"data-workload":a.workload,"data-workload-id":a.id,"data-group":c},f.default.createElement("div",{className:v.default.type},a.hasCB&&f.default.createElement(h.Icon,{name:"thunder",type:"light"}),t("DEPLOYMENT")),f.default.createElement("div",{className:v.default.wrapper},this.renderDetail(),f.default.createElement("div",{className:v.default.workload},f.default.createElement("span",null,t("DEPLOYMENT")),f.default.createElement("span",null,a.workload))))}}]),r}(f.default.PureComponent);a.default=g,g.propTypes={data:p.default.object,health:p.default.object,edge:p.default.object},g.defaultProps={data:{},health:{},edge:{}}},3856:function(e,t,a){e.exports={card:"_3UtyX1TwsMA4J5_I9azhk4",error:"_1f5z3cAVlVjSxozltEiLWa",type:"_3ig_hBH8qoAHkvUzs_7XPE",wrapper:"_2-NCjQfg1O19iTRk90LKv",detail:"_3Rb35sVDvzSTfvK_EvU8E6",gatewayName:"-s8vbKJS6TAxA3e75lQyx",workload:"_3hKVcpsaMemXWCdKAFDatc"}},3857:function(e,t,a){e.exports={title:"vt11zKMrFCOLash0CtDuq",app:"_2VIFmapZqEet3i4h8IcfoT",group:"GBv7IxeMCUzEwP37i9ruG",selected:"_3hAJJY6cz3ePuX_85HtNfJ",error:"_3cHhj9ZjDA2V1eTNhECHpo",pods:"_2g9MF0hWsSUsXH7jreOBwD"}},3858:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(29),r(14),r(4),r(18),r(43),r(11);var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(26)),f=n(r(0)),p=n(r(1)),m=n(r(5)),h=r(189),v=n(r(3859)),_=n(r(3864)),g=n(r(3868)),y=n(r(3870));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=h.Collapse.CollapseItem,S=function(e){(0,l.default)(r,e);var a=E(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).state={name:(0,d.default)(e.props,"data.name"),activeKey:["monitor"]},e.handleCollapseChange=function(t){e.setState({activeKey:t})},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.data,r=e.fullScreen;if(!a.nodes)return null;var n=a.nodes.find((function(e){return"service"===e.data.nodeType}));if(!n)return null;var c=(0,d.default)(n,"data.traffic[0].protocol");return f.default.createElement("div",{className:(0,m.default)(y.default.detail,"ks-service-detail")},f.default.createElement("div",{className:(0,m.default)(y.default.wrapper,(0,o.default)({},y.default.fullscreen,r))},f.default.createElement("div",{className:y.default.title},f.default.createElement(h.Icon,{name:"network-router",size:32}),f.default.createElement("div",null,f.default.createElement("div",{className:"h5"},a.name),f.default.createElement("p",null,t("SERVICE")))),f.default.createElement(h.Collapse,{activeKey:this.state.activeKey,onChange:this.handleCollapseChange,accordion:!0},f.default.createElement(b,{label:t("TRAFFIC_MONITORING"),key:"monitor"},f.default.createElement(v.default,{detail:a,store:this.props.store,protocol:c})),f.default.createElement(b,{label:t("TRAFFIC_MANAGEMENT"),key:"form"},f.default.createElement(_.default,{detail:a,store:this.props.store,protocol:c})),f.default.createElement(b,{label:t("POD_PL"),key:"pods"},f.default.createElement(g.default,{detail:a,store:this.props.store})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=(0,d.default)(e,"data.name");return t.name!==a?{activeKey:["monitor"],name:a}:null}}]),r}(f.default.Component);a.default=S,S.propTypes={type:p.default.string,data:p.default.object}},3859:function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=r(189),f=n(r(3860)),p=n(r(3861));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var h=function(e){(0,s.default)(r,e);var a=m(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).handleTypeChange=function(e){t.setState({type:e})},t.state={type:"service"},t}return(0,c.default)(r,[{key:"render",value:function(){var e=this.state.type;return u.default.createElement("div",null,u.default.createElement(d.RadioGroup,{mode:"button",buttonWidth:50,value:this.state.type,onChange:this.handleTypeChange,options:this.types}),"service"===e?u.default.createElement(f.default,this.props):u.default.createElement(p.default,this.props))}},{key:"types",get:function(){return[{label:t("SERVICE_PL"),value:"service"},{label:t("WORKLOAD_PL"),value:"workload"}]}}]),r}(u.default.Component);a.default=h},3860:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(14),r(193),r(4),r(18),r(11),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(446),r(14),r(193),r(4),r(18),r(43),r(11),r(110);var o=n(r(317)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(26)),f=n(r(0)),p=n(r(1)),m=n(r(830)),h=r(803),v=r(480),_=r(820),g=n(r(1610)),y=n(r(1232));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=function(e){(0,l.default)(r,e);var a=E(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).state={metrics:{},outMetrics:{}},t.getData(),t}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){(0,m.default)(e.detail,this.props.detail)||this.getData()}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){e.getData()}),1e4)}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"getData",value:function(){var e=this,t=this.props,a=t.detail,r=t.store,n=this.store.fetchServiceMetrics.bind(this.store);a&&a.name&&(n({name:a.name,namespace:r.detail.namespace,cluster:r.detail.cluster},{duration:1800}).then((function(t){e.setState({metrics:t})})),n({name:a.name,namespace:r.detail.namespace,cluster:r.detail.cluster},{duration:1800,direction:"outbound",reporter:"destination"}).then((function(t){e.setState({outMetrics:t})})))}},{key:"render",value:function(){return"tcp"===this.props.protocol?f.default.createElement(f.default.Fragment,null,f.default.createElement("div",{className:y.default.title},t("TCP_INBOUND_TRAFFIC")),f.default.createElement(_.SimpleArea,(0,o.default)({},this.tcpInMetrics,{height:150}))):f.default.createElement(f.default.Fragment,null,f.default.createElement("div",{className:y.default.title},t("TRAFFIC_RPS")),f.default.createElement(g.default,{metrics:this.trafficInMetrics}),f.default.createElement("div",{className:"margin-b8"}),f.default.createElement(_.SimpleArea,(0,o.default)({},this.requestInMetrics,{height:150})))}},{key:"store",get:function(){return this.props.store}},{key:"requestInMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.metrics,t=(0,d.default)(e,"request_count[0].datapoints",[]),a=(0,d.default)(e,"request_error_count[0].datapoints",[]),r=t.map((function(e,t){return(0,v.getSuccessCount)(e,a[t])}));return(0,h.getAreaChartOps)({title:"TRAFFIC",legend:["SUCCESSFUL","ALL"],areaColors:["#329dce","#d8dee5"],data:[{values:r},{values:t}],unit:"RPS"})}},{key:"tcpInMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.metrics,t=(0,d.default)(e,"tcp_received[0].datapoints",[]),a=(0,d.default)(e,"tcp_sent[0].datapoints",[]);return 0===t.length&&0===a.length?{}:(0,h.getAreaChartOps)({title:"BANDWIDTH",legend:["SENT","RECEIVED"],data:[{values:a},{values:t}],unit:"B/s"})}},{key:"trafficInMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.metrics,t=(0,v.getMetricData)((0,d.default)(e,"request_count[0].datapoints",[]),NaN),a=(0,v.getMetricData)((0,d.default)(e,"request_error_count[0].datapoints",[]),0),r=t>0?100*(t-a)/t:NaN,n=(0,v.getMetricData)((0,d.default)(e,"request_duration_millis[0].datapoints",[]),NaN);return[{title:"TRAFFIC",data:t.toFixed(2),unit:"RPS",icon:"changing-over"},{title:"SUCCESS_RATE",data:r.toFixed(2),icon:"check",unit:"%"},{title:"DURATION",data:n.toFixed(2),icon:"timed-task",unit:"ms"}]}}]),r}(f.default.Component);a.default=b,b.propTypes={detail:p.default.object,store:p.default.object}},3861:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(193),r(4),r(18),r(11),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(193),r(4),r(21),r(18),r(43),r(11),r(110);var o=n(r(317)),c=n(r(38));r(35);var s=n(r(39)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(26)),m=n(r(0)),h=n(r(1)),v=n(r(830)),_=r(803),g=r(480),y=r(820),E=n(r(1610)),b=n(r(3862)),S=n(r(1232));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var R=function(e){(0,u.default)(n,e);var a,r=O(n);function n(e){var t;return(0,l.default)(this,n),(t=r.call(this,e)).handleWorkloadChange=function(e){t.setState({workload:e},(function(){return t.getData()}))},t.state={workload:(0,p.default)(e.detail,"workloads[0].data.workload"),metrics:{},outMetrics:{}},t.getData(),t}return(0,i.default)(n,[{key:"componentDidUpdate",value:function(e){var t=this;(0,v.default)(e.detail,this.props.detail)||this.setState({workload:(0,p.default)(this.props.detail,"workloads[0].data.workload")},(function(){t.getData()}))}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){e.getData()}),1e4)}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"getData",value:(a=(0,s.default)(c.default.mark((function e(){var t,a,r=this;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.workload,a=this.props.store,t&&(this.store.fetchWorkloadMetrics({name:t,namespace:a.detail.namespace,cluster:a.detail.cluster},{duration:1800}).then((function(e){r.setState({metrics:e})})),this.store.fetchWorkloadMetrics({name:t,namespace:a.detail.namespace,cluster:a.detail.cluster},{duration:1800,direction:"outbound",reporter:"destination"}).then((function(e){r.setState({outMetrics:e})})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderWorkloadSelect",value:function(){return m.default.createElement(b.default,{className:S.default.workloads,value:this.state.workload,options:this.workloads,onChange:this.handleWorkloadChange})}},{key:"render",value:function(){return"tcp"===this.props.protocol?m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:S.default.title},t("TCP_INBOUND_TRAFFIC")," ",this.renderWorkloadSelect()),m.default.createElement(y.SimpleArea,(0,o.default)({},this.tcpInMetrics,{height:150})),m.default.createElement("div",{className:S.default.title},t("TCP_OUTBOUND_TRAFFIC")," ",this.renderWorkloadSelect()),m.default.createElement(y.SimpleArea,(0,o.default)({},this.tcpOutMetrics,{height:150}))):m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:S.default.title},t("HTTP_INBOUND_TRAFFIC")," ",this.renderWorkloadSelect()),m.default.createElement(E.default,{metrics:this.trafficInMetrics}),m.default.createElement("div",{className:"margin-b8"}),m.default.createElement(y.SimpleArea,(0,o.default)({},this.requestInMetrics,{height:150})),m.default.createElement("div",{className:S.default.title},t("HTTP_OUTBOUND_TRAFFIC")," ",this.renderWorkloadSelect()),m.default.createElement(E.default,{metrics:this.trafficOutMetrics}),m.default.createElement("div",{className:"margin-b8"}),m.default.createElement(y.SimpleArea,(0,o.default)({},this.requestOutMetrics,{height:150})))}},{key:"store",get:function(){return this.props.store}},{key:"workloads",get:function(){return(0,p.default)(this.props.detail,"workloads",[]).map((function(e){return{label:(0,p.default)(e,"data.workload",""),value:(0,p.default)(e,"data.workload","")}}))}},{key:"requestInMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.metrics,t=(0,p.default)(e,"request_count[0].datapoints",[]),a=(0,p.default)(e,"request_error_count[0].datapoints",[]),r=t.map((function(e,t){return(0,g.getSuccessCount)(e,a[t])}));return(0,_.getAreaChartOps)({title:"TRAFFIC",legend:["SUCCESSFUL","ALL"],areaColors:["#329dce","#d8dee5"],data:[{values:r},{values:t}],unit:"RPS"})}},{key:"requestOutMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.outMetrics,t=(0,p.default)(e,"request_count[0].datapoints",[]),a=(0,p.default)(e,"request_error_count[0].datapoints",[]),r=t.map((function(e,t){return(0,g.getSuccessCount)(e,a[t])}));return(0,_.getAreaChartOps)({title:"TRAFFIC",legend:["SUCCESSFUL","ALL"],areaColors:["#329dce","#d8dee5"],data:[{values:r},{values:t}],unit:"RPS"})}},{key:"tcpInMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.metrics,t=(0,p.default)(e,"tcp_received[0].datapoints",[]),a=(0,p.default)(e,"tcp_sent[0].datapoints",[]);return 0===t.length&&0===a.length?{}:(0,_.getAreaChartOps)({title:"BANDWIDTH",legend:["SENT","RECEIVED"],data:[{values:a},{values:t}],unit:"B/s"})}},{key:"tcpOutMetrics",get:function(){if(!this.props.detail)return{};var e=this.state.outMetrics,t=(0,p.default)(e,"metrics.tcp_received.matrix[0].values",[]),a=(0,p.default)(e,"tcp_sent[0].datapoints",[]);return 0===t.length&&0===a.length?{}:(0,_.getAreaChartOps)({title:"BANDWIDTH",legend:["SENT","RECEIVED"],data:[{values:a},{values:t}],unit:"B/s"})}},{key:"trafficInMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.metrics,t=(0,g.getMetricData)((0,p.default)(e,"request_count[0].datapoints",[]),NaN),a=(0,g.getMetricData)((0,p.default)(e,"request_error_count[0].datapoints",[]),0),r=t>0?100*(t-a)/t:NaN,n=(0,g.getMetricData)((0,p.default)(e,"request_duration_millis[0].datapoints",[]),NaN);return[{title:"TRAFFIC",data:t.toFixed(2),unit:"RPS",icon:"changing-over"},{title:"SUCCESS_RATE",desc:"SUCCESS_RATE_SCAP",data:r.toFixed(2),icon:"check",unit:"%"},{title:"DURATION",data:n.toFixed(2),icon:"timed-task",unit:"ms"}]}},{key:"trafficOutMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.outMetrics,t=(0,g.getMetricData)((0,p.default)(e,"request_count[0].datapoints",[]),NaN),a=(0,g.getMetricData)((0,p.default)(e,"request_error_count[0].datapoints",[]),0),r=t>0?100*(t-a)/t:NaN,n=(0,g.getMetricData)((0,p.default)(e,"request_duration_millis[0].datapoints",[]),NaN);return[{title:"TRAFFIC",data:t.toFixed(2),unit:"RPS",icon:"changing-over"},{title:"SUCCESS_RATE",desc:"SUCCESS_RATE_SCAP",data:r.toFixed(2),icon:"check",unit:"%"},{title:"DURATION",data:n.toFixed(2),icon:"timed-task",unit:"ms"}]}}]),n}(m.default.Component);a.default=R,R.propTypes={detail:h.default.object,store:h.default.object}},3862:function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(4),a(18),a(43),a(11);var o=n(a(25)),c=n(a(28)),s=n(a(41)),l=n(a(42)),i=n(a(37)),u=r(a(0)),d=n(a(5)),f=a(189),p=n(a(3863));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var h=function(e){(0,s.default)(a,e);var t=m(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).handleOptionsClick=function(t,a){e.props.onChange(a)},e}return(0,c.default)(a,[{key:"renderOptions",value:function(){var e=this.props.options;return u.default.createElement(f.Menu,{className:p.default.options,onClick:this.handleOptionsClick},e.map((function(e){return u.default.createElement(f.Menu.MenuItem,{key:e.value},e.label)})))}},{key:"renderControl",value:function(){var e=this.props,t=e.className,a=e.value;return u.default.createElement("div",{className:(0,d.default)(p.default.value,t)},u.default.createElement("span",{className:p.default.label},a),u.default.createElement(f.Icon,{className:p.default.rightIcon,name:"chevron-down",type:"light"}))}},{key:"render",value:function(){return u.default.createElement(f.Dropdown,{theme:"dark",content:this.renderOptions()},this.renderControl())}}]),a}(u.Component);t.default=h},3863:function(e,t,a){e.exports={value:"_3CEWBshCQLzo8RNlclZR3J",label:"_2M9odPubyrPiecJ5IeMMOM",options:"MH6o3mirwIGZ0ZWiEaxbc",rightIcon:"_1DBoOHtlGbnr78vBqKbcEj"}},3864:function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(98),r(14),r(8),r(13),r(9),r(4),r(190),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(18),r(43),r(11),r(7);var o,c,s,l=n(r(31)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(26)),h=n(r(68)),v=n(r(196)),_=n(r(67)),g=n(r(142)),y=n(r(0)),E=n(r(1)),b=r(17),S=r(243),O=n(r(831)),R=r(189),k=n(r(191)),C=n(r(805)),A=r(56),T=n(r(438)),D=n(r(3865)),P=n(r(3866)),N=n(r(3867));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var M=(0,S.observer)((s=c=function(e){(0,d.default)(r,e);var a=x(r);function r(e){var n;return(0,i.default)(this,r),(n=a.call(this,e)).handleModeChange=function(e){n.setState({mode:e},(function(){"lb"===n.state.mode?(0,v.default)(n.state.formData,"spec.template.spec.trafficPolicy.loadBalancer.consistentHash"):(0,v.default)(n.state.formData,"spec.template.spec.trafficPolicy.loadBalancer.simple")}))},n.handlePoolToggle=function(e){n.setState({showPoolForm:e})},n.handleCircuitToggle=function(e){n.setState({showCircuitForm:e})},n.handleSubmit=function(e){var a=n.state,r=a.showCircuitForm,o=a.showPoolForm;r||(0,v.default)(e,"spec.template.spec.trafficPolicy.outlierDetection"),o||(0,v.default)(e,"spec.template.spec.trafficPolicy.connectionPool");var c=function(){n.getData(n.props),k.default.success({content:t("UPDATE_SUCCESSFUL")})};if((0,_.default)(n.detail)){var s=(0,b.toJS)(n.props.store.detail),l=s.cluster,i=s.namespace;n.store.create(e,{cluster:l,namespace:i}).then(c)}else(0,h.default)(e,"metadata.resourceVersion",n.detail.resourceVersion),n.store.update(n.detail,e).then(c)},n.sessionValidator=function(e,a,r){if((0,_.default)(a)||Object.values(a).some((function(e){return(0,g.default)(e)&&!e})))return r({message:t("PARAM_REQUIRED"),field:e.field});r()},n.state={mode:"lb",showPoolForm:!1,showCircuitForm:!1,formData:{}},n.store=new D.default,n.getData(e),n}return(0,u.default)(r,[{key:"getData",value:function(e){var t=this,a=e.detail.name,r=(0,b.toJS)(e.store.detail),n=r.cluster,o=r.namespace;this.store.fetchListByK8s({cluster:n,namespace:o,labelSelector:(0,A.joinSelector)({app:a}),limit:1}).then((function(){t.setState({showPoolForm:t.detail.connectPoolEnable,showCircuitForm:t.detail.outlierDetectionEnable,formData:t.formTemplate})}))}},{key:"componentDidUpdate",value:function(e){e.detail.name!==this.props.detail.name&&this.getData(this.props)}},{key:"getLBOptions",value:function(){return[{label:t("LB_UNSPECIFIED"),value:"UNSPECIFIED"},{label:t("LB_RANDOM"),value:"RANDOM"},{label:t("LB_PASSTHROUGH"),value:"PASSTHROUGH"},{label:t("LB_ROUND_ROBIN"),value:"ROUND_ROBIN"},{label:t("LB_LEAST_REQUEST"),value:"LEAST_REQUEST"}]}},{key:"renderLB",value:function(){var e=this.state.mode;return y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:N.default.title},t("TRAFFIC_POLICIES")),y.default.createElement(R.RadioGroup,{wrapClassName:"radio-group-button margin-t12",buttonWidth:165,value:e,onChange:this.handleModeChange,size:"small"},y.default.createElement(R.RadioButton,{value:"lb"},t("LOAD_BALANCING")),y.default.createElement(R.RadioButton,{value:"session"},t("SESSION_PERSISTENCE"))),"lb"===e&&this.renderLBOptions(),"session"===e&&this.renderSessionOptions())}},{key:"renderPool",value:function(){var e=this.state.showPoolForm,a=y.default.createElement("div",{className:N.default.title},t("CONNECTION_POOL"),y.default.createElement(R.Toggle,{checked:e,onChange:this.handlePoolToggle,onText:t("ON"),offText:t("OFF")})),r=y.default.createElement("div",{className:N.default.tip},t("CONNECTION_POOL_TIP"));return this.isHTTP?y.default.createElement(y.default.Fragment,null,a,e?y.default.createElement(y.default.Fragment,null,y.default.createElement(R.Form.Item,{className:"margin-t12",label:t("MAXIMUM_CONNECTIONS"),desc:t("MAXIMUM_CONNECTIONS_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.connectionPool.tcp.maxConnections",min:0})),y.default.createElement(R.Form.Item,{label:t("MAXIMUM_REQUESTS_PER_CONNECTION"),desc:t("MAXIMUM_REQUESTS_PER_CONNECTION_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.connectionPool.http.maxRequestsPerConnection",defaultValue:1,min:0})),y.default.createElement(R.Form.Item,{label:t("TRAFFIC_MONITORING_MAXIMUM_RETRIES"),desc:t("TRAFFIC_MONITORING_MAXIMUM_RETRIES_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.connectionPool.http.maxRetries",defaultValue:3,min:0})),y.default.createElement(R.Form.Item,{label:t("CONNECTION_TIMEOUT"),desc:t("CONNECTION_TIMEOUT_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.connectionPool.tcp.connectTimeout",min:0,unit:"ms",showUnit:!0})),y.default.createElement(R.Form.Item,{label:t("MAXIMUM_REQUESTS")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.connectionPool.http.http2MaxRequests",defaultValue:1024,min:0})),y.default.createElement(R.Form.Item,{label:t("MAXIMUM_PENDING_REQUESTS")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.connectionPool.http.http1MaxPendingRequests",defaultValue:1024,min:0}))):r):y.default.createElement(y.default.Fragment,null,a,e?y.default.createElement(y.default.Fragment,null,y.default.createElement(R.Form.Item,{className:"margin-t12",label:t("MAXIMUM_CONNECTIONS"),desc:t("MAXIMUM_CONNECTIONS_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.connectionPool.tcp.maxConnections",min:0})),y.default.createElement(R.Form.Item,{label:t("CONNECTION_TIMEOUT"),desc:t("CONNECTION_TIMEOUT_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.connectionPool.tcp.connectTimeout",min:0,unit:"ms",showUnit:!0}))):r)}},{key:"renderCircuit",value:function(){var e=this.state.showCircuitForm;return this.isHTTP?y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:N.default.title},t("CIRCUIT_BREAKER"),y.default.createElement(R.Toggle,{checked:e,onChange:this.handleCircuitToggle,onText:t("ON"),offText:t("OFF")})),e?y.default.createElement(y.default.Fragment,null,y.default.createElement(R.Form.Item,{className:"margin-t12",label:t("CONSECUTIVE_FIVEXX_ERRORS"),desc:t("CONSECUTIVE_FIVEXX_ERRORS_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.outlierDetection.consecutiveErrors",defaultValue:5,min:0})),y.default.createElement(R.Form.Item,{label:t("INSPECTION_INTERVAL_S"),desc:t("INSPECTION_INTERVAL_S_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.outlierDetection.interval",defaultValue:"10s",min:.001,unit:"s",showUnit:!0})),y.default.createElement(R.Form.Item,{label:t("MAXIUM_EJECTION_RATIO"),desc:t("MAXIUM_EJECTION_RATIO_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.outlierDetection.maxEjectionPercent",defaultValue:10,min:0})),y.default.createElement(R.Form.Item,{label:t("BASE_EJECTION_TIME_S"),desc:t("BASE_EJECTION_TIME_S_DESC")},y.default.createElement(C.default,{name:"spec.template.spec.trafficPolicy.outlierDetection.baseEjectionTime",defaultValue:"30s",min:0,unit:"s",showUnit:!0}))):y.default.createElement("div",{className:N.default.tip},t("CIRCUIT_BREAKER_DESC"))):null}},{key:"renderLBOptions",value:function(){return y.default.createElement("div",{className:"margin-t12"},y.default.createElement(R.Form.Item,{label:t("LOAD_BALANCING_ALGORITHM")},y.default.createElement(R.Select,{name:"spec.template.spec.trafficPolicy.loadBalancer.simple",options:this.getLBOptions(),defaultValue:"ROUND_ROBIN"})),y.default.createElement(R.Alert,{className:N.default.alert,message:t.html("LB_ALG_DESC"),type:"info"}))}},{key:"renderSessionOptions",value:function(){return y.default.createElement("div",{className:"margin-t12"},y.default.createElement(R.Form.Item,{label:t("METHOD"),rules:[{validator:this.sessionValidator}]},y.default.createElement(P.default,{name:"spec.template.spec.trafficPolicy.loadBalancer.consistentHash",protocol:this.props.protocol})))}},{key:"render",value:function(){return y.default.createElement(R.Form,{onSubmit:this.handleSubmit,data:this.state.formData},this.renderLB(),this.renderPool(),this.renderCircuit(),y.default.createElement("div",{className:"text-right margin-t12"},y.default.createElement(R.Button,{onClick:this.handleCancel},t("CANCEL")),y.default.createElement(R.Button,{type:"primary",htmlType:"submit",loading:this.store.isSubmitting,disabled:this.store.isSubmitting},t("OK"))))}},{key:"detail",get:function(){var e=(0,b.toJS)(this.store.list);return(0,m.default)(e,"data.[0]",{})}},{key:"isHTTP",get:function(){return"http"===this.props.protocol}},{key:"formTemplate",get:function(){if(this.detail._originData)return(0,O.default)(this.detail._originData);var e=this.props.detail.name,t=(0,b.toJS)(this.props.store.detail),a=t.namespace,r=t.selector;return T.default.strategyPolicy({name:e,namespace:a,selector:w(w({},r),{},{app:e})})}}]),r}(y.default.Component),c.propTypes={detail:E.default.object,store:E.default.object},c.defaultProps={detail:{}},o=s))||o;a.default=M},3865:function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),l=r(a(37));function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,l.default)(e);if(t){var n=(0,l.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var u=function(e){(0,c.default)(a,e);var t=i(a);function a(){var e;return(0,n.default)(this,a),(e=t.call(this)).module="servicepolicies",e}return(0,o.default)(a,[{key:"apiVersion",get:function(){return"apis/servicemesh.kubesphere.io/v1alpha2"}}]),a}(r(a(49)).default);t.default=u},3866:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(66),r(20),r(99),r(9),r(4),r(18),r(30),r(11),r(71),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(97)),c=n(r(31)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37));r(32),r(3),r(66),r(20),r(29),r(99),r(9),r(4),r(18),r(43),r(30),r(11),r(71);var f=n(r(808)),p=n(r(0)),m=n(r(1)),h=r(189);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var _=function(e){(0,i.default)(r,e);var a=v(r);function r(e){var t;(0,s.default)(this,r),(t=a.call(this,e)).triggerChange=(0,f.default)((function(e){t.props.onChange(e)}),500),t.handleTypeChange=function(e){t.setState({type:e,value:""},(function(){"useSourceIp"===e?t.triggerChange((0,c.default)({},e,!0)):t.triggerChange((0,c.default)({},e,""))}))},t.handleValueChange=function(e,a){t.setState({value:a},(function(){var e=t.state.type;if("httpCookie"===e){var r=function(e){for(var t=!0,a=e.replace(/\s+/g,"").split(";"),r={},n=0;n<a.length;n++){var o=a[n].split("=");o.length>1?r[o[0]]=o[1]:t=!1}return{result:r,status:t}}(a),n=r.result;r.status&&t.triggerChange((0,c.default)({},e,n))}else t.triggerChange((0,c.default)({},e,a))}))};var n=t.getOptions(),l=Object.keys(e.value)[0]||n[0].value,i=e.value[l];return"httpCookie"===l&&i&&(i=Object.entries(i).map((function(e){var t=(0,o.default)(e,2),a=t[0],r=t[1];return"".concat(a,"=").concat(r)})).join("; ")),t.state={type:l,value:i,propsValue:e.value},t}return(0,l.default)(r,[{key:"getOptions",value:function(){var e=this.props.protocol,a=[{label:t("HASH_BASED_ON_SOURCE_IP_ADDRESS"),value:"useSourceIp"},{label:t("HASH_BASED_ON_RINGHASH"),value:"ringHash"},{label:t("HASH_BASED_ON_MAGLEV"),value:"maglev"}];if("http"===e)return[{label:t("HASH_BASED_ON_HTTP_HEADER"),value:"httpHeaderName"},{label:t("HASH_BASED_ON_HTTP_COOKIE"),value:"httpCookie"},{label:t("HASH_BASED_ON_HTTP_QUERY_PARAMETE_NAME"),value:"httpQueryParameterName"}].concat(a)}},{key:"render",value:function(){var e=this.state,a=e.type,r=e.value;return p.default.createElement("div",null,p.default.createElement(h.Select,{value:a,options:this.getOptions(),onChange:this.handleTypeChange}),"httpHeaderName"===a&&p.default.createElement(p.default.Fragment,null,p.default.createElement("div",{className:"margin-t12"},t("HTTP_HEADER")),p.default.createElement(h.Input,{value:r,onChange:this.handleValueChange})),"httpCookie"===a&&p.default.createElement(p.default.Fragment,null,p.default.createElement("div",{className:"margin-t12"},t("HTTP_COOKIE")),p.default.createElement(h.Input,{value:r,onChange:this.handleValueChange,placeholder:"key1=value1; key2=value2"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.value!==t.propsValue){var a=Object.keys(e.value)[0],r=e.value[a];return"httpCookie"===a&&r&&(r=Object.entries(r).map((function(e){var t=(0,o.default)(e,2),a=t[0],r=t[1];return"".concat(a,"=").concat(r)})).join("; ")),{type:a,value:r,propsValue:e.value}}return null}}]),r}(p.default.Component);a.default=_,_.propTypes={value:m.default.object,onChange:m.default.func},_.defaultProps={value:{},onChange:function(){}}},3867:function(e,t,a){e.exports={alert:"_1vmq3lFL4s_LHc4G92GrAd",title:"UJTgRS_diNzcvnFtP8moj",tip:"IYAZYjWhc7hDQqpGq-eJy"}},3868:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(18),r(30),r(11),r(46),r(69),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(36),r(66),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(46),r(69),r(7),r(40);var o=n(r(38)),c=n(r(31));r(35);var s,l=n(r(39)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(55),v=r(437),_=n(r(26)),g=r(17),y=r(189),E=n(r(830)),b=r(56),S=n(r(452)),O=n(r(319)),R=n(r(3869)),k=n(r(1611));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var D=(0,h.withRouter)(s=function(e){(0,d.default)(n,e);var a,r=T(n);function n(e){var t;return(0,i.default)(this,n),(t=r.call(this,e)).podStore=new S.default,t.workloadStore=new O.default("deployments"),t.state={workloads:[]},t}return(0,u.default)(n,[{key:"componentDidMount",value:function(){this.getData()}},{key:"componentDidUpdate",value:function(e){(0,E.default)(e.detail,this.props.detail)||this.getData()}},{key:"getData",value:(a=(0,l.default)(o.default.mark((function e(){var t,a,r,n,c,s,l,i,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.detail,r=t.store,!a||!a.name){e.next=10;break}return n=r.detail,c=n.namespace,s=n.cluster,l=a.nodes.filter((function(e){return e.data.workload})).map((function(e){return e.data.workload})),e.next=6,Promise.all([this.workloadStore.fetchList({namespace:c,cluster:s,names:l.join(",")}),this.podStore.fetchListByK8s({namespace:c,cluster:s,labelSelector:(0,b.joinSelector)(A(A({},r.detail.selector),{},{app:a.name}))})]);case 6:i=(0,g.toJS)(this.workloadStore.list.data),u=(0,g.toJS)(this.podStore.list.data),i.forEach((function(e){e.labels&&e.labels.version&&(e.pods=u.filter((function(t){return t.labels&&t.labels.version===e.labels.version&&t.labels.app===e.labels.app})))})),this.setState({workloads:i});case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this,a=this.state.workloads,r=this.props.match.params,n=r.workspace,o=r.cluster,c=r.namespace;return m.default.createElement("div",{className:k.default.wrapper},a.map((function(a){return m.default.createElement("div",{className:k.default.item,key:a.uid},m.default.createElement("div",{className:k.default.title},m.default.createElement(y.Icon,{name:"backup",size:32}),m.default.createElement("div",{className:k.default.text},m.default.createElement("p",null,m.default.createElement("strong",null,m.default.createElement(v.Link,{to:"/".concat(n,"/clusters/").concat(o,"/projects/").concat(c,"/deployments/").concat(a.name)},a.name))),m.default.createElement("div",{className:k.default.version},m.default.createElement("span",null,t("VERSION"))," ",(0,_.default)(a,"labels.version")))),a.pods&&m.default.createElement("div",{className:k.default.pods},a.pods.map((function(t){return m.default.createElement(R.default,{key:t.uid,data:t,match:e.props.match})}))))})))}}]),n}(m.default.Component))||s;a.default=D},3869:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(69);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=n(r(5)),f=n(r(26)),p=r(189),m=r(437),h=r(56),v=n(r(1611));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var g=function(e){(0,s.default)(r,e);var a=_(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return(e=a.call.apply(a,[this].concat(n))).handleLinkClick=function(){localStorage.setItem("pod-detail-referrer",location.pathname)},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props.data,a=this.props.match.params,r=a.workspace,n=a.cluster,o=a.namespace,c=e.podStatus,s="running"===c.type||"completed"===c.type?"running":"updating";return u.default.createElement("div",{className:v.default.podItem},u.default.createElement("div",{className:v.default.icon},u.default.createElement(p.Icon,{name:"pod",size:32}),u.default.createElement("span",{className:(0,d.default)(v.default.status,v.default[s])})),u.default.createElement("div",{className:v.default.text},u.default.createElement(m.Link,{to:"/".concat(r,"/clusters/").concat(n,"/projects/").concat(o,"/pods/").concat(e.name)},u.default.createElement("strong",{onClick:this.handleLinkClick},e.name)),u.default.createElement("p",null,t("UPDATED_AT_VALUE_SCAP",{value:(0,h.getLocalTime)((0,f.default)(e,"status.startTime")||(0,f.default)(e,"createTime")).format("YYYY-MM-DD HH:mm:ss")}))))}}]),r}(u.default.Component);a.default=g},3870:function(e,t,a){e.exports={detail:"_2nZLGr4tqIVCg5V__c5QtF",wrapper:"_1nI-r7opnLRDzav8uyOoMB",fullscreen:"_3tl8311-BoDScKfpXTzXFq",title:"_1JiVM4e0fJSK9p6xWMriZg"}},3871:function(e,t,a){e.exports={graph:"_1XGvazo0r1NORQGXuaghPQ",graphContent:"_2owoCDhiTBQS0dGMnA9sC3",edgeWrapper:"cZDahLdDa3RWx9XVuQkzI",body:"qDE6K4UlY8s-QNAwxCe1K",fullScreen:"ZOIRUYm9uqbrHbC-75Yzx",loading:"_2O0O0Pw4n2v_7cu35cdot4",dragger:"_2m-ChjT4AAegWwJ_NoEqaA",mainContent:"QUutK9QVd5TABUKunFVkN"}},3872:function(e,t,a){e.exports={main:"_2iPG6M7MGzMxbPdbDEWKTS",graph:"_1DNY4Ckxe-2VlpvOswSGWY",tracing:"_1U4YYpaZmy1CDP-SUtxJ2s",cardHeader:"_5WqgHfksXAkqCtNbKg2cp",operations:"_3j3KuCy2m-nw5bx3PSeVbs",timeSelect:"_3cUfdUjfIvXc4idqihXfUw",emptyList:"_1t2nghWnemmp2lgjyfQ4Ql",loading:"_1KcntxCOV8bBEr8KBomL9T"}},3873:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(67)),f=n(r(0)),p=r(437),m=r(189),h=r(17),v=r(243),_=r(56),g=n(r(844)),y=r(3874),E=n(r(3908));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=(0,v.inject)("detailStore")(o=(0,v.observer)(o=function(e){(0,l.default)(r,e);var a=b(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).detailStore=e.detailStore,t.module=e.module,t}return(0,s.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.disposer=(0,h.when)((function(){return!(0,d.default)(e.detailStore.detail)}),(function(){return e.getData()}))}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"getData",value:function(){var e=(0,h.toJS)(this.detailStore.detail).selector,t={namespace:this.namespace,cluster:this.cluster,labelSelector:(0,_.joinSelector)(e)};this.store.fetchList(t).then()}},{key:"renderEmpty",value:function(){return f.default.createElement(g.default,{icon:"istio",title:t("NO_GRAYSCALE_RELEASE_TASK_FOUND"),desc:t("NO_GRAYSCALE_RELEASE_TASK_FOUND_DESC")})}},{key:"renderHeader",value:function(){var e=this.props.match.params,a=e.cluster,r=e.workspace,n=e.namespace;return f.default.createElement("div",{className:E.default.header},f.default.createElement(m.Columns,null,f.default.createElement(m.Column,null,f.default.createElement("p",{className:E.default.headerTip},t("GRAYSCALE_RELEASE_DESC"))),f.default.createElement(m.Column,{className:"is-narrow"},f.default.createElement(p.Link,{to:"/".concat(r,"/clusters/").concat(a,"/projects/").concat(n,"/grayrelease/cates")},this.canCreate&&f.default.createElement(m.Button,{type:"control"},t("CREATE_GRAYSCALE_RELEASE_TASK"))))))}},{key:"canCreate",get:function(){var e=this.props.match.params,t=e.cluster,a=e.workspace,r=e.namespace;return globals.app.hasPermission({cluster:t,workspace:a,project:r,module:"grayscale-release",action:"create"})}}]),r}(y.Component))||o)||o;a.default=S},3874:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(69),r(7);var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(67)),f=n(r(0)),p=r(189),m=r(243),h=n(r(191)),v=n(r(844)),_=n(r(3875)),g=n(r(1612)),y=n(r(3906)),E=n(r(1234));function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var R=function(e){(0,l.default)(r,e);var a=O(r);function r(e){var n;return(0,c.default)(this,r),(n=a.call(this,e)).showDetail=function(e){n.setState({showDetailModal:!0,selectItem:S(S({},e),{},{workspace:n.workspace})})},n.hideDetail=function(){n.setState({showDetailModal:!1,selectItem:{}},(function(){n.getData()}))},n.handleDelete=function(){n.store.delete(n.state.selectItem).then((function(){h.default.success({content:"".concat(t("DELETED_SUCCESSFULLY"))}),n.hideDetail()}))},n.showCreateGrayReleaseJob=function(){var e=n.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;n.props.rootStore.routing.push("/".concat(t,"/clusters/").concat(a,"/projects/").concat(r,"/grayrelease/cates"))},n.state={showDetailModal:!1,selectItem:{}},n.store=new g.default,n}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getData",value:function(){this.store.fetchList({namespace:this.namespace,cluster:this.cluster})}},{key:"renderHeader",value:function(){return null}},{key:"renderEmpty",value:function(){return f.default.createElement(v.default,{icon:"istio",title:t("NO_GRAYSCALE_RELEASE_TASK_FOUND"),desc:t("NO_GRAYSCALE_RELEASE_TASK_FOUND_DESC"),actions:this.canCreate?f.default.createElement(p.Button,{type:"control",onClick:this.showCreateGrayReleaseJob},t("CREATE")):null})}},{key:"renderContent",value:function(){var e=this,t=this.store.list,a=t.data;return t.isLoading?f.default.createElement(p.Loading,{className:E.default.loading}):(0,d.default)(a)?this.renderEmpty():f.default.createElement("div",{className:E.default.items},a.map((function(t){return f.default.createElement(y.default,{key:t.name,data:t,onClick:e.showDetail,store:e.store})})))}},{key:"renderFooter",value:function(){var e=this.store.list.total;return f.default.createElement("div",{className:E.default.footer},f.default.createElement("p",null,t("TOTAL_ITEMS",{num:e})))}},{key:"render",value:function(){return f.default.createElement("div",null,this.renderHeader(),this.renderContent(),this.renderFooter(),f.default.createElement(_.default,{detail:this.state.selectItem,visible:this.state.showDetailModal,onCancel:this.hideDetail,onDelete:this.handleDelete}))}},{key:"namespace",get:function(){return this.props.match.params.namespace}},{key:"cluster",get:function(){return this.props.match.params.cluster}},{key:"workspace",get:function(){return this.props.match.params.workspace}},{key:"canCreate",get:function(){var e=this.props.match.params,t=e.cluster,a=e.workspace,r=e.namespace;return globals.app.getActions({cluster:t,workspace:a,project:r,module:"applications"}).includes("edit")&&this.serviceMeshEnable}},{key:"serviceMeshEnable",get:function(){return globals.app.hasClusterModule(this.cluster,"servicemesh")}}]),r}(f.default.Component),k=(0,m.inject)("rootStore")((0,m.observer)(R));a.default=k;var C=R;a.Component=C},3875:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(70),r(66),r(20),r(51),r(14),r(8),r(13),r(9),r(4),r(190),r(18),r(30),r(11),r(73),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(66),r(20),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(18),r(43),r(11),r(73),r(7);var o,c,s,l=n(r(317)),i=n(r(50)),u=n(r(31)),d=n(r(25)),f=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(26)),_=n(r(68)),g=n(r(196)),y=n(r(67)),E=n(r(326)),b=n(r(859)),S=n(r(0)),O=n(r(1)),R=n(r(5)),k=r(17),C=r(243),A=r(189),T=n(r(798)),D=n(r(1051)),P=n(r(1172)),N=n(r(1612)),I=n(r(319)),w=r(56),x=r(61),M=n(r(438)),L=n(r(3876)),j=n(r(3878)),U=n(r(3881)),B=n(r(3905));function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var G={exact:"EXACT_MATCH",prefix:"PREFIX_MATCH",regex:"REGEX_MATCH"},H=(0,E.default)(x.GRAY_RELEASE_CANARY_CONTENT,"value"),q=(0,C.inject)("rootStore")(o=(0,C.observer)((s=c=function(e){(0,p.default)(r,e);var a=V(r);function r(e){var n;return(0,d.default)(this,r),(n=a.call(this,e)).updateTipInfo=function(){var e=(0,k.toJS)(n.store.detail),a=e.governor,r=e.newVersion,o=e.oldVersion;a?n.setState({tipType:"info",tipInfo:a===o?t.html("OLD_VERSION_TAKEOVER_DESC",{newVersion:r,oldVersion:o}):t.html("NEW_VERSION_TAKEOVER_DESC",{newVersion:r,oldVersion:o})}):n.setState({tipInfo:""})},n.handlePatch=function(e){var t=(0,k.toJS)(n.store.detail);n.store.patch(t,e).then((function(){n.store.fetchDetail(t).then((function(){var e=(0,k.toJS)(n.store.detail);if("Canary"===e.type&&!e.byContent){var t=(0,v.default)(e,"newRoute.weight",50);n.setState({ratio:t})}n.updateTipInfo()}))}))},n.handleRatioChange=function(e){n.setState({ratio:e})},n.handleConfirmSaveRatio=function(){var e=n.state.ratio;n.handleSaveRatio(e)},n.handleSaveRatio=function(e){var t=(0,k.toJS)(n.store.detail),a=t.oldRoute,r=t.oldVersion,o=t.newRoute,c=t.newVersion,s=t.protocol,l={};(0,_.default)(l,"spec.template.spec.".concat(s,"[0].route"),[Y(Y({},a),{},{weight:100-e}),Y(Y({},o),{},{weight:e})]),"tcp"===s&&(0,_.default)(l,"spec.template.spec.".concat(s,"[0].match"),[]),100===e?(0,_.default)(l,"spec.governor",c):0===e?(0,_.default)(l,"spec.governor",r):(0,_.default)(l,"spec.governor",""),n.handlePatch(l)},n.handleResetRatio=function(){var e=(0,k.toJS)(n.store.detail),t=(0,v.default)(e,"newRoute.weight");n.setState({ratio:t})},n.showEditModal=function(){n.setState({showEditModal:!0})},n.hideEditModal=function(){n.setState({showEditModal:!1})},n.updateStrategy=function(e){var t=(0,v.default)(e,"spec.protocol","http"),a="spec.template.spec.".concat(t,"[0]"),r=(0,v.default)(e,"".concat(a,".match[0].headers.cookie"));r&&(0,y.default)(Object.values(r)[0])&&(0,g.default)(e,"".concat(a,".match[0].headers.cookie"));var n=(0,v.default)(e,"".concat(a,".match[0].headers"));n&&Object.keys(n).forEach((function(t){(0,y.default)(t)&&(0,g.default)(e,"".concat(a,".match[0].headers.").concat(t))}));var o=(0,v.default)(e,"".concat(a,".match[0].uri"));o&&(0,y.default)(Object.values(o)[0])&&(0,g.default)(e,"".concat(a,".match[0].uri"));var c=(0,v.default)(e,"".concat(a,".match[0].headers['User-Agent'].regex"));return c&&(0,y.default)(Object.values(c)[0])&&(0,g.default)(e,"".concat(a,".match[0].headers['User-Agent'].regex")),(0,g.default)(e,"spec.governor"),e},n.handleComponentEdit=function(e,t){var a=(0,k.toJS)(n.store.detail),r={};t.includes("grayReleaseStrategy")&&(r.strategy=n.updateStrategy(e.strategy)),t.includes("grayReleaseComponent")&&(r.workload=e.workload),n.store.update(a,r).then((function(){n.store.fetchDetail(a).then((function(){n.hideEditModal();var e=(0,k.toJS)(n.store.detail);if("Canary"===e.type&&!e.byContent){var t=(0,v.default)(e,"newRoute.weight",50);n.setState({ratio:t})}n.updateTipInfo()}))}))},n.handleOffline=function(){var e=(0,k.toJS)(n.store.detail),a=e.type,r=e.cluster,o=e.namespace,c=e.governor,s=e.oldVersion,l=e.oldWorkloadName,i=e.newWorkloadName;if(c){var u=n.props.onDelete,d=c===s?i:l;d&&(n.workloadStore.delete({name:d,cluster:r,namespace:o}),u())}else if("Mirror"!==a)n.setState({tipType:"warning",tipInfo:t("DELETE_GRAYSCALE_RELEASE_TASK_DESC")});else{var f=n.props.onDelete;i&&(n.workloadStore.delete({name:i,cluster:r,namespace:o}),f())}},n.handleTakeover=function(e){var t=(0,k.toJS)(n.store.detail);"Canary"===t.type?t.byContent?n.handlePatch({spec:{governor:"new"===e?t.newVersion:t.oldVersion}}):n.handleSaveRatio("new"===e?100:0):"Bluegreen"===t.type&&n.handlePatch({spec:{governor:"new"===e?t.newVersion:t.oldVersion}})},n.handleRecover=function(){n.handlePatch({spec:{governor:""}})},n.state={tipType:"",tipInfo:"",ratio:50,showEditModal:!1},n.store=new N.default,n.workloadType=(0,v.default)(e.detail,'annotations["servicemesh.kubesphere.io/workloadType"]',"deployments"),n.workloadStore=new I.default(n.workloadType),e.visible&&(n.getData(e.detail),n.getWorkLoadDetail(e.detail)),n}return(0,f.default)(r,[{key:"initWebsocket",value:function(e){var t=this,a=e||{},r=a.cluster,n=a.namespace,o=a.selector,c="api/v1/watch/".concat(r?"klusters/".concat(r,"/"):"","namespaces/").concat(n,"/pods?labelSelector=").concat((0,w.joinSelector)(o));c&&n&&o&&(this.websocket.watch(c),this.getWorkLoadDetail=(0,b.default)(this.getWorkLoadDetail,2e3),this.disposer=(0,k.reaction)((function(){return t.websocket.message}),(function(a){"Pod"===a.object.kind&&"ADDED"!==a.type&&t.getWorkLoadDetail(Y(Y({},e),{},{silent:!0}))})))}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,r=t.detail;a&&a!==e.visible&&(this.getData(r),this.getWorkLoadDetail(r))}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer(),this.websocket.close()}},{key:"getData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.name&&t.namespace&&this.store.fetchDetail(t).then((function(){var t=(0,k.toJS)(e.store.detail);if("Canary"===t.type&&!t.byContent){var a=(0,v.default)(t,"newRoute.weight",50);e.setState({ratio:a})}e.initWebsocket(t),e.updateTipInfo()}))}},{key:"getWorkLoadDetail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,a=(0,i.default)(e,["silent"]),r=a.cluster,n=a.namespace,o=a.selector,c=a.hosts,s=a.newVersion,l=a.oldVersion;if(n&&o){var u=(0,w.joinSelector)(o);this.workloadStore.fetchListByK8s({cluster:r,namespace:n,labelSelector:u}),this.store.fetchComponents({cluster:r,namespace:n,service:c,labelSelector:u,newVersion:s,oldVersion:l,silent:t})}}},{key:"renderTitle",value:function(){var e=(0,k.toJS)(this.store.detail),a=x.GRAY_RELEASE_CATEGORIES.find((function(t){return t.type===e.type}))||{};return S.default.createElement("div",{className:B.default.title},S.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/default-app.svg",alt:""}),S.default.createElement("div",{className:B.default.text},S.default.createElement("div",{className:"h4"},e.name),S.default.createElement("p",null,t("RELEASE_MODE"),": ",S.default.createElement("strong",null,t("".concat(a.title,"_LOW"))))),this.CanDelete&&S.default.createElement(A.Button,{onClick:this.handleOffline},t("DELETE")))}},{key:"renderComponents",value:function(){var e=(0,k.toJS)(this.store.detail),a=this.store.components.data,r=this.store.isComponentsLoading;if(r)return S.default.createElement("div",null,S.default.createElement("div",{className:B.default.sectionTitle},S.default.createElement("div",null,t("VERSIONS")),S.default.createElement("p",null,t("GRAY_COMPONENT_DESC"))),S.default.createElement(A.Loading,{spinning:r,className:B.default.loading}));var n={showEditModal:this.showEditModal,onTakeover:"Mirror"!==e.type?this.handleTakeover:null,namespace:this.props.detail.namespace,cluster:this.props.detail.cluster,workspace:this.props.detail.workspace,maxLength:Math.min(Math.max((0,v.default)(a,"[".concat(e.newVersion,"].pods.length"),0),(0,v.default)(a,"[".concat(e.oldVersion,"].pods.length"),0)),3),jobDetail:e,workloadType:this.workloadType};return S.default.createElement("div",null,S.default.createElement("div",{className:B.default.sectionTitle},S.default.createElement("div",null,t("VERSIONS")),S.default.createElement("p",null,t("GRAY_COMPONENT_DESC"))),S.default.createElement(A.Columns,null,S.default.createElement(A.Column,null,S.default.createElement(L.default,(0,l.default)({data:a[e.newVersion],pods:(0,k.toJS)((0,v.default)(a,"[".concat(e.newVersion,"].pods"),[])),type:"new",isGovernor:e.governor===e.newVersion},n))),S.default.createElement(A.Column,null,S.default.createElement(L.default,(0,l.default)({data:a[e.oldVersion],pods:(0,k.toJS)((0,v.default)(a,"[".concat(e.oldVersion,"].pods"),[])),type:"old",isGovernor:e.governor===e.oldVersion},n)))))}},{key:"renderTraffic",value:function(){var e=(0,k.toJS)(this.store.detail),a=this.state.ratio,r=(0,v.default)(e,"newRoute.weight");return S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{className:B.default.sectionTitle},S.default.createElement("div",null,t("TRAFFIC_DISTRIBUTION")),S.default.createElement("p",null,t("ALLOCATE_TRAFFIC_DESC"))),S.default.createElement(P.default,{min:0,max:100,value:a,leftContent:e.newVersion,rightContent:e.oldVersion,onChange:this.handleRatioChange}),S.default.createElement(D.default,{visible:a!==r,width:400,title:t("ADJUST_TRAFFIC_DISTRIBUTION"),content:t.html("ADJUST_TRAFFIC_DISTRIBUTION_DESC",{newVersion:e.newVersion,oldVersion:e.oldVersion,ratioNew:a,ratioOld:100-a}),cancelText:t("CANCEL"),confirmText:t("OK"),isSubmitting:this.store.isSubmitting,onCancel:this.handleResetRatio,onConfirm:this.handleConfirmSaveRatio}))}},{key:"renderBluegreen",value:function(){var e=(0,k.toJS)(this.store.detail),a=e.governor||(100===e.oldRoute.weight?e.oldVersion:e.newVersion);return S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{className:B.default.sectionTitle},S.default.createElement("div",null,t("TRAFFIC_DISTRIBUTION")),S.default.createElement("p",null,t("BLUE_GREEN_TRAFFIC_DISTRI_DESC"))),S.default.createElement("div",{className:B.default.barWrapper},S.default.createElement("div",{className:B.default.bar},t("VERSION_TRAFFIC_PERCENT",{version:a,percent:"100"}))))}},{key:"renderMirror",value:function(){var e=(0,k.toJS)(this.store.detail),a=e.governor||(100===e.oldRoute.weight?e.oldVersion:e.newVersion);return S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{className:B.default.sectionTitle},S.default.createElement("div",null,t("TRAFFIC_DISTRIBUTION")),S.default.createElement("p",null,t("TRAFFIC_MIRRORING_TRAFFIC_DISTRI_DESC"))),S.default.createElement("div",{className:B.default.mirror},S.default.createElement("div",{className:B.default.barWrapper},S.default.createElement("div",{className:(0,R.default)(B.default.bar,(0,u.default)({},B.default.mirrorBar,a!==e.newVersion))},t("VERSION_TRAFFIC_PERCENT",{version:e.newVersion,percent:"100"}))),S.default.createElement("div",{className:(0,R.default)(B.default.mirrorIcon,(0,u.default)({},B.default.revertMirrorIcon,a===e.oldVersion))},S.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/mirror.svg",alt:""})),S.default.createElement("div",{className:B.default.barWrapper},S.default.createElement("div",{className:(0,R.default)(B.default.bar,(0,u.default)({},B.default.mirrorBar,a!==e.oldVersion))},t("VERSION_TRAFFIC_PERCENT",{version:e.oldVersion,percent:"100"})))))}},{key:"renderContentMatch",value:function(){var e=(0,k.toJS)(this.store.detail),a=this.store.components.data,r=this.store.isComponentsLoading;if(r)return S.default.createElement("div",null,S.default.createElement("div",{className:B.default.sectionTitle},S.default.createElement("div",null,t("REQUEST_PARAMETERS")),S.default.createElement("p",null,t("SPECIFY_REQUEST_PARAMETERS_DESC"))),S.default.createElement(A.Loading,{spinning:r,className:B.default.loading}));var n=(0,v.default)(e,"newRoute.match[0]"),o=a[e.newVersion]||{};if(!n)return null;var c=(0,v.default)(n,"uri",{}),s=(0,v.default)(n,"headers",{}),l=Object.keys(c)[0]||"",i=c[l]||"-",u=s.cookie||{},d=Object.keys(u)[0]||"",f=u[d]||"-",p=s["User-Agent"]||{},m=p.regex&&p.regex.slice(3,p.regex.length-3).split("|").map((function(e){return H[e]?H[e].label:e})).join(", ")||"-",h=Object.keys(s).find((function(e){return!["cookie","User-Agent"].includes(e)})),_=s[h]||{},g=Object.keys(_)[0]||"",y=_[g]||"-";return S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{className:B.default.sectionTitle},S.default.createElement("div",null,t("REQUEST_PARAMETERS")),S.default.createElement("p",null,t("SPECIFY_REQUEST_PARAMETERS_DESC"))),S.default.createElement("div",{className:B.default.matchWrapper},e.governor&&S.default.createElement("div",{className:B.default.governor},S.default.createElement("div",null,S.default.createElement("div",null,S.default.createElement(A.Icon,{name:"appcenter",size:40})),S.default.createElement("div",null,t.html("SERVICE_VERSION_RECEIVE_ALL_TRAFFIC",{version:e.governor})),S.default.createElement("div",null,S.default.createElement(A.Button,{onClick:this.handleRecover},t("RESTORE"))))),S.default.createElement(A.Columns,null,S.default.createElement(A.Column,null,S.default.createElement("ul",null,S.default.createElement("li",null,S.default.createElement(A.Icon,{name:"earth",size:24}),S.default.createElement("strong",null,d?t("COOKIE_".concat(G[d])):t("COOKIE")),f),S.default.createElement("li",null,S.default.createElement(A.Icon,{name:"image",size:24}),S.default.createElement("strong",null,t("OS")),m),S.default.createElement("li",null,S.default.createElement(A.Icon,{name:"pen",size:24}),S.default.createElement("strong",null,g?t("HEADER_".concat(G[g])):t("HEADER")),h?"".concat(h,": ").concat(y):""),S.default.createElement("li",null,S.default.createElement(A.Icon,{name:"ip",size:24}),S.default.createElement("strong",null,l?t("URL_".concat(G[l])):t("URL")),i))),S.default.createElement(A.Column,{className:"is-narrow"},S.default.createElement("div",{className:B.default.matchArrow},S.default.createElement(A.Icon,{name:"update",color:{primary:"#329dce"},size:24}))),S.default.createElement(A.Column,{className:"is-narrow"},S.default.createElement("div",{className:B.default.matchVersion},S.default.createElement("div",null,S.default.createElement("div",null,S.default.createElement(A.Icon,{name:"appcenter",size:40})),S.default.createElement("div",null,S.default.createElement("span",{className:"ks-tag"},e.newVersion)),S.default.createElement("div",null,S.default.createElement("strong",null,e.hosts)),S.default.createElement("p",null,t("REPLICA_COUNT"),": ",S.default.createElement("strong",null,o.available),"/",o.desire)))))))}},{key:"renderPolicy",value:function(){var e=(0,k.toJS)(this.store.detail);return"Canary"===e.type?S.default.createElement("div",{style:{marginTop:20}},e.byContent?this.renderContentMatch():this.renderTraffic()):"Bluegreen"===e.type?S.default.createElement("div",{style:{marginTop:20}},this.renderBluegreen()):"Mirror"===e.type?S.default.createElement("div",{style:{marginTop:20}},this.renderMirror()):null}},{key:"renderMonitor",value:function(){var e=(0,k.toJS)(this.store.detail);return S.default.createElement(j.default,{detail:e,store:this.store})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.state,o=n.showEditModal,c=n.tipInfo,s=n.tipType,l=(0,k.toJS)(this.store.detail);return S.default.createElement(T.default,{className:B.default.modal,bodyClassName:B.default.body,headerClassName:B.default.header,title:t("TASK_STATUS"),cancelText:t("CLOSE"),onCancel:r,visible:a,fullScreen:!0},c&&S.default.createElement(A.Alert,{className:"margin-b8",type:s,message:c}),this.renderTitle(),S.default.createElement("div",{className:B.default.wrapper},this.renderComponents(),this.renderPolicy()),S.default.createElement("div",{className:B.default.monitor},this.renderMonitor()),S.default.createElement(U.default,{visible:o,module:"grayreleases",formData:this.formData,cluster:l.cluster,onOk:this.handleComponentEdit,onCancel:this.hideEditModal,isSubmitting:this.store.isSubmitting}))}},{key:"websocket",get:function(){return this.props.rootStore.websocket}},{key:"formData",get:function(){var e=(0,k.toJS)(this.store.detail),t="".concat(e.hosts,"-").concat(e.newVersion),a=(0,k.toJS)(this.workloadStore.list.data).find((function(e){return e.name===t}))||{},r=M.default[this.workloadType]({namespace:e.namespace}),n={strategy:(0,k.toJS)(e._originData),workload:{apiVersion:r.apiVersion,kind:r.kind,metadata:{name:t,namespace:a.namespace,labels:a.labels,annotations:a.annotations},spec:a.spec}};return(0,w.mergeLabels)(n.workload,{version:e.newVersion}),n}},{key:"CanDelete",get:function(){var e=this.store.detail,t=e.cluster,a=e.workspace,r=e.namespace;return globals.app.hasPermission({cluster:t,workspace:a,project:r,module:"grayscale-release",action:"delete"})}}]),r}(S.default.Component),c.propTypes={visible:O.default.bool,detail:O.default.object,onCancel:O.default.func,onDelete:O.default.func},c.defaultProps={visible:!1,detail:{},onCancel:function(){},onDelete:function(){}},o=s))||o)||o;a.default=q},3876:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(70),r(20),r(14),r(99),r(8),r(13),r(9),r(4),r(190),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(190),r(18),r(43),r(11),r(7);var o=n(r(31)),c=n(r(97)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=n(r(1)),m=n(r(5)),h=r(437),v=n(r(830)),_=n(r(26)),g=n(r(67)),y=n(r(198)),E=r(17),b=r(189),S=n(r(1019)),O=n(r(3877)),R=n(r(1613));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var T={cpu:"pod_cpu_usage",memory:"pod_memory_usage_wo_cache"},D=function(e){(0,i.default)(r,e);var a=A(r);function r(e){var t;return(0,s.default)(this,r),(t=a.call(this,e)).handleMoreMenuClick=function(e,a){switch(a){case"edit":t.props.showEditModal();break;case"offline":t.props.onOffline(t.props.type);break;case"takeover":t.props.onTakeover(t.props.type)}},t.state={pods:e.pods||[]},t.monitorStore=new S.default,t.getData(e.pods),t}return(0,l.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props.pods;(0,v.default)(t,e.pods)||this.getData(t)}},{key:"getData",value:function(e){var t=this;(0,g.default)(e)||this.monitorStore.fetchMetrics({cluster:this.props.cluster,namespace:this.props.namespace,resources:e.map((function(e){return e.name})),metrics:Object.values(T),last:!0}).then((function(){var a=(0,E.toJS)(t.monitorStore.data);t.setState({pods:e.map((function(e){var t={};return Object.entries(T).forEach((function(r){var n=(0,c.default)(r,2),o=n[0],s=n[1],l=(0,_.default)(a,"".concat(s,".data.result"))||[];t[o]=l.find((function(t){return(0,_.default)(t,"metric.pod")===e.name}))})),C(C({},e),{},{metrics:t})}))})}))}},{key:"renderMoreMenu",value:function(){var e=this.props,a=e.type,r=e.isGovernor,n=e.onTakeover;return f.default.createElement(b.Menu,{onClick:this.handleMoreMenuClick},"new"===a&&f.default.createElement(b.Menu.MenuItem,{key:"edit"},f.default.createElement(b.Icon,{name:"update",type:"light"})," ",t("EDIT")),!r&&(0,y.default)(n)&&f.default.createElement(b.Menu.MenuItem,{key:"takeover"},f.default.createElement(b.Icon,{name:"linechart",type:"light"})," ",t("TAKE_OVER")))}},{key:"render",value:function(){var e=this,a=this.props,r=a.data,n=a.type,o=a.isGovernor,c=a.onTakeover,s=a.jobDetail,l=a.maxLength,i=a.workloadType,u=this.state.pods,d="new"!==n&&(o||!(0,y.default)(c)),p={minHeight:40*l+4*(l-1)},v=["Bluegreen","Mirror"].includes(s.type)&&!o;return f.default.createElement("div",{className:R.default.wrapper},f.default.createElement("div",{className:R.default.header},f.default.createElement(b.Icon,{name:"appcenter",size:40}),f.default.createElement("div",{className:R.default.title},f.default.createElement("div",{className:"h6"},f.default.createElement(h.Link,{to:"".concat(this.prefix,"/").concat(i,"/").concat(r.name,"-").concat(r.version)},r.name),"",f.default.createElement("span",{className:(0,m.default)("ks-tag",{"ks-tag-disable":v})},r.version),v&&f.default.createElement(b.Tooltip,{content:"Mirror"===s.type?t("MIRRORED_TRAFFIC_TIP"):t("OFFLINE_TIP")},f.default.createElement("span",{className:"ks-tag ks-tag-disable"},"Mirror"===s.type?t("MIRRORED_TRAFFIC"):t("OFFLINE")))),f.default.createElement("p",null,t("REPLICA_COUNT"),": ",f.default.createElement("strong",null,r.available),"/",r.desire)),!d&&f.default.createElement("div",{className:R.default.right},f.default.createElement(b.Dropdown,{theme:"dark",content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},f.default.createElement(b.Button,{icon:"more",type:"flat"})))),f.default.createElement("ul",{className:R.default.pods,style:p},u.map((function(t){return f.default.createElement(O.default,{data:t,key:t.uid,prefix:e.prefix})}))))}},{key:"prefix",get:function(){var e=this.props,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r)}}]),r}(f.default.Component);a.default=D,D.propTypes={namespace:p.default.string,data:p.default.object,isGovernor:p.default.bool,showEditModal:p.default.func,onTakeover:p.default.func},D.defaultProps={namespace:"",data:{},isGovernor:!0,maxLength:0,jobDetail:{},showEditModal:function(){}}},3877:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(14),a(4),a(18),a(43),a(11);var n=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),l=r(a(37)),i=r(a(0)),u=a(437),d=r(a(26)),f=a(189),p=r(a(863)),m=a(803),h=r(a(1613));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,l.default)(e);if(t){var n=(0,l.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=function(e){(0,c.default)(a,e);var t=v(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).handleLinkClick=function(){localStorage.setItem("pod-detail-referrer","".concat(e.props.prefix,"/pods"))},e}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.prefix,r=t.podStatus.type,n="".concat(a,"/pods/").concat(t.name);return i.default.createElement("li",null,i.default.createElement("div",{className:h.default.icon},i.default.createElement(f.Icon,{name:"pod",size:24}),i.default.createElement(p.default,{type:r.toLowerCase(),className:h.default.status,flicker:!0})),i.default.createElement(u.Link,{to:n},i.default.createElement("span",{onClick:this.handleLinkClick},t.name)),i.default.createElement("div",{className:h.default.metric},i.default.createElement(f.Icon,{name:"memory",size:20}),i.default.createElement("div",null,(0,m.getSuitableValue)((0,d.default)(t,"metrics.memory.value[1]"),"memory"))),i.default.createElement("div",{className:h.default.metric},i.default.createElement(f.Icon,{name:"cpu",size:20}),i.default.createElement("div",null,(0,m.getSuitableValue)((0,d.default)(t,"metrics.cpu.value[1]"),"cpu"))))}}]),a}(i.default.Component);t.default=_},3878:function(e,a,r){"use strict";r(16);var n=r(19);r(44),r(20),r(4),r(18),r(11),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(44),r(20),r(29),r(4),r(440),r(18),r(43),r(11),r(110);var o=n(r(317)),c=n(r(31)),s=n(r(97)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=n(r(830)),h=n(r(26)),v=n(r(1)),_=n(r(5)),g=r(189),y=r(480),E=n(r(3879)),b=n(r(3880)),S=n(r(1233));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var R=function(e){(0,u.default)(r,e);var a=O(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleTypeChange=function(e){var a=e.currentTarget.dataset.type;t.setState({selectedType:a})},t.state={newMetrics:{},oldMetrics:{},selectedType:"traffic-in"},t.getData(),t}return(0,i.default)(r,[{key:"componentDidUpdate",value:function(e){(0,m.default)(this.props.detail,e.detail)||this.getData(this.props)}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){e.getData()}),1e4)}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"getData",value:function(e){var t=this,a=(e||this.props).detail;a&&a.namespace&&this.store.fetchMetrics(a,{duration:1800}).then((function(e){var a=(0,s.default)(e,2),r=a[0],n=a[1];t.setState({newMetrics:r,oldMetrics:n})}))}},{key:"render",value:function(){var e=this,t=this.state.selectedType,a="tcp"===this.props.detail.protocol?this.tcpMetrics:this.metrics,r=a.find((function(e){return e.type===t}));return p.default.createElement(g.Columns,null,p.default.createElement(g.Column,{className:"is-narrow"},p.default.createElement("ul",{className:S.default.leftPane},a.map((function(a){return p.default.createElement("li",{key:a.type,className:(0,_.default)((0,c.default)({},S.default.selected,a.type===t)),"data-type":a.type,onClick:e.handleTypeChange},p.default.createElement(E.default,(0,o.default)({},a,{whiteMode:a.type===t})))})))),p.default.createElement(g.Column,null,r&&p.default.createElement(b.default,r)))}},{key:"store",get:function(){return this.props.store}},{key:"metrics",get:function(){var e=this.props.detail;if(!e)return[];var a=this.state,r=a.newMetrics,n=a.oldMetrics,o=[(0,h.default)(r,"request_count[0].datapoints",[]),(0,h.default)(n,"request_count[0].datapoints",[])],c=[(0,h.default)(r,"request_error_count[0].datapoints",[]),(0,h.default)(n,"request_error_count[0].datapoints",[])],l=[o[0].map((function(e,t){return(0,y.getSuccessRate)(e,c[0][t])})),o[1].map((function(e,t){return(0,y.getSuccessRate)(e,c[1][t])}))],i=[(0,h.default)(r,"request_duration_millis[0].datapoints",[]).map((function(e){var t=(0,s.default)(e,2),a=t[0],r=t[1];return[a,parseFloat(r)/1e3]})),(0,h.default)(n,"request_duration_millis[0].datapoints",[]).map((function(e){var t=(0,s.default)(e,2),a=t[0],r=t[1];return[a,parseFloat(r)/1e3]}))];return[{type:"traffic-in",title:t("TRAFFIC"),legendData:[e.newVersion,e.oldVersion],data:o,unit:"RPS",tip:t("TRAFFIC_IN_LAST_FIVE_MINUTES")},{type:"request_success_rate",title:t("SUCCESSFUL_REQUEST_RATE"),legendData:[e.newVersion,e.oldVersion],data:l,unit:"%"},{type:"request_duration",title:t("REQUEST_LATENCY"),legendData:[e.newVersion,e.oldVersion],data:i,unit:"ms"}]}},{key:"tcpMetrics",get:function(){var e=this.props.detail;if(!e)return[];var a=this.state,r=a.newMetrics,n=a.oldMetrics,o=[(0,h.default)(r,"tcp_received[0].datapoints",[]),(0,h.default)(n,"tcp_received[0].datapoints",[])],c=[(0,h.default)(r,"tcp_sent[0].datapoints",[]),(0,h.default)(n,"tcp_sent[0].datapoints",[])];return[{type:"traffic-in",title:t("TCP_INBOUND_TRAFFIC"),legendData:[e.newVersion,e.oldVersion],data:o,unit:"B/s",icon:"next"},{type:"traffic-out",title:t("TCP_OUTBOUND_TRAFFIC"),legendData:[e.newVersion,e.oldVersion],data:c,unit:"B/s",icon:"previous"}]}}]),r}(p.default.Component);a.default=R,R.propTypes={detail:v.default.object,store:v.default.object}},3879:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(24),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(24),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=n(r(1)),f=n(r(26)),p=r(189),m=r(820),h=r(803),v=n(r(1233));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var g=function(e){(0,s.default)(r,e);var a=_(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return(e=a.call.apply(a,[this].concat(n))).getSeriesData=function(){var t=e.props,a=t.data,r=t.legendData,n=t.whiteMode,o=a[0]?(0,f.default)(a[0],"[".concat(a[0].length-1,"].[1]"),NaN):NaN,c=a[1]?(0,f.default)(a[1],"[".concat(a[1].length-1,"].[1]"),NaN):NaN;return[{name:r[0],itemStyle:{fill:n?"#ffffff":"#329dce"},value:Number(o)},{name:r[1],itemStyle:{fill:n?"#6fbadc":"#c7deef"},value:Number(c)}]},e}return(0,c.default)(r,[{key:"renderTip",value:function(){var e=this.props,t=e.tip,a=e.whiteMode;return u.default.createElement(p.Tooltip,{content:t},u.default.createElement(p.Icon,{name:"information",className:v.default.tip,type:a?"light":"dark"}))}},{key:"render",value:function(){var e=this.props,a=e.title,r=e.tip,n=e.data,o=e.unit,c=n[0]?(0,f.default)(n[0],"[".concat(n[0].length-1,"].[1]"),NaN):NaN,s=n[1]?(0,f.default)(n[1],"[".concat(n[1].length-1,"].[1]"),NaN):NaN;return u.default.createElement("div",{className:v.default.chart},u.default.createElement("div",{className:v.default.circle},u.default.createElement(m.PieChart,{width:40,height:40,data:this.getSeriesData()})),u.default.createElement("div",{className:v.default.chartDetail},u.default.createElement("div",{className:v.default.title},a," ",r&&this.renderTip()),u.default.createElement("div",null,u.default.createElement("span",{className:v.default.tag},isNaN(c)?t("NO_DATA_SCAP"):"".concat((0,h.getSuitableValue)(c,o)," ").concat(o)),u.default.createElement("span",{className:v.default.tag},isNaN(s)?t("NO_DATA_SCAP"):"".concat((0,h.getSuitableValue)(s,o)," ").concat(o)))))}}]),r}(u.default.Component);a.default=g,g.propTypes={title:d.default.string,unit:d.default.string,data:d.default.array,legendData:d.default.array,whiteMode:d.default.bool},g.defaultProps={title:"",data:[],legendData:[],whiteMode:!1}},3880:function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(20),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(10),a(6),a(20),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var n=r(a(31)),o=r(a(50)),c=r(a(25)),s=r(a(28)),l=r(a(41)),i=r(a(42)),u=r(a(37)),d=r(a(0)),f=r(a(1)),p=a(803),m=a(820),h=r(a(1233));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=function(e){(0,l.default)(a,e);var t=_(a);function a(){return(0,c.default)(this,a),t.apply(this,arguments)}return(0,s.default)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.legendData,r=(0,o.default)(e,["data","legendData"]),c=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({width:"100%",legend:a,data:t.map((function(e){return{values:e}})),areaColors:["#329dce","#c7deef"]},r);return d.default.createElement("div",{className:h.default.chart},d.default.createElement(m.SimpleArea,(0,p.getAreaChartOps)(c)))}}]),a}(d.default.Component);t.default=g,g.propTypes={title:f.default.string,unit:f.default.string,data:f.default.array,legendData:f.default.array},g.defaultProps={title:"",data:[],legendData:[]}},3881:function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),o=r(a(50)),c=r(a(25)),s=r(a(28)),l=r(a(41)),i=r(a(42)),u=r(a(37)),d=r(a(0)),f=r(a(1)),p=r(a(1008)),m=r(a(3882));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var v=function(e){(0,l.default)(a,e);var t=h(a);function a(){return(0,c.default)(this,a),t.apply(this,arguments)}return(0,s.default)(a,[{key:"render",value:function(){var e=this.props,t=e.module,a=(0,o.default)(e,["module"]);return d.default.createElement(p.default,(0,n.default)({title:"EDIT_GRAYSCALE_RELEASE_TASK",icon:"components",module:t,forms:this.forms},a))}},{key:"forms",get:function(){return m.default}}]),a}(d.default.Component);t.default=v,v.propTypes={module:f.default.string},v.defaultProps={module:"grayreleases"}},3882:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(3883)),o=r(a(3888)),c=[{icon:"appcenter",name:"grayReleaseComponent",title:"NEW_VERSION_SETTINGS",component:n.default},{icon:"appcenter",name:"grayReleaseStrategy",title:"STRATEGY_SETTINGS",component:o.default}];t.default=c},3883:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(26));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var f=function(e){(0,s.default)(r,e);var a=d(r);function r(){var e;(0,o.default)(this,r);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=a.call.apply(a,[this].concat(c))).versionValidator=function(a,r,n){if(!r)return n();if(r===(0,u.default)(e.formTemplate,'metadata.labels["version"]',""))return n();var o=(0,u.default)(e.formTemplate,"metadata.labels.app",""),c="".concat(o,"-").concat(r);e.workloadStore.checkName({name:c,namespace:e.namespace,cluster:e.props.cluster}).then((function(e){if(e.exist)return n({message:t("VERSION_EXISTS"),field:a.field});n()}))},e}return(0,c.default)(r,[{key:"templatePrefix",get:function(){return"workload"}},{key:"isEdit",get:function(){return!0}}]),r}(n(r(3884)).default);a.default=f},3884:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(26)),p=n(r(68)),m=n(r(808)),h=n(r(0)),v=r(243),_=r(189),g=n(r(1427)),y=n(r(900)),E=n(r(319)),b=r(56),S=r(61),O=n(r(3885)),R=n(r(3887));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var C=(0,v.observer)(o=function(e){(0,i.default)(r,e);var a=k(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).versionValidator=function(e,a,r){if(!a)return r();var o=(0,f.default)(n.formTemplate,"metadata.labels.app",""),c="".concat(o,"-").concat(a);n.workloadStore.checkName({name:c,namespace:n.namespace,cluster:n.props.cluster}).then((function(a){if(a.exist)return r({message:t("NEW_VERSION_NUMBER_EXIST_DESC",{name:c}),field:e.field});r()}))},n.handleVersionChange=(0,m.default)((function(e){var t=(0,f.default)(n.formTemplate,"metadata.labels.app",""),a="".concat(t,"-").concat(e);(0,p.default)(n.formTemplate,"metadata.name",a),(0,b.mergeLabels)(n.formTemplate,{version:e}),(0,p.default)(n.props.formTemplate,'strategy.metadata.annotations["servicemesh.kubesphere.io/newWorkloadName"]',a)}),200),n.module=(0,f.default)(e.formTemplate,'strategy.metadata.annotations["servicemesh.kubesphere.io/workloadType"]',"deployments"),n.workloadStore=new E.default(n.module),n}return(0,l.default)(r,[{key:"renderReplicasControl",value:function(){return h.default.createElement(_.Column,{className:"is-narrow"},h.default.createElement(_.Form.Item,{className:R.default.narrow,label:t("NEW_VERSION_NUMBER"),desc:t("NEW_VERSION_NUMBER_DESC"),rules:[{required:!0,message:t("NEW_VERSION_NUMBER_EMPTY_DESC")},{pattern:S.PATTERN_COMPONENT_VERSION,message:t("NEW_VERSION_NUMBER_INVALID_DESC")},{validator:this.versionValidator}]},h.default.createElement(_.Input,{name:"metadata.labels.version",onChange:this.handleVersionChange,disabled:this.isEdit,maxLength:16})),h.default.createElement("div",{className:R.default.specify},h.default.createElement(_.Form.Item,null,h.default.createElement(g.default,{name:"spec.replicas"}))))}},{key:"renderContainerList",value:function(){var e=(0,f.default)(this.formTemplate,"".concat(this.prefix,"spec"));return h.default.createElement(_.Column,null,h.default.createElement(_.Form.Item,{rules:[{validator:this.containersValidator}]},h.default.createElement(O.default,{className:R.default.containers,name:"".concat(this.prefix,"spec.containers"),onShow:this.showContainer,onDelete:this.handleDelete,specTemplate:e,disabled:this.isEdit})))}},{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formProps,r=this.state,n=r.showContainer,o=r.selectContainer;return n?this.renderContainerForm(o):h.default.createElement(_.Form,(0,c.default)({data:this.formTemplate,ref:t},a),h.default.createElement(_.Columns,null,this.renderReplicasControl(),this.renderContainerList()))}},{key:"formTemplate",get:function(){return this.props.formTemplate.workload||{}}},{key:"namespace",get:function(){return(0,f.default)(this.formTemplate,"metadata.namespace")}}]),r}(y.default))||o;a.default=C},3885:function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(20),a(29),a(14),a(4),a(18),a(43),a(11);var n=r(a(25)),o=r(a(28)),c=r(a(215)),s=r(a(41)),l=r(a(42)),i=r(a(37)),u=r(a(0)),d=r(a(1348)),f=r(a(3886)),p=r(a(1614));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var h=function(e){(0,s.default)(a,e);var t=m(a);function a(){return(0,n.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"renderEmpty",value:function(){return null}},{key:"renderContainers",value:function(){var e=this,t=this.props,a=t.value,r=t.disabled;return u.default.createElement("ul",{className:p.default.list},a.map((function(t){return u.default.createElement(f.default,{container:t,key:t.name,onEdit:e.handleEdit,onDelete:e.handleDelete,disabled:r})})))}},{key:"renderInitContainers",value:function(){var e=this,t=this.props,a=t.specTemplate.initContainers,r=void 0===a?[]:a,n=t.disabled;return r.map((function(t){return u.default.createElement(f.default,{container:t,key:t.name,type:"init",onEdit:e.handleEdit,onDelete:e.handleDelete,disabled:n})}))}},{key:"renderAdd",value:function(){return this.props.disabled?null:(0,c.default)((0,i.default)(a.prototype),"renderAdd",this).call(this)}}]),a}(d.default);t.default=h},3886:function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var o=n(r(31)),c=n(r(0)),s=n(r(1)),l=r(189),i=n(r(828)),u=n(r(1614));function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p=function(e){var a=e.type,r=void 0===a?"worker":a,n=e.container,o=e.onEdit,s=e.onDelete,d=e.disabled,p=c.default.createElement("div",{className:u.default.inputs},c.default.createElement(l.Input,{defaultValue:n.image,onChange:function(e,t){n.image=t},disabled:d})),m="init"===r?c.default.createElement("span",null,n.name,c.default.createElement(l.Tag,{className:"margin-l8",type:"warning"},t("INIT_CONTAINER"))):n.name;return c.default.createElement(i.default.Item,{icon:"docker",title:m,className:u.default.card,description:t("GRAYSCALE_IMAGE",{image:n.image}),extras:p,onDelete:!d&&function(){return s(f({type:r},n))},onEdit:!d&&function(){return o(f({type:r},n))}})};p.propTypes={container:s.default.object};var m=p;a.default=m},3887:function(e,t,a){e.exports={narrow:"_3MyIBanS39Yy2xFvGvD2Ax",specify:"_2_94GzmKeNJkOU-YlzOdQX",containers:"_2WkVQ3Y2P9QTDsKKkqH3gR"}},3888:function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n,o=r(a(317)),c=r(a(25)),s=r(a(28)),l=r(a(41)),i=r(a(42)),u=r(a(37)),d=r(a(0)),f=a(243),p=r(a(26)),m=r(a(3889)),h=r(a(3900)),v=r(a(3904));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g={Canary:m.default,Bluegreen:h.default,Mirror:v.default},y=(0,f.observer)(n=function(e){(0,l.default)(a,e);var t=_(a);function a(){return(0,c.default)(this,a),t.apply(this,arguments)}return(0,s.default)(a,[{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formProps,r=g[this.strategyType];return r?d.default.createElement(r,(0,o.default)({formRef:t,formTemplate:this.formTemplate},a)):null}},{key:"strategyType",get:function(){return(0,p.default)(this.formTemplate,"strategy.spec.type","")}},{key:"formTemplate",get:function(){return this.props.formTemplate}}]),a}(d.default.Component))||n;t.default=y},3889:function(e,a,r){"use strict";r(16);var n=r(19);r(44),r(6),r(98),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(44),r(6),r(98),r(29),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(26)),d=n(r(68)),f=n(r(67)),p=n(r(831)),m=n(r(0)),h=r(189),v=n(r(3890)),_=n(r(3892)),g=n(r(3899));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var E=function(e){(0,s.default)(r,e);var a=y(r);function r(e){var t;(0,o.default)(this,r),(t=a.call(this,e)).initFormTemplate=function(e){var a=t.props.formTemplate,r=(0,u.default)(a,"strategy.spec.template.spec.hosts[0]"),n=(0,u.default)(a,"strategy.spec.principal"),o=(0,u.default)(a,"workload.metadata.labels.version"),c="traffic"===e?[{route:[{destination:{subset:n,host:r}},{destination:{subset:o,host:r}}]}]:[{route:[{destination:{subset:o,host:r},weight:100}]},{route:[{destination:{subset:n,host:r},weight:100}]}];if(t.oldHttpData&&(1===t.oldHttpData.length&&"traffic"===e||2===t.oldHttpData.length&&"content"===e))if("traffic"===e){var s=(0,u.default)(t.oldHttpData,"[0].route",[]),l=s.find((function(e){return(0,u.default)(e,"destination.subset")===n})),i=s.find((function(e){return(0,u.default)(e,"destination.subset")===o}));l&&i&&((0,d.default)(c[0],"route[0].weight",l.weight),(0,d.default)(c[0],"route[1].weight",i.weight))}else{var f=t.oldHttpData.find((function(e){return!!e.match}));(0,d.default)(c[0],"match",f.match)}"tcp"===t.protocol&&c.forEach((function(e){e.match=e.match||[]})),(0,d.default)(t.formTemplate,t.strategyPath,c)},t.handleModeChange=function(e){t.initFormTemplate(e),t.setState({mode:e})};var n=(0,u.default)(t.formTemplate,t.strategyPath,[]);return t.state={mode:n.some((function(e){return!(0,f.default)(e.match)}))?"content":"traffic"},t.oldHttpData=(0,p.default)(n),t.initFormTemplate(t.state.mode),t}return(0,c.default)(r,[{key:"renderContent",value:function(){return"traffic"===this.state.mode?m.default.createElement(v.default,this.props):m.default.createElement(_.default,this.props)}},{key:"render",value:function(){return m.default.createElement("div",{className:g.default.wrapper},m.default.createElement("div",{className:g.default.bar},m.default.createElement(h.RadioGroup,{mode:"button",value:this.state.mode,onChange:this.handleModeChange,size:"small"},m.default.createElement(h.RadioButton,{value:"traffic"},t("SPECIFY_TRAFFIC_DISTRIBUTION")),m.default.createElement(h.RadioButton,{value:"content",disabled:"http"!==this.protocol},t("SPECIFY_REQUEST_PARAMETERS"))),this.protocol&&m.default.createElement(h.Tooltip,{content:t("POLICY_REQUEST_CONTENT_TIP")},m.default.createElement(h.Icon,{className:g.default.tip,name:"question"}))),m.default.createElement("div",{className:g.default.contentWrapper},this.renderContent()))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"protocol",get:function(){return(0,u.default)(this.formTemplate,"spec.protocol","http")}},{key:"strategyPath",get:function(){return"spec.template.spec.".concat(this.protocol)}}]),r}(m.default.Component);a.default=E},3890:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var o=n(r(317)),c=n(r(50)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(26)),p=n(r(68)),m=n(r(163)),h=n(r(0)),v=r(189),_=n(r(1172)),g=n(r(3891));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var E=function(e){(0,i.default)(r,e);var a=y(r);function r(e){var t;return(0,s.default)(this,r),(t=a.call(this,e)).handleRatioChange=function(e){t.setState({ratio:e},(function(){(0,p.default)(t.oldRoute,"weight",100-e)}))},t.state={ratio:(0,f.default)(t.newRoute,"weight",50)},t}return(0,l.default)(r,[{key:"componentDidMount",value:function(){var e=(0,f.default)(this.oldRoute,"weight"),t=(0,f.default)(this.newRoute,"weight");(0,m.default)(e)&&(0,p.default)(this.oldRoute,"weight",100-this.state.ratio),(0,m.default)(t)&&(0,p.default)(this.newRoute,"weight",this.state.ratio)}},{key:"render",value:function(){var e=this.state.ratio,a=this.props,r=a.formRef,n=(a.formTemplate,(0,c.default)(a,["formRef","formTemplate"])),s=(0,f.default)(this.formTemplate,"spec.template.spec.hosts[0]"),l=(0,f.default)(this.newRoute,"destination.subset"),i=(0,f.default)(this.oldRoute,"destination.subset"),u="".concat(l," ").concat(t("TRAFFIC_LOW")),d="".concat(i," ").concat(t("TRAFFIC_LOW"));return h.default.createElement("div",{className:g.default.wrapper},h.default.createElement("div",{className:g.default.item},h.default.createElement(v.Alert,{type:"info",message:t.html("CANARY_BY_TRAFFIC_DESC",{ratio:e,component:s,newVersion:l})})),h.default.createElement("div",{className:g.default.item},h.default.createElement("div",{className:g.default.title},t("TRAFFIC_DISTRIBUTION")),h.default.createElement(v.Form,(0,o.default)({ref:r,data:this.formTemplate},n),h.default.createElement(v.Form.Item,null,h.default.createElement(_.default,{name:"".concat(this.strategyPath,"[0].route[1].weight"),min:0,max:100,leftContent:u,rightContent:d,onChange:this.handleRatioChange})))))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"strategyPath",get:function(){var e=(0,f.default)(this.formTemplate,"spec.protocol","http");return"spec.template.spec.".concat(e)}},{key:"oldRoute",get:function(){return(0,f.default)(this.formTemplate,"".concat(this.strategyPath,"[0].route[0]"),{})}},{key:"newRoute",get:function(){return(0,f.default)(this.formTemplate,"".concat(this.strategyPath,"[0].route[1]"),{})}}]),r}(h.default.Component);a.default=E},3891:function(e,t,a){e.exports={wrapper:"nETb4KMOztrWN5hml6q98",title:"_1rwGy_A6FaU6W5jHRrwFlf",item:"_383D6mqvtF_Sw426o7q_GW"}},3892:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(9),r(4),r(190),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(9),r(4),r(190),r(18),r(43),r(11);var o=n(r(317)),c=n(r(50)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(26)),p=n(r(67)),m=n(r(196)),h=n(r(0)),v=r(189),_=r(61),g=n(r(3893)),y=n(r(3895)),E=n(r(3897)),b=n(r(3898));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var O=function(e){(0,i.default)(r,e);var a=S(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleCookieChange=function(t){e.setState({cookie:t})},e.handleFormChange=function(t,a){t==="".concat(e.prefix,".match[0].headers.cookie")?(0,p.default)(Object.values(a)[0])&&(0,m.default)(e.formTemplate,t):t==="".concat(e.prefix,".match[0].headers")?(0,p.default)(Object.keys(a)[0])&&(0,m.default)(e.formTemplate,t):t==="".concat(e.prefix,".match[0].uri")?(0,p.default)(Object.values(a)[0])&&(0,m.default)(e.formTemplate,t):t==="".concat(e.prefix,".match[0].headers['User-Agent'].regex")&&(0,p.default)(a)&&(0,m.default)(e.formTemplate,"".concat(e.prefix,".match[0].headers['User-Agent']"))},e}return(0,l.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=(e.formTemplate,(0,c.default)(e,["formRef","formTemplate"]));return h.default.createElement("div",{className:b.default.wrapper},h.default.createElement("div",{className:b.default.item},h.default.createElement(v.Alert,{type:"info",message:t("SPECIFY_REQUEST_PARAMETERS_DESC")})),h.default.createElement("div",{className:b.default.item},h.default.createElement("div",{className:b.default.title},t("REQUEST_PARAMETERS")),h.default.createElement(v.Form,(0,o.default)({ref:a,data:this.formTemplate,onChange:this.handleFormChange},r),h.default.createElement(v.Form.Item,{label:t("COOKIE")},h.default.createElement(g.default,{name:"".concat(this.prefix,".match[0].headers.cookie"),onChange:this.handleCookieChange,placeholder:t("KEY_EQ_VALUE")})),h.default.createElement(v.Form.Item,{label:t("HEADER")},h.default.createElement(y.default,{name:"".concat(this.prefix,".match[0].headers")})),h.default.createElement(v.Form.Item,{label:"URL"},h.default.createElement(g.default,{name:"".concat(this.prefix,".match[0].uri"),placeholder:"URL",matchTypes:["prefix","regex"]})),h.default.createElement(v.Form.Item,{label:t("CLIENT_OS")},h.default.createElement(E.default,{name:"".concat(this.prefix,".match[0].headers['User-Agent'].regex"),options:_.GRAY_RELEASE_CANARY_CONTENT})))))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"prefix",get:function(){var e=(0,f.default)(this.formTemplate,"spec.protocol","http");return"spec.template.spec.".concat(e,"[0]")}}]),r}(h.default.Component);a.default=O},3893:function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(70),r(9),r(4),r(18),r(30),r(11),r(73),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(70),r(29),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(69);var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=n(r(1)),p=n(r(808)),m=r(189),h=n(r(3894));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=function(e){(0,l.default)(r,e);var a=v(r);function r(e){var t;(0,c.default)(this,r),(t=a.call(this,e)).triggerChange=(0,p.default)((function(){var e=t.state,a=e.match,r=e.value,n=t.props.onChange;a&&n((0,o.default)({},a,r||""))}),200),t.handleMatchChange=function(e){t.setState({match:e},(function(){t.triggerChange()}))},t.handleValueChange=function(e,a){t.setState({value:a},(function(){t.triggerChange()}))};var n=Object.keys(e.value)[0]||t.matchTypes[0].value;return t.state={match:n,value:e.value[n]||""},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.state,a=e.match,r=e.value;return d.default.createElement("div",{className:h.default.match},d.default.createElement(m.Select,{value:a,options:this.matchTypes,onChange:this.handleMatchChange}),d.default.createElement(m.Input,{value:r,placeholder:this.props.placeholder||t("KEY_EQ_VALUE"),onChange:this.handleValueChange}))}},{key:"matchTypes",get:function(){var e=this.props.matchTypes;return[{label:t("EXACT_MATCH"),value:"exact"},{label:t("PREFIX_MATCH"),value:"prefix"},{label:t("REGEX_MATCH"),value:"regex"}].filter((function(t){var a=t.value;return e.includes(a)}))}}]),r}(d.default.Component);a.default=_,_.propTypes={value:f.default.object,onChange:f.default.func,matchTypes:f.default.array},_.defaultProps={value:{},onChange:function(){},matchTypes:["exact","regex"]}},3894:function(e,t,a){e.exports={match:"_1NxalZ4Q_iF0oawMFUygN8"}},3895:function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(70),r(8),r(13),r(9),r(4),r(190),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37));r(12),r(32),r(10),r(6),r(70),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(18),r(43),r(30),r(11),r(69),r(7);var d=n(r(0)),f=n(r(1)),p=n(r(808)),m=n(r(244)),h=r(189),v=n(r(3896));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var y=["cookie","User-Agent"],E=function(e){(0,l.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).triggerChange=(0,p.default)((function(){var e=t.state,a=e.match,r=e.key,n=e.value,c=t.props,s=c.onChange,l=c.value;s(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}((0,o.default)({},r,(0,o.default)({},a,n)),(0,m.default)(l,y)))}),200),t.handleMatchChange=function(e){t.setState({match:e},(function(){t.triggerChange()}))},t.handleKeyChange=function(e,a){t.setState({key:a},(function(){t.triggerChange()}))},t.handleValueChange=function(e,a){t.setState({value:a},(function(){t.triggerChange()}))},t.state=function(e){var t=Object.keys(e.value).filter((function(e){return!y.includes(e)}))[0];return{key:t,match:(t?Object.keys(e.value[t])[0]:"exact")||"exact",value:(t?Object.values(e.value[t])[0]:"")||""}}(e),t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.state,a=e.match,r=e.key,n=e.value;return d.default.createElement("div",{className:v.default.match},d.default.createElement(h.Select,{value:a,defaultValue:"exact",options:this.matchTypes,onChange:this.handleMatchChange}),d.default.createElement(h.Input,{value:r,placeholder:t("KEY"),onChange:this.handleKeyChange}),d.default.createElement(h.Input,{value:n,placeholder:t("VALUE"),onChange:this.handleValueChange}))}},{key:"matchTypes",get:function(){return[{label:t("EXACT_MATCH"),value:"exact"},{label:t("REGEX_MATCH"),value:"regex"}]}}]),r}(d.default.Component);a.default=E,E.propTypes={value:f.default.object,onChange:f.default.func},E.defaultProps={value:{},onChange:function(){}}},3896:function(e,t,a){e.exports={match:"_38Cti3g5qY_E84pX1BMFTq"}},3897:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(66),a(51),a(4),a(18),a(30),a(11),a(139),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(66),a(51),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),o=r(a(25)),c=r(a(28)),s=r(a(41)),l=r(a(42)),i=r(a(37)),u=r(a(0)),d=r(a(1426)),f=r(a(67));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var m=function(e){(0,s.default)(a,e);var t=p(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).getValueFromProps=function(e){return e.value?e.value.slice(3,e.value.length-3).split("|"):[]},e.handleChange=function(t){var a=e.props.onChange;(0,f.default)(t)?a&&a(""):a&&a(".*(".concat(t.join("|"),").*"))},e}return(0,c.default)(a,[{key:"render",value:function(){var e=this.getValueFromProps(this.props);return u.default.createElement(d.default,(0,n.default)({},this.props,{value:e,onChange:this.handleChange}))}}]),a}(u.default.Component);t.default=m},3898:function(e,t,a){e.exports={wrapper:"_1aRgespwFUWU9GqbQKeG92",title:"_3z2kLZ8Z3DiGGoAJcdF4mK",item:"dfPzevqogHOiFt1iKPbzS"}},3899:function(e,t,a){e.exports={wrapper:"-dBWXCBE13eJRQLETuS_r",bar:"_1sECNuIPwCvR2dUOMjhl4R",contentWrapper:"_3b2bEEWVzoUh58GIlURRy6",tip:"_2hEEnwJXIG-QlbIGZ8yWGY"}},3900:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(6),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(6),r(29),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o=n(r(317)),c=n(r(50)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=n(r(26)),m=n(r(68)),h=n(r(67)),v=r(189),_=n(r(3901)),g=n(r(3903));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var E=function(e){(0,i.default)(r,e);var a=y(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).state={versions:[]},e.handleVersionChange=function(t){(0,p.default)(e.formTemplate,"spec.principal")===t?((0,m.default)(e.formTemplate,"".concat(e.strategyPath,"[0].route[0].weight"),100),(0,m.default)(e.formTemplate,"".concat(e.strategyPath,"[0].route[1].weight"),0)):((0,m.default)(e.formTemplate,"".concat(e.strategyPath,"[0].route[0].weight"),0),(0,m.default)(e.formTemplate,"".concat(e.strategyPath,"[0].route[1].weight"),100))},e}return(0,l.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.formTemplate,t=(0,p.default)(e,"strategy.spec.template.spec.hosts[0]"),a=(0,p.default)(e,"strategy.spec.principal"),r=(0,p.default)(e,"workload.metadata.labels.version"),n=(0,p.default)(e,"workload.spec.replicas"),o=(0,p.default)(e,'strategy.metadata.annotations["servicemesh.kubesphere.io/workloadReplicas"]',0),c=[{route:[{destination:{subset:a,host:t},weight:100},{destination:{subset:r,host:t},weight:0}]}];"tcp"===this.protocol&&c.forEach((function(e){e.match=e.match||[]})),(0,h.default)((0,p.default)(this.formTemplate,"spec.governor"))&&(0,m.default)(this.formTemplate,"spec.governor",a),(0,h.default)((0,p.default)(this.formTemplate,this.strategyPath))&&(0,m.default)(this.formTemplate,this.strategyPath,c),this.setState({versions:[{name:a,replicas:o},{name:r,replicas:n}]})}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=(e.formTemplate,(0,c.default)(e,["formRef","formTemplate"]));return f.default.createElement("div",{className:g.default.wrapper},f.default.createElement("div",{className:g.default.item},f.default.createElement("p",null,t("BLUE_GREEN_STRATEGY_DESC"))),f.default.createElement("div",{className:g.default.item},f.default.createElement("div",{className:g.default.title},t("SELECT_VERSION")),f.default.createElement(v.Form,(0,o.default)({ref:a,data:this.formTemplate},r),f.default.createElement(v.Form.Item,null,f.default.createElement(_.default,{name:"spec.governor",options:this.state.versions,onChange:this.handleVersionChange})))))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"protocol",get:function(){return(0,p.default)(this.formTemplate,"spec.protocol","http")}},{key:"strategyPath",get:function(){return"spec.template.spec.".concat(this.protocol)}}]),r}(f.default.Component);a.default=E},3901:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=n(r(1)),p=n(r(5)),m=r(189),h=n(r(3902));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=function(e){(0,l.default)(r,e);var a=v(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleTakeOver=function(t){e.props.onChange(t.currentTarget.dataset.version)},e.handleOffline=function(t){var a=e.props,r=a.onChange,n=a.options,o=t.currentTarget.dataset.version,c=n.find((function(e){return e.name!==o}));c&&r(c.name)},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.value,n=a.options;return d.default.createElement("ul",{className:h.default.wrapper},n.map((function(a){return d.default.createElement("li",{key:a.name,className:(0,p.default)((0,o.default)({},h.default.selected,r===a.name))},d.default.createElement(m.Icon,{name:"appcenter",size:40}),d.default.createElement("div",{className:h.default.text},d.default.createElement("p",null,t("GRAYSCALE_VERSION",{version:a.name})),d.default.createElement("p",null,1===a.replicas?t("GRAYSCALE_REPLICA_SI",{count:a.replicas}):t("GRAYSCALE_REPLICA_PL",{count:a.replicas}))),r!==a.name?d.default.createElement(m.Button,{className:h.default.button,type:"control","data-version":a.name,onClick:e.handleTakeOver},t("TAKE_OVER")):d.default.createElement(m.Button,{className:h.default.button,"data-version":a.name,onClick:e.handleOffline},t("TAKE_OFFLINE")))})))}}]),r}(d.default.Component);a.default=_,_.propTypes={value:f.default.string,options:f.default.array,onChange:f.default.func},_.defaultProps={value:"",options:[],onChange:function(){}}},3902:function(e,t,a){e.exports={wrapper:"_3XscnuxSwuZleg8ScGet9M",selected:"pu6IlaTV5o0udnBBkp9Ff",text:"_3EXmNHMRGFVnK-HPq3geRQ",button:"_1Y__cTEragjsYM7DeIP9FS"}},3903:function(e,t,a){e.exports={wrapper:"fPQ8Td9R5A7pYRg5B86NM",title:"_65t8-S2AxDctXS8qxxP-X",item:"hyg1hbrClRD8y-DIg_jOm"}},3904:function(e,a,r){"use strict";r(16);var n=r(19);r(6),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(6),r(29),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=n(r(26)),f=n(r(68)),p=n(r(67)),m=r(189);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var v=function(e){(0,s.default)(r,e);var a=h(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.formTemplate,t=(0,d.default)(e,"strategy.spec.template.spec.hosts[0]"),a=[{route:[{destination:{subset:(0,d.default)(e,"strategy.spec.principal"),host:t},weight:100}],mirror:{host:t,subset:(0,d.default)(e,"workload.metadata.labels.version")}}];"tcp"===this.protocol&&a.forEach((function(e){e.match=e.match||[]})),(0,p.default)((0,d.default)(this.formTemplate,this.strategyPath))&&(0,f.default)(this.formTemplate,this.strategyPath,a)}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate;return u.default.createElement(m.Form,{ref:a,data:r},u.default.createElement(m.Alert,{type:"info",message:t("MIRROR_POLICY_DESC")}))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"protocol",get:function(){return(0,d.default)(this.formTemplate,"spec.protocol","http")}},{key:"strategyPath",get:function(){return"spec.template.spec.".concat(this.protocol)}}]),r}(u.default.Component);a.default=v},3905:function(e,t,a){e.exports={modal:"_1YO6qAa4o5CIAXihai2gp7",header:"_2vVO-uv8lJHWqrVv11v0KR",body:"_2vJZEtSz_f9o_ieM2tvSDQ",title:"_31-lgqfez3yBbVlFo_tUcz",text:"_89vaF9RK4xiC6CTS8AMv7",wrapper:"_3rzjtTdrtDtIU3oXBYyX6A",loading:"lwBciOx7X_Aiezt5FYLpb",sectionTitle:"_3k9GdhtEu1-2BO5qFF2Mb0",matchWrapper:"_1pNGhihrUvVdQ5sBH7TTmb",matchArrow:"_3ruGexdrbaeOPbmO9YdgNM",matchVersion:"Q1EqkLXYIAMTFlJDYgV6b",governor:"_2MPS2QWyT6zjz7d2WTFE8Y",barWrapper:"_2NHJds2bdFgZ_CD9y4Ysvd",bar:"_1V8kzO-zzW71tEbOPLFeU3",mirrorBar:"pK-EmPX1F-LcM21gsSMZP",mirror:"_2r0HBgs_ICewriI-7OZBi8",mirrorIcon:"_25PLS8q5MC3mcxhp2UWRCA",revertMirrorIcon:"LxkxCr-ExgyPESSixjvSr",monitor:"_1DCVu0WUnzdaAxKRZ3yPPS"}},3906:function(e,a,r){"use strict";r(16);var n=r(19);r(44),r(20),r(14),r(24),r(193),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(317)),c=n(r(97)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37));r(32),r(44),r(20),r(29),r(14),r(24),r(193),r(4),r(18),r(43),r(11);var f=n(r(26)),p=n(r(0)),m=n(r(830)),h=r(189),v=r(480),_=r(61),g=n(r(3907)),y=n(r(1234));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}function b(e){var t,a=Number(e);return isNaN(a)||(t=a,Number(t)===t&&t%1==0)?a:a.toFixed(2)}var S=function(e){(0,i.default)(r,e);var a=E(r);function r(e){var t;return(0,s.default)(this,r),(t=a.call(this,e)).handleClick=function(){var e=t.props,a=e.data;(0,e.onClick)(a)},t.state={newMetrics:{},oldMetrics:{},newHealth:{},oldHealth:{}},t}return(0,l.default)(r,[{key:"componentDidMount",value:function(){this.getData()}},{key:"componentWillUnmount",value:function(){this.unmount=!0}},{key:"componentDidUpdate",value:function(e){(0,m.default)(this.props.data,e.data)||this.getData(this.props)}},{key:"getData",value:function(e){var t=this,a=(e||this.props).data;this.store.fetchMetrics(a).then((function(e){var a=(0,c.default)(e,2),r=a[0],n=a[1];t.unmount||t.setState({newMetrics:r,oldMetrics:n})})),this.store.fetchHealth(a).then((function(e){var a=(0,c.default)(e,2),r=a[0],n=a[1];t.unmount||t.setState({newHealth:r,oldHealth:n})}))}},{key:"render",value:function(){var e=this.props.data,a=this.state,r=a.newHealth,n=a.oldHealth,c=_.GRAY_RELEASE_CATEGORIES.find((function(t){return t.type===e.type}))||{},s="tcp"===e.protocol?this.tcpMetrics:this.metrics;return p.default.createElement("div",{className:y.default.item,onClick:this.handleClick},p.default.createElement("div",{className:y.default.left},p.default.createElement("div",{className:y.default.icon},p.default.createElement("img",{src:(0,f.default)(e,'annotations["app.kubernetes.io/icon"]',"/extensions-static/ks-console-embed/dist/v3dist/assets/default-app.svg"),alt:""}),p.default.createElement("div",{className:y.default.iconExtra},p.default.createElement(h.Icon,{name:c.icon,size:24,type:"light"}))),p.default.createElement("div",{className:y.default.title},p.default.createElement("div",{className:"h5"},e.name),p.default.createElement("p",null,p.default.createElement("span",null,t("APP")),":"," ",(0,f.default)(e,'labels["app.kubernetes.io/name"]')),p.default.createElement("p",null,p.default.createElement("span",null,t("RELEASE_MODE")),": ",t("".concat(c.title,"_LOW"))),p.default.createElement("p",null,p.default.createElement("span",null,t("SERVICE")),": ",e.hosts))),p.default.createElement("div",{className:y.default.right},p.default.createElement("div",{className:y.default.versions},p.default.createElement("p",null,p.default.createElement("strong",null,t("VERSIONS"))),p.default.createElement("p",{className:y.default.tag},e.newVersion,"",p.default.createElement("span",null,"(",t("REPLICA_COUNT_LOW"),":"," ",(0,f.default)(r,"workloadStatus.available")||(0,f.default)(r,"workloadStatus.availableReplicas"),"/",(0,f.default)(r,"workloadStatus.replicas")||(0,f.default)(r,"workloadStatus.desiredReplicas"),")")),p.default.createElement("p",{className:y.default.tag},e.oldVersion,"",p.default.createElement("span",null,"(",t("REPLICA_COUNT_LOW"),":"," ",(0,f.default)(n,"workloadStatus.available")||(0,f.default)(n,"workloadStatus.availableReplicas"),"/",(0,f.default)(n,"workloadStatus.replicas")||(0,f.default)(n,"workloadStatus.desiredReplicas"),")"))),s.map((function(e){return p.default.createElement(g.default,(0,o.default)({key:e.type},e))}))))}},{key:"store",get:function(){return this.props.store}},{key:"metrics",get:function(){var e=this.props.data;if(!e)return[];var a=this.state,r=a.newMetrics,n=a.oldMetrics,o=[(0,v.getMetricData)((0,f.default)(r,"request_count[0].datapoints",[]),0),(0,v.getMetricData)((0,f.default)(n,"request_count[0].datapoints",[]),0)],c=[(0,v.getMetricData)((0,f.default)(r,"request_error_count[0].datapoints",[]),0),(0,v.getMetricData)((0,f.default)(n,"request_error_count[0].datapoints",[]),0)],s=[o[0]>0?Number((100*(o[0]-c[0])/o[0]).toFixed(2)):NaN,o[1]>0?Number((100*(o[1]-c[1])/o[1]).toFixed(2)):NaN],l=[(0,v.getMetricData)((0,f.default)(r,"request_duration_millis[0].datapoints",[]),NaN),(0,v.getMetricData)((0,f.default)(n,"request_duration_millis[0].datapoints",[]),NaN)];return[{type:"traffic",name:t("TRAFFIC"),legendData:[e.newVersion,e.oldVersion],data:o.map(b),unit:"RPS",icon:"changing-over",tip:t("TRAFFIC_IN_LAST_FIVE_MINUTES")},{type:"request_success_rate",name:t("SUCCESSFUL_REQUEST_RATE"),legendData:[e.newVersion,e.oldVersion],data:s.map(b),icon:"check",unit:"%"},{type:"request_duration",name:t("REQUEST_LATENCY"),legendData:[e.newVersion,e.oldVersion],data:l.map(b),icon:"timed-task",unit:"ms"}]}},{key:"tcpMetrics",get:function(){var e=this.props.data;if(!e)return[];var a=this.state,r=a.newMetrics,n=a.oldMetrics,o=[(0,v.getMetricData)((0,f.default)(r,"tcp_received[0].datapoints",[]),0),(0,v.getMetricData)((0,f.default)(n,"tcp_received[0].datapoints",[]),0)],c=[(0,v.getMetricData)((0,f.default)(r,"tcp_sent[0].datapoints",[]),0),(0,v.getMetricData)((0,f.default)(n,"tcp_sent[0].datapoints",[]),0)];return[{type:"traffic-in",name:t("TCP_INBOUND_TRAFFIC"),legendData:[e.newVersion,e.oldVersion],data:o.map(b),unit:"B/s",icon:"next"},{type:"traffic-out",name:t("TCP_OUTBOUND_TRAFFIC"),legendData:[e.newVersion,e.oldVersion],data:c.map(b),unit:"B/s",icon:"previous"}]}}]),r}(p.default.Component);a.default=S},3907:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=n(r(1)),f=r(189),p=r(820),m=n(r(1234));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var v=function(e){(0,s.default)(r,e);var a=h(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return(e=a.call.apply(a,[this].concat(n))).getSeriesData=function(){var t=e.props,a=t.data,r=t.legendData;return[{name:r[0],itemStyle:{fill:"#329dce"},value:a[0]||0},{name:r[1],itemStyle:{fill:"#c7deef"},value:a[1]||0}]},e}return(0,c.default)(r,[{key:"renderTip",value:function(){var e=this.props.tip;return u.default.createElement(f.Tooltip,{content:e},u.default.createElement(f.Icon,{name:"information",className:m.default.tip}))}},{key:"render",value:function(){var e=this.props,a=e.name,r=e.icon,n=e.data,o=e.unit,c=e.tip;return u.default.createElement("div",{className:m.default.chart},u.default.createElement("div",{className:m.default.circle},u.default.createElement(f.Icon,{name:r,size:20}),u.default.createElement(p.PieChart,{width:60,height:60,data:this.getSeriesData()})),u.default.createElement("div",{className:m.default.chartDetail},u.default.createElement("div",null,u.default.createElement("strong",null,a)," ",c&&this.renderTip()),u.default.createElement("p",{className:m.default.tag},isNaN(n[0])?t("NO_DATA_SCAP"):"".concat(n[0]," ").concat(o)),u.default.createElement("p",{className:m.default.tag},isNaN(n[1])?t("NO_DATA_SCAP"):"".concat(n[1]," ").concat(o))))}}]),r}(u.default.Component);a.default=v,v.propTypes={name:d.default.string,tip:d.default.string,unit:d.default.string,data:d.default.array,legendData:d.default.array},v.defaultProps={name:"",data:[],legendData:[]}},3908:function(e,t,a){e.exports={header:"_1NlihNgeoVDB3R-HjKAgoV",headerTip:"_2ewkr_stwSEswFhRlWo0M8"}},3909:function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var o,c=n(r(50)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(67)),m=n(r(0)),h=r(17),v=r(243),_=r(56),g=r(189),y=n(r(3910)),E=n(r(3912)),b=n(r(954)),S=r(847),O=n(r(325)),R=n(r(3921));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var T=(0,v.inject)("detailStore")(o=(0,v.observer)(o=function(e){(0,u.default)(r,e);var a=A(r);function r(e){var n;(0,l.default)(this,r),(n=a.call(this,e)).fetchTracing=function(){var e=(0,h.toJS)(n.detailStore.detail),t=C({cluster:e.cluster,namespace:e.namespace,service:n.state.serviceName},n.state.query);n.detailStore.fetchTracing(t)},n.showDetailModal=function(e){n.setState({showDetailModal:!0,selectItem:e})},n.hideDetailModal=function(){n.setState({showDetailModal:!1,selectItem:{}})},n.handleServiceChange=function(e){n.setState({serviceName:e},(function(){n.fetchTracing()}))},n.handleRefresh=function(){n.fetchTracing()},n.handleLookbackChange=function(e){var t=e.step,a=e.times,r=(0,c.default)(e,["step","times"]),o=(0,S.getTimeRange)({step:(0,S.getMinuteValue)(t),times:a}),s=o.start,l=o.end,i=1e3*(r.start||s),u=1e3*(r.end||l);n.setState((function(e){return{query:C(C({},e.query),{},{start:i,end:u})}}),(function(){return n.fetchTracing()}))},n.handleLimitChange=function(e){n.setState((function(t){return{query:C(C({},t.query),{},{limit:e})}}),(function(){return n.fetchTracing()}))},n.serviceRenderer=function(e){return m.default.createElement("span",null,t("SERVICE_VALUE",{value:e.label}))},n.detailStore=e.detailStore,n.serviceStore=new O.default;var o=(0,S.getTimeRange)({step:(0,S.getMinuteValue)("5m"),times:60}),s=o.start,i=o.end;return n.state={showDetailModal:!1,selectItem:{},serviceName:"",query:{limit:5,start:1e3*s,end:1e3*i}},n}return(0,i.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.disposer=(0,h.when)((function(){return!(0,p.default)(e.detailStore.detail)}),(function(){return e.getData()}))}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"getData",value:function(){var e=this,t=(0,h.toJS)(this.detailStore.detail),a=t.selector,r=t.cluster,n=t.namespace;if(a){var o={cluster:r,namespace:n,labelSelector:(0,_.joinSelector)(a)};this.serviceStore.fetchListByK8s(o).then((function(){var t=(0,h.toJS)(e.serviceStore.list.data);t.length>0&&e.setState({serviceName:t[0].name},(function(){return e.fetchTracing()}))}))}}},{key:"renderOperations",value:function(){var e=this.state.query;return m.default.createElement("div",{className:R.default.operations},m.default.createElement(g.Select,{options:this.services,value:this.state.serviceName,prefixIcon:m.default.createElement(g.Icon,{name:"appcenter"}),onChange:this.handleServiceChange,valueRenderer:this.serviceRenderer}),m.default.createElement(b.default,{className:R.default.timeSelect,onChange:this.handleLookbackChange,showStep:!1,dark:!0,arrowIcon:"chevron-down"}),m.default.createElement(g.Select,{value:e.limit,options:this.limitOptions,onChange:this.handleLimitChange}),m.default.createElement(g.Button,{type:"flat",icon:"refresh",onClick:this.handleRefresh}))}},{key:"renderTracing",value:function(){var e=this.detailStore,t=e.tracing,a=e.isTracingLoading,r=this.serviceStore.list,n=r.isLoading,o=r.data;return!n&&(0,p.default)(o)?null:m.default.createElement(y.default,{loading:a,data:t.data,operations:this.renderOperations(),onItemClick:this.showDetailModal})}},{key:"render",value:function(){return m.default.createElement("div",null,this.renderTracing(),m.default.createElement(E.default,{detail:this.state.selectItem,visible:this.state.showDetailModal,onCancel:this.hideDetailModal}))}},{key:"limitOptions",get:function(){return[{label:t("LAST_NUM_RECORDS",{num:5}),value:5},{label:t("LAST_NUM_RECORDS",{num:10}),value:10},{label:t("LAST_NUM_RECORDS",{num:20}),value:20},{label:t("LAST_NUM_RECORDS",{num:50}),value:50}]}},{key:"services",get:function(){return this.serviceStore.list.data.map((function(e){return{label:e.name,value:e.name,type:e.type}}))}}]),r}(m.default.Component))||o)||o;a.default=T},3910:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=n(r(1)),f=n(r(67)),p=r(189),m=n(r(823)),h=n(r(3911)),v=n(r(1615));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var g=function(e){(0,s.default)(r,e);var a=_(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"shouldComponentUpdate",value:function(e){return e.loading!==this.props.loading}},{key:"renderContent",value:function(){var e=this.props,t=e.data,a=e.onItemClick;return(0,f.default)(t)?null:u.default.createElement("div",{className:v.default.cardContent},t.map((function(e){return u.default.createElement(h.default,{key:e.traceID,detail:e,onClick:a})})))}},{key:"renderEmpty",value:function(){return u.default.createElement("div",{className:v.default.empty},u.default.createElement("div",null,u.default.createElement("div",{className:v.default.icon},u.default.createElement(p.Icon,{name:"target",size:40})),u.default.createElement("p",null,u.default.createElement("strong",null,t("NO_DATA"))),u.default.createElement("p",null,t("TRACING_NO_DATA_DESC"))))}},{key:"renderHeader",value:function(){var e=this.props.operations;return u.default.createElement("div",{className:v.default.cardHeader},e&&u.default.createElement("div",{className:v.default.operations},e),t("TRACING"))}},{key:"render",value:function(){var e=this.props.loading;return u.default.createElement(m.default,{className:v.default.tracing,header:this.renderHeader(),empty:this.renderEmpty(),loading:e},this.renderContent())}}]),r}(u.default.Component);a.default=g,g.propTypes={className:d.default.string,data:d.default.array,loading:d.default.bool,operations:d.default.oneOfType([d.default.string,d.default.element,d.default.node]),onItemClick:d.default.func},g.defaultProps={prefix:"",data:[],onItemClick:function(){},loading:!1}},3911:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(20),r(98),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(98),r(29),r(14),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(445)),d=n(r(0)),f=n(r(1)),p=n(r(5)),m=r(56),h=r(940),v=r(189),_=n(r(1615));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var y=function(e){var t=e.key,a=e.value;return"error"===t&&(!0===a||"true"===a)},E=function(e){(0,s.default)(r,e);var a=g(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return(e=a.call.apply(a,[this].concat(n))).handleClick=function(){var t=e.props;(0,t.onClick)(t.detail)},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.className,r=e.detail;if(!r)return null;var n=r.duration,o=r.durationPercent,c=r.services,s=r.startTime,l=r.spans,i=r.traceName,f=r.serviceColorMap,g=(0,m.getLocalTime)(s/1e3),E=g.format("HH:mm:ss"),b=g.fromNow(),S=l.length,O=l.filter((function(e){return e.tags.some(y)})).length;return d.default.createElement("div",{className:(0,p.default)(_.default.item,a),onClick:this.handleClick},d.default.createElement("div",{className:_.default.header},d.default.createElement("div",{className:_.default.title},i),d.default.createElement("div",{className:_.default.duration},d.default.createElement(v.Icon,{name:"timed-task"}),"".concat(n/1e3," ms")),d.default.createElement("div",{className:_.default.durationBar,style:{width:"".concat(o,"%"),borderTopRightRadius:100===o?4:0}})),d.default.createElement("div",{className:_.default.content},d.default.createElement("div",{className:_.default.spanWrapper},d.default.createElement("div",{className:_.default.spans},1===S?t("NUM_SPAN_SI",{num:S}):t("NUM_SPAN_PL",{num:S})),O>0&&d.default.createElement("div",{className:_.default.errorSpans},1===O?t("NUM_ERROR_SI",{num:O}):t("NUM_ERROR_PL",{num:O}))),d.default.createElement("ul",{className:_.default.services},(0,u.default)(c,"name").map((function(e){return d.default.createElement("li",{key:e.name},d.default.createElement("span",{className:_.default.tag,style:{backgroundColor:f[e.name]}}),"".concat(e.name," (").concat(e.numberOfSpans,")"))}))),d.default.createElement("div",{className:_.default.startTime},d.default.createElement("p",null,(0,h.formatRelativeDate)(s/1e3),"|",d.default.createElement("strong",null,E)),d.default.createElement("p",null,b))))}}]),r}(d.default.Component);a.default=E,E.propTypes={className:f.default.string,onClick:f.default.func,detail:f.default.object,durationPercent:f.default.number},E.defaultProps={onClick:function(){},durationPercent:0,detail:{}}},3912:function(e,a,r){"use strict";r(16);var n=r(19);r(6),r(20),r(14),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(6),r(20),r(27),r(29),r(14),r(4),r(321),r(18),r(43),r(11),r(7);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(67)),d=n(r(0)),f=n(r(1)),p=r(189),m=n(r(830)),h=n(r(798)),v=r(56),_=r(940),g=n(r(3913)),y=n(r(3915)),E=n(r(3917)),b=n(r(3920));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var O=function(e){(0,s.default)(r,e);var a=S(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).handleMouseDown=function(e){e.offsetY<4&&(t.originPos=e.y,document.addEventListener("mousemove",t.handleResize,!1))},t.handleMouseUp=function(){document.removeEventListener("mousemove",t.handleResize,!1)},t.handleResize=function(e){var a=t.originPos-e.y;t.originPos=e.y;var r=t.detailPane.current,n=parseInt(getComputedStyle(r.parentNode,"").height,10),o=parseInt(getComputedStyle(r,"").height,10);o+a<n-83&&(r.style.height="".concat(o+a,"px"),t.listPane&&t.listPane.current&&(t.listPane.current.style.bottom="".concat(o+a,"px")))},t.handleSpanClick=function(e){t.setState({selectSpan:e})},t.hideSpanDetail=function(){t.setState({selectSpan:{}})},t.handleRangeChange=function(e){t.getViewedBounds=(0,_.createViewedBoundsFunc)({min:t.props.detail.startTime,max:t.props.detail.endTime,viewStart:e.viewStart,viewEnd:e.viewEnd}),t.setState(e)},t.state={selectSpan:{},viewStart:0,viewEnd:1},t.getViewedBounds=(0,_.createViewedBoundsFunc)({min:e.detail.startTime,max:e.detail.endTime,viewStart:0,viewEnd:1}),t.listPane=d.default.createRef(),t.detailPane=d.default.createRef(),t.originPos=0,t}return(0,c.default)(r,[{key:"componentDidUpdate",value:function(e,t){var a=this.props.detail;(0,m.default)(a,e.detail)||(this.getViewedBounds=(0,_.createViewedBoundsFunc)({min:a.startTime,max:a.endTime,viewStart:0,viewEnd:1}),this.setState({selectSpan:{},viewStart:0,viewEnd:1})),this.detailPane&&this.detailPane.current&&(!(0,u.default)(this.state.selectSpan)&&(0,u.default)(t.selectSpan)?(this.detailPane.current.addEventListener("mousedown",this.handleMouseDown,!1),document.addEventListener("mouseup",this.handleMouseUp,!1)):(0,u.default)(this.state.selectSpan)&&!(0,u.default)(t.selectSpan)&&(this.detailPane.current.removeEventListener("mousedown",this.handleMouseDown,!1),document.removeEventListener("mouseup",this.handleMouseUp,!1),document.removeEventListener("mousemove",this.handleResize,!1)))}},{key:"componentWillUnmount",value:function(){this.detailPane&&this.detailPane.current&&(this.detailPane.current.removeEventListener("mousedown",this.handleMouseDown,!1),document.removeEventListener("mouseup",this.handleMouseUp,!1),document.removeEventListener("mousemove",this.handleResize,!1))}},{key:"getCoords",value:function(){for(var e=100/_.COORD_COUNT,t=[],a=0;a<_.COORD_COUNT;a++)t.push({percent:"".concat(a*e,"%")});return t.push({percent:"100%"}),t}},{key:"renderHeader",value:function(){var e=this.props.detail,a=e.traceName,r=e.traceID,n=e.duration,o=e.startTime,c=e.services,s=e.spans;if(!s)return null;var l=0;return s.forEach((function(e){l=Math.max(l,e.depth)})),d.default.createElement("div",{className:b.default.header},d.default.createElement(p.Icon,{name:"target",size:40}),d.default.createElement("div",{className:b.default.title},d.default.createElement("div",{className:b.default.name},a," ",d.default.createElement("span",null,r)),d.default.createElement("ul",null,d.default.createElement("li",null,d.default.createElement("span",null,t("START_TIME"),": "),d.default.createElement("span",null,(0,v.getLocalTime)(o/1e3).format("YYYY-MM-DD HH:mm:ss"))),d.default.createElement("li",null,d.default.createElement("span",null,t("DURATION"),": "),d.default.createElement("span",null,(0,_.formatDuration)(n))),d.default.createElement("li",null,d.default.createElement("span",null,t("CALLED_SERVICES"),": "),d.default.createElement("span",null,c.length)),d.default.createElement("li",null,d.default.createElement("span",null,t("CALL_DEPTH"),": "),d.default.createElement("span",null,l)))),d.default.createElement("div",{className:b.default.close,onClick:this.props.onCancel},d.default.createElement(p.Icon,{name:"close",size:20,type:"light"})))}},{key:"render",value:function(){var e=this,a=this.props,r=a.visible,n=a.detail,o=a.onCancel,c=this.state.selectSpan,s=this.getCoords();return d.default.createElement(h.default,{visible:r,bodyClassName:b.default.body,onCancel:o,hideHeader:!0,hideFooter:!0,fullScreen:!0},this.renderHeader(),d.default.createElement("div",{className:b.default.content},d.default.createElement("div",{className:b.default.wrapper},d.default.createElement(p.Columns,{className:"is-gapless"},d.default.createElement(p.Column,{className:"is-3"},d.default.createElement("div",{className:b.default.leftPane},d.default.createElement("div",{className:b.default.timelineTitle},t("SERVICES_AND_OPERATIONS")))),d.default.createElement(p.Column,null,d.default.createElement("div",{className:b.default.rightPane},d.default.createElement("div",{className:b.default.timelineSelect},d.default.createElement(E.default,{data:n,viewRange:this.viewRange,onRangeChange:this.handleRangeChange})),d.default.createElement("svg",{className:b.default.coords},s.map((function(e){return d.default.createElement("line",{key:e.percent,y1:"0%",y2:"100%",x1:e.percent,x2:e.percent})})))))),d.default.createElement("ul",{className:b.default.listPane,ref:this.listPane,style:{bottom:(0,u.default)(c)?0:"50%"}},n.spans&&n.spans.map((function(t){return d.default.createElement(g.default,{key:t.spanID,span:t,selected:c.spanID===t.spanID,color:n.serviceColorMap[t.process.serviceName],getViewedBounds:e.getViewedBounds,onClick:e.handleSpanClick})}))),!(0,u.default)(c)&&d.default.createElement("div",{className:b.default.detailPane,ref:this.detailPane},d.default.createElement(y.default,{span:c,onClose:this.hideSpanDetail})))))}},{key:"viewRange",get:function(){return{viewStart:this.state.viewStart,viewEnd:this.state.viewEnd}}}]),r}(d.default.Component);a.default=O,O.propTypes={visible:f.default.bool,detail:f.default.object,onCancel:f.default.func},O.defaultProps={visible:!1,detail:{},onCancel:function(){}}},3913:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(14),a(193),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31)),o=r(a(25)),c=r(a(28)),s=r(a(41)),l=r(a(42)),i=r(a(37));a(32),a(3),a(29),a(14),a(193),a(4),a(18),a(43),a(11);var u=r(a(0)),d=r(a(5)),f=a(189),p=a(940),m=r(a(3914));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}function v(e){return"".concat((100*e).toFixed(1),"%")}var _=function(e){(0,s.default)(a,e);var t=h(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).handleClick=function(){var t=e.props;(0,t.onClick)(t.span)},e}return(0,c.default)(a,[{key:"render",value:function(){var e,t=this.props,a=t.span,r=t.color,o=t.getViewedBounds,c=t.selected,s=(0,p.isErrorSpan)(a),l=(0,p.formatDuration)(a.duration),i=o(a.startTime,a.startTime+a.duration);return e=i.start>1-i.end?"Left":"Right",u.default.createElement("li",{className:(0,d.default)(m.default.wrapper,(0,n.default)({},m.default.selected,c)),onClick:this.handleClick},u.default.createElement(f.Columns,{className:"is-gapless"},u.default.createElement(f.Column,{className:"is-3"},u.default.createElement("div",{className:m.default.nameWrapper},u.default.createElement("span",{className:m.default.padder,style:{paddingLeft:12*(a.depth+1)}}),u.default.createElement("a",{className:m.default.name,style:{borderColor:r}},u.default.createElement("span",{className:m.default.svc},s&&u.default.createElement(f.Icon,{name:"error",color:{primary:"#fff",secondary:"#ea4641"}}),a.process.serviceName," "),u.default.createElement("span",{className:m.default.endpoint},a.operationName)))),u.default.createElement(f.Column,{className:"margin-l12 margin-r12"},u.default.createElement("div",{className:m.default.barWrapper},u.default.createElement("div",{className:m.default.bar,style:{backgroundColor:r,left:v(i.start),width:v(i.end-i.start)}},u.default.createElement("div",{className:(0,d.default)(m.default.barLabel,m.default["barLabel".concat(e)])},l))))))}}]),a}(u.default.Component);t.default=_},3914:function(e,t,a){e.exports={wrapper:"_3FpC5ye7GyQiA_9XNgx040",selected:"_11AetUGUuNRQbhOiVaaPrQ",nameWrapper:"cWTG60H4pfEzvUaUIBzkJ",name:"vjWzJJl5QXyvJrZh0yxG1",svc:"_1-OgJnOWAnoA9-4y_V7v6",endpoint:"_6EPxZpgSu0q2JNsNKM8dH",padder:"XpivfNFuNAu6Z00f5sn1b",barWrapper:"_2jIAbOYlOMtqtmQQ44uZ1a",bar:"_1kkSL2CR5ItZrLhBYy8cx4",barLabel:"_2jh31S8ET1p5RAOzk3mU13",barLabelLeft:"_32_b1BUKqADygs-iprfczz",barLabelRight:"_3V0eVtgfe3fOMxrkhggaoC"}},3915:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(14),r(4),r(18),r(30),r(11),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37));r(32),r(20),r(141),r(29),r(14),r(120),r(4),r(18),r(43),r(11);var u=n(r(67)),d=n(r(0)),f=r(189),p=n(r(1e3)),m=r(940),h=n(r(3916));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var _=function(e,t){switch(e){case"bool":return String(t);case"string":case"number":return t;default:return JSON.stringify(t)}},g=function(e){var t=e.data;return d.default.createElement("ul",{className:h.default.properties},t.map((function(e){return d.default.createElement("li",{key:e.key},d.default.createElement("span",null,e.key,": "),d.default.createElement("span",null,_(e.type,e.value)))})))},y=function(e){var t=e.data,a=e.startTime;return d.default.createElement("div",null,t.map((function(e){var t=(0,m.formatDuration)(e.timestamp-a);return d.default.createElement("div",{key:e.timestamp,classNames:h.default.log},d.default.createElement("span",null,t),e.fields.map((function(e){return d.default.createElement("span",{className:"margin-l12",key:e.key},d.default.createElement("span",null,e.key,"= "),d.default.createElement("span",null,d.default.createElement("strong",null," ",_(e.type,e.value))))})))})))},E=function(e){(0,s.default)(r,e);var a=v(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).handleTypeChange=function(e){t.setState({type:e})},t.renderContentBody=function(){var e=t.props.span;switch(t.state.type){case"tags":return d.default.createElement(g,{data:e.tags});case"process":return d.default.createElement(g,{data:e.process.tags});case"logs":return d.default.createElement(y,{data:e.logs,startTime:e.startTime-e.relativeStartTime})}return null},t.state={type:"tags"},t}return(0,c.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.span!==e.span&&this.setState({type:"tags"})}},{key:"render",value:function(){var e=this.props,a=e.span,r=e.onClose,n=this.state.type,o=(0,m.formatDuration)(a.relativeStartTime),c=(0,m.formatDuration)(a.duration),s=a.process.serviceName.split(".")[0];return d.default.createElement("div",{className:h.default.wrapper},d.default.createElement("div",{className:h.default.header},d.default.createElement(f.Icon,{name:"target",size:40}),d.default.createElement("div",{className:h.default.text},d.default.createElement("div",{className:h.default.name},a.process.serviceName,d.default.createElement(p.default,{name:t("SERVICE"),value:s}),d.default.createElement(p.default,{name:t("START_TIME"),value:o}),d.default.createElement(p.default,{name:t("DURATION"),value:c})),d.default.createElement("p",null,a.operationName)),d.default.createElement("div",{className:h.default.close,onClick:r},d.default.createElement(f.Icon,{name:"minimize",size:20}))),d.default.createElement("div",{className:h.default.content},d.default.createElement("div",{className:h.default.contentHeader},d.default.createElement(f.RadioGroup,{mode:"button",buttonWidth:155,value:n,onChange:this.handleTypeChange,size:"small"},d.default.createElement(f.RadioButton,{value:"tags"},t("TAG")),d.default.createElement(f.RadioButton,{value:"process"},t("PROCESS")),!(0,u.default)(a.logs)&&d.default.createElement(f.RadioButton,{value:"logs"},t("LOG")))),d.default.createElement("div",{className:h.default.contentBody},this.renderContentBody())))}}]),r}(d.default.Component);a.default=E},3916:function(e,t,a){e.exports={wrapper:"_2SrTH5oLaYBNtgxSsaIe1_",header:"_14VaoFxYI4xrb8vE4XX7q_",text:"_1iF8T6gN1lf2KdP5iGWCtN",name:"afCuDDLbVrc6EwA9B7J42",content:"iQqWGMwUNDUNhZckjqUKb",contentHeader:"I7j76faUqwX3zA4eEVJQG",contentBody:"_3soUTBQ4emfUy3qasSxMm1",properties:"_33lp7a1-5ZP0KxxrDJPaa-",close:"PLv31nTie7tGWOvDkQJv1",log:"Wzdc9MCTDUaK_p6l27wct"}},3917:function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),l=r(a(37)),i=r(a(0)),u=r(a(67)),d=r(a(3918)),f=r(a(3919)),p=r(a(1616));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,l.default)(e);if(t){var n=(0,l.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(a,e);var t=m(a);function a(){return(0,n.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.viewRange,r=e.onRangeChange;return(0,u.default)(t)?null:i.default.createElement("div",{className:p.default.graph},i.default.createElement(d.default,{data:t}),i.default.createElement(f.default,{data:t,viewRange:a,onRangeChange:r}))}}]),a}(i.default.Component);t.default=h},3918:function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(20),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),l=r(a(37)),i=r(a(0)),u=a(940);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,l.default)(e);if(t){var n=(0,l.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var f=function(e){(0,c.default)(a,e);var t=d(a);function a(e){var r;return(0,n.default)(this,a),(r=t.call(this,e)).getColor=function(e){return r.props.data.serviceColorMap[e]},r.canvas=i.default.createRef(),r}return(0,o.default)(a,[{key:"componentDidMount",value:function(){this.drawCanvas()}},{key:"drawCanvas",value:function(){if(this.canvas&&this.canvas.current){var e=this.props.data,t=e.spans.map((function(e){return{valueOffset:e.relativeStartTime,valueWidth:e.duration,serviceName:e.process.serviceName}}));(0,u.renderIntoCanvas)(this.canvas.current,t,e.duration,this.getColor)}}},{key:"render",value:function(){return i.default.createElement("canvas",{ref:this.canvas})}}]),a}(i.default.Component);t.default=f},3919:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(193),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(27),r(29),r(193),r(4),r(18),r(43),r(11);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=r(940),f=n(r(1616));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var m=function(e){(0,s.default)(r,e);var a=p(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).handleMouseDown=function(e){t.originX=e.x,t.hideCursorGuide();var a=t.svgBound,r=a.left,n=a.width,o=Math.max(e.x-r,0)/n;t.setState({viewStart:o,viewEnd:o})},t.handleMouseUp=function(){t.originX=-1;var e=t.state,a=e.viewStart,r=e.viewEnd;Math.abs(a-r)>.01&&t.props.onRangeChange({viewStart:a,viewEnd:r})},t.handleMouseLeave=function(){t.hideCursorGuide()},t.handleMouseMove=function(e){if(t.originX>-1){var a=t.svgBound,r=a.left,n=a.width,o=Math.max(e.x-r,0)/n;o>t.state.viewStart?t.setState({viewEnd:o}):t.setState({viewStart:o})}else t.showCursorGuide(e)},t.handleClear=function(){t.props.onRangeChange({viewStart:0,viewEnd:1})},t.showCursorGuide=function(e){if(t.cursorGuide)for(var a=t.svgBound,r=a.left,n=a.width,o=Math.max(e.x-r,0)/n,c="".concat(100*o,"%"),s=0;s<t.cursorGuide.children.length;s++)t.cursorGuide.children[s].setAttribute("x1",c),t.cursorGuide.children[s].setAttribute("x2",c),t.cursorGuide.children[s].setAttribute("stroke-opacity",1)},t.hideCursorGuide=function(){if(t.cursorGuide)for(var e=0;e<t.cursorGuide.children.length;e++)t.cursorGuide.children[e].setAttribute("stroke-opacity",0)},t.svg=u.default.createRef(),t.originX=-1,t.state={viewStart:e.viewRange.viewStart,viewEnd:e.viewRange.viewEnd},t}return(0,c.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props.viewRange;t.viewStart!==e.viewRange.viewStart&&this.setState({viewStart:t.viewStart}),t.viewEnd!==e.viewRange.viewEnd&&this.setState({viewEnd:t.viewEnd})}},{key:"componentDidMount",value:function(){this.svg&&this.svg.current&&(this.svg.current.addEventListener("mousedown",this.handleMouseDown),this.svg.current.addEventListener("mousemove",this.handleMouseMove),this.svg.current.addEventListener("mouseup",this.handleMouseUp),this.svg.current.addEventListener("mouseleave",this.handleMouseLeave),this.svgBound=this.svg.current.getBoundingClientRect(),this.cursorGuide=this.svg.current.querySelector('[name="cursor-guide"]'))}},{key:"componentWillUnmount",value:function(){this.svg&&this.svg.current&&(this.svg.current.removeEventListener("mousedown",this.handleMouseDown),this.svg.current.removeEventListener("mousemove",this.handleMouseMove),this.svg.current.removeEventListener("mouseup",this.handleMouseUp),this.svg.current.removeEventListener("mouseleave",this.handleMouseLeave))}},{key:"getCoords",value:function(){for(var e=this.props.data.duration,t=(e/d.COORD_COUNT).toFixed(2),a=100/d.COORD_COUNT,r=[],n=0;n<d.COORD_COUNT;n++)r.push({value:n*t,percent:"".concat(n*a,"%")});return r.push({value:e,percent:"100%"}),r}},{key:"render",value:function(){var e=this.state,a=e.viewStart,r=e.viewEnd,n=a>0&&r<1,o="".concat(100*a,"%"),c="".concat(100*r,"%"),s=this.getCoords();return u.default.createElement("div",{className:f.default.range},u.default.createElement("svg",{height:"100%",width:"100%",ref:this.svg},u.default.createElement("g",{className:f.default.coord},s.map((function(e,t){return u.default.createElement("g",{key:e.value,className:f.default.coordLine},u.default.createElement("line",{y1:"0%",y2:"100%",x1:e.percent,x2:e.percent}),u.default.createElement("text",{x:e.percent,y:12,transform:t===d.COORD_COUNT?"translate(-2,0)":"translate(2,0)",textAnchor:t===d.COORD_COUNT?"end":"start"},(0,d.formatDuration)(e.value)))}))),u.default.createElement("g",{className:f.default.cursorGuide,name:"cursor-guide"},u.default.createElement("line",{y1:0,y2:58,strokeWidth:"1",stroke:"#212b36",strokeOpacity:"0",strokeDasharray:"2,2"}),u.default.createElement("line",{y1:19,y2:41,stroke:"#242e42",strokeWidth:"4",strokeOpacity:"0",strokeLinecap:"round"}),u.default.createElement("line",{y1:0,y2:58,strokeWidth:"20",stroke:"transparent"})),n&&u.default.createElement("g",{className:f.default.scrubber},u.default.createElement("line",{className:f.default.scrubberLine,y1:"0%",y2:"100%",x1:o,x2:o}),u.default.createElement("line",{className:f.default.scrubberLine,y1:"0%",y2:"100%",x1:c,x2:c}))),n&&u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:f.default.hoverBlock,style:{left:0,width:o}}),u.default.createElement("div",{className:f.default.hoverBlock,style:{left:c,width:"".concat(100*(1-r),"%")}}),u.default.createElement("div",{className:f.default.clearBlock,onClick:this.handleClear},t("CLEAR"))))}}]),r}(u.default.Component);a.default=m},3920:function(e,t,a){e.exports={body:"_1pPFSIIbH7oLnLwkgHOLB5",header:"_2DMYdLCQ-OBk0rFii_9W5O",title:"_1Erbw_1JjBawD0kM-G52ln",name:"_3ugl6RaS7fK6PUFj7hPqwZ",close:"_2i5KJmq9o9HmC3fp0B5rPv",content:"_1lhG8ZLZp0syy6MTsAqY-_",wrapper:"_3n2YybElrtxWe2nOf7ZQUa",timelineTitle:"_3kkKn_rpepfTAFlapQ4YVK",leftPane:"pfziZWcqAxnmD-tb1Ip10",rightPane:"_36cdSAMcGZ9FJ-_068PDV_",timelineSelect:"_2mJV8zFMq6n5D4t-maCCmh",listPane:"GgsvlcpZCQVcsOdH3tQ6J",detailPane:"_4xyXvcotLTz6jMyjqWGbV",coords:"_20avL2qiM0J57r-UIzor8v"}},3921:function(e,t,a){e.exports={operations:"_-15riN_1mHwid5aQz6xwZ",timeSelect:"_1jv6axOPYBWD4xXsZgGZBB"}},3922:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(317)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=r(17),h=r(243),v=n(r(26)),_=n(r(67)),g=r(189),y=r(56),E=r(804),b=n(r(1072)),S=n(r(826)),O=n(r(807)),R=n(r(834)),k=n(r(3923)),C=n(r(3929));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var P=(0,h.inject)("rootStore","projectStore")(o=(0,h.observer)(o=(0,E.trigger)(o=function(e){(0,u.default)(r,e);var a=D(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).store=new b.default,e.fetchData=function(){var t=e.props.match.params;e.store.fetchDetail(t)},e.getOperations=function(){return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(){return e.trigger("openpitrix.app.edit",{type:e.name,detail:(0,m.toJS)(e.store.detail),success:e.fetchData})}},{key:"editTemplate",icon:"pen",text:t("EDIT_SETTINGS"),action:"edit",onClick:function(){return e.trigger("openpitrix.app.template.edit",T(T({},e.props.match.params),{},{detail:(0,m.toJS)(e.store.detail),success:e.fetchData}))}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",type:"danger",onClick:function(){return e.trigger("resource.delete",{type:e.name,detail:e.store.detail,success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var a=(0,m.toJS)(e.store.detail),r=e.props.match.params,n=r.cluster,o=r.namespace;if(!(0,_.default)(a))return[{name:t("CLUSTER"),value:(0,y.showNameAndAlias)(n,"cluster")},{name:t("PROJECT"),value:(0,y.showNameAndAlias)(o,"project")},{name:t("STATUS"),value:e.renderStatus()},{name:t("VERSION"),value:(0,v.default)(a,"version.name","-")},{name:t("CREATION_TIME_TCAP"),value:(0,y.getLocalTime)((0,v.default)(a,"create_time")).format("YYYY-MM-DD HH:mm:ss")},{name:t("UPDATE_TIME_TCAP"),value:(0,y.getLocalTime)((0,v.default)(a,"status_time")).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:a.owner}]},e.renderStatus=function(){var a=(0,m.toJS)(e.store.detail),r=a.status;return a.additional_info?p.default.createElement(g.Tooltip,{content:a.additional_info},p.default.createElement(O.default,{name:t(r),type:r})):p.default.createElement(O.default,{name:t(r),type:r})},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=(0,m.toJS)(this.store.detail),a={detailStore:this.store};if(this.store.isLoading&&!this.store.detail.name)return p.default.createElement(g.Loading,{className:"ks-page-loading"});var r={icon:p.default.createElement("label",{className:C.default.icon},p.default.createElement(S.default,{iconLetter:(0,v.default)(e,"app.name"),src:(0,v.default)(e,"app.icon"),alt:""})),module:this.module,name:(0,y.getDisplayName)(this.store.detail),desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("APP_PL"),url:this.listUrl}]};return p.default.createElement(R.default,(0,c.default)({stores:a},r,{routes:k.default}))}},{key:"module",get:function(){return"applications"}},{key:"name",get:function(){return"APP"}},{key:"listUrl",get:function(){var e=this.props.match.params,t=e.cluster,a=e.workspace,r=e.namespace;return"/".concat(a,"/clusters/").concat(t,"/projects/").concat(r,"/").concat(this.module,"/template")}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),r}(p.default.Component))||o)||o)||o;a.default=P},3923:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(318),o=r(a(3924)),c=r(a(3925)),s=r(a(3927)),l="/:workspace/clusters/:cluster/projects/:namespace/applications/template/:id",i=[{path:"".concat(l,"/resource-status"),name:"resource-status",title:"RESOURCE_STATUS",component:o.default,exact:!0},{path:"".concat(l,"/template"),title:"APP_TEMPLATE",component:c.default,exact:!0},{path:"".concat(l,"/config"),title:"APP_SETTINGS",component:s.default,exact:!0},(0,n.getIndexRoute)({path:l,to:"".concat(l,"/resource-status"),exact:!0})];t.default=i},3924:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(30),a(11),a(69);var n,o=r(a(25)),c=r(a(28)),s=r(a(41)),l=r(a(42)),i=r(a(37)),u=r(a(0)),d=a(243),f=r(a(1229)),p=r(a(1074)),m=r(a(1230)),h=r(a(1231));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var _=(0,d.inject)("detailStore")(n=(0,d.observer)(n=function(e){(0,s.default)(a,e);var t=v(a);function a(e){var r;return(0,o.default)(this,a),(r=t.call(this,e)).store=e.detailStore,r.module=e.module,r}return(0,c.default)(a,[{key:"render",value:function(){var e=this.store.detail,t=e.cluster,a=e.namespace,r=e.selector;return u.default.createElement(u.default.Fragment,null,u.default.createElement(m.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(f.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(p.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(h.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r)}}]),a}(u.default.Component))||n)||n;t.default=_},3925:function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var o,c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=n(r(67)),p=r(17),m=r(243),h=r(189),v=n(r(890)),_=n(r(887)),g=n(r(823)),y=n(r(932)),E=n(r(1457)),b=n(r(3926));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var O=h.Tabs.TabPanel,R=(0,m.inject)("detailStore")(o=(0,m.observer)(o=function(e){(0,l.default)(r,e);var a=S(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleTabChange=function(e){t.setState({tab:e})},t.state={tab:"readme"},t.store=e.detailStore,t.appVersionStore=new v.default,t.appFileStore=new _.default,(0,p.when)((function(){return!(0,f.default)(t.store.detail)}),(function(){return t.getData()})),t}return(0,s.default)(r,[{key:"getData",value:function(){var e=(0,p.toJS)(this.store).detail,t=e.app_id,a=e.version_id;this.appVersionStore.fetchList({app_id:t,status:"active"}),this.appFileStore.fetch({app_id:t,version_id:a})}},{key:"renderReadme",value:function(){var e=this.appFileStore.files;return e["README.md"]||this.appFileStore.isLoading?d.default.createElement(y.default,{source:e["README.md"],className:b.default.markdown}):d.default.createElement("p",null,t("NO_APP_DESC_FOUND"))}},{key:"renderSettings",value:function(){var e=this.appFileStore.files;return d.default.createElement(E.default,{files:e})}},{key:"render",value:function(){var e=this.state.tab;return d.default.createElement(g.default,{title:t("APP_TEMPLATE"),className:b.default.wrapper},d.default.createElement(h.Tabs,{type:"button",activeName:e,onChange:this.handleTabChange},d.default.createElement(O,{label:t("APP_DESCRIPTION"),name:"readme"},this.renderReadme()),d.default.createElement(O,{label:t("CHART_FILES"),name:"settings"},this.renderSettings())))}}]),r}(d.default.Component))||o)||o;a.default=R},3926:function(e,t,a){e.exports={wrapper:"_2pJacSa2ZXD7ds8HDYKw9l"}},3927:function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var o,c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=r(243),p=n(r(801)),m=n(r(838)),h=n(r(3928));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=(0,f.inject)("rootStore","detailStore")(o=(0,f.observer)(o=function(e){(0,l.default)(r,e);var a=v(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"render",value:function(){var e=this.store,a=e.isLoading,r=e.detail;return d.default.createElement(p.default,{title:t("APP_SETTINGS"),loading:a},d.default.createElement(m.default,{className:h.default.yaml,value:r.env||""}))}},{key:"store",get:function(){return this.props.detailStore}}]),r}(d.default.Component))||o)||o;a.default=_},3928:function(e,t,a){e.exports={yaml:"_2YSMOV4ZrOWlGFo_rsn-eF"}},3929:function(e,t,a){e.exports={icon:"_2hq_evgK9i1gndFgNOU-kf"}},3930:function(e,a,r){"use strict";var n=r(19),o=r(162);r(12),r(109),r(3),r(10),r(44),r(6),r(70),r(36),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(46),r(69),r(71),r(7),r(40),r(1084),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(44),r(6),r(70),r(36),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(440),r(321),r(18),r(43),r(30),r(11),r(73),r(46),r(69),r(71),r(7),r(40),r(1084),r(1619),r(1620),r(1621),r(1622),r(1623);var c,s=n(r(317)),l=n(r(31)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(17),v=r(243),_=n(r(26)),g=n(r(67)),y=r(189),E=n(r(191)),b=r(56),S=r(804),O=o(r(1221)),R=n(r(1624)),k=n(r(1625)),C=n(r(3961)),A=r(1085),T=r(815),D=n(r(331)),P=n(r(826)),N=n(r(807)),I=n(r(3962)),w=n(r(834)),x=n(r(3965)),M=n(r(4029));function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var B=(0,v.inject)("rootStore")(c=(0,v.observer)(c=(0,S.trigger)(c=function(e){(0,d.default)(r,e);var a=U(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).store=new O.default,e.rebalanceStore=new C.default,e.backupStore=new R.default,e.websocket=new D.default,e.fetchData=function(){var t=e.props.match.params;return e.store.fetchDetail(t)},e.getOperations=function(){var a=e.props.match.params,r=a.cluster,n=a.workspace,o=a.namespace,c=a.id,s=(0,h.toJS)(e.store.detail),l={cluster:r,workspace:n,namespace:o,cluster_id:c,app_id:s.app_id};return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(){return e.trigger("openpitrix.db.app.edit",{type:t(e.name),detail:j(j({},l),{},{name:s.name,description:s.description}),success:e.fetchData})}},{key:"createDBNode",icon:"backup",text:t("SCALE_OUT"),action:"create",onClick:function(){return e.trigger("openpitrix.db.createDBNode",j(j({type:t(e.name)},l),{},{shardsCount:s.shardsCount,nodes:s.nodes,icon:"backup",specificationsObject:s.specifications,storage:s.storage,storages:s.storages}))},disabled:!s.isRunning},{key:"rebalance",icon:"loadbalancer",text:t("REBALANCE_NODES"),action:"manage",onClick:function(){return e.trigger("openpitrix.db.kafka.rebalance",j({type:t(e.name),icon:"loadbalancer",title:t("REBALANCE_NODES"),store:e.rebalanceStore},l))},disabled:!s.isRunning,includeApp:[T.RadonDBAppId.Kafka]},{key:"Specification",icon:"scaling",text:t("ADJUST_RESOURCES"),action:"manage",onClick:function(){return e.trigger("openpitrix.db.adjustSpecification",j(j(j({},e.props.match.params),{},{icon:"scaling",cpu:s.cpu,memory:s.memory,specificationsObject:s.specifications,nodes:s.nodes},l),{},{success:function(e){if(s.app_id===T.RadonDBAppId.RedisCluster||s.app_id===T.RadonDBAppId.RedisSentinel){var t=(0,T.getCpuAndMemoryFromSpecifications)(e).memory;(new k.default).updateParams(j(j({},l),{},{params:{maxmemory:1024*parseFloat(t)-50}}))}}}))},disabled:!s.isRunning},{key:"storage",icon:"storage",text:t("EXPAND_VOLUME"),action:"manage",onClick:function(){return e.trigger("openpitrix.db.adjustCapacity",j({type:t(e.name),icon:"storage",storage:s.realStorage||s.storage,storages:s.realStorages||s.storages,nodes:s.nodes},l))},disabled:!s.allowVolumeExpansion||!s.isRunning},{key:"backup",icon:"backup",text:t("BACK_UP"),action:"manage",onClick:function(){return e.trigger("openpitrix.db.backup.create",j({type:t(e.name),icon:"backup",title:t("BACK_UP"),store:e.backupStore,image:s.sidecarImage,success:e.fetchData},l))},disabled:!s.isRunning,includeApp:[T.RadonDBAppId.MySQL,T.RadonDBAppId.PostgreSQL]},{key:"autoBackup",icon:"storage",text:t("SET_AUTO_BACKUP"),action:"manage",onClick:function(){var a=s.backupSchedule,r=0,n=!1;return s.app_id===T.RadonDBAppId.PostgreSQL&&(a=(0,_.default)(s,"spec.backupCluster.backupToS3.cron.schedule",""),n="REDUNDANCY 10"!==(0,_.default)(s,"spec.backupCluster.backupToS3.policy.retention","REDUNDANCY 10"),r=(0,_.default)(s,"spec.backupCluster.backupToS3.policy.retention","REDUNDANCY 10").replace(/[^\d]/g,"")),e.trigger("openpitrix.db.backup.auto",j({type:t(e.name),icon:"backup",title:t("SET_AUTO_BACKUP"),store:e.backupStore,backupSchedule:a,isScheduledDelete:n,retentionTime:n?parseInt(r,10):30,success:e.fetchData},l))},disabled:!s.isRunning,includeApp:[T.RadonDBAppId.MySQL,T.RadonDBAppId.PostgreSQL]},{key:"update",icon:"update",text:t("UPDATE_VERSION"),action:"edit",show:e.showUpdateVersion,onClick:function(){e.trigger("openpitrix.db.app.update",{resource:s.name,title:t("UPDATE_VERSION"),detail:j({},l),success:function(){return e.fetchData}})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",type:"danger",onClick:function(){return e.trigger("resource.delete",{type:e.name,detail:s,success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var a=(0,h.toJS)(e.store.detail),r=e.props.match.params,n=r.cluster,o=r.namespace;if(!(0,g.default)(a))return[{name:t("CLUSTER"),value:(0,b.showNameAndAlias)(n,"cluster")},{name:t("PROJECT"),value:(0,b.showNameAndAlias)(o,"project")},{name:t("STATUS"),value:e.renderStatus()},{name:t("APP_TEMPLATE"),value:(0,_.default)(a,"app_name","-")},{name:t("VERSION"),value:(0,_.default)(a,"version","-")},{name:t("KERNEL_VERSION"),value:(0,_.default)(a,"databaseVersionText")},{name:t("CREATION_TIME_TCAP"),value:(0,b.getLocalTime)((0,_.default)(a,"creationTimestamp")).format("YYYY-MM-DD HH:mm:ss")}].filter((function(e){return e.value}))},e.getCustomAttrs=function(){var a=e.store.detail,r=a.services,n=void 0===r?[]:r,o=a.secret,c=o?(0,A.binaryStringToBlob)(o.cert):new Blob,s=n.filter((function(e){return"ClusterIP"===e.type})),l=n.filter((function(e){return"NodePort"===e.type}));return m.default.createElement("div",{"data-test":"detail-attrs"},m.default.createElement("div",{style:{margin:"24px 0 12px"},className:"h6"},t("ACCESS_ADDRESS_PL")),s.length>0&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{style:{margin:"12px 0 4px"}},"CluserIP"),m.default.createElement(I.default,null,s.map((function(e){var a=e.label,r=e.value;return m.default.createElement(I.default.Item,{name:t(a),value:r||"-"})})))),l.length>0&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{style:{margin:"12px 0 4px"}},"NodePort"),m.default.createElement(I.default,null,l.map((function(e){var a=e.label,r=e.value;return m.default.createElement(I.default.Item,{name:t(a),value:r||"-"})})))),o&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{style:{margin:"24px 0 12px"},className:"h6"},""),m.default.createElement(I.default,null,m.default.createElement(I.default.Item,{name:t("CA_CERTIFICATE"),value:o.cert?m.default.createElement("div",{className:M.default.flexRow},m.default.createElement("span",null,"ca.p12"),m.default.createElement("a",{href:URL.createObjectURL(c),download:"ca.p12"},t("DOWNLOAD"))):"-"}),m.default.createElement(I.default.Item,{name:t("CA_PASSWORD"),value:m.default.createElement("div",{className:M.default.flexRow},m.default.createElement("span",null,o.password||"-"),m.default.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),(0,A.copyToClipboard)(o.password).then((function(){E.default.success({content:t("COPY_SUCCESSFUL")})}))}},t("COPY")))}),m.default.createElement(I.default.Item,{name:t("VALIDITY_PERIOD"),value:o.validDate||"-"}))))},e.renderStatus=function(){var a=(0,h.toJS)(e.store.detail),r=a.status;return r?a.additional_info?m.default.createElement(y.Tooltip,{content:a.additional_info},m.default.createElement(N.default,{name:t("DATABASE_STATUS_".concat(r.replace(/[-\s]/g,"_").toUpperCase())),type:O.DMPStatus[r]||r})):m.default.createElement(N.default,{name:t("DATABASE_STATUS_".concat(r.replace(/[-\s]/g,"_").toUpperCase())),type:O.DMPStatus[r]||r,flicker:!0}):"-"},e}return(0,u.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.fetchData().then((function(){e.initWebsocket(),(0,_.default)(e.store,"detail.app_id")===T.RadonDBAppId.Kafka&&e.rebalanceStore.fetchList(e.props.match.params)}))}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer(),this.websocket.close()}},{key:"checkAlertRulesPermission",value:function(){var e=this.props.match.params,t=e.cluster,a=e.namespace;return globals.app.hasClusterModule(t,"alerting")&&globals.app.hasPermission({cluster:t,project:a,action:"view",module:"alert-rules"})}},{key:"initWebsocket",value:function(){var e=this,t=this.props.match.params.id,a=this.store.getWatchUrl({name:t});a&&(this.websocket.watch(a),this.disposer=(0,h.reaction)((function(){return e.websocket.message}),(function(t){"Manifest"===t.object.kind&&["MODIFIED","DELETED"].includes(t.type)&&e.fetchData()}),{name:a}))}},{key:"render",value:function(){var e={detailStore:this.store};if(this.store.isLoading&&!this.store.detail.name)return m.default.createElement(y.Loading,{className:"ks-page-loading"});var a=m.default.createElement("label",{className:M.default.icon},m.default.createElement(P.default,{iconLetter:this.store.detail.kind,src:this.store.detail.icon,alt:""})),r=this.store.detail.app_id,n={icon:a,module:this.module,name:(0,b.getDisplayName)(this.store.detail),desc:this.store.detail.description,operations:this.getOperations().filter((function(e){return!e.includeApp||e.includeApp.includes(r)})),attrs:this.getAttrs(),customAttrs:this.getCustomAttrs(),breadcrumbs:[{label:t("APP_PL"),url:this.listUrl}]},o=x.default;this.checkAlertRulesPermission()||(o=x.default.filter((function(e){return!e.path.includes("alerting")})));var c=x.default.find((function(e){return e.path.includes("account")}));return c&&(r===T.RadonDBAppId.Kafka?c.title="KAFKA_USERS":c.title="DATABASE_USERS"),o=o.filter((function(e){return e.excludeApp?!e.excludeApp.includes(r):!e.only||e.only===r})),m.default.createElement(w.default,(0,s.default)({stores:e},n,{routes:o}))}},{key:"module",get:function(){return"applications"}},{key:"name",get:function(){return"APP"}},{key:"listUrl",get:function(){var e=this.props.match.params,t=e.cluster,a=e.workspace,r=e.namespace;return"/".concat(a,"/clusters/").concat(t,"/projects/").concat(r,"/").concat(this.module,"/database")}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"showUpdateVersion",get:function(){var e=(0,h.toJS)(this.store.detail);return!(e.app_id!==T.RadonDBAppId.OpenSearch||!e.databaseVersionText.includes("2.3.0"))}}]),r}(m.default.Component))||c)||c)||c;a.default=B},3960:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(24),r(4),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.getCKParams=function(e){var a=e.replicasCount,r=e.tcpPort,n=e.httpPort,c=e.max_server_memory_usage,s=e.max_memory_usage;return[{key:"replicasCount",name:t("REPLICA_COUNT"),value:a,description:t("DBPARAM_REPLICACOUNT_DESC"),range:{min:1,max:3},disable:!0},{key:"tcpPort",name:t("TCP_PORT"),value:(0,o.default)(r,"port"),description:t("DBPARAM_TCPPORT_DESC"),range:{min:1,max:65535},disable:!0},{key:"httpPort",name:t("HTTP_PORT"),value:(0,o.default)(n,"port"),description:t("DBPARAM_HTTPPORT_DESC"),range:{min:1,max:65535},disable:!0},{key:"max_server_memory_usage",name:"max_server_memory_usage",value:Number(c),description:t("DBPARAM_MAX_SERVER_MEMORY_USAGE"),restart:t("YES"),range:{min:1e9,max:128e9}},{key:"max_memory_usage",name:"max_memory_usage",value:Number(s),description:t("DBPARAM_MAX_MEMORY_USAGE"),restart:t("NO"),range:{min:2e7,max:128e9}}]},a.getPGParams=function(e){return[{key:"database_version",name:t("DBPARAM_DATABASE_VERSION"),value:(0,o.default)(e,"pgVersion","12"),description:t("DBPARAM_DATABASE_VERSION_DESC"),restart:"-",disable:!0},{key:"port",name:"port",value:(0,o.default)(e,"port",5432),description:t("DBPARAM_PG_PORT_DESC"),range:{min:1,max:65534},restart:t("YES")},{key:"fsync",name:"fsync",value:(0,o.default)(e,"fsync",!0).toString(),description:t("DBPARAM_FSYNC_DESC"),restart:t("NO"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"full_page_writes",name:"full_page_writes",value:(0,o.default)(e,"full_page_writes",!0).toString(),description:t("DBPARAM_FULL_PAGE_WRITES_DESC"),restart:t("NO"),type:"select",options:[{label:"true",value:"true"}]},{key:"wal_compression",name:"wal_compression",value:(0,o.default)(e,"wal_compression",!1).toString(),description:t("DBPARAM_WAL_COMPRESSION_DESC"),restart:t("NO"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"jit",name:"jit",value:(0,o.default)(e,"jit",!1).toString(),description:t("DBPARAM_JIT_DESC"),restart:t("NO"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"autovacuum",name:"autovacuum",value:(0,o.default)(e,"autovacuum",!0).toString(),description:t("DBPARAM_AUTOVACUUM_DESC"),restart:t("NO"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"synchronous_commit",name:"synchronous_commit",value:(0,o.default)(e,"synchronous_commit","on"),description:t("DBPARAM_SYNCHRONOUS_COMMIT_DESC"),restart:t("NO"),type:"select",options:[{label:"off",value:"off"},{label:"local",value:"local"},{label:"on",value:"on"},{label:"remote_write",value:"remote_write"},{label:"remote_apply",value:"remote_apply"}]},{key:"wal_level",name:"wal_level",value:(0,o.default)(e,"wal_level","replica"),description:t("DBPARAM_LOG_WAL_LEVEL_DESC"),restart:t("YES"),type:"select",options:[{label:"replica",value:"replica"},{label:"logical",value:"logical"}]},{key:"temp_buffers",name:"temp_buffers",value:parseInt((0,o.default)(e,"temp_buffers","1MB"),10),description:t("DBPARAM_TEMP_BUFFERS_DESC"),restart:t("NO"),range:{min:1,max:32768}},{key:"work_mem",name:"work_mem",value:parseInt((0,o.default)(e,"work_mem","4MB"),10),description:t("DBPARAM_WORK_MEM_DESC"),range:{min:1,max:1024},restart:t("NO")},{key:"maintenance_work_mem",name:"maintenance_work_mem",value:parseInt((0,o.default)(e,"maintenance_work_mem","64MB"),10),description:t("DBPARAM_MAINTENANCE_WORK_MEM_DESC"),range:{min:64,max:1024},restart:t("NO")},{key:"shared_buffers",name:"shared_buffers",value:parseInt((0,o.default)(e,"shared_buffers","128MB"),10),description:t("DBPARAM_SHARED_BUFFERS_DESC"),range:{min:128,max:10240},restart:t("YES")},{key:"max_connections",name:"max_connections",value:(0,o.default)(e,"max_connections",100),description:t("DBPARAM_MAX_CONNECTIONS_DESC"),range:{min:100,max:262143},restart:t("YES")},{key:"max_worker_processes",name:"max_worker_processes",value:(0,o.default)(e,"max_worker_processes",20),description:t("DBPARAM_WORKER_PROCESSES_DESC"),range:{min:10,max:65536},restart:t("YES")},{key:"wal_writer_delay",name:"wal_writer_delay",value:(0,o.default)(e,"wal_writer_delay",10),description:t("DBPARAM_WAL_WRITER_DELAY_DESC"),range:{min:1,max:1e4},restart:t("NO")},{key:"wal_writer_flush_after",name:"wal_writer_flush_after",value:parseInt((0,o.default)(e,"wal_writer_flush_after","1MB"),10),description:t("DBPARAM_WAL_WRITER_FLUSH_AFTER_DESC"),restart:t("NO"),range:{min:1,max:1024}},{key:"commit_delay",name:"commit_delay",value:(0,o.default)(e,"commit_delay",0),description:t("DBPARAM_COMMIT_DELAY_DESC"),range:{min:0,max:1e5},restart:t("NO")},{key:"commit_siblings",name:"commit_siblings",value:(0,o.default)(e,"commit_siblings",5),description:t("DBPARAM_COMMIT_SIBLINGS_DESC"),range:{min:0,max:1e3},restart:t("NO")},{key:"bgwriter_delay",name:"bgwriter_delay",value:(0,o.default)(e,"bgwriter_delay",10),description:t("DBPARAM_BGWRITER_DELAY_DESC"),range:{min:10,max:1e4},restart:t("NO")},{key:"bgwriter_lru_maxpages",name:"bgwriter_lru_maxpages",value:(0,o.default)(e,"bgwriter_lru_maxpages",1e3),description:t("DBPARAM_BGWRITER_LRU_MAXPAGES_DESC"),range:{min:0,max:1073741823},restart:t("NO")},{key:"bgwriter_flush_after",name:"bgwriter_flush_after",value:parseInt((0,o.default)(e,"bgwriter_flush_after","512KB"),10),description:t("DBPARAM_BGWRITER_FLUSH_AFTER_DESC"),restart:t("NO"),range:{min:0,max:2048}},{key:"statement_timeout",name:"statement_timeout",value:(0,o.default)(e,"statement_timeout",0),description:t("DBPARAM_STATEMENT_TIMEOUT_DESC"),range:{min:0,max:2147483647},restart:t("NO")},{key:"idle_in_transaction_session_timeout",name:"idle_in_transaction_session_timeout",value:(0,o.default)(e,"idle_in_transaction_session_timeout",864e5),description:t("DBPARAM_IDLE_IN_TRANSACTION_SESSION_TIMEOUT_DESC"),range:{min:0,max:2147483647},restart:t("NO")},{key:"log_min_duration_statement",name:"log_min_duration_statement",value:(0,o.default)(e,"log_min_duration_statement",1e4),description:t("DBPARAM_LOG_MIN_DURATION_STATEMENT_DESC"),range:{min:-1,max:2147483647},restart:t("NO")},{key:"checkpoint_timeout",name:"checkpoint_timeout",value:(0,o.default)(e,"checkpoint_timeout",300),description:t("DBPARAM_CHECKPOINT_TIMEOUT_DESC"),range:{min:30,max:86400},restart:t("NO")},{key:"autovacuum_vacuum_cost_delay",name:"autovacuum_vacuum_cost_delay",value:(0,o.default)(e,"autovacuum_vacuum_cost_delay",0),description:t("DBPARAM_AUTOVACUUM_VACUUM_COST_DELAY_DESC"),range:{min:-1,max:100},restart:t("NO")},{key:"autovacuum_vacuum_cost_limit",name:"autovacuum_vacuum_cost_limit",value:(0,o.default)(e,"autovacuum_vacuum_cost_limit",1e4),description:t("DBPARAM_AUTOVACUUM_VACUUM_COST_LIMIT_DESC"),restart:t("NO"),range:{min:-1,max:1e4}},{key:"autovacuum_vacuum_scale_factor",name:"autovacuum_vacuum_scale_factor",value:(0,o.default)(e,"autovacuum_vacuum_scale_factor",.02),description:t("DBPARAM_AUTOVACUUM_VACUUM_SCALE_FACTOR_DESC"),restart:t("NO"),integer:!1,range:{min:.01,max:100}},{key:"autovacuum_analyze_scale_factor",name:"autovacuum_analyze_scale_factor",value:(0,o.default)(e,"autovacuum_analyze_scale_factor",.05),description:t("DBPARAM_AUTOVACUUM_ANALYZE_SCALE_FACTOR_DESC"),restart:t("NO"),integer:!1,range:{min:.01,max:100}},{key:"vacuum_defer_cleanup_age",name:"vacuum_defer_cleanup_age",value:(0,o.default)(e,"vacuum_defer_cleanup_age",1e4),description:t("DBPARAM_VACUUM_DEFER_CLEANUP_AGE_DESC"),restart:t("NO"),range:{min:0,max:1e6}},{key:"seq_page_cost",name:"seq_page_cost",value:(0,o.default)(e,"seq_page_cost",1),description:t("DBPARAM_SEQ_PAGE_COST_DESC"),restart:t("NO"),integer:!1,range:{min:0,max:1e8}},{key:"random_page_cost",name:"random_page_cost",value:(0,o.default)(e,"random_page_cost",1.1),description:t("DBPARAM_RANDOM_PAGE_COST_DESC"),restart:t("NO"),integer:!1,range:{min:0,max:1e8}},{key:"cpu_tuple_cost",name:"cpu_tuple_cost",value:(0,o.default)(e,"cpu_tuple_cost",.01),description:t("DBPARAM_CPU_TUPLE_COST_DESC"),restart:t("NO"),integer:!1,range:{min:0,max:1e8}},{key:"cpu_index_tuple_cost",name:"cpu_index_tuple_cost",value:(0,o.default)(e,"cpu_index_tuple_cost",.005),description:t("DBPARAM_CPU_INDEX_TUPLE_COST_DESC"),restart:t("NO"),integer:!1,range:{min:0,max:1e8}},{key:"log_min_messages",name:"log_min_messages",value:(0,o.default)(e,"log_min_messages","WARNING"),description:t("DBPARAM_LOG_MIN_MESSAGES_DESC"),restart:t("NO"),type:"select",options:c.map((function(e){return{label:e,value:e}}))},{key:"log_statement",name:"log_statement",value:(0,o.default)(e,"log_statement","none"),description:t("DBPARAM_LOG_STATEMENT_DESC"),restart:t("NO"),type:"select",options:[{label:"none",value:"none"},{label:"ddl",value:"ddl"},{label:"mod",value:"mod"},{label:"all",value:"all"}]},{key:"max_wal_senders",name:"max_wal_senders",value:(0,o.default)(e,"max_wal_senders",15),description:t("DBPARAM_MAX_WAL_SENDERS_DESC"),restart:t("YES"),range:{min:10,max:262143}},{key:"max_replication_slots",name:"max_replication_slots",value:(0,o.default)(e,"max_replication_slots",15),description:t("DBPARAM_MAX_REPLICATION_SLOTS_DESC"),restart:t("YES"),range:{min:10,max:262143}}]},a.getMySQLParams=function(e){return[{key:"audit_log_policy",name:"audit_log_policy",value:e.audit_log_policy||"NONE",description:t("DBPARAM_AUDIT_LOG_POLICY_DESC"),restart:t("YES"),type:"select",options:[{label:"ALL",value:"ALL"},{label:"LOGINS",value:"LOGINS"},{label:"QEURIES",value:"QEURIES"},{label:"NONE",value:"NONE"}]},{key:"audit_log_format",name:"audit_log_format",value:e.audit_log_format||"OLD",description:t("DBPARAM_AUDIT_LOG_FORMAT_DESC"),restart:t("YES"),type:"select",options:[{label:"OLD",value:"OLD"},{label:"NEW",value:"NEW"},{label:"JSON",value:"JSON"}]},{key:"audit_log_rotate_on_size",name:"audit_log_rotate_on_size",value:parseInt(e.audit_log_rotate_on_size||104857600,10),description:t("DBPARAM_AUDIT_LOG_ROTATE_ON_SIZE_DESC"),restart:t("YES"),range:{min:20971520,max:2147483648}},{key:"audit_log_rotations",name:"audit_log_rotations",value:e.audit_log_rotations||6,description:t("DBPARAM_AUDIT_LOG_ROTATIONS_DESC"),restart:t("YES"),range:{min:6,max:48}},{key:"default_storage_engine",name:"default_storage_engine",value:e.default_storage_engine||"InnoDB",description:t("DBPARAM_DEFAULT_STORAGE_ENGINE_DESC"),restart:t("YES"),type:"select",options:[{label:"InnoDB",value:"InnoDB"},{label:"TokuDB",value:"TokuDB"}]},{key:"innodb_buffer_pool_size",name:"innodb_buffer_pool_size",value:parseInt((0,o.default)(e,"innodb_buffer_pool_size","-1"),10),description:t("DBPARAM_INNODB_BUFFER_POOL_SIZE_DESC"),restart:t("YES"),range:{min:-1}},{key:"character_set_server",name:"character_set_server",value:(0,o.default)(e,"character_set_server","utf8mb4"),description:t("DBPARAM_CHARACTER_SET_SERVER_DESC"),restart:t("YES"),type:"text"},{key:"expire_logs_days",name:"expire_logs_days",value:parseInt((0,o.default)(e,"expire_logs_days","7"),10),description:t("DBPARAM_EXPIRE_LOGS_DAYS_DESC"),restart:t("YES"),range:{min:0,max:14}},{key:"long_query_time",name:"long_query_time",value:parseInt((0,o.default)(e,"long_query_time","3"),10),description:t("DBPARAM_LONG_QUERY_TIME_DESC"),restart:t("YES"),range:{min:0,max:300}},{key:"max_connections",name:"max_connections",value:parseInt((0,o.default)(e,"max_connections","1024"),10),description:t("DBPARAM_MAX_CONNECTIONS_DESC"),restart:t("YES"),range:{min:1024,max:16384}},{key:"max_connect_errors",name:"max_connect_errors",value:parseInt((0,o.default)(e,"max_connect_errors","655360"),10),description:t("DBPARAM_MAX_CONNECT_ERRORS_DESC"),restart:t("YES"),range:{min:1,max:4294967295}},{key:"wait_timeout",name:"wait_timeout",value:parseInt((0,o.default)(e,"wait_timeout","3600"),10),description:t("DBPARAM_WAIT_TIMEOUT_DESC"),restart:t("YES"),range:{min:1,max:2147483}},{key:"max_allowed_packet",name:"max_allowed_packet",value:parseInt((0,o.default)(e,"max_allowed_packet","1073741824"),10),description:t("DBPARAM_MAX_ALLOWED_PACKET_DESC"),restart:t("YES"),range:{min:1024,max:1073741824}},{key:"slave_parallel_workers",name:"slave_parallel_workers",value:parseInt((0,o.default)(e,"slave_parallel_workers","8"),10),description:t("DBPARAM_SLAVE_PARALLEL_WORKERS_DESC"),restart:t("YES"),range:{min:0,max:1024}},{key:"skip_name_resolve",name:"skip_name_resolve",value:(0,o.default)(e,"skip_name_resolve","0"),description:t("DBPARAM_SKIP_NAME_RESOLVE_DESC"),restart:t("YES"),type:"select",options:[{label:"0",value:"0"},{label:"1",value:"1"}]},{key:"autocommit",name:"autocommit",value:(0,o.default)(e,"autocommit","1"),description:t("DBPARAM_AUTOCOMMIT_DESC"),restart:t("YES"),type:"select",options:[{label:"0",value:"0"},{label:"1",value:"1"}]},{key:"transaction_isolation",name:"transaction_isolation",value:(0,o.default)(e,"transaction_isolation","READ-COMMITTED"),description:t("DBPARAM_TRANSACTION_ISOLATION_DESC"),restart:t("YES"),type:"select",options:[{label:"REPEATABLE-READ",value:"REPEATABLE-READ"},{label:"READ-UNCOMMITTED",value:"READ-UNCOMMITTED"},{label:"READ-COMMITTED",value:"READ-COMMITTED"},{label:"SERIALIZABLE",value:"SERIALIZABLE"}]},{key:"innodb_flush_method",name:"innodb_flush_method",value:(0,o.default)(e,"innodb_flush_method","O_DIRECT"),description:t("DBPARAM_INNODB_FLUSH_METHOD_DESC"),restart:t("YES"),type:"select",options:[{label:"O_DIRECT",value:"O_DIRECT"},{label:"fsync",value:"fsync"}]},{key:"innodb_use_native_aio",name:"innodb_use_native_aio",value:(0,o.default)(e,"innodb_use_native_aio","1"),description:t("DBPARAM_INNODB_USE_NATIVE_AIO_DESC"),restart:t("YES"),type:"select",options:[{label:"0",value:"0"},{label:"1",value:"1"}]}]},a.getMongoDBParams=function(e){return[{key:"port",name:"port",value:(0,o.default)(e,"port",27017),description:t("DBPARAM_MONGODB_PORT_DESC"),restart:t("YES")},{key:"oplogSizeMB",name:"oplogSizeMB",value:(0,o.default)(e,"oplogSizeMB",10240),description:t("DBPARAM_OPLOGSIZEMB_DESC"),range:{min:1024,max:51200},restart:t("NO")},{key:"maxIncomingConnections",name:"maxIncomingConnections",value:(0,o.default)(e,"maxIncomingConnections",1e4),description:t("DBPARAM_MAXINCOMINGCONNECTIONS_DESC"),range:{min:3e3,max:2e4},restart:t("YES")},{key:"cursorTimeoutMillis",name:"cursorTimeoutMillis",value:(0,o.default)(e,"cursorTimeoutMillis",6e5),description:t("DBPARAM_CURSORTIMEOUTMILLIS_DESC"),restart:t("YES")},{key:"profilingMode",name:"profilingMode",value:(0,o.default)(e,"profilingMode","off"),description:t("DBPARAM_PROFILINGMODE_MODE"),restart:t("YES"),type:"select",options:[{label:"off",value:"off"},{label:"slowOp",value:"slowOp"},{label:"all",value:"all"}]},{key:"slowOpThresholdMs",name:"slowOpThresholdMs",value:(0,o.default)(e,"slowOpThresholdMs",100),description:t("DBPARAM_SLOWOPTHRESHOLDMS_DESC"),restart:t("YES")},{key:"enableMajorityReadConcern",name:"enableMajorityReadConcern",value:(0,o.default)(e,"enableMajorityReadConcern","true").toString(),description:t("DBPARAM_ENABLEMAJORITYREADCONCERN_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"commandVerbosity",name:"commandVerbosity",value:(0,o.default)(e,"commandVerbosity","0"),description:t("DBPARAM_COMMANDVERBOSITY_DESC"),restart:t("YES"),type:"select",options:[{label:"0",value:"0"},{label:"1",value:"1"}]},{key:"indexVerbosity",name:"indexVerbosity",value:(0,o.default)(e,"indexVerbosity","0"),description:t("DBPARAM_INDEXVERBOSITY_DESC"),restart:t("YES"),type:"select",options:[{label:"0",value:"0"},{label:"1",value:"1"}]},{key:"queryVerbosity",name:"queryVerbosity",value:(0,o.default)(e,"queryVerbosity","0"),description:t("DBPARAM_QUERYVERBOSITY_DESC"),restart:t("YES"),type:"select",options:[{label:"0",value:"0"},{label:"1",value:"1"}]},{key:"networkVerbosity",name:"networkVerbosity",value:(0,o.default)(e,"networkVerbosity","0"),description:t("DBPARAM_NETWORKVERBOSITY_DESC"),restart:t("YES"),type:"select",options:[{label:"0",value:"0"},{label:"1",value:"1"}]},{key:"writeVerbosity",name:"writeVerbosity",value:(0,o.default)(e,"writeVerbosity","0"),description:t("DBPARAM_WRITEVERBOSITY_DESC"),restart:t("YES"),type:"select",options:[{label:"0",value:"0"},{label:"1",value:"1"}]}]},a.getRedisParams=function(e){return[{key:"endpointType",name:t("ENDPOINT_TYPE"),value:(0,o.default)(e,"endpointType","false").toString(),description:t("ENDPOINT_TYPE_DESC"),restart:t("YES"),type:"select",options:[{label:t("ENABLED"),value:"true"},{label:t("DISABLED"),value:"false"}]},{key:"maxmemory",name:"maxmemory",value:parseInt((0,o.default)(e,"maxmemory",0),10),description:t("DBPARAM_MAXMEMORY_DESC"),range:{min:0},restart:t("NO")},{key:"activerehashing",name:"activerehashing",value:(0,o.default)(e,"activerehashing","yes"),description:t("DBPARAM_ACTIVEREHASHING_DESC"),restart:t("NO"),type:"select",options:[{label:"yes",value:"yes"},{label:"no",value:"no"}]},{key:"appendonly",name:"appendonly",value:(0,o.default)(e,"appendonly","yes"),description:t("DBPARAM_APPENDONLY_DESC"),restart:t("NO"),type:"select",options:[{label:"yes",value:"yes"},{label:"no",value:"no"}]},{key:"appendfsync",name:"appendfsync",value:(0,o.default)(e,"appendfsync","everysec"),description:t("DBPARAM_APPENDFSYNC_DESC"),restart:t("NO"),type:"select",options:[{label:"no",value:"no"},{label:"everysec",value:"everysec"},{label:"always",value:"always"}]},{key:"cluster-node-timeout",name:"cluster-node-timeout",value:parseInt((0,o.default)(e,"cluster-node-timeout",15e3),10),description:t("DBPARAM_CLUSTER_NODE_TIMEOUT_DESC"),range:{min:1e3,max:6e6},restart:t("NO")},{key:"latency-monitor-threshold",name:"latency-monitor-threshold",value:parseInt((0,o.default)(e,"latency-monitor-threshold",0),10),description:t("DBPARAM_LATENCY_MONITOR_THRESHOLD_DESC"),range:{min:0},restart:t("NO")},{key:"maxclients",name:"maxclients",value:parseInt((0,o.default)(e,"maxclients",102400),10),description:t("DBPARAM_MAXCLIENTS_DESC"),range:{min:10},restart:t("NO")},{key:"maxmemory-policy",name:"maxmemory-policy",value:(0,o.default)(e,"maxmemory-policy","volatile-lru"),description:t("DBPARAM_MAXMEMORY_POLICY_DESC"),restart:t("NO"),type:"select",options:[{label:"volatile-lru",value:"volatile-lru"},{label:"allkeys-lru",value:"allkeys-lru"},{label:"volatile-random",value:"volatile-random"},{label:"allkeys-random",value:"allkeys-random"},{label:"volatile-ttl",value:"volatile-ttl"},{label:"noevtication",value:"noevtication"}]},{key:"maxmemory-samples",name:"maxmemory-samples",value:parseInt((0,o.default)(e,"maxmemory-samples",3),10),description:t("DBPARAM_MAXMEMORY_SAMPLES_DESC"),range:{min:1,max:100},restart:t("NO")},{key:"min-slaves-max-lag",name:"min-slaves-max-lag",value:parseInt((0,o.default)(e,"min-slaves-max-lag",10),10),description:t("DBPARAM_MIN_SLAVES_MAX_LAG_DESC"),range:{min:0},restart:t("NO")},{key:"min-slaves-to-write",name:"min-slaves-to-write",value:parseInt((0,o.default)(e,"min-slaves-to-write",0),10),description:t("DBPARAM_MIN_SLAVES_TO_WRITE_DESC"),range:{min:0},restart:t("NO")},{key:"no-appendfsync-on-rewrite",name:"no-appendfsync-on-rewrite",value:(0,o.default)(e,"no-appendfsync-on-rewrite","no"),description:t("DBPARAM_NO_APPENDFSYNC_ON_REWRITE_DESC"),restart:t("NO"),type:"select",options:[{label:"yes",value:"yes"},{label:"no",value:"no"}]},{key:"notify-keyspace-events",name:"notify-keyspace-events",value:(0,o.default)(e,"notify-keyspace-events",""),description:t("DBPARAM_NOTIFY_KEYSPACE_EVENTS_DESC"),restart:t("NO")},{key:"repl-backlog-size",name:"repl-backlog-size",value:parseInt((0,o.default)(e,"repl-backlog-size",1),10),description:t("DBPARAM_REPL_BACKLOG_SIZE_DESC"),range:{min:1,max:1024},restart:t("NO")},{key:"repl-backlog-ttl",name:"repl-backlog-ttl",value:parseInt((0,o.default)(e,"repl-backlog-ttl",3600),10),description:t("DBPARAM_REPL_BACKLOG_TTL_DESC"),range:{min:1,max:864e3},restart:t("NO")},{key:"repl-timeout",name:"repl-timeout",value:parseInt((0,o.default)(e,"repl-timeout",60),10),description:t("DBPARAM_REPL_TIMEOUT_DESC"),range:{min:1,max:86400},restart:t("NO")},{key:"set-max-intset-entries",name:"set-max-intset-entries",value:parseInt((0,o.default)(e,"set-max-intset-entries",512),10),description:t("DBPARAM_SET_MAX_INTSET_ENTRIES_DESC"),restart:t("NO")},{key:"slowlog-log-slower-than",name:"slowlog-log-slower-than",value:parseInt((0,o.default)(e,"slowlog-log-slower-than",-1),10),description:t("DBPARAM_SLOWLOG_LOG_SLOWER_THAN_DESC"),range:{min:-1,max:6e7},restart:t("NO")},{key:"slowlog-max-len",name:"slowlog-max-len",value:parseInt((0,o.default)(e,"slowlog-max-len",128),10),description:t("DBPARAM_SLOWLOG_MAX_LEN_DESC"),range:{min:1},restart:t("NO")},{key:"hash-max-ziplist-entries",name:"hash-max-ziplist-entries",value:parseInt((0,o.default)(e,"hash-max-ziplist-entries",512),10),description:t("DBPARAM_HASH_MAX_ZIPLIST_ENTRIES_DESC"),range:{min:0},restart:t("NO")},{key:"hash-max-ziplist-value",name:"hash-max-ziplist-value",value:parseInt((0,o.default)(e,"hash-max-ziplist-value",64),10),description:t("DBPARAM_HASH_MAX_ZIPLIST_VALUE_DESC"),range:{min:0},restart:t("NO")},{key:"list-max-ziplist-entries",name:"list-max-ziplist-entries",value:parseInt((0,o.default)(e,"list-max-ziplist-entries",512),10),description:t("DBPARAM_LIST_MAX_ZIPLIST_ENTRIES_DESC"),range:{min:0},restart:t("NO")},{key:"list-max-ziplist-value",name:"list-max-ziplist-value",value:parseInt((0,o.default)(e,"list-max-ziplist-value",64),10),description:t("DBPARAM_LIST_MAX_ZIPLIST_VALUE_DESC"),range:{min:0},restart:t("NO")},{key:"zset-max-ziplist-entries",name:"zset-max-ziplist-entries",value:parseInt((0,o.default)(e,"zset-max-ziplist-entries",128),10),description:t("DBPARAM_ZSET_MAX_ZIPLIST_ENTRIES_DESC"),range:{min:0},restart:t("NO")},{key:"zset-max-ziplist-value",name:"zset-max-ziplist-value",value:parseInt((0,o.default)(e,"zset-max-ziplist-value",64),10),description:t("DBPARAM_ZSET_MAX_ZIPLIST_VALUE_DESC"),range:{min:0},restart:t("NO")},{key:"lua-time-limit",name:"lua-time-limit",value:parseInt((0,o.default)(e,"lua-time-limit",5e3),10),description:t("DBPARAM_LUA_TIME_LIMIT_DESC"),range:{min:0},restart:t("NO")},{key:"io-threads-do-reads",name:"io-threads-do-reads",value:(0,o.default)(e,"io-threads-do-reads","no"),description:t("DBPARAM_IO_THREADS_DO_READS_DESC"),restart:t("YES"),type:"select",options:[{label:"yes",value:"yes"},{label:"no",value:"no"}]},{key:"io-threads",name:"io-threads",value:parseInt((0,o.default)(e,"io-threads",1),10),description:t("DBPARAM_IO_THREADS_DESC"),range:{min:1,max:100},restart:t("YES")},{key:"logfile",name:"logfile",value:(0,o.default)(e,"logfile","logfile"),description:t("DBPARAM_LOGFILE_DESC"),restart:t("YES"),type:"select",options:[{label:"logfile",value:"logfile"},{label:"stdout",value:"stdout"}]}]},a.getECKParams=function(e){return[{key:"thread_pool.write.queue_size",name:"thread_pool.write.queue_size",value:(0,o.default)(e,'["thread_pool.write.queue_size"]',1e4),description:t("DBPARAM_THREAD_POOL_WRITE_QUEUE_SIZE_DESC"),range:{min:1e3,max:2e4},restart:t("YES")},{key:"thread_pool.search.queue_size",name:"thread_pool.search.queue_size",value:(0,o.default)(e,'["thread_pool.search.queue_size"]',1e3),description:t("DBPARAM_THREAD_POOL_SEARCH_QUEUE_SIZE_DESC"),range:{min:1e3,max:2e4},restart:t("YES")},{key:"action.destructive_requires_name",name:"action.destructive_requires_name",value:(0,o.default)(e,'["action.destructive_requires_name"]',"true").toString(),description:t("DBPARAM_ACTION_DESTRUCTIVE_REQUIRES_NAME_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"http.cors.enabled",name:"http.cors.enabled",value:(0,o.default)(e,'["http.cors.enabled"]',"false").toString(),description:t("DBPARAM_HTTP_CORS_ENABLED_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"http.cors.allow-origin",name:"http.cors.allow-origin",value:(0,o.default)(e,'["http.cors.allow-origin"]',""),description:t("DBPARAM_HTTP_CORS_ALLOW_ORIGIN_DESC"),restart:t("YES")},{key:"indices.fielddata.cache.size",name:"indices.fielddata.cache.size",value:(0,o.default)(e,'["indices.fielddata.cache.size"]',"-1b"),description:t("DBPARAM_INDICES_FIELDDATA_CACHE_SIZE"),restart:t("YES")},{key:"indices.memory.index_buffer_size",name:"indices.memory.index_buffer_size",value:(0,o.default)(e,'["indices.memory.index_buffer_size"]',"10%"),description:t("DBPARAM_INDICES_MEMORY_INDEX_BUFFER_SIZE_DESC"),restart:t("YES")},{key:"indices.queries.cache.size",name:"indices.queries.cache.size",value:(0,o.default)(e,'["indices.queries.cache.size"]',"10%"),description:t("DBPARAM_INDICES_QUERIES_CACHE_SIZE_DESC"),restart:t("YES")},{key:"indices.requests.cache.size",name:"indices.requests.cache.size",value:(0,o.default)(e,'["indices.requests.cache.size"]',"1%"),description:t("DBPARAM_INDICES_REQUESTS_CACHE_SIZE_DESC"),restart:t("YES")},{key:"reindex.remote.whitelist",name:"reindex.remote.whitelist",value:(0,o.default)(e,'["reindex.remote.whitelist"]',""),description:t("DBPARAM_REINDEX_REMOTE_WHITELIST_DESC"),restart:t("YES")},{key:"cluster.routing.allocation.awareness.attributes",name:"cluster.routing.allocation.awareness.attributes",value:(0,o.default)(e,'["cluster.routing.allocation.awareness.attributes"]',""),description:t("DBPARAM_CLUSTER_ROUTING_ALLOCATION_AWARENESS_ATTRIBUTES_DESC"),restart:t("YES")}]},a.getKafkaParams=function(e,a){if("kafka"===a)return[{key:"num.partitions",name:"num.partitions",value:(0,o.default)(e,"num.partitions",3),description:t("DBPARAM_KAFKA_PARTITIONS_DESC"),range:{min:1,max:1e3},restart:t("YES")},{key:"tls",name:"TLS",value:(0,o.default)(e,"tls","true").toString(),description:t("DBPARAM_KAFKA_TLS_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"authentication",name:t("DBPARAM_AUTHENTICATION_TYPE"),value:(0,o.default)(e,"authentication","tls").toString(),description:t("DBPARAM_KAFKA_AUTHENTICATION_TYPE_DESC"),restart:t("YES"),type:"select",options:[{label:t("NO_AUTH"),value:"no"},{label:"TLS",value:"tls"},{label:"SCRAM-SHA-512",value:"scram-sha-512"}]},{key:"nodePort",name:t("DBPARAM_NODE_PORT"),value:(0,o.default)(e,"nodePort","false").toString(),description:t("DBPARAM_NODE_PORT_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"log.retention.bytes",name:"log.retention.bytes",value:(0,o.default)(e,'["log.retention.bytes"]',-1),description:t("DBPARAM_LOG_RETENTION_BYTES_DESC"),range:{min:-1,max:2147483647},restart:t("YES")},{key:"log.retention.hours",name:"log.retention.hours",value:(0,o.default)(e,'["log.retention.hours"]',168),description:t("DBPARAM_LOG_RETENTION_HOURS_DESC"),range:{min:1,max:8760},restart:t("YES")},{key:"log.segment.bytes",name:"log.segment.bytes",value:(0,o.default)(e,'["log.segment.bytes"]',1073741824),description:t("DBPARAM_LOG_SEGMENT_BYTES_DESC"),range:{min:1048576,max:2147483647},restart:t("YES")},{key:"log.segment.delete.delay.ms",name:"log.segment.delete.delay.ms",value:(0,o.default)(e,'["log.segment.delete.delay.ms"]',6e4),description:t("DBPARAM_LOG_SEGMENT_DELETE_DELAY_MS_DESC"),range:{min:0},restart:t("YES")},{key:"log.roll.hours",name:"log.roll.hours",value:(0,o.default)(e,'["log.roll.hours"]',168),description:t("DBPARAM_LOG_ROLL_HOURS_DESC"),range:{min:1},restart:t("YES")},{key:"offsets.topic.replication.factor",name:"offsets.topic.replication.factor",value:(0,o.default)(e,'["offsets.topic.replication.factor"]',3),description:t("DBPARAM_OFFSETS_TOPIC_REPLICATION_FACTOR"),range:{min:1,max:100},restart:t("YES")},{key:"log.cleanup.policy",name:"log.cleanup.policy",value:(0,o.default)(e,'["log.cleanup.policy"]',"delete"),description:t("DBPARAM_LOG_CLEANUP_POLICY_DESC"),restart:t("YES"),type:"select",options:[{label:"delete",value:"delete"},{label:"compact",value:"compact"}]},{key:"log.cleaner.enable",name:"log.cleaner.enable",value:(0,o.default)(e,'["log.cleaner.enable"]',"true").toString(),description:t("DBPARAM_LOG_CLEANER_ENABLE_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"compression.type",name:"compression.type",value:(0,o.default)(e,'["compression.type"]',"producer"),description:t("DBPARAM_COMPRESSION_TYPE_DESC."),restart:t("YES"),type:"select",options:["uncompressed","zstd","lz4","snappy","gzip","producer"].map((function(e){return{label:e,value:e}}))},{key:"message.max.bytes",name:"message.max.bytes",value:(0,o.default)(e,'["message.max.bytes"]',1e6),description:t("DBPARAM_MESSAGE_MAX_BYTES_DESC"),range:{min:1024,max:2147483647},restart:t("YES")},{key:"num.network.threads",name:"num.network.threads",value:(0,o.default)(e,'["num.network.threads"]',3),description:t("DBPARAM_NUM_NETWORK_THREADS_DESC"),range:{min:1},restart:t("YES")},{key:"num.io.threads",name:"num.io.threads",value:(0,o.default)(e,'["num.io.threads"]',8),description:t("DBPARAM_NUM_IO_THREADS_DESC"),range:{min:1,max:20},restart:t("YES")},{key:"num.recovery.threads.per.data.dir",name:"num.recovery.threads.per.data.dir",value:(0,o.default)(e,'["num.recovery.threads.per.data.dir"]',1),description:t("DBPARAM_NUM_RECOVERY_THREADS_PER_DATA_DIR_DESC"),range:{min:1},restart:t("YES")},{key:"num.replica.fetchers",name:"num.replica.fetchers",value:(0,o.default)(e,'["num.replica.fetchers"]',1),description:t("DBPARAM_NUM_REPLICA_FETCHERS_DESC"),range:{min:1,max:10},restart:t("YES")},{key:"queued.max.requests",name:"queued.max.requests",value:(0,o.default)(e,'["queued.max.requests"]',500),description:t("DBPARAM_QUEUED_MAX_REQUESTS_DESC"),range:{min:1,max:5e3},restart:t("YES")},{key:"replica.lag.time.max.ms",name:"replica.lag.time.max.ms",value:(0,o.default)(e,'["replica.lag.time.max.ms"]',1e4),description:t("DBPARAM_REPLICA_LAG_TIME_MAX_MS_DESC"),range:{min:6e3,max:99999},restart:t("YES")},{key:"group.max.session.timeout.ms",name:"group.max.session.timeout.ms",value:(0,o.default)(e,'["group.max.session.timeout.ms"]',18e5),description:t("DBPARAM_GROUP_MAX_SESSION_TIMEOUT_MS_DESC"),range:{min:0,max:9999999},restart:t("YES")},{key:"group.min.session.timeout.ms",name:"group.min.session.timeout.ms",value:(0,o.default)(e,'["group.min.session.timeout.ms"]',6e3),description:t("DBPARAM_GROUP_MIN_SESSION_TIMEOUT_MS_DESC"),range:{min:0,max:6e4},restart:t("YES")},{key:"auto.create.topics.enable",name:"auto.create.topics.enable",value:(0,o.default)(e,'["auto.create.topics.enable"]',"true").toString(),description:t("DBPARAM_AUTO_CREATE_TOPICS_ENABLE_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"min.insync.replicas",name:"min.insync.replicas",value:(0,o.default)(e,'["min.insync.replicas"]',2),description:t("DBPARAM_MIN_INSYNC_REPLICAS_DESC"),range:{min:1,max:6},restart:t("YES")},{key:"default.replication.factor",name:"default.replication.factor",value:(0,o.default)(e,'["default.replication.factors"]',3),description:t("DBPARAM_DEFAULT_REPLICATION_FACTORS_DESC"),range:{min:1,max:6},restart:t("YES")},{key:"jmxOptions",name:"jmxOptions",value:(0,o.default)(e,"jmxOptions","disable"),description:t("DBPARAM_JMXOPTIONS_DESC"),restart:t("YES"),type:"select",options:[{label:"disable",value:"disable"},{label:"enable",value:"enable"},{label:"password",value:"password"}]}];return[{key:"tickTime",name:"tickTime",value:(0,o.default)(e,"tickTime",2e3),range:{min:1,max:1e6},description:t("DBPARAM_TICKTIME_DESC"),restart:t("YES")},{key:"initLimit",name:"initLimit",value:(0,o.default)(e,"initLimit",5),range:{min:1,max:1e6},description:t("DBPARAM_INITLIMIT_DESC"),restart:t("YES")},{key:"syncLimit",name:"syncLimit",value:(0,o.default)(e,"syncLimit",2),range:{min:1,max:1e6},description:t("DBPARAM_SYNCLIMIT_DESC"),restart:t("YES")},{key:"maxClientCnxns",name:"maxClientCnxns",value:(0,o.default)(e,"maxClientCnxns",1e3),range:{min:1,max:1e6},description:t("DBPARAM_MAXCLIENTCNXNS_DESC"),restart:t("YES")},{key:"autopurge.snapRetainCount",name:"autopurge.snapRetainCount",value:(0,o.default)(e,'["autopurge.snapRetainCount"]',3),range:{min:3,max:1e8},description:t("DBPARAM_AUTOPURGE_SNAPRETAINCOUNT_DESC"),restart:t("YES")},{key:"autopurge.purgeInterval",name:"autopurge.purgeInterval",value:(0,o.default)(e,'["autopurge.purgeInterval"]',1),range:{min:0,max:720},description:t("DBPARAM_AUTOPURGE_PURGEINTERVAL_DESC"),restart:t("YES")},{key:"jmxOptions",name:"jmxOptions",value:(0,o.default)(e,"jmxOptions","disable"),description:t("DBPARAM_JMXOPTIONS_DESC"),restart:t("YES"),type:"select",options:[{label:"disable",value:"disable"},{label:"enable",value:"enable"},{label:"password",value:"password"}]}]},a.getOpenSearchParams=function(e){return[{key:"thread_pool.write.queue_size",name:"thread_pool.write.queue_size",value:(0,o.default)(e,'["thread_pool.write.queue_size"]',1e4),description:t("DBPARAM_THREAD_POOL_WRITE_QUEUE_SIZE_DESC"),range:{min:1e3,max:2e4},restart:t("YES")},{key:"thread_pool.search.queue_size",name:"thread_pool.search.queue_size",value:(0,o.default)(e,'["thread_pool.search.queue_size"]',1e3),description:t("DBPARAM_THREAD_POOL_SEARCH_QUEUE_SIZE_DESC"),range:{min:1e3,max:2e4},restart:t("YES")},{key:"action.destructive_requires_name",name:"action.destructive_requires_name",value:(0,o.default)(e,'["action.destructive_requires_name"]',"true").toString(),description:t("DBPARAM_ACTION_DESTRUCTIVE_REQUIRES_NAME_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"http.cors.enabled",name:"http.cors.enabled",value:(0,o.default)(e,'["http.cors.enabled"]',"false").toString(),description:t("DBPARAM_HTTP_CORS_ENABLED_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"http.cors.allow-origin",name:"http.cors.allow-origin",value:(0,o.default)(e,'["http.cors.allow-origin"]',""),description:t("DBPARAM_HTTP_CORS_ALLOW_ORIGIN_DESC"),restart:t("YES")},{key:"indices.fielddata.cache.size",name:"indices.fielddata.cache.size",value:(0,o.default)(e,'["indices.fielddata.cache.size"]',"-1b"),description:t("DBPARAM_INDICES_FIELDDATA_CACHE_SIZE"),restart:t("YES")},{key:"indices.memory.index_buffer_size",name:"indices.memory.index_buffer_size",value:(0,o.default)(e,'["indices.memory.index_buffer_size"]',"10%"),description:t("DBPARAM_INDICES_MEMORY_INDEX_BUFFER_SIZE_DESC"),restart:t("YES")},{key:"indices.queries.cache.size",name:"indices.queries.cache.size",value:(0,o.default)(e,'["indices.queries.cache.size"]',"10%"),description:t("DBPARAM_INDICES_QUERIES_CACHE_SIZE_DESC"),restart:t("YES")},{key:"indices.requests.cache.size",name:"indices.requests.cache.size",value:(0,o.default)(e,'["indices.requests.cache.size"]',"1%"),description:t("DBPARAM_INDICES_REQUESTS_CACHE_SIZE_DESC"),restart:t("YES")},{key:"reindex.remote.whitelist",name:"reindex.remote.whitelist",value:(0,o.default)(e,'["reindex.remote.whitelist"]',""),description:t("DBPARAM_REINDEX_REMOTE_WHITELIST_DESC"),restart:t("YES")},{key:"logstash.PIPELINE_WORKERS",name:"LOGSTASH_PIPELINE_WORKERS",value:Number((0,o.default)(e,"logstash.PIPELINE_WORKERS",1)),description:t("DBPARAM_PIPELINE_WORKERS_DESC"),range:{min:1},restart:t("YES")},{key:"logstash.PIPELINE_BATCH_SIZE",name:"LOGSTASH_PIPELINE_BATCH_SIZE",value:Number((0,o.default)(e,"logstash.PIPELINE_BATCH_SIZE",125)),description:t("DBPARAM_PIPELINE_BATCH_SIZE_DESC"),range:{min:1},restart:t("YES")},{key:"logstash.PIPELINE_BATCH_DELAY",name:"LOGSTASH_PIPELINE_BATCH_DELAY",value:Number((0,o.default)(e,"logstash.PIPELINE_BATCH_DELAY",50)),description:t("DBPARAM_PIPELINE_BATCH_DELAY_DESC"),range:{min:1},restart:t("YES")},{key:"logstash.PIPELINE_UNSAFE_SHUTDOWN",name:"LOGSTASH_PIPELINE_UNSAFE_SHUTDOWN",value:(0,o.default)(e,"logstash.PIPELINE_UNSAFE_SHUTDOWN","false").toString(),description:t("DBPARAM_PIPELINE_UNSAFE_SHUTDOWN_DESC"),restart:t("YES"),type:"select",options:[{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"logstash.PIPELINE_ORDERED",name:"LOGSTASH_PIPELINE_ORDERED",value:(0,o.default)(e,"logstash.PIPELINE_ORDERED","auto"),description:t("DBPARAM_PIPELINE_ORDERED_DESC"),restart:t("YES"),type:"select",options:[{label:"auto",value:"auto"},{label:"true",value:"true"},{label:"false",value:"false"}]},{key:"logstash.PIPELINE.ECS_COMPATIBILITY",name:"LOGSTASH_PIPELINE.ECS_COMPATIBILITY",value:(0,o.default)(e,'logstash["PIPELINE.ECS_COMPATIBILITY"]',"v8"),description:t("DBPARAM_ECS_COMPATIBILITY_DESC"),restart:t("YES"),type:"select",options:[{label:"disabled",value:"disabled"},{label:"v1",value:"v1"},{label:"v8",value:"v8"}]},{key:"logstash.LOG_LEVEL",name:"LOGSTASH_LOG_LEVEL",value:(0,o.default)(e,"logstash.LOG_LEVEL","info"),description:t("DBPARAM_LOG_LEVEL_DESC"),restart:t("YES"),type:"select",options:[{label:"fatal",value:"fatal"},{label:"error",value:"error"},{label:"warn",value:"warn"},{label:"info",value:"info"},{label:"debug",value:"debug"},{label:"trace",value:"trace"}]},{key:"logstash.LOG_FORMAT",name:"LOGSTASH_LOG_FORMAT",value:(0,o.default)(e,"logstash.LOG_FORMAT","plain"),description:t("DBPARAM_LOG_FORMAT_DESC"),restart:t("YES"),type:"select",options:[{label:"plain",value:"plain"},{label:"json",value:"json"}]},{key:"logstash.jvm",name:"LOGSTASH_JVM",value:Number((0,o.default)(e,"logstash.jvm","50")),description:t("DBPARAM_LOG_JVM_DESC"),range:{min:50,max:75},restart:t("YES")}]},r(32),r(20),r(29),r(24),r(4),r(321),r(11);var o=n(r(26));var c=["DEBUG5","DEBUG","INFO","NOTICE","WARNING","ERROR"]},3961:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(20),a(51),a(24),a(138),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(247),a(51),a(442),a(141),a(29),a(120),a(24),a(138),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(7);var n=r(a(38)),o=r(a(58)),c=r(a(31)),s=r(a(50));a(35);var l,i=r(a(39)),u=r(a(25)),d=r(a(28)),f=r(a(41)),p=r(a(42)),m=r(a(37)),h=r(a(45)),v=r(a(26)),_=r(a(68)),g=a(17),y=r(a(49)),E=a(934),b=a(992);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var k=(l=function(e){(0,f.default)(r,e);var t,a=R(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).getListUrl=function(e){var t=e.cluster,a=e.namespace,r=e.id;return"/apis".concat(globals.app.isMultiCluster&&t?"/clusters/".concat(t):"","/kafka.strimzi.io/v1beta2/namespaces/").concat(a,"/kafkarebalances").concat(r?"?labelSelector=strimzi.io/cluster=".concat(r):"")},e.getResourceUrl=e.getListUrl,e.statusMap={"True-Ready":"Success","True-NotReady":"Failed"},e.statusNameMap={Success:"REBALANCE_SUCCESS",Failed:"REBALANCE_FAILED",Creating:"REBALANCING"},e}return(0,d.default)(r,[{key:"fetchList",value:(t=(0,i.default)(n.default.mark((function e(){var t,a,r,c,l,i,u,d,f,p=this,m=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{},a=t.cluster,t.workspace,r=t.namespace,c=t.more,l=t.id,i=(0,s.default)(t,["cluster","workspace","namespace","more","id"]),this.list.isLoading=!0,i.sortBy="createTime",i.limit!==1/0&&-1!==i.limit||(i.limit=-1,i.page=1),i.limit=i.limit||10,e.next=7,request.get(this.getResourceUrl({cluster:a,namespace:r,id:l}));case 7:return u=e.sent,d=((0,v.default)(u,"items")||[]).reverse().slice(0,3).map((function(e){var t=p.statusMap[(0,E.getStatusFromYaml)(e)]||"Creating";return{cluster:a,namespace:r,status:t,name:(0,v.default)(e,"metadata.name"),creationTimestamp:(0,v.default)(e,"metadata.creationTimestamp"),statusName:p.statusNameMap[t]}})),f=Number(u.total||d.length),this.list.update(O(O({data:c?[].concat((0,o.default)(this.list.data),(0,o.default)(d)):d,total:f},i),{},{limit:Number(i.limit)||10,page:Number(i.page)||1,isLoading:!1},this.list.silent?{}:{selectedRowKeys:[]})),e.abrupt("return",d);case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getYamlFromData",value:function(e){var t=JSON.parse(JSON.stringify(b.kafkaYaml.rebalance));return(0,_.default)(t,"metadata.name","".concat(e,"-").concat(Date.now())),(0,_.default)(t,'metadata.labels["strimzi.io/cluster"]',e),t}},{key:"create",value:function(e){var t=Object.assign({},e),a=this.getYamlFromData(t.id);return delete t.id,request.post(this.getListUrl(t),a)}}]),r}(y.default),(0,h.default)(l.prototype,"fetchList",[g.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchList"),l.prototype),(0,h.default)(l.prototype,"create",[g.action],Object.getOwnPropertyDescriptor(l.prototype,"create"),l.prototype),l);t.default=k},3962:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(3963)),o=r(a(3964));n.default.Item=o.default;var c=n.default;t.default=c},3963:function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var o=n(a(25)),c=n(a(28)),s=n(a(41)),l=n(a(42)),i=n(a(37)),u=r(a(0)),d=n(a(1)),f=n(a(5)),p=n(a(1659));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var h=function(e){(0,s.default)(a,e);var t=m(a);function a(){return(0,o.default)(this,a),t.apply(this,arguments)}return(0,c.default)(a,[{key:"render",value:function(){return u.default.createElement("ul",{className:(0,f.default)(p.default.attributes,this.props.className)},this.props.children)}}]),a}(u.PureComponent);t.default=h,h.propTypes={children:d.default.any}},3964:function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(14),a(4),a(18),a(43),a(11);var o=n(a(25)),c=n(a(28)),s=n(a(41)),l=n(a(42)),i=n(a(37)),u=r(a(0)),d=n(a(1)),f=n(a(5)),p=a(189),m=n(a(1659));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var v=function(e){(0,s.default)(a,e);var t=h(a);function a(){return(0,o.default)(this,a),t.apply(this,arguments)}return(0,c.default)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.value,r=e.tooltips,n=e.className;return u.default.createElement("li",{className:(0,f.default)(m.default.item,n)},u.default.createElement("div",{className:m.default.name},u.default.createElement("span",null,t,": "),""!==r&&u.default.createElement(p.Tooltip,{content:r,placement:"topLeft"},u.default.createElement(p.Icon,{name:"question",size:20}))),u.default.createElement("div",{className:m.default.value},a))}}]),a}(u.PureComponent);t.default=v,v.propTypes={name:d.default.string.isRequired,value:d.default.oneOfType([d.default.string,d.default.node]),tooltips:d.default.string},v.defaultProps={value:"-",tooltips:""}},3965:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(318),o=a(815),c=r(a(3966)),s=r(a(4005)),l=r(a(4009)),i=r(a(4011)),u=r(a(4016)),d=r(a(4024)),f=r(a(4026)),p="/:workspace/clusters/:cluster/projects/:namespace/applications/database/:id",m=[{path:"".concat(p,"/resource-status"),name:"resource-status",title:"OVERVIEW",component:c.default,exact:!0},{path:"".concat(p,"/monitoring"),title:"MONITORING",component:d.default,exact:!0},{path:"".concat(p,"/alerting"),title:"ALERT_RULE_GROUP_PL",component:u.default,exact:!0},{path:"".concat(p,"/account"),title:"DATABASE_USERS",component:s.default,exact:!0,excludeApp:[o.RadonDBAppId.MongoDB,o.RadonDBAppId.Elasticsearch,o.RadonDBAppId.OpenSearch]},{path:"".concat(p,"/backup"),title:"BACKUPS",component:l.default,exact:!0,excludeApp:[o.RadonDBAppId.ClickHouse,o.RadonDBAppId.RedisSentinel,o.RadonDBAppId.RedisCluster,o.RadonDBAppId.MongoDB,o.RadonDBAppId.Elasticsearch,o.RadonDBAppId.Kafka,o.RadonDBAppId.OpenSearch]},{path:"".concat(p,"/topic"),title:"TOPICS",component:f.default,exact:!0,only:o.RadonDBAppId.Kafka},{path:"".concat(p,"/config"),title:"PARAMETERS",component:i.default,exact:!0},(0,n.getIndexRoute)({path:p,to:"".concat(p,"/resource-status"),exact:!0})];t.default=m},3966:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(440),r(18),r(43),r(30),r(11),r(73),r(69),r(71),r(7);var o,c,s,l=n(r(31)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(243),v=r(189),_=n(r(245)),g=n(r(801)),y=n(r(807)),E=n(r(826)),b=r(56),S=r(815),O=r(1221),R=n(r(3967)),k=n(r(4004));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var D=m.default.createContext({nodeIP:"",updateState:null}),P=(0,h.inject)("detailStore")(o=(0,h.observer)((s=c=function(e){(0,d.default)(r,e);var a=T(r);function r(e){var t;return(0,i.default)(this,r),(t=a.call(this,e)).deleteNode=function(e){var a=t.props.match.params,r=a.cluster,n=a.namespace,o=a.id,c=a.workspace;t.store.deleteNode({workspace:c,podName:e,namespace:n,cluster:r,cluster_id:o})},t.store=e.detailStore,t.module=e.module,t.state={nodeIP:""},t}return(0,u.default)(r,[{key:"hasDeleteAction",get:function(){return(globals.app.getActions({workspace:this.props.match.params.workspace,module:"applications"})||[]).includes("delete")}}]),(0,u.default)(r,[{key:"renderPanel",value:function(){var e=this.store.detail,a=e.app_id,r=e.status,n=e.creationTimestamp,o=e.shardsCount,c=e.cpu,s=e.memory,l=e.storage,i=e.replicasCount,u=(0,_.default)(n),d=[];if(a===S.RadonDBAppId.Elasticsearch)d.push.apply(d,[{iconSrc:"/extensions-static/ks-console-embed/dist/v3dist/assets/pod.svg",label:this.store.detail.nodes.master,desc:1===this.store.detail.nodes.master?t("PRIMARY_NODE"):t("PRIMARY_NODE_PL")},{iconName:"database",label:this.store.detail.nodes.hot,desc:1===this.store.detail.nodes.hot?t("HOT_NODE"):t("HOT_NODE_PL")},{iconName:"cluster",label:this.store.detail.nodes.warm,desc:1===this.store.detail.nodes.warm?t("WARM_NODE"):t("WARM_NODE_PL")},{iconName:"cluster",label:this.store.detail.nodes.cold,desc:1===this.store.detail.nodes.cold?t("COLD_NODE"):t("COLD_NODE_PL")},{iconName:"cluster",label:this.store.detail.nodes.kibana,desc:1===this.store.detail.nodes.cold?t("KIBANA_NODE"):t("KIBANA_NODE_PL")}]);else if(a===S.RadonDBAppId.OpenSearch)d.push.apply(d,[{iconSrc:"/extensions-static/ks-console-embed/dist/v3dist/assets/pod.svg",label:this.store.detail.nodes.master,desc:1===this.store.detail.nodes.master?t("PRIMARY_NODE"):t("PRIMARY_NODE_PL")},{iconName:"database",label:this.store.detail.nodes.hot,desc:1===this.store.detail.nodes.hot?t("HOT_NODE"):t("HOT_NODE_PL")},{iconName:"cluster",label:this.store.detail.nodes.warm,desc:1===this.store.detail.nodes.warm?t("WARM_NODE"):t("WARM_NODE_PL")},{iconName:"cluster",label:this.store.detail.nodes.cold,desc:1===this.store.detail.nodes.cold?t("COLD_NODE"):t("COLD_NODE_PL")},{iconName:"cluster",label:this.store.detail.nodes.dashboard,desc:t("DASHBOARD_NODE")},{iconName:"cluster",label:this.store.detail.nodes.logstash,desc:t("LOGSTASH_NODE")}]);else if(a===S.RadonDBAppId.Kafka){var f=this.store.detail.specifications.kafka,p=this.store.detail.specifications.zookeeper;d.push.apply(d,[{iconSrc:"/extensions-static/ks-console-embed/dist/v3dist/assets/radondb_kafka.svg",label:this.store.detail.nodes.kafka,desc:this.store.detail.nodes.kafka?t("KAFKA_NODE"):t("KAFKA_NODE_PL")},{iconName:"cpu",label:"".concat(parseFloat(f.cpu)>500?t("VALUE_CORES",{value:(0,b.cpuFormat)(f.cpu)}):f.cpu||""," ").concat(f.memory||""," | ").concat(this.store.detail.storages.kafka),desc:t("KAFKA_RESOURCES")},{iconSrc:"/extensions-static/ks-console-embed/dist/v3dist/assets/radondb_zookeeper.svg",label:this.store.detail.nodes.zookeeper,desc:1===this.store.detail.nodes.zookeeper?t("ZOOKEEPER_NODE"):t("ZOOKEEPER_NODE_PL")},{iconName:"cpu",label:"".concat(parseFloat(p.cpu)>500?t("VALUE_CORES",{value:(0,b.cpuFormat)(p.cpu)}):p.cpu||""," ").concat(p.memory||""," | ").concat(this.store.detail.storages.zookeeper),desc:t("ZOOKEEPER_RESOURCES")}])}else{if(a===S.RadonDBAppId.ClickHouse)d.push({iconSrc:"/extensions-static/ks-console-embed/dist/v3dist/assets/pod.svg",label:o,desc:1===o?t("SHARD"):t("SHARD_PL")}),d.push({iconName:"database",label:i,desc:1===i?t("REPLICA"):t("REPLICA_PL")});else if(a===S.RadonDBAppId.RedisSentinel)d.push({iconSrc:"/extensions-static/ks-console-embed/dist/v3dist/assets/pod.svg",label:1,desc:t("PRIMARY_NODE_PL")}),d.push({iconName:"database",label:i,desc:1===i?t("STANDBY_NODE"):t("STANDBY_NODE_PL")});else if(a===S.RadonDBAppId.RedisCluster)d.push({iconSrc:"/extensions-static/ks-console-embed/dist/v3dist/assets/pod.svg",label:o,desc:t("PRIMARY_NODE_PL")}),d.push({iconName:"database",label:i,desc:1===i?t("STANDBY_NODE"):t("STANDBY_NODE_PL")});else{var h=a===S.RadonDBAppId.PostgreSQL?o+1:o;d.push({iconSrc:"/extensions-static/ks-console-embed/dist/v3dist/assets/pod.svg",label:h,desc:t("NODE_PL")}),d.push({iconName:"database",label:o>0?o-1:o,desc:o-1==1?t("REPLICA"):t("REPLICA_PL")})}d.push({iconName:"cpu",label:"".concat(parseFloat(c)>500?"".concat((0,b.cpuFormat)(c),"Core"):c||""," ").concat(s||""),desc:t("RESOURCES")}),d.push({iconName:"storage",label:l,desc:t("VOLUME")})}return m.default.createElement(g.default,{className:k.default.overview},m.default.createElement("div",null,m.default.createElement("div",{className:k.default.title},t("BASIC_INFORMATION")),m.default.createElement("div",{className:k.default.desc},t("DATABASE_RUNNING_FOR_VALUE",{value:u.toNow(!0)}))),m.default.createElement("div",{className:k.default.info},m.default.createElement("div",{className:k.default.card},m.default.createElement("div",null,r?m.default.createElement(y.default,{name:t("DATABASE_STATUS_".concat(r.replace(/[-\s]/g,"_").toUpperCase())),type:O.DMPStatus[r]||r,flicker:!0}):"-",m.default.createElement("div",{className:k.default.desc},t("STATUS")))),d.map((function(e){var t=e.iconSrc,a=e.iconName,r=e.label,n=e.desc;return m.default.createElement("div",{className:k.default.card,key:"".concat(r).concat(n)},t&&m.default.createElement(E.default,{src:t,iconSize:40}),a&&m.default.createElement(v.Icon,{name:a,size:40}),m.default.createElement("div",{className:k.default.detail},m.default.createElement("div",{className:k.default.label},r),m.default.createElement("div",{className:k.default.desc},n)))}))))}},{key:"render",value:function(){var e=this,t=this.store.detail,a=t.cluster,r=t.namespace,n=t.name,o=t.app_id,c=D.Provider,s=D.Consumer;return m.default.createElement(c,{value:{state:this.state,updateState:function(t){e.setState(A(A({},e.state),t))}}},m.default.createElement(h.Provider,{Consumer:s},this.renderPanel(),m.default.createElement(R.default,{cluster:a,chi:n,namespace:r,prefix:this.prefix,app_id:o,replicasCount:this.store.detail.replicasCount,showDelete:this.hasDeleteAction,deleteNode:this.deleteNode})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r)}}]),r}(m.default.Component),c.contextType=D,o=s))||o)||o;a.default=P},3967:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.DBNODE_STATUS=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(3968),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(7);var o=n(r(317)),c=n(r(31)),s=n(r(38));r(35);var l,i,u,d=n(r(39)),f=n(r(25)),p=n(r(28)),m=n(r(41)),h=n(r(42)),v=n(r(37)),_=n(r(0)),g=r(106),y=r(55),E=n(r(5)),b=r(243),S=r(17),O=n(r(859)),R=n(r(26)),k=n(r(1222)),C=n(r(1660)),A=r(815),T=n(r(801)),D=n(r(810)),P=r(806),N=n(r(331)),I=n(r(4003)),w=n(r(1671));function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var j=[{text:"RUNNING",value:"Running"},{text:"UPDATING",value:"Updating"},{text:"STOPPED",value:"Stopped"},{text:"PENDING",value:"Pending"}];a.DBNODE_STATUS=j;var U=(l=(0,b.inject)("Consumer"),i=(0,P.withProjectList)({store:new k.default,module:"applications",name:"NODE",rowKey:"name"}),l(u=(0,y.withRouter)(u=i(u=(0,b.observer)(u=function(e){(0,m.default)(r,e);var a=L(r);function r(e){var n;(0,f.default)(this,r),(n=a.call(this,e)).store=null,n.searchName="",n.state={currentMonitorDbNode:[],isShowMonitor:!1,nodeRole:""},n.fetchData=(0,O.default)((function(){var e=n.props,t=e.chi,a=e.namespace,r=e.getData,o=e.app_id;r({namespace:a,chi:t,app_id:o,esKibana:o===A.RadonDBAppId.Elasticsearch})}),2e3),n.deleteNode=function(e){return function(t){var a;t.stopPropagation(),t.preventDefault(),n.props.trigger("resource.delete",{detail:e,type:"NODE",success:(a=(0,d.default)(s.default.mark((function t(){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.props.deleteNode(e.deploymentName);case 2:n.searchName="",n.fetchData();case 4:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})})}},n.switchItemShowMonitor=function(e){return function(t){t.stopPropagation(),t.preventDefault(),n.setState(M(M({},n.state),{},{currentMonitorDbNode:e,nodeRole:(0,R.default)(e,"nodeRole","")}),(function(){n.switchShowMonitor(!0)}))}},n.getColumns=function(){var e=n.props,a=e.getSortOrder,r=e.app_id,o=e.showDelete;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:a("name"),render:function(e,t){return _.default.createElement("div",null," ",_.default.createElement(I.default,{key:"".concat(t.name,"-").concat(t.status),detail:t,app_id:r,switchShowMonitor:n.switchItemShowMonitor(t),deleteNode:n.deleteNode(t),showDelete:o}))}}]};var o=e.store;return n.store=o,n.websocket=new N.default,n.initWebsocket(),n}return(0,p.default)(r,[{key:"initWebsocket",value:function(){var e=this,t=this.props,a=t.chi,r=t.namespace,n=t.app_id,o=this.props.match.params.cluster,c=this.props.store.getWatchListUrl({namespace:r,chi:a,app_id:n,cluster:o});c&&r&&(this.websocket.watch(c),this.disposer=(0,S.reaction)((function(){return e.websocket.message}),(function(t){"Pod"===t.object.kind&&["MODIFIED","DELETED","ADDED"].includes(t.type)&&e.fetchData()})))}},{key:"componentDidMount",value:function(){this.fetchData(),localStorage.setItem("pod-detail-referrer",location.pathname)}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer(),this.store.clear()}},{key:"switchShowMonitor",value:function(e){this.setState(M(M({},this.state),{},{isShowMonitor:e}))}},{key:"getStatus",value:function(){return j.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"renderContent",value:function(){var e=this,t=this.props.Consumer;return _.default.createElement(_.default.Fragment,null,_.default.createElement(t,null,(function(t){var a=t.updateState;e.updateState=a})),this.state.isShowMonitor&&(0,g.createPortal)(_.default.createElement("div",{className:w.default.fullScreen},_.default.createElement(C.default,{monitorDbNode:this.state.currentMonitorDbNode,nodeRole:this.state.nodeRole,exitHandler:function(){e.switchShowMonitor(!1)}})),document.body))}},{key:"getTableProps",value:function(){var e=this,t=this.props,a=t.tableProps,r=t.store,n=function(t){t?Object.hasOwn(t,"name")?(void 0===t.name&&(t.name=""),e.searchName=t.name):t.name=e.searchName:e.searchName="";var a=e.props,n=a.chi,o=a.namespace,c=a.getData,s=a.app_id;r.list.isLoading=!0,c({namespace:o,chi:n,dataFilters:t,app_id:s,esKibana:s===A.RadonDBAppId.Elasticsearch})};return{tableActions:M(M({},a.tableActions),{},{onFetch:n,onRefresh:function(){n({limit:a.pagination.limit,page:a.pagination.page}),e.initWebsocket()},actions:[],onCreate:null}),selectActions:[],emptyProps:{desc:""},emptyText:r.list.isLoading?" ":null,searchType:"name"}}},{key:"render",value:function(){var e=this.props,a=e.className,r=e.tableProps,n=e.replicasCount;return _.default.createElement(T.default,{className:(0,E.default)(w.default.container,a),title:t("NODE_PL")},_.default.createElement(D.default,(0,o.default)({},r,{itemActions:[],columns:this.getColumns()},this.getTableProps(),{className:n>0?"split-".concat(n):""})),this.renderContent())}}]),r}(_.default.Component))||u)||u)||u)||u);a.default=U},3969:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(36),a(66),a(20),a(87),a(99),a(8),a(4),a(21),a(18),a(11),a(46),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(38));a(35);var o=r(a(39)),c=r(a(25)),s=r(a(28)),l=r(a(41)),i=r(a(42)),u=r(a(37)),d=r(a(45));a(250),a(32),a(3),a(36),a(66),a(20),a(87),a(141),a(29),a(120),a(99),a(8),a(4),a(21),a(18),a(43),a(11),a(46),a(40);var f,p=r(a(97)),m=r(a(50)),h=a(17),v=a(803);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=(f=function(e){(0,l.default)(i,e);var t,a,r=_(i);function i(){var e;(0,c.default)(this,i);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return(e=r.call.apply(r,[this].concat(a))).resourceName="node",e.getApi=function(){return"".concat(e.apiVersion,"/node_metrics")},e.config=[],e.fetchMetric=function(){var e=(0,o.default)(n.default.mark((function e(t){var a,r,o,c,s,l,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.expr,r=t.step,o=t.start,c=t.end,s=t.cluster,l=t.namespace,a){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,request.get("kapis/monitoring.kubesphere.io/v1beta1/targets/query",{cluster:s,namespace:l,expr:a,step:r,start:o,end:c},null,(function(e,t){throw new Error(t.message)}));case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:return i=e.t0,e.abrupt("return",i.data);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e}return(0,s.default)(i,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cluster,a=e.namespace,r="";return globals.app.isMultiCluster&&t&&(r+="/klusters/".concat(t)),a&&(r+="/namespaces/".concat(a)),r}},{key:"fetchMetrics",value:(a=(0,o.default)(n.default.mark((function e(t){var a,r,o,c,s,l,i,u,d,f,p;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.autoRefresh,r=void 0!==a&&a,o=t.more,c=void 0!==o&&o,s=t.fillZero,l=void 0===s||s,i=t.cluster,u=t.namespace,d=(0,m.default)(t,["autoRefresh","more","fillZero","cluster","namespace"]),r?(d.last=!0,this.isRefreshing=!0):this.isLoading=!0,d.cluster&&(this.cluster=d.cluster),f=this.getParams(d),this.config=f.config.reduce((function(e,t){return e.targets=e.targets.concat(t.targets),e}),{namespace:u,cluster:i,targets:[]}),e.t0=this,e.next=8,this.fetchMetricsAll(f);case 8:return e.t1=e.sent,p=e.t0.getResult.call(e.t0,e.t1),r&&(p=this.getRefreshResult(p,this.data)),c&&(p=this.getMoreResult(p,this.data)),this.data=l?(0,v.fillEmptyMetrics)(f,p):p,this.isLoading=!1,this.isRefreshing=!1,e.abrupt("return",p);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchMetricsAll",value:(t=(0,o.default)(n.default.mark((function e(t){var a,r,c,s,l,i,u,d,f,p,m=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.start,r=t.end,c=t.step,s=this.config,l=s.targets,i=void 0===l?[]:l,u=s.cluster,d=s.namespace,this.timeRange={start:a,end:r},f={ID:++this.requestID,errorMessage:"",metrics:[]},e.prev=4,e.next=7,Promise.all(i.map(function(){var e=(0,o.default)(n.default.mark((function e(t){var o,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.expr,e.next=3,m.fetchMetric({cluster:u,namespace:d,expr:o,step:c,start:a,end:r});case 3:return s=e.sent,e.abrupt("return",{data:s,target:t});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:p=e.sent,f.metrics=p.reduce((function(e,t){var a=t.data,r=void 0===a?[]:a,n=t.target,o=void 0===n?{}:n,c=o.expr,s=o.refId,l=(null==r?void 0:r.result).map((function(e){var t=e.values,a=void 0===t?[]:t,r=e.metric,n=void 0===r?{}:r,l=y(n)||c,i="".concat(s,".").concat(l);return{values:a,metric:n,target:o,id:i,responseMetricID:l}}));return e.concat(l)}),[]),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),f.errorMessage=e.t0.message;case 14:return e.prev=14,f.ID===this.requestID&&(this.metrics=f.metrics,this.errorMessage=f.errorMessage),e.finish(14);case 17:return e.abrupt("return",p);case 18:case"end":return e.stop()}}),e,this,[[4,11,14,17]])}))),function(e){return t.apply(this,arguments)})}]),i}(r(a(847)).default),(0,d.default)(f.prototype,"fetchMetrics",[h.action],Object.getOwnPropertyDescriptor(f.prototype,"fetchMetrics"),f.prototype),(0,d.default)(f.prototype,"fetchMetricsAll",[h.action],Object.getOwnPropertyDescriptor(f.prototype,"fetchMetricsAll"),f.prototype),f);function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.__name__,a=(0,m.default)(e,["__name__"]);if(!t)return JSON.stringify(a||{});var r=Object.entries(a||{}).map((function(e){var t=(0,p.default)(e,2),a=t[0],r=t[1];return"".concat(a,'="').concat(r,'"')})),n=r.length?"{".concat(r.join(","),"}"):"";return"".concat(t).concat(n)}t.default=g},3970:function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(442),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var o=n(r(31)),c=n(r(25)),s=n(r(28)),l=n(r(74)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=n(r(1)),m=n(r(5)),h=n(r(67)),v=n(r(64)),_=n(r(455)),g=r(803),y=r(189),E=n(r(823)),b=n(r(954)),S=n(r(3971));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var C=function(e){(0,i.default)(r,e);var a=k(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).initParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e||{},r=a.times,n=a.step,o=a.createTime,c={times:r,step:n};if(o){var s=new Date(o).valueOf()/1e3,l=Date.now()/1e3,i=l-s;switch(!0){case i<=1800:c.times=30,c.step="1m";break;case i<=3600:c.times=60,c.step="1m";break;case i<=18e3:c.times=60,c.step="5m"}}t.params=c},t.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=R(R({},t.params),e);t.props.onFetch(a)},t.handleChange=function(e){t.params=e;var a=!e.start&&!e.end&&t.props.enableAutoRefresh;t.setState({enableAutoRefresh:a,autoRefresh:!1},(function(){(0,g.stopAutoRefresh)((0,l.default)(t)),t.fetchData()}))},t.handleRefresh=function(){t.fetchData()},t.handleAutoRefresh=function(){t.setState({autoRefresh:!t.state.autoRefresh},(function(){t.state.autoRefresh?(0,g.startAutoRefresh)((0,l.default)(t)):(0,g.stopAutoRefresh)((0,l.default)(t))}))},t.handleToggle=function(e){t.setState({active:e})},t.state={active:!1,enableAutoRefresh:e.enableAutoRefresh,autoRefresh:!1},t.init(),t}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){e.step===this.props.step&&e.times===this.props.times&&e.createTime===this.props.createTime||(this.initParams(this.props),this.fetchData())}},{key:"componentWillUnmount",value:function(){(0,g.stopAutoRefresh)(this)}},{key:"init",value:function(){this.initParams(this.props),this.fetchData()}},{key:"renderAutoRefresh",value:function(){var e=this.state,t=e.enableAutoRefresh,a=e.autoRefresh;return t?f.default.createElement(y.Button,{className:S.default.button,type:"control",icon:a?"pause":"start",iconType:"light",onClick:this.handleAutoRefresh}):null}},{key:"renderCustomActions",value:function(){return this.props.customAction||null}},{key:"renderOperations",value:function(){var e=this.state.active,t=this.params,a=t.step,r=t.times,n=this.props.closeBtn;return f.default.createElement("div",{className:(0,m.default)(S.default.operations,(0,o.default)({},S.default.active,e))},this.props.customSelect||null,f.default.createElement(b.default,{step:a,times:r,onChange:this.handleChange,onToggle:this.handleToggle}),this.renderAutoRefresh(),f.default.createElement(y.Button,{className:S.default.button,type:"control",icon:"refresh",iconType:"light",onClick:this.handleRefresh}),this.renderCustomActions(),n)}},{key:"renderTitle",value:function(){var e=this.props.title||t("MONITORING");return f.default.createElement("div",{className:S.default.title},f.default.createElement("span",null,e),this.renderOperations())}},{key:"renderContent",value:function(){var e=this.props.children;return(0,h.default)(e)||(0,v.default)(e)&&(0,h.default)((0,_.default)(e).filter((function(e){return e})))?null:e}},{key:"render",value:function(){var e=this.props.loading,a=this.state.active;return f.default.createElement(y.Loading,{style:{zIndex:0},spinning:e},f.default.createElement(E.default,{className:(0,m.default)(S.default.card,(0,o.default)({},S.default.showDropDown,a)),title:this.renderTitle(),empty:e?" ":t("NO_MONITORING_DATA"),isEmpty:this.props.isEmpty},f.default.createElement("div",{className:S.default.content},this.renderContent())))}}]),r}(f.default.Component);a.default=C,C.propTypes={title:p.default.string,step:p.default.string,times:p.default.number,createTime:p.default.string,onFetch:p.default.func,loading:p.default.bool,refreshing:p.default.bool,isEmpty:p.default.bool,enableAutoRefresh:p.default.bool,customAction:p.default.oneOfType([p.default.node,p.default.element]),customSelect:p.default.oneOfType([p.default.node,p.default.element])},C.defaultProps={step:"10m",times:30,createTime:"",onFetch:function(){},loading:!1,refreshing:!1,isEmpty:!1,enableAutoRefresh:!0,customAction:""}},3971:function(e,t,a){e.exports={card:"_65_m-_4Ubjwu9QSuJvfzt",title:"_Xd78Z9vissC3z3MsYARn",operations:"hkQOkv4O5PZpDcwI2cWWl",button:"_1lWhAFrlevv8CiN813fzw8",content:"JUQudezMo9M8whf3hhuc5",showDropDown:"_1p7Rp4uYKW2hAUoSs2zLfw"}},3972:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(3973)),o=r(a(3974)),c=r(a(3975)),s=r(a(3976)),l=r(a(3977)),i=r(a(3978)),u=r(a(3979)),d=r(a(3980)),f=r(a(3981)),p=r(a(3982)),m={mysql:n.default,ck:o.default,pg:c.default,redis:s.default,mongo:i.default,eck:u.default,predixy:l.default,kafka:d.default,zookeeper:f.default,opensearch:p.default};t.default=m},3973:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(14);var o=n(r(26));var c={getConfig:function(e,t){var a=e.detail,r=a.name,n=a.namespace,o=t.name;return[{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**Max Connections** \n\nMax Connections is the maximum permitted number of simultaneous client connections. By default, this is 151. Increasing this value increases the number of file descriptors that mysqld requires. If the required number of descriptors are not available, the server reduces the value of Max Connections.\n\nmysqld actually permits Max Connections + 1 clients to connect. The extra connection is reserved for use by accounts that have the SUPER privilege, such as root.\n\nMax Used Connections is the maximum number of connections that have been in use simultaneously since the server started.\n\nConnections is the number of connection attempts (successful or not) to the MySQL server.",id:92,lines:!0,targets:[{expr:"mysql_global_status_threads_connected{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Connections",refId:1,step:"1m"},{expr:"mysql_global_status_max_used_connections{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Max Used Connections",refId:2,step:"1m"},{expr:"mysql_global_variables_max_connections{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Max Connections",refId:3,step:"1m"}],title:"MYSQL_CONNECTIONS",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Active Threads**\n\nThreads Connected is the number of open connections, while Threads Running is the number of threads not sleeping.",id:10,lines:!0,targets:[{expr:"max_over_time(mysql_global_status_threads_connected{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[3m])",legendFormat:"Peak Threads Connected",refId:1,step:"1m"},{expr:"max_over_time(mysql_global_status_threads_running{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[3m])",legendFormat:"Peak Threads Running",refId:2,step:"1m"},{expr:"avg_over_time(mysql_global_status_threads_running{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[3m])",legendFormat:"Avg Threads Running",refId:3,step:"1m"}],title:"MYSQL_CLIENT_THREAD_ACTIVITY",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Questions**\n\nThe number of statements executed by the server. This includes only statements sent to the server by clients and not statements executed within stored programs, unlike the Queries used in the QPS calculation. \n\nThis variable does not count the following commands:\n* ``COM_PING``\n* ``COM_STATISTICS``\n* ``COM_STMT_PREPARE``\n* ``COM_STMT_CLOSE``\n* ``COM_STMT_RESET``",id:53,lines:!0,targets:[{expr:"rate(mysql_global_status_questions{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Questions",refId:1,step:"1m"}],title:"MYSQL_QUESTIONS",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Thread Cache**\n\nThe thread_cache_size variable sets how many threads the server should cache to reuse. When a client disconnects, the client's threads are put in the cache if the cache is not full. It is autosized in MySQL 5.6.8 and above (capped to 100). Requests for threads are satisfied by reusing threads taken from the cache if possible, and only when the cache is empty is a new thread created.\n\n* *Threads_created*: The number of threads created to handle connections.\n* *Threads_cached*: The number of threads in the thread cache.",id:11,lines:!0,targets:[{expr:"mysql_global_variables_thread_cache_size{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Thread Cache Size",refId:1,step:"1m"},{expr:"mysql_global_status_threads_cached{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Threads Cached",refId:2,step:"1m"},{expr:"rate(mysql_global_status_threads_created{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Threads Created",refId:3,step:"1m"}],title:"MYSQL_THREAD_CACHE",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],id:22,lines:!0,targets:[{expr:"rate(mysql_global_status_created_tmp_tables{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"CREATED_TEMP_TABLES",refId:1,step:"1m"},{expr:"rate(mysql_global_status_created_tmp_disk_tables{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Created Tmp Disk Tables",refId:2,step:"1m"},{expr:"rate(mysql_global_status_created_tmp_files{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Created Tmp Files",refId:3,step:"1m"}],title:"MySQL Temporary Objects",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Select Types**\n\nAs with most relational databases, selecting based on indexes is more efficient than scanning an entire table's data. Here we see the counters for selects not done with indexes.\n\n* ***Select Scan*** is how many queries caused full table scans, in which all the data in the table had to be read and either discarded or returned.\n* ***Select Range*** is how many queries used a range scan, which means MySQL scanned all rows in a given range.\n* ***Select Full Join*** is the number of joins that are not joined on an index, this is usually a huge performance hit.",id:311,lines:!0,targets:[{expr:"rate(mysql_global_status_select_full_join{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Select Full Join",refId:1,step:"1m"},{expr:"rate(mysql_global_status_select_full_range_join{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Select Full Range Join",refId:2,step:"1m"},{expr:"rate(mysql_global_status_select_range{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Select Range",refId:3,step:"1m"},{expr:"rate(mysql_global_status_select_range_check{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Select Range Check",refId:4,step:"1m"},{expr:"rate(mysql_global_status_select_scan{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Select Scan",refId:5,step:"1m"}],title:"MySQL Select Types",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Sorts**\n\nDue to a query's structure, order, or other requirements, MySQL sorts the rows before returning them. For example, if a table is ordered 1 to 10 but you want the results reversed, MySQL then has to sort the rows to return 10 to 1.\n\nThis graph also shows when sorts had to scan a whole table or a given range of a table in order to return the results and which could not have been sorted via an index.",id:30,lines:!0,targets:[{expr:"rate(mysql_global_status_sort_rows{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Sort Rows",refId:1,step:"1m"},{expr:"rate(mysql_global_status_sort_range{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Sort Range",refId:2,step:"1m"},{expr:"rate(mysql_global_status_sort_merge_passes{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Sort Merge Passes",refId:3,step:"1m"},{expr:"rate(mysql_global_status_sort_scan{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Sort Scan",refId:4,step:"1m"}],title:"MySQL Sorts",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Slow Queries**\n\nSlow queries are defined as queries being slower than the long_query_time setting. For example, if you have long_query_time set to 3, all queries that take longer than 3 seconds to complete will show on this graph.",id:48,lines:!0,targets:[{expr:"rate(mysql_global_status_slow_queries{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Slow Queries",refId:1,step:"1m"}],title:"MySQL Slow Queries",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**Aborted Connections**\n\nWhen a given host connects to MySQL and the connection is interrupted in the middle (for example due to bad credentials), MySQL keeps that info in a system table (since 5.6 this table is exposed in performance_schema).\n\nIf the amount of failed requests without a successful connection reaches the value of max_connect_errors, mysqld assumes that something is wrong and blocks the host from further connection.\n\nTo allow connections from that host again, you need to issue the ``FLUSH HOSTS`` statement.",id:47,lines:!0,targets:[{expr:"rate(mysql_global_status_aborted_connects{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Aborted Connects (attempts)",refId:1,step:"1m"},{expr:"rate(mysql_global_status_aborted_clients{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Aborted Clients (timeout)",refId:2,step:"1m"}],title:"MySQL Aborted Connections",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**Table Locks**\n\nMySQL takes a number of different locks for varying reasons. In this graph we see how many Table level locks MySQL has requested from the storage engine. In the case of InnoDB, many times the locks could actually be row locks as it only takes table level locks in a few specific cases.\n\nIt is most useful to compare Locks Immediate and Locks Waited. If Locks waited is rising, it means you have lock contention. Otherwise, Locks Immediate rising and falling is normal activity.",id:32,lines:!0,targets:[{expr:"rate(mysql_global_status_table_locks_immediate{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Table Locks Immediate",refId:1,step:"1m"},{expr:"rate(mysql_global_status_table_locks_waited{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Table Locks Waited",refId:2,step:"1m"}],title:"MySQL Table Locks",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Network Traffic**\n\nHere we can see how much network traffic is generated by MySQL. Outbound is network traffic sent from MySQL and Inbound is network traffic MySQL has received.",id:9,lines:!0,stack:!0,targets:[{expr:"rate(mysql_global_status_bytes_received{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Inbound",refId:1,step:"1m"},{expr:"rate(mysql_global_status_bytes_sent{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Outbound",refId:2,step:"1m"}],title:"MySQL Network Traffic",type:"graph",yaxes:[{format:"Byte"}]},{bars:!0,colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Network Usage Hourly**\n\nHere we can see how much network traffic is generated by MySQL per hour. You can use the bar graph to compare data sent by MySQL and data received by MySQL.",id:381,stack:!0,targets:[{expr:"increase(mysql_global_status_bytes_received{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[1h])",legendFormat:"Received",refId:1,step:"1m"},{expr:"increase(mysql_global_status_bytes_sent{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[1h])",legendFormat:"Sent",refId:2,step:"1m"}],title:"MySQL Network Usage Hourly",type:"graph",yaxes:[{format:"Byte"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"***System Memory***: Total Memory for the system.\\\n***InnoDB Buffer Pool Data***: InnoDB maintains a storage area called the buffer pool for caching data and indexes in memory.\\\n***TokuDB Cache Size***: Similar in function to the InnoDB Buffer Pool,  TokuDB will allocate 50% of the installed RAM for its own cache.\\\n***Key Buffer Size***: Index blocks for MYISAM tables are buffered and are shared by all threads. key_buffer_size is the size of the buffer used for index blocks.\\\n***Adaptive Hash Index Size***: When InnoDB notices that some index values are being accessed very frequently, it builds a hash index for them in memory on top of B-Tree indexes.\\\n ***Query Cache Size***: The query cache stores the text of a SELECT statement together with the corresponding result that was sent to the client. The query cache has huge scalability problems in that only one thread can do an operation in the query cache at the same time.\\\n***InnoDB Dictionary Size***: The data dictionary is InnoDB s internal catalog of tables. InnoDB stores the data dictionary on disk, and loads entries into memory while the server is running.\\\n***InnoDB Log Buffer Size***: The MySQL InnoDB log buffer allows transactions to run without having to write the log to disk before the transactions commit.",id:50,lines:!0,stack:!0,targets:[{expr:"node_memory_MemTotal_bytes{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"System Memory",refId:1,step:"1m"},{expr:"mysql_global_status_innodb_page_size{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"InnoDB Buffer Pool Data",refId:2,step:"1m"},{expr:"mysql_global_variables_innodb_log_buffer_size{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"InnoDB Log Buffer Size",refId:3,step:"1m"},{expr:"mysql_global_variables_innodb_additional_mem_pool_size{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"InnoDB Additional Memory Pool Size",refId:4,step:"1m"},{expr:"mysql_global_status_innodb_mem_dictionary{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"InnoDB Dictionary Size",refId:5,step:"1m"},{expr:"mysql_global_variables_key_buffer_size{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Key Buffer Size",refId:6,step:"1m"},{expr:"mysql_global_variables_query_cache_size{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Query Cache Size",refId:7,step:"1m"},{expr:"mysql_global_status_innodb_mem_adaptive_hash{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Adaptive Hash Index Size",refId:8,step:"1m"},{expr:"mysql_global_variables_tokudb_cache_size{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"TokuDB Cache Size",refId:9,step:"1m"}],title:"MySQL Internal Memory Overview",type:"graph",yaxes:[{format:"Byte"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**Top Command Counters**\n\nThe Com_{{xxx}} statement counter variables indicate the number of times each xxx statement has been executed. There is one status variable for each type of statement. For example, Com_delete and Com_update count [``DELETE``](https://dev.mysql.com/doc/refman/5.7/en/delete.html) and [``UPDATE``](https://dev.mysql.com/doc/refman/5.7/en/update.html) statements, respectively. Com_delete_multi and Com_update_multi are similar but apply to [``DELETE``](https://dev.mysql.com/doc/refman/5.7/en/delete.html) and [``UPDATE``](https://dev.mysql.com/doc/refman/5.7/en/update.html) statements that use multiple-table syntax.",id:14,lines:!0,targets:[{expr:"topk(5, rate(mysql_global_status_commands_total{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m]))",legendFormat:"Com_{{command}}",refId:1,step:"1m"}],title:"Top Command Counters",type:"graph",yaxes:[{format:"none"}]},{bars:!0,colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**Top Command Counters Hourly**\n\nThe Com_{{xxx}} statement counter variables indicate the number of times each xxx statement has been executed. There is one status variable for each type of statement. For example, Com_delete and Com_update count [``DELETE``](https://dev.mysql.com/doc/refman/5.7/en/delete.html) and [``UPDATE``](https://dev.mysql.com/doc/refman/5.7/en/update.html) statements, respectively. Com_delete_multi and Com_update_multi are similar but apply to [``DELETE``](https://dev.mysql.com/doc/refman/5.7/en/delete.html) and [``UPDATE``](https://dev.mysql.com/doc/refman/5.7/en/update.html) statements that use multiple-table syntax.",id:39,stack:!0,targets:[{expr:"topk(5, increase(mysql_global_status_commands_total{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[1h]))",legendFormat:"Com_{{command}}",refId:1,step:"1m"}],title:"Top Command Counters Hourly",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Handlers**\n\nHandler statistics are internal statistics on how MySQL is selecting, updating, inserting, and modifying rows, tables, and indexes.\n\nThis is in fact the layer between the Storage Engine and MySQL.\n\n* `read_rnd_next` is incremented when the server performs a full table scan and this is a counter you don't really want to see with a high value.\n* `read_key` is incremented when a read is done with an index.\n* `read_next` is incremented when the storage engine is asked to 'read the next index entry'. A high value means a lot of index scans are being done.",id:8,lines:!0,targets:[{expr:"rate(mysql_global_status_handlers_total{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"{{handler}}",refId:1,step:"1m"}],title:"MySQL Handlers",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],id:28,lines:!0,targets:[{expr:"rate(mysql_global_status_handlers_total{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"{{handler}}",refId:1,step:"1m"}],title:"MySQL Transaction Handlers",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Query Cache Memory**\n\nThe query cache has huge scalability problems in that only one thread can do an operation in the query cache at the same time. This serialization is true not only for SELECTs, but also for INSERT/UPDATE/DELETE.\n\nThis also means that the larger the `query_cache_size` is set to, the slower those operations become. In concurrent environments, the MySQL Query Cache quickly becomes a contention point, decreasing performance. MariaDB and AWS Aurora have done work to try and eliminate the query cache contention in their flavors of MySQL, while MySQL 8.0 has eliminated the query cache feature.\n\nThe recommended settings for most environments is to set:\n  ``query_cache_type=0``\n  ``query_cache_size=0``\n\nNote that while you can dynamically change these values, to completely remove the contention point you have to restart the database.",id:46,lines:!0,targets:[{expr:"mysql_global_status_qcache_free_memory{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Free Memory",refId:1,step:"1m"},{expr:"mysql_global_variables_query_cache_size{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Query Cache Size",refId:2,step:"1m"}],title:"MySQL Query Cache Memory",type:"graph",yaxes:[{format:"Byte"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Query Cache Activity**\n\nThe query cache has huge scalability problems in that only one thread can do an operation in the query cache at the same time. This serialization is true not only for SELECTs, but also for INSERT/UPDATE/DELETE.\n\nThis also means that the larger the `query_cache_size` is set to, the slower those operations become. In concurrent environments, the MySQL Query Cache quickly becomes a contention point, decreasing performance. MariaDB and AWS Aurora have done work to try and eliminate the query cache contention in their flavors of MySQL, while MySQL 8.0 has eliminated the query cache feature.\n\nThe recommended settings for most environments is to set:\n``query_cache_type=0``\n``query_cache_size=0``\n\nNote that while you can dynamically change these values, to completely remove the contention point you have to restart the database.",id:45,lines:!0,targets:[{expr:"rate(mysql_global_status_qcache_hits{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Hits",refId:1,step:"1m"},{expr:"rate(mysql_global_status_qcache_inserts{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Inserts",refId:2,step:"1m"},{expr:"rate(mysql_global_status_qcache_not_cached{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Not Cached",refId:3,step:"1m"},{expr:"rate(mysql_global_status_qcache_lowmem_prunes{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Prunes",refId:4,step:"1m"},{expr:"mysql_global_status_qcache_queries_in_cache{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Queries in Cache",refId:5,step:"1m"}],title:"MySQL Query Cache Activity",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],id:43,lines:!0,targets:[{expr:"rate(mysql_global_status_opened_files{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Openings",refId:1,step:"1m"}],title:"MySQL File Openings",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],id:41,lines:!0,targets:[{expr:"mysql_global_status_open_files{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Open Files",refId:1,step:"1m"},{expr:"mysql_global_variables_open_files_limit{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Open Files Limit",refId:2,step:"1m"},{expr:"mysql_global_status_innodb_num_open_files{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"InnoDB Open Files",refId:3,step:"1m"}],title:"MySQL Open Files",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Table Open Cache Status**\n\nThe recommendation is to set the `table_open_cache_instances` to a loose correlation to virtual CPUs, keeping in mind that more instances means the cache is split more times. If you have a cache set to 500 but it has 10 instances, each cache will only have 50 cached.\n\nThe `table_definition_cache` and `table_open_cache` can be left as default as they are auto-sized MySQL 5.6 and above (ie: do not set them to any value).",id:44,lines:!0,targets:[{expr:"rate(mysql_global_status_opened_tables{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Openings",refId:1,step:"1m"},{expr:"rate(mysql_global_status_table_open_cache_hits{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Hits",refId:2,step:"1m"},{expr:"rate(mysql_global_status_table_open_cache_misses{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Misses",refId:3,step:"1m"},{expr:"rate(mysql_global_status_table_open_cache_overflows{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Misses due to Overflows",refId:4,step:"1m"},{expr:"(rate(mysql_global_status_table_open_cache_hits{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m]))",legendFormat:"Table Open Cache Hit Ratio",refId:5,step:"1m"}],title:"MySQL Table Open Cache Status",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Open Tables**\n\nThe recommendation is to set the `table_open_cache_instances` to a loose correlation to virtual CPUs, keeping in mind that more instances means the cache is split more times. If you have a cache set to 500 but it has 10 instances, each cache will only have 50 cached.\n\nThe `table_definition_cache` and `table_open_cache` can be left as default as they are auto-sized MySQL 5.6 and above (ie: do not set them to any value).",id:42,lines:!0,targets:[{expr:"mysql_global_status_open_tables{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Open Tables",refId:1,step:"1m"},{expr:"mysql_global_variables_table_open_cache{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Table Open Cache",refId:2,step:"1m"}],title:"MySQL Open Tables",type:"graph",yaxes:[{format:"none"}]},{colors:["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],description:"**MySQL Table Definition Cache**\n\nThe recommendation is to set the `table_open_cache_instances` to a loose correlation to virtual CPUs, keeping in mind that more instances means the cache is split more times. If you have a cache set to 500 but it has 10 instances, each cache will only have 50 cached.\n\nThe `table_definition_cache` and `table_open_cache` can be left as default as they are auto-sized MySQL 5.6 and above (ie: do not set them to any value).",id:54,lines:!0,targets:[{expr:"mysql_global_status_open_table_definitions{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Open Table Definitions",refId:1,step:"1m"},{expr:"mysql_global_variables_table_definition_cache{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}",legendFormat:"Table Definitions Cache Size",refId:2,step:"1m"},{expr:"rate(mysql_global_status_opened_table_definitions{"+'service="'.concat(r,'-metrics",namespace="').concat(n,'",pod="').concat(o,'"')+"}[5m])",legendFormat:"Opened Table Definitions",refId:3,step:"1m"}],title:"MySQL Table Definition Cache",type:"graph",yaxes:[{format:"none"}]}]},getMonitoringCfgs:function(e){return[{type:"utilisation",title:t("MAX_USED_CONNECTIONS"),legend:[t("MAX_USED_CONNECTIONS")],data:[(0,o.default)(e,"[2].data.result[0]",{})]},{type:"utilisation",title:"THREADS",legend:[t("PEAK_THREADS_CONNECTED"),t("PEAK_THREADS_RUNNING"),t("AVG_THREADS_RUNNING")],data:[(0,o.default)(e,"[4].data.result[0]",{}),(0,o.default)(e,"[5].data.result[0]",{}),(0,o.default)(e,"[6].data.result[0]",{})]},{type:"utilisation",title:t("ABORTED_CONNECTIONS"),legend:[t("ABORTED_CONNECTION_ATTEMPTS"),t("ABORTED_CLIENT_TIMEOUTS")],data:[(0,o.default)(e,"[24].data.result[0]",{}),(0,o.default)(e,"[25].data.result[0]",{})]},{type:"utilisation",title:t("QUESTIONS"),legend:[t("QUESTIONS")],data:[(0,o.default)(e,"[7].data.result[0]",{})]},{type:"utilisation",title:t("SELECT_BY_TYPE"),legend:[t("SELECT_FULL_JOIN"),t("SELECT_FULL_RANGE_JOIN"),t("SELECT_RANGE"),t("SELECT_RANGE_CHECK"),t("SELECT_SCAN")],data:[(0,o.default)(e,"[14].data.result[0]",{}),(0,o.default)(e,"[15].data.result[0]",{}),(0,o.default)(e,"[16].data.result[0]",{}),(0,o.default)(e,"[17].data.result[0]",{}),(0,o.default)(e,"[18].data.result[0]",{})]},{type:"utilisation",title:t("SORT_BY_TYPE"),legend:[t("SORT_ROWS"),t("SORT_RANGE"),t("SORT_MERGE_PASSES"),t("SORT_SCAN")],data:[(0,o.default)(e,"[19].data.result[0]",{}),(0,o.default)(e,"[20].data.result[0]",{}),(0,o.default)(e,"[21].data.result[0]",{}),(0,o.default)(e,"[22].data.result[0]",{})]},{type:"utilisation",title:t("SLOW_QUERIES"),legend:[t("SLOW_QUERIES")],data:[(0,o.default)(e,"[23].data.result[0]",{})]},{type:"utilisation",title:t("TABLE_LOCKS"),legend:[t("TABLE_LOCKS_IMMEDIATE"),t("TABLE_LOCKS_WAITED")],data:[(0,o.default)(e,"[26].data.result[0]",{}),(0,o.default)(e,"[27].data.result[0]",{})]},{type:"utilisation",title:t("TMP_TABLES_AND_FILES"),legend:[t("CREATED_TMP_TABLES"),t("CREATED_TMP_DISK_TABLES"),t("CREATED_TMP_FILES")],data:[(0,o.default)(e,"[11].data.result[0]",{}),(0,o.default)(e,"[12].data.result[0]",{}),(0,o.default)(e,"[13].data.result[0]",{})]},{type:"utilisation",title:t("MYSQL_NETWORK_TRAFFIC"),legend:[t("MYSQL_INBOUND"),t("MYSQL_OUTBOUND")],data:[(0,o.default)(e,"[28].data.result[0]",{}),(0,o.default)(e,"[29].data.result[0]",{})]}]}};a.default=c},3974:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(20),r(14);var o=n(r(26));var c={getConfig:function(e,t){var a=e.detail.namespace,r=t.name;return[{targets:[{expr:'sum by(hostname) (chi_clickhouse_metric_TCPConnection{namespace="'.concat(a,'",pod="').concat(r,'"})')},{expr:'sum by(hostname) (chi_clickhouse_metric_HTTPConnection{namespace="'.concat(a,'",pod="').concat(r,'"})')}]},{targets:[{expr:'chi_clickhouse_metric_DiskDataBytes{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_SelectQuery{namespace="'.concat(a,'",pod="').concat(r,'"}[2m]))')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_Query{namespace="'.concat(a,'",pod="').concat(r,'"}[2m]))')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_InsertedBytes{namespace="'.concat(a,'",pod="').concat(r,'"}[2m]))')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_InsertedRows{namespace="'.concat(a,'",pod="').concat(r,'"}[2m]))')}]},{targets:[{expr:'chi_clickhouse_metric_ReplicasMaxAbsoluteDelay{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'chi_clickhouse_metric_ReplicasMaxRelativeDelay{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'chi_clickhouse_metric_TotalPartsOfMergeTreeTables{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'chi_clickhouse_metric_DelayedInserts{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'increase(chi_clickhouse_event_DelayedInserts{namespace="'.concat(a,'",pod="').concat(r,'"}[1m])')},{expr:'increase(chi_clickhouse_event_RejectedInserts{namespace="'.concat(a,'",pod="').concat(r,'"}[1m])')},{expr:'chi_clickhouse_metric_DistributedFilesToInsert{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_CompressedReadBufferBytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_ReadCompressedBytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_ReadBufferFromFileDescriptorReadBytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_OSReadBytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')}]},{targets:[{expr:'chi_clickhouse_metric_MemoryTracking{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_ReplicatedDataLoss{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_ReplicatedPartChecks{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_ReplicatedPartChecksFailed{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_ReplicatedPartFetches{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_ReplicatedPartFailedFetches{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_ReplicatedPartFetchesOfMerged{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_ReplicatedPartMerges{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')},{expr:'chi_clickhouse_metric_ReplicasMaxQueueSize{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_Merge{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_MergedRows{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_MergedUncompressedBytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]))')}]},{targets:[{expr:'sum by(pod) (chi_clickhouse_table_parts{namespace="'.concat(a,'",pod="').concat(r,'",active="1"})')}]},{targets:[{expr:'sum by(pod) (chi_clickhouse_table_parts{namespace="'.concat(a,'",pod="').concat(r,'",active="0"})')}]},{targets:[{expr:'chi_clickhouse_metric_MaxPartCountForPartition{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'chi_clickhouse_metric_MemoryCode{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'chi_clickhouse_metric_MemoryResident{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'chi_clickhouse_metric_MemoryShared{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'chi_clickhouse_metric_MemoryPrimaryKeyBytesAllocated{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'chi_clickhouse_metric_MemoryDictionaryBytesAllocated{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'irate(chi_clickhouse_event_MarkCacheHits{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) / (irate(chi_clickhouse_event_MarkCacheHits{namespace="').concat(a,'",pod="').concat(r,'"}[1m]))')}]},{targets:[{expr:'chi_clickhouse_metric_BackgroundPoolTask{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'chi_clickhouse_metric_BackgroundSchedulePoolTask{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'chi_clickhouse_metric_BackgroundMovePoolTask{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'sum by (pod) (chi_clickhouse_table_mutations{namespace="'.concat(a,'",pod="').concat(r,'"})')},{expr:'sum by (pod) (chi_clickhouse_table_mutations_parts_to_do{namespace="'.concat(a,'",pod="').concat(r,'"})')}]},{targets:[{expr:'sum by(pod) (irate(chi_clickhouse_event_DiskReadElapsedMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_DiskWriteElapsedMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_NetworkReceiveElapsedMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_NetworkSendElapsedMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_RealTimeMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_UserTimeMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_SystemTimeMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_OSIOWaitMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_OSCPUWaitMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')},{expr:'sum by(pod) (irate(chi_clickhouse_event_OSCPUVirtualTimeMicroseconds{namespace="'.concat(a,'",pod=~"').concat(r,'"}[1m]))')}]}]},getMonitoringCfgs:function(e){return[{title:t("CONNECTIONS"),legend:["TCP","HTTP"],data:[(0,o.default)(e,"1.data.result[0]",{}),(0,o.default)(e,"2.data.result[0]",{})]},{title:t("CLICKHOUSE_DATA_SIZE_ON_DISK"),unit:"MB",legend:[t("CLICKHOUSE_DATA_SIZE_ON_DISK")],data:[(0,o.default)(e,"3.data.result[0]",{})]},{title:t("QUERIES"),legend:[t("SELECT_QUERIES"),t("ALL_QUERIES")],data:[(0,o.default)(e,"4.data.result[0]",{}),(0,o.default)(e,"5.data.result[0]",{})]},{title:t("INSERTED_BYTES"),unit:"KiB",legend:(0,o.default)(e,"6.data.result",[]).map((function(){return t("INSERTED_BYTES")})),data:(0,o.default)(e,"6.data.result",[])},{title:t("INSERTED_ROWS"),legend:(0,o.default)(e,"7.data.result",[]).map((function(){return t("INSERTED_ROWS")})),data:(0,o.default)(e,"7.data.result",[])},{title:t("MAXIMUM_REPLICATION_DEPLAY"),legend:[t("RELATIVE_DELAY"),t("ABSOLUTE_DELAY")],unit:"s",data:[(0,o.default)(e,"8.data.result[0]",{}),(0,o.default)(e,"9.data.result[0]",{})]},{title:t("TOTAL_PARTS_OF_MERGETREE_TABLES"),legend:[t("TOTAL_PARTS_OF_MERGETREE_TABLES")],data:[(0,o.default)(e,"10.data.result[0]",{})]},{title:t("DELAYED_REJECTED_INSERTS"),legend:[t("DELAYED_QUERIES"),t("DELAYED_BLOCKS"),t("REJECTED_BLOCKS"),t("DELAYED_DISTRIBUTED_FILES")],data:[(0,o.default)(e,"11.data.result[0]",{}),(0,o.default)(e,"12.data.result[0]",{}),(0,o.default)(e,"13.data.result[0]",{}),(0,o.default)(e,"14.data.result[0]",{})]},{title:t("READ_BYTES"),legend:[t("UNCOMPRESSED"),t("COMPRESSED"),t("FILE_DESCRIPTOR"),t("CLICKHOUSE_OS")],unitType:"memory",data:[(0,o.default)(e,"15.data.result[0]",{}),(0,o.default)(e,"16.data.result[0]",{}),(0,o.default)(e,"17.data.result[0]",{}),(0,o.default)(e,"18.data.result[0]",{})]},{title:t("MEMORY_FOR_QUERIES"),legend:[t("MEMORY_FOR_QUERIES")],unitType:"memory",data:[(0,o.default)(e,"19.data.result[0]",{})]},{title:t("REPLICATION_QUEUE_JOBS"),legend:[t("DATA_LOSS"),t("CHECK"),t("CHECK_FAIL"),t("FETCH"),t("FETCH_FAIL"),t("FETCH_MERGED"),t("REPLICATED_MERGED"),t("MAX_QUEUE_SIZE")],unitType:"memory",data:[(0,o.default)(e,"20.data.result[0]",{}),(0,o.default)(e,"21.data.result[0]",{}),(0,o.default)(e,"22.data.result[0]",{}),(0,o.default)(e,"23.data.result[0]",{}),(0,o.default)(e,"24.data.result[0]",{}),(0,o.default)(e,"25.data.result[0]",{}),(0,o.default)(e,"26.data.result[0]",{}),(0,o.default)(e,"27.data.result[0]",{})]},{title:t("MERGES"),legend:[t("MERGES")],data:[(0,o.default)(e,"28.data.result[0]",{})]},{title:t("MERGED_ROWS"),legend:[t("MERGED_ROWS")],data:[(0,o.default)(e,"29.data.result[0]",{})]},{title:t("MERGED_UNCOMPRESSED_BYTES"),legend:[t("MERGED_UNCOMPRESSED_BYTES")],unitType:"disk",data:[(0,o.default)(e,"30.data.result[0]",{})]},{title:t("ACTIVE_PARTS"),legend:[t("ACTIVE_PARTS")],data:[(0,o.default)(e,"31.data.result[0]",{})]},{title:t("DETACHED_PARTS"),legend:[t("DETACHED_PARTS")],data:[(0,o.default)(e,"32.data.result[0]",{})]},{title:t("MAX_PART_COUNT_FOR_PARTITION"),legend:[t("MAX_PART_COUNT_FOR_PARTITION")],data:[(0,o.default)(e,"33.data.result[0]",{})]},{title:t("CLICKHOUSE_SERVER_PROCESS_MEMORY"),legend:["CODE","RES","SHR"],unitType:"memory",data:[(0,o.default)(e,"34.data.result[0]",{}),(0,o.default)(e,"35.data.result[0]",{}),(0,o.default)(e,"36.data.result[0]",{})]},{title:t("PRIMARY_KEYS_MEMORY"),legend:[t("PRIMARY_KEYS_MEMORY")],unitType:"memory",data:[(0,o.default)(e,"37.data.result[0]",{})]},{title:t("DICTIONARY_MEMORY"),legend:[t("DICTIONARY_MEMORY")],unitType:"memory",data:[(0,o.default)(e,"38.data.result[0]",{})]},{title:t("BACKGROUND_TASKS"),legend:[t("MERGE_MUTATE_FETCH"),t("CLEAN_ALTER_REPLICA_REINIT"),t("MOVES")],unitType:"memory",data:[(0,o.default)(e,"40.data.result[0]",{}),(0,o.default)(e,"41.data.result[0]",{}),(0,o.default)(e,"42.data.result[0]",{})]},{title:t("CPU_TIME_PER_SECOND"),legend:[t("DISK_READ_SYSCALL"),t("DISK_WRITE_SYSCALL"),t("NETWORK_RECEIVE"),t("NETWORK_SEND"),t("REAL_TIME"),t("USER_TIME"),t("SYSTEM_TIME"),t("OS_IO_WAIT"),t("OS_CPU_WAIT"),t("OS_CPU_VIRTUAL")],unit:"s",data:[(0,o.default)(e,"45.data.result[0]",{}),(0,o.default)(e,"46.data.result[0]",{}),(0,o.default)(e,"47.data.result[0]",{}),(0,o.default)(e,"48.data.result[0]",{}),(0,o.default)(e,"49.data.result[0]",{}),(0,o.default)(e,"50.data.result[0]",{}),(0,o.default)(e,"51.data.result[0]",{}),(0,o.default)(e,"52.data.result[0]",{}),(0,o.default)(e,"53.data.result[0]",{}),(0,o.default)(e,"54.data.result[0]",{})]}]}};a.default=c},3975:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(58));r(3),r(20),r(14);var c=n(r(26));function s(e,t){var a=e.detail.namespace,r=t.name;return[{targets:[{expr:'sum(pg_stat_activity_count{namespace="'.concat(a,'",pod="').concat(r,'",state="active"})')},{expr:'sum(pg_stat_activity_count{namespace="'.concat(a,'",pod="').concat(r,'",state="idle in transaction"})')},{expr:'sum(pg_stat_activity_count{namespace="'.concat(a,'",pod="').concat(r,'",state="idle"})')}]},{targets:[{expr:'(sum(pg_stat_database_numbackends{namespace="'.concat(a,'",pod="').concat(r,'"}) / sum(pg_settings_max_connections{namespace="').concat(a,'",pod="').concat(r,'"}))')}]},{targets:[{expr:'round(sum(pg_stat_database_blks_hit{namespace="'.concat(a,'",pod="').concat(r,'"}) / (sum(pg_stat_database_blks_hit{namespace="').concat(a,'",pod="').concat(r,'"}) + sum(pg_stat_database_blks_read{namespace="').concat(a,'",pod="').concat(r,'"})),0.001)')}]},{targets:[{expr:'pg_stat_database_blks_hit{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""} / (pg_stat_database_blks_read{namespace="').concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""} + pg_stat_database_blks_hit{namespace="').concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""})')}]},{targets:[{expr:'irate(pg_stat_database_tup_fetched{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')},{expr:'irate(pg_stat_database_tup_inserted{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')},{expr:'irate(pg_stat_database_tup_updated{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')},{expr:'irate(pg_stat_database_tup_deleted{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')},{expr:'irate(pg_stat_database_tup_returned{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')}]},{targets:[{expr:'irate(pg_stat_database_conflicts{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')},{expr:'irate(pg_stat_database_deadlocks{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')},{expr:'irate(pg_stat_database_xact_commit{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')},{expr:'irate(pg_stat_database_xact_rollback{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}[1m])')}]},{targets:[{expr:'max(pg_stat_activity_max_tx_duration{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}) by (datname)')}]},{targets:[{expr:'pg_locks_count{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""} > 0')}]},{targets:[{expr:'pg_database_size_bytes{namespace="'.concat(a,'",pod="').concat(r,'",datname!="template0", datname!="template1",datname!=""}')}]}]}function l(e){return[{title:t("CONNECTIONS"),legend:[t("ACTIVE_CONNECTIONS"),t("IDLE_IN_TRANSACTION"),t("IDLE_CONNECTIONS")],data:[(0,c.default)(e,"[1].data.result[0]",{}),(0,c.default)(e,"[2].data.result[0]",{}),(0,c.default)(e,"[3].data.result[0]",{})]},{title:t("ACTIVE_SESSIONS"),legend:[t("ACTIVE_SESSIONS")],unit:"%",dot:2,data:[(0,c.default)(e,"[4].data.result[0]",{})]},{title:t("CACHE_HIT_RATIO"),legend:[t("CACHE_HIT_RATIO")],unit:"%",dot:2,data:[(0,c.default)(e,"[5].data.result[0]",{})]},{title:t("CACHE_HIT_RATIO_EACH_DATABASE"),legend:(0,c.default)(e,"[6].data.result",[]).map((function(e){return e.metric.datname})),unit:"%",dot:2,data:(0,c.default)(e,"[6].data.result",[])},{title:t("FETCHED_PER_SECOND"),legend:(0,c.default)(e,"[7].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[7].data.result",[])},{title:t("INSERTED_PER_SECOND"),legend:(0,c.default)(e,"[8].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[8].data.result",[])},{title:t("UPDATED_PER_SECOND"),legend:(0,c.default)(e,"[9].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[9].data.result",[])},{title:t("DELETED_PER_SECOND"),legend:(0,c.default)(e,"[10].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[10].data.result",[])},{title:t("RETURNED_PER_SECOND"),legend:(0,c.default)(e,"[11].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[11].data.result",[])},{title:t("CONFLICTS_PER_SECOND"),legend:(0,c.default)(e,"[12].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[12].data.result",[])},{title:t("DEADLOCKS_PER_SECOND"),legend:(0,c.default)(e,"[13].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[13].data.result",[])},{title:t("COMMITS_PER_SECOND"),legend:(0,c.default)(e,"[14].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[14].data.result",[])},{title:t("ROLLBACKS_PER_SECOND"),legend:(0,c.default)(e,"[15].data.result",[]).map((function(e){return e.metric.datname})),dot:2,data:(0,c.default)(e,"[15].data.result",[])},{title:t("MAX_TX_DURATION"),legend:(0,c.default)(e,"[15].data.result",[]).map((function(e){return e.metric.datname})),data:(0,c.default)(e,"[16].data.result",[])},{title:t("LOCKS"),legend:(0,c.default)(e,"[17].data.result",[]).map((function(e){return"".concat(e.metric.datname,"-").concat(e.metric.mode)})),data:(0,c.default)(e,"[17].data.result",[])},{title:t("DATABASE_SIZE"),unitType:"disk",legend:(0,c.default)(e,"[18].data.result",[]).map((function(e){return e.metric.datname})),data:(0,c.default)(e,"[18].data.result",[])}]}var i={postgresql:{getConfig:s,getMonitoringCfgs:l},autofailover:{getConfig:function(e,t){var a=e.detail.namespace,r=t.name;return[].concat((0,o.default)(s(e,t)),[{targets:[{expr:'pg_auto_failover_async_count{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'pg_auto_failover_invalid_count{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'pg_auto_failover_not_running_count{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'pg_auto_failover_unhealth_count{namespace="'.concat(a,'",pod="').concat(r,'"}')}]}])},getMonitoringCfgs:function(e){return[{title:t("ASYNC_NODE_NUMBER"),legend:[t("ASYNC_NODE_NUMBER")],data:[(0,c.default)(e,"[19].data.result[0]",{})]},{title:t("INVALID_STATUS_NODE_NUMBER"),legend:[t("INVALID_STATUS_NODE_NUMBER")],data:[(0,c.default)(e,"[20].data.result[0]",{})]},{title:t("NOT_RUNNING_NODE_NUMBER"),legend:[t("NOT_RUNNING_NODE_NUMBER")],data:[(0,c.default)(e,"[21].data.result[0]",{})]},{title:t("UNHEALTH_NODE_NUMBER"),legend:[t("UNHEALTH_NODE_NUMBER")],data:[(0,c.default)(e,"[22].data.result[0]",{})]}].concat(l(e))}}};a.default=i},3976:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(20),r(14);var o=n(r(26));var c={getConfig:function(e,t){var a=e.detail.namespace,r=t.name;return[{targets:[{expr:'redis_memory_used_bytes{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'redis_memory_max_bytes{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'redis_memory_used_bytes{namespace="'.concat(a,'",pod="').concat(r,'"} / redis_memory_max_bytes{namespace="').concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'rate(redis_commands_processed_total{namespace="'.concat(a,'",pod="').concat(r,'"}[1m])')}]},{targets:[{expr:'topk(5, irate(redis_commands_total{namespace="'.concat(a,'",pod="').concat(r,'"} [1m]))')}]},{targets:[{expr:'rate(redis_net_input_bytes_total{namespace="'.concat(a,'",pod="').concat(r,'"}[5m])')},{expr:'rate(redis_net_output_bytes_total{namespace="'.concat(a,'",pod="').concat(r,'"}[5m])')}]},{targets:[{expr:'sum (redis_db_keys{namespace="'.concat(a,'",pod="').concat(r,'"}) by (db)')}]},{targets:[{expr:'sum (redis_db_keys{namespace="'.concat(a,'",pod="').concat(r,'"}) - sum (redis_db_keys_expiring{namespace="').concat(a,'",pod="').concat(r,'"})')},{expr:'sum (redis_db_keys_expiring{namespace="'.concat(a,'",pod="').concat(r,'"})')}]},{targets:[{expr:'redis_connected_clients{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'irate(redis_keyspace_hits_total{namespace="'.concat(a,'",pod="').concat(r,'"}[5m]) * 100')},{expr:'irate(redis_keyspace_misses_total{namespace="'.concat(a,'",pod="').concat(r,'"}[5m]) * 100')}]},{targets:[{expr:'redis_mem_fragmentation_ratio{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'rate(redis_rejected_connections_total{namespace="'.concat(a,'",pod="').concat(r,'"}[5m])')}]},{targets:[{expr:'redis_evicted_keys_total{namespace="'.concat(a,'",pod="').concat(r,'"}')}]}]},getMonitoringCfgs:function(e){return[{title:t("REDIS_MEMORY_USAGE"),legend:[t("REDIS_USED_MEMORY"),t("REDIS_MAX_MEMORY")],unitType:"memory",data:[(0,o.default)(e,"1.data.result[0]",{}),(0,o.default)(e,"2.data.result[0]",{})]},{title:t("REDIS_MEMORY_USAGE"),unit:"%",dot:2,legend:[t("REDIS_MEMORY_USAGE")],data:[(0,o.default)(e,"3.data.result[0]",{})]},{title:t("COMMANDS_EXECUTED_PER_MINUTE"),legend:[t("COMMANDS_EXECUTED_PER_MINUTE")],data:[(0,o.default)(e,"4.data.result[0]",{})]},{title:t("TOP_5_REDIS_COMMANDS_PER_MINUTE"),dot:2,legend:(0,o.default)(e,"5.data.result",[]).map((function(e){return(0,o.default)(e,"metric.cmd")})),data:(0,o.default)(e,"5.data.result")},{title:t("NETWORK_IO"),unitType:"memory",legend:[t("NETWORK_INPUT_BYTES"),t("NETWORK_OUTPUT_BYTES")],data:[(0,o.default)(e,"6.data.result[0]",{}),(0,o.default)(e,"7.data.result[0]",{})]},{title:t("TOTAL_DB_KEYS"),legend:[t("TOTAL_DB_KEYS")],data:[(0,o.default)(e,"8.data.result[0]",{})]},{title:t("DB_KEYS"),legend:[t("VALID_KEYS"),t("EXPIRED_KEYS")],data:[(0,o.default)(e,"9.data.result[0]",{}),(0,o.default)(e,"10.data.result[0]",{})]},{title:t("CLIENT_COUNT"),legend:[t("CLIENT_COUNT")],data:[(0,o.default)(e,"11.data.result[0]",{})]},{title:t("KEYSPACE"),legend:[t("KEYSPACE_HITS_TOTAL"),t("KEYSPACE_MISSES_TOTAL")],data:[(0,o.default)(e,"12.data.result[0]",{}),(0,o.default)(e,"13.data.result[0]",{})]},{title:t("MEMORY_FRAGMENTATION_RATIO"),legend:[t("MEMORY_FRAGMENTATION_RATIO")],unit:"%",data:[(0,o.default)(e,"14.data.result[0]",{})]},{title:t("REJECTED_CONNECTION_RATIO"),legend:[t("REJECTED_CONNECTION_RATIO")],unit:"%",data:[(0,o.default)(e,"15.data.result[0]",{})]},{title:t("REVICTED_KEY_RATIO"),legend:[t("REVICTED_KEY_RATIO")],data:[(0,o.default)(e,"16.data.result[0]",{})]}]}};a.default=c},3977:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(14);var o=n(r(26));var c={getConfig:function(e,t){var a=e.detail.namespace,r=t.name;return[{targets:[{expr:'predixy_used_memory{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'predixy_redis_cluster_connections{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'rate(predixy_redis_cluster_total_recv_client_bytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m])')},{expr:'rate(predixy_redis_cluster_total_recv_server_bytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m])')},{expr:'rate(predixy_redis_cluster_total_send_client_bytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m])')},{expr:'rate(predixy_redis_cluster_total_send_server_bytes{namespace="'.concat(a,'",pod="').concat(r,'"}[1m])')}]},{targets:[{expr:'rate(predixy_total_requests{namespace="'.concat(a,'",pod="').concat(r,'"}[1m])')}]},{targets:[{expr:'count(predixy_redis_cluster_server_connections{namespace="'.concat(a,'",pod="').concat(r,'"})')}]}]},getMonitoringCfgs:function(e){return[{title:t("PREDIXY_MEMORY_USAGE"),legend:[t("PREDIXY_MEMORY_USAGE")],unitType:"memory",data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("CLIENT_COUNT"),unit:"%",dot:2,legend:[t("CLIENT_COUNT")],data:[(0,o.default)(e,"2.data.result[0]",{})]},{title:t("NETWORK_IO"),legend:[t("RECV_CLIENT_BYTES"),t("RECV_SERVER_BYTES"),t("SEND_CLIENT_BYTES"),t("SEND_SERVER_BYTES")],data:[(0,o.default)(e,"3.data.result[0]",{}),(0,o.default)(e,"4.data.result[0]",{}),(0,o.default)(e,"5.data.result[0]",{}),(0,o.default)(e,"6.data.result[0]",{})]},{title:t("COMMANDS_EXECUTED_PER_MINUTE"),legend:[t("COMMANDS_EXECUTED_PER_MINUTE")],data:[(0,o.default)(e,"7.data.result[0]",{})]},{title:t("REDIS_CLUSTER_COUNT"),legend:[t("REDIS_CLUSTER_COUNT")],data:[(0,o.default)(e,"8.data.result[0]",{})]}]}};a.default=c},3978:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(14);var o=n(r(26));var c={getConfig:function(e,t){var a=e.detail.namespace,r=t.name;return[{targets:[{expr:'sum(max_over_time(mongodb_opcounters_insert{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcounters_insert{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcounters_query{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcounters_query{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcounters_update{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcounters_update{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcounters_delete{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcounters_delete{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcounters_getmore{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcounters_getmore{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcounters_command{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcounters_command{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')}]},{targets:[{expr:'sum(max_over_time(mongodb_opcountersRepl_insert{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcountersRepl_insert{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcountersRepl_query{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcountersRepl_query{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcountersRepl_update{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcountersRepl_update{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcountersRepl_delete{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcountersRepl_delete{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcountersRepl_getmore{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcountersRepl_getmore{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')},{expr:'sum(max_over_time(mongodb_opcountersRepl_command{namespace="'.concat(a,'",pod="').concat(r,'"}[1m]) or vector(0)) - sum(max_over_time(mongodb_opcountersRepl_command{namespace="').concat(a,'",pod="').concat(r,'"}[1m] offset 1m) or vector(0))')}]},{targets:[{expr:'mongodb_connections_current{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_connections_totalCreated{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_connections_available{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_connections_active{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'mongodb_metrics_cursor_timedOut{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_metrics_cursor_open_noTimeout{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_metrics_cursor_open_pinned{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_metrics_cursor_open_total{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'mongodb_network_bytesIn{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_network_bytesOut{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'mongodb_wiredTiger_concurrentTransactions_write_out{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_wiredTiger_concurrentTransactions_write_available{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_wiredTiger_concurrentTransactions_read_out{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_wiredTiger_concurrentTransactions_read_available{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'mongodb_metrics_document_deleted{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_metrics_document_inserted{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_metrics_document_returned{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_metrics_document_updated{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'mongodb_metrics_queryExecutor_scanned{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_metrics_queryExecutor_scannedObjects{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'mongodb_globalLock_activeClients_total{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_globalLock_activeClients_readers{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_globalLock_activeClients_writers{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'mongodb_globalLock_currentQueue_total{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_globalLock_currentQueue_readers{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_globalLock_currentQueue_writers{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'mongodb_wiredTiger_cache_tracked_dirty_bytes_in_the_cache{namespace="'.concat(a,'",pod="').concat(r,'"} / mongodb_wiredTiger_cache_maximum_bytes_configured{namespace="').concat(a,'",pod="').concat(r,'"}')},{expr:'mongodb_wiredTiger_cache_bytes_currently_in_the_cache{namespace="'.concat(a,'",pod="').concat(r,'"} / mongodb_wiredTiger_cache_maximum_bytes_configured{namespace="').concat(a,'",pod="').concat(r,'"}')}]}]},getMonitoringCfgs:function(e){return[{title:t("OP_COUNTERS"),legend:[t("OP_INSERT"),t("OP_QUERY"),t("OP_UPDATE"),t("OP_DELETE"),t("OP_GETMORE"),t("OP_COMMAND")],data:[(0,o.default)(e,"1.data.result[0]",{}),(0,o.default)(e,"2.data.result[0]",{}),(0,o.default)(e,"3.data.result[0]",{}),(0,o.default)(e,"4.data.result[0]",{}),(0,o.default)(e,"5.data.result[0]",{}),(0,o.default)(e,"6.data.result[0]",{})]},{title:t("OPREPL_COUNTERS"),legend:[t("OPREPL_INSERT"),t("OPREPL_QUERY"),t("OPREPL_UPDATE"),t("OPREPL_DELETE"),t("OPREPL_GETMORE"),t("OPREPL_COMMAND")],data:[(0,o.default)(e,"7.data.result[0]",{}),(0,o.default)(e,"8.data.result[0]",{}),(0,o.default)(e,"9.data.result[0]",{}),(0,o.default)(e,"10.data.result[0]",{}),(0,o.default)(e,"11.data.result[0]",{}),(0,o.default)(e,"12.data.result[0]",{})]},{title:t("CONNECTIONS"),legend:[t("CONNECTIONS_CURRENT"),t("CONNECTIONS_TOTALCREATED"),t("CONNECTIONS_AVAILABLE"),t("CONNECTIONS_ACTIVE")],data:[(0,o.default)(e,"13.data.result[0]",{}),(0,o.default)(e,"14.data.result[0]",{}),(0,o.default)(e,"15.data.result[0]",{}),(0,o.default)(e,"16.data.result[0]",{})]},{title:t("CURSOR_COUNT"),legend:[t("CURSOR_TIMEDOUT"),t("CURSOR_OPEN_NOTIMEOUT"),t("CURSOR_OPEN_PINNED"),t("CURSOR_OPEN_TOTAL")],data:[(0,o.default)(e,"17.data.result[0]",{}),(0,o.default)(e,"18.data.result[0]",{}),(0,o.default)(e,"19.data.result[0]",{}),(0,o.default)(e,"20.data.result[0]",{})]},{title:t("MONGODB_NETWORK_TRAFFIC"),legend:[t("NETWORK_BYTESIN"),t("NETWORK_BYTESOUT")],unitType:"memory",data:[(0,o.default)(e,"21.data.result[0]",{}),(0,o.default)(e,"22.data.result[0]",{})]},{title:t("WIREDTIGER_OPERATION_COUNT"),legend:[t("WT_WRITE_OUT"),t("WT_WRITE_AVAILABLE"),t("WT_READ_OUT"),t("WT_READ_AVAILABLE")],data:[(0,o.default)(e,"23.data.result[0]",{}),(0,o.default)(e,"24.data.result[0]",{}),(0,o.default)(e,"25.data.result[0]",{}),(0,o.default)(e,"26.data.result[0]",{})]},{title:t("DOC_COUNT"),legend:[t("DOC_DELETED"),t("DOC_INSERTED"),t("DOC_RETURNED"),t("DOC_UPDATED")],data:[(0,o.default)(e,"27.data.result[0]",{}),(0,o.default)(e,"28.data.result[0]",{}),(0,o.default)(e,"29.data.result[0]",{}),(0,o.default)(e,"30.data.result[0]",{})]},{title:t("QUERYEXECUTOR"),legend:[t("SCANNEDKEYS"),t("SCANNEDDOCS")],data:[(0,o.default)(e,"31.data.result[0]",{}),(0,o.default)(e,"32.data.result[0]",{})]},{title:t("ACTIVECLIENTS"),legend:[t("CLIENTS_TOTAL"),t("CLIENTS_READERS"),t("CLIENTS_WRITERS")],data:[(0,o.default)(e,"33.data.result[0]",{}),(0,o.default)(e,"34.data.result[0]",{}),(0,o.default)(e,"35.data.result[0]",{})]},{title:t("QUEUED_OPERATIONS"),legend:[t("QUEUE_TOTAL"),t("QUEUE_READERS"),t("QUEUE_WRITERS")],unitType:"%",data:[(0,o.default)(e,"36.data.result[0]",{}),(0,o.default)(e,"37.data.result[0]",{}),(0,o.default)(e,"38.data.result[0]",{})]},{title:t("WIREDTIGER_CACHE"),legend:[t("WIREDTIGER_CACHE_USAGED"),t("WIREDTIGER_CACHE_DIRTY_USAGE")],unitType:"%",data:[(0,o.default)(e,"39.data.result[0]",{}),(0,o.default)(e,"40.data.result[0]",{})]}]}};a.default=c},3979:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(14);var o=n(r(26));var c={main:{getConfig:function(e){var t=e.detail,a=t.namespace,r=t.name;return[{targets:[{expr:'sum(elasticsearch_cluster_health_task_max_waiting_in_queue_millis{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')}]},{targets:[{expr:'sum(elasticsearch_cluster_health_number_of_in_flight_fetch{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')},{expr:'sum(elasticsearch_cluster_health_number_of_pending_tasks{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')}]},{targets:[{expr:'sum(elasticsearch_cluster_health_number_of_data_nodes{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')},{expr:'sum(elasticsearch_cluster_health_number_of_nodes{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')}]},{targets:[{expr:'sum(elasticsearch_cluster_health_delayed_unassigned_shards{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')},{expr:'sum(elasticsearch_cluster_health_initializing_shards{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')},{expr:'sum(elasticsearch_cluster_health_relocating_shards{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')},{expr:'sum(elasticsearch_cluster_health_unassigned_shards{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')},{expr:'sum(elasticsearch_cluster_health_active_primary_shards{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')},{expr:'sum(elasticsearch_cluster_health_active_shards{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'"})')}]},{targets:[{expr:'sum(elasticsearch_cluster_health_status{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'",color="green"})')},{expr:'sum(elasticsearch_cluster_health_status{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'",color="yellow"})')},{expr:'sum(elasticsearch_cluster_health_status{service="'.concat(r,'-es-elasticsearch-exporter",namespace="').concat(a,'",color="red"})')}]}]},getMonitoringCfgs:function(e){return[{title:t("CLUSTER_TASK_WAITING_TIME"),legend:[t("CLUSTER_TASK_WAITING_TIME")],unit:"ms",data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("CLUSTER_TASK_STATUS"),legend:[t("CLUSTER_NUMBER_OF_IN_FLIGHT_FETCH"),t("CLUSTER_NUMBER_OF_PENDING_TASKS")],data:[(0,o.default)(e,"2.data.result[0]",{}),(0,o.default)(e,"3.data.result[0]",{})]},{title:t("CLUSTER_NUMBER_OF_NODES"),legend:[t("CLUSTER_NUMBER_OF_DATA_NODES"),t("CLUSTER_NUMBER_OF_ALL_NODES")],data:[(0,o.default)(e,"4.data.result[0]",{}),(0,o.default)(e,"5.data.result[0]",{})]},{title:t("SHARD_STATUS"),dot:2,legend:[t("CLUSTER_DELAYED_UNASSIGNED_SHARDS"),t("CLUSTER_INITIALIZING_SHARDS"),t("CLUSTER_RELOCATING_SHARDS"),t("CLUSTER_UNASSIGNED_SHARDS"),t("CLUSTER_ACTIVE_PRIMARY_SHARDS"),t("CLUSTER_ACTIVE_SHARDS")],data:[(0,o.default)(e,"6.data.result[0]"),(0,o.default)(e,"7.data.result[0]"),(0,o.default)(e,"8.data.result[0]"),(0,o.default)(e,"9.data.result[0]"),(0,o.default)(e,"10.data.result[0]"),(0,o.default)(e,"11.data.result[0]")]},{title:t("CLUSTER_HEALTH_STATUS"),legend:[t("CLUSTER_HEALTH_STATUS_GREEN"),t("CLUSTER_HEALTH_STATUS_YELLOW"),t("CLUSTER_HEALTH_STATUS_RED")],data:[(0,o.default)(e,"12.data.result[0]",{}),(0,o.default)(e,"13.data.result[0]",{}),(0,o.default)(e,"14.data.result[0]",{})]}]}},pod:{getConfig:function(e,t){var a=e.detail.namespace,r=t.name;return[{targets:[{expr:'round(elasticsearch_jvm_memory_used_bytes{namespace="'.concat(a,'",name="').concat(r,'",area="heap"}/elasticsearch_jvm_memory_max_bytes{namespace="').concat(a,'",name="').concat(r,'",area="heap"},0.001)')}]},{targets:[{expr:'round(elasticsearch_filesystem_data_available_bytes{namespace="'.concat(a,'",name="').concat(r,'"},0.1)')}]},{targets:[{expr:'round(elasticsearch_filesystem_data_free_bytes{namespace="'.concat(a,'",name="').concat(r,'"}/elasticsearch_filesystem_data_size_bytes{namespace="').concat(a,'",name="').concat(r,'"},0.001)')}]},{targets:[{expr:'(elasticsearch_os_cpu_percent{namespace="'.concat(a,'",name="').concat(r,'"}/100)')}]},{targets:[{expr:'elasticsearch_os_load1{namespace="'.concat(a,'",name="').concat(r,'"}')},{expr:'elasticsearch_os_load5{namespace="'.concat(a,'",name="').concat(r,'"}')},{expr:'elasticsearch_os_load15{namespace="'.concat(a,'",name="').concat(r,'"}')}]},{targets:[{expr:'elasticsearch_indices_docs{namespace="'.concat(a,'",name="').concat(r,'"}')},{expr:'elasticsearch_indices_docs_deleted{namespace="'.concat(a,'",name="').concat(r,'"}')}]},{targets:[{expr:'rate(elasticsearch_indices_indexing_index_total{namespace="'.concat(a,'",name="').concat(r,'"}[5m])')}]},{targets:[{expr:'rate(elasticsearch_indices_search_query_total{namespace="'.concat(a,'",name="').concat(r,'"}[5m])')}]},{targets:[{expr:'round(rate(elasticsearch_indices_indexing_index_time_seconds_total{namespace="'.concat(a,'",name="').concat(r,'"}[5m])*1000)')}]},{targets:[{expr:'round(rate(elasticsearch_indices_search_query_time_seconds{namespace="'.concat(a,'",name="').concat(r,'"}[5m])*1000)')}]}]},getMonitoringCfgs:function(e){return[{title:t("HEAP_MEMORY"),legend:[t("JVM_MEMORY_HEAP_USAGE_PER")],unit:"%",dot:"2",data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("DATA_AVAILABLE_BYTES"),legend:[t("DATA_AVAILABLE_BYTES")],unitType:"memory",data:[(0,o.default)(e,"2.data.result[0]",{})]},{title:t("DATA_AVAILABLE_PERCENT"),legend:[t("DATA_AVAILABLE_PERCENT")],unit:"%",dot:2,data:[(0,o.default)(e,"3.data.result[0]",{})]},{title:"CPU",legend:[t("ECK_CPU_USAGE")],unit:"%",dot:2,data:[(0,o.default)(e,"4.data.result[0]",{})]},{title:t("OS_LOAD"),legend:[t("OS_LOAD1"),t("OS_LOAD5"),t("OS_LOAD15")],data:[(0,o.default)(e,"5.data.result[0]",{}),(0,o.default)(e,"6.data.result[0]",{}),(0,o.default)(e,"7.data.result[0]",{})]},{title:t("DOC_STATISTICS"),legend:[t("ELASTICSEARCH_INDICES_DOCS"),t("ELASTICSEARCH_INDICES_DOCS_DELETED")],data:[(0,o.default)(e,"8.data.result[0]",{}),(0,o.default)(e,"9.data.result[0]",{})]},{title:t("ELASTICSEARCH_INDICES_INDEXING_INDEX_QPS"),legend:[t("ELASTICSEARCH_INDICES_INDEXING_INDEX_QPS")],data:[(0,o.default)(e,"10.data.result[0]",{})]},{title:t("ELASTICSEARCH_INDICES_SEARCH_QUERY_QPS"),legend:[t("ELASTICSEARCH_INDICES_SEARCH_QUERY_QPS")],data:[(0,o.default)(e,"11.data.result[0]",{})]},{title:t("ELASTICSEARCH_INDICES_INDEXING_TIME_MS"),legend:[t("ELASTICSEARCH_INDICES_INDEXING_TIME_MS")],unit:"ms",data:[(0,o.default)(e,"12.data.result[0]",{})]},{title:t("ELASTICSEARCH_INDICES_SEARCH_TIME_MS"),legend:[t("ELASTICSEARCH_INDICES_SEARCH_TIME_MS")],unit:"ms",data:[(0,o.default)(e,"13.data.result[0]",{})]}]}}};a.default=c},3980:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(14);var o=n(r(26));var c={main:{getConfig:function(e){var t=e.detail,a=t.namespace,r=t.name;return[{targets:[{expr:'count(kafka_server_replicamanager_leadercount{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*"})')}]},{targets:[{expr:'sum(kafka_cluster_partition_underminisr{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*"})')}]},{targets:[{expr:'sum(kafka_controller_kafkacontroller_offlinepartitionscount{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*"})')}]},{targets:[{expr:'sum(irate(kafka_server_brokertopicmetrics_bytesin_total{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*",topic!~"strimzi.cruisecontrol.modeltrainingsamples|strimzi.cruisecontrol.metrics|trainingsamples|__consumer_offsets|__strimzi-topic-operator-kstreams-topic-store-changelog|__strimzi_store_topic|strimzi.cruisecontrol.partitionmetricsamples|"}[2m]))')}]},{targets:[{expr:'sum(irate(kafka_server_brokertopicmetrics_bytesout_total{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*",topic!~"strimzi.cruisecontrol.modeltrainingsamples|strimzi.cruisecontrol.metrics|trainingsamples|__consumer_offsets|__strimzi-topic-operator-kstreams-topic-store-changelog|__strimzi_store_topic|strimzi.cruisecontrol.partitionmetricsamples|"}[2m]))')}]},{targets:[{expr:'sum(irate(kafka_server_brokertopicmetrics_messagesin_total{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*",topic!~"strimzi.cruisecontrol.modeltrainingsamples|strimzi.cruisecontrol.metrics|trainingsamples|__consumer_offsets|__strimzi-topic-operator-kstreams-topic-store-changelog|__strimzi_store_topic|strimzi.cruisecontrol.partitionmetricsamples|"}[2m]))')}]},{targets:[{expr:'sum(irate(kafka_server_brokertopicmetrics_totalproducerequests_total{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*",topic!~"strimzi.cruisecontrol.modeltrainingsamples|strimzi.cruisecontrol.metrics|trainingsamples|__consumer_offsets|__strimzi-topic-operator-kstreams-topic-store-changelog|__strimzi_store_topic|strimzi.cruisecontrol.partitionmetricsamples|"}[2m]))')}]}]},getMonitoringCfgs:function(e){return[{title:t("ONLINE_BROKER_COUNT"),legend:[t("ONLINE_BROKER_COUNT")],data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("PARTITIONS_UNDER_MINIMUM_ISR"),legend:[t("PARTITIONS_UNDER_MINIMUM_ISR")],data:[(0,o.default)(e,"2.data.result[0]",{})]},{title:t("OFFLINE_PARTITION_COUNT"),legend:[t("OFFLINE_PARTITION_COUNT")],data:[(0,o.default)(e,"3.data.result[0]",{})]},{title:t("TOPIC_INCOMING_DATA_RATE"),legend:[t("TOPIC_INCOMING_DATA_RATE")],unitType:"traffic",data:[(0,o.default)(e,"4.data.result[0]")]},{title:t("TOPIC_OUTGOING_DATA_RATE"),legend:[t("TOPIC_OUTGOING_DATA_RATE")],unitType:"traffic",data:[(0,o.default)(e,"5.data.result[0]",{})]},{title:t("TOPIC_INCOMING_MESSAGE_RATE"),legend:[t("TOPIC_INCOMING_MESSAGE_RATE")],data:[(0,o.default)(e,"6.data.result[0]",{})]},{title:t("TOPIC_OUTGOING_MESSAGE_RATE"),legend:[t("TOPIC_OUTGOING_MESSAGE_RATE")],data:[(0,o.default)(e,"7.data.result[0]",{})]}]}},pod:{getConfig:function(e,t){var a=e.detail,r=a.namespace,n=a.name,o=t.name;return[{targets:[{expr:'kafka_network_socketserver_networkprocessoravgidle_percent{namespace="'.concat(r,'",strimzi_io_cluster="').concat(n,'",job=~"').concat(r,"/").concat(n,'.*",kubernetes_pod_name=~"').concat(o,'"}')}]},{targets:[{expr:'irate(kafka_server_kafkaserver_linux_disk_write_bytes{namespace="'.concat(r,'",strimzi_io_cluster="').concat(n,'",job=~"').concat(r,"/").concat(n,'.*",kubernetes_pod_name=~"').concat(o,'"}[2m])')}]},{targets:[{expr:'irate(kafka_server_kafkaserver_linux_disk_read_bytes{namespace="'.concat(r,'",strimzi_io_cluster="').concat(n,'",job=~"').concat(r,"/").concat(n,'.*",kubernetes_pod_name=~"').concat(o,'"}[2m])')}]},{targets:[{expr:'sum(container_memory_usage_bytes{namespace="'.concat(r,'",pod=~"').concat(o,'",container="kafka"}) by (pod)')}]},{targets:[{expr:'sum(rate(container_cpu_usage_seconds_total{namespace="'.concat(r,'",pod=~"').concat(o,'",container="kafka"}[5m])) by (pod)')}]},{targets:[{expr:'process_open_fds{namespace="'.concat(r,'",pod=~"').concat(o,'",job=~"').concat(r,"/").concat(n,'.*",container="kafka"}')}]},{targets:[{expr:'sum(jvm_memory_bytes_used{namespace="'.concat(r,'",kubernetes_pod_name=~"').concat(o,'",strimzi_io_name="').concat(n,'-kafka",job=~".*').concat(n,'.*"}) by (kubernetes_pod_name)')}]},{targets:[{expr:'jvm_threads_current{namespace="'.concat(r,'",kubernetes_pod_name=~"').concat(o,'",strimzi_io_name="').concat(n,'-kafka",job=~".*').concat(n,'.*"}')}]},{targets:[{expr:'kubelet_volume_stats_available_bytes{namespace="'.concat(r,'",persistentvolumeclaim=~"data-0-').concat(n,'-kafka-0"}')}]}]},getMonitoringCfgs:function(e){return[{title:t("NETWORK_PROCESSOR_AVG_IDLE_PERCENT"),legend:[t("NETWORK_PROCESSOR_AVG_IDLE_PERCENT")],unit:"%",dot:2,data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("DISK_WRITES"),legend:[t("DISK_WRITES")],unitType:"traffic",data:[(0,o.default)(e,"2.data.result[0]",{})]},{title:t("DISK_READS"),legend:[t("DISK_READS")],unitType:"traffic",data:[(0,o.default)(e,"3.data.result[0]",{})]},{title:t("KAFKA_MEMORY_USAGE"),legend:[t("KAFKA_MEMORY_USAGE")],unitType:"memory",data:[(0,o.default)(e,"4.data.result[0]")]},{title:t("KAFKA_CPU_USAGE"),legend:[t("KAFKA_CPU_USAGE")],data:[(0,o.default)(e,"5.data.result[0]",{})]},{title:t("KAFKA_OPEN_FILE_DESC"),legend:[t("KAFKA_OPEN_FILE_DESC")],data:[(0,o.default)(e,"6.data.result[0]",{})]},{title:t("JVM_MEMORY_USAGE"),legend:[t("JVM_MEMORY_USAGE")],unitType:"memory",data:[(0,o.default)(e,"7.data.result[0]",{})]},{title:t("JVM_THREAD_COUNT"),legend:[t("JVM_THREAD_COUNT")],data:[(0,o.default)(e,"8.data.result[0]",{})]},{title:t("AVAILABLE_DISK_SPACE"),legend:[t("AVAILABLE_DISK_SPACE")],unitType:"memory",data:[(0,o.default)(e,"9.data.result[0]",{})]}]}}};a.default=c},3981:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(51),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(51),r(14);var o=n(r(26));var c={main:{getConfig:function(e){var t=e.detail,a=t.namespace,r=t.name;return[{targets:[{expr:'max(zookeeper_quorumsize{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*",strimzi_io_kind="Kafka"})')}]},{targets:[{expr:'avg(zookeeper_inmemorydatatree_nodecount{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*",strimzi_io_kind="Kafka"})')}]},{targets:[{expr:'sum(zookeeper_numaliveconnections{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*",strimzi_io_kind="Kafka"})')}]},{targets:[{expr:'sum(zookeeper_inmemorydatatree_watchcount{namespace="'.concat(a,'",strimzi_io_cluster="').concat(r,'",job=~"').concat(a,"/").concat(r,'.*",strimzi_io_kind="Kafka"})')}]}]},getMonitoringCfgs:function(e){return[{title:t("QUORUM_SIZE"),legend:[t("QUORUM_SIZE")],data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("ZNODE_COUNT"),legend:[t("ZNODE_COUNT")],data:[(0,o.default)(e,"2.data.result[0]",{})]},{title:t("ACTIVE_CONNECTIONS"),legend:[t("ACTIVE_CONNECTIONS")],data:[(0,o.default)(e,"3.data.result[0]",{})]},{title:t("WATCHER_COUNT"),legend:[t("WATCHER_COUNT")],data:[(0,o.default)(e,"4.data.result[0]")]}]}},pod:{getConfig:function(e,t){var a=e.detail,r=a.namespace,n=a.name,o=t.name;return[{targets:[{expr:'sum(container_memory_usage_bytes{namespace="'.concat(r,'",pod=~"').concat(o,'",container="zookeeper"}) by (pod)')}]},{targets:[{expr:'sum(rate(container_cpu_usage_seconds_total{namespace="'.concat(r,'",pod=~"').concat(o,'",container="zookeeper"}[5m])) by (pod)')}]},{targets:[{expr:'process_open_fds{namespace="'.concat(r,'",pod=~"').concat(o,'",job=~"').concat(r,"/").concat(n,'.*",container="zookeeper"}')}]},{targets:[{expr:'jvm_threads_current{namespace="'.concat(r,'",kubernetes_pod_name=~"').concat(o,'",strimzi_io_name="').concat(n,'-zookeeper",job=~".*').concat(n,'.*"}')}]},{targets:[{expr:'sum(jvm_memory_bytes_used{namespace="'.concat(r,'",kubernetes_pod_name=~"').concat(o,'",strimzi_io_name="').concat(n,'-zookeeper",job=~".*').concat(n,'.*"}) by (kubernetes_pod_name)')}]},{targets:[{expr:'zookeeper_avgrequestlatency{namespace="'.concat(r,'",job=~"').concat(r,"/").concat(n,'.*",kubernetes_pod_name=~"').concat(o,'"}')}]},{targets:[{expr:'zookeeper_maxrequestlatency{namespace="'.concat(r,'",job=~"').concat(r,"/").concat(n,'.*",kubernetes_pod_name=~"').concat(o,'"}')}]},{targets:[{expr:'kubelet_volume_stats_available_bytes{namespace="'.concat(r,'",persistentvolumeclaim=~"data-').concat(n,"-zookeeper-").concat(o.slice(-1),'"}')}]}]},getMonitoringCfgs:function(e){return[{title:t("ZOOKEEPER_MEMORY_USAGE"),legend:[t("ZOOKEEPER_MEMORY_USAGE")],unitType:"memory",data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("ZOOKEEPER_CPU_USAGE"),legend:[t("ZOOKEEPER_CPU_USAGE")],data:[(0,o.default)(e,"2.data.result[0]",{})]},{title:t("OPEN_FILE_DESCRIPTORS"),legend:[t("OPEN_FILE_DESCRIPTORS")],data:[(0,o.default)(e,"3.data.result[0]",{})]},{title:t("JVM_THREAD_COUNT"),legend:[t("JVM_THREAD_COUNT")],data:[(0,o.default)(e,"4.data.result[0]")]},{title:t("JVM_MEMORY_USAGE"),legend:[t("JVM_MEMORY_USAGE")],unitType:"memory",data:[(0,o.default)(e,"5.data.result[0]",{})]},{title:t("REQUEST_LATENCY_AVERAGE"),legend:[t("REQUEST_LATENCY_AVERAGE")],unitType:"second",data:[(0,o.default)(e,"6.data.result[0]",{})]},{title:t("REQUEST_LATENCY_MAXIMUM"),legend:[t("REQUEST_LATENCY_MAXIMUM")],unitType:"second",data:[(0,o.default)(e,"7.data.result[0]",{})]},{title:t("AVAILABLE_DISK_SPACE"),legend:[t("AVAILABLE_DISK_SPACE")],unitType:"memory",data:[(0,o.default)(e,"8.data.result[0]",{})]}]}}};a.default=c},3982:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(14);var o=n(r(26));var c={main:{getConfig:function(e){var t=e.detail,a=t.namespace,r=t.name;return[{targets:[{expr:'opensearch_cluster_task_max_waiting_time_seconds{namespace="'.concat(a,'",pod="').concat(r,'-masters-0"}')}]},{targets:[{expr:'opensearch_cluster_inflight_fetch_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0"}')},{expr:'opensearch_cluster_pending_tasks_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0"}')}]},{targets:[{expr:'opensearch_cluster_datanodes_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0"}')},{expr:'opensearch_cluster_nodes_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0"}')}]},{targets:[{expr:'round(opensearch_cluster_shards_active_percent{namespace="'.concat(a,'",pod="').concat(r,'-masters-0"} / 100, 0.01)')}]},{targets:[{expr:'opensearch_cluster_shards_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0",type="initializing"}')},{expr:'opensearch_cluster_shards_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0",type="relocating"}')},{expr:'opensearch_cluster_shards_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0",type="unassigned"}')},{expr:'opensearch_cluster_shards_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0",type="active_primary"}')},{expr:'opensearch_cluster_shards_number{namespace="'.concat(a,'",pod="').concat(r,'-masters-0",type="active"}')}]},{targets:[{expr:'opensearch_cluster_status{namespace="'.concat(a,'",pod="').concat(r,'-masters-0"}')}]}]},getMonitoringCfgs:function(e){return[{title:t("CLUSTER_TASK_WAITING_TIME"),legend:[t("CLUSTER_TASK_WAITING_TIME")],unit:"s",data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("CLUSTER_TASK_STATUS"),legend:[t("CLUSTER_NUMBER_OF_IN_FLIGHT_FETCH"),t("CLUSTER_NUMBER_OF_PENDING_TASKS")],data:[(0,o.default)(e,"2.data.result[0]",{}),(0,o.default)(e,"3.data.result[0]",{})]},{title:t("CLUSTER_NUMBER_OF_NODES"),legend:[t("CLUSTER_NUMBER_OF_DATA_NODES"),t("CLUSTER_NUMBER_OF_ALL_NODES")],data:[(0,o.default)(e,"4.data.result[0]",{}),(0,o.default)(e,"5.data.result[0]",{})]},{title:t("CLUSTER_SHARDS_ACTIVE_PERCENT"),legend:[t("CLUSTER_SHARDS_ACTIVE_PERCENT")],unit:"%",dot:2,data:[(0,o.default)(e,"6.data.result[0]",{})]},{title:t("SHARD_STATUS"),legend:[t("CLUSTER_INITIALIZING_SHARDS"),t("CLUSTER_RELOCATING_SHARDS"),t("CLUSTER_UNASSIGNED_SHARDS"),t("CLUSTER_ACTIVE_PRIMARY_SHARDS"),t("CLUSTER_ACTIVE_SHARDS")],data:[(0,o.default)(e,"7.data.result[0]",{}),(0,o.default)(e,"8.data.result[0]",{}),(0,o.default)(e,"9.data.result[0]",{}),(0,o.default)(e,"10.data.result[0]",{}),(0,o.default)(e,"11.data.result[0]",{})]},{title:t("CLUSTER_HEALTH_STATUS"),legend:[t("CLUSTER_HEALTH_STATUS")],data:[(0,o.default)(e,"12.data.result[0]",{})]}]}},pod:{getConfig:function(e,t){var a=e.detail.namespace,r=t.name;return[{targets:[{expr:'round(opensearch_jvm_mem_heap_used_percent{namespace="'.concat(a,'",pod="').concat(r,'"} / 100, 0.01)')}]},{targets:[{expr:'round(opensearch_fs_total_available_bytes{namespace="'.concat(a,'",pod="').concat(r,'"})')}]},{targets:[{expr:'opensearch_fs_total_available_bytes{namespace="'.concat(a,'",pod="').concat(r,'"}/opensearch_fs_total_total_bytes{namespace="').concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'round(opensearch_os_cpu_percent{namespace="'.concat(a,'",pod="').concat(r,'"} /100, 0.01)')}]},{targets:[{expr:'opensearch_os_load_average_one_minute{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'opensearch_os_load_average_five_minutes{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'opensearch_os_load_average_fifteen_minutes{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'opensearch_indices_doc_number{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'opensearch_indices_doc_deleted_number{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'opensearch_indices_indexing_index_current_number{namespace="'.concat(a,'", pod="').concat(r,'"}')}]},{targets:[{expr:'opensearch_indices_search_query_current_number{namespace="'.concat(a,'", pod="').concat(r,'"}')}]},{targets:[{expr:'delta(opensearch_indices_indexing_index_time_seconds{namespace="'.concat(a,'", pod="').concat(r,'"}[5m])')}]},{targets:[{expr:'delta(opensearch_indices_search_query_time_seconds{namespace="'.concat(a,'", pod="').concat(r,'"}[5m])')}]}]},getMonitoringCfgs:function(e){return[{title:t("HEAP_MEMORY"),legend:[t("JVM_MEMORY_HEAP_USAGE_PER")],unit:"%",dot:2,data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("DATA_AVAILABLE_BYTES"),legend:[t("DATA_AVAILABLE_BYTES")],unitType:"memory",data:[(0,o.default)(e,"2.data.result[0]",{})]},{title:t("DATA_AVAILABLE_PERCENT"),legend:[t("DATA_AVAILABLE_PERCENT")],unit:"%",dot:2,data:[(0,o.default)(e,"3.data.result[0]",{})]},{title:"CPU",legend:[t("ECK_CPU_USAGE")],unit:"%",dot:2,data:[(0,o.default)(e,"4.data.result[0]",{})]},{title:t("OS_LOAD"),legend:[t("OS_LOAD1"),t("OS_LOAD5"),t("OS_LOAD15")],data:[(0,o.default)(e,"5.data.result[0]",{}),(0,o.default)(e,"6.data.result[0]",{}),(0,o.default)(e,"7.data.result[0]",{})]},{title:t("DOC_STATISTICS"),legend:[t("ELASTICSEARCH_INDICES_DOCS"),t("ELASTICSEARCH_INDICES_DOCS_DELETED")],data:[(0,o.default)(e,"8.data.result[0]",{}),(0,o.default)(e,"9.data.result[0]",{})]},{title:t("ELASTICSEARCH_INDICES_INDEXING_INDEX_QPS"),legend:[t("ELASTICSEARCH_INDICES_INDEXING_INDEX_QPS")],data:[(0,o.default)(e,"10.data.result[0]",{})]},{title:t("ELASTICSEARCH_INDICES_SEARCH_QUERY_QPS"),legend:[t("ELASTICSEARCH_INDICES_SEARCH_QUERY_QPS")],data:[(0,o.default)(e,"11.data.result[0]",{})]},{title:t("ELASTICSEARCH_INDICES_INDEXING_TIME_MS"),legend:[t("ELASTICSEARCH_INDICES_INDEXING_TIME_MS")],unit:"s",data:[(0,o.default)(e,"12.data.result[0]",{})]},{title:t("ELASTICSEARCH_INDICES_SEARCH_TIME_MS"),legend:[t("ELASTICSEARCH_INDICES_SEARCH_TIME_MS")],unit:"s",data:[(0,o.default)(e,"13.data.result[0]",{})]}]}},logstash:{getConfig:function(e,t){var a=e.detail.namespace,r=t.name;return[{targets:[{expr:'logstash_stats_jvm_mem_heap_used_bytes{namespace="'.concat(a,'",pod="').concat(r,'"}/logstash_stats_jvm_mem_heap_max_bytes{namespace="').concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'logstash_stats_process_cpu_percent{namespace="'.concat(a,'",pod="').concat(r,'"}*0.01')}]},{targets:[{expr:'logstash_stats_process_cpu_load_average_1m{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'logstash_stats_process_cpu_load_average_5m{namespace="'.concat(a,'",pod="').concat(r,'"}')},{expr:'logstash_stats_process_cpu_load_average_15m{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'rate(logstash_stats_events_in{namespace="'.concat(a,'",pod="').concat(r,'"}[2m])')},{expr:'rate(logstash_stats_events_filtered{namespace="'.concat(a,'",pod="').concat(r,'"}[2m])')},{expr:'rate(logstash_stats_events_out{namespace="'.concat(a,'",pod="').concat(r,'"}[2m])')}]},{targets:[{expr:'logstash_stats_queue_events_count{namespace="'.concat(a,'",pod="').concat(r,'"}')}]},{targets:[{expr:'logstash_stats_jvm_threads_count{namespace="'.concat(a,'",pod="').concat(r,'"}')}]}]},getMonitoringCfgs:function(e){return[{title:t("OPENSEARCH_HEAP_MEMORY"),legend:[t("OPENSEARCH_HEAP_MEMORY_PER")],unit:"%",dot:2,data:[(0,o.default)(e,"1.data.result[0]",{})]},{title:t("OPENSEARCH_CPU_USAGE"),legend:[t("OPENSEARCH_CPU_USAGE_PER")],unit:"%",dot:2,data:[(0,o.default)(e,"2.data.result[0]",{})]},{title:t("CPU_LOAD"),legend:[t("CPU_LOAD1"),t("CPU_LOAD5"),t("CPU_LOAD15")],data:[(0,o.default)(e,"3.data.result[0]",{}),(0,o.default)(e,"4.data.result[0]",{}),(0,o.default)(e,"5.data.result[0]",{})]},{title:t("EVENTS_STATISTICS"),legend:[t("IN_EVENTS_STATISTICS"),t("FILTERED_EVENTS_STATISTICS"),t("OUT_EVENTS_STATISTICS")],data:[(0,o.default)(e,"6.data.result[0]",{}),(0,o.default)(e,"7.data.result[0]",{}),(0,o.default)(e,"8.data.result[0]",{})]},{title:t("QUEUE_EVENTS_COUNT"),legend:[t("QUEUE_EVENTS_COUNT")],data:[(0,o.default)(e,"9.data.result[0]",{})]},{title:t("JVM_THREADS_COUNT"),legend:[t("JVM_THREADS_COUNT")],data:[(0,o.default)(e,"10.data.result[0]",{})]}]}}};a.default=c},3983:function(e,t,a){e.exports={button:"_22FIaIAalrDvw6HPWCx4Ev",pieChartZone:"_1rJo533Xe-a4cxKBg2vbTM",pieChartCompose:"aBgq2MYPWuFtdzADvOyTZ"}},3984:function(e,t,a){"use strict";a(16);var r=a(19);a(3),Object.defineProperty(t,"__esModule",{value:!0}),t.mergerValues=void 0;var n=r(a(58));a(3),a(121);var o=r(a(3985)),c=r(a(4001)),s=r(a(119)),l=r(a(4002)),i=r(a(811));t.mergerValues=function(e){var t=(0,s.default)(e);return(0,o.default)(c.default,(function(e,t){return Array.isArray(e)?(0,l.default)(e.concat(t),i.default):e})).apply(void 0,(0,n.default)(t))}},4003:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(70),r(14),r(4),r(18),r(30),r(11),r(73),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(73),r(69);var o,c,s,l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(189),v=r(437),_=n(r(800)),g=n(r(807)),y=n(r(826)),E=n(r(833)),b=r(56),S=r(439),O=r(804),R=r(815),k=n(r(1671));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var A=(0,O.trigger)(o=(0,v.withRouter)((s=c=function(e){(0,u.default)(r,e);var a=C(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,i.default)(r,[{key:"getDescription",value:function(e){var a=(0,S.getWorkloadStatus)(e,e.module),r=a.status,n=a.reason;if(n)return p.default.createElement(E.default,{status:r,reason:t(n),data:e});var o=e.updateTime,c=e.createTime;return o?t("CREATED_AGO",{diff:(0,b.getLocalTime)(o).fromNow()}):t("CREATED_AGO",{diff:(0,b.getLocalTime)(c).fromNow()})}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.switchShowMonitor,n=e.app_id;if(!a)return null;var o=a.roleText,c=a.spec.cpu?a.spec.cpu.includes("m")?a.spec.cpu:"".concat(a.spec.cpu,"Core"):"-",s=a.status;return p.default.createElement(v.Link,{to:"".concat(this.prefix,"/").concat(a.name)},p.default.createElement("div",{className:k.default.item},p.default.createElement(_.default,{icon:"pod",title:a.name,description:this.getDescription({createTime:a.creationTimestamp})}),p.default.createElement(_.default,{title:p.default.createElement(g.default,{type:s,name:t(String(s).toUpperCase()),flicker:!0}),description:t("STATUS")}),p.default.createElement(_.default,{title:a.ip,description:t("POD_IP_ADDRESS_SCAP")}),n!==R.RadonDBAppId.ClickHouse&&p.default.createElement(_.default,{title:o,description:t("TYPE")}),p.default.createElement(_.default,{title:"".concat(c," ").concat(a.spec.memory),description:t("RESOURCES")}),p.default.createElement(_.default,{title:a.capacity,description:t("CAPACITY")}),a.noMonitoring?p.default.createElement("div",{className:k.default["monitor-btn"]}):p.default.createElement(_.default,{className:k.default["monitor-btn"],title:p.default.createElement(h.Button,{type:"flat",onClick:r},p.default.createElement(y.default,{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/cloudsat.svg",iconSize:16}))})))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace,n="/clusters/".concat(a,"/projects/").concat(r,"/pods");return t?"/".concat(t).concat(n):n}}]),r}(p.default.PureComponent),c.propTypes={className:m.default.string,detail:m.default.object,switchShowMonitor:m.default.func,deleteNode:m.default.func,app_id:m.default.string},c.defaultProps={detail:{}},o=s))||o)||o;a.default=A},4004:function(e,t,a){e.exports={overview:"_1fnEV5GTezTAO2J1NJCFKq",title:"_1guWoWd8H4DWntBkj9A5Ug",info:"_2j1zlhy-uQmfOtcORtrmV4",card:"SLCjWxnBFeiGgClaPx_D9",detail:"_1rmZebXPUOrP7hDWV7mYRf",label:"_3eI23drWQTHTOW8EZuzaRM",desc:"_3BhV772zHxeTa7HYP3bXsR"}},4005:function(e,a,r){"use strict";var n=r(19),o=r(162);r(12),r(3),r(10),r(6),r(36),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(46),r(69),r(1672),r(7),r(40),r(1084),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=n(r(38));r(35);var s=n(r(39)),l=n(r(317)),i=n(r(31)),u=n(r(25)),d=n(r(28)),f=n(r(41)),p=n(r(42)),m=n(r(37));r(12),r(32),r(3),r(10),r(6),r(36),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(46),r(69),r(977),r(1672),r(7),r(40),r(1084),r(1619),r(1620),r(1621),r(1622),r(1623);var h,v=n(r(0)),_=n(r(26)),g=n(r(4006)),y=r(189),E=n(r(191)),b=n(r(976)),S=o(r(806)),O=n(r(810)),R=n(r(4007)),k=n(r(1673)),C=r(1085),A=r(815),T=n(r(4008));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}function I(e){return e&&"string"==typeof e?e[0].toUpperCase()+e.substr(1):e}var w=(0,S.default)({store:new R.default,module:"applications",name:"USER",injectStores:["rootStore","detailStore"]})(h=function(e){(0,f.default)(r,e);var a=N(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).getColumns=function(){var a={title:t("USERNAME"),dataIndex:"name",render:function(e,t){return v.default.createElement(b.default,{avatar:(0,_.default)(t,"icon","/extensions-static/ks-console-embed/dist/v3dist/assets/default-user.svg"),iconLetter:e,iconSize:40,title:e,desc:t.desc})}},r=[a,{title:t("PASSWORD"),dataIndex:"password",render:function(){return v.default.createElement(k.default,null)}}];switch(e.props.detailStore.detail.app_id){case A.RadonDBAppId.RedisCluster:case A.RadonDBAppId.RedisSentinel:return[].concat(r,[{title:t("PERMISSIONS"),dataIndex:"permission",render:function(e){return v.default.createElement("div",null,t(e))}}]);case A.RadonDBAppId.MySQL:case A.RadonDBAppId.PostgreSQL:return[].concat(r,[{title:t("PERMISSIONS"),dataIndex:"permission",render:function(e){return v.default.createElement("div",null,t("".concat(e.toUpperCase(),"_PERMISSIONS")))}}]);case A.RadonDBAppId.Kafka:return[P(P({},a),{},{width:"20%"}),{title:t("AUTHENTICATION_MODE"),dataIndex:"authentication",render:function(a){return v.default.createElement("div",null,v.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/paper-work.svg",className:"icon",style:{width:"16px"}}),v.default.createElement("span",null,a.toUpperCase()),e.props.detailStore.detail.authentication!==a&&v.default.createElement(y.Tooltip,{content:v.default.createElement("b",null,t("AUTHENTICATION_MODE_INCORRECT_DESC"))},v.default.createElement(y.Icon,{style:{marginLeft:"4px"},name:"exclamation",size:16,color:{primary:"#ffffff",secondary:"#eaa944"}})))}},{title:t("SECRET_KEY"),dataIndex:"password",render:function(e,a){var r;return a.cert&&(r=(0,C.binaryStringToBlob)(a.cert.value)),a.cert?v.default.createElement(y.Tooltip,{closeAfterClick:!1,content:v.default.createElement("div",null,v.default.createElement("div",{className:T.default.bold},t("USER_CERTIFICATE")),v.default.createElement("div",null,v.default.createElement("span",{className:T.default.bold},t("CERTIFICATE"),t(": ")),v.default.createElement("span",null,a.name,".p12"),v.default.createElement("a",{className:T.default.bold,style:{marginLeft:"4px",color:"#329DCE"},href:URL.createObjectURL(r),download:"".concat(a.name,".p12")},t("DOWNLOAD"))),v.default.createElement("div",null,v.default.createElement("span",{className:T.default.bold},t("PASSWORD"),t(": ")),v.default.createElement(k.default,{password:e,color:{primary:"#ffffff"}})),v.default.createElement("div",null,v.default.createElement("span",{className:T.default.bold},t("VALIDITY_PERIOD"),t(": "),a.cert.validDate)))},v.default.createElement("span",null,v.default.createElement("img",{className:"icon",src:"/extensions-static/ks-console-embed/dist/v3dist/assets/certificates.svg",style:{width:"16px"}}),v.default.createElement("span",null,t("CA_CERTIFICATE")))):v.default.createElement(y.Tooltip,{closeAfterClick:!1,content:v.default.createElement("div",null,v.default.createElement("span",{className:T.default.bold},t("PASSWORD"),t(": ")),v.default.createElement(k.default,{password:e,color:{primary:"#ffffff"}}))},v.default.createElement("span",null,v.default.createElement(y.Icon,{name:"lock",size:16}),v.default.createElement(k.default,null)))}},{title:t("AUTHORIZATION_RULE"),dataIndex:"permissionRules",render:function(e){return v.default.createElement(y.Tooltip,{content:v.default.createElement("div",null,e.map((function(e,t){return v.default.createElement("div",null,v.default.createElement("b",null,"ACL ",t+1),v.default.createElement("div",null,I(e.type)," ",e.operation," ",I(e.resource.type),"",I(e.resource.patternType)," ",e.resource.name))}))),style:{top:"-8px"}},v.default.createElement("span",null,e.length," ACL",e.length>1?"s":""))}}];default:return r}},e.createAccount=function(){var a=P(P(P({},e.props.match.params),e.props.query),{},{app_id:e.props.detailStore.detail.app_id});return e.props.trigger("openpitrix.db.createAccount",P({icon:"human",title:t("CREATE_USER"),action:e.props.store.add,content:"".concat(t("CREATE_SUCCESSFUL")),nameReplicationValidator:e.props.store.checkUserName,authentication:e.props.detailStore.detail.authentication},a))},e.getData=function(t){var a=e.props.match.params.id;e.props.getData(P(P({},t),{},{cluster_id:a}))},e}return(0,d.default)(r,[{key:"getTableProps",value:function(){var e=this,a=this.props,r=a.tableProps,n=a.detailStore.detail,o=n.isRunning,c=n.authentication,s=n.app_id,l=[{key:"deploy",type:"control",text:t("CREATE"),action:"create",forbidden:!o,onClick:this.createAccount}];o||(l[0].tooltip={message:t("USERCREATION_NOT_ALLOWED"),placement:"bottom"});var i={key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){var a=r.data.filter((function(e){return e.root}));(0,g.default)(a,r.selectedRowKeys.map((function(e){return{name:e}})),"name").length>0?E.default.warning({content:t("CANNOT_DELETE_ROOT_USER")}):e.props.trigger("resource.batch.delete",P(P(P({once:!0,type:"USER",rowKey:r.rowKey},e.props.match.params),e.props.query),{},{success:function(){return e.getData(P(P({},e.props.match.params),e.props.query))}}))}};return{tableActions:P(P({},r.tableActions),{},{selectActions:o?[i]:[],actions:s!==A.RadonDBAppId.Kafka||c?l:[],onCreate:null}),emptyProps:{icon:"human",desc:s===A.RadonDBAppId.Kafka?c?t("KAFKA_NO_USER_DESC"):t("NO_AUTHENTICATION_DESC"):t("DATABASE_USERS_EMPTY_DESC")},searchType:"keyword"}}},{key:"componentWillUnmount",value:function(){this.props.store.clear()}},{key:"render",value:function(){var e=this.props.tableProps;return v.default.createElement("div",{className:T.default.account},v.default.createElement(S.ListPage,(0,l.default)({},this.props,{getData:this.getData,noWatch:!0}),v.default.createElement(O.default,(0,l.default)({},e,this.getTableProps(),{itemActions:this.itemActions,columns:this.getColumns(),alwaysUpdate:!0}))))}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.trigger,n=a.detailStore,o=a.store,l=n.detail,i=l.app_id,u=l.authentication;if(!n.detail.isRunning||i===A.RadonDBAppId.Kafka&&!u)return[];var d=P(P(P({},this.props.match.params),this.props.query),{},{app_id:i});return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:function(e){var a;r("openpitrix.db.createAccount",P({detail:e,title:t("EDIT_USER"),action:(a=(0,s.default)(c.default.mark((function a(r){return c.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.root){a.next=3;break}return E.default.warning({content:t("CANNOT_EDIT_ROOT_USER")}),a.abrupt("return");case 3:return a.next=5,o.edit(r);case 5:case"end":return a.stop()}}),a)}))),function(e){return a.apply(this,arguments)}),content:e.root?"":"".concat(t("MODIFY_SUCCESSFUL")),nameReplicationValidator:o.checkUserName,authentication:u},d))}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(a){a.root?E.default.warning({content:t("CANNOT_DELETE_ROOT_USER")}):r("resource.delete",{type:"USER",title:t("DELETE_USER"),detail:P(P({},a),d),store:e.props.store})}}]}}]),r}(v.default.Component))||h;a.default=w},4007:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(44),a(199),a(6),a(70),a(36),a(66),a(20),a(51),a(194),a(14),a(138),a(8),a(13),a(9),a(4),a(21),a(18),a(30),a(11),a(111),a(73),a(46),a(71),a(139),a(817),a(7),a(40),a(110),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(44),a(199),a(6),a(70),a(36),a(66),a(20),a(27),a(51),a(194),a(860),a(141),a(29),a(14),a(120),a(138),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(30),a(11),a(111),a(73),a(46),a(71),a(817),a(1013),a(7),a(40),a(1014),a(1015),a(1016),a(110);var n=r(a(50)),o=r(a(38));a(35);var c,s,l,i,u,d,f,p=r(a(39)),m=r(a(58)),h=r(a(31)),v=r(a(62)),_=r(a(25)),g=r(a(28)),y=r(a(74)),E=r(a(41)),b=r(a(42)),S=r(a(37)),O=r(a(45)),R=(r(a(63)),a(17)),k=r(a(26)),C=r(a(67)),A=r(a(457)),T=r(a(68)),D=r(a(196)),P=r(a(49)),N=a(324),I=a(56),w=a(815),x=a(934),M=a(992);function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){(0,h.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,S.default)(e);if(t){var n=(0,S.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,b.default)(this,a)}}var B='{"apiVersion":"mysql.radondb.com/v1alpha1","kind":"MysqlUser","metadata":{"name":"user-sample","labels":{}},"spec":{"user":"sample_user","hosts":["%"],"permissions":[{"database":"*","tables":["*"],"privileges":["SELECT"]}],"clusterBinder":{"clusterName":"sample","nameSpace":"default"},"secretBinder":{"secretName":"sample-user-password","secretKey":"pwdForSample"}}}',F=["ALTER","ALTER ROUTINE","CREATE","CREATE ROUTINE","CREATE TEMPORARY TABLES","CREATE VIEW","DELETE","DROP","EXECUTE","EVENT","INDEX","INSERT","LOCK TABLES","SELECT","SHOW VIEW","UPDATE","TRIGGER","REFERENCES"],Y=["ALTER","ALTER ROUTINE","CREATE","CREATE ROUTINE","CREATE TEMPORARY TABLES","CREATE VIEW","DELETE","DROP","EXECUTE","EVENT","INDEX","INSERT","LOCK TABLES","PROCESS","RELOAD","SELECT","SHOW DATABASES","SHOW VIEW","UPDATE","TRIGGER","REFERENCES"],V=(c=function(e){(0,E.default)(P,e);var t,a,r,c,h,b,S,O,R=U(P);function P(){var e;(0,_.default)(this,P);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=R.call.apply(R,[this].concat(a))).resourceName="db_user",e.app_id="",e.allUsers=[],e.getUrl=function(e){return(0,x.getManifestApi)(e)},(0,v.default)(e,"fetchList",s,(0,y.default)(e)),(0,v.default)(e,"checkUserName",l,(0,y.default)(e)),(0,v.default)(e,"add",i,(0,y.default)(e)),(0,v.default)(e,"edit",u,(0,y.default)(e)),(0,v.default)(e,"delete",d,(0,y.default)(e)),(0,v.default)(e,"batchDelete",f,(0,y.default)(e)),e.getPGUsersFromYaml=function(e){var t=(0,k.default)(e,"spec.postgresql.users.admin",[]).map((function(e){return j(j({},e),{},{permission:"Advanced"})})),a=(0,k.default)(e,"spec.postgresql.users.normal",[]).map((function(e){return j(j({},e),{},{permission:"General"})}));return[].concat((0,m.default)(t),(0,m.default)(a))},e.getMySQLSecretCrd=function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,n=a.namespace,c=a.cluster_id,t.next=3,request.get(e.getMySQLSecretUrl(r,n,c));case 3:return s=t.sent,t.abrupt("return",s);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.addMySQLSecret=function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c,s,l;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,n=a.namespace,c=a.yamlJSON,s=a.user,l=a.cluster_id,(0,T.default)(c,"data.".concat(s.name),(0,N.safeBtoa)(s.password)),t.next=4,request.put(e.getMySQLSecretUrl(r,n,l),c);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.deleteMySQLSecret=function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c,s,l;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,n=a.namespace,c=a.secretKeys,s=a.cluster_id,t.next=3,e.getMySQLSecretCrd({cluster:r,namespace:n,cluster_id:s});case 3:return l=t.sent,c.forEach((function(e){delete l.data[e]})),t.next=7,request.put(e.getMySQLSecretUrl(r,n,s),l);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getMySQLUserList=function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c,s,l;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,n=a.namespace,c=a.cluster_id,t.next=3,request.get("".concat(e.getMysqlUsersUrl(r,n),"?labelSelector=cluster_id=").concat(c));case 3:return s=t.sent,t.next=6,e.getMySQLSecretCrd({cluster:r,namespace:n,cluster_id:c});case 6:return l=t.sent,t.abrupt("return",s.items.filter((function(e){return"False"!==(0,k.default)(e,"status.conditions[0].status")})).map((function(e){return{name:(0,k.default)(e,"spec.user"),host:(0,k.default)(e,"spec.hosts").join(","),database:(0,k.default)(e,"spec.permissions[0].database"),permission:(0,k.default)(e,"spec.permissions[0].privileges",[]).length===Y.length?"Advanced":"General",password:(0,N.safeAtob)(l.data[(0,k.default)(e,"spec.user")])}})));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.addMySQLUser=function(){var t=(0,p.default)(o.default.mark((function t(a,r){var n,c,s,l,i,u,d,f,m,h,v,_;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.cluster,c=a.cluster_id,s=a.namespace,l=a.user,i=l.name,u=l.permission,d=l.host,f=l.database,m="".concat(c,"---").concat(e.userNameToMetadataName(i)),h="".concat(e.getMysqlUsersUrl(n,s),"/").concat(m),v=JSON.parse(B),(0,T.default)(v,"metadata.name",m),(0,T.default)(v,"metadata.labels",{cluster_id:c}),(0,T.default)(v,"spec.user",i),(0,T.default)(v,"spec.hosts",d.split(",")),(0,T.default)(v,"spec.permissions[0].database",f),(0,T.default)(v,"spec.permissions[0].privileges","Advanced"===u?Y:F),(0,T.default)(v,"spec.withGrantOption","Advanced"===u),(0,T.default)(v,"spec.userOwner",{clusterName:c,nameSpace:s}),(0,T.default)(v,"spec.secretSelector",{secretName:e.getMySQLSecretName(c),secretKey:i}),r){t.next=18;break}return t.next=17,e.getMySQLSecretCrd({cluster:n,namespace:s,cluster_id:c});case 17:r=t.sent;case 18:return t.next=20,request.post(h,v);case 20:return t.next=22,e.addMySQLSecret({cluster:n,cluster_id:c,namespace:s,user:l,yamlJSON:r});case 22:return _=0,t.next=25,new Promise((function(t,a){var r=setInterval((0,p.default)(o.default.mark((function i(){var u,d;return o.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,request.get(h);case 2:if(u=o.sent,d=(0,k.default)(u,"status.conditions[0].status"),_++,!("False"===d||_>50)){o.next=12;break}return clearInterval(r),o.next=9,e.deleteMySQLUser({cluster:n,namespace:s,cluster_id:c,users:[l]});case 9:a({message:"Create Failed"}),o.next=13;break;case 12:"True"===d&&(clearInterval(r),t());case 13:case"end":return o.stop()}}),i)}))),200)}));case 25:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.deleteMySQLUser=function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c,s,l,i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,n=a.namespace,c=a.cluster_id,s=a.users,l=[],i=[],s.forEach((function(t){l.push(request.delete("".concat(e.getMysqlUsersUrl(r,n),"/").concat(c,"---").concat(e.userNameToMetadataName(t.name)))),i.push(t.name)})),t.next=6,Promise.all(l);case 6:return t.next=8,e.deleteMySQLSecret({cluster:r,namespace:n,cluster_id:c,secretKeys:i});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.editMySQLUser=function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c,s,l;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,n=a.cluster_id,c=a.namespace,s=a.user,l=a.oldUser,t.next=3,e.deleteMySQLUser({cluster:r,cluster_id:n,namespace:c,users:[l]});case 3:return t.next=5,e.addMySQLUser({cluster:r,cluster_id:n,namespace:c,user:s});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getRedisUserList=function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,request.get(e.getRedisUsersUrl(a));case 2:return r=t.sent,n=(0,k.default)(r,'data["aclfile.conf"]',""),t.abrupt("return",e.getUsersFromRedisText(n));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return(0,g.default)(P,[{key:"updateList",value:(O=(0,p.default)(o.default.mark((function e(t){var a,r,n,c,s,l,i,u,d,f,p=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=p.length>1&&void 0!==p[1]?p[1]:{},r=JSON.parse(t.customResource),n=a.page,c=void 0===n?1:n,s=a.limit,l=void 0===s?10:s,i=a.keyword,u=a.namespace,this.app_id=(0,w.getAppIdByKind)(r.kind),d=[],e.t0=this.app_id,e.next=e.t0===w.RadonDBAppId.ClickHouse?8:e.t0===w.RadonDBAppId.PostgreSQL?11:e.t0===w.RadonDBAppId.MySQL?13:e.t0===w.RadonDBAppId.RedisCluster||e.t0===w.RadonDBAppId.RedisSentinel?17:e.t0===w.RadonDBAppId.Kafka?21:25;break;case 8:return f=(0,k.default)(r,"spec.configuration.users",{}),d=Object.keys(f).filter((function(e){return e.endsWith("/password")})).map((function(e){var t=e.replace("/password","");return{name:t,password:f[e],ip:(0,k.default)(f,"".concat(t,"/networks/ip.[0]")),network:(0,k.default)(f,"".concat(t,"/networks/ip.[1]")),namespace:u}})),e.abrupt("break",26);case 11:return d=this.getPGUsersFromYaml(r),e.abrupt("break",26);case 13:return e.next=15,this.getMySQLUserList(a);case 15:return d=e.sent,e.abrupt("break",26);case 17:return e.next=19,this.getRedisUserList(a);case 19:return d=e.sent,e.abrupt("break",26);case 21:return e.next=23,this.getKafkaUserList(a);case 23:return d=e.sent,e.abrupt("break",26);case 25:return e.abrupt("break",26);case 26:this.allUsers=d.slice(),i&&(d=d.filter((function(e){return e.name.includes(i)}))),Object.assign(this.list,{data:d.slice((c-1)*l,c*l),total:d.length,isLoading:!1,limit:l,page:c,filters:i?{keyword:i}:{},selectedRowKeys:[]});case 29:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"addUserToYamlJSON",value:function(e,t,a){var r=e.name,n=e.password,o=e.network,c=void 0===o?"::/0":o,s=e.ip,l=void 0===s?"127.0.0.1":s,i=e.permission;switch(a){case w.RadonDBAppId.ClickHouse:var u=(0,k.default)(t,"spec.configuration.users",{});return u["".concat(r,"/networks/ip")]=[l,c],u["".concat(r,"/password")]=n,u["".concat(r,"/profile")]="default",u["".concat(r,"/quotas")]="default",t;case w.RadonDBAppId.PostgreSQL:var d={name:r,password:n},f=(0,k.default)(t,"spec.postgresql.users",{admin:[],normal:[]});return"Advanced"===i?f.admin.push(d):f.normal.push(d),(0,T.default)(t,"spec.postgresql.users",f),t;default:return t}}},{key:"deleteUserFromYamlJSON",value:function(e,t,a){var r=e.name;switch(a){case w.RadonDBAppId.ClickHouse:var n=(0,k.default)(t,"spec.configuration.users",{}),o=["/networks/ip","/password","/profile","/quotas"],c=(0,A.default)(n,(function(e,t){return o.map((function(e){return r+e})).includes(t)}));return(0,T.default)(t,"spec.configuration.users",c),t;case w.RadonDBAppId.PostgreSQL:var s=[],l=(s="Advanced"===e.permission?(0,k.default)(t,"spec.postgresql.users.admin",[]):(0,k.default)(t,"spec.postgresql.users.normal",[])).findIndex((function(t){return t.name===e.name}));return l>-1&&s.splice(l,1),t;default:return t}}},{key:"getSecretUrl",value:function(e,t,a){return"/api".concat(globals.app.isMultiCluster&&e?"/clusters/".concat(e):"","/v1/namespaces/").concat(t,"/secrets/").concat(a)}},{key:"getMySQLSecretName",value:function(e){return"".concat(e,"-userpassword-secret")}},{key:"getMysqlUsersUrl",value:function(e,t){return"/apis".concat(globals.app.isMultiCluster&&e?"/clusters/".concat(e):"","/mysql.radondb.com/v1alpha1/namespaces/").concat(t,"/mysqlusers")}},{key:"getMySQLSecretUrl",value:function(e,t,a){return this.getSecretUrl(e,t,this.getMySQLSecretName(a))}},{key:"userNameToMetadataName",value:function(e){return e.toLowerCase().replace(/_/g,"-0-z")}},{key:"getRedisUsersUrl",value:function(e){var t=e.cluster,a=e.namespace,r=e.cluster_id;return"/api".concat(globals.app.isMultiCluster&&t?"/clusters/".concat(t):"","/v1/namespaces/").concat(a,"/configmaps/").concat(r,"-acl-config")}},{key:"getUsersFromRedisText",value:function(e){return e?e.split("\n").map((function(e){var t=e.trim().split(" ");return{name:(0,k.default)(t,"[1]"),password:(0,k.default)(t,"[3]","").substring(1),permission:t.slice(4).join(" ")}})):[]}},{key:"createRedisUserText",value:function(e){var t=e.name,a=e.password,r=e.permission,n=void 0===r?"~* &* +@all":r;return"user ".concat(t," on >").concat(a," ").concat(n)}},{key:"addRedisUser",value:(S=(0,p.default)(o.default.mark((function e(t){var a,r,c,s,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.user,r=(0,n.default)(t,["user"]),e.next=3,request.get(this.getRedisUsersUrl(r));case 3:return c=e.sent,s=(0,k.default)(c,'data["aclfile.conf"]',""),this.getUsersFromRedisText(s).find((function(e){return e.name===a.name}))||(l=this.createRedisUserText(a),(0,T.default)(c,'data["aclfile.conf"]',s?"".concat(l,"\n").concat(s):l)),e.next=10,request.put(this.getRedisUsersUrl(r),c);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"deleteRedisUsers",value:(b=(0,p.default)(o.default.mark((function e(t){var a,r,c,s,l=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.users,r=(0,n.default)(t,["users"]),e.next=3,request.get(this.getRedisUsersUrl(r));case 3:return c=e.sent,s=(0,k.default)(c,'data["aclfile.conf"]',""),a.forEach((function(e){var t=l.getUsersFromRedisText(s),a=s.split("\n"),r=t.findIndex((function(t){return t.name===e.name}));s&&r>-1&&(a.splice(r,1),s=a.join("\n"))})),(0,T.default)(c,'data["aclfile.conf"]',s),e.next=9,request.put(this.getRedisUsersUrl(r),c);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"editRedisUser",value:(h=(0,p.default)(o.default.mark((function e(t){var a,r,c,s,l,i,u,d;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.oldUser,a=t.user,r=(0,n.default)(t,["oldUser","user"]),e.next=3,request.get(this.getRedisUsersUrl(r));case 3:if(c=e.sent,s=(0,k.default)(c,'data["aclfile.conf"]',""),l=this.getUsersFromRedisText(s),i=l.findIndex((function(e){return e.name===a.name})),!(s&&i>-1)){e.next=15;break}return(u=s.split("\n")).splice(i,1),d=this.createRedisUserText(a),u.unshift(d),(0,T.default)(c,'data["aclfile.conf"]',u.join("\n")),e.next=15,request.put(this.getRedisUsersUrl(r),c);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getKafkaUserUrl",value:function(e){var t=e.cluster,a=e.namespace,r=e.name,n=e.cluster_id;return"/apis".concat(globals.app.isMultiCluster&&t?"/clusters/".concat(t):"","/kafka.strimzi.io/v1beta2/namespaces/").concat(a,"/kafkausers").concat(r?"/".concat(r):n?"?labelSelector=strimzi.io/cluster=".concat(n):"")}},{key:"getKafkaUserList",value:(c=(0,p.default)(o.default.mark((function e(t){var a,r,n=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,request.get(this.getKafkaUserUrl(t));case 2:return a=e.sent,e.next=5,Promise.all(a.items.map((function(e){return request.get(n.getSecretUrl(t.cluster,t.namespace,e.metadata.name))})));case 5:return r=e.sent,e.abrupt("return",a.items.map((function(e,t){var a=window.atob||N.safeAtob,n=a((0,k.default)(r,"[".concat(t,']data["user.p12"]'),"")),o=n?(0,k.default)(r,"[".concat(t,']data["user.password"]'),""):(0,k.default)(r,"[".concat(t,"]data.password"),"");return{name:e.metadata.name,password:a(o),authentication:e.spec.authentication.type,authorization:e.spec.authorization.type,permissionRules:e.spec.authorization.acls,kafkaUserConfig:(0,k.default)(e,"spec.quotas",{}),cert:n?{value:n,validDate:(0,I.getLocalTime)(e.metadata.creationTimestamp).add(3650,"d").format("YYYY.MM.DD")}:null}})));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"addKafkaUser",value:(r=(0,p.default)(o.default.mark((function e(t){var a,r,c;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.user,r=(0,n.default)(t,["user"]),c=JSON.parse(JSON.stringify(M.kafkaYaml.user)),(0,T.default)(c,"metadata.name",a.name),(0,T.default)(c,'metadata.labels["strimzi.io/cluster"]',r.cluster_id),(0,T.default)(c,"spec.authentication",{type:a.authentication}),(0,T.default)(c,"spec.authorization",{type:a.authorization,acls:a.permissionRules.map((function(e){return j(j({},e),{},{host:"*"})}))}),(0,C.default)(a.kafkaUserConfig)?(0,D.default)(c,"spec.quotas"):(0,T.default)(c,"spec.quotas",a.kafkaUserConfig),delete r.cluster_id,e.next=10,request.post(this.getKafkaUserUrl(r),c);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"editKafkaUser",value:(a=(0,p.default)(o.default.mark((function e(t){var a,r,c,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.user,r=t.oldUser,c=(0,n.default)(t,["user","oldUser"]),a.name===r.name){e.next=7;break}return e.next=4,this.deleteKafkaUsers(j({users:[r]},c));case 4:return e.next=6,this.addKafkaUser(j({user:a},c));case 6:return e.abrupt("return");case 7:return e.next=9,request.get(this.getKafkaUserUrl(j({name:a.name},c)));case 9:return s=e.sent,(0,T.default)(s,"spec.authentication",{type:a.authentication}),(0,T.default)(s,"spec.authorization",{type:a.authorization,acls:a.permissionRules.map((function(e){return j(j({},e),{},{host:"*"})}))}),(0,C.default)(a.kafkaUserConfig)?(0,D.default)(s,"spec.quotas"):(0,T.default)(s,"spec.quotas",a.kafkaUserConfig),e.next=15,request.put(this.getKafkaUserUrl(j({name:a.name},c)),s);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"deleteKafkaUsers",value:(t=(0,p.default)(o.default.mark((function e(t){var a,r,c=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.users,r=(0,n.default)(t,["users"]),e.next=3,Promise.all(a.map((function(e){return request.delete(c.getKafkaUserUrl(j(j({},r),{},{name:e.name})))})));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),P}(P.default),s=(0,O.default)(c.prototype,"fetchList",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,p.default)(o.default.mark((function t(a){var r;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.list.isLoading=!0,t.next=3,request.get(e.getUrl(a));case 3:return r=t.sent,t.next=6,e.updateList(r,a);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),l=(0,O.default)(c.prototype,"checkUserName",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){return t===a||!e.allUsers.find((function(e){return e.name===t}))}}}),i=(0,O.default)(c.prototype,"add",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c,s,l;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,request.get(e.getUrl(a));case 2:r=t.sent,n=JSON.parse(r.customResource),t.t0=a.app_id,t.next=t.t0===w.RadonDBAppId.MySQL?7:t.t0===w.RadonDBAppId.RedisCluster||t.t0===w.RadonDBAppId.RedisSentinel?17:t.t0===w.RadonDBAppId.Kafka?22:36;break;case 7:return c=a.user.name,t.next=10,e.getMySQLSecretCrd(a);case 10:if((s=t.sent).data&&s.data[c]){t.next=16;break}return t.next=14,e.addMySQLUser(a,s);case 14:return t.next=16,e.updateList(r,a);case 16:return t.abrupt("break",44);case 17:return t.next=19,e.addRedisUser(a);case 19:return t.next=21,e.updateList(r,a);case 21:return t.abrupt("break",44);case 22:return t.next=24,e.addKafkaUser(a);case 24:return t.prev=24,(0,T.default)(window,"globals.config.enableErrorNotify",!1),t.next=28,e.updateList(r,a);case 28:t.next=34;break;case 30:return t.prev=30,t.t1=t.catch(24),t.next=34,new Promise((function(t,n){setTimeout((function(){(0,T.default)(window,"globals.config.enableErrorNotify",!0),e.updateList(r,a).then((function(){t()}),(function(e){return n(e)}))}),2e3)}));case 34:return(0,T.default)(window,"globals.config.enableErrorNotify",!0),t.abrupt("break",44);case 36:return l=e.addUserToYamlJSON(a.user,n,e.app_id),r.customResource=JSON.stringify(l),r.version+=1,t.next=41,request.put(e.getUrl(a),r);case 41:return t.next=43,e.updateList(r,a);case 43:return t.abrupt("break",44);case 44:case"end":return t.stop()}}),t,null,[[24,30]])})));return function(e){return t.apply(this,arguments)}}()}}),u=(0,O.default)(c.prototype,"edit",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,request.get(e.getUrl(a));case 2:r=t.sent,t.t0=e.app_id,t.next=t.t0===w.RadonDBAppId.MySQL?6:t.t0===w.RadonDBAppId.RedisCluster||t.t0===w.RadonDBAppId.RedisSentinel?11:t.t0===w.RadonDBAppId.Kafka?16:21;break;case 6:return t.next=8,e.editMySQLUser(a);case 8:return t.next=10,e.updateList(r,a);case 10:return t.abrupt("break",31);case 11:return t.next=13,e.editRedisUser(a);case 13:return t.next=15,e.updateList(r,a);case 15:return t.abrupt("break",31);case 16:return t.next=18,e.editKafkaUser(a);case 18:return t.next=20,e.updateList(r,a);case 20:return t.abrupt("break",31);case 21:return n=JSON.parse(r.customResource),n,c=e.addUserToYamlJSON(a.user,e.deleteUserFromYamlJSON(a.oldUser,n,e.app_id),e.app_id),r.customResource=JSON.stringify(c),r.version+=1,t.next=28,request.put(e.getUrl(a),r);case 28:return t.next=30,e.updateList(r,a);case 30:return t.abrupt("break",31);case 31:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),d=(0,O.default)(c.prototype,"delete",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,p.default)(o.default.mark((function t(a){var r,n,c;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,request.get(e.getUrl(a));case 2:r=t.sent,t.t0=e.app_id,t.next=t.t0===w.RadonDBAppId.MySQL?6:t.t0===w.RadonDBAppId.RedisCluster||t.t0===w.RadonDBAppId.RedisSentinel?11:t.t0===w.RadonDBAppId.Kafka?16:22;break;case 6:return t.next=8,e.deleteMySQLUser(j(j({},a),{},{users:[a]}));case 8:return t.next=10,e.updateList(r,a);case 10:return t.abrupt("break",31);case 11:return t.next=13,e.deleteRedisUsers(j(j({},a),{},{users:[{name:a.name,password:a.password}]}));case 13:return t.next=15,e.updateList(r,a);case 15:return t.abrupt("break",31);case 16:return t.next=18,e.deleteKafkaUsers(j(j({},a),{},{users:[{name:a.name}]}));case 18:return delete a.name,t.next=21,e.updateList(r,a);case 21:return t.abrupt("break",31);case 22:return n=JSON.parse(r.customResource),c=e.deleteUserFromYamlJSON(a,n,e.app_id),r.customResource=JSON.stringify(c),r.version+=1,t.next=28,request.put(e.getUrl(a),r);case 28:return t.next=30,e.updateList(r,a);case 30:return t.abrupt("break",31);case 31:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),f=(0,O.default)(c.prototype,"batchDelete",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,p.default)(o.default.mark((function t(a){var r,c,s,l,i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.selectedItems,c=void 0===r?[]:r,s=(0,n.default)(a,["selectedItems"]),t.next=3,request.get(e.getUrl(s));case 3:l=t.sent,t.t0=e.app_id,t.next=t.t0===w.RadonDBAppId.MySQL?7:t.t0===w.RadonDBAppId.RedisCluster||t.t0===w.RadonDBAppId.RedisSentinel?12:t.t0===w.RadonDBAppId.Kafka?15:18;break;case 7:return t.next=9,e.deleteMySQLUser(j(j({},s),{},{users:c}));case 9:return t.next=11,e.updateList(l,s);case 11:return t.abrupt("break",27);case 12:return t.next=14,e.deleteRedisUsers(j(j({},s),{},{users:c}));case 14:return t.abrupt("break",27);case 15:return t.next=17,e.deleteKafkaUsers(j(j({},s),{},{users:c}));case 17:return t.abrupt("break",27);case 18:return i=JSON.parse(l.customResource),c.forEach((function(t){e.deleteUserFromYamlJSON(t,i,e.app_id)})),l.customResource=JSON.stringify(i),l.version+=1,t.next=24,request.put(e.getUrl(s),l);case 24:return t.next=26,e.updateList(l,s);case 26:return t.abrupt("break",27);case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),c);t.default=V},4008:function(e,t,a){e.exports={account:"_1HFVM35BYOkVoGpYanyH4V",bold:"_18QxU4dmDWA3adSzdgfON6"}},4009:function(e,a,r){"use strict";var n=r(19),o=r(162);r(12),r(3),r(10),r(44),r(6),r(70),r(51),r(14),r(193),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(197),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(27),r(51),r(29),r(14),r(193),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(197),r(7);var c=n(r(317)),s=n(r(38)),l=n(r(31)),i=n(r(50));r(35);var u,d=n(r(39)),f=n(r(25)),p=n(r(28)),m=n(r(41)),h=n(r(42)),v=n(r(37)),_=n(r(0)),g=n(r(26)),y=n(r(859)),E=n(r(191)),b=r(17),S=r(248),O=n(r(807)),R=o(r(806)),k=n(r(810)),C=r(56),A=n(r(1624)),T=r(815),D=n(r(331)),P=n(r(4010));function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var x={Creating:"CREATING",Success:"SUCCESSFUL",Failed:"FAILED"},M=(0,R.default)({store:new A.default,module:"applications",name:"BACKUP",injectStores:["rootStore","detailStore"]})(u=function(e){(0,m.default)(r,e);var a=w(r);function r(){var e;(0,f.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).state={appList:[]},e.websocket=new D.default,e.lastIsRunning=!0,e.getData=(0,y.default)((0,d.default)(s.default.mark((function t(){var a,r,n,o,c=arguments;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>0&&void 0!==c[0]?c[0]:{},r=a.silent,n=(0,i.default)(a,["silent"]),o=e.props.store,r&&(o.list.silent=!0),t.next=5,o.fetchList(I(I(I({},e.props.match.params),n),{},{app_id:e.props.detailStore.detail.app_id}));case 5:o.list.silent=!1;case 6:case"end":return t.stop()}}),t)}))),1e3),e.getColumns=function(){return[{title:t("NAME"),dataIndex:"name",minWidth:"20%"},{title:t("STATUS"),dataIndex:"status",render:function(a){var r=e.props.detailStore;return(0,g.default)(r,"detail.app_id")===T.RadonDBAppId.PostgreSQL?_.default.createElement(O.default,{flicker:!0,type:"available",name:t("AVAILABLE")}):_.default.createElement(O.default,{flicker:!0,type:a,name:t(x[a])})}},{title:t("SIZE_GIB"),dataIndex:"size",render:function(e){var t="-";return e&&(t="string"==typeof e?e:(e/1024/1024/1024).toFixed(2)),t},with:"120px"},{title:t("BACKUP_START_TIME"),dataIndex:"createAt",render:function(e){return e?(0,C.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:t("BACKUP_END_TIME"),dataIndex:"completeAt",render:function(e){return e?(0,C.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"):"-"}}]},e.showCreate=function(){var a=e.props,r=a.match,n=a.module,o=a.detailStore;return e.props.trigger("openpitrix.db.backup.create",{module:n,cluster:r.params.cluster,namespace:r.params.namespace,workspace:r.params.workspace,title:t("CREATE_BACKUP"),app_id:(0,g.default)(o,"detail.app_id"),cluster_id:r.params.id,image:(0,g.default)(o,"detail.sidecarImage"),success:function(){return e.getData((0,S.parse)(location.search.slice(1)))}})},e}return(0,p.default)(r,[{key:"componentDidMount",value:function(){var e=this;request.get("/kapis/application.kubesphere.io/v2/apps?orderBy=create_time&conditions=status%3Dactive%2Crepo_id%3Drepo-helm%2Ccategory_id%3Dradondb&reverse=true").then((function(t){e.setState({appList:t.items})})),this.isRunning=this.props.detailStore.detail.isRunning,this.initWebsocket()}},{key:"componentDidUpdate",value:function(){var e=this.props.detailStore.detail.isRunning;this.lastIsRunning!==e&&e&&this.getData((0,S.parse)(location.search.slice(1))),this.lastIsRunning=e}},{key:"initWebsocket",value:function(){var e=this,t=this.props.match.params,a=t.cluster,r=t.namespace,n=t.id,o=this.props.store.getWatchListUrl({namespace:r,cluster_id:n,app_id:this.props.detailStore.detail.app_id,cluster:a});o&&r&&(this.websocket.watch(o),this.disposer=(0,b.reaction)((function(){return e.websocket.message}),(function(t){"Backup"===t.object.kind&&["ADDED","MODIFIED","DELETED"].includes(t.type)&&e.getData((0,S.parse)(location.search.slice(1)))})))}},{key:"getTableProps",value:function(){var e=this,a=this.props,r=a.tableProps,n=a.detailStore,o=a.store,c=a.name,s=this.canCreate?[{key:"deploy",type:"control",text:t("CREATE"),action:"create",forbidden:!n.detail.isRunning,onClick:this.showCreate}]:[];n.detail.isRunning||(s[0].tooltip={message:t("BACKUP_NOT_ALLOWED_DESC"),placement:(0,g.default)(o,"list.data.length")?"bottomRight":"bottom"});var l=(0,g.default)(n,"detail.app_id"),i={key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){e.props.trigger("resource.batch.delete",I(I({once:l===T.RadonDBAppId.PostgreSQL,type:c,rowKey:r.rowKey},e.props.match.params),{},{app_id:l}))}};return{tableActions:I(I({},r.tableActions),{},{selectActions:n.detail.isRunning?l===T.RadonDBAppId.PostgreSQL?[]:[i]:[],actions:s}),emptyProps:{desc:""},searchType:"keyword"}}},{key:"render",value:function(){var e=this.props.tableProps,t=this.itemActions;return _.default.createElement("div",{className:P.default.backup},_.default.createElement(R.ListPage,(0,c.default)({},this.props,{getData:this.getData,noWatch:!0}),_.default.createElement(k.default,(0,c.default)({},e,this.getTableProps(),{rowKey:"name",itemActions:t,columns:this.getColumns(),alwaysUpdate:!0}))))}},{key:"canCreate",get:function(){var e=this.props.match.params,t=e.cluster,a=e.namespace;return globals.app.hasPermission({cluster:t,project:a,module:"applications",action:"create"})}},{key:"itemActions",get:function(){var e=this,a=this.props,r=a.trigger,n=a.routing,o=a.match,c=a.module,s=a.name,l=a.detailStore,i=l.detail.app_id;return[{key:"edit",icon:"copy",text:t("RESTORE_FROM_BACKUP"),action:"edit",show:function(e){return"Success"===e.status},onClick:function(a){if("Success"===a.status){var n=(0,g.default)(l.detail,"spec.S3"),s=(0,g.default)(l.detail,"name");r("openpitrix.db.app.create",{module:c,app_id:i,detail:e.state.appList.find((function(e){return e.app_id===i})),namespace:o.params.namespace,cluster:o.params.cluster,workspace:o.params.workspace,routing:e.props.rootStore.routing,restoreParams:I(I({},a.restoreParams),{},{backupId:a.name,backupToS3Name:s,S3:n,databaseVersion:l.detail.databaseVersion,nodes:(0,g.default)(a,"nodes"),volume:(0,g.default)(a,"volume"),specifications:(0,g.default)(a,"specifications")}),trigger:r})}else E.default.warning({content:t("BACKUP_IN_PROGRESS_DESC")})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",show:function(){return i!==T.RadonDBAppId.PostgreSQL},onClick:function(t){return r("resource.delete",{type:s,detail:I(I(I({},t),o.params),{},{app_id:l.detail.app_id}),success:n.query,store:e.props.store})}}]}}]),r}(_.default.Component))||u;a.default=M},4010:function(e,t,a){e.exports={backup:"F5aUFXk3RQ-bylkMTo9ru"}},4011:function(e,a,r){"use strict";var n=r(19),o=r(162);r(12),r(3),r(10),r(44),r(6),r(20),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(197),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(197),r(7);var c=n(r(317)),s=n(r(38));r(35);var l,i=n(r(39)),u=n(r(31)),d=n(r(25)),f=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),_=r(189),g=n(r(191)),y=o(r(806)),E=n(r(810)),b=n(r(1625)),S=n(r(4012)),O=n(r(5)),R=n(r(1673)),k=r(815),C=n(r(68)),A=n(r(26)),T=n(r(163)),D=n(r(67)),P=r(248),N=r(4014),I=n(r(4015));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var L=(0,y.default)({store:new b.default,module:"applications",name:"PARAMETER",injectStores:["rootStore","detailStore"]})(l=function(e){(0,p.default)(r,e);var a=M(r);function r(){var e;(0,d.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).state={editMode:!1,data:{},nodeRole:"kafka"},e.getColumns=function(){var a={title:t("PARAMETER"),dataIndex:"name",width:"200px"},r={title:t("VALUE"),dataIndex:"value",width:"120px",render:function(a,r){var n=e.state,o=n.editMode,c=n.data;if(o)return"select"===r.type?r.disable?v.default.createElement(_.Input,{disabled:!0,value:a,style:{width:160}}):v.default.createElement(_.Select,{options:(r.options||[]).map((function(e){return x(x({},e),{},{label:"number"==typeof e.label?e.label:t(e.label)})})),value:(0,T.default)(c[r.key])?a:c[r.key],style:{width:160},onChange:e.handleChange(r.key)}):"number"==typeof a?v.default.createElement(S.default,{value:(0,T.default)(c[r.key])?a:c[r.key],onChange:e.handleChange(r.key),disabled:r.disable,integer:(0,A.default)(r,"integer",!0),style:{width:160},min:(0,A.default)(r,"range.min"),max:(0,A.default)(r,"range.max")}):v.default.createElement(_.Input,{value:(0,T.default)(c[r.key])?a:c[r.key],style:{width:160},disabled:r.disable,onChange:e.handleChange(r.key)});if(t(r.name)===t("PASSWORD"))return v.default.createElement(R.default,null);var s=String(a);return"select"===r.type&&(s=(0,A.default)((r.options||[]).find((function(e){return e.value===a})),"label",s)),v.default.createElement("div",null,s)}},n={title:t("DESCRIPTION"),dataIndex:"description",isHideable:!0,render:function(e){return v.default.createElement("pre",null,e)}},o={title:t("AUTO_RESTART"),dataIndex:"restart",width:"100px"},c={title:t("RANGE"),dataIndex:"range",width:"100px",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.min,a=e.max;return(0,T.default)(t)&&(0,T.default)(a)?null:v.default.createElement("div",null,"".concat((0,T.default)(t)?" ":t,"").concat((0,T.default)(a)?" ":a))}};switch(e.appId){case k.RadonDBAppId.ClickHouse:return[a,r,n,c];default:return[a,r,n,o,c]}},e.handleChange=function(t){return function(a){(0,C.default)(e.state.data,'["'.concat(t,'"]'),(0,A.default)(a,"target.value",a)),e.forceUpdate()}},e.editParameters=function(){e.setState({editMode:!0})},e.handleConfirm=(0,i.default)(s.default.mark((function a(){var r,n,o,c,l;return s.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.props.match.params,n=r.workspace,o=r.namespace,c=r.id,l=r.cluster,!(0,D.default)(e.state.data)){a.next=4;break}return e.handleCancel(),a.abrupt("return");case 4:return a.prev=4,a.next=7,e.props.store.updateParams({workspace:n,namespace:o,cluster_id:c,cluster:l,nodeRole:e.state.nodeRole,params:e.state.data});case 7:a.next=13;break;case 9:return a.prev=9,a.t0=a.catch(4),g.default.error({content:t(a.t0.message)}),a.abrupt("return");case 13:return e.handleCancel(),a.next=16,e.getData((0,P.parse)(location.search.slice(1)));case 16:g.default.success({content:t("MODIFY_SUCCESSFUL")});case 17:case"end":return a.stop()}}),a,null,[[4,9]])}))),e.handleCancel=function(){e.setState({editMode:!1,data:{}})},e.getData=function(t){var a=e.props.match.params,r=a.workspace,n=a.namespace,o=a.id,c=a.cluster;return e.props.store.fetchList(x(x({},t),{},{workspace:r,namespace:n,cluster:c,cluster_id:o,nodeRole:e.state.nodeRole}))},e.getEditTitle=function(){return v.default.createElement(_.Level,null,v.default.createElement(_.LevelLeft,null,v.default.createElement(_.Button,{type:"primary",onClick:e.handleConfirm},t("OK")),v.default.createElement(_.Button,{onClick:e.handleCancel},t("CANCEL"))))},e.rowClassName=function(e){return e.disable?"disable":""},e.handleNodeRoleChange=function(t){e.setState({data:{},nodeRole:t},(function(){e.getData()}))},e}return(0,f.default)(r,[{key:"getTableProps",value:function(){var e=this.props,a=e.tableProps,r=e.detailStore,n=this.canCreate?[{key:"edit",type:"default",text:t("EDIT"),forbidden:!r.detail.isRunning,onClick:this.editParameters}]:[];r.detail.isRunning||(n[0].tooltip={message:t("EDIT_NOT_ALLOWED"),placement:"bottomRight"});var o={tableActions:x(x({},a.tableActions),{},{actions:n,selectActions:null}),emptyProps:{desc:""},searchType:"keyword",alwaysUpdate:!0};return this.state.editMode&&(o.extraProps={title:this.getEditTitle(),rowClassName:this.rowClassName},o.hideHeader=!0),o}},{key:"getCustomFilter",value:function(){switch(this.appId){case k.RadonDBAppId.Kafka:return v.default.createElement(_.Select,{options:N.KafkaOptions,value:this.state.nodeRole,style:{width:200,marginRight:"12px"},onChange:this.handleNodeRoleChange});default:return null}}},{key:"render",value:function(){var e=this.props.tableProps;return v.default.createElement(y.ListPage,(0,c.default)({},this.props,{getData:this.getData,noWatch:!0}),v.default.createElement(E.default,(0,c.default)({},e,this.getTableProps(),{className:(0,O.default)({"params-table-edit":this.state.editMode},I.default.params),itemActions:[],columns:this.getColumns(),hideFooter:!0,customFilter:this.getCustomFilter()})))}},{key:"appId",get:function(){return this.props.store.app_id}},{key:"canCreate",get:function(){var e=this.props.match.params,t=e.cluster,a=e.namespace;return globals.app.hasPermission({cluster:t,project:a,module:"applications",action:"create"})}}]),r}(v.default.Component))||l;a.default=L},4012:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(88),a(24),a(8),a(13),a(9),a(4),a(18),a(11),a(79),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(88),a(27),a(29),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(79),a(7);var n=r(a(317)),o=r(a(31)),c=r(a(50)),s=r(a(25)),l=r(a(28)),i=r(a(41)),u=r(a(42)),d=r(a(37)),f=r(a(163)),p=r(a(67)),m=r(a(465)),h=r(a(808)),v=r(a(0)),_=r(a(1)),g=r(a(5)),y=a(189),E=r(a(4013));function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var R=function(e){(0,i.default)(a,e);var t=O(a);function a(){var e;(0,s.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).handleChange=function(t){var a=e.props,r=a.onChange,n=a.unit,o=a.max,c=a.integer,s=t.target.value;if(e.debounceHandleChange(s),(0,p.default)(s)||!c&&s.indexOf(".")>0&&-1==="".concat(e.props.value).indexOf(".")||"-"===s&&(0,p.default)(e.props.value))r(s);else{var l=Number(s);isNaN(l)||(!(0,f.default)(o)&&l>o&&(l=o),c||s.startsWith("0")&&!s.startsWith("0.")||l!==Number(s)||"".concat(l)===s||(l=s),!(0,f.default)(l)&&n&&(l="".concat(l).concat(n)),r&&r(l))}},e.debounceHandleChange=(0,h.default)((function(t){var a=e.props,r=a.onChange,n=a.unit,o=a.min,c=a.max,s=a.integer;if((0,p.default)(t)||!s&&t.indexOf(".")>0&&-1==="".concat(e.props.value).indexOf(".")||"-"===t&&(0,p.default)(e.props.value))r(t);else{var l=Number(t);isNaN(l)||(!(0,f.default)(o)&&l<o&&(l=o),!(0,f.default)(c)&&l>c&&(l=c),s||t.startsWith("0")&&!t.startsWith("0.")||l!==Number(t)||"".concat(l)===t||(l=t),!(0,f.default)(l)&&n&&(l="".concat(l).concat(n)),r&&r(l))}}),500),e}return(0,l.default)(a,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.unit,r=e.showUnit,o=e.value,s=e.defaultValue,l=(e.onChange,e.integer,(0,c.default)(e,["className","unit","showUnit","value","defaultValue","onChange","integer"])),i=(0,f.default)(o)?s:o;a&&(i=(0,m.default)(i,a));var u=S(S({type:"text"},l),{},{value:(0,f.default)(i)?"":i,onChange:this.handleChange});return a&&r?v.default.createElement("div",{className:(0,g.default)(t,E.default.withUnit)},v.default.createElement(y.Input,u),v.default.createElement("span",null,a)):v.default.createElement(y.Input,(0,n.default)({className:t},u))}}]),a}(v.default.Component);R.propTypes={unit:_.default.string,showUnit:_.default.bool,value:_.default.oneOfType([_.default.string,_.default.number]),defaultValue:_.default.oneOfType([_.default.string,_.default.number]),min:_.default.number,max:_.default.number,integer:_.default.bool,onChange:_.default.func},R.defaultProps={unit:"",showUnit:!1,integer:!1,onChange:function(){}};var k=R;t.default=k},4013:function(e,t,a){e.exports={withUnit:"_1xayErxJuaugCVf4OR8UQy"}},4014:function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.KafkaOptions=void 0;var o=n(r(826)),c=n(r(0)),s=[{label:c.default.createElement(c.default.Fragment,null,c.default.createElement(o.default,{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/radondb_kafka.svg",style:{width:"16px",marginRight:"4px"}}),c.default.createElement("span",null,t("KAFKA_PARAMETERS"))),value:"kafka"},{label:c.default.createElement(c.default.Fragment,null,c.default.createElement(o.default,{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/radondb_zookeeper.svg",style:{width:"16px",marginRight:"4px"}}),c.default.createElement("span",null,t("ZOOKEEPER_PARAMETERS"))),value:"zookeeper"}];a.KafkaOptions=s},4015:function(e,t,a){e.exports={params:"_3yNPbIt265kOjZ-_lOxYbf"}},4016:function(e,a,r){"use strict";(function(e){var n=r(19),o=r(162);r(12),r(109),r(3),r(192),r(10),r(6),r(70),r(88),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(192),r(10),r(6),r(70),r(88),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(73),r(69),r(7);var c=n(r(58)),s=n(r(317)),l=n(r(38)),i=n(r(31)),u=n(r(50));r(35);var d,f=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),_=n(r(37)),g=n(r(0)),y=n(r(26)),E=r(17),b=n(r(802)),S=n(r(807)),O=o(r(806)),R=n(r(810)),k=r(56),C=r(1674),A=r(878),T=n(r(1463)),D=n(r(4021)),P=n(r(4023));function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,_.default)(e);if(t){var n=(0,_.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var x=(0,O.default)({store:new T.default,module:"rules",authKey:"rulegroups",name:"ALERTING_POLICY",injectStores:["rootStore","detailStore"]})(d=function(a){(0,h.default)(n,a);var r=w(n);function n(){var e;(0,p.default)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=r.call.apply(r,[this].concat(o))).getData=(0,f.default)(l.default.mark((function t(){var a,r,n,o,c=arguments;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>0&&void 0!==c[0]?c[0]:{},r=a.silent,n=(0,u.default)(a,["silent"]),o=e.props.store,r&&(o.list.silent=!0),t.next=5,o.fetchList(I(I({},e.props.match.params),n));case 5:o.list.silent=!1;case 6:case"end":return t.stop()}}),t)}))),e.getColumns=function(){var a=e.props,r=a.getFilteredValue,n=a.match,o=n.url.substring(n.url.indexOf("/applications"),-1);return[{title:t("NAME"),dataIndex:"name",search:!0,render:function(e,t){return g.default.createElement(b.default,{avatar:"/extensions-static/ks-console-embed/dist/v3dist/assets/bell_gear_duotone.svg",title:(0,k.getDisplayName)(t),desc:t.description,className:P.default["table-icon"],to:"".concat(o,"/alert-rules/").concat(e)})}},{title:t("POLICY_STATUS"),dataIndex:"enable",filters:e.getEnableFilter(),filteredValue:r("enable"),isHideable:!0,search:!0,width:"16%",render:function(e,a){return g.default.createElement(S.default,{className:P.default.status_icon,type:a.enabled&&JSON.parse(a.enabled)?"active":"disabled",name:a.enabled&&JSON.parse(a.enabled)?t("ENABLED"):t("DISABLED")})}},{title:t("RULE_STATUS"),dataIndex:"state",search:!0,filters:e.getStatus(),isHideable:!0,width:"16%",render:function(e,t){return g.default.createElement(D.default,{rulesStats:t.rulesStats})}},{title:t("TIME_SPENT"),dataIndex:"evaluationTime",isHideable:!0,width:"12%",render:function(e){return g.default.createElement("span",null,"-"!==e?t("TIME_S",{num:e}):e)}},{title:t("RECENT_DETECT_TIME"),dataIndex:"lastEvaluation",isHideable:!0,width:"15.8%",render:function(e,t){var a=(0,y.default)(t._originDataWithStatus,"status.lastEvaluation");return g.default.createElement("span",null,a?(0,k.getLocalTime)(a).format("YYYY-MM-DD HH:mm:ss"):"-")}}]},e.showCreate=function(){var a=e.props,r=a.match,n=a.getData,o=a.module,c=a.detailStore;return e.props.trigger("alerting.policy.create",{module:o,cluster:r.params.cluster,namespace:r.params.namespace,title:t("CREATE_ALERTING_POLICY"),app_id:c.detail.app_id,cluster_id:r.params.id,success:n})},e}return(0,m.default)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params,t=e.cluster;!e.namespace&&this.props.store.fetchCount({cluster:t}),localStorage.setItem("alert-policy-detail-referrer",this.props.match.url)}},{key:"getStatus",value:function(){return C.ALERTING_STATUS.map((function(e){return{text:t("ALERT_RULE_".concat(e.toUpperCase())),value:e}}))}},{key:"getEnableFilter",value:function(){return[{text:t("ENABLED"),value:"true"},{text:t("DISABLED"),value:"false"}]}},{key:"getAlertingTypes",value:function(){return A.SEVERITY_LEVEL.map((function(e){return{text:t(e.label),value:e.value}}))}},{key:"render",value:function(){var e=this.props.tableProps;return g.default.createElement(O.ListPage,(0,s.default)({},this.props,{getData:this.getData,noWatch:!0}),g.default.createElement(R.default,(0,s.default)({},e,{rowKey:"name",itemActions:this.itemActions,columns:this.getColumns(),tableActions:this.tableActions})))}},{key:"itemActions",get:function(){var a=this,r=this.props,n=r.trigger,o=r.routing,c=r.match,s=r.name;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(r){n("alerting.baseinfo.edit",{detail:r,module:e,cluster:c.params.cluster,namespace:c.params.namespace,title:t("EDIT_ALERTING_POLICY"),success:a.getData})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return n("alerting.yaml.edit",{detail:e,cluster:c.params.cluster,namespace:c.params.namespace,title:t("EDIT_ALERTING_POLICY"),success:a.getData})}},{key:"editRule",icon:"wrench",text:t("EDIT_ALERT_RULES"),action:"edit",onClick:function(e){n("alerting.rule.edit",{detail:e,cluster:c.params.cluster,namespace:c.params.namespace,success:o.query})}},{key:"disablePolicy",icon:function(e){return JSON.parse(e.enabled)?"stop":"start"},text:function(e){return JSON.parse(e.enabled)?t("DISABLE"):t("ENABLE")},action:"edit",onClick:function(e){var a=JSON.parse(e.enabled);n("alerting.rule.update",{detail:e,cluster:c.params.cluster,namespace:c.params.namespace,resourceName:s,success:o.query,title:a?t("DISABLE_ALERTING_POLICY"):t("ENABLE_ALERTING_POLICY"),enabled:a})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return n("alerting.rule.delete",{name:s,cluster:c.params.cluster,namespace:c.params.namespace,detail:e,success:o.query})}}]}},{key:"tableActions",get:function(){var e=this.props,a=e.tableProps,r=e.getData,n=e.trigger,o=e.name,s=e.store,l=e.match,i=e.detailStore,u=(0,E.toJS)(s.list.data),d=(0,E.toJS)(s.list.selectedRowKeys),f=u.filter((function(e){return d.includes(e.name)})).every((function(e){return!JSON.parse(e.enabled)})),p=u.filter((function(e){return d.includes(e.name)})).every((function(e){return JSON.parse(e.enabled)})),m=[{key:"deploy",type:"control",text:t("CREATE"),action:"create",forbidden:!i.detail.isRunning,onClick:this.showCreate}];return i.detail.isRunning||(m[0].tooltip={message:t("ALERTING_POLICY_CREATION_NOT_ALLOWED"),placement:(0,y.default)(s,"list.data.length")?"bottomRight":"bottom"}),I(I({},a.tableActions),{},{actions:m,selectActions:[].concat((0,c.default)(a.tableActions.selectActions),[{key:"enable",text:t("ENABLE"),action:"edit",disabled:p,onClick:function(){n("alerting.rule.update",{resourceName:o,cluster:l.params.cluster,namespace:l.params.namespace,title:t("ENABLE_ALERTING_POLICY"),enabled:!1,success:r,batchMode:!0})}},{key:"disable",text:t("DISABLE"),action:"edit",disabled:f,onClick:function(){n("alerting.rule.update",{resourceName:o,cluster:l.params.cluster,namespace:l.params.namespace,title:t("DISABLE_ALERTING_POLICY"),enabled:!0,success:r,batchMode:!0})}}])})}}]),n}(g.default.Component))||d;a.default=x}).call(this,r(144)(e))},4017:function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.ALL_METRICS_CONFIG=t.RESOURCE_METRICS_CONFIG=void 0,a(12),a(10),a(6),a(27),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var n=r(a(31)),o=r(a(4018)),c=r(a(4019)),s=r(a(4020));function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={node:o.default,workload:c.default,pod:s.default};t.RESOURCE_METRICS_CONFIG=u;var d=i(i(i({},o.default),c.default),s.default);t.ALL_METRICS_CONFIG=d},4018:function(e,t,a){"use strict";a(16),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(878),n={"node:pod_abnormal:ratio{$1}":{label:"UNAVAILABLE_POD_RATIO",prefixIcon:"pod",ruleConfig:r.PERCENT_RULE_CONFIG},"node:pod_utilisation:ratio{$1}":{label:"POD_QUOTA_UTILIZATION_SCAP",prefixIcon:"pod",ruleConfig:r.PERCENT_RULE_CONFIG},"node:node_cpu_utilisation:avg1m{$1}":{label:"CPU_UTILIZATION_SCAP",prefixIcon:"cpu",ruleConfig:r.PERCENT_RULE_CONFIG},"node:load1:ratio{$1}":{label:"CPU_LOAD_1",prefixIcon:"cpu",ruleConfig:r.BASE_RULE_CONFIG},"node:load5:ratio{$1}":{label:"CPU_LOAD_5",prefixIcon:"cpu",ruleConfig:r.BASE_RULE_CONFIG},"node:load15:ratio{$1}":{label:"CPU_LOAD_15",prefixIcon:"cpu",ruleConfig:r.BASE_RULE_CONFIG},"node:node_memory_bytes_available:sum{$1}":{label:"MEMORY_AVAILABLE",prefixIcon:"memory",ruleConfig:r.DISK_RULE_CONFIG},"node:node_memory_utilisation:{$1}":{label:"MEMORY_UTILIZATION_SCAP",prefixIcon:"memory",ruleConfig:r.PERCENT_RULE_CONFIG},"node:disk_space_available:{$1}":{label:"DISK_SPACE_AVAILABLE",prefixIcon:"storage",ruleConfig:r.DISK_RULE_CONFIG},"node:disk_space_utilization:ratio{$1}":{label:"DISK_SPACE_UTILIZATION",prefixIcon:"storage",ruleConfig:r.PERCENT_RULE_CONFIG},"node:disk_inode_utilization:ratio{$1}":{label:"INODE_UTILIZATION",prefixIcon:"storage",ruleConfig:r.PERCENT_RULE_CONFIG},"node:data_volume_iops_reads:sum{$1}":{label:"DISK_READ_IOPS",prefixIcon:"storage",ruleConfig:r.BASE_RULE_CONFIG},"node:data_volume_iops_writes:sum{$1}":{label:"DISK_WRITE_IOPS",prefixIcon:"storage",ruleConfig:r.BASE_RULE_CONFIG},"node:data_volume_throughput_bytes_read:sum{$1}":{label:"DISK_READ_THROUGHPUT",prefixIcon:"storage",ruleConfig:r.THROUGHPUT_RULE_CONFIG},"node:data_volume_throughput_bytes_written:sum{$1}":{label:"DISK_WRITE_THROUGHPUT",prefixIcon:"storage",ruleConfig:r.THROUGHPUT_RULE_CONFIG},"node:node_net_bytes_transmitted:sum_irate{$1}":{label:"DATA_SEND_RATE",prefixIcon:"network",ruleConfig:r.BANDWIDTH_RULE_CONFIG},"node:node_net_bytes_received:sum_irate{$1}":{label:"DATA_RECEIVE_RATE",prefixIcon:"network",ruleConfig:r.BANDWIDTH_RULE_CONFIG}};t.default=n},4019:function(e,t,a){"use strict";a(16),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(878),n=(0,r.getBaseRuleConfig)({thresholds:{unit:"Kbps"}}),o={"namespace:workload_cpu_usage:sum{$1}":{label:"CPU_USAGE_SCAP",prefixIcon:"cpu",ruleConfig:r.CPU_RULE_CONFIG},"namespace:workload_memory_usage:sum{$1}":{label:"MEMORY_USAGE_SCAP",prefixIcon:"memory",ruleConfig:r.MEMORY_RULE_CONFIG},"namespace:workload_memory_usage_wo_cache:sum{$1}":{label:"MEMORY_USAGE_WO_CACHE_SCAP",prefixIcon:"memory",ruleConfig:r.MEMORY_RULE_CONFIG},"namespace:workload_net_bytes_transmitted:sum_irate{$1}":{label:"DATA_SEND_RATE",prefixIcon:"network",ruleConfig:n},"namespace:workload_net_bytes_received:sum_irate{$1}":{label:"DATA_RECEIVE_RATE",prefixIcon:"network",ruleConfig:n},"namespace:$2_unavailable_replicas:ratio{$1}":{label:"UNAVAILABLE_WORKLOAD_REPLICA_RATIO",prefixIcon:"backup",ruleConfig:r.PERCENT_RULE_CONFIG}};t.default=o},4020:function(e,t,a){"use strict";a(16),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(878),n=(0,r.getBaseRuleConfig)({thresholds:{unit:"Kbps"}}),o={pod_cpu_usage:{label:"CPU_USAGE_SCAP",prefixIcon:"cpu",ruleConfig:r.CPU_RULE_CONFIG},pod_cpu_utilisation:{label:"CPU_UTILIZATION_SCAP",prefixIcon:"cpu",ruleConfig:r.PERCENT_RULE_CONFIG},pod_memory_usage:{label:"MEMORY_USAGE_SCAP",prefixIcon:"memory",ruleConfig:r.MEMORY_RULE_CONFIG},pod_memory_usage_wo_cache:{label:"MEMORY_USAGE_WO_CACHE_SCAP",prefixIcon:"memory",ruleConfig:r.MEMORY_RULE_CONFIG},pod_memory_utilisation:{label:"MEMORY_UTILIZATION_SCAP",prefixIcon:"memory",ruleConfig:r.PERCENT_RULE_CONFIG},pod_net_bytes_transmitted:{label:"DATA_SEND_RATE",prefixIcon:"network",ruleConfig:n},pod_net_bytes_received:{label:"DATA_RECEIVE_RATE",prefixIcon:"network",ruleConfig:n}};t.default=o},4021:function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(99),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=n(r(31)),c=n(r(97));r(20),r(99);var s=n(r(0)),l=r(189),i=n(r(5)),u=n(r(4022)),d=function(e){var a=e.rulesStats,r={pending:t("ALERT_RULE_PENDING"),inactive:t("ALERT_RULE_INACTIVE"),firing:t("ALERT_RULE_FIRING"),disabled:t("DISABLED")},n=Object.entries(a).map((function(e){var t=(0,c.default)(e,2),a=t[0],n=t[1];return{label:r[a],type:a,value:n}}));return s.default.createElement(l.Tooltip,{content:s.default.createElement(s.default.Fragment,null,n.map((function(e,t){return s.default.createElement("div",{key:t,className:(0,i.default)(u.default.tipContent,[u.default[e.type]],(0,o.default)({},u.default.disabled,0===e.value))},s.default.createElement("span",null,e.label),s.default.createElement("span",null,e.value))}))),placement:"right"},s.default.createElement("ul",{className:u.default.statusBox},n.map((function(e,t){return s.default.createElement("li",{key:t,className:(0,i.default)([u.default["li-".concat(e.type)]],(0,o.default)({},u.default.iconDisabled,0===e.value))},e.value)}))))};a.default=d},4022:function(e,t,a){e.exports={statusBox:"_3-nUUNPdHf6nbcNilZpYRu",tipContent:"_3hWwCJ2aJ_CoClIJxwLD92","li-inactive":"qR0ICXRI_XTjTQpSmpQ30","li-pending":"mSNAp1UtzsfpxCLTnhS7r","li-firing":"_3-ibjgejpBZzHSyM9CLeFN","li-disabled":"_28ksGom3cFiMbDfJ69J2Sj",pending:"i0nzirrByxHGMEKshU2B8",inactive:"TSFq6Mn2U7nNIetXHhvbq",firing:"_3ZvlqZkrbQaAbCXIzga0Gz",disabled:"_2x-hssz0bLHxhscbkXhHRp",iconDisabled:"_1BJXzHjXw3Nt_eSzIZepU4"}},4023:function(e,t,a){e.exports={"table-icon":"_1ZDsG2UdrEfYAB3t_km53m",status_icon:"usLADWmbiVkW64AlURQPz"}},4024:function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(69),r(7);var o,c,s=n(r(58)),l=n(r(31)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(26)),v=r(55),_=r(243),g=r(189),y=n(r(1049)),E=n(r(1222)),b=n(r(1660)),S=r(815),O=n(r(4025));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var A=(o=(0,_.inject)("detailStore"),(0,v.withRouter)(c=o(c=(0,_.observer)(c=function(e){(0,d.default)(r,e);var a=C(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).store=new E.default,e.state={currentMonitorDbNode:null,nodeRole:"kafka"},e.MainLable={label:t("ALL_NODES"),value:"whole"},e.fetchData=function(){var t=e.props,a=t.match,r=t.detailStore.detail.app_id;e.store.fetchList({namespace:a.params.namespace,cluster:a.params.cluster,chi:a.params.id,app_id:r}).then((function(){e.setState({currentMonitorDbNode:e.store.data.find((function(t){return t.name===(0,h.default)(e.nodesOptions,"[0].value")}))})}))},e.switchItemShowMonitor=function(t){var a=e.store.data.find((function(e){return e.name===t}));a?e.setState({currentMonitorDbNode:a,nodeRole:(0,h.default)(a,"nodeRole","")}):e.setState({currentMonitorDbNode:a,nodeRole:t})},e}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"switchShowMonitor",value:function(e){this.setState(k(k({},this.state),{},{isShowMonitor:e}))}},{key:"render",value:function(){var e=this.state.currentMonitorDbNode,a=this.store.data.filter((function(e){return!e.noMonitoring})).length,r=(0,h.default)(this.nodesOptions,"[0].value"),n=(0,h.default)(e,"name")||("whole"===r?r:this.state.nodeRole);return m.default.createElement("div",null,this.store.isLoading?m.default.createElement(g.Loading,{className:O.default.loading}):e||!e&&a!==this.nodesOptions.length?m.default.createElement(b.default,{monitorDbNode:e,nodeRole:this.state.nodeRole,customSelect:m.default.createElement(g.Select,{className:O.default.pods,prefixIcon:m.default.createElement(g.Icon,{name:"pod"}),options:this.nodesOptions,value:n,onChange:this.switchItemShowMonitor})}):m.default.createElement(y.default,{title:t("NO_MONITORING_DATA"),module:"monitor",desc:""}))}},{key:"needMainAppId",get:function(){return[S.RadonDBAppId.Elasticsearch,S.RadonDBAppId.OpenSearch]}},{key:"nodesOptions",get:function(){var e=this.props.detailStore.detail.app_id,a=this.store.data.filter((function(e){return!e.noMonitoring})).map((function(e){return{label:e.name,value:e.name}}));if(a.length>0){if(this.needMainAppId.includes(e))return[this.MainLable].concat((0,s.default)(a.map((function(e){return k(k({},e),{},{label:e.label})}))));if(e===S.RadonDBAppId.Kafka)return[{label:t("ALL_KAFKA_NODES"),value:"kafka"},{label:t("ALL_ZOOKEEPER_NODES"),value:"zookeeper"}].concat((0,s.default)(a.map((function(e){return k(k({},e),{},{label:e.label})}))))}return a}}]),r}(m.default.Component))||c)||c)||c);a.default=A},4025:function(e,t,a){e.exports={loading:"_2rHsiQmBSPxEv5ZYKWM2Na",pods:"_2x_UjL9AEVUgL7SJ1CJbqZ"}},4026:function(e,a,r){"use strict";var n=r(19),o=r(162);r(12),r(10),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(7);var c=n(r(317)),s=n(r(38)),l=n(r(31)),i=n(r(50));r(35);var u,d=n(r(39)),f=n(r(25)),p=n(r(28)),m=n(r(41)),h=n(r(42)),v=n(r(37)),_=n(r(0)),g=n(r(26)),y=n(r(859)),E=r(17),b=n(r(807)),S=o(r(806)),O=n(r(810)),R=r(56),k=r(1674),C=r(878),A=n(r(4027)),T=n(r(331)),D=n(r(4028));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var w=(0,S.default)({store:new A.default,module:"applications",injectStores:["rootStore","detailStore"]})(u=function(e){(0,m.default)(r,e);var a=I(r);function r(e){var n;return(0,f.default)(this,r),(n=a.call(this,e)).getData=(0,d.default)(s.default.mark((function e(){var t,a,r,o,c=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},a=t.silent,r=(0,i.default)(t,["silent"]),o=n.props.store,a&&(o.list.silent=!0),e.next=5,o.fetchList(N(N({},n.props.match.params),r));case 5:o.list.silent=!1;case 6:case"end":return e.stop()}}),e)}))),n.throttleGetData=(0,y.default)(n.getData,1e3),n.getColumns=function(){return[{title:t("NAME"),dataIndex:"name",width:200},{title:t("STATUS"),dataIndex:"status",render:function(e){return _.default.createElement(b.default,{type:e,name:t(e),flicker:!0})}},{title:t("PARTITION_COUNT"),dataIndex:"partitions"},{title:t("REPLICA_COUNT"),dataIndex:"replicas"},{title:t("MESSAGE_RETENTION_TIME"),dataIndex:'config["retention.ms"]',render:function(e){return e?_.default.createElement("span",null,e,"ms"):"-"}},{title:t("CREATION_TIME"),dataIndex:"creationTimestamp",render:function(e){return e?(0,R.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"):"-"}}]},n.showCreate=function(){var e=n.props,a=e.match,r=e.getData,o=e.store,c=e.detailStore;return n.props.trigger("openpitrix.db.topic.create",{store:o,cluster:a.params.cluster,namespace:a.params.namespace,title:t("CREATE_TOPIC"),app_id:(0,g.default)(c,"detail.app_id"),kafkaReplicas:(0,g.default)(c,"detail.nodes.kafka"),cluster_id:a.params.id,success:r})},n.websocket=new T.default,n.initWebsocket(),n}return(0,p.default)(r,[{key:"initWebsocket",value:function(){var e=this,t=this.props.match.params,a=t.cluster,r=t.namespace,n=t.id,o=this.props.store.getWatchListUrl({namespace:r,cluster:a,cluster_id:n});o&&r&&(this.websocket.watch(o),this.disposer=(0,E.reaction)((function(){return e.websocket.message}),(function(t){"KafkaTopic"===t.object.kind&&["MODIFIED","DELETED","ADDED"].includes(t.type)&&e.throttleGetData()})))}},{key:"getStatus",value:function(){return k.ALERTING_STATUS.map((function(e){return{text:t("ALERT_RULE_".concat(e.toUpperCase())),value:e}}))}},{key:"getAlertingTypes",value:function(){return C.SEVERITY_LEVEL.map((function(e){return{text:t(e.label),value:e.value}}))}},{key:"getTableProps",value:function(){var e=this,a=this.props,r=a.tableProps,n=a.detailStore,o=a.store,c=[{key:"deploy",type:"control",text:t("CREATE"),action:"create",forbidden:!n.detail.isRunning,onClick:this.showCreate}];n.detail.isRunning||(c[0].tooltip={message:t("TOPIC_CREATION_NOT_ALLOWED"),placement:(0,g.default)(o,"list.data.length")?"bottomRight":"bottom"});var s=[{key:"delete",type:"danger",text:t("DELETE"),action:"delete",onClick:function(){return e.props.trigger("resource.batch.delete",N(N({type:"APP",rowKey:r.rowKey,success:e.getData},e.props.match.params),e.props.query))}}];return{tableActions:N(N({},r.tableActions),{},{selectActions:[],actions:c}),selectActions:s,emptyProps:{title:t("NO_TOPIC_FOUND"),icon:"record",desc:t("TOPIC_EMPTY_DESC")},searchType:"keyword"}}},{key:"render",value:function(){var e=this.props.tableProps,t=this.itemActions;return _.default.createElement("div",{className:D.default.policy},_.default.createElement(S.ListPage,(0,c.default)({},this.props,{getData:this.getData,noWatch:!0}),_.default.createElement(O.default,(0,c.default)({},e,this.getTableProps(),{rowKey:"name",itemActions:t,columns:this.getColumns()}))))}},{key:"itemActions",get:function(){var e=this.props,a=e.trigger,r=e.routing,n=e.match,o=e.getData,c=e.name,s=e.store,l=e.detailStore;return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:function(e){var r=e.name,c=e.partitions,i=e.replicas,u=e.config;return a("openpitrix.db.topic.create",{cluster:n.params.cluster,namespace:n.params.namespace,title:t("EDIT_TOPIC"),detail:N({name:r,partitions:c,replicas:i},u),kafkaReplicas:(0,g.default)(l,"detail.nodes.kafka"),isEdit:!0,store:s,success:o})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return a("resource.delete",{type:c,detail:e,success:r.query})}}]}}]),r}(_.default.Component))||u;a.default=w},4027:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(70),a(20),a(51),a(14),a(24),a(8),a(13),a(9),a(4),a(18),a(11),a(73),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(70),a(20),a(27),a(51),a(141),a(29),a(14),a(120),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(321),a(21),a(18),a(43),a(11),a(73),a(7);var n=r(a(38)),o=r(a(31)),c=r(a(50));a(35);var s,l,i=r(a(39)),u=r(a(62)),d=r(a(25)),f=r(a(28)),p=r(a(74)),m=r(a(41)),h=r(a(42)),v=r(a(37)),_=r(a(45)),g=(r(a(63)),r(a(26))),y=r(a(68)),E=a(17),b=r(a(49)),S=a(934),O=a(992);function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var A=(s=function(e){(0,m.default)(o,e);var t,a,r=C(o);function o(){var e;(0,d.default)(this,o);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return e=r.call.apply(r,[this].concat(a)),(0,u.default)(e,"targetsMetadata",l,(0,p.default)(e)),e.statusMap={"True-Ready":"Success","True-NotReady":"Failed"},e.getWatchListUrl=function(e){var t=e.cluster_id,a=e.cluster,r=e.namespace;return"/apis".concat(globals.app.isMultiCluster&&a?"/clusters/".concat(a):"","/kafka.strimzi.io/v1beta2/watch/namespaces/").concat(r,"/kafkatopics?labelSelector=strimzi.io/cluster=").concat(t)},e.getListUrl=function(e){var t=e.cluster,a=e.namespace,r=e.id;return"/apis".concat(globals.app.isMultiCluster&&t?"/clusters/".concat(t):"","/kafka.strimzi.io/v1beta2/namespaces/").concat(a,"/kafkatopics").concat(r?"?labelSelector=strimzi.io/cluster=".concat(r):"")},e.getResourceUrl=e.getListUrl,e}return(0,f.default)(o,[{key:"fetchList",value:(a=(0,i.default)(n.default.mark((function e(){var t,a,r,o,s,l,i,u,d,f,p,m,h,v=this,_=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.length>0&&void 0!==_[0]?_[0]:{},a=t.cluster,t.workspace,r=t.namespace,t.more,o=t.id,s=(0,c.default)(t,["cluster","workspace","namespace","more","id"]),l=s.page,i=void 0===l?1:l,u=s.limit,d=void 0===u?10:u,f=s.keyword,this.list.isLoading=!0,s.limit=s.limit||10,e.next=6,request.get(this.getResourceUrl({cluster:a,namespace:r,id:o}));case 6:return p=e.sent,m=((0,g.default)(p,"items")||[]).filter((function(e){return!f||e.metadata.name.includes(f)})).map((function(e){var t=(0,S.getStatusFromYaml)(e);return{cluster:a,namespace:r,name:(0,g.default)(e,"metadata.name"),partitions:(0,g.default)(e,"spec.partitions"),replicas:(0,g.default)(e,"spec.replicas"),config:(0,g.default)(e,"spec.config",{}),creationTimestamp:(0,g.default)(e,"metadata.creationTimestamp"),status:v.statusMap[t]||"Creating"}})),h=Number(p.total||m.length),this.list.update(k({data:m.slice((i-1)*d,i*d),total:h,limit:Number(d)||10,page:Number(i)||1,isLoading:!1,filters:f?{keyword:f}:{}},this.list.silent?{}:{selectedRowKeys:[]})),e.abrupt("return",m);case 11:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getYamlFromData",value:function(e,t){var a=t.cluster_id,r=JSON.parse(JSON.stringify(O.kafkaYaml.topic)),n=e.name,o=e.partitions,s=e.replicas,l=(0,c.default)(e,["name","partitions","replicas"]);return(0,y.default)(r,"metadata.name",n),(0,y.default)(r,'metadata.labels["strimzi.io/cluster"]',a),(0,y.default)(r,"spec",{partitions:parseInt(o,10),replicas:s,config:l}),r}},{key:"create",value:function(e){var t=e.topic,a=(0,c.default)(e,["topic"]),r=this.getYamlFromData(t,a);return request.post(this.getListUrl(a),r)}},{key:"edit",value:(t=(0,i.default)(n.default.mark((function e(t){var a,r,o,s,l,i,u,d,f;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.topic,r=t.oldTopicName,o=(0,c.default)(t,["topic","oldTopicName"]),s=a.name,l=a.partitions,a.replicas,i=(0,c.default)(a,["name","partitions","replicas"]),s!==r){e.next=13;break}return e.next=5,request.get(this.getDetailUrl(k(k({},o),{},{name:s})));case 5:return u=e.sent,d=(0,g.default)(u,"spec.config",{}),(0,y.default)(u,"spec.config",k(k({},d),i)),(0,y.default)(u,"spec.partitions",parseInt(l,10)),e.next=11,request.patch(this.getDetailUrl(k(k({},o),{},{name:s})),u);case 11:e.next=18;break;case 13:return f=this.getYamlFromData(a,o),e.next=16,this.delete(k(k({},o),{},{name:r}));case 16:return e.next=18,request.post(this.getListUrl(o),f);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),o}(b.default),l=(0,_.default)(s.prototype,"targetsMetadata",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,_.default)(s.prototype,"fetchList",[E.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchList"),s.prototype),(0,_.default)(s.prototype,"create",[E.action],Object.getOwnPropertyDescriptor(s.prototype,"create"),s.prototype),(0,_.default)(s.prototype,"edit",[E.action],Object.getOwnPropertyDescriptor(s.prototype,"edit"),s.prototype),s);t.default=A},4028:function(e,t,a){e.exports={policy:"_1CLMyM9L5Lqm9wNw2AdC16"}},4029:function(e,t,a){e.exports={icon:"_2TdY7G6Sm3yz4Ym6JmHf18",flexRow:"_2cqSWZz9wp2Tx2LFZcTIha"}},4030:function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(14),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(27),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=r(17),m=r(243),h=n(r(26)),v=n(r(67)),_=r(189),g=r(56),y=r(804),E=n(r(1597)),b=n(r(826)),S=n(r(807)),O=n(r(834)),R=n(r(4031)),k=n(r(4035));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var A=(0,m.inject)("rootStore","projectStore")(o=(0,m.observer)(o=(0,y.trigger)(o=function(e){(0,i.default)(r,e);var a=C(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).store=new E.default,e.fetchData=function(){var t=e.props.match.params;e.store.fetchDetail(t)},e.getOperations=function(){return[{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",type:"danger",onClick:function(){return e.trigger("resource.delete",{type:e.name,detail:e.store.detail,success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var a=(0,p.toJS)(e.store.detail),r=e.props.match.params,n=r.cluster,o=r.namespace;if(!(0,v.default)(a))return[{name:t("CLUSTER"),value:(0,g.showNameAndAlias)(n,"cluster")},{name:t("PROJECT"),value:(0,g.showNameAndAlias)(o,"project")},{name:t("STATUS"),value:e.renderStatus()},{name:t("APP"),value:(0,h.default)(a,"app.name","-")},{name:t("VERSION"),value:(0,h.default)(a,"version.name","-")},{name:t("CREATION_TIME_TCAP"),value:(0,g.getLocalTime)((0,h.default)(a,"create_time")).format("YYYY-MM-DD HH:mm:ss")},{name:t("UPDATE_TIME_TCAP"),value:(0,g.getLocalTime)((0,h.default)(a,"status_time")).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:a.owner}]},e.renderStatus=function(){var a=(0,p.toJS)(e.store.detail),r=a.status;return a.additional_info?f.default.createElement(_.Tooltip,{content:a.additional_info},f.default.createElement(S.default,{name:t(r),type:r})):f.default.createElement(S.default,{name:t(r),type:r})},e}return(0,l.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=(0,p.toJS)(this.store.detail),a={detailStore:this.store};if(this.store.isLoading&&!this.store.detail.name)return f.default.createElement(_.Loading,{className:"ks-page-loading"});var r={icon:f.default.createElement("label",{className:k.default.icon},f.default.createElement(b.default,{iconLetter:(0,h.default)(e,"app.name"),src:(0,h.default)(e,"app.icon"),alt:""})),module:this.module,name:(0,g.getDisplayName)(this.store.detail),desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("APP_PL"),url:this.listUrl}]};return f.default.createElement(O.default,(0,c.default)({stores:a},r,{routes:R.default}))}},{key:"module",get:function(){return"applications"}},{key:"name",get:function(){return"APP"}},{key:"listUrl",get:function(){var e=this.props.match.params,t=e.cluster,a=e.workspace,r=e.namespace;return"/".concat(a,"/clusters/").concat(t,"/projects/").concat(r,"/").concat(this.module,"/others")}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),r}(f.default.Component))||o)||o)||o;a.default=A},4031:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(318),o=r(a(4032)),c=r(a(4033)),s="/:workspace/clusters/:cluster/projects/:namespace/applications/others/:name",l=[{path:"".concat(s,"/resource-status"),name:"resource-status",title:"RESOURCE_STATUS",component:o.default,exact:!0},{path:"".concat(s,"/config"),title:"APP_SETTINGS",component:c.default,exact:!0},(0,n.getIndexRoute)({path:s,to:"".concat(s,"/resource-status"),exact:!0})];t.default=l},4032:function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(30),a(11),a(69);var n,o=r(a(25)),c=r(a(28)),s=r(a(41)),l=r(a(42)),i=r(a(37)),u=r(a(0)),d=a(243),f=r(a(1229)),p=r(a(1074)),m=r(a(1230)),h=r(a(1231));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var _=(0,d.inject)("detailStore")(n=(0,d.observer)(n=function(e){(0,s.default)(a,e);var t=v(a);function a(e){var r;return(0,o.default)(this,a),(r=t.call(this,e)).store=e.detailStore,r.module=e.module,r}return(0,c.default)(a,[{key:"render",value:function(){var e=this.store.detail,t=e.cluster,a=e.namespace,r=e.selector;return u.default.createElement(u.default.Fragment,null,u.default.createElement(m.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(f.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(p.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}),u.default.createElement(h.default,{selector:r,cluster:t,namespace:a,prefix:this.prefix}))}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r)}}]),a}(u.default.Component))||n)||n;t.default=_},4033:function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var o,c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=r(243),p=n(r(801)),m=n(r(838)),h=n(r(4034));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=(0,f.inject)("rootStore","detailStore")(o=(0,f.observer)(o=function(e){(0,l.default)(r,e);var a=v(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"render",value:function(){var e=this.store,a=e.isLoading,r=e.detail;return d.default.createElement(p.default,{title:t("APP_SETTINGS"),loading:a},d.default.createElement(m.default,{className:h.default.yaml,value:r.env||""}))}},{key:"store",get:function(){return this.props.detailStore}}]),r}(d.default.Component))||o)||o;a.default=_},4034:function(e,t,a){e.exports={yaml:"_1hH60eHxLLLnVycbTucOOv"}},4035:function(e,t,a){e.exports={icon:"_2KoJkVrpTJFXtxV0RBukan"}},4036:function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(70),r(88),r(14),r(4),r(18),r(30),r(11),r(73),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(70),r(88),r(27),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(73),r(69);var o,c=n(r(317)),s=n(r(25)),l=n(r(28)),i=n(r(41)),u=n(r(42)),d=n(r(37)),f=n(r(0)),p=r(17),m=r(243),h=n(r(67)),v=r(189),_=r(56),g=r(804),y=n(r(322)),E=n(r(834)),b=n(r(4037));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var O=(0,m.inject)("rootStore")(o=(0,m.observer)(o=(0,g.trigger)(o=function(e){(0,i.default)(r,e);var a=S(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).store=new y.default,e.fetchData=function(){e.store.fetchDetail(e.props.match.params)},e.getOperations=function(){var a=e.store.detail;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",show:e.showEdit,onClick:function(){return e.trigger("resource.baseinfo.edit",{type:e.name,detail:(0,p.toJS)(e.store.detail),success:e.fetchData})}},{key:"editRole",icon:"pen",text:t("EDIT_PERMISSIONS"),action:"edit",show:e.showEdit,onClick:function(){return e.trigger("role.edit",{module:e.module,detail:(0,p.toJS)(e.store.detail),roleTemplates:(0,p.toJS)(e.store.roleTemplates.data),basicRoleTemplates:(0,p.toJS)(e.store.basicRoleTemplates.data),roleModules:(0,p.toJS)(e.store.roleCategory),success:e.fetchData})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",type:"danger",show:e.showEdit,onClick:function(){return e.trigger("role.delete",{detail:a,type:e.name,cluster:e.props.match.params.cluster,namespace:e.props.match.params.namespace,success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var a=(0,p.toJS)(e.store.detail),r=e.props.match.params,n=r.cluster,o=r.namespace;if(!(0,h.default)(a))return[{name:t("CLUSTER"),value:n},{name:t("PROJECT"),value:o},{name:t("CREATION_TIME_TCAP"),value:(0,_.getLocalTime)(a.createTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("UPDATE_TIME_TCAP"),value:(0,_.getLocalTime)(a.updateTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:a.creator}]},e}return(0,l.default)(r,[{key:"componentDidMount",value:function(){this.fetchData(),this.store.fetchRoleTemplates("namespace","iam.kubesphere.io/scope=namespace,kubesphere.io/managed=true,iam.kubesphere.io/hidden-role-template!=true"),this.store.fetchBasicRoleTemplates("namespace","iam.kubesphere.io/scope=namespace,iam.kubesphere.io/basic-role-template=true,kubesphere.io/managed=true"),this.store.fetchTemplatesCategory("namespace")}},{key:"render",value:function(){var e={detailStore:this.store};if(this.store.isLoading&&!this.store.detail.name)return f.default.createElement(v.Loading,{className:"ks-page-loading"});var a={module:this.module,name:(0,_.getDisplayName)(this.store.detail),desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("PROJECT_ROLE_PL"),url:this.listUrl}]};return f.default.createElement(E.default,(0,c.default)({stores:e},a,{routes:(0,b.default)(this.props.match.path)}))}},{key:"module",get:function(){return"roles"}},{key:"name",get:function(){return"PROJECT_ROLE"}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"listUrl",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return-1!==this.props.match.url.indexOf("project-roles")?"/workspaces/".concat(t,"/project-roles"):"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r,"/").concat(this.module)}},{key:"showEdit",get:function(){var e=this.props.match.params.name;return!globals.config.presetRoles.includes(e)}}]),r}(f.default.Component))||o)||o)||o;a.default=O},4037:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(318),o=r(a(1075)),c=r(a(1076));t.default=function(e){return[{path:"".concat(e,"/authorizations"),title:"PERMISSION_PL",component:o.default,exact:!0},{path:"".concat(e,"/users"),title:"AUTHORIZED_USER_PL",component:c.default,exact:!0},(0,n.getIndexRoute)({path:e,to:"".concat(e,"/authorizations"),exact:!0})]}},4038:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(7);var o=n(r(317)),c=n(r(38)),s=n(r(31));r(35);var l,i=n(r(39)),u=n(r(25)),d=n(r(28)),f=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=r(17),_=r(243),g=n(r(26)),y=n(r(64)),E=r(189),b=n(r(191)),S=r(56),O=r(804),R=n(r(459)),k=n(r(482)),C=n(r(1557)),A=n(r(834)),T=r(1675),D=n(r(4042));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var w=(0,_.inject)("rootStore")(l=(0,_.observer)(l=(0,O.trigger)(l=function(e){(0,f.default)(r,e);var a=I(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=a.call.apply(a,[this].concat(o))).store=new R.default(e.module),e.resourceStore=new C.default(e.module),e.s2iRunStore=new k.default,e.fetchData=function(){var t=(0,i.default)(c.default.mark((function t(a){var r,n;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.store.fetchDetail(e.params,a);case 2:return r=t.sent,t.next=5,e.s2iRunStore.fetchRunDetail(N(N({},e.params),{},{runName:(0,g.default)(r,"status.lastRunName","")}));case 5:return n=t.sent,t.next=8,e.s2iRunStore.fetchJobDetail(N(N({},e.params),{},{name:(0,g.default)(n,"_originData.status.kubernetesJobName","")}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCopy=function(){b.default.success({content:t("COPIED_SUCCESSFUL")})},e.getOperations=function(){return[{key:"Run",text:t("RUN"),action:"edit",type:"control",onClick:function(){return e.trigger("imagebuilder.rerun",{detail:(0,v.toJS)(e.store.detail),success:e.fetchData})}},{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(){return e.trigger("resource.baseinfo.edit",{type:e.name,detail:(0,v.toJS)(e.store.detail),success:e.fetchData})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(){return e.trigger("resource.yaml.edit",{detail:e.store.detail,success:e.fetchData})}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",type:"danger",onClick:function(){return e.trigger("resource.delete",{type:e.name,detail:e.store.detail,success:function(){return e.routing.push(e.listUrl)}})}}]},e.pathAddCluster=function(e,t){var a=e.match(/(\/kapis|api|apis)(.*)/);return t&&"default"!==t&&(0,y.default)(a)?"".concat(a[1],"/clusters/").concat(t).concat(a[2]):e},e.getAttrs=function(){var a=(0,v.toJS)(e.store.detail),r=e.props.match.params.cluster,n=a.spec,o=void 0===n?{}:n,c=(0,g.default)(o,"config.isBinaryURL",""),s=e.s2iRunStore.runDetail.binaryName,l=(0,g.default)(o,"config.sourceUrl",""),i=(0,g.default)((0,S.parseUrl)(l),"pathname","/".concat(l)),u=e.pathAddCluster(i,r),d="".concat(window.location.protocol,"//").concat(window.location.host,"/b2i_download").concat(u),f=(0,g.default)(a,"spec.config.secretCode",""),p="http://s2ioperator-trigger-service.kubesphere-devops-system.svc/s2itrigger/v1alpha1/general/namespaces/".concat(a.namespace,"/s2ibuilders/").concat(a.name,"/").concat(f?"?secretCode=".concat(f):"");return[{name:t("NAME"),value:a.name},{name:t("PROJECT"),value:(0,S.showNameAndAlias)(a.namespace,"project")},{name:t("TYPE"),value:t(a.type)},{name:t("BUILDER_IMAGE"),value:(0,g.default)(o,"config.builderImage","-")},{name:t("IMAGE_NAME"),value:(0,g.default)(o,"config.imageName","-")},{name:t("PULL_POLICY"),value:(0,g.default)(o,"config.builderPullPolicy","-")},{name:t("CODE_REPOSITORY_URL"),value:c?h.default.createElement("a",{href:d,download:!0},s):l},{name:t("REMOTE_TRIGGER"),value:h.default.createElement(h.default.Fragment,null,h.default.createElement("span",null,p),h.default.createElement(T.CopyToClipboard,{text:p,onCopy:e.handleCopy},h.default.createElement(E.Icon,{name:"copy",changeable:!0})))},{name:t("CREATION_TIME_TCAP"),value:(0,S.getLocalTime)(a.createTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:a.creator}]},e}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e={detailStore:this.store,s2iRunStore:this.s2iRunStore,resourceStore:this.resourceStore};if(this.store.isLoading||this.s2iRunStore.isLoading)return h.default.createElement(E.Loading,{className:"ks-page-loading"});var a={module:this.module,name:(0,S.getDisplayName)(this.store.detail),desc:this.store.detail.description,operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("IMAGE_BUILDER_PL"),url:this.listUrl}]};return h.default.createElement(A.default,(0,o.default)({stores:e},a,{routes:(0,D.default)(this.props.match.path)}))}},{key:"module",get:function(){return"s2ibuilders"}},{key:"name",get:function(){return"IMAGE_BUILDER"}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"params",get:function(){return this.props.match.params}},{key:"listUrl",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"".concat(t?"/".concat(t):"","/clusters/").concat(a,"/projects/").concat(r,"/").concat(this.module)}}]),r}(h.default.Component))||l)||l)||l;a.default=w},4042:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(318),o=r(a(4043)),c=r(a(4050)),s=r(a(4051)),l=r(a(4052)),i=r(a(4053));t.default=function(e){return[{path:"".concat(e,"/records"),title:"RUN_RECORDS",component:o.default,excat:!0},{path:"".concat(e,"/resource-status"),title:"RESOURCE_STATUS",component:c.default,excat:!0},{path:"".concat(e,"/image-artifacts"),title:"IMAGE_ARTIFACTS",component:i.default,excat:!0},{path:"".concat(e,"/env"),title:"ENVIRONMENT_VARIABLE_PL",component:s.default,excat:!0},{path:"".concat(e,"/events"),title:"EVENT_PL",component:l.default,excat:!0},(0,n.getIndexRoute)({path:e,to:"".concat(e,"/records"),exact:!0})]}},4043:function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=n(r(26)),p=r(243),m=n(r(4044)),h=n(r(1676)),v=n(r(4049));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=(0,p.inject)("detailStore","s2iRunStore")(o=(0,p.observer)(o=function(e){(0,l.default)(r,e);var a=_(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props.match.params,a=this.props.s2iRunStore.runDetail;return d.default.createElement(d.default.Fragment,null,d.default.createElement("div",{className:v.default.title},t("LAST_BUILD_ENVIRONMENT")),d.default.createElement("div",{className:v.default.card},d.default.createElement(m.default,{isB2i:this.isB2i,runDetail:a,params:e})),d.default.createElement("div",{className:v.default.title},t("RUN_RECORDS")),d.default.createElement("div",{className:v.default.card},d.default.createElement(h.default,{isB2i:this.isB2i,params:e})))}},{key:"store",get:function(){return this.props.detailStore}},{key:"isB2i",get:function(){return(0,f.default)(this.store.detail,"spec.config.isBinaryURL")}}]),r}(d.default.Component))||o)||o;a.default=g},4044:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(69);var o=n(r(25)),c=n(r(28)),s=n(r(41)),l=n(r(42)),i=n(r(37)),u=n(r(0)),d=n(r(5)),f=r(189),p=n(r(26)),m=n(r(64)),h=r(56),v=n(r(4045));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var g=function(e){(0,s.default)(r,e);var a=_(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return(e=a.call.apply(a,[this].concat(n))).pathAddCluster=function(e,t){var a=e.match(/(\/kapis|api|apis)(.*)/);return t&&"default"!==t&&(0,m.default)(a)?"".concat(a[1],"/clusters/").concat(t).concat(a[2]):e},e}return(0,c.default)(r,[{key:"renderB2i",value:function(){var e=this.props,a=e.className,r=e.params,n=e.runDetail,o=n.builderImage,c=n.sourceUrl,s=n.binaryName,l=n.binarySize,i=n.status,m=r.cluster,_=(0,p.default)((0,h.parseUrl)(c),"pathname","/".concat(c)),g=this.pathAddCluster(_,m),y="".concat(window.location.protocol,"//").concat(window.location.host,"/b2i_download").concat(g);return u.default.createElement("ul",{className:(0,d.default)(v.default.builderContent,a)},u.default.createElement("li",null,u.default.createElement("span",{className:v.default.icon},u.default.createElement(f.Icon,{name:(0,h.getLanguageName)(o),size:40})),u.default.createElement("div",{className:v.default.info},u.default.createElement("p",{className:v.default.value,title:o},o),u.default.createElement("p",{className:v.default.name},t("BUILDER_IMAGE_SCAP")))),u.default.createElement("li",{className:v.default.downloadContent},u.default.createElement("a",{href:"Success"!==i?null:y,download:!0},u.default.createElement("span",{className:v.default.icon},u.default.createElement(f.Icon,{name:"resource",size:40})),u.default.createElement("div",{className:v.default.info},u.default.createElement("p",{className:v.default.value,title:s},s),u.default.createElement("p",{className:v.default.name},t("FILE_SIZE_VALUE",{value:(0,h.formatSize)(l)}))))))}},{key:"render",value:function(){var e=this.props,a=e.className;if(e.isB2i)return this.renderB2i();var r=this.props.runDetail,n=r.sourceUrl,o=r.builderImage,c=r.revisionId;return u.default.createElement("ul",{className:(0,d.default)(v.default.builderContent,a)},u.default.createElement("li",null,u.default.createElement("span",{className:v.default.icon,style:{backgroundImage:"url('/extensions-static/ks-console-embed/dist/v3dist/assets/".concat((0,h.getLanguageName)(o),".png')")}}),u.default.createElement("div",{className:v.default.info},u.default.createElement("p",{className:v.default.value,title:o},o),u.default.createElement("p",{className:v.default.name},t("BUILDER_IMAGE_SCAP")))),u.default.createElement("li",null,u.default.createElement("span",{className:v.default.icon},u.default.createElement(f.Icon,{name:"resource",size:40})),u.default.createElement("div",{className:v.default.info},u.default.createElement("p",{className:v.default.value,title:n},n),u.default.createElement("p",{className:v.default.name},t("CODE_REPOSITORY_URL")))),u.default.createElement("li",null,u.default.createElement(f.Icon,{name:"branch",className:v.default.icon}),u.default.createElement("div",{className:v.default.info},u.default.createElement("p",{className:v.default.value},c||"master"),u.default.createElement("p",{className:v.default.name},t("BRANCH_SI")))))}}]),r}(u.default.Component);a.default=g},4045:function(e,t,a){e.exports={builderContent:"BkSp13POZ-js2HUtWNRz0",icon:"Hd8bCjdE9-3_BACC2Bo_J",info:"_2WqRttYeptGxvqC17MIBCN",value:"J0OCuGgJwMRDp3cpr2zcL",name:"_2czgyMcWaHAVtdYdIG8PsL",downloadContent:"_1WjbXqIcDDGS8lq6Z4mPe7"}},4046:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(30),r(11),r(69),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(110);var o=n(r(31)),c=n(r(38));r(35);var s,l=n(r(39)),i=n(r(25)),u=n(r(28)),d=n(r(41)),f=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(5)),v=r(243),_=n(r(26)),g=n(r(64)),y=r(189),E=n(r(807)),b=r(56),S=n(r(4047));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var R=(0,v.observer)(s=function(e){(0,d.default)(r,e);var a=O(r);function r(e){var n;return(0,i.default)(this,r),(n=a.call(this,e)).toggleShowLog=function(){var e=n.state.showLog;e?clearTimeout(n.refreshTimer):globals.app.hasKSModule("whizard-logging")?(n.getLog(),n.setState({noModuleMsg:null})):(n.store.logData.isLoading=!1,n.setState({noModuleMsg:t("LOG_MODULE_NOT_INSTALLED")})),n.setState({showLog:!e})},n.getLog=(0,l.default)(c.default.mark((function e(){var t,a,r,o,s,l;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.runDetail,a=t.logURL,r=t.status,o=t.cluster,s=n.store.logData,l="Building"===r||"Unknown"===r,clearTimeout(n.refreshTimer),a){e.next=7;break}return n.refreshTimer=setTimeout(n.getLog,4e3),e.abrupt("return");case 7:return e.next=9,n.store.getLog(a,o);case 9:if(n.handleScrollToBottom(),!s.hasMore){e.next=13;break}return n.getLog(),e.abrupt("return");case 13:l&&(n.refreshTimer=setTimeout(n.getLog,4e3));case 14:case"end":return e.stop()}}),e)}))),n.handleScrollToBottom=function(){var e=n.LogContent.current;e&&(e.scrollTop=e.scrollHeight)},n.showLog=function(){n.setState({showLog:!0})},n.stopPropagation=function(e){e&&e.stopPropagation()},n.pathAddCluster=function(e,t){var a=e.match(/(\/kapis|api|apis)(.*)/);return t&&"default"!==t&&(0,g.default)(a)?"".concat(a[1],"/clusters/").concat(t).concat(a[2]):e},n.handleDownload=function(){var e=n.props.runDetail,t=e.sourceUrl,a=e.cluster,r=(0,_.default)((0,b.parseUrl)(t),"pathname","/".concat(t)),o=n.pathAddCluster(r,a),c="".concat(window.location.protocol,"//").concat(window.location.host,"/b2i_download").concat(o);window.open(c)},n.renderLog=function(){var e=n.store.logData,a=e.log,r=e.isLoading,o=n.state.noModuleMsg;return n.state.showLog?r?m.default.createElement("div",{className:S.default.logContent,onClick:n.stopPropagation},m.default.createElement(y.Loading,null)):m.default.createElement("div",{className:S.default.logContent,onClick:n.stopPropagation},m.default.createElement("pre",{ref:n.LogContent},o||a||t("LOADING_DOTS"))):null},n.renderDetailInfo=function(){var e=n.props.runDetail,a=e.imageName,r=e.branch,o=e.binaryName,c=e.binarySize,s=e.status;if(!n.props.isB2i)return m.default.createElement("span",{className:S.default.branchName},m.default.createElement(y.Icon,{name:"branch"}),m.default.createElement("span",null,r||"master"));var l=m.default.createElement("div",{className:S.default.artifactContent},m.default.createElement("p",{className:S.default.title},t("ARTIFACT_FILE")),m.default.createElement("div",{className:S.default.info},m.default.createElement(y.Icon,{name:"file"}),m.default.createElement("p",null,o," ",m.default.createElement("span",null,(0,b.formatSize)(c)))),m.default.createElement("div",{className:S.default.info},m.default.createElement(y.Icon,{name:"templet"}),m.default.createElement("p",null,a)),m.default.createElement(y.Button,{onClick:n.handleDownload,type:"primary",disabled:"Successful"!==s},t("DOWNLOAD_ARTIFACT")));return m.default.createElement(y.Tooltip,{className:S.default.tooltip,content:l,trigger:"hover"},m.default.createElement(y.Icon,{name:"file"}))},n.state={showLog:!1,noModuleMsg:null},n.LogContent=m.default.createRef(),n.store=e.store,n}return(0,u.default)(r,[{key:"componentWillUnmount",value:function(){clearTimeout(this.refreshTimer),this.setState({noModuleMsg:null})}},{key:"render",value:function(){var e=this.props.runDetail,a=e.count,r=e.status,n=e.imageName,c=e.startTime,s=e.name;return this.props.loading?null:m.default.createElement("ul",{className:(0,h.default)(S.default.item,(0,o.default)({},S.default.active,this.state.showLog)),onClick:this.toggleShowLog},m.default.createElement("li",null,m.default.createElement("div",{className:S.default.value},"#",a," ",this.renderDetailInfo()),m.default.createElement("div",{className:S.default.label},t("SERIAL_NUMBER"))),m.default.createElement("li",null,m.default.createElement("div",{className:S.default.value},m.default.createElement(E.default,{className:S.default.status,type:r,name:t(t(r)),flicker:!0})),m.default.createElement("div",{className:S.default.label},t("STATUS"))),m.default.createElement("li",null,m.default.createElement("div",{className:S.default.value},n),m.default.createElement("div",{className:S.default.label},t("IMAGE_NAME_SCAP"))),m.default.createElement("li",null,m.default.createElement("div",{className:S.default.value},(0,b.getLocalTime)(c).format("YYYY-MM-DD HH:mm:ss")),m.default.createElement("div",{className:S.default.label},t("START_TIME_SCAP"))),m.default.createElement("li",null,m.default.createElement("div",{className:S.default.value},r&&s&&t("IMAGE_NAME_".concat(r.toUpperCase()),{name:s})),m.default.createElement("div",{className:S.default.label},t("LAST_MESSAGE_SCAP"))),m.default.createElement(y.Icon,{className:S.default.icon,name:"chevron-down"}),this.renderLog())}}]),r}(m.default.Component))||s;a.default=R},4047:function(e,t,a){e.exports={item:"_3elQcs0a3jxkIwI3ZFGz_Q",value:"_3T4SMPwXMkA9bkeSRaiPDy",status:"_3SKf3UE7oGRjx5y36ufLXK",label:"oc_0Y06yilwcM1rPeAuLM",icon:"_1KE-WZA890ochiXMG_1CsK",branchName:"_3mBN7MemPAoSkAQ7aRCpd3",active:"AkkmSAa32PoBGb8x5Xva1",logContent:"x1_tdtG8vUDtmFG2c4NB9",tooltip:"_3YH0xMx3dBN7B0SttPsUkk",artifactContent:"_3IzWACmQ7p6fvAT9-WdUuE",title:"_30zaQHexLzCS9qKs8vmomE",info:"_2KW1j46oxR29q8pnufGWGt"}},4048:function(e,t,a){e.exports={content:"_1slgUd1teNIfY0n58nGO",header:"_33WAUE8MIh2OonzlUeXWfw",search:"_1R7RIjj9k5xB0OOtOnTZob",actions:"_1IG1p_n9Tvf8h2SYQTY35x"}},4049:function(e,t,a){e.exports={main:"_3cgE6f9b9x33gijePTtBOg",table:"_3j0UWPstvzLi3v0mSQm6PS",clickable:"_3h3VphlUJpSBWERve0cBEG",content:"_1qU2sf5wNS4NAGpul7wEmg",title:"uMJf_Dj6zXK_em4b4IvwU",card:"_iGPpNLR9zhNV2XUNi0K-"}},4050:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(8),a(13),a(9),a(4),a(18),a(30),a(11),a(69),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(30),a(11),a(69),a(7);var n,o=r(a(31)),c=r(a(25)),s=r(a(28)),l=r(a(41)),i=r(a(42)),u=r(a(37)),d=r(a(0)),f=a(243),p=a(1018),m=r(a(920)),h=a(189);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var y=(0,f.inject)("detailStore","s2iRunStore")(n=(0,f.observer)(n=function(e){(0,l.default)(a,e);var t=g(a);function a(){return(0,c.default)(this,a),t.apply(this,arguments)}return(0,s.default)(a,[{key:"renderPods",value:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster;return d.default.createElement(m.default,{prefix:"/".concat(t?"/".concat(t):"","/clusters/").concat(a),detail:_({cluster:a},this.store.jobDetail)})}},{key:"renderContent",value:function(){return this.store.isLoading?d.default.createElement(h.Loading,null):d.default.createElement("div",null,this.renderContainerPorts(),this.renderPods())}},{key:"store",get:function(){return this.props.s2iRunStore}}]),a}(p.Component))||n)||n;t.default=y},4051:function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(4),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(20),a(29),a(4),a(18),a(43),a(30),a(11),a(69);var n,o=r(a(25)),c=r(a(28)),s=r(a(41)),l=r(a(42)),i=r(a(37)),u=r(a(0)),d=a(17),f=a(243),p=r(a(67)),m=r(a(26)),h=r(a(1540)),v=r(a(1541));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var g=(0,f.inject)("s2iRunStore")(n=(0,f.observer)(n=function(e){(0,s.default)(a,e);var t=_(a);function a(e){var r;return(0,o.default)(this,a),(r=t.call(this,e)).fetchData=function(){r.envStore.fetchList({cluster:r.cluster,namespace:r.namespace,containers:r.containers})},r.envStore=new h.default,r}return(0,c.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=(0,d.toJS)(this.envStore.list),t=e.data,a=e.isLoading;return u.default.createElement("div",null,t.map((function(e,t){return u.default.createElement(v.default,{key:t,detail:e,expand:0===t,loading:a})})))}},{key:"module",get:function(){return this.props.module}},{key:"store",get:function(){return this.props.s2iRunStore}},{key:"namespace",get:function(){return this.store.jobDetail.namespace}},{key:"cluster",get:function(){return this.props.match.params.cluster}},{key:"containers",get:function(){var e=(0,d.toJS)(this.store.jobDetail),t=e.spec,a=e.containers,r=void 0===a?[]:a;return"containers"===this.module?[e]:(0,p.default)(r)?(0,p.default)(t)?[]:(0,m.default)(t,"template.spec.containers",[]):r}},{key:"test",get:function(){return"2"}}]),a}(u.default.Component))||n)||n;t.default=g},4052:function(e,t,a){"use strict";a(16);var r=a(19);a(14),a(4),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.Component=t.default=void 0,a(32),a(29),a(14),a(4),a(18),a(43),a(30),a(11),a(69);var n=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),l=r(a(37)),i=r(a(0)),u=a(17),d=a(243),f=a(56),p=r(a(1163)),m=r(a(1539));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,l.default)(e);if(t){var n=(0,l.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(a,e);var t=h(a);function a(e){var r;return(0,n.default)(this,a),(r=t.call(this,e)).fetchData=function(){var e=r.store.jobDetail,t=e.uid,a=e.name,n=e.namespace,o=r.props.match.params.cluster,c={"involvedObject.name":a,"involvedObject.namespace":n,"involvedObject.kind":"Job","involvedObject.uid":t};r.eventStore.fetchList({cluster:o,namespace:r.namespace,fieldSelector:(0,f.joinSelector)(c)})},r.eventStore=new p.default,r.fetchData(),r}return(0,o.default)(a,[{key:"render",value:function(){var e=(0,u.toJS)(this.eventStore.list),t=e.data,a=e.isLoading;return i.default.createElement(m.default,{data:t,loading:a})}},{key:"store",get:function(){return this.props.s2iRunStore}},{key:"namespace",get:function(){return this.store.jobDetail.namespace}}]),a}(i.default.Component),_=(0,d.inject)("s2iRunStore")((0,d.observer)(v));t.default=_;var g=v;t.Component=g},4053:function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(30),r(11),r(69);var o,c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=r(243),p=n(r(823)),m=n(r(4054)),h=n(r(4057));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=(0,f.observer)(o=function(e){(0,l.default)(r,e);var a=v(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props.match.params;return d.default.createElement(p.default,{className:h.default.main,title:t("IMAGE_ARTIFACTS")},d.default.createElement(m.default,{params:e}))}}]),r}(d.default.Component))||o;a.default=_},4054:function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(14),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(27),a(29),a(14),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(7);var n=r(a(38)),o=r(a(31));a(35);var c,s=r(a(39)),l=r(a(25)),i=r(a(28)),u=r(a(41)),d=r(a(42)),f=r(a(37)),p=r(a(0)),m=a(243),h=r(a(1676)),v=r(a(4055));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var E=(0,m.observer)(c=function(e){(0,u.default)(a,e);var t=y(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).fetchData=(0,s.default)(n.default.mark((function t(){var a,r,o,c,s=arguments;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>0&&void 0!==s[0]?s[0]:{},r=e.props,o=r.limit,(c=r.params).status="Successful",t.next=5,e.store.fetchS2IRunRecords(g(g({limit:o},c),a));case 5:e.setAutoRefresh();case 6:case"end":return t.stop()}}),t)}))),e}return(0,i.default)(a,[{key:"renderItem",value:function(e){var t=this.store.list.isLoading;return p.default.createElement(v.default,{key:e.name,runDetail:e,loading:t,store:this.store})}}]),a}(h.default))||c;t.default=E},4055:function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var o,c=n(r(25)),s=n(r(28)),l=n(r(41)),i=n(r(42)),u=n(r(37)),d=n(r(0)),f=r(243),p=r(56),m=r(189),h=n(r(191)),v=r(1675),_=n(r(4056));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var y=(0,f.observer)(o=function(e){(0,l.default)(r,e);var a=g(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=a.call.apply(a,[this].concat(o))).handleCopy=function(){h.default.success({content:t("COPY_SUCCESSFUL")})},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props.runDetail,a=e.imageName,r=e.imageCreated,n=e.imageSize,o=e.commandPull;return this.props.loading?null:d.default.createElement("ul",{className:_.default.item},d.default.createElement(m.Icon,{name:"cdn",size:40}),d.default.createElement("li",null,d.default.createElement("div",{className:_.default.value},a),d.default.createElement("div",{className:_.default.label},t("IMAGE_NAME_SCAP"))),d.default.createElement("li",null,d.default.createElement("div",{className:_.default.value},(0,p.formatSize)(n)),d.default.createElement("div",{className:_.default.label},t("IMAGE_SIZE_SCAP"))),d.default.createElement("li",null,d.default.createElement("div",{className:_.default.value},o,d.default.createElement(v.CopyToClipboard,{text:o,onCopy:this.handleCopy},d.default.createElement(m.Icon,{className:_.default.copyIcon,name:"copy",changeable:!0}))),d.default.createElement("div",{className:_.default.label},t("PULL_COMMAND_SCAP"))),d.default.createElement("li",null,d.default.createElement("div",{className:_.default.value},(0,p.getLocalTime)(r).format("YYYY-MM-DD HH:mm:ss")),d.default.createElement("div",{className:_.default.label},t("RELEASE_TIME_SCAP"))))}}]),r}(d.default.Component))||o;a.default=y},4056:function(e,t,a){e.exports={item:"_1c8i_eoUlHMB2lYN5xgXvt",value:"_25Hi7XHKhZ1owsalTEwjnb",status:"_3SFV9llOs6oQvRXeuhE9Tc",label:"_2pypsciA7t2SNBk15A_i0Q",icon:"_2e4TfXHI2JnlLkg62MITNS",copyIcon:"_1HwMmSXmFXLnNvOlIBrqUP"}},4057:function(e,t,a){e.exports={table:"JkzBFOqQxJDXdFS8jg9xD"}},4058:function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(317)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(0)),m=r(17),h=r(243),v=n(r(67)),_=r(189),g=r(56),y=r(804),E=n(r(1203)),b=n(r(834)),S=n(r(4059));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var C=(0,h.inject)("rootStore")(o=(0,h.observer)(o=(0,y.trigger)(o=function(e){(0,u.default)(r,e);var a=k(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).store=new E.default,e.fetchData=function(){e.store.fetchDetail(e.props.match.params)},e.getOperations=function(){return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(){return e.trigger("resource.baseinfo.edit",{type:e.name,detail:e.store.detail,success:e.fetchData})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(){return e.trigger("resource.yaml.edit",{detail:e.store.detail,success:e.fetchData})}},{key:"editScale",icon:"pen",text:t("EDIT_SCALING_SETTINGS"),action:"edit",onClick:function(){return e.trigger("customScaling.edit.setting",R({detail:e.store.detail,success:e.fetchData},e.props.match.params))}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(){return e.trigger("resource.delete",{type:e.name,detail:e.store.detail,success:function(){return e.routing.push(e.listUrl)}})}}]},e.getAttrs=function(){var a=(0,m.toJS)(e.store.detail)||{},r=e.props.match.params,n=r.cluster,o=r.namespace;if(!(0,v.default)(a))return[{name:t("CLUSTER"),value:(0,g.showNameAndAlias)(n,"cluster")},{name:t("PROJECT"),value:(0,g.showNameAndAlias)(o,"project")},{name:t("CREATION_TIME_TCAP"),value:(0,g.getLocalTime)(a.createTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:a.creator}]},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e,a,r,n,o,s={detailStore:this.store};if(this.store.isLoading&&!this.store.detail.name)return p.default.createElement(_.Loading,{className:"ks-page-loading"});var l={module:this.module,name:(0,g.getDisplayName)(null!==(e=null===(a=this.store)||void 0===a?void 0:a.detail)&&void 0!==e?e:{}),desc:null!==(r=null===(n=this.store)||void 0===n||null===(o=n.detail)||void 0===o?void 0:o.description)&&void 0!==r?r:"",operations:this.getOperations(),attrs:this.getAttrs(),breadcrumbs:[{label:t("CUSTOM_SCALING_PL"),url:this.listUrl}]};return p.default.createElement(b.default,(0,c.default)({stores:s},l,{routes:(0,S.default)(this.props.match.path)}))}},{key:"module",get:function(){return"customScalings"}},{key:"name",get:function(){return"CUSTOM_SCALING"}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"listUrl",get:function(){var e=this.props.match.params,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r,"/custom-scaling")}}]),r}(p.default.Component))||o)||o)||o;a.default=C},4059:function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(318),o=r(a(867)),c=r(a(4060));t.default=function(e){return[{path:"".concat(e,"/resource-status"),title:"RESOURCE_STATUS",component:c.default,exact:!0},{path:"".concat(e,"/events"),title:"EVENT_PL",component:o.default,exact:!0},(0,n.getIndexRoute)({path:e,to:"".concat(e,"/resource-status"),exact:!0})]}},4060:function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(30),a(11),a(69);var n,o=r(a(25)),c=r(a(28)),s=r(a(41)),l=r(a(42)),i=r(a(37)),u=r(a(0)),d=a(17),f=a(243),p=r(a(4061)),m=r(a(4063)),h=r(a(4068));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.default)(this,a)}}var _=(0,f.inject)("detailStore")(n=(0,f.observer)(n=function(e){(0,s.default)(a,e);var t=v(a);function a(){return(0,o.default)(this,a),t.apply(this,arguments)}return(0,c.default)(a,[{key:"render",value:function(){var e=this.props.detailStore.detail;return u.default.createElement("div",null,u.default.createElement(h.default,{detail:(0,d.toJS)(e)}),u.default.createElement(p.default,{detail:(0,d.toJS)(e),params:this.props.match.params}),u.default.createElement(m.default,{detail:(0,d.toJS)(e)}))}}]),a}(u.default.Component))||n)||n;t.default=_},4061:function(e,a,r){"use strict";var n=r(162),o=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var c=o(r(317)),s=o(r(38)),l=o(r(31));r(35);var i=o(r(39)),u=o(r(97)),d=o(r(802)),f=o(r(801)),p=o(r(26)),m=o(r(1547)),h=n(r(0)),v=o(r(319)),_=r(61),g=r(56),y=r(466),E=o(r(4062));function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O=function(e){var a,r,n,o,l,b,O=e.detail,R=e.params,k=(0,h.useState)({}),C=(0,u.default)(k,2),A=C[0],T=C[1],D=(0,h.useMemo)((function(){var e,t;return"".concat(null==O||null===(e=O.scaleTargetRef)||void 0===e||null===(t=e.kind)||void 0===t?void 0:t.toLocaleLowerCase(),"s")}),[O.scaleTargetRef.kind]),P=[{icon:"down-duotone",title:null!==(a=null==O?void 0:O.minReplicaCount)&&void 0!==a?a:"-",desc:t("MINIMUM_REPLICAS")},{icon:"up-duotone",title:null!==(r=null==O?void 0:O.maxReplicaCount)&&void 0!==r?r:"-",desc:t("MAXIMUM_REPLICAS")},{icon:"history-duotone",title:(0,g.getUnitValueString)(null!==(n=null==O?void 0:O.pollingInterval)&&void 0!==n?n:"-",y.timeUnit),desc:t("POLLING_INTERVAL")},{icon:"clock-duotone",title:(0,g.getUnitValueString)(null!==(o=null==O?void 0:O.cooldownPeriod)&&void 0!==o?o:"-",y.timeUnit),desc:t("WAITING_TIME")}],N=(0,h.useCallback)(function(){var e=(0,i.default)(s.default.mark((function e(t){var a,r,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchDetail(S(S({},R),{},{name:null==O||null===(a=O.scaleTargetRef)||void 0===a?void 0:a.name}));case 2:r=t.detail,n=I(r),T(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),I=(0,h.useCallback)((function(e){var t={};switch(D){case"deployments":t={current:e.availablePodNums||0,desire:e.podNums||0};break;case"statefulsets":t={current:(0,p.default)(e,"status.currentReplicas",e.readyPodNums),desire:e.podNums||0}}return t}),[D]);return(0,h.useEffect)((function(){var e=new v.default(D);N(e)}),[D]),h.default.createElement(f.default,{title:t("SCALING_OBJECT")},h.default.createElement("div",{className:E.default.scalingObject},h.default.createElement("div",{className:E.default.scalingObjectHeader},h.default.createElement(d.default,{icon:_.ICON_TYPES[D],iconSize:40,title:null==O||null===(l=O.scaleTargetRef)||void 0===l?void 0:l.name,desc:t(null==O||null===(b=O.scaleTargetRef)||void 0===b?void 0:b.kind),noLink:!0})),h.default.createElement("div",{className:E.default.scalingObjectBody},h.default.createElement(m.default,(0,c.default)({},A,{hideOperation:!0})),h.default.createElement("div",{className:E.default.itemBoxBody},P.map((function(e,t){return h.default.createElement("div",{className:E.default.itemBoxBodyItem,key:t},h.default.createElement(d.default,{iconSize:40,icon:e.icon,title:e.title,desc:e.desc,noLink:!0}))}))))))},R=(0,h.memo)(O);a.default=R},4062:function(e,t,a){e.exports={scalingObject:"_2HUP0LySuuHrrXuV-TrTsu",scalingObjectHeader:"_3mMfQf77HpdXXMDgz8YiOB",scalingObjectBody:"_3LITN8X08Bdt0XHP-aM_U6",itemBoxBody:"_3aBU-ClqYPDNxCgic1Ec3Y",itemBoxBodyItem:"_2SxPhPdUD8AM7pB3-7vVcE"}},4063:function(e,a,r){"use strict";r(16);var n=r(19),o=r(162);r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20);var c=o(r(0)),s=n(r(801)),l=n(r(4064)),i=n(r(4065)),u=n(r(4067)),d=n(r(1089)),f=function(e){var a,r=e.detail;return r.triggers.length<1?null:c.default.createElement(s.default,{title:t("TRIGGER")},c.default.createElement("div",{className:d.default.triggerBox},null===(a=r.triggers)||void 0===a?void 0:a.map((function(e,t){var a="cron"===e.type?c.default.createElement(l.default,e):"prometheus"===e.type?c.default.createElement(i.default,e):c.default.createElement(u.default,e);return c.default.createElement("div",{key:t},a)}))))},p=(0,c.memo)(f);a.default=p},4064:function(e,a,r){"use strict";r(16);var n=r(19);r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20);var o=n(r(0)),c=n(r(802)),s=n(r(1089)),l=function(e){var a=e.metadata,r=void 0===a?{}:a,n=[{title:null==r?void 0:r.timezone,desc:t("TIME_ZONE"),icon:"map-time"},{title:null==r?void 0:r.desiredReplicas,desc:t("REPLICAS_DESIRED"),icon:"pod"},{title:null==r?void 0:r.start,desc:t("START_TIME"),icon:"clock-duotone"},{title:null==r?void 0:r.end,desc:t("END_TIME"),icon:"clock-duotone"}];return o.default.createElement("div",{className:s.default.itemBox},o.default.createElement("div",{className:s.default.itemBoxTitle},o.default.createElement(c.default,{icon:"cronjob-duotone",iconSize:40,title:"Cron",desc:t("CORN_DESC"),noLink:!0})),o.default.createElement("div",{className:s.default.itemBoxBody},n.map((function(e,t){return o.default.createElement("div",{className:s.default.itemBoxBodyItem,key:t},o.default.createElement(c.default,{icon:e.icon,iconSize:40,title:e.title,desc:e.desc,noLink:!0}))}))))};a.default=l},4065:function(e,a,r){"use strict";r(16);var n=r(19);r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20);var o=n(r(0)),c=n(r(802)),s=n(r(67)),l=n(r(1677)),i=n(r(1089)),u=function(e){var a=e.metadata,r=void 0===a?{}:a,n=e.authenticationRef,u=void 0===n?{}:n,d=[{title:r.serverAddress,desc:t("ADDRESS"),icon:"network-duotone"},{title:r.metricName,desc:t("INDICATOR_NAME"),icon:"textarea-duotone"},{title:r.threshold,desc:t("THRESHOLD"),icon:"proportion-chart"},{title:r.query,desc:t("EXPRESSION"),icon:"apps-duotone"}];return o.default.createElement("div",{className:i.default.itemBox},o.default.createElement("div",{className:i.default.itemBoxTitle},o.default.createElement(c.default,{icon:"prometheus",iconSize:40,title:"Prometheus",desc:t("SCALING_Prometheus_DESC"),noLink:!0})),o.default.createElement("div",{className:i.default.itemBoxBody2Column},d.map((function(e,t){return o.default.createElement("div",{className:i.default.itemBoxBodyItem,key:t},o.default.createElement(c.default,{icon:e.icon,iconSize:40,title:e.title,desc:e.desc,noLink:!0}))}))),!(0,s.default)(u)&&o.default.createElement("div",{className:i.default.authentication},o.default.createElement("section",null,t("TOGGLER_AUTHOR")),o.default.createElement(l.default,{data:u})))};a.default=u},4066:function(e,t,a){e.exports={annotations:"DmBSAoLXwzMmq9Y7Ew49L"}},4067:function(e,a,r){"use strict";r(16);var n=r(19),o=r(162);r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20);var c=o(r(0)),s=n(r(802)),l=n(r(1677)),i=n(r(1089)),u=function(e){var a=(0,c.useMemo)((function(){return[{title:e.type,desc:t("TYPE"),icon:"appcenter"}]}),[e]);return c.default.createElement("div",{className:i.default.itemBox},c.default.createElement("div",{className:i.default.itemBoxTitle},c.default.createElement(s.default,{icon:"computing-setting",iconSize:40,title:e.type,desc:t("SCALING_CUSTOM_DESC"),noLink:!0})),c.default.createElement("div",{className:i.default.itemBoxBody},a.map((function(e,t){return c.default.createElement("div",{className:i.default.itemBoxBodyItem,key:t},c.default.createElement(s.default,{icon:e.icon,iconSize:40,title:e.title,desc:e.desc,noLink:!0}))}))),c.default.createElement("div",{className:i.default.authentication},c.default.createElement("section",null,t("TOGGLER_PARAMS")),c.default.createElement(l.default,{data:e.metadata})),c.default.createElement("div",{className:i.default.authentication},c.default.createElement("section",null,t("TOGGLER_AUTHOR")),c.default.createElement(l.default,{data:e.authenticationRef})))},d=(0,c.memo)(u);a.default=d},4068:function(e,a,r){"use strict";r(16);var n=r(19),o=r(162);r(44),r(20),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(44),r(20),r(14),r(4);var c=o(r(0)),s=n(r(801)),l=n(r(802)),i=r(189),u=r(1678),d=n(r(4070)),f=function(e){var a,r,n=e.detail,o=null!==(a=null==n||null===(r=n.status)||void 0===r?void 0:r.conditions)&&void 0!==a?a:[],f=[{icon:"front-sight",title:t("STRETCH_OBJECT_READY"),type:"Ready"},{icon:"stretch",title:t("TRIGGER_ACTIVE"),type:"Active"},{icon:"time-backup",title:t("RETRACTOR_FALLBACK"),type:"Fallback"}];return c.default.createElement(s.default,{title:t("STATUS_INFORMATION")},c.default.createElement("div",{className:d.default.scalingObject},c.default.createElement("div",{className:d.default.scalingObjectBody},c.default.createElement("div",{className:d.default.itemBoxBody},f.map((function(e,a){return c.default.createElement("div",{className:d.default.itemBoxBodyItem,key:a},c.default.createElement(l.default,{iconSize:40,icon:e.icon,title:e.title,noLink:!0}),c.default.createElement("span",{className:d.default.itemMoreMessage},function(e){var a,r,n,s=o.find((function(t){return t.type===e.type})),l=null!==(a=null===(r=u.ICON_TYPES[s.status])||void 0===r?void 0:r.name)&&void 0!==a?a:"success";return c.default.createElement(i.Tooltip,{content:(n=s,c.default.createElement("div",null,c.default.createElement("p",null,u.STATUS_TITLE[n.type]),c.default.createElement("ul",null,c.default.createElement("li",null,t("STATUS_VALUE",{value:n.status})),c.default.createElement("li",null,n.reason&&t("REASON_VALUE",{value:n.reason})),c.default.createElement("li",null,n.message&&t("MESSAGE_VALUE",{value:n.message})))))},c.default.createElement(i.Icon,{size:15,name:l,className:"close"===l?d.default.closeIcon:"",color:{primary:"#fff",secondary:u.ICON_TYPES[s.status].color}}))}(e)))}))))))},p=(0,c.memo)(f);a.default=p},4069:function(e,t,a){e.exports={container:"_2KVItd1HYYaJgdIyvHcwUc",item:"_3VFw_wXbCXL1Ywf-VNO5aK",closeIcon:"_1tqgjq-R_7uGbX_0TkMkd3",textItem:"sXH771p37zacfjCTwHkhs",textItemTitle:"_2nfBuQzfWBKyTHRIKCWMgP"}},4070:function(e,t,a){e.exports={scalingObject:"_3dOb7zP9K-HeLTa-2w8ahj",scalingObjectBody:"QLeGWNMC0fYGehEs0oeqd",itemBoxBody:"_1Ju85rdIxkWSfN9odO4ApV",itemBoxBodyItem:"_1TlGtUKn-agIFcyK_6fmhl",itemMoreMessage:"SgThEYjDBa8DkABHylJ96",closeIcon:"TgeOayymCsr54gm9GNvt7"}},4071:function(e,a,r){"use strict";(function(e){var n=r(19);r(12),r(109),r(3),r(10),r(6),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(66),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var o,c=n(r(317)),s=n(r(31)),l=n(r(25)),i=n(r(28)),u=n(r(41)),d=n(r(42)),f=n(r(37)),p=n(r(802)),m=n(r(800)),h=n(r(813)),v=r(806),_=n(r(810)),g=n(r(479)),y=n(r(0)),E=n(r(1203)),b=r(56),S=r(61),O=n(r(1678));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var A=(0,v.withProjectList)({store:new E.default,module:"customScalings",name:"CUSTOM_SCALING"})(o=function(a){(0,u.default)(n,a);var r=C(n);function n(){var a;(0,l.default)(this,n);for(var o=arguments.length,c=new Array(o),s=0;s<o;s++)c[s]=arguments[s];return(a=r.call.apply(r,[this].concat(c))).getColumns=function(){var r=a.props,n=r.getSortOrder,o=r.module;return[{title:t("NAME"),dataIndex:"name",sorter:!0,sortOrder:n("name"),render:function(e,t){return y.default.createElement(p.default,{icon:S.ICON_TYPES[o],iconSize:40,title:(0,b.getDisplayName)(t),desc:t.description||"-",to:"".concat(a.props.match.url,"/").concat(e),isMultiCluster:t.isFedManaged})}},{title:t("STATUS"),dataIndex:"status",width:100,render:function(t,r){return y.default.createElement(O.default,{status:t,toEvent:function(){e.navigateTo("".concat(a.props.match.url,"/").concat(r.name,"/events"))}})}},{title:t("SCALER"),dataIndex:"triggers",isHideable:!0,width:"15%",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.map((function(e){return(0,g.default)(e.type)})).join(",");return t}},{title:t("SCALING_OBJECT"),dataIndex:"scaleTargetRef",isHideable:!0,width:"15%",render:function(e){var a,r;return y.default.createElement(m.default,{title:null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"-",description:t(null!==(r=null==e?void 0:e.kind)&&void 0!==r?r:"-")})}},{title:t("MINIMUM_REPLICAS"),dataIndex:"minReplicaCount",isHideable:!0,width:"10%"},{title:t("MAXIMUM_REPLICAS"),dataIndex:"maxReplicaCount",isHideable:!0,width:"10%"},{title:t("CREATION_TIME_TCAP"),dataIndex:"createTime",sorter:!0,sortOrder:n("createTime"),isHideable:!0,width:150,render:function(e){return(0,b.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},a.showCreate=function(){var e=a.props,r=e.match,n=e.module,o=e.getData;return a.props.trigger("customScaling.create",k(k({module:n},r.params),{},{success:o,title:t("CREATE_CUSTOM_SCALING")}))},a}return(0,i.default)(n,[{key:"render",value:function(){var e=this.props,t=e.bannerProps,a=e.tableProps;return y.default.createElement(v.ListPage,(0,c.default)({},this.props,{noWatch:!0}),y.default.createElement(h.default,t),y.default.createElement(_.default,(0,c.default)({},a,{className:"table-2-3",itemActions:this.itemActions,columns:this.getColumns(),onCreate:this.showCreate,searchType:"name"})))}},{key:"itemActions",get:function(){var e=this.props,a=e.getData,r=e.trigger,n=e.name,o=e.match;return[{key:"edit",icon:"pen",text:t("EDIT_INFORMATION"),action:"edit",onClick:function(e){return r("resource.baseinfo.edit",{detail:e,success:a})}},{key:"editYaml",icon:"pen",text:t("EDIT_YAML"),action:"edit",onClick:function(e){return r("resource.yaml.edit",{detail:e,success:a})}},{key:"editScale",icon:"pen",text:t("EDIT_SCALING_SETTINGS"),action:"edit",onClick:function(e){return r("customScaling.edit.setting",k({detail:e,success:a},o.params))}},{key:"delete",icon:"trash",text:t("DELETE"),action:"delete",onClick:function(e){return r("resource.delete",{type:n,detail:e,success:a})}}]}}]),n}(y.default.Component))||o;a.default=A}).call(this,r(75))},796:function(e,t,a){"use strict";var r=a(19),n=a(162);a(12),a(10),a(6),a(36),a(14),a(8),a(13),a(9),a(4),a(21),a(18),a(30),a(11),a(46),a(69),a(7),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(10),a(6),a(36),a(27),a(29),a(14),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(30),a(11),a(46),a(69),a(7),a(40);var o=r(a(38)),c=r(a(31));a(35);var s,l=r(a(39)),i=r(a(25)),u=r(a(28)),d=r(a(41)),f=r(a(42)),p=r(a(37)),m=n(a(0)),h=a(243),v=a(189),_=r(a(68)),g=r(a(244)),y=a(318),E=r(a(441)),b=r(a(448)),S=r(a(443)),O=r(a(3716));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var A=(0,h.inject)("rootStore")(s=(0,h.observer)(s=function(e){(0,d.default)(r,e);var t,a=C(r);function r(e){var t;return(0,i.default)(this,r),(t=a.call(this,e)).store=new E.default,t.clusterStore=new b.default,t.workspaceStore=new S.default,t.init(e.match.params),t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){var t=e.match.params,a=t.namespace,r=t.cluster;this.project===a&&this.cluster===r||this.init(this.props.match.params)}},{key:"init",value:(t=(0,l.default)(o.default.mark((function e(t){var a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.initializing=!0,e.next=3,Promise.all([this.store.fetchDetail(t),this.workspaceStore.fetchDetail({workspace:t.workspace}),this.clusterStore.fetchDetail({name:t.cluster}),this.props.rootStore.getRules({workspace:t.workspace})]);case 3:if(this.store.detail.name){e.next=5;break}return e.abrupt("return",this.props.rootStore.routing.push("/404"));case 5:return e.next=7,this.props.rootStore.getRules(t);case 7:return e.next=9,this.clusterStore.checkSpringCloudIfActive({cluster:t.cluster});case 9:a=e.sent,(0,_.default)(globals,"clusterConfig.".concat(t.cluster),k(k({},this.clusterStore.detail.configz),{},{k8sVersion:this.clusterStore.detail.kubernetesVersion,springcloud:a})),globals.app.cacheHistory(this.props.match.url,k(k({type:"Project"},(0,g.default)(this.store.detail,["name","aliasName"])),{},{cluster:(0,g.default)(this.clusterStore.detail,["name","aliasName","group","provider"])})),this.store.initializing=!1;case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){return this.store.initializing?m.default.createElement(v.Loading,{className:"ks-page-loading"}):m.default.createElement(h.Provider,{projectStore:this.store,workspaceStore:this.workspaceStore},(0,y.renderRoutes)(O.default))}},{key:"project",get:function(){return this.props.match.params.namespace}},{key:"cluster",get:function(){return this.props.match.params.cluster}}]),r}(m.Component))||s)||s;t.default=A}}]);