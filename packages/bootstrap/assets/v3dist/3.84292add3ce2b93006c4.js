(window.webpackJsonp=window.webpackJsonp||[]).push([[3],Array(791).concat([function(e,t,a){"use strict";a(16),a(10),a(36),a(138),a(4),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(10),a(36),a(138),a(4),a(40);for(var r=a(1695),n=r.keys().filter((function(e){return"./index.js"!==e})),l={},u=0;u<n.length;u+=1)Object.assign(l,r(n[u]).default);var o=l;t.default=o},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports={CodeEditor:"fWKJIVIp0j8BpxLeQvB84",clickable:"_1MWvcZ4Nk-gUkGBi2mTlT5",dockerCredentialsContent:"_1Ft3A_KxSha1ekW7Kj7PhV",dockerCredentialsContent__title:"cvH0AdmzBm64wtNfOw-r6",dockerCredentialsContent__content:"_6e1Y_TkD0j9LQti3mZtTI",dockerCredentialsContent__trashicon:"_2OKbHoYbk9D8ava2syyAkO",desc:"_3dhQzgRA0CKwra7jXP8LIj",info:"_1tc604kXLhTZ5HZc1wTviA",columns:"_2BKaEhU1omIebd5PVjl-mC"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a(16);var r=a(19);a(3),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(3);var l=r(a(26)),u={},o={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.pathname;return(0,l.default)(u,"".concat(e,".").concat(t))},set:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:location.pathname;u[e]=(0,n.default)({},a,t)},delete:function(e){delete u[e]}};t.default=o},,,,,,,,,,,,,,,,,,,,,function(e,a,r){"use strict";r(16),r(3),r(6),r(24),r(886),r(138),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.getDMPQuery=function(e){var t=e.rule,a=e.namespace,r=e.cluster_id,l=e.duration,u=n.ALL_QUERY_CONFIG[t.metricType];return u=u.replaceAll("$NAMESPACE",a).replaceAll("$CLUSTERID",r).replaceAll("$DURATION",l),""===t.thresholds||"-"===t.thresholds||Number.isNaN(t.thresholds)?u:"".concat(u," ").concat(t.comparator," ").concat(t.thresholds)},a.arrayToObject=function(e){var t={};return e.forEach((function(e){Object.assign(t,e)})),t},a.severityOptions=void 0,r(3),r(6),r(886),r(138),r(4),r(30),r(71),r(991),r(7);var n=r(1125);var l=[{label:t("CRITICAL_ALERT"),value:"critical",bgColor:"#CA2621",color:"#FFFFFF"},{label:t("ERROR_ALERT"),value:"error",color:"#FFFFFF",bgColor:"#F5A623"},{label:t("WARNING_ALERT"),value:"warning",color:"#5F5110",bgColor:"#FFD939"},{label:t("INFO_ALERT"),value:"info",color:"#36435C",bgColor:"#D8DEE5"}];a.severityOptions=l},,,,,,,,,,,,,,,,,function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(70),r(20),r(87),r(51),r(14),r(138),r(8),r(13),r(9),r(30),r(69),r(71),r(79),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.parseCondition=a.isArgo=a.isSvnRepo=a.checkRepoSource=a.getCommonSource=a.getRepoUrl=a.getLanguageIcon=a.groovyToJS=a.updatePipelineParamsInSpec=a.resetPipelineMultiBranch=a.updatePipelineParams=void 0;var l=n(r(58)),u=n(r(97)),o=n(r(31)),c=n(r(50));r(12),r(109),r(250),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(87),r(51),r(14),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(30),r(195),r(69),r(71),r(79),r(977),r(7);var s=n(r(191)),i=n(r(119)),f=n(r(26)),d=n(r(204)),p=n(r(68));function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v=function(e){for(var t in e)t.startsWith("enable_")&&!1===e[t]&&(delete e[t.slice(7)],e.git_source&&delete e.git_source[t.slice(7)],e.github_source&&delete e.github_source[t.slice(7)],e.bitbucket_server_source&&delete e.bitbucket_server_source[t.slice(7)],e.svn_source&&delete e.svn_source[t.slice(7)])};a.updatePipelineParams=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.multi_branch_pipeline,r=e.pipeline,n=(e.type,(0,c.default)(e,["multi_branch_pipeline","pipeline","type"]));t&&!n.description&&(n.description="");var l=(0,i.default)(n);if(l.metadata&&delete l.metadata,a&&(t?Object.assign(e.multi_branch_pipeline,l):n&&Object.assign(e.multi_branch_pipeline,n),e.type="multi-branch-pipeline",v(e.multi_branch_pipeline)),r&&(t?Object.assign(e.pipeline,l):Object.assign(e.pipeline,n),e.type="pipeline",v(e.pipeline)),!t)for(var u in n)"devopsName"!==u&&delete e[u]};a.resetPipelineMultiBranch=function(e){e.multi_branch_pipeline&&e.__multi_branch_pipeline&&(e.multi_branch_pipeline=(0,d.default)(e.__multi_branch_pipeline,e.multi_branch_pipeline)),delete e.__multi_branch_pipeline};a.updatePipelineParamsInSpec=function(e,t){e.multi_branch_pipeline&&(delete(e=(0,p.default)(e,"metadata.name",e.multi_branch_pipeline.name)).multi_branch_pipeline.metadata,e.spec={multi_branch_pipeline:h({},e.multi_branch_pipeline),type:e.type},delete e.multi_branch_pipeline),e.pipeline&&(delete(e=(0,p.default)(e,"metadata.name",e.pipeline.name)).pipeline.metadata,e.spec={pipeline:h({},e.pipeline),type:e.type},delete e.pipeline),delete e.type,delete e.description,e=(0,p.default)(e,"metadata.namespace",t)};a.groovyToJS=function(e){for(var t,a=/([\w-]*) ?: '?([\w-:/_.]*)'?/g,r={};null!==(t=a.exec(e));)t[1]&&(r[t[1]]=t[2]);return r};a.getLanguageIcon=function(e,t){return["java","gradle","javascript","php","python","golang","nodejs","jar","war","binary"].includes(e)?e:t};a.getRepoUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.provider,a=e.owner,r=e.repo,n=e.server,l=e.url,u=e.api_uri;if(l)return l;switch(t){case"github":return"https://github.com/".concat(a,"/").concat(r);case"gitlab":return"".concat(n,"/").concat(a,"/").concat(r);case"bitbucket_server":var o=u,c="/"===o.substr(o.length-1)?o:"".concat(o,"/");return/https:\/\/bitbucket.org\/?/gm.test(c)||(c+="scm/"),"".concat(c).concat(a,"/").concat(r);default:return""}};a.getCommonSource=function(e){var t=e.provider,a=e.owner,r=e.repo,n=e.url,l=e.secret,u=e.server;return"git"===t?{url:n,discover_branches:!0,credential_id:null==l?void 0:l.name}:{owner:a,repo:r,server_name:u,url:n,credential_id:null==l?void 0:l.name,discover_branches:1,discover_pr_from_forks:{strategy:2,trust:2},discover_pr_from_origin:2,discover_tags:!0}};a.checkRepoSource=function(e){var a=e.source_type,r=(0,c.default)(e,["source_type"]),n=(0,f.default)(r,"".concat(a,"_source"),{}),l=n.owner,u=n.repo,o=n.server_name,i=n.url,d=n.remote,p=l&&u;switch(a){case"svn":case"single_svn":p=!!d;break;case"git":p=!!i;break;case"gitlab":p=p&&o}if(!p)throw s.default.error(t("NOT_VALID_REPO")),Error(t("NOT_VALID_REPO"))};a.isSvnRepo=function(e){return["svn","single_svn"].includes(e)};var E=function(e){var t=e.match(/(.+)(>|>=|==|!=)(.+)/),a=(0,u.default)(t,4),r=a[1],n=a[2],l=a[3];return{key:r.replace(".param.",""),operator:n,value:l}},y=function(e,t){var a=(0,f.default)(t,e.key);switch(e.operator){case"==":return a===e.value;case">=":return a>=e.value;case"<=":return a<=e.value;case"!=":return a!==e.value;default:return!1}},g="argocd"===globals.config.gitopsEngine;a.isArgo=g;a.parseCondition=function(e,t){try{var a=e.match(/(.+?)(&&|\|\|)/g);if(!a)return y(E(e),t);var r=[].concat((0,l.default)(a.map((function(e){return e.slice(0,-2)}))),[e.slice(a.reduce((function(e,t){return e+t.length}),0))]).map(E);return a.map((function(e){return e.slice(-2)})).reduce((function(e,a,n){var l=0===n?y(r[0],t):e,u=y(r[n+1],t);switch(a){case"&&":return l&&u;case"||":return l||u;default:return!1}}),!1)}catch(e){return!1}}},,,,,,,,function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.disabledRuleConfig=t.BYTE_RULE_CONFIG=t.ITEM_RULE_CONFIG=t.BANDWIDTH_RULE_CONFIG=t.THROUGHPUT_RULE_CONFIG=t.DISK_MB_RULE_CONFIG=t.DISK_RULE_CONFIG=t.MEMORY_RULE_CONFIG=t.CPU_RULE_CONFIG=t.TIME_RULE_CONFIG=t.PERCENT_RULE_CONFIG=t.BASE_RULE_CONFIG=t.getBaseRuleConfig=t.SEVERITY_LEVEL=void 0,a(12),a(10),a(6),a(27),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var n=r(a(31));function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var o=[{label:">",value:">"},{label:">=",value:">="},{label:"<",value:"<"},{label:"<=",value:"<="}];t.SEVERITY_LEVEL=[{type:"critical",prefixIcon:"information",color:{primary:"#fae7e5",secondary:"#ca2621"},label:"CRITICAL_ALERT",value:"critical"},{type:"error",prefixIcon:"information",color:{primary:"#fae7e5",secondary:"#f5a623"},label:"ERROR_ALERT",value:"error"},{className:"tag-ffd939",prefixIcon:"information",color:{primary:"#fae7e5",secondary:"#FFD939"},label:"WARNING_ALERT",value:"warning"},{type:"secondary",prefixIcon:"information",color:{primary:"#fae7e5",secondary:"#79879c"},label:"INFO_ALERT",value:"info"}];var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.comparator,a=void 0===t?{}:t,r=e.thresholds,n=void 0===r?{}:r;return[u({name:"comparator",options:o,placeholder:"CONDITION_OPERATOR"},a),u({type:"number",name:"thresholds",placeholder:"THRESHOLD"},n)]};t.getBaseRuleConfig=c;var s=c({thresholds:{min:0}});t.BASE_RULE_CONFIG=s;var i=c({thresholds:{min:0,max:100,unit:"%"}});t.PERCENT_RULE_CONFIG=i;var f=c({thresholds:{min:0,max:1e4,unit:"s"}});t.TIME_RULE_CONFIG=f;var d=c({thresholds:{unit:"core",min:0}});t.CPU_RULE_CONFIG=d;var p=c({thresholds:{unit:"Mi",min:0}});t.MEMORY_RULE_CONFIG=p;var m=c({thresholds:{unit:"GB",min:0}});t.DISK_RULE_CONFIG=m;var h=c({thresholds:{unit:"MB",min:0}});t.DISK_MB_RULE_CONFIG=h;var v=c({thresholds:{unit:"KB/s",min:0}});t.THROUGHPUT_RULE_CONFIG=v;var E=c({thresholds:{unit:"Mbps",min:0,converter:function(e){return e*(Math.pow(1024,2)/8)}}});t.BANDWIDTH_RULE_CONFIG=E;var y=c({thresholds:{unit:"",min:0}});t.ITEM_RULE_CONFIG=y;var g=c({thresholds:{unit:"byte",min:0}});t.BYTE_RULE_CONFIG=g;var b=c({comparator:{disabled:!0,value:"-",options:[{label:"- ",value:"-"}]},thresholds:{disabled:!0,value:"-",type:"text"}});t.disabledRuleConfig=b},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(70),r(51),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(51),r(29),r(4),r(18),r(43),r(11),r(73);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(189),p=n(r(808)),m=n(r(26)),h=n(r(68)),v=r(243),E=r(56),y=r(61),g=n(r(898)),b=n(r(441));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=(0,v.observer)(l=function(e){(0,c.default)(r,e);var a=S(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).projectStore=new b.default,e.nameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:r,namespace:e.namespace,cluster:e.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e.projectValidator=function(e,t,a){a()},e.handleNameChange=(0,p.default)((function(t){var a=e.props,r=a.module,n=a.isFederated,l=(0,m.default)(e.fedFormTemplate,"metadata.labels",{});y.APP_LABEL_MODULES.includes(r)&&(l.app=t.slice(0,63)),(0,E.updateLabels)(e.fedFormTemplate,r,l),n&&y.APP_LABEL_MODULES.includes(r)&&(0,h.default)(e.formTemplate,"metadata.labels.app",t.slice(0,63))}),200),e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.maxNameLength,n=void 0===r?253:r,l=253===n?t("LONG_NAME_DESC"):t("NAME_DESC");return f.default.createElement(d.Form,{data:this.formTemplate,ref:a},f.default.createElement(d.Columns,null,f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("NAME"),desc:l,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:y.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:l})}]},f.default.createElement(d.Input,{name:"metadata.name",onChange:this.handleNameChange,maxLength:n,autoFocus:!0}))),f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:y.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},f.default.createElement(d.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),f.default.createElement(d.Columns,null,!this.props.namespace&&f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("PROJECT"),desc:t("SELECT_PROJECT_DESC"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")},{validator:this.projectValidator}]},f.default.createElement(g.default,{name:"metadata.namespace",cluster:this.props.cluster,defaultValue:this.namespace}))),f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},f.default.createElement(d.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))))}},{key:"cluster",get:function(){return this.props.cluster}},{key:"namespace",get:function(){return(0,m.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,m.default)(t,y.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,m.default)(this.formTemplate,"spec.template"):this.formTemplate}}]),r}(f.default.Component))||l;a.default=_},,,,,,,function(e,t,a){e.exports={footer:"_1WMMKdlgPJP8HpmV7ErYX0",rebalanceFooter:"_3F76rZJvolgVz7-vsSOWkY",form:"_3tPN78F46lD5kfG084VCUN",alert:"_1X_J55mhN5eJy0wnSJ2pTt",tips:"_1tYW3rzvJc_uMQ0NkDnvqE",autoBackupToggle:"_1D6snPJqcb_azVvtVFjGJV",autoBackupSetting:"_1N_2GVI6dr20-Rd1UtncoJ",formItem:"h2Fubg6ObXXG2H5an03nb",label:"_3-vh6NLtJiBGlZHRn5ndip",otherItems:"_1_0eixoO7ATqBczd7r0j46",addRuleRow:"_3GiUwHWU3kRZMWx02JvN6b",modalPadding:"_3-fp4OZMjVTRyLOFPgjy6J",rebalance:"_3PlWFKo389VW80SuC71P66",subTitle:"_3aY4r5FdC1aHn4J42EoV3Y",historyContainer:"_1WQysINpV3YlChN2wjjP8O",row:"O1E620GeBroxK3oug8z3D",time:"_2vXSlcGPQbRtZ-yIdeliSx",status:"_1y1hRCANq2uyk1g-iaOJRi",historyItem:"y2A7stXUPTKgkjrQRXUQK",advanced:"_2XK7rJSU93ZtweTKZRZk09",retentionTime:"EnZOPrLaNoHjkPomMuWgw",checkboxWrapper:"joPZ-akJHlFTj44jdzP75"}},,,,,function(e,a,r){"use strict";r(16);var n=r(19);r(192),r(98),r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(){return l.default.createElement(l.default.Fragment,null,l.default.createElement("div",{className:f.default.label},t("RULE_LABEL_SETTING")),l.default.createElement("div",{className:(0,u.default)(f.default.contentGroup,f.default.lineContent)},l.default.createElement(c.Form.Item,{label:t("RULE_LABEL_SETTING"),desc:t("RULE_LABEL_SETTING_DESC"),rules:[{validator:function(e,a,r){var n=Object.keys(null!=a?a:{});return n.some((function(e){return(0,s.default)(e)}))?r(t("EMPTY_KEY")):n.every((function(e){return/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)}))?void r():r(t("INCORRECT_KEY_DESC"))}}]},l.default.createElement(o.default,{name:"labels",addText:t("ADD"),controlled:!0,readOnlyKeys:i.LIMIT_RULE_LABELS_MAPPER}))))},r(192),r(98),r(9),r(4),r(30),r(195);var l=n(r(0)),u=n(r(5)),o=n(r(829)),c=r(189),s=n(r(67)),i=r(61),f=n(r(1756))},,,,,,,,,,function(e,t,a){e.exports={body:"_3XpBlmVgox84--EIeoh9fz",content:"_1F464iNseM7XiK3gfga5vM",licenseTip:"_2dX1tvwR7ipGdCOFkK1Zff",wrapper:"YfqK_u02oybtZ3G8fQioe",title:"vWoxrLipXpH0_9MujX0tS",tip:"_1Ioqq6AH-6kAmBtAqeShnj",container:"_1ff-HAmM9PkupcPF5IHG-g",tabs:"_3UVSHIgbB4j88-oDkYHXoW",active:"_2ZtuXPp-bDSkwl_xOknaDU",tooltipTrigger:"ADIqskK1YalArD57gBPYe",tipIcon:"_3j-9lnSWFemgYsnnZgoR2R",updateIcon:"V-EgOBnVouCHu_MYAMSXg",form:"_1mBCTvVb8kcquZWer2bcmr",confirm:"_2CpgnkNxBu6v2utr4FQUnF",confirmActive:"_28K21pPDNYL8rlm-fMFgr-",wrapperActive:"_2u6nNgENwc3ovcH_X5lWJ3",formContainer:"_1uFnFyG7d4K1XrJ471RRUu",footer:"_3eVjkRQJaFlSH1dxNxa8L-",panel:"hbM182I7vu3iJceuVUKlA"}},,function(e,t,a){e.exports={sider:"_3y7-mTgYjs2dHEX56ZcZlC",sheet:"_1VTQEGDBWPuUTtcgiyEAOC",title:"vlfMOA3JURdw5nk7WeIqH",delete:"_1kpyCW22GDVJh1I5gLyodh",edit:"_17i-NSdS-P7GUZCw1-YPnt",describtion:"_1ZLAf7WvHoqwp-0F-8tdTc",form:"_1LP-CIeypBa9wbadIjZn8d",name_input:"_1JAZWUE9yJWoVQUSCQPHM7",form_lable:"_5Q1qFPpM3eL-rJAdDuEs-",footer:"_3bSiW6kTLb3kTBF6VFFXXK",clickable:"_23bCX01Ss7OCfh3hJlUDtX",pipelineCard__item__drag:"_2c5vlHp7UGoWb30NL5EO4d",conditionList:"_3v2nj92lVAeDDd8IDTPLPt"}},,,,,,,,,function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.ALL_METRICS_CONFIG=t.RESOURCE_METRICS_CONFIG=void 0,a(12),a(10),a(6),a(27),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var n=r(a(31)),l=r(a(1738)),u=r(a(1740));function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s={node:l.default,workload:u.default};t.RESOURCE_METRICS_CONFIG=s;var i=c(c({},l.default),u.default);t.ALL_METRICS_CONFIG=i},function(e,t,a){"use strict";a(16);var r=a(19);a(14),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return l.default.createElement(u.Select,(0,n.default)({options:o.severityOptions,optionRenderer:function(e){var t=e.label,a=e.value;return l.default.createElement("span",{className:c.default[a],style:{paddingTop:2,paddingBottom:2}},t)},valueRenderer:function(e){var t=e.label,a=e.value;return l.default.createElement("span",{className:c.default[a]},t)},placeholder:" "},e,{name:e.name||"severity"}))};var n=r(a(317));a(14);var l=r(a(0)),u=a(189),o=a(922),c=r(a(1754))},,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var n=r(a(31)),l=r(a(50)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=r(a(26)),p=r(a(808));function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=function(e){(0,c.default)(a,e);var t=v(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={value:e.props.value},e.handleChange=function(t){var a=(0,d.default)(t,"currentTarget.value",t);e.setState({value:a}),e.change(a)},e.change=(0,p.default)((function(t){e.props.onChange(t)}),e.props.debounce),e}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.children;e.value,e.onChange;return t(h(h({},(0,l.default)(e,["children","value","onChange"])),{},{value:this.state.value,onChange:this.handleChange}))}}]),a}(f.default.Component);t.default=E},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(317)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=r(189),p=n(r(26)),m=n(r(0)),h=r(243),v=r(61),E=n(r(1441)),y=n(r(2654)),g=n(r(2655));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=(0,h.observer)(l=function(e){(0,s.default)(r,e);var a=b(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).groupRef=m.default.createRef(),t}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.store,n=e.module,l=e.cluster,o=e.prefix,c=e.isFederated,s=e.onlyMetaData,i=e.supportNodeGroupSelect,f=e.withEditCheck,h=e.formProps;return m.default.createElement(d.Form,(0,u.default)({data:this.fedFormTemplate,ref:a},f?h:{}),!s&&globals.app.hasClusterExtensionModule(l,"network")&&globals.app.hasExtensionModuleAnnotation("network","network.kubesphere.io/enable-network-ippool")&&!c&&m.default.createElement(E.default,{prefix:o,cluster:l,namespace:this.namespace,replicas:(0,p.default)(this.formTemplate,"spec.replicas"),rootStore:this.props.rootStore,formTemplate:this.formTemplate}),!s&&"daemonsets"!==n&&m.default.createElement(d.Form.Group,{label:t("SELECT_NODES"),desc:t("SELECT_NODES_DESC"),checkable:!0},m.default.createElement(g.default,{prefix:o,cluster:l,namespace:this.namespace,formTemplate:this.fedFormTemplate,data:this.fedFormTemplate,workspace:this.props.workspace,supportNodeGroupSelect:i})),m.default.createElement(d.Form.Group,{ref:this.groupRef,label:t("ADD_METADATA"),desc:t("ADD_METADATA_DESC"),keepDataWhenUnCheck:!0,checkable:!0},m.default.createElement(y.default,{store:r,module:n,cluster:l,namespace:this.namespace,formTemplate:this.formTemplate,isFederated:c,formGroupRef:this.groupRef})))}},{key:"namespace",get:function(){return(0,p.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,p.default)(t,v.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,p.default)(this.formTemplate,"spec.template"):this.formTemplate}},{key:"prefix",get:function(){return this.props.prefix||"spec.template.spec"}}]),r}(m.default.Component))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(70),r(36),r(98),r(14),r(4),r(18),r(11),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(36),r(98),r(29),r(14),r(4),r(18),r(43),r(11),r(40);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=l(r(26)),p=l(r(68)),m=l(r(196)),h=l(r(67)),v=l(r(119)),E=r(189),y=l(r(191)),g=l(r(800)),b=l(r(858)),S=l(r(1368)),_=l(r(824)),O=l(r(2711)),C=l(r(438)),T=l(r(1453)),R=l(r(2713));function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var k=function(e){(0,c.default)(r,e);var a=D(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).formRef=e.props.formRef||f.default.createRef(),e.verifyStore=new O.default,e.state={enabled:(0,d.default)(e.props.data,"receiver.spec.".concat(e.props.name,".enabled"),!1),isVerifying:!1},e.checkItemValid=function(e){var t=e.key&&e.operator;return t&&["In","NotIn"].includes(e.operator)&&(t=t&&e.values.length>0),"Match"===e.operator&&(t=t&&e.regexValue),t},e.itemValidator=function(a,r,n){return r?r.some((function(t){return!e.checkItemValid(t)}))?n({message:t("INVALID_NOTIFICATION_CONDITION")}):void n():n()},e.handleSwitch=function(t){e.setState({enabled:t})},e.handleVerify=function(){var a=e.props,r=a.user,n=a.getVerifyFormTemplate,l=a.onVerify,u=e.formRef.current;u&&u.validate((function(){var a=u.getData(),o=C.default.notificationVerify({user:r}),c=(0,v.default)(n(a)),s=c.config,i=c.receiver;l&&!l(a)||((0,p.default)(o,"config.spec",(0,d.default)(s,"spec",{})),(0,p.default)(o,"receiver.spec",(0,d.default)(i,"spec",{})),(0,h.default)(s)&&(0,m.default)(o,"config"),e.setState({isVerifying:!0}),e.verifyStore.checkInfo(o,{user:r}).then((function(a){e.setState({isVerifying:!1}),200===a.Status?y.default.success({content:t("SEND_TEST_MESSAGE_SUCCESS_DESC")}):y.default.error({content:a.Message})})))}))},e.handleSubmit=function(){var t=e.formRef.current;t&&t.validate((function(){e.props.onSubmit(t.getData())}))},e}return(0,o.default)(r,[{key:"renderEnableService",value:function(){var e=this.props,a=e.user,r=e.name,n=e.module,l=e.icon,u=e.noConfig,o=void 0===u||u,c=this.state.enabled;return a&&!o?f.default.createElement("div",{className:R.default.contentWrapper},f.default.createElement(E.Form.Item,{className:R.default.isHorizon,label:t(c?t("NOTIFICATION_ENABLED"):t("NOTIFICATION_DISABLED"))},f.default.createElement(S.default,{name:"receiver.spec.".concat(r,".enabled"),value:c,onChange:this.handleSwitch}))):f.default.createElement("div",{className:R.default.header},f.default.createElement(g.default,{className:R.default.title,icon:l,title:t("".concat(n.toUpperCase(),"_TITLE")),description:t("".concat(n.toUpperCase(),"_DESC"))}),!o&&f.default.createElement("div",{className:R.default.action},f.default.createElement(E.Form.Item,null,f.default.createElement(b.default,{name:"receiver.spec.".concat(r,".enabled"),text:t(c?t("ENABLED"):t("DISABLED")),checked:c,onChange:this.handleSwitch}))))}},{key:"renderControlAnnotation",value:function(){return f.default.createElement("div",{className:R.default.annotation},f.default.createElement(E.Icon,{name:"question"}),f.default.createElement("p",{className:R.default.desc},t.html("NOTIFICATION_CONDITION_SETTING_TIP")))}},{key:"renderControlSetting",value:function(){var e=this.props,a=e.name,r=e.user;return f.default.createElement(E.Form.Group,{label:t("FILTER_CONDITIONS"),desc:t("NOTIFICATION_CONDITION_SETTINGS_DESC"),checkable:!0,keepDataWhenUnCheck:Boolean(r)},f.default.createElement(E.Form.Item,{rules:[{validator:this.itemValidator,checkOnSubmit:!0}]},f.default.createElement(_.default,{name:"receiver.spec.".concat(a,".alertSelector.matchExpressions"),itemType:"object",addText:t("ADD"),checkItemValid:this.checkItemValid,desc:this.renderControlAnnotation()},f.default.createElement(T.default,null))))}},{key:"renderVerifyAction",value:function(){var e=this.state.isVerifying;return f.default.createElement("div",{className:R.default.contentWrapper},f.default.createElement("p",null,t("SEND_TEST_MESSAGE_DESC")),f.default.createElement(E.Button,{className:R.default.action,onClick:this.handleVerify,loading:e},t("SEND_TEST_MESSAGE")))}},{key:"renderFooterBtns",value:function(){var e=this.props,a=e.onCancel,r=e.isSubmitting;return f.default.createElement("div",{className:R.default.footer},f.default.createElement(E.Button,{onClick:a},t("CANCEL")),f.default.createElement(E.Button,{type:"control",loading:r,onClick:this.handleSubmit},t("OK")))}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.onChange,r=e.hideFooter,n=e.children,l=e.module,u=e.user;return f.default.createElement(E.Form,{ref:this.formRef,data:t,onChange:a},f.default.createElement("div",{className:R.default.formBody},this.renderEnableService(),f.default.createElement("div",{className:R.default.contentWrapper},n,("mail"!==l||"mail"===l&&u)&&this.renderControlSetting()),("mail"!==l||"mail"===l&&u)&&this.renderVerifyAction()),!r&&this.renderFooterBtns())}}]),r}(f.Component);a.default=k},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(41)),u=r(a(42)),o=r(a(37));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,o.default)(e);if(t){var n=(0,o.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var s=function(e){(0,l.default)(a,e);var t=c(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return(e=t.call.apply(t,[this].concat(l))).module="receivers",e}return a}(r(a(1063)).default);t.default=s},function(e,t,a){e.exports={pipelineCard:"uLmxymVsGkkYEf4yNccS6",pipelineCard__title:"_374bDv2bi1dgj-3Ep0nJtt","pipelineCard__title-error":"_2f_2SEsh5G2oZIyeNZAaOj",pipelineCard__content:"_1yZ2ddWm3YllTHSa1mSMac",pipelineCard__item:"_1j55rjwffi54nOaArMvQB2","pipelineCard-error":"rUnBDmlIjlvSq8C8rupWI",errorTip:"_1xCvRnuQl_HK5ABGqg_4Gt","pipelineCard-active":"_2RjzuvDfXn-yRmy6gVBXQ",content__title:"_1LbrO1eYXEftlLojLl8elX",content__title__error:"dL6e5rCCy45AlcnTNKd8c",content__title__noDetail:"dN_jyqpuK7-wjUCtyBwgQ",content__title__text:"_2i2A2H340NtX7tTERjbDnT",content__text:"_2TlASMvryC2WAexUpv5Pt5",content__detail:"_1EDW6C4SqJ_GXk04u0vtVo",pipeline_column:"_2Vr4U7R21ewKodQbQ3yxvA",addSteps:"_1XL2Tx9WZXsq6XUPqcr2-n",addBranchCard:"_1TrqGHHYXzKjWoHt9nGppf",conditions:"_1Clw9YoUbLC8bkdFwJyCp4",nestStage_content:"_8fLMHq9hBtobMpLMRVB6p",indentBorder:"pgY1DAUVAYW-QogDMobqg",nestsStage_detail:"_3vTIWGQ45B-Lpw4vdbSQIO"}},,,function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(20),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(321),r(18),r(43),r(30),r(11),r(69);var u=l(r(97)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(245)),m=l(r(1)),h=l(r(5)),v=l(r(950)),E=l(r(851)),y=l(r(852)),g=l(r(1108)),b=l(r(853)),S=r(803),_=l(r(3052));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var C=function(e){(0,s.default)(r,e);var a=O(r);function r(){var e;(0,o.default)(this,r);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(e=a.call.apply(a,[this].concat(l))).xTickFormatter=function(t){var a=e.props.interval.match(/\d+(\w+)/)||[],r=(0,u.default)(a,2)[1],n=void 0===r?"s":r,l=parseInt(t,10);return(0,p.default)(l).format({s:"HH:mm:ss",m:"HH:mm",h:"HH:mm",d:"MM/DD",M:"YYYY/MM",Y:"YYYY"}[n])},e.labelFormatter=function(a){var r=a,n=r+(0,S.timestampify)(e.props.interval),l=(0,p.default)(r),u=(0,p.default)(n),o=l.isSame(u,"day"),c="".concat("YYYY/MM/DD"," ").concat("HH:mm:ss"),s=l.format(c),i=u.format(c),f=o?"".concat(s," ~ ").concat(u.format("HH:mm:ss")):"".concat(s," ~ ").concat(i);return"".concat(t("TIME_RANGE")," : ").concat(f)},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.className,r=e.data,n=e.xKey,l=e.tooltipCursor;return d.default.createElement("div",{className:(0,h.default)(_.default.wrapper,a)},t,d.default.createElement(b.default,{width:"100%",height:"100%",debounce:1},d.default.createElement(g.default,{data:r},d.default.createElement(y.default,{dataKey:n,tickFormatter:this.xTickFormatter,tickLine:!1}),d.default.createElement(E.default,{cursor:l,labelFormatter:this.labelFormatter}),this.renderBars())))}},{key:"renderBars",value:function(){var e=this.props,t=e.legend,a=e.onBarClick;return t.map((function(e){var t=(0,u.default)(e,2),r=t[0],n=t[1];return d.default.createElement(v.default,{key:r,dataKey:r,onClick:a,name:n,maxBarSize:40})}))}}]),r}(d.Component);C.propTypes={title:m.default.string,xKey:m.default.string,onBarClick:m.default.func,tooltipCursor:m.default.oneOfType([m.default.object,m.default.bool]),data:m.default.array.isRequired,interval:m.default.string.isRequired,legend:m.default.arrayOf(m.default.array)},C.defaultProps={tooltipCursor:!1,onBarClick:function(){}};var T=C;a.default=T},,function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(20),r(99),r(8),r(9),r(4),r(18),r(30),r(11),r(69),r(817),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(62)),u=n(r(25)),o=n(r(28)),c=n(r(74)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(45));n(r(63));r(32),r(3),r(44),r(20),r(27),r(442),r(29),r(99),r(8),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(817);var p,m,h,v,E,y,g,b,S,_,O,C,T,R,D=n(r(97)),k=n(r(0)),N=n(r(1)),I=n(r(5)),P=r(17),A=r(243),w=n(r(26)),L=r(189),M=n(r(1040)),x=n(r(1041)),j=r(909),U=n(r(3054));function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var V=function(e){var t=e.match(/(\d+)(\w+)/),a=(0,D.default)(t,3),r=a[1],n=void 0===r?0:r,l=a[2];return n*{s:1,m:60,h:3600,d:86400}[void 0===l?"s":l]},G=(0,A.observer)((R=T=function(e){(0,s.default)(r,e);var a=F(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,l.default)(e,"searchWord",h,(0,c.default)(e)),(0,l.default)(e,"showDropDown",v,(0,c.default)(e)),e.duration=(0,P.observable)({end:Math.ceil(Date.now()/1e3),start:Math.ceil(Date.now()/1e3)-1800,step:"1m"}),e.inputRef=k.default.createRef(),(0,l.default)(e,"removeParam",E,(0,c.default)(e)),(0,l.default)(e,"changeSearchWord",y,(0,c.default)(e)),e.changeInputKey=function(t){13===t.keyCode&&e.handlerInputEnter()},(0,l.default)(e,"hiddenDropDown",g,(0,c.default)(e)),(0,l.default)(e,"changeNextQueryKey",b,(0,c.default)(e)),(0,l.default)(e,"showDurationMenu",S,(0,c.default)(e)),(0,l.default)(e,"removeParamsDuration",_,(0,c.default)(e)),(0,l.default)(e,"cancelChangeTime",O,(0,c.default)(e)),e.focus=function(){e.inputRef.current.focus()},(0,l.default)(e,"handleTimeChange",C,(0,c.default)(e)),e}return(0,o.default)(r,[{key:"handlerInputEnter",value:function(){var e=this.props,t=e.params,a=e.dropDownItems,r=e.onChange;if(this.searchWord.trim()){var n=t.nextParamsKey,l=this.searchWord.match(/([^:]+):(.+)/)||[],u=(0,D.default)(l,3),o=u[1],c=u[2],s=this.findParamKeyInDropDown(o);n?this.props.params.query.push({key:n,value:this.searchWord}):s?this.props.params.query.push({key:s,value:c}):this.props.params.query.push({key:Object.keys(a)[0],value:this.searchWord}),this.searchWord="",this.showDropDown=!0,t.nextParamsKey="",this.focus(),r()}}},{key:"findParamKeyInDropDown",value:function(e){return(Object.entries(this.props.dropDownItems).find((function(t){return(0,D.default)(t,2)[1].text===e}))||[])[0]}},{key:"render",value:function(){var e=this.props,t=e.enableClear,a=e.className;return k.default.createElement("div",{className:(0,I.default)(U.default.container,a),onClick:this.focus},this.renderParamsItems(),this.renderParamsDuration(),this.renderInput(),t&&this.renderClear(),this.showDurationDropDown&&this.renderTimeDuration())}},{key:"renderTimeDuration",value:function(){return k.default.createElement("div",{className:U.default.durationDropdown},k.default.createElement(M.default,{step:this.duration.step,times:this.durationTimes,onChange:this.handleTimeChange}),k.default.createElement(x.default,{className:U.default.customRange,step:this.duration.step,times:this.durationTimes,onSubmit:this.handleTimeChange,onCancel:this.cancelChangeTime,showStep:this.props.showStep}))}},{key:"renderParamsDuration",value:function(){var e=this.props.params,a=e.start,r=e.end,n=e.durationAlias;return a?k.default.createElement("span",{className:U.default.param,key:"_duration"},k.default.createElement("span",null,n?t("TIME_RANGE_LAST",{value:(0,j.getTimeLabel)(n)}):t("TIME_RANGE_RANGE",{startTime:(0,j.getDateStr)(a),endTime:(0,j.getDateStr)(r)})),k.default.createElement("span",{onClick:this.removeParamsDuration},k.default.createElement(L.Icon,{name:"close",className:U.default.removeParam,type:"light"}))):null}},{key:"renderParamsItems",value:function(){var e=this,t=this.props,a=t.dropDownItems;return t.params.query.map((function(t,r){var n=t.key,l=t.value;return n?k.default.createElement("span",{className:U.default.param,key:r},k.default.createElement("span",null,(0,w.default)(a,"".concat(n,".text")),": ",l),k.default.createElement("span",{"data-index":r,onClick:e.removeParam},k.default.createElement(L.Icon,{name:"close",className:U.default.removeParam,type:"light"}))):null}))}},{key:"renderFilterKey",value:function(){return this.currentParamText?k.default.createElement("span",{className:U.default.currentParam},this.currentParamText,":"):null}},{key:"renderInput",value:function(){return k.default.createElement("div",{className:U.default.input},this.renderFilterKey(),k.default.createElement("input",{type:"text",placeholder:t("SEARCH"),value:this.searchWord,ref:this.inputRef,disabled:this.showDurationDropDown,onChange:this.changeSearchWord,onFocus:this.changeSearchWord,onBlur:this.hiddenDropDown,onKeyUp:this.changeInputKey}),this.showDropDown&&this.renderDropdownContent())}},{key:"renderDropdownContent",value:function(){var e=this,a=this.props,r=a.dropDownItems,n=a.enableTimeDuration,l=a.dropdownClass,u=a.iconThem;return k.default.createElement("div",{className:(0,I.default)(U.default.dropdown,l)},Object.entries(r).map((function(t){var a=(0,D.default)(t,2),r=a[0],n=a[1];return k.default.createElement("div",{className:U.default.dropdownItem,key:r,onMouseDown:e.changeNextQueryKey,"data-query":r},k.default.createElement("span",{className:U.default.icon},n.imgUrl?k.default.createElement("img",{height:"100%",src:n.imgUrl}):k.default.createElement(L.Icon,{name:n.icon,type:u||"dark"})),k.default.createElement("span",null,n.text))})),n&&k.default.createElement("div",{className:U.default.dropdownItem,onMouseDown:this.showDurationMenu,key:"_time"},k.default.createElement("span",{className:U.default.icon},k.default.createElement(L.Icon,{name:"clock"})),k.default.createElement("span",null,t("TIME_RANGE_SCAP"))))}},{key:"renderClear",value:function(){}},{key:"durationTimes",get:function(){return(this.duration.end-this.duration.start)/V(this.duration.step)}},{key:"showDurationDropDown",get:function(){return this.props.enableTimeDuration&&"_time"===this.props.params.nextParamsKey}},{key:"currentParamText",get:function(){var e=this.props,a=e.dropDownItems,r=e.params;return"_time"===r.nextParamsKey?t("TIME_RANGE_SCAP"):(0,w.default)(a,"".concat(r.nextParamsKey,".text"))}}]),r}(k.default.Component),T.propType={params:N.default.object.isRequired,onChange:N.default.func,dropDownItems:N.default.object.isRequired,enableClear:N.default.bool,enableTimeDuration:N.default.bool},T.defaultProps={enableTimeDuration:!0,enableClear:!1,onChange:function(){}},m=R,h=(0,d.default)(m.prototype,"searchWord",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),v=(0,d.default)(m.prototype,"showDropDown",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),(0,d.default)(m.prototype,"durationTimes",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"durationTimes"),m.prototype),(0,d.default)(m.prototype,"showDurationDropDown",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"showDurationDropDown"),m.prototype),(0,d.default)(m.prototype,"currentParamText",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"currentParamText"),m.prototype),E=(0,d.default)(m.prototype,"removeParam",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.props,r=a.onChange,n=a.params,l=(0,w.default)(t,"currentTarget.dataset.index");n.query[l]={},r()}}}),y=(0,d.default)(m.prototype,"changeSearchWord",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.target.value,r=e.props.params;e.showDropDown=!r.nextParamsKey||!a,e.searchWord=a}}}),(0,d.default)(m.prototype,"handlerInputEnter",[P.action],Object.getOwnPropertyDescriptor(m.prototype,"handlerInputEnter"),m.prototype),g=(0,d.default)(m.prototype,"hiddenDropDown",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showDropDown=!1}}}),b=(0,d.default)(m.prototype,"changeNextQueryKey",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t.preventDefault();var a=(0,w.default)(t,"currentTarget.dataset.query");e.props.params.nextParamsKey=a,e.focus()}}}),S=(0,d.default)(m.prototype,"showDurationMenu",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.params.nextParamsKey="_time",e.searchWord="",e.showDropDown=!1}}}),_=(0,d.default)(m.prototype,"removeParamsDuration",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.props,a=t.params,r=t.onChange;a.start="",a.end="",a.step="",r()}}}),O=(0,d.default)(m.prototype,"cancelChangeTime",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.params.nextParamsKey=""}}}),C=(0,d.default)(m.prototype,"handleTimeChange",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.step,r=t.start,n=t.end,l=t.lastTime,u=e.props,o=u.params,c=u.onChange;o.step=a,o.durationAlias=l,l?(o.end=Math.ceil(Date.now()/1e3),o.start=Math.ceil(Date.now()/1e3)-V(l)):(o.end=n,o.start=r),o.nextParamsKey="",c()}}}),p=m))||p;a.default=G},,,,,,,function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(163)),d=n(r(67)),p=n(r(0)),m=n(r(1)),h=r(17),v=n(r(5)),E=n(r(798)),y=n(r(861)),g=n(r(1731));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var S=function(e){(0,c.default)(r,e);var a=b(r);function r(e){var t;return(0,u.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.props,a=e.onOk,r=e.onCancel,n=e.store,l=e.detail,u=t.editor.current.getData(),o=n.list,c=(0,h.toJS)(o.selectedRowKeys),s=c?c.filter((function(e){return e!==l.uid})):"";(0,f.default)(u)?r():(a(u),c&&o.setSelectRowKeys(s))},t.state={value:e.store?null:e.detail},t.editor=p.default.createRef(),t}return(0,o.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&!e.visible&&this.init(this.props)}},{key:"componentDidMount",value:function(){this.init(this.props)}},{key:"init",value:function(e){var t=this,a=e.yaml,r=e.detail,n=e.store,l=e.k8sVersion;if(a)return this.setState({value:a});r&&r.name&&n.fetchDetail(r,l).then((function(e){var a=n.deployedScheduleTemplate;(0,d.default)(a)?t.setState({value:e._originData}):t.setState({value:[e._originData,a]})}))}},{key:"render",value:function(){var e=this.props,a=e.readOnly,r=e.visible,n=e.onCancel,u=e.isSubmitting,o=a?t("VIEW_YAML"):t("EDIT_YAML"),c=a?"eye":"pen";return p.default.createElement(E.default,{icon:c,title:o,bodyClassName:(0,v.default)((0,l.default)({},g.default.readOnly,a)),onOk:this.handleOk,onCancel:n,okText:t("OK"),visible:r,closable:a,hideFooter:a,isSubmitting:u,fullScreen:!0},this.state.value&&p.default.createElement(y.default,{ref:this.editor,editorClassName:g.default.editor,value:this.state.value,readOnly:a}))}}]),r}(p.default.Component);a.default=S,S.propTypes={detail:m.default.object,yaml:m.default.object,visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool,readOnly:m.default.bool},S.defaultProps={visible:!1,isSubmitting:!1,readOnly:!1,detail:{},onOk:function(){},onCancel:function(){}}},,function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(6),a(14),a(4),a(18),a(11),a(111),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(6),a(29),a(14),a(4),a(18),a(43),a(11),a(111),a(7);var l=n(a(25)),u=n(a(28)),o=n(a(41)),c=n(a(42)),s=n(a(37)),i=r(a(0)),f=a(189),d=n(a(67)),p=n(a(163)),m=n(a(465)),h=n(a(5)),v=n(a(1763));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(a,e);var t=E(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).state={unit:e.unit},e.handleChange=function(t){var a=e.props.onChange,r=t.target.value;a((0,p.default)(r)||(0,d.default)(r)?"":"".concat(r).concat(e.state.unit))},e.handleUnitChange=function(t){var a=e.props.onChange;e.setState({unit:t},(function(){a((0,p.default)(e.value)||(0,d.default)(e.value)?"":"".concat(e.value).concat(t))}))},e}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.unitOptions,r=e.inputClassName,n=e.className;return i.default.createElement("div",{className:(0,h.default)(v.default.box,n)},i.default.createElement("div",{className:(0,h.default)(v.default.value,r)},i.default.createElement(f.Input,{name:t,onChange:this.handleChange,value:this.value})),i.default.createElement("div",{className:v.default.unit},i.default.createElement(f.Select,{value:this.state.unit,onChange:this.handleUnitChange,options:a})))}},{key:"unit",get:function(){var e=this.props,t=e.value,a=e.unitOptions,r=e.defaultValue||a[0].value;return a.forEach((function(e){(null==t?void 0:t.endsWith(e.value))&&(r=e.value)})),r}},{key:"value",get:function(){var e=this.props.value;return(0,m.default)(e,this.unit)}}]),a}(i.Component);t.default=y},,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.className,a=e.children,r=e.label;return n.default.createElement("div",{className:(0,l.default)(u.default.wrapper,t)},n.default.createElement("header",null,r),n.default.createElement("div",null,a))};var n=r(a(0)),l=r(a(5)),u=r(a(2459))},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.label,a=e.children,r=e.tips,c=e.className;return n.default.createElement("div",{className:(0,u.default)(o.default.wrapper,c)},n.default.createElement("label",{className:o.default.label},n.default.createElement("span",null,t),r&&n.default.createElement(l.Tooltip,{content:r},n.default.createElement(l.Icon,{name:"information"}))),n.default.createElement("div",{className:o.default.content},a))};var n=r(a(0)),l=a(189),u=r(a(5)),o=r(a(2461))},,function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(317)),u=n(r(50)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37));r(32),r(3),r(29),r(4),r(18),r(43),r(30),r(195),r(11);var p=n(r(0)),m=n(r(67)),h=r(189),v=n(r(5)),E=r(61),y=n(r(2549));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=/(?=.*?[A-Z])(?=.*?[a-z])/,S=/(?=.*?[~!@#$%^&*()\-_=+\\|\[\{\}\];:'",<.>/? ])/,_=/(?=.*?[0-9])/,O=function(e){if((0,m.default)(e))return-1;var t=0;return b.test(e)&&(t+=4),_.test(e)&&(t+=2),S.test(e)&&(t+=2),e.length>=6&&e<12?t+=2:e.length>=12&&(t+=4),E.PATTERN_PASSWORD.test(e)?t:0},C=function(e){(0,i.default)(r,e);var a=g(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={strength:-1,showTip:!1},e.ref=p.default.createRef(),e.handleChange=function(t,a){var r=e.props,n=r.withStrength,l=r.onChange;if(l&&l(t,a),n){var u=O(a);e.setState({strength:u,showTip:u>-1})}},e.handleDropdownClose=function(t){t&&t.target&&e.ref&&e.ref.current&&e.ref.current.contains(t.target)?e.setState({showTip:!0}):e.setState({showTip:!1})},e.handleInputClick=function(){var t=e.state.strength;e.setState({showTip:t>-1})},e.handleInputBlur=function(){e.setState({showTip:!1})},e.getColor=function(){var t=e.state.strength;return-1===t?{width:0,backgroundColor:"#fff"}:t>=0&&t<6?{width:"33%",backgroundColor:"#ca2621"}:t>=6&&t<8?{width:"66%",backgroundColor:"#f5a623"}:t>=8?{width:"100%",backgroundColor:"#55bc8a"}:void 0},e}return(0,s.default)(r,[{key:"renderStrengthContent",value:function(){var e=this.props.value,a=void 0===e?"":e;return p.default.createElement("div",{className:y.default.content},p.default.createElement("p",null,t("PASSWORD_MUST")),p.default.createElement("ul",{className:y.default.rules},p.default.createElement("li",null,p.default.createElement(h.Icon,{className:(0,v.default)(y.default.icon,(0,o.default)({},y.default.selected,b.test(a))),name:"check",size:12,type:"light"}),t("PASSWORD_LETTER")),p.default.createElement("li",null,p.default.createElement(h.Icon,{className:(0,v.default)(y.default.icon,(0,o.default)({},y.default.selected,_.test(a))),name:"check",size:12,type:"light"}),t("PASSWORD_NUMBER")),p.default.createElement("li",null,p.default.createElement(h.Icon,{className:(0,v.default)(y.default.icon,(0,o.default)({},y.default.selected,S.test(a))),name:"check",size:12,type:"light"}),t("PASSWORD_CHARACTERS")),p.default.createElement("li",null,p.default.createElement(h.Icon,{className:(0,v.default)(y.default.icon,(0,o.default)({},y.default.selected,a.length>=8)),name:"check",size:12,type:"light"}),t("PASSWORD_LENGTH"))),p.default.createElement("p",null,t("PASSWORD_STRENGTH"),":"),p.default.createElement("div",{className:y.default.barWrapper},p.default.createElement("div",{className:y.default.bar,style:this.getColor()})),p.default.createElement("p",{className:y.default.tip},t("PASSWORD_STRENGTH_DESC")))}},{key:"render",value:function(){var e=this.props,t=e.withStrength,a=e.tipClassName,r=(0,u.default)(e,["withStrength","tipClassName"]),n=this.state,o=n.showTip,c=n.strength;return t?p.default.createElement("div",{className:y.default.wrapper,ref:this.ref},p.default.createElement(h.Dropdown,{className:a,visible:o&&c>-1,content:this.renderStrengthContent(),placement:"bottomRight",closeAfterClick:!1,onClose:this.handleDropdownClose},p.default.createElement("div",{className:y.default.trigger})),p.default.createElement(h.InputPassword,(0,l.default)({},r,{onChange:this.handleChange,onBlur:this.handleInputBlur,onClick:this.handleInputClick}))):p.default.createElement(h.InputPassword,r)}}]),r}(p.default.Component);a.default=C},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(1)),m=n(r(5)),h=n(r(67)),v=n(r(914)),E=r(189),y=r(1060),g=n(r(2555));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=function(e){(0,s.default)(r,e);var a=b(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={inputValue:""},e.handleInputChange=function(t){var a,r;e.setState({inputValue:null!==(a=null==t||null===(r=t.target)||void 0===r?void 0:r.value)&&void 0!==a?a:t})},e.handleAdd=function(){var t=e.props,a=t.validate,r=t.onAdd,n=e.state.inputValue;a((0,v.default)(n))&&e.setState({inputValue:""},(function(){r((0,v.default)(n))}))},e.handleKeyUp=function(t){13===t.keyCode&&e.handleAdd()},e}return(0,c.default)(r,[{key:"renderInput",value:function(){var e=this.props,t=e.className,a=e.defaultSelectValue,r=e.options,n=e.onSelectChange,o=(0,u.default)(e,["className","defaultSelectValue","options","onSelectChange"]),c=this.state.inputValue;return(0,h.default)(r)?d.default.createElement(y.EmailInput,(0,l.default)({value:c,onKeyUp:this.handleKeyUp,onChange:this.handleInputChange},o)):d.default.createElement("div",{className:(0,m.default)(g.default.selectWrapper,t)},d.default.createElement(E.Input,{className:g.default.selectInput,onChange:this.handleInputChange,value:c,onKeyUp:this.handleKeyUp}),d.default.createElement(E.Select,{className:g.default.select,defaultValue:a,options:r,onChange:n}))}},{key:"render",value:function(){var e=this.props,a=e.className,r=e.title;return d.default.createElement("div",{className:a},r&&d.default.createElement("p",{className:g.default.title},r),d.default.createElement("div",{className:g.default.inputWrapper},this.renderInput(),d.default.createElement(E.Button,{className:"margin-l12",onClick:this.handleAdd},t("ADD"))))}}]),r}(d.default.Component);a.default=S,S.propTypes={title:p.default.string,defaultSelectValue:p.default.string,options:p.default.array,onSelectChange:p.default.func,onAdd:p.default.func,validate:p.default.func},S.defaultProps={title:"",defaultSelectValue:"",options:[],onAdd:function(){},onSelectChange:function(){},validate:function(){}}},,function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(88),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(18),r(30),r(11),r(71),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(88),r(121),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(321),r(21),r(18),r(43),r(30),r(11),r(71),r(7),r(110);var l=n(r(38)),u=n(r(31)),o=n(r(50));r(35);var c,s,i,f,d,p,m,h,v,E,y,g,b,S,_,O,C,T,R,D,k=n(r(39)),N=n(r(62)),I=n(r(25)),P=n(r(28)),A=n(r(74)),w=n(r(41)),L=n(r(42)),M=n(r(37)),x=n(r(45)),j=(n(r(63)),r(893)),U=n(r(119)),F=n(r(26)),V=n(r(64)),G=n(r(67)),B=n(r(140)),z=n(r(68)),Y=r(17),H=r(56),q=n(r(203)),K=n(r(330));function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,M.default)(e);if(t){var n=(0,M.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,L.default)(this,a)}}var X={headers:{"content-type":"application/x-www-form-urlencoded"}},Z=(c=function(e){(0,w.default)(de,e);var a,r,n,u,c,L,M,x,K,W,Z,$,ee,te,ae,re,ne,le,ue,oe,ce,se,ie,fe=J(de);function de(){var e;(0,I.default)(this,de);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=fe.call.apply(fe,[this].concat(a))).module="pipelines",(0,N.default)(e,"pipelineConfig",s,(0,A.default)(e)),(0,N.default)(e,"originalList",i,(0,A.default)(e)),(0,N.default)(e,"list",f,(0,A.default)(e)),(0,N.default)(e,"branchList",d,(0,A.default)(e)),(0,N.default)(e,"activityList",p,(0,A.default)(e)),(0,N.default)(e,"pullRequestList",m,(0,A.default)(e)),(0,N.default)(e,"credentialsList",h,(0,A.default)(e)),(0,N.default)(e,"detail",v,(0,A.default)(e)),(0,N.default)(e,"isLoading",E,(0,A.default)(e)),(0,N.default)(e,"notFound",y,(0,A.default)(e)),(0,N.default)(e,"repositoryLog",g,(0,A.default)(e)),(0,N.default)(e,"isSubmitting",b,(0,A.default)(e)),(0,N.default)(e,"pipelineJsonData",S,(0,A.default)(e)),(0,N.default)(e,"branchDetail",_,(0,A.default)(e)),(0,N.default)(e,"jenkinsFile",O,(0,A.default)(e)),(0,N.default)(e,"devops",C,(0,A.default)(e)),(0,N.default)(e,"devopsName",T,(0,A.default)(e)),(0,N.default)(e,"setPipelineConfig",R,(0,A.default)(e)),(0,N.default)(e,"setSelectRowKeys",D,(0,A.default)(e)),e.submitting=function(t){return e.isSubmitting=!0,t},e.saveAsFile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default.txt",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,j.saveAs)(a,t)},e}return(0,P.default)(de,[{key:"getPipelineUrl",value:function(e){var t=e.cluster,a=e.devops,r=e.name;return"".concat(this.getDevopsUrlV2({cluster:t,devops:a||this.devops}),"pipelines/").concat(decodeURIComponent(r),"/")}},{key:"fetchList",value:(ie=(0,k.default)(l.default.mark((function e(){var t,a,r,n,u,c,s,i,f,d,p,m,h,v,E,y,g,b=this,S=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=S.length>0&&void 0!==S[0]?S[0]:{},r=a.devops,a.workspace,n=a.devopsName,u=a.silent,c=a.cluster,s=(0,o.default)(a,["devops","workspace","devopsName","silent","cluster"]),u||(this.list.isLoading=!0),i=s.page,f=s.limit,d=s.name,p=s.filter,m=s.type,h=s.ascending,v=d?"".concat(encodeURIComponent(d)):void 0,E="".concat(this.getBaseUrl({cluster:c,devops:r}),"pipelines"),e.next=7,request.get(E,{page:i||1,limit:f||10,name:v,filter:p||void 0,type:m||void 0,ascending:h},{params:Q({},s)});case 7:y=e.sent,g=(null!==(t=y.items)&&void 0!==t?t:[]).filter((function(e){return!e.metadata.deletionTimestamp})).map((function(e){return Q({},b.mapper(e))})),this.setDevops(r),this.devopsName=n,this.list={data:g||[],total:y.totalItems||0,limit:parseInt(f,10)||10,page:parseInt(i,10)||1,filters:(0,B.default)(s,"devops","ascending"),selectedRowKeys:[],isLoading:!1};case 12:case"end":return e.stop()}}),e,this)}))),function(){return ie.apply(this,arguments)})},{key:"fetchDetail",value:(se=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,o,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.cluster,r=t.name,n=t.isSilent,u=t.devops,n||(this.isLoading=!0),e.next=4,request.get("".concat(this.getBaseUrl({devops:u,cluster:a})).concat(this.module,"/").concat(r));case 4:return o=e.sent,c=this.mapper(o),this.setPipelineConfig(o),this.detail=c,this.isLoading=!1,e.abrupt("return",c);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return se.apply(this,arguments)})},{key:"fetchDetailUntilEditModeNull",value:(ce=(0,k.default)(l.default.mark((function e(a){var r,n,u,o=this;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.cluster,n=a.name,u=a.devops,e.abrupt("return",new Promise((function(e,a){var c=setTimeout((function(){clearTimeout(o.timer),clearTimeout(c),a(t("CONNECTION_TIMEOUT"))}),6e4),s=function(){var t=(0,k.default)(l.default.mark((function t(){var a,i;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,request.get("".concat(o.getBaseUrl({devops:u,cluster:r})).concat(o.module,"/").concat(n));case 2:a=t.sent,i=o.mapper(a),clearTimeout(o.timer),(0,F.default)(i,"annotations['pipeline.devops.kubesphere.io/jenkinsfile.edit.mode']")?o.timer=setTimeout(s,1e3):(clearTimeout(c),e(i));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();s()})));case 2:case"end":return e.stop()}}),e)}))),function(e){return ce.apply(this,arguments)})},{key:"checkPipelineName",value:(oe=(0,k.default)(l.default.mark((function e(t){var a,r,n,u=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,r=t.cluster,n=t.devops,u.length>1&&void 0!==u[1]&&!u[1]){e.next=6;break}return e.next=5,request.get(this.getPipelineUrl({cluster:r,name:a,devops:n}),{},{headers:{"x-check-exist":!0}});case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,request.get("/kapis/devops.kubesphere.io/v1alpha2".concat(this.getPath({cluster:r,devops:n}),"/pipelines/").concat(a),{check:!0});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return oe.apply(this,arguments)})},{key:"getJenkinsFile",value:(ue=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,o,c=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.cluster,r=t.name,n=t.devops,u=c.length>1&&void 0!==c[1]&&c[1],this.pipelineJsonData.isLoading=!0,e.t0=u,!e.t0){e.next=7;break}return e.next=7,this.fetchDetail({cluster:a,name:r,devops:n});case 7:this.jenkinsFile=(0,F.default)(this.pipelineConfig,"spec.pipeline.jenkinsfile",""),o=(0,F.default)(this.pipelineConfig,"metadata.annotations['pipeline.devops.kubesphere.io/jenkinsfile']"),this.pipelineJsonData={pipelineJson:o?{json:JSON.parse(o)}:void 0,isLoading:!1};case 10:case"end":return e.stop()}}),e,this)}))),function(e){return ue.apply(this,arguments)})},{key:"setPipelineJsonData",value:function(e){this.pipelineJsonData={pipelineJson:e?{json:JSON.parse(e)}:void 0,isLoading:!1}}},{key:"convertJenkinsFileToJson",value:(le=(0,k.default)(l.default.mark((function e(t,a,r,n,u){var o,c,s,i;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u&&(this.isSubmitting=!0),o=a&&"default"!==a?"/klusters/".concat(a):"",e.next=4,request.put("/kapis/devops.kubesphere.io/v1alpha3".concat(o,"/namespaces/").concat(r,"/pipelines/").concat(n,"/jenkinsfile?mode=raw"),{data:t},{headers:{"content-type":"application/json"}});case 4:return c="raw",e.prev=5,e.next=8,this.fetchDetailUntilEditModeNull({cluster:a,devops:r,name:n});case 8:i=e.sent,s=(0,F.default)(i,'annotations["pipeline.devops.kubesphere.io/jenkinsfile"]'),c="",e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),c="raw",s=void 0;case 17:return e.prev=17,u&&(this.isSubmitting=!1),e.finish(17);case 20:return e.abrupt("return",{mode:c,jsonData:s});case 21:case"end":return e.stop()}}),e,this,[[5,13,17,20]])}))),function(e,t,a,r,n){return le.apply(this,arguments)})},{key:"getPullRequest",value:(ne=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,c,s,i,f,d;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,r=t.devops,t.workspace,n=t.cluster,u=(0,o.default)(t,["name","devops","workspace","cluster"]),c=decodeURIComponent(a),s=u.page,i=u.limit,f=void 0===i?10:i,!(0,G.default)(this.detail)){e.next=6;break}return e.next=6,this.fetchDetail({name:c,devops:r});case 6:return e.next=8,request.get("".concat(this.getBaseUrl({cluster:n,namespace:r}),"pipelines/").concat(decodeURIComponent(a),"/branches"),{filter:"pull-requests",page:s||1,limit:f});case 8:d=e.sent,Array.isArray(d.items)&&d.items.forEach((function(e){e.id=e.latestRun.endTime})),this.pullRequestList={data:d.items||[],total:d.totalItems||0,limit:f,page:parseInt(s,10)||1,filters:(0,B.default)(u,"devops"),isLoading:!1,selectedRowKeys:[]};case 11:case"end":return e.stop()}}),e,this)}))),function(e){return ne.apply(this,arguments)})},{key:"getBranches",value:(re=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,c,s,i,f,d,p;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.cluster,r=t.devops,n=t.name,u=t.branch,c=(0,o.default)(t,["cluster","devops","name","branch"]),s=decodeURIComponent(n),i=c.page,f=c.limit,d=void 0===f?10:f,!(0,G.default)(this.detail)){e.next=6;break}return e.next=6,this.fetchDetail({cluster:a,name:s,devops:r});case 6:return e.next=8,request.get("".concat(this.getBaseUrl({cluster:a,namespace:r}),"pipelines/").concat(decodeURIComponent(n),"/branches"),{filter:"origin",page:i||1,limit:d,branch:encodeURIComponent(u)});case 8:p=e.sent,this.branchList={data:p.items||[],limit:d,total:p.totalItems||0,page:parseInt(i,10)||1,filters:(0,B.default)(c,"devops"),isLoading:!1,selectedRowKeys:[]};case 10:case"end":return e.stop()}}),e,this)}))),function(e){return re.apply(this,arguments)})},{key:"getActivities",value:(ae=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,c,s,i,f,d,p,m,h;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,r=t.branch,n=t.devops,u=t.cluster,c=t.backward,s=void 0!==c&&c,i=(0,o.default)(t,["name","branch","devops","cluster","backward"]),a=decodeURIComponent(a),f=i.page,d=i.limit,p=void 0===d?10:d,!(0,G.default)(this.detail)){e.next=6;break}return e.next=6,this.fetchDetail({cluster:u,name:a,devops:n});case 6:return m={page:f||1,limit:p,branch:r,backward:s},f<0&&(delete m.page,delete m.limit),e.next=10,request.get("".concat(this.getBaseUrl({cluster:u,namespace:n}),"pipelines/").concat(a,"/pipelineruns"),Q({},m));case 10:return h=e.sent,(0,V.default)(h)&&(h=h.filter((function(e){return e._links}))),!1===s&&!(0,G.default)(h)&&(0,V.default)(h.items)&&(h.items=h.items.map((function(e){var t,a=(0,H.safeParseJSON)((0,F.default)(e,"metadata.annotations.['devops.kubesphere.io/jenkins-pipelinerun-status']"),{});return Q(Q({},a),{},{id:null!==(t=a.id)&&void 0!==t?t:(0,F.default)(e,'metadata.annotations["devops.kubesphere.io/jenkins-pipelinerun-id"]'),uid:e.metadata.uid,_originData:e})}))),this.activityList={limit:p,data:h.items||[],total:h.totalItems||0,page:parseInt(f,10)||1,filters:(0,B.default)(i,"devops"),isLoading:!1,selectedRowKeys:[]},e.abrupt("return",h.items);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return ae.apply(this,arguments)})},{key:"getBranchDetail",value:(te=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.devops,r=t.cluster,n=t.name,u=t.branch,e.prev=1,e.next=4,request.get("".concat(this.getBaseUrl({cluster:r,namespace:a}),"pipelines/").concat(decodeURIComponent(n),"/branches/").concat(encodeURIComponent(u)));case 4:return(o=e.sent).name&&(this.branchDetail=o),e.abrupt("return",o);case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return te.apply(this,arguments)})},{key:"handleActivityReplay",value:(ee=(0,k.default)(l.default.mark((function e(t,a){var r,n,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.url,n=t.devops,u=t.name,o=t.cluster,e.next=3,request.post("".concat(this.getPipelineUrl({cluster:o,devops:n,name:u})).concat(r,"/replay/"),void 0,void 0,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return ee.apply(this,arguments)})},{key:"handleActivityStop",value:($=(0,k.default)(l.default.mark((function e(t){var a,r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.url,r=t.devops,n=t.name,u=t.cluster,e.next=3,request.post("".concat(this.getPipelineUrl({cluster:u,devops:r,name:n})).concat(a,"/stop/?blocking=true&timeOutInSecs=10"));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return $.apply(this,arguments)})},{key:"runBranch",value:(Z=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,o,c,s,i=this;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.cluster,r=t.devops,n=t.name,u=t.branch,o=t.parameters,c="".concat(this.getBaseUrl({cluster:a,namespace:r}),"pipelines/").concat(n,"/pipelineruns").concat(u?"?branch=".concat(encodeURIComponent(u)):""),s=(0,G.default)(o)?{parameters:[]}:{parameters:o},e.next=5,request.post(c,s).then((function(){setTimeout((function(){i.fetchDetail({cluster:a,devops:r,name:n,isSilent:!0})}),1e3)}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return Z.apply(this,arguments)})},{key:"getPipeLineConfig",value:function(){var e=(0,U.default)((0,Y.toJS)(this.pipelineConfig));return delete(e=Q(Q({},(0,Y.toJS)(e.spec)),(0,Y.toJS)(e))).spec,delete e.kind,delete e.apiVersion,e}},{key:"setDevops",value:function(e){this.devops=e}},{key:"createPipeline",value:(W=(0,k.default)(l.default.mark((function e(t){var a,r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,r=t.devops,n=t.cluster,a.kind="Pipeline",a.apiVersion="devops.kubesphere.io/v1alpha3",u="".concat(this.getBaseUrl({devops:r,cluster:n}),"pipelines"),e.next=6,request.post(u,a);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return W.apply(this,arguments)})},{key:"updatePipeline",value:(K=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.cluster,r=t.data,n=t.devops,r.kind="Pipeline",r.apiVersion="devops.kubesphere.io/v1alpha3",u="".concat(this.getBaseUrl({devops:n,cluster:a}),"pipelines/").concat(r.metadata.name),e.next=6,request.put(u,r);case 6:return o=e.sent,this.setPipelineConfig(o),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return K.apply(this,arguments)})},{key:"updateJenkinsFile",value:function(e){var t=(0,U.default)((0,Y.toJS)(this.pipelineConfig));(0,z.default)(t,"spec.pipeline.jenkinsfile",e),this.setPipelineConfig(t)}},{key:"delete",value:(x=(0,k.default)(l.default.mark((function e(t){var a,r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,r=t.devops,n=t.cluster,u="".concat(this.getBaseUrl({devops:r,cluster:n}),"pipelines/").concat(a),e.next=4,request.delete(u);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"scanRepository",value:(M=(0,k.default)(l.default.mark((function e(t){var a,r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.devops,r=t.name,n=t.cluster,u={},e.next=4,request.defaults({method:"POST",url:"".concat(this.getPipelineUrl({cluster:n,devops:a||this.devops,name:r||this.detail.name}),"scan"),options:u,handler:function(e){return e.text().then((function(){if(e.redirected)return"Scan success"}))}});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)})},{key:"getRepoScanLogs",value:(L=(0,k.default)(l.default.mark((function e(t){var a,r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.devops,r=t.name,n=t.cluster,e.next=3,request.get("".concat(this.getPipelineUrl({cluster:n,name:r,devops:a}),"consolelog"));case 3:u=e.sent,this.repositoryLog=u;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return L.apply(this,arguments)})},{key:"checkCron",value:(c=(0,k.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,request.get("".concat(this.getDevopsUrlV2(),"check/cron?value=").concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"checkScriptCompile",value:(u=(0,k.default)(l.default.mark((function e(t,a){var r,n,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.devops,n=t.pipeline,u=t.value,o=t.cluster,e.abrupt("return",request.post("".concat(this.getPipelineUrl({cluster:o,name:n,devops:r}),"checkScriptCompile"),{value:u},X,a));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"getBranchLists",value:(n=(0,k.default)(l.default.mark((function e(t){var a,r,n,u,c,s,i;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.devops,r=t.name,t.workspace,n=t.cluster,u=(0,o.default)(t,["devops","name","workspace","cluster"]),c=u.page,s=u.limit,i=void 0===s?10:s,e.next=4,request.get("".concat(this.getPipelineUrl({cluster:n,name:r,devops:a}),"branches/"),{filter:"origin",start:(c-1)*i||0,limit:i});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getPipelineTemplateList",value:(r=(0,k.default)(l.default.mark((function e(t){var a,r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="zh"===(0,q.default)("lang")?"ZH":"EN",e.next=3,request.get("".concat(this.getBaseUrl(t),"clustertemplates?limit=100"));case 3:return r=e.sent,n=r.items,u=(void 0===n?[]:n).map((function(e){var t={},r=(0,F.default)(e,"metadata.annotations",{}),n=r["devops.kubesphere.io/icon"];return t.type=e.metadata.name,t.desc=r["devops.kubesphere.io/description".concat(a)]||r["devops.kubesphere.io/descriptionEN"],t.title=r["devops.kubesphere.io/displayName".concat(a)]||r["devops.kubesphere.io/displayNameEN"]||r.displayNameEN,t.image=n&&n.indexOf("http")>-1?n:"/extensions-static/ks-console-embed/dist/v3dist/assets/pipeline/".concat(n),t.parameters=(0,F.default)(e,"spec.parameters",[]),t})),e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getTempleJenkins",value:(a=(0,k.default)(l.default.mark((function e(t,a,r){var n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,request.post("".concat(this.getBaseUrl(r),"clustertemplates/").concat(t,"/render"),a);case 2:return n=e.sent,u=(0,F.default)(n,'metadata.annotations["devops.kubesphere.io/render-result"]',""),e.abrupt("return",u);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return a.apply(this,arguments)})}]),de}(K.default),s=(0,x.default)(c.prototype,"pipelineConfig",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),i=(0,x.default)(c.prototype,"originalList",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=(0,x.default)(c.prototype,"list",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),d=(0,x.default)(c.prototype,"branchList",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),p=(0,x.default)(c.prototype,"activityList",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),m=(0,x.default)(c.prototype,"pullRequestList",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0,selectedRowKeys:[]}}}),h=(0,x.default)(c.prototype,"credentialsList",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],total:0,isLoading:!0}}}),v=(0,x.default)(c.prototype,"detail",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),E=(0,x.default)(c.prototype,"isLoading",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),y=(0,x.default)(c.prototype,"notFound",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=(0,x.default)(c.prototype,"repositoryLog",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),b=(0,x.default)(c.prototype,"isSubmitting",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=(0,x.default)(c.prototype,"pipelineJsonData",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{pipelineJson:{},isLoading:!0}}}),_=(0,x.default)(c.prototype,"branchDetail",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),O=(0,x.default)(c.prototype,"jenkinsFile",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),C=(0,x.default)(c.prototype,"devops",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),T=(0,x.default)(c.prototype,"devopsName",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),(0,x.default)(c.prototype,"fetchList",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchList"),c.prototype),(0,x.default)(c.prototype,"fetchDetail",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchDetail"),c.prototype),R=(0,x.default)(c.prototype,"setPipelineConfig",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.pipelineConfig=t}}}),D=(0,x.default)(c.prototype,"setSelectRowKeys",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.list.selectedRowKeys.replace(t)}}}),(0,x.default)(c.prototype,"checkPipelineName",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"checkPipelineName"),c.prototype),(0,x.default)(c.prototype,"getJenkinsFile",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"getJenkinsFile"),c.prototype),(0,x.default)(c.prototype,"setPipelineJsonData",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"setPipelineJsonData"),c.prototype),(0,x.default)(c.prototype,"convertJenkinsFileToJson",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"convertJenkinsFileToJson"),c.prototype),(0,x.default)(c.prototype,"getPullRequest",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"getPullRequest"),c.prototype),(0,x.default)(c.prototype,"getBranches",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"getBranches"),c.prototype),(0,x.default)(c.prototype,"getActivities",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"getActivities"),c.prototype),(0,x.default)(c.prototype,"getBranchDetail",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"getBranchDetail"),c.prototype),(0,x.default)(c.prototype,"getPipeLineConfig",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"getPipeLineConfig"),c.prototype),(0,x.default)(c.prototype,"setDevops",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"setDevops"),c.prototype),(0,x.default)(c.prototype,"createPipeline",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"createPipeline"),c.prototype),(0,x.default)(c.prototype,"updatePipeline",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"updatePipeline"),c.prototype),(0,x.default)(c.prototype,"updateJenkinsFile",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"updateJenkinsFile"),c.prototype),(0,x.default)(c.prototype,"delete",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"delete"),c.prototype),(0,x.default)(c.prototype,"scanRepository",[Y.action],Object.getOwnPropertyDescriptor(c.prototype,"scanRepository"),c.prototype),c);a.default=Z},function(e,t,a){e.exports={CodeEditor:"_2IGErYZEo2u6vShZitIa79",clickable:"_3ylLQDoZRYBuC4tQG6Htw1",dockerCredentialsContent:"N9fZkoawlX7Y5WKvAn_3z",dockerCredentialsContent__title:"lssVHY8sKSk5ISt0jEvk2",dockerCredentialsContent__content:"_2VLKA_dumPxcwW_D1Rk5Wf",dockerCredentialsContent__trashicon:"_3ibKRdFB6iCNX3nffBkdnD",desc:"_2937jTLnfbzlio0BxmAZm0",info:"_1KJL6X1lqIBhGp1B7GBRMd",columns:"_2g2Tfmk-iTKCRSCInv4oFD"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(20),a(14),a(24),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(121),a(20),a(27),a(29),a(14),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(7);var n=r(a(38)),l=r(a(58)),u=r(a(31)),o=r(a(50));a(35);var c,s,i,f,d=r(a(39)),p=r(a(62)),m=r(a(25)),h=r(a(28)),v=r(a(74)),E=r(a(41)),y=r(a(42)),g=r(a(37)),b=r(a(45)),S=(r(a(63)),r(a(140))),_=a(17);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,g.default)(e);if(t){var n=(0,g.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,y.default)(this,a)}}var R=(c=function(e){(0,E.default)(g,e);var t,a,r,u,c,y=T(g);function g(){var e;(0,m.default)(this,g);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=y.call.apply(y,[this].concat(a))).module="codeRepos",(0,p.default)(e,"list",s,(0,v.default)(e)),(0,p.default)(e,"detail",i,(0,v.default)(e)),e.getListUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat(e.apiVersion).concat(e.getPath(t),"/gitrepositories").concat(t.dryRun?"?dryRun=All":"")},e.getResourceUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat(e.apiVersion).concat(e.getPath(t),"/gitrepositories")},e.getDetailUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat(e.getListUrl(t),"/").concat(t.name)},(0,p.default)(e,"setSelectRowKeys",f,(0,v.default)(e)),e}return(0,h.default)(g,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.namespace,a=e.cluster,r="";return a&&(r+="/klusters/".concat(a)),t&&(r+="/namespaces/".concat(t)),r}},{key:"fetchList",value:(c=(0,d.default)(n.default.mark((function e(){var t,a,r,u,c,s,i,f,d=this,p=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},a=t.devops,t.workspace,r=t.cluster,u=t.more,c=(0,o.default)(t,["devops","workspace","cluster","more"]),this.list.isLoading=!0,c.limit!==1/0&&-1!==c.limit||(c.limit=-1,c.page=1),c.limit=c.limit||10,s="".concat(this.getResourceUrl({namespace:a,cluster:r})),e.next=7,request.get(s,C({},c),{},(function(){return[]}));case 7:return i=e.sent,f=Array.isArray(i.items)?i.items.map((function(e){return C({},d.mapper(C(C({},e),{},{devops:a})))})):[],this.list.update(C(C({data:u?[].concat((0,l.default)(this.list.data),(0,l.default)(f)):f,total:i.totalItems||i.total_count||f.length||0},c),{},{limit:Number(c.limit)||10,page:Number(c.page)||1,isLoading:!1},this.list.silent?{}:{selectedRowKeys:[]})),e.abrupt("return",f);case 11:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"create",value:(u=(0,d.default)(n.default.mark((function e(t){var a,r,l,u,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,r=t.devops,l=t.cluster,u="".concat(this.getResourceUrl({namespace:r,cluster:l})),e.next=4,request.post(u,a);case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"edit",value:(r=(0,d.default)(n.default.mark((function e(t){var a,r,l,u,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,r=t.devops,l=t.name,u=t.cluster,o="".concat(this.getResourceUrl({namespace:r,cluster:u}),"/").concat(l),e.abrupt("return",this.submitting(request.put(o,a)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"update",value:(a=(0,d.default)(n.default.mark((function e(t,a){var r;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(this.getResourceUrl({namespace:t.devops,cluster:t.cluster}),"/").concat(a.metadata.name),e.abrupt("return",this.submitting(request.put(r,a)));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"delete",value:function(e){var t=(0,S.default)(C(C({},e),{},{namespace:e.devops}),"devops");return this.submitting(request.delete(this.getDetailUrl(t)))}},{key:"fetchDetail",value:(t=(0,d.default)(n.default.mark((function e(t){var a,r,l;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.getResourceUrl({namespace:t.devops,cluster:t.cluster}),"/").concat(t.name),e.next=3,this.submitting(request.get(a),null,null,(function(){return{}}));case 3:return r=e.sent,l=this.mapper(r),this.detail=l,e.abrupt("return",l);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),g}(r(a(49)).default),s=(0,b.default)(c.prototype,"list",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",filters:{},isLoading:!1,selectedRowKeys:[]}}}),i=(0,b.default)(c.prototype,"detail",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),f=(0,b.default)(c.prototype,"setSelectRowKeys",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.list.selectedRowKeys=t}}}),(0,b.default)(c.prototype,"fetchList",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchList"),c.prototype),(0,b.default)(c.prototype,"create",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"create"),c.prototype),(0,b.default)(c.prototype,"edit",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"edit"),c.prototype),(0,b.default)(c.prototype,"update",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"update"),c.prototype),(0,b.default)(c.prototype,"delete",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"delete"),c.prototype),(0,b.default)(c.prototype,"fetchDetail",[_.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchDetail"),c.prototype),c);t.default=R},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.className,a=e.title,r=e.description;return n.default.createElement("div",{className:(0,l.default)(u.default.text,t)},n.default.createElement("div",null,a),n.default.createElement("p",null,r))},a(12),a(109);var n=r(a(0)),l=r(a(5)),u=r(a(2341))},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(20),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(14),a(4),a(18),a(43),a(11);var l=n(a(317)),u=n(a(50)),o=n(a(25)),c=n(a(28)),s=n(a(41)),i=n(a(42)),f=n(a(37)),d=r(a(0)),p=a(189),m=n(a(805)),h=n(a(2358));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var E=function(e){(0,s.default)(a,e);var t=v(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).handleSelectChange=function(t){var a=e.props,r=a.name;(0,a.onChange)(t,r)},e.handleNumberChange=function(t){var a=e.props,r=a.name;(0,a.onChange)(t,r)},e.handleInputChange=function(t){var a=e.props,r=a.name;(0,a.onChange)(t.target.value,r)},e}return(0,c.default)(a,[{key:"render",value:function(){var e=this.props,t=e.param,a=(0,u.default)(e,["param"]);if(t.options){var r=t.options.map((function(e){return{label:e,value:e}}));return d.default.createElement(p.Select,(0,l.default)({options:r},a,{onChange:this.handleSelectChange}))}return"integer"===t.type?d.default.createElement(m.default,(0,l.default)({className:h.default.number,min:t.min,unit:t.unit},a,{onChange:this.handleNumberChange,showUnit:!0})):d.default.createElement(p.Input,(0,l.default)({},a,{onChange:this.handleInputChange}))}}]),a}(d.Component);t.default=E},,function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(21),r(200),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(200),r(18),r(43),r(11),r(7);var l=n(r(38));r(35);var u,o,c,s,i,f,d,p,m,h,v,E,y=n(r(39)),g=n(r(31)),b=n(r(62)),S=n(r(25)),_=n(r(28)),O=n(r(74)),C=n(r(41)),T=n(r(42)),R=n(r(37)),D=n(r(45)),k=(n(r(63)),n(r(0))),N=n(r(1)),I=n(r(26)),P=n(r(68)),A=r(17),w=r(243),L=n(r(798)),M=r(189),x=n(r(1164)),j=r(61),U=n(r(2398));function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){(0,g.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,R.default)(e);if(t){var n=(0,R.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,T.default)(this,a)}}var B=(0,w.observer)((E=v=function(e){(0,C.default)(n,e);var a,r=G(n);function n(e){var a;return(0,S.default)(this,n),(a=r.call(this,e)).clearData=function(){a.formData={},a.isSubmitting=!1,a.type="username_password"},(0,b.default)(a,"formData",c,(0,O.default)(a)),(0,b.default)(a,"type",s,(0,O.default)(a)),(0,b.default)(a,"kubeconfig",i,(0,O.default)(a)),(0,b.default)(a,"isSubmitting",f,(0,O.default)(a)),(0,b.default)(a,"isGetConfigLoading",d,(0,O.default)(a)),(0,b.default)(a,"fetchKubeConfig",p,(0,O.default)(a)),(0,b.default)(a,"handleOk",m,(0,O.default)(a)),(0,b.default)(a,"handleTypeChange",h,(0,O.default)(a)),a.nameValidator=function(e,r,n){var l=a.props,u=l.devops,o=l.cluster,c=l.isEditMode;if(!r||c)return n();a.store.checkName({name:r,devops:u,cluster:o}).then((function(a){if(a.exist)return n({message:t("CREDENTIAL_NAME_EXIST_DESC"),field:e.field});n()}))},a.renderCredentForm=function(){switch(a.type){case"ssh":return k.default.createElement(k.default.Fragment,null,k.default.createElement(M.Form.Item,{label:t("USERNAME")},k.default.createElement(M.Input,{name:"ssh.username"})),k.default.createElement(M.Form.Item,{label:t("PRIVATE_KEY")},k.default.createElement(M.TextArea,{name:"ssh.private_key"})),k.default.createElement(M.Form.Item,{label:t("PASSPHRASE")},k.default.createElement(M.Input,{type:"password",name:"ssh.passphrase"})));case"username_password":return k.default.createElement(k.default.Fragment,null,k.default.createElement(M.Form.Item,{label:t("USERNAME")},k.default.createElement(M.Input,{name:"username_password.username",defaultValue:"admin",disabled:a.props.sourceType&&"github"===a.props.sourceType})),k.default.createElement(M.Form.Item,{label:t("PASSWORD_TOKEN")},k.default.createElement(M.Input,{name:"username_password.password",type:"password"})));case"secret_text":return k.default.createElement(k.default.Fragment,null,k.default.createElement(M.Form.Item,{label:t("TOKEN")},k.default.createElement(M.TextArea,{name:"secret_text.secret"})));case"kubeconfig":return k.default.createElement(M.Form.Item,{className:U.default.narrowItem,label:t("CONTENT"),desc:t("KUBECONFIG_CONTENT_DESC")},a.isGetConfigLoading?k.default.createElement(M.Loading,null,k.default.createElement(M.TextArea,{name:"kubeconfig.content",defaultValue:a.kubeconfig})):k.default.createElement(M.TextArea,{name:"kubeconfig.content",defaultValue:a.kubeconfig}));default:return null}},a.formRef=k.default.createRef(),a.store=new x.default,e.formTemplate&&(a.formData=e.formTemplate,a.type=e.formTemplate.type,a.formData[a.type]=V({},a.formData.data)),e.credentialType&&(a.type=e.credentialType,a.formData.type=e.credentialType),a.username=(0,I.default)(globals,"user.username",""),a}return(0,_.default)(n,[{key:"componentDidMount",value:function(){"kubeconfig"!==this.type||this.props.isEditMode||this.fetchKubeConfig()}},{key:"componentDidUpdate",value:function(e){this.props.visible&&!e.visible&&(this.clearData(),this.props.formTemplate&&(this.formData=this.props.formTemplate,this.type=this.props.formTemplate.type,this.formData[this.type]=V({},this.formData.data)),this.props.credentialType&&(this.type=this.props.credentialType,this.formData.type=this.props.credentialType,this.kubeconfig||"kubeconfig"!==this.props.credentialType||this.fetchKubeConfig()))}},{key:"handleCreate",value:(a=(0,y.default)(l.default.mark((function e(t,a){var r,n;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.devops,n=a.cluster,e.next=3,this.store.handleCreate(t,{devops:r,cluster:n});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"updateFormData",value:function(e){e[this.type]&&(e[this.type].id=e.id)}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isEditMode,l=(e.credentialType,e.title);return k.default.createElement(L.default,{width:680,bodyClassName:U.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,isSubmitting:this.isSubmitting,title:l||t("CREATE_CREDENTIAL")},k.default.createElement(M.Form,{data:this.formData,ref:this.formRef},k.default.createElement(M.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("CREDENTIAL_NAME_EMPTY_DESC")},{pattern:j.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.nameValidator}]},k.default.createElement(M.Input,{name:"id",disabled:n})),k.default.createElement(M.Form.Item,{label:t("TYPE")},k.default.createElement(M.Select,{options:[{label:t("CREDENTIAL_TYPE_USERNAME_PASSWORD"),value:"username_password"},{label:t("CREDENTIAL_TYPE_SSH"),value:"ssh"},{label:t("CREDENTIAL_TYPE_SECRET_TEXT"),value:"secret_text"}],disabled:n,onChange:this.handleTypeChange,defaultValue:"username_password",name:"type"})),this.renderCredentForm(),k.default.createElement(M.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},k.default.createElement(M.TextArea,{name:"description",maxLength:256}))))}}]),n}(k.default.Component),v.propTypes={name:N.default.string,isEditMode:N.default.bool,formTemplate:N.default.object,credentialType:N.default.string,title:N.default.string},v.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isEditMode:!1},o=E,c=(0,D.default)(o.prototype,"formData",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),s=(0,D.default)(o.prototype,"type",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"username_password"}}),i=(0,D.default)(o.prototype,"kubeconfig",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=(0,D.default)(o.prototype,"isSubmitting",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=(0,D.default)(o.prototype,"isGetConfigLoading",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),(0,D.default)(o.prototype,"handleCreate",[A.action],Object.getOwnPropertyDescriptor(o.prototype,"handleCreate"),o.prototype),p=(0,D.default)(o.prototype,"fetchKubeConfig",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,y.default)(l.default.mark((function t(){var a,r;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.cluster,e.isGetConfigLoading=!0,t.next=4,request.get("kapis/resources.kubesphere.io/v1alpha2/".concat(e.store.getPath({cluster:a}),"/users/").concat(e.username,"/kubeconfig")).finally((function(){e.isGetConfigLoading=!1}));case 4:r=t.sent,e.kubeconfig=r,(0,P.default)(e.formData,"kubeconfig.content",r),e.forceUpdate();case 8:case"end":return t.stop()}}),t)})))}}),m=(0,D.default)(o.prototype,"handleOk",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.formRef.current.getData();e.formRef.current.validate((0,y.default)(l.default.mark((function a(){return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.isSubmitting=!0,e.updateFormData(t),e.props.onOk(t,(function(){e.isSubmitting=!1}));case 3:case"end":return a.stop()}}),a)}))))}}}),h=(0,D.default)(o.prototype,"handleTypeChange",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.type=t,e.formData[t]={id:(0,I.default)(e.formData,"id","")},e.kubeconfig||"kubeconfig"!==e.type||e.fetchKubeConfig()}}}),u=o))||u;a.default=B},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.errorMessage,a=e.children;return n.default.createElement("div",{className:u.default.wrapper},t&&n.default.createElement(l.Tooltip,{content:t},n.default.createElement("div",{className:u.default.error})),a)};var n=r(a(0)),l=a(189),u=r(a(2445))},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AccessModes",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"AddonsInput",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"AnnotationsInput",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"ArrayInput",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"BoolSelect",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"BoxSelect",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"ContainerPort",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"ContainerServicePort",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"ObjectInput",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"PropertiesInput",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"EnvironmentInput",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"ReplicasInput",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"MountInput",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"NumberInput",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(t,"ResourceLimit",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"Upload",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"InputPassword",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"TrafficSlider",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(t,"ServicePort",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(t,"RulePath",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(t,"UrlInput",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(t,"SchemeInput",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(t,"ProjectSelect",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(t,"StringInput",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(t,"SecretSelect",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"RoleSelect",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(t,"UnitWrapper",{enumerable:!0,get:function(){return I.default}}),Object.defineProperty(t,"BoxInput",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(t,"UnitSlider",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(t,"TagInput",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"TailIUnitInput",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"EmailInput",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(t,"TimeUnitInput",{enumerable:!0,get:function(){return M.TimeUnitInput}}),Object.defineProperty(t,"UnitInput",{enumerable:!0,get:function(){return M.UnitInput}});var n=r(a(2543)),l=r(a(995)),u=r(a(956)),o=r(a(824)),c=r(a(1376)),s=r(a(1426)),i=r(a(1333)),f=r(a(1334)),d=r(a(841)),p=r(a(829)),m=r(a(1135)),h=r(a(1427)),v=r(a(960)),E=r(a(805)),y=r(a(843)),g=r(a(2547)),b=r(a(1006)),S=r(a(1172)),_=r(a(1155)),O=r(a(1128)),C=r(a(1061)),T=r(a(1428)),R=r(a(898)),D=r(a(1138)),k=r(a(1381)),N=r(a(1173)),I=r(a(2554)),P=r(a(1007)),A=r(a(894)),w=r(a(1174)),L=r(a(1430)),M=a(2559)},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(5)),d=r(189),p=n(r(805)),m=n(r(2551));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.className,r=e.readOnly,n=e.renderHostInput,l=e.exampleValue;return i.default.createElement(d.Columns,{className:(0,f.default)(m.default.columns,a)},i.default.createElement(d.Column,{className:"is-7"},i.default.createElement(d.Form.Item,{rules:this.props.hostRules},n||i.default.createElement(d.Input,{name:this.props.hostName,placeholder:t("EXAMPLE_VALUE",{value:l||"192.168.1.10"}),readOnly:r}))),i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{rules:this.props.portRules},i.default.createElement(p.default,{min:0,max:65535,name:this.props.portName,onChange:this.onPortChange,defaultValue:this.props.defaultPort,placeholder:t("EXAMPLE_VALUE",{value:9200}),readOnly:r,integer:!0}))))}}]),r}(i.default.Component);a.default=v,v.defaultProps={hostName:"Host",portName:"Port",defaultPort:9200,hostRules:[{required:!0,message:t("ENTER_SERVICE_ADDRESS")}],portRules:[{required:!0,message:t("PORT_NUMBER_EMPTY")}]}},,,function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(41)),u=r(a(42)),o=r(a(37));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,o.default)(e);if(t){var n=(0,o.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,u.default)(this,a)}}var s=function(e){(0,l.default)(a,e);var t=c(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return(e=t.call.apply(t,[this].concat(l))).module="secrets",e}return a}(r(a(1063)).default);t.default=s},function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(24),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(27),a(29),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var n=r(a(317)),l=r(a(31)),u=r(a(50)),o=r(a(25)),c=r(a(28)),s=r(a(41)),i=r(a(42)),f=r(a(37)),d=r(a(0)),p=r(a(805)),m=r(a(163)),h=r(a(465)),v=r(a(5)),E=a(189),y=r(a(2815));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=function(e){(0,s.default)(a,e);var t=S(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).add=function(){var t=e.props,a=t.onChange,r=t.min,n=t.max,l=t.value,u=t.defaultValue;if(!t.disabled){var o=(0,m.default)(u)?r-1:u,c=(0,m.default)(l)||""===l?o:l;c<n&&a(Number(c)+1,"add")}},e.subtract=function(){var t=e.props,a=t.onChange,r=t.min,n=t.value,l=t.defaultValue;if(!t.disabled){var u=(0,m.default)(l)?r+1:l,o=(0,m.default)(n)||""===n?u:n;o>r&&a(Number(o)-1)}},e}return(0,c.default)(a,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.unit,r=e.showUnit,l=e.value,o=e.defaultValue,c=(e.onChange,e.integer,e.showFunc),s=e.style,i=void 0===s?{}:s,f=(0,u.default)(e,["className","unit","showUnit","value","defaultValue","onChange","integer","showFunc","style"]),p=(0,m.default)(l)?o:l;a&&(p=(0,h.default)(p,a));var g=b(b({type:"text"},f),{},{value:(0,m.default)(p)?"":p,onChange:this.handleChange});return a&&r||c?d.default.createElement("div",{className:(0,v.default)(t,y.default.withUnit),style:i},d.default.createElement(E.Input,g),d.default.createElement("div",{className:y.default.funcContainer},d.default.createElement("span",null,a),c&&d.default.createElement("div",{className:y.default.func},d.default.createElement(E.Icon,{name:"chevron-up",clickable:!0,onClick:this.add}),d.default.createElement(E.Icon,{name:"chevron-down",clickable:!0,onClick:this.subtract})))):d.default.createElement(E.Input,(0,n.default)({className:t,style:i},g))}}]),a}(p.default);t.default=_},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(20),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(250),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(98),r(141),r(29),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(58)),u=n(r(38)),o=n(r(31));r(35);var c=n(r(39)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=r(189),h=n(r(191)),v=n(r(5)),E=n(r(0)),y=n(r(1054)),g=r(1165),b=r(17),S=r(902),_=r(865),O=n(r(2866));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var D=function(e){(0,f.default)(r,e);var a=R(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).getRepoList=function(){var e=(0,c.default)(u.default.mark((function e(t,a){var r,l,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props,l=r.devops,o=r.cluster,e.next=3,n.codeStore.fetchList(T(T({devops:l,cluster:o},t),{},{limit:1e4}));case 3:n.setState({repoList:n.codeStore.list.data},(function(){a&&n.handleRepoChange(a)}));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.isSvnRepoRepeat=function(e){return n.state.svnRepoList.map((function(e){var t=e.name,a=e.sources;return{name:t,sources:JSON.stringify(a)}})).some((function(t){return t.name===e.metadata.name}))},n.addSvnCodeRepoOption=function(e){var a=n.isSvnRepoRepeat(e),r=e.metadata,u=e.sources;if(a)throw h.default.error({content:'"'.concat(r.name,'" ').concat(t("CODE_REPO_EXISTS"))}),Error('"'.concat(r.name,'" ').concat(t("CODE_REPO_EXISTS")));var o={name:r.name,sources:u};n.setState((function(e){var t=e.svnRepoList;return{svnRepoList:[o].concat((0,l.default)(t))}}),(function(){var e="".concat(r.name,"(").concat(u["".concat(u.source_type,"_source")].remote,")");n.handleRepoChange(e)}))},n.showCodeRepoCreate=function(){var e=n.props,a=e.trigger,r=e.devops,l=e.cluster;null==a||a("codeRepo.create",{title:t("IMPORT_CODE_REPO"),devops:r,cluster:l,module:"codeRepos",noCodeEdit:!0,store:n.codeStore,isCreatePipeline:!0,addSvnCodeRepoDirectly:n.addSvnCodeRepoOption,success:function(){n.getRepoList()}})},n.handleRepoChange=function(e){var t=n.props.onChange,a=n.allOptions.find((function(t){return t.value===e}));t&&t(a?T(T({},null==a?void 0:a.repo),{},{key:e}):a)},n.optionRenderer=function(e){return function(t){var a;if(e.value)return E.default.createElement("span",{className:O.default.option},!!e.icon&&E.default.createElement(m.Icon,{name:null!==(a=e.icon)&&void 0!==a?a:"",type:"value"===t?"dark":"light"}),e.value)}},n.optionValueMap={},n.codeStore=new y.default,n.state={repoList:[],svnRepoList:[]},n}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.getRepoList()}},{key:"render",value:function(){var e=this.props,a=e.value,r=e.index,n=e.name;return E.default.createElement(E.default.Fragment,null,E.default.createElement(_.TypeSelect,{key:r,name:n,onFetch:this.getRepoList,options:(0,b.toJS)(this.allOptions),onChange:this.handleRepoChange,value:null==a?void 0:a.key,placeholder:{icon:"code",label:t("SELECT_CODE_REPOSITORY")}}),E.default.createElement("div",{className:(0,v.default)(O.default["multi-repo"],"form-item-desc"),onClick:this.showCodeRepoCreate},t.html("GO_CREATE_REPO_ACTION")))}},{key:"svnOptions",get:function(){return this.state.svnRepoList.map((function(e){var t=e.name,a=e.sources,r="".concat(t,"(").concat(a["".concat(a.source_type,"_source")].remote,")");return{label:t,value:r,icon:"svn",repo:T({key:r},a)}}))}},{key:"repoOptions",get:function(){var e=this;return this.state.repoList.map((function(t){var a,r=t.name,n=t._originData,l=t.repoURL,u=t.provider,c=n.spec,s="".concat(r,"(").concat(null!=l?l:(0,S.getRepoUrl)(c),")");return{label:r,value:r,icon:"bitbucket_server"===u?"bitbucket":u,repo:e.props.isCreatePipeline?(0,o.default)({key:s,source_type:c.provider},"".concat(c.provider,"_source"),null===(a=g.gitRepositorySpec2Source[c.provider])||void 0===a?void 0:a.call(g.gitRepositorySpec2Source,c,r)):(0,b.toJS)(c),disabled:e.props.provider&&e.props.provider!==u,description:l}}))}},{key:"allOptions",get:function(){var e=this.props.showAllItem,a=this.svnOptions.concat(this.repoOptions);return e?[{label:t("ALL"),value:"*",icon:"allowlist"}].concat((0,l.default)(a)):a}}]),r}(E.default.Component);a.default=D},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(10),r(20),r(14),r(8),r(4),r(18),r(30),r(11),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(29),r(14),r(8),r(4),r(18),r(43),r(30),r(195),r(11);var u,o,c=n(r(58)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(45)),h=l(r(0)),v=n(r(862)),E=n(r(845)),y=n(r(445)),g=r(17),b=r(243),S=n(r(5)),_=r(189),O=n(r(1265)),C=n(r(1267)),T=n(r(1774));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var D=(0,b.observer)((o=function(e){(0,f.default)(r,e);var a=R(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleMetricSelect=function(t){e.props.onChange(t)},e}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props,a=e.name,r=e.value,n=e.onChange,l=e.labelsets,u=e.onLabelSearch,o=e.supportMetrics,c=e.supportDebugButton,s=void 0!==c&&c;return h.default.createElement("div",{className:T.default.wrapper},h.default.createElement(O.default,{options:this.groupedMetrics,onSelect:this.handleMetricSelect},h.default.createElement("span",{className:T.default.trigger},t("MONITOR_METRIC"),h.default.createElement(_.Icon,{type:"light",name:"caret-down"}))),h.default.createElement("div",{className:T.default.input},h.default.createElement(C.default,{name:a,value:r,onChange:n,metrics:o,labelsets:l,onLabelSearch:u})),s&&h.default.createElement("div",{onClick:this.props.onDebugClick,className:(0,S.default)(T.default.debug,T.default.btn)},h.default.createElement(_.Icon,{name:"terminal",type:"light"})," ",h.default.createElement("span",null,t("DEBUGB_DATA"))))}},{key:"groupedMetrics",get:function(){var e=/:\w+:/,t=(0,c.default)(this.props.supportMetrics);return t=t.filter((function(t){return!e.test(t.value)})),t=(0,E.default)(t,(function(e){return e.value.split("_")[0]})),t=(0,v.default)(t,(function(e,t){var a=1===e.length&&e[0]===t?[]:e.map((function(e){return{label:e.value,value:e.value,desc:e.desc}}));return{children:(0,y.default)(a,"label"),label:t,value:t}})),(0,y.default)(t,"label")}}]),r}(h.Component),(0,m.default)(o.prototype,"groupedMetrics",[g.computed],Object.getOwnPropertyDescriptor(o.prototype,"groupedMetrics"),o.prototype),u=o))||u;a.default=D},function(e,t,a){e.exports={wrapper:"_2GwJwev2SkXT_7T9_wM7oT",options:"_3-8ILrzsloMaSb1q8VHZGB",item:"_1Sv6m-zFhZ6z4HxHwNjTSV",isOpen:"_1RoPAe-6k6dY12KTKlPRb3",hasChildren:"_3T6HDoFJhvQq-eFIiaEu5Q"}},,,,,,,,,,,,,,,,,,,,,,function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(0)),u=r(189),o=n(r(798)),c=n(r(1907)),s=function(e){var a=e.onCancel,r=e.title,n=e.visible,s=e.isSubmitting,i=e.desc,f=e.icon;return l.default.createElement(o.default,{width:600,onOk:function(){e.onOk()},okText:t("OK"),onCancel:a,visible:n,isSubmitting:s,hideHeader:!0},l.default.createElement("div",{className:c.default.title},f?l.default.createElement(u.Icon,{name:f,size:20}):l.default.createElement(u.Icon,{name:"information",size:20,className:c.default.icon}),r),l.default.createElement("p",{className:c.default.desc},i))};a.default=s},function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.ALL_QUERY_CONFIG=t.ALL_SUMMARY_CONFIG=t.ALL_MESSAGE_CONFIG=t.ALL_METRICS_CONFIG=t.RESOURCE_METRICS_CONFIG=void 0,a(12),a(10),a(6),a(27),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var n,l=r(a(31)),u=a(815),o=r(a(1947)),c=r(a(1948)),s=r(a(1949)),i=r(a(1950)),f=r(a(1951)),d=r(a(1952)),p=r(a(1953)),m=r(a(1954));function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E=(n={},(0,l.default)(n,u.RadonDBAppId.MySQL,o.default.Metric),(0,l.default)(n,u.RadonDBAppId.PostgreSQL,c.default.Metric),(0,l.default)(n,u.RadonDBAppId.ClickHouse,s.default.Metric),(0,l.default)(n,u.RadonDBAppId.MongoDB,i.default.Metric),(0,l.default)(n,u.RadonDBAppId.RedisCluster,f.default.Metric),(0,l.default)(n,u.RadonDBAppId.RedisSentinel,f.default.Metric),(0,l.default)(n,u.RadonDBAppId.Elasticsearch,d.default.Metric),(0,l.default)(n,u.RadonDBAppId.Kafka,p.default.Metric),(0,l.default)(n,u.RadonDBAppId.OpenSearch,m.default.Metric),n);t.RESOURCE_METRICS_CONFIG=E;var y=v(v(v(v(v(v(v(v({},o.default.Metric),c.default.Metric),s.default.Metric),i.default.Metric),f.default.Metric),d.default.Metric),p.default.Metric),m.default.Metric);t.ALL_METRICS_CONFIG=y;var g=v(v(v(v(v(v(v(v({},o.default.Message),c.default.Message),s.default.Message),i.default.Message),f.default.Message),d.default.Message),p.default.Message),m.default.Message);t.ALL_MESSAGE_CONFIG=g;var b=v(v(v(v(v(v(v(v({},o.default.Summary),c.default.Summary),s.default.Summary),i.default.Summary),f.default.Summary),d.default.Summary),p.default.Summary),m.default.Summary);t.ALL_SUMMARY_CONFIG=b;var S=v(v(v(v(v(v(v(v({},o.default.Query),c.default.Query),s.default.Query),i.default.Query),f.default.Query),d.default.Query),p.default.Query),m.default.Query);t.ALL_QUERY_CONFIG=S},,function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(44),r(6),r(70),r(88),r(20),r(87),r(194),r(14),r(8),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0,r(32),r(10),r(44),r(6),r(70),r(88),r(20),r(27),r(87),r(194),r(29),r(14),r(8),r(4),r(18),r(43),r(11),r(73),r(7);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(45)),d=n(r(26)),p=n(r(68)),m=n(r(67)),h=n(r(140)),v=n(r(119)),E=n(r(0)),y=r(17),g=r(243),b=r(189),S=r(56),_=r(61),O=n(r(447)),C=n(r(325)),T=n(r(450)),R=n(r(1971)),D=n(r(1973));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var N=(l=function(e){(0,c.default)(r,e);var a=k(r);function r(e){var n;return(0,u.default)(this,r),(n=a.call(this,e)).showRule=function(e){n.setState({showRule:!0,selectRuleIndex:e,operation:"add"})},n.closeModal=function(){n.setState({showRule:!1,selectRuleIndex:-1,operation:""})},n.closeEditModal=function(){if("edit"===n.state.operation){var e=n.state.oldTemplate;(0,p.default)(n.fedFormTemplate,"spec",e.spec),n.props.isFederated&&n.updateOverrides()}n.closeModal()},n.showEdit=function(e){n.setState({showRule:!0,selectRuleIndex:e,operation:"edit",oldTemplate:(0,v.default)((0,y.toJS)(n.fedFormTemplate))})},n.handleRule=function(e){var t=n.props.isFederated,a=n.state.selectRuleIndex,r=n.fedFormTemplate,l=(0,d.default)(r,"spec.rules",[]);a>=0?l[a]=e:l.push(e),(0,p.default)(r,"spec.rules",l),n.updateTLS(r),t&&n.updateOverrides(),n.closeModal()},n.handleDelete=function(e){var t=n.props.isFederated,a=n.fedFormTemplate,r=(0,d.default)(a,"spec.rules",[]);r.splice(e,1),(0,p.default)(a,"spec.rules",r),n.updateTLS(a),t&&n.updateOverrides(),n.closeModal()},n.rulesValidator=function(e,a,r){if((0,m.default)(a))return r({message:t("ROUTING_RULE_EMPTY_DESC")});r()},n.state={showRule:!1,selectRuleIndex:-1,gateway:{},oldTemplate:{},isLoading:!1,operation:""},n.secretStore=new O.default,n.serviceStore=new C.default,e.isFederated&&(n.secretStore=new T.default({module:n.secretStore.module}),n.serviceStore=new T.default({module:n.serviceStore.module})),n}return(0,o.default)(r,[{key:"componentDidMount",value:function(){this.secretStore.fetchList({namespace:this.namespace,cluster:this.cluster,limit:-1}),this.serviceStore.fetchList({namespace:this.namespace,cluster:this.cluster,limit:-1,labelSelector:(0,S.joinSelector)(this.props.selector)})}},{key:"updateTLS",value:function(e){var t=(0,d.default)(e,"spec.rules",[]).filter((function(e){return"https"===e.protocol&&e.secretName})).reduce((function(e,t){var a=t.secretName,r=t.host,n=t.clusters,l=e.find((function(e){return e.secretName===a}));return l?(l.hosts=l.hosts||[],-1===l.hosts.indexOf(r)&&l.hosts.push(r)):e.push({hosts:[r],secretName:a,clusters:n}),e}),[]);(0,p.default)(e,"spec.tls",t)}},{key:"updateOverrides",value:function(){var e=[],t=(0,d.default)(this.fedFormTemplate,"spec.rules",[]),a=(0,d.default)(this.fedFormTemplate,"spec.tls",[]);(0,d.default)(this.props.projectDetail,"clusters",[]).forEach((function(r){var n=function(e){return e.filter((function(e){return e.clusters.includes(r.name)})).map((function(e){return(0,h.default)(e,"clusters")}))};e.push({clusterName:r.name,clusterOverrides:[{path:"/spec/rules",value:n(t)},{path:"/spec/tls",value:n(a)}]})})),(0,p.default)(this.formTemplate,"spec.overrides",e)}},{key:"renderRuleForm",value:function(e){var t=this.props,a=t.isFederated,r=t.projectDetail,n=t.namespace,l=t.formTemplate,u=t.detail,o=(0,y.toJS)(this.services),c=(0,y.toJS)(this.secretStore.list).data,s=(0,d.default)(this.fedFormTemplate,"spec.rules[".concat(e,"]"),{});return E.default.createElement(D.default,{data:s,gateway:this.state.gateway,secrets:c,services:o,isFederated:a,projectDetail:r,cluster:this.cluster,detail:u,namespace:n,validData:(0,v.default)((null==l?void 0:l.ingress)||(null==l?void 0:l.Ingress)),onSave:this.handleRule,onCancel:this.closeEditModal})}},{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.isFederated,r=e.projectDetail,n=this.state,l=n.showRule,u=n.selectRuleIndex,o=n.gateway,c=n.isLoading;if(l)return this.renderRuleForm(u);var s=(0,m.default)(o)&&!c;return E.default.createElement(b.Form,{data:this.fedFormTemplate,ref:t},E.default.createElement(b.Form.Item,{rules:[{validator:this.rulesValidator}]},E.default.createElement(R.default,{name:"spec.rules",onShow:this.showRule,onEdit:this.showEdit,onDelete:this.handleDelete,disabled:s,isFederated:a,projectDetail:r})))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,_.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,d.default)(this.formTemplate,"spec.template"):this.formTemplate}},{key:"cluster",get:function(){return this.props.cluster}},{key:"namespace",get:function(){return(0,d.default)(this.formTemplate,"metadata.namespace")}},{key:"services",get:function(){return this.serviceStore.list.data}}]),r}(E.default.Component),(0,f.default)(l.prototype,"services",[y.computed],Object.getOwnPropertyDescriptor(l.prototype,"services"),l.prototype),l),I=(0,g.observer)(N);a.default=I;var P=N;a.Component=P},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a(16),Object.defineProperty(t,"__esModule",{value:!0}),t.STORAGE_PLUGIN_ICONS=t.NETWORK_PLUGIN_ICONS=t.NEW_CLUSTER_SPEC=t.IMPORT_EDGE_CLUSTER_SPEC=t.CREATE_EDGE_CLUSTER_SPEC=t.IMPORT_CLUSTER_SPEC=void 0;t.IMPORT_CLUSTER_SPEC={apiVersion:"cluster.kubesphere.io/v1alpha1",kind:"Cluster",spec:{provider:"",connection:{type:"direct",kubeconfig:""},joinFederation:!0}};t.CREATE_EDGE_CLUSTER_SPEC={apiVersion:"infra.edgewize.io/v1alpha1",kind:"EdgeCluster",spec:{namespace:"",hostCluster:"",advertiseAddress:[],type:"auto",kubeConfig:""},metadata:{name:""}};t.IMPORT_EDGE_CLUSTER_SPEC={apiVersion:"infra.edgewize.io/v1alpha1",kind:"Cluster",spec:{provider:"edgewize",type:"auto",kubeconfig:"",joinFederation:!1}};t.NEW_CLUSTER_SPEC={apiVersion:"kubekey.kubesphere.io/v1alpha1",kind:"Cluster",metadata:{},spec:{hosts:[],roleGroups:{},controlPlaneEndpoint:{domain:"lb.kubesphere.local",address:"",port:6443},kubernetes:{clusterName:"cluster.local",maxPods:110,etcdBackupDir:"/var/backups/kube_etcd",etcdBackupPeriod:30,keepBackupNumber:5},network:{plugin:"calico",kubePodsCIDR:"10.233.64.0/18",kubeServiceCIDR:"10.233.0.0/18",ipipMode:"Always",vxlanMode:"Never",vethMTU:1440},registry:{privateRegistry:""},addons:[{},{}]}};t.NETWORK_PLUGIN_ICONS={calico:"",flannel:"",cilium:""};t.STORAGE_PLUGIN_ICONS={nfs:"vsan"}},,,function(e,t,a){"use strict";var r=a(19);a(12),a(109),a(3),a(10),a(6),a(70),a(20),a(14),a(24),a(8),a(13),a(9),a(4),a(18),a(30),a(11),a(73),a(139),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(32),a(3),a(10),a(6),a(70),a(121),a(20),a(27),a(141),a(29),a(14),a(120),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(73),a(7);var n=r(a(246)),l=r(a(38)),u=r(a(58)),o=r(a(31)),c=r(a(50));a(35);var s,i,f,d,p=r(a(39)),m=r(a(62)),h=r(a(25)),v=r(a(28)),E=r(a(74)),y=r(a(41)),g=r(a(42)),b=r(a(37)),S=r(a(45)),_=(r(a(63)),r(a(68))),O=r(a(26)),C=r(a(67)),T=r(a(76)),R=r(a(196)),D=r(a(163)),k=a(17),N=a(324),I=a(61),P=r(a(438)),A=r(a(330));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,b.default)(e);if(t){var n=(0,b.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,g.default)(this,a)}}var x=(s=function(e){(0,y.default)(b,e);var t,a,r,o,s,g=M(b);function b(){var e;(0,h.default)(this,b);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=g.call.apply(g,[this].concat(a))).module="secrets",(0,m.default)(e,"list",i,(0,E.default)(e)),(0,m.default)(e,"detail",f,(0,E.default)(e)),(0,m.default)(e,"params",d,(0,E.default)(e)),e.getResourceUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a="".concat(e.getBaseUrl(t),"credentials");return t.name?"".concat(a,"/").concat(t.name):a},e}return(0,v.default)(b,[{key:"setParams",value:function(e){this.params=e}},{key:"fetchList",value:(s=(0,p.default)(l.default.mark((function e(){var t,a,r,n,o,s,i,f=this,d=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},a=t.devops,r=t.cluster,n=(0,c.default)(t,["devops","cluster"]),this.list.isLoading=!0,n.limit===1/0||-1===n.limit?(n.limit=-1,n.page=1):n.limit=n.limit||10,o=n.more||!1,(0,R.default)(n,"more"),n.sortBy=n.sortBy||"createTime",e.next=8,request.get(this.getResourceUrl({devops:a,cluster:r}),L({},n));case 8:return s=e.sent,i=Array.isArray(s.items)?s.items.filter((function(e){return I.CREDENTIAL_TYPE_LIST.includes(e.type)})).map((function(e){return(e=f.mapper(e)).type=I.CREDENTIAL_DISPLAY_KEY[e.type.split("/")[1]],e})):[],this.list.update({data:o?[].concat((0,u.default)(this.list.data),(0,u.default)(i)):i,total:s.totalItems||i.length||0,filters:n,limit:Number(n.limit)||10,page:Number(n.page)||1,isLoading:!1}),e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"handleCreate",value:(o=(0,p.default)(l.default.mark((function e(t,a){var r,n,u,o,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.devops,n=a.cluster,u=P.default[this.module]({namespace:r}),o=(0,O.default)(t,t.type,{}),c=o.id||t.id,(0,_.default)(u,"metadata.labels.app",c),(0,_.default)(u,'metadata.annotations["kubesphere.io/description"]',t.description),(0,_.default)(u,"metadata.name",c),delete t.description,o.id&&delete o.id,!(0,C.default)(o)&&(0,T.default)(o)&&Object.keys(o).forEach((function(e){o[e]&&(o[e]=(0,N.safeBtoa)(o[e]))})),delete t[t.type],u.data=L({},o),u.type="credential.devops.kubesphere.io/".concat(I.CREDENTIAL_KEY[t.type]),e.next=15,request.post(this.getResourceUrl({devops:r,cluster:n}),u,null,null);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"fetchDetail",value:(r=(0,p.default)(l.default.mark((function e(t){var a,r,n,u,o,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,D.default)(t)||(0,C.default)(t)||(this.params=t),a=this.params,r=a.devops,n=a.credential_id,u=a.cluster,e.next=4,request.get("".concat(this.getResourceUrl({devops:r,name:n,cluster:u}),"?content=1"));case 4:o=e.sent,(c=this.mapper(o)).display_name=c.name,c.id=c.name,c.type=I.CREDENTIAL_DISPLAY_KEY[c.type.split("/")[1]],this.detail=c,this.isLoading=!1;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updateCredential",value:(a=(0,p.default)(l.default.mark((function e(t,a){var r,u,o,c,s;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.devops,u=a.cluster,o=t[t.type],c=t.description,s=t._originData,"{}"!==JSON.stringify(o)&&"object"===(0,n.default)(o)&&Object.keys(o).forEach((function(e){o[e]=(0,N.safeBtoa)(o[e])})),(0,_.default)(s,"data",o),(0,_.default)(s,'metadata.annotations["kubesphere.io/description"]',c),e.next=9,request.put("".concat(this.getResourceUrl({devops:r,name:t.name,cluster:u}),"?content=1"),s);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"delete",value:(t=(0,p.default)(l.default.mark((function e(t){var a,r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,r=this.params,n=r.devops,u=r.cluster,e.next=4,request.delete("".concat(this.getResourceUrl({devops:n,name:a,cluster:u})));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"checkName",value:function(e){return request.get(this.getResourceUrl(e),{},{headers:{"x-check-exist":!0}})}},{key:"apiVersion",get:function(){return I.API_VERSIONS.devops}}]),b}(A.default),i=(0,S.default)(s.prototype,"list",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),f=(0,S.default)(s.prototype,"detail",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),d=(0,S.default)(s.prototype,"params",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),(0,S.default)(s.prototype,"setParams",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"setParams"),s.prototype),(0,S.default)(s.prototype,"fetchList",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchList"),s.prototype),(0,S.default)(s.prototype,"handleCreate",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"handleCreate"),s.prototype),(0,S.default)(s.prototype,"fetchDetail",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"fetchDetail"),s.prototype),(0,S.default)(s.prototype,"updateCredential",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"updateCredential"),s.prototype),(0,S.default)(s.prototype,"delete",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"delete"),s.prototype),(0,S.default)(s.prototype,"checkName",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"checkName"),s.prototype),s);t.default=x},function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(14),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.getGithubSource=o,t.getGitlabSource=c,t.getBitbucketSource=s,t.getGitSource=i,t.omitRepoKeys=t.gitRepositorySpec2Source=t.gitRepositorySpec2GitSource=t.gitRepositorySpec2BitbucketSource=t.gitRepositorySpec2GitlabSource=t.gitRepositorySpec2GithubSource=t.getCodeRepoTemplate=void 0;var n=r(a(31));function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e){var t=e.owner,a=e.repo,r=a.url||a.remote||a.repo;return{repo:a,owner:t,url:/^https:\/\//.test(r)?r:"https://github.com/".concat(t,"/").concat(a)}}function c(e){var t=e.owner,a=e.repo,r=e.server_name;return{repo:a,owner:t,server:r,url:"".concat(r,"/").concat(t,"/").concat(a)}}function s(e){var t=e.owner,a=e.repo,r=e.api_uri,n="/"===r.substr(r.length-1)?r:"".concat(r,"/");return/https:\/\/bitbucket.org\/?/gm.test(n)||(n+="scm/"),{repo:a,owner:t,server:n,url:"".concat(n).concat(t,"/").concat(a)}}function i(e){return{url:e.url}}a(12),a(3),a(10),a(6),a(27),a(14),a(33),a(16),a(8),a(13),a(9),a(4),a(30),a(195),a(977),a(7);var f={github:o,gitlab:c,bitbucket_server:s,git:i};t.getCodeRepoTemplate=f;var d=function(e,t){var a;return{scm_id:t,owner:null==e?void 0:e.owner,repo:null==e?void 0:e.repo,credential_id:null==e||null===(a=e.secret)||void 0===a?void 0:a.name,discover_branches:1,discover_pr_from_forks:{strategy:2,trust:2},discover_pr_from_origin:2,discover_tags:!0}},p=d;t.gitRepositorySpec2GithubSource=p;var m=function(e,t){return{gitlab_source:u(u({},d(e,t)),{},{server_name:null==e?void 0:e.server})}};t.gitRepositorySpec2GitlabSource=m;var h=function(e,t){return u(u({},d(e,t)),{},{api_uri:null==e?void 0:e.server})};t.gitRepositorySpec2BitbucketSource=h;var v=function(e,t){var a;return{scm_id:t,credential_id:null==e||null===(a=e.secret)||void 0===a?void 0:a.name,url:null==e?void 0:e.url,discover_branches:!0}};t.gitRepositorySpec2GitSource=v;var E={github:p,gitlab:m,bitbucket_server:h,git:v};t.gitRepositorySpec2Source=E;t.omitRepoKeys={github:["scm_id","owner","repo","credential_id","discover_branches","discover_pr_from_forks","discover_pr_from_origin","discover_tags"],gitlab:["scm_id","owner","repo","credential_id","discover_branches","discover_pr_from_forks","discover_pr_from_origin","discover_tags","server_name"],bitbucket_server:["scm_id","owner","repo","credential_id","discover_branches","discover_pr_from_forks","discover_pr_from_origin","discover_tags","api_uri"],git:["scm_id","credential_id","url","discover_branches"]}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.preview,a=e.sidebar,r=e.main;return n.default.createElement("div",{className:l.default.wrapper},n.default.createElement("div",{className:l.default.preview},t," "),n.default.createElement("div",{className:l.default.form},n.default.createElement("div",{className:l.default.sidebar},a),n.default.createElement("div",{className:l.default.resource},r)))};var n=r(a(0)),l=r(a(2451))},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"GraphTextInput",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"ThemeSelector",{enumerable:!0,get:function(){return l.default}});var n=r(a(2452)),l=r(a(2454))},,,,function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(36),a(66),a(20),a(87),a(99),a(8),a(13),a(9),a(4),a(21),a(30),a(46),a(71),a(7),a(40),a(110),Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MONITOR_PANEL_TYPE=void 0;var n=r(a(38));a(35);var l=r(a(39)),u=r(a(31)),o=r(a(62)),c=r(a(25)),s=r(a(28)),i=r(a(45));r(a(63));a(12),a(250),a(32),a(3),a(10),a(6),a(36),a(66),a(20),a(27),a(87),a(141),a(120),a(33),a(16),a(99),a(8),a(13),a(9),a(4),a(321),a(21),a(30),a(46),a(71),a(7),a(40),a(110);var f,d,p,m,h,v,E=r(a(97)),y=r(a(50)),g=a(17),b=r(a(26)),S=r(a(142));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.MONITOR_PANEL_TYPE={TEXT:"singlestat",ROW:"row",GRAPH:"graph"};var C=(f=function(){function e(t){var a=this;(0,c.default)(this,e),this.belongTo=null,(0,o.default)(this,"errorMessage",d,this),(0,o.default)(this,"config",p,this),(0,o.default)(this,"metrics",m,this),(0,o.default)(this,"timeRange",h,this),this.monitoring=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.template;a.isObserving||(a.isObserving=!0,a.pollingController=R((function(){var t=e.getTimeRange(),r=t.from,n=t.to;a.fetchMetrics({start:r.valueOf(),end:n.valueOf()})}),{interval:e.refreshMs}),a.disposer=(0,g.reaction)((function(){return{time:e.timeRange,refresh:e.refreshMs,exprs:a.config.targets.map((function(e){return e.expr})),steps:a.config.targets.map((function(e){return e.step}))}}),(function(t){var r=t.refresh;a.metrics=a.metrics.map((function(e){return O(O({},e),{},{values:[]})})),a.pollingController&&a.pollingController.stopPolling(),a.pollingController=R((function(){var t=e.getTimeRange(),r=t.from,n=t.to;a.fetchMetrics({start:r.valueOf(),end:n.valueOf()})}),{interval:r})})))},(0,o.default)(this,"fetchMetrics",v,this),this.fetchMetric=function(){var e=(0,l.default)(n.default.mark((function e(t){var r,l,u,o,c,s,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.expr,l=t.step,u=t.start,o=t.end,c=t.cluster,s=t.namespace,r){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,request.get("".concat(a.apiVersion,"/targets/query"),{cluster:c,namespace:s,expr:r,step:l,start:u,end:o},null,(function(e,t){throw new Error(t.message)}));case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:return i=e.t0,e.abrupt("return",(0,b.default)(i,"data.result",[]));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.stopMonitoring=function(){a.isObserving=!1,a.pollingController&&a.pollingController.stopPolling(),a.disposer&&a.disposer()},this.belong=function(e){return a.belongTo=e,a},this.config=t,this.requestID=0}return(0,s.default)(e,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cluster,a=e.namespace,r="";return t&&(r+="/clusters/".concat(t)),a&&(r+="/namespaces/".concat(a)),r}},{key:"apiVersion",get:function(){return"kapis/monitoring.kubesphere.io/v1beta1"}},{key:"type",get:function(){return this.config.type}},{key:"targets",get:function(){return this.config.targets||[]}},{key:"id",get:function(){return this.config.id}}]),(0,s.default)(e,[{key:"clearMonitorMetrics",value:function(){this.metrics=[]}},{key:"clone",value:function(){return new this.constructor((0,g.toJS)(this.config))}},{key:"formattedMetrics",get:function(){return this.metrics.map((function(e){var t=e.target,a=e.metric,r=e.responseMetricID,n=(0,y.default)(e,["target","metric","responseMetricID"]),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,S.default)(e))return e.replace(/\{\{(.*?)\}\}/g,(function(e,a){return t[a]}))}(t.legendFormat,a)||r;return O(O({},n),{},{name:l})}))}}]),e}(),d=(0,i.default)(f.prototype,"errorMessage",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),p=(0,i.default)(f.prototype,"config",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),m=(0,i.default)(f.prototype,"metrics",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=(0,i.default)(f.prototype,"timeRange",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{start:0,end:0}}}),(0,i.default)(f.prototype,"type",[g.computed],Object.getOwnPropertyDescriptor(f.prototype,"type"),f.prototype),(0,i.default)(f.prototype,"targets",[g.computed],Object.getOwnPropertyDescriptor(f.prototype,"targets"),f.prototype),(0,i.default)(f.prototype,"clearMonitorMetrics",[g.action],Object.getOwnPropertyDescriptor(f.prototype,"clearMonitorMetrics"),f.prototype),v=(0,i.default)(f.prototype,"fetchMetrics",[g.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,l.default)(n.default.mark((function t(a){var r,u,o,c,s,i,f,d,p;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.start,u=a.end,o=e.config,c=o.targets,s=void 0===c?[]:c,i=o.cluster,f=o.namespace,e.timeRange={start:r,end:u},d={ID:++e.requestID,errorMessage:"",metrics:[]},t.prev=4,t.next=7,Promise.all(s.map(function(){var t=(0,l.default)(n.default.mark((function t(a){var l,o,c;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=a.expr,o=a.step,t.next=3,e.fetchMetric({cluster:i,namespace:f,expr:l,step:o,start:parseInt(r/1e3,10),end:parseInt(u/1e3,10)});case 3:return c=t.sent,t.abrupt("return",{data:c,target:a});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 7:p=t.sent,d.metrics=p.reduce((function(e,t){var a=t.data,r=void 0===a?[]:a,n=t.target,l=void 0===n?{}:n,u=l.expr,o=l.refId,c=r.map((function(e){var t=e.values,a=void 0===t?[]:t,r=e.metric,n=void 0===r?{}:r,c=T(n)||u,s="".concat(o,".").concat(c);return{values:a,metric:n,target:l,id:s,responseMetricID:c}}));return e.concat(c)}),[]),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),d.errorMessage=t.t0.message;case 14:return t.prev=14,d.ID===e.requestID&&(e.metrics=d.metrics,e.errorMessage=d.errorMessage),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[4,11,14,17]])})));return function(e){return t.apply(this,arguments)}}()}}),(0,i.default)(f.prototype,"formattedMetrics",[g.computed],Object.getOwnPropertyDescriptor(f.prototype,"formattedMetrics"),f.prototype),f);function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.__name__,a=(0,y.default)(e,["__name__"]);if(!t)return JSON.stringify(a||{});var r=Object.entries(a||{}).map((function(e){var t=(0,E.default)(e,2),a=t[0],r=t[1];return"".concat(a,'="').concat(r,'"')})),n=r.length?"{".concat(r.join(","),"}"):"";return"".concat(t).concat(n)}function R(e,t){var a={timer:null,stopPolling:function(){clearTimeout(a.timer)}};e();return function r(){t.interval&&(a.timer=setTimeout((function(){e(),r()}),t.interval))}(),a}t.default=C},,function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(20),r(14),r(138),r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(138),r(8),r(4),r(18),r(43),r(11);var u,o,c=n(r(317)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(45)),h=l(r(0)),v=r(17),E=r(243),y=n(r(26)),g=r(189),b=n(r(322)),S=n(r(2553));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var O=(0,E.observer)((o=function(e){(0,f.default)(r,e);var a=_(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).roleStore=new b.default,e.fetchRoles=function(){var t=e.props,a=t.cluster,r=t.namespace;return e.roleStore.fetchList({cluster:a,namespace:r,limit:-1,sortBy:"createTime"})},e.optionRenderer=function(e){return h.default.createElement("div",{className:S.default.option},h.default.createElement("div",null,e.label),h.default.createElement("p",null,e.desc))},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.props.namespace&&this.fetchRoles()}},{key:"componentDidUpdate",value:function(e){this.props.namespace!==e.namespace&&this.props.namespace&&this.fetchRoles()}},{key:"render",value:function(){var e=Object.assign({},this.props);return h.default.createElement(g.Select,(0,c.default)({options:this.roles,optionRenderer:this.optionRenderer},e))}},{key:"roles",get:function(){return this.roleStore.list.data.map((function(e){return{label:e.name,value:e.name,item:e,desc:t((0,y.default)(e,"description"))}}))}}]),r}(h.Component),(0,m.default)(o.prototype,"roles",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"roles"),o.prototype),u=o))||u;a.default=O},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(10),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(10),a(20),a(29),a(4),a(18),a(43),a(11);var n=r(a(58)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=r(a(1)),d=r(a(5)),p=r(a(458)),m=a(189),h=r(a(2556)),v=r(a(1429));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(a,e);var t=E(a);function a(e){var r;return(0,l.default)(this,a),(r=t.call(this,e)).handleClick=function(){r.autosuggest.focus()},r.handleInputChange=function(e,t){(0,r.props.onInputChange)(e,t)},r.handleAdd=function(e){var t=r.state.tags,a=r.props.onChange,l=[].concat((0,n.default)(t),[e]);r.setState({tags:l},(function(){a(l)}))},r.handleDelete=function(){var e=r.state.tags,t=r.props.onChange;if(!(e.length<=0)){var a=e.filter((function(t,a){return a!==e.length-1}));r.setState({tags:a},(function(){t(a)}))}},r.handleCloseTag=function(e){var t=e.value,a=e.index,n=r.state.tags,l=r.props.onChange,u=n.filter((function(e,r){return e!==t&&r!==a}));r.setState({tags:u},(function(){l(u)}))},r.renderTags=function(){var e=r.state.tags;return i.default.createElement(i.default.Fragment,null,e.map((function(e,t){return i.default.createElement(m.Tag,{key:"".concat(e,"-").concat(t+1)},e,i.default.createElement(m.Icon,{name:"close",color:{primary:"rgb(255,255,255)"},size:16,clickable:!0,onClick:function(){return r.handleCloseTag({item:e,index:t})}}))})))},r.state={tags:e.value||[]},r}return(0,u.default)(a,[{key:"render",value:function(){var e=this;return i.default.createElement("div",{className:(0,d.default)("input",v.default.filterInput),onClick:this.handleClick},this.renderTags(),i.default.createElement(h.default,{ref:function(t){e.autosuggest=t},placeholder:this.placeholder,onChange:this.handleInputChange,onAdd:this.handleAdd,onDelte:this.handleDelete}))}},{key:"placeholder",get:function(){var e=this.props.placeholder;return 0===this.state.tags.length?e:null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.tags!==e.value?{tags:e.value}:null}}]),a}(i.default.Component);t.default=y,y.propTypes={placeholder:f.default.string,value:f.default.array,onChange:f.default.func,onInputChange:f.default.func},y.defaultProps={value:[],onChange:p.default,onBlur:p.default,onFocus:p.default,onClear:p.default,onInputChange:p.default}},function(e,t,a){e.exports={wrapper:"_2txp4-htvICs4f6c3rqsX6",contentWrapper:"_1ccZoq2QaWbCEWk-OZo1mE",hidden:"_1ZsdcL3CHNMzvcbO79RwNl"}},function(e,t,a){e.exports={wrapper:"wXHKYRcPKuXFRfyupNjOu",content:"_1GXH8tzUyU5FHWVbgQC2yC",search:"fIGMiznH-KyaGoj2YiJny",cardList:"_1CuokVurLCjDnq4oP4oGRR",emptyText:"_28JJz3Xe4z4rL7-NGN6z_5",emptyTipIcon:"pGMtYHHqbFWHUy30mrUf0",action:"K0VfnE3ZVeXqSI5P0ICCJ",card:"Fe47hou2kTN8vkdsVYJKD"}},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(831)),m=r(189),h=n(r(798)),v=r(61);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleOk=function(e){var a=t.props,r=a.onOk,n=a.store,l=a.detail,u=n.list,o=(0,d.toJS)(u.selectedRowKeys),c=o?o.filter((function(e){return e!==l.uid})):"";r(e),o&&u.setSelectRowKeys(c)},t.state={formData:(0,p.default)((0,d.toJS)(e.detail._originData||e.detail))},t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,p.default)((0,d.toJS)(this.props.detail._originData||this.props.detail))})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=e.hideAlias,u=this.state.formData;return i.default.createElement(h.default.Form,{data:u,width:691,title:t("EDIT_INFORMATION"),icon:"pen",onOk:this.handleOk,okText:t("OK"),onCancel:n,visible:a,isSubmitting:r},i.default.createElement(m.Form.Item,{label:t("NAME")},i.default.createElement(m.Input,{name:"metadata.name",disabled:!0})),!l&&i.default.createElement(m.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:v.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},i.default.createElement(m.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),i.default.createElement(m.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},i.default.createElement(m.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))}}]),r}(i.default.Component);a.default=y,y.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},y.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(911)),l=r(a(900)),u=r(a(915)),o=r(a(963)),c=[{title:"BASIC_INFORMATION",icon:"cdn",component:n.default,required:!0},{title:"POD_SETTINGS",icon:"docker",component:l.default,required:!0},{title:"STORAGE_SETTINGS",icon:"storage",component:u.default,required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:o.default,required:!0}];t.default=c},,,function(e,t,a){e.exports={title:"_3MyN8db51dIymCq_ZC1Gwn",row:"_1Wp_FocJespWSojpwmEORy",item:"_1Wca6ooaX_vhRkns6JCVcF",labelWrapper:"_2c9_1qksBruoEx3E-dV8-_",wrapper:"_1Qt_Py85R6VmNAr3eyTPAt",listWrapper:"_1YXhXmofHC5kroZqEBeYz2",listItem:"_-6807uDmbi-G9F7KW3RPe",boxWrapper:"_2IHS2beu14kmMkgIZcP6h0",empty:"CDHcI6fTkYWvRDqv9SsGW",tag:"rr3ttiyZ2BAdAQHbcNyYK"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(194),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(194),r(29),r(4),r(18),r(43),r(11);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(1)),p=n(r(5)),m=n(r(67)),h=r(189),v=n(r(1007)),E=n(r(1181));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=function(e){(0,c.default)(r,e);var a=y(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleAdd=function(t){var a=e.props,r=a.value;(0,a.onChange)([].concat((0,l.default)(r),[t]))},e.handleDelete=function(t,a){var r=e.props,n=r.value,l=r.onChange;n.splice(a,1),l(n)},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.value,n=a.validate,l=a.className,u=a.title,o=void 0===u?t("KEYWORDS"):u,c=a.listTitle,s=void 0===c?t("KEYWORDS_LIST"):c,i=a.emptyDesc,d=void 0===i?t("EMPTY_KEYWORDS_DESC"):i,y=a.placeholder,g=void 0===y?t(" "):y;return f.default.createElement("div",{className:(0,p.default)(E.default.wrapper,l)},f.default.createElement(v.default,{className:E.default.wrapper,title:o,placeholder:g,validate:n,onAdd:this.handleAdd}),f.default.createElement("p",{className:"margin-t8"},s),f.default.createElement("div",{className:E.default.boxWrapper},(0,m.default)(r)?f.default.createElement("div",{className:E.default.empty},d):r.map((function(t,a){return f.default.createElement(h.Tag,{className:E.default.tag,key:"".concat(t,"-").concat(a)},t,f.default.createElement(h.Icon,{name:"close",size:12,clickable:!0,type:"light",onClick:function(){return e.handleDelete(t,a)}}))}))))}}]),r}(f.default.Component);a.default=g,g.propTypes={value:d.default.array,onChange:d.default.func},g.defaultProps={value:[],onChange:function(){}}},,function(e,t,a){e.exports={body:"_1dBSaRblPfBn-mqT_KKE3S",formItem:"iH3qOy_HN_GKp2DHh14E",urlInput:"_2B1OdPUOkMfYykX5QmiCr5",label:"_2qOEiddhpXtxUvsrjH18Jw",desc:"L_NsnJWzaluWmh8TdlMsc",field:"_7hAGFIYgADWKFn3WK0tWD",fieldInput:"_2aknEdLUnkxDuraw2Zn01J",protocol:"_2tM1lMWiP_tnelAVYCnDOu",url:"_3tjuojCcgCMNlIeVz-XkLP",validated:"_1laKRGeL96H0Mm_frK-cu8",validStatus:"d9NK4MMS7VQlOHlThM-P1",access:"_3qhTvuFZpMBckEcXWQT5bi",accessItem:"_22lD7uAdTjGbgCQUZCuEzO",verifyBtn:"yAN3vK16N0HKawleIBS-g",timeInput:"xOQCUWADs79nVpq1YymkB",input:"_2gp7EWD023VrljWknkh8ML",select:"_2XaWi99BOi61P7Hqiyr7ic"}},,function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(31)),p=n(r(26)),m=n(r(140)),h=n(r(163)),v=n(r(198)),E=n(r(0)),y=n(r(106)),g=n(r(1096)),b=r(243),S=n(r(1)),_=n(r(5)),O=r(189),C=n(r(826)),T=n(r(800)),R=n(r(2822));function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,d.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}g.default.defaultStyles.overlay=N(N({},g.default.defaultStyles.overlay),{},{padding:0,minWidth:500,backgroundColor:"rgba(35, 45, 65, 0.7)",zIndex:2e3,overflow:"auto"}),g.default.defaultStyles.content=N(N({},(0,m.default)(g.default.defaultStyles.content,["top","left","right","bottom","padding"])),{},{width:744,position:"relative",margin:"0 auto"});var I=function(e){(0,s.default)(r,e);var a=D(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"renderTitle",value:function(){var e=this.props,t=e.icon,a=e.imageIcon,r=e.title,n=e.description,l=e.rightScreen?48:(0,h.default)(n)?20:40;return E.default.createElement("div",{className:R.default.title},a?E.default.createElement("label",{className:R.default.image},E.default.createElement(C.default,{src:a,iconLetter:a,iconSize:l})):t&&E.default.createElement(O.Icon,{name:t,size:l}),E.default.createElement(T.default,{title:r,description:n}))}},{key:"render",value:function(){var e,a=this.props,r=a.className,n=a.width,o=a.visible,c=a.children,s=a.hideFooter,i=a.onOk,f=a.onCancel,p=a.onPrev,m=a.okText,h=a.cancelText,v=a.okButtonType,y=a.cancelButtonType,b=a.closable,S=a.operations,T=a.headerClassName,D=a.bodyClassName,k=a.footerClassName,N=a.fullScreen,I=a.rightScreen,P=a.maskClosable,A=a.isSubmitting,w=a.icon,L=a.imageIcon,M=a.disableSubmit,x=a.customTitle,j=a.okTooltip,U=(0,u.default)(a,["className","width","visible","children","hideFooter","onOk","onCancel","onPrev","okText","cancelText","okButtonType","cancelButtonType","closable","operations","headerClassName","bodyClassName","footerClassName","fullScreen","rightScreen","maskClosable","isSubmitting","icon","imageIcon","disableSubmit","customTitle","okTooltip"]),F={content:{}},V=(w||L)&&I;N||I||(F.content.width=n);var G=x||E.default.createElement(E.default.Fragment,null,this.renderTitle(),V&&E.default.createElement("div",{className:R.default.iconBg},L?E.default.createElement(C.default,{src:L,iconLetter:L,iconSize:200}):E.default.createElement(O.Icon,{name:w,size:200}))),B=E.default.createElement(O.Button,{type:v,loading:A,disabled:M||A,onClick:i,"data-test":"modal-ok"},m||t("OK"));return E.default.createElement(g.default,(0,l.default)({className:(0,_.default)(R.default.modal,r,(e={},(0,d.default)(e,R.default.fullscreen,N),(0,d.default)(e,R.default.rightScreen,I),e)),style:F,isOpen:o,onRequestClose:f,ariaHideApp:!1,closeTimeoutMS:0,shouldCloseOnOverlayClick:P},U),E.default.createElement("div",{className:(0,_.default)(R.default.header,T)},G,S,b&&E.default.createElement(O.Button,{className:R.default.close,icon:"close",iconType:"light",type:"control",onClick:f,"data-test":"modal-close"})),E.default.createElement("div",{className:(0,_.default)(R.default.body,D,(0,d.default)({},R.default.hideFooter,s))},c),!s&&E.default.createElement("div",{className:(0,_.default)(R.default.footer,k)},p?E.default.createElement(O.Button,{type:y,onClick:p,"data-test":"modal-cancel"},t("PREVIOUS")):f&&E.default.createElement(O.Button,{type:y,onClick:f,"data-test":"modal-cancel"},h||t("CANCEL")),i&&(j?E.default.createElement(O.Tooltip,{content:E.default.createElement("div",null,j)},E.default.createElement("span",{style:{display:"inline-block",marginLeft:"10px"}},B)):B)))}}]),r}(E.default.Component);a.default=I,I.propTypes={className:S.default.string,headerClassName:S.default.string,bodyClassName:S.default.string,footerClassName:S.default.string,icon:S.default.string,title:S.default.oneOfType([S.default.node,S.default.string]),description:S.default.oneOfType([S.default.node,S.default.string]),width:S.default.oneOfType([S.default.number,S.default.string]),visible:S.default.bool,okText:S.default.string,cancelText:S.default.string,okButtonType:S.default.string,cancelButtonType:S.default.string,onOk:S.default.func,onCancel:S.default.func,renderFooter:S.default.func,children:S.default.any,hideFooter:S.default.bool,closable:S.default.bool,maskClosable:S.default.bool,fullScreen:S.default.bool,rightScreen:S.default.bool,disableSubmit:S.default.bool,customTitle:S.default.node,onPrev:S.default.func},I.defaultProps={className:"",width:600,visible:!1,hideFooter:!1,closable:!0,maskClosable:!1,fullScreen:!1,rightScreen:!1,isSubmitting:!1,okButtonType:"control",cancelButtonType:"default",disableSubmit:!1},I.open=function(e){var t=document.createElement("div");document.body.appendChild(t),document.activeElement.blur();var a=function(){(0,v.default)(e.onCancel)&&e.onCancel(),I.close(t)},r=e.modal,n=(0,b.observer)((function(){return E.default.createElement(r,(0,l.default)({},(0,m.default)(e,"modal","onCancel"),{isSubmitting:(0,p.default)(e,"store.isSubmitting"),onCancel:a,visible:!0}))}));return y.default.render(E.default.createElement(n,null),t),t},I.close=function(e){y.default.unmountComponentAtNode(e)&&e.parentNode&&e.parentNode.removeChild(e)}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u,o,c,s,i,f,d=n(r(31)),p=n(r(62)),m=n(r(25)),h=n(r(28)),v=n(r(74)),E=n(r(41)),y=n(r(42)),g=n(r(37)),b=n(r(45)),S=(n(r(63)),n(r(5))),_=n(r(1150)),O=n(r(1051)),C=n(r(26)),T=n(r(67)),R=r(17),D=r(243),k=n(r(0)),N=n(r(1468)),I=n(r(2869)),P=n(r(2874)),A=n(r(2921));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,g.default)(e);if(t){var n=(0,g.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,y.default)(this,a)}}var M={json:{pipeline:{stages:[],agent:{type:"any"}}}},x=(0,D.observer)((f=i=function(e){(0,E.default)(r,e);var a=L(r);function r(e){var t;if((0,m.default)(this,r),t=a.call(this,e),(0,p.default)(t,"clearFocus",o,(0,v.default)(t)),(0,p.default)(t,"handleContinue",c,(0,v.default)(t)),(0,p.default)(t,"handleDiscard",s,(0,v.default)(t)),t.state={},e.isEditMode){t.store=new A.default,t.store.params=e.params;var n=e.params,l=n.devops,u=n.name;t.prevData=JSON.parse(localStorage.getItem("".concat(globals.user.username,"-").concat(l,"-").concat(u))),t.store.fetchLabel(),(0,T.default)(e.jsonData)?t.store.setData(t.prevData||M):(t.store.jsonData=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,d.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.jsonData),t.prevData&&(t.state={showConfirmPrevdata:!0}))}return t}return(0,h.default)(r,[{key:"render",value:function(){var e,a,r=this.props,n=r.isEditMode,l=r.className,u=r.isSubmitting,o=(null!==(e=null===(a=this.props)||void 0===a?void 0:a.params)&&void 0!==e?e:{}).cluster;return k.default.createElement("div",{className:(0,S.default)(N.default.content,"pipeline-content",l)},k.default.createElement(_.default,{enableToggleFullScreen:!n,XOffset:30,YOffset:60,onClick:this.clearFocus},k.default.createElement(I.default,{store:this.store,isEditMode:n,stages:this.stages})),n?k.default.createElement(P.default,{store:this.store,onOk:this.props.onOk,onCancel:this.props.onCancel,isSubmitting:u,cluster:o,trigger:this.props.trigger}):null,k.default.createElement(O.default,{visible:this.state.showConfirmPrevdata,width:400,title:t("LoadPrevData_Desc"),content:"",cancelText:t("Discard"),confirmText:t("Continue"),onCancel:this.handleDiscard,onConfirm:this.handleContinue}))}},{key:"stages",get:function(){var e=this.props,t=e.isEditMode,a=e.jsonData;return t?this.store.stages:(0,C.default)(a,"json.pipeline.stages",[])}}]),r}(k.default.Component),i.defaultProps={onOK:function(){},onCancel:function(){}},u=f,o=(0,b.default)(u.prototype,"clearFocus",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.isEditMode&&e.store.clearFocus()}}}),c=(0,b.default)(u.prototype,"handleContinue",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.props.params,a=t.devops,r=t.name;e.setState({showConfirmPrevdata:!1}),e.store.setData(e.prevData),localStorage.removeItem("".concat(globals.user.username,"-").concat(a,"-").concat(r))}}}),s=(0,b.default)(u.prototype,"handleDiscard",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.props.params,a=t.devops,r=t.name;e.setState({showConfirmPrevdata:!1}),localStorage.removeItem("".concat(globals.user.username,"-").concat(a,"-").concat(r))}}}),l=u))||l;a.default=x},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(14),r(99),r(79),Object.defineProperty(a,"__esModule",{value:!0}),a.renderStepArgs=void 0,r(20),r(141),r(14),r(120),r(99),r(79);var l=n(r(26)),u=n(r(142)),o=n(r(244)),c=n(r(68)),s=n(r(0)),i=r(902),f=n(r(966)),d=function(e){return void 0!==(0,l.default)(e,"value.value")?"string"==typeof e.value.value?e.value.value:JSON.stringify(e.value.value):"string"==typeof e.value?e.value:JSON.stringify(e.value)},p=function(e){return s.default.createElement("div",{key:e.key,className:f.default.content__detail},t(e.key),"   ",d(e))},m=function(e){return Object.entries(e).map((function(e){return s.default.createElement("div",{key:e[0],className:f.default.content__detail},t(e[0]),"   ",e[1])}))},h={git:function(e){return"changelog"===e.key||"poll"===e.key?null:p(e)},withCredentials:function(e){var t=d(e);if((0,u.default)(t)&&t.startsWith("${")){var a=(0,i.groovyToJS)(t);return m(a)}return p(e)},checkout:function(e){if("scm"===e.key){var t=d(e);if((0,u.default)(t)&&t.startsWith("[")){var a=(0,i.groovyToJS)(t);return a.url&&!a.remote&&(0,c.default)(a,"remote",a.url),a=(0,o.default)(a,["remote","credentialsId"]),m(a)}return p(e)}return null},default:p};a.renderStepArgs=function(e){return e.arguments?void 0!==e.arguments.length?e.arguments.map((function(t){return h[e.name]?h[e.name](t):h.default(t)})):h[e.name]?h[e.name](e.arguments):h.default(e.arguments):null}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=n(r(838)),y=n(r(1010));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleChange=function(e){t.newValue=e},t.handleOk=function(){t.props.onOk(t.newValue)},t.state={value:""},t}return(0,s.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.value;this.state.value=e}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("yaml")},p.default.createElement(E.default,{className:y.default.CodeEditor,name:"script",mode:"yaml",value:this.state.value,onChange:this.handleChange}))}}],[{key:"getDerivedStateFromProps",value:function(e){return{value:e.value}}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,t,a){e.exports={templateParams:"_3OaPsWjDseZlyvzVyh4shI",container:"VCeY3AOEqowO64dK4tCg9",params:"_1ymcUpjfqsH5vqVTE3bgK",params_container:"_6gdEyFwcAl-pF3FJDq_0C",itemWrapper:"_2lQsvf23MK44IzuZh9-U2X",content:"_1hjO3TCR42KV3THqO7IDRX",empty:"_1aRxE-OINWHNU21zvG5fJG",icon:"_2DOKE0E0jHLnIbDlIwsSrX",timeOut:"_3qtruIMglpuM_KTjmlcWgO"}},,function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(10),a(6),a(8),a(13),a(9),a(30),a(139),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.STORAGE_CLASS_VOLUME_CLAIMS=t.STORAGE_CLASS_STORAGE=void 0,a(12),a(10),a(6),a(27),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var l=n(a(31)),u=n(a(97)),o=n(a(50)),c=r(a(0)),s=n(a(444)),i=n(a(26)),f=n(a(845)),d=n(a(2945));function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.STORAGE_CLASS_STORAGE="storageclass.storage.k8s.io/requests.storage";t.STORAGE_CLASS_VOLUME_CLAIMS="storageclass.storage.k8s.io/persistentvolumeclaims";var h=function(e){var t,a,r=e.quota,n=e.allStorageClass,l=e.renderOutOfLimitTip,p=void 0!==l&&l,h=e.totalStorageError,v=void 0!==h&&h,E=e.totalVolumeClaimsError,y=void 0!==E&&E,g=e.currentRelatedStorageTotal,b=void 0===g?0:g,S=e.currentRelatedVolumeClaimsTotal,_=void 0===S?0:S,O=e.addedItems,C=void 0===O?[]:O,T=(0,o.default)(e,["quota","allStorageClass","renderOutOfLimitTip","totalStorageError","totalVolumeClaimsError","currentRelatedStorageTotal","currentRelatedVolumeClaimsTotal","addedItems"]),R=(0,c.useState)({"requests.storage":"InfinityGi",persistentvolumeclaims:""}),D=(0,u.default)(R,2),k=D[0],N=D[1],I=(0,c.useState)([]),P=(0,u.default)(I,2),A=P[0],w=P[1];(0,c.useEffect)((function(){N(r)}),[r]),(0,c.useEffect)((function(){var e=[],t=[];Object.keys(r).forEach((function(e){((0,s.default)(e,"storageclass.storage.k8s.io/requests.storage")||(0,s.default)(e,"storageclass.storage.k8s.io/persistentvolumeclaims"))&&t.push({key:e,value:r[e]})})),t.length>0&&(e=(0,f.default)(t,(function(e){return e.key.split(".")[0]}))),w(e)}),[r]);var L=(0,c.useCallback)((function(e){var t={"requests.storage":(0,i.default)(e,["requests.storage"],""),persistentvolumeclaims:(0,i.default)(e,"persistentvolumeclaims","")};T.onChange({actionType:"add",data:m({},t)})})),M=(0,c.useCallback)((function(e){T.onChange(e)}));return c.default.createElement(d.default,{namespace:T.namespace,allStorageClass:n,isWorkspace:(0,i.default)(T,"isWorkspace",!0),availableQuota:T.availableQuota,wsAvailableRequest:null!==(t=T.wsAvailableRequest)&&void 0!==t?t:{},relatedStoragesLimit:null!==(a=T.relatedStoragesLimit)&&void 0!==a?a:[],storageLimitSpec:k,namespaceStorageClass:A,handleWsLimitChange:L,handleRelateVolumeChange:M,renderOutOfLimitTip:p,totalStorageError:v,totalVolumeClaimsError:y,currentRelatedStorageTotal:b,currentRelatedVolumeClaimsTotal:_,addedItems:C})};t.default=h},,function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(21),a(18),a(43),a(11);var l=n(a(317)),u=n(a(50)),o=n(a(38));a(35);var c=n(a(39)),s=n(a(25)),i=n(a(28)),f=n(a(41)),d=n(a(42)),p=n(a(37)),m=r(a(0)),h=a(189),v=a(865),E=n(a(1485)),y=n(a(3025));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var b=function(e){(0,f.default)(a,e);var t=g(a);function a(e){var r;return(0,s.default)(this,a),(r=t.call(this,e)).icon="pen",r.handleOk=function(){var e=r.props,t=e.formTemplate,a=e.onOk;r.formRef.current.validate((0,c.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a(t);case 1:case"end":return e.stop()}}),e)}))))},r.component=E.default,r.formRef=m.createRef(),r}return(0,i.default)(a,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.formTemplate,r=e.store,n=(0,u.default)(e,["title","formTemplate","store"]),o=this.component;return m.createElement(v.Modal,(0,l.default)({width:960},n,{onOk:this.handleOk,title:m.createElement("div",{className:y.default.title},m.createElement(h.Icon,{name:this.icon,className:"margin-r8"}),m.createElement("div",null,t))}),m.createElement("div",{className:y.default.wrapper},m.createElement(o,{formTemplate:a,formRef:this.formRef,isEdit:!0,store:r})))}}]),a}(m.Component);t.default=b},function(e,t,a){"use strict";(function(e){var r=a(19);a(12),a(10),a(6),a(8),a(13),a(970),a(9),a(4),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(10),a(6),a(27),a(29),a(33),a(16),a(8),a(13),a(970),a(9),a(4),a(21),a(11),a(7);var n=r(a(38)),l=r(a(31)),u=r(a(50));a(35);var o,c,s,i,f,d=r(a(39)),p=r(a(62)),m=r(a(25)),h=r(a(28)),v=r(a(45)),E=(r(a(63)),a(17));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b=(o=function(){function t(){var a=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,m.default)(this,t),(0,p.default)(this,"isLoading",c,this),(0,p.default)(this,"pathParams",s,this),(0,p.default)(this,"data",i,this),(0,p.default)(this,"headers",f,this),Object.getOwnPropertyNames(r).forEach((function(e){a[e]=r[e]})),this.headers={"X-Remote-User":e.globals.user.username}}return(0,h.default)(t,[{key:"getApiPath",value:function(){return"kapis/logging.kubesphere.io/v1alpha2/logs"}},{key:"request",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((0,d.default)(n.default.mark((function e(){var t,a,r,l,o,c,s,i=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=i.length>1&&void 0!==i[1]?i[1]:"get",this.isLoading=!0,r=t.start_time,l=t.end_time,o=t.cluster,c=(0,u.default)(t,["start_time","end_time","cluster"]),e.next=6,request[a](this.getApiPath(),g(g({},c),{},{start_time:r?Math.floor(r/1e3):void 0,end_time:l?Math.floor(l/1e3):void 0,cluster:o}),{headers:this.headers});case 6:return s=e.sent,this.isLoading=!1,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)}))))},{key:"apiVersion",get:function(){return"kapis/logging.kubesphere.io/v1alpha2"}}]),t}(),c=(0,v.default)(o.prototype,"isLoading",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=(0,v.default)(o.prototype,"pathParams",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),i=(0,v.default)(o.prototype,"data",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=(0,v.default)(o.prototype,"headers",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),(0,v.default)(o.prototype,"request",[E.action],Object.getOwnPropertyDescriptor(o.prototype,"request"),o.prototype),o);t.default=b}).call(this,a(75))},,,,,function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(10),r(20),r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(29),r(8),r(4),r(18),r(43),r(11);var u,o,c,s,i,f=n(r(62)),d=n(r(25)),p=n(r(28)),m=n(r(74)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=(n(r(63)),n(r(45))),g=n(r(317)),b=n(r(50)),S=l(r(0)),_=n(r(5)),O=r(17),C=r(243),T=n(r(163)),R=n(r(26)),D=n(r(67)),k=n(r(4568)),N=n(r(3123)),I=n(r(3125)),P=n(r(3126)),A=r(189),w=n(r(3127));function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}function M(e){var t=e.measure,a=e.data,r=e.height,n=e.children,l=(0,b.default)(e,["measure","data","height","children"]),u=S.useRef(null);return S.useEffect((function(){var e;(null===(e=u.current)||void 0===e?void 0:e.getBoundingClientRect().height)!==r&&t()}),[a]),S.createElement("div",(0,g.default)({},l,{ref:u}),n)}var x=(0,C.observer)((i=s=function(e){(0,h.default)(r,e);var a=L(r);function r(){var e;(0,d.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).measureCache=new I.default({fixedWidth:!0,minHeight:e.props.defaultRowHeight}),e.clearMeasurerCache=function(){e.measureCache.clearAll()},e.onTrClick=function(t){var a=t.target,r=t.currentTarget,n=function e(t){var a=(0,R.default)(t,"dataset.itemIndex");if(t!==r)return(0,T.default)(a)?e(t.parentNode):a}(a);if(!(0,T.default)(n)){var l=e.props.data[n];e.props.onTrClick&&e.props.onTrClick(l)}},(0,f.default)(e,"toggleCol",c,(0,m.default)(e)),e.handleRefresh=function(){location.reload()},e.renderDropdownContent=function(){return S.createElement("div",{className:w.default.dropdown},S.createElement("h3",null,t("CUSTOM_COLUMNS")),e.dropDownCols.map((function(t,a){return S.createElement("div",{key:t.thead,className:w.default.visibleItem,"data-index":a,onClick:e.toggleCol},S.createElement(A.Icon,{name:t.hidden?"eye-closed":"eye"}),S.createElement("span",null,t.thead))})))},e.renderItem=function(t){var a=t.index,r=t.key,n=t.parent,l=t.style,u=e.props.data[a]||{};return S.createElement(P.default,{key:r,parent:n,columnIndex:0,rowIndex:a,cache:e.measureCache},(function(t){var n,o=t.measure,c=t.registerChild;return S.createElement("div",{style:l,ref:c},S.createElement(M,{measure:o,data:e.visibleCol,"data-item-index":a,height:null===(n=e.measureCache._rowHeightCache)||void 0===n?void 0:n[r],className:(0,_.default)(w.default.tr,e.props.trCLassName)},e.visibleCol.map((function(e){return S.createElement("div",{key:e.key,className:(0,_.default)(w.default.bodyItems,e.className)},e.content(u))}))))}))},e}return(0,p.default)(r,[{key:"componentDidUpdate",value:function(){this.clearMeasurerCache()}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,r=t.body,n=t.tableRef,l=t.onScroll,u=a.length;return S.createElement("div",{className:w.default.table},this.renderTitle(),S.createElement("div",{className:(0,_.default)(w.default.body,r),onClick:this.onTrClick},S.createElement(N.default,{onResize:this.CellMeasurerCache},(function(t){var r=t.width,o=t.height;return S.createElement(k.default,{ref:n,width:r,height:o,overscanRowCount:10,rowRenderer:e.renderItem,onScroll:l,rowCount:u,rowHeight:e.measureCache.rowHeight,deferredMeasurementCache:e.measureCache,data:a,visibleCol:e.visibleCol})}))))}},{key:"renderTitle",value:function(){return S.createElement("div",{className:(0,_.default)(w.default.header,this.props.header)},this.visibleCol.map((function(e){return S.createElement("div",{key:e.key,className:(0,_.default)(w.default.headerItems,e.className)},e.thead)})),(0,D.default)((0,O.toJS)(this.dropDownCols))?null:S.createElement("div",{className:w.default.visibleBtn},S.createElement(A.Dropdown,{placement:"bottomRight",content:this.renderDropdownContent(),onOpen:this.handleOpen,onClose:this.handleClose},S.createElement("div",null,t("CUSTOM_COLUMNS")," ",S.createElement(A.Icon,{name:"cogwheel"})))))}},{key:"dropDownCols",get:function(){return this.props.cols.filter((function(e){return!e.mustShow}))}},{key:"visibleCol",get:function(){return this.props.cols.filter((function(e){return!e.hidden}))}}]),r}(S.Component),s.defaultProps={defaultRowHeight:32},o=i,(0,y.default)(o.prototype,"dropDownCols",[O.computed],Object.getOwnPropertyDescriptor(o.prototype,"dropDownCols"),o.prototype),(0,y.default)(o.prototype,"visibleCol",[O.computed],Object.getOwnPropertyDescriptor(o.prototype,"visibleCol"),o.prototype),c=(0,y.default)(o.prototype,"toggleCol",[O.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.currentTarget.dataset.index,r=e.dropDownCols[a];r.hidden=!r.hidden,e.clearMeasurerCache()}}}),u=o))||u;a.default=x},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(10),a(6),a(194),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(10),a(6),a(27),a(194),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var l=n(a(317)),u=n(a(31)),o=n(a(97)),c=r(a(0)),s=n(a(26)),i=n(a(119)),f=n(a(67)),d=n(a(68)),p=a(189),m=n(a(1732)),h=n(a(1741)),v=n(a(1788));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g=function(e){var t=(0,c.useState)(!1),a=(0,o.default)(t,2),r=a[0],n=a[1],u=(0,c.useState)((0,s.default)(e,"formTemplate")),E=(0,o.default)(u,2),g=E[0],b=E[1],S=(0,c.useState)(null),_=(0,o.default)(S,2),O=_[0],C=_[1],T=(0,c.useState)({}),R=(0,o.default)(T,2),D=R[0],k=R[1],N=(0,v.default)(),I=(0,o.default)(N,2),P=I[0],A=I[1],w=function(){C(null),k({})};return c.default.createElement(c.default.Fragment,null,c.default.createElement(p.Form,{data:g,ref:e.formRef}),c.default.createElement("div",null,r?c.default.createElement(h.default,(0,l.default)({},e,{formTemplate:g,onCancel:function(){n(!1),w()},onSave:function(e){var t=(0,s.default)(g,"spec.rules",[]);if((0,f.default)(D))t.push(e);else{var a=y(y({},(0,i.default)(t[O])),e);t.splice(O,1,a)}b(y(y({},g),{},{spec:y(y({},g.spec),{},{rules:t})})),n(!1),w()},editRule:D,allClusters:P,fetchClusterList:A})):c.default.createElement(m.default,{formTemplate:g,AddRuleClick:function(){return n(!0)},handleEdit:function(e,t){n(!0),k((0,i.default)(t)),C(e)},handleDisable:function(e,t){var a=(0,s.default)(g,"spec.rules",[]);(0,d.default)(a[e],"disable",t),b(y(y({},g),{},{spec:y(y({},g.spec),{},{rules:a})}))},handleDelete:function(e){var t=(0,s.default)(g,"spec.rules",[]);t.splice(e,1),b(y(y({},g),{},{spec:y(y({},g.spec),{},{rules:t})}))},onEdit:e.onEdit,index:"ruleList",allClusters:P,fetchClusterList:A,isEditRule:(0,s.default)(e,"editMode",!1),builtInRule:"builtin"===(0,s.default)(e,"type","custom")})))};t.default=g},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(10),r(44),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(10),r(44),r(14),r(4);var u=l(r(317)),o=l(r(97)),c=r(189),s=n(r(0)),i=r(56),f=r(61),d=l(r(1736)),p=function(e){var a=e.cluster,r=e.allClusters,n=void 0===r?[]:r,l=e.title,p=(0,s.useState)({iconName:"kubernetes",tagType:"production"}),m=(0,o.default)(p,2),h=m[0],v=m[1],E=(0,s.useCallback)((function(){var e,t,r=n.filter((function(e){return e.name===a}))[0],l=null!==(e=null==r?void 0:r.provider)&&void 0!==e&&e?f.CLUSTER_PROVIDER_ICON[r.provider]:"kubernetes",u=f.CLUSTER_GROUP_TAG_TYPE[null!==(t=null==r?void 0:r.group)&&void 0!==t?t:"production"];v({iconName:l,tagType:u})}),[a,n]),y=n.find((function(e){return e.name===a}));return(0,s.useEffect)((function(){E()}),[a,n]),y?s.default.createElement(c.Tag,{key:"".concat(a),type:null==h?void 0:h.tagType,className:d.default.tags},s.default.createElement(c.Icon,(0,u.default)({name:null==h?void 0:h.iconName,size:16},"default"===(null==h?void 0:h.tagType)?{type:"light"}:{})),s.default.createElement("span",{className:"text ellipsis",title:"string"==typeof l?l:(0,i.showNameAndAlias)(y)},l||(0,i.showNameAndAlias)(y))):s.default.createElement(c.Tooltip,{content:t("CLUSTER_DELETED")},s.default.createElement(c.Tag,{key:"".concat(a),className:d.default.tags,type:"secondary"},s.default.createElement(c.Icon,{name:"question",size:16}),s.default.createElement("span",{className:"text ellipsis",title:a},a)))};a.default=p},function(e,t,a){e.exports={container:"_1qwlMHMojjzsQ6N5txi0eb",head:"_2rRyD17VVE2tgXIgfS40LO",title:"_28xsQPoGyGzymKvpp-2ytB",icon:"xjgObFIg4yfjdPw8zX6Mc",iconDisabled:"_3TX1cCjQXhssZ37lujU96z",iconOn:"_3qL_0yHuZrs_prNkdGGjhd",text:"sZBjJEpZcltz2_JVWGXno",ruleName:"_2p_hp8zpwtrzTXy4KJQOya",opt:"_3K_cz1Oq_VOHt3ZwwUtA4R",sToggle:"oFpEHGL8Whq8PcjbEL49i",tooltip:"ZnJHhrzA23_KJVzrZSIyc",triangle:"_2Zx-UT33CFkj0Rz_Abl8Jc",icon_margin:"_7iJlU5odv-jDXdtaeKIKR",iconBg:"muXFJtV2oawpU7h8Minh4",desc:"_314TlnBA0Jjs2LnlDl4Svi",descText:"_1dihnQ3_lsSm5NmAYT9vH9",descTextCL:"_1UuTO3ljk5zt7sntIbVRi_",exprLine:"_3QTmWTRvzv45pwfQeL-zZ8",pr_title:"_2r2X79pL5dQ1jN0oXa3ony",exprText:"_3xiQvHI88_LjDfpJFq90a4",cus_text:"_3HqHTae0yI5JaNissjiuFW",clusterTarget_0:"_1yKDCb5piGtYuf7nDoe2hH",cl_text:"eUlnq2lBE4W1y0WZUx3Jl",clusterTarget_1:"_2mAqu0iuU4K5mHQVQLx_TP",clusterTarget_2:"_2QfZP5tuqPvWK2sT0-udB",targetTipRest:"_3B20ZtLtFkSZyMP5aKa7Go",tipContentBox_cluster:"_2zrWgAdAUYMi1M3XfliKLe",tipContentBox:"_11xloJuRf3x3nX_gEz8gdb",tipLineItem:"_2PJ__zQyRKFdg2175Jjfog",tipText_title:"_2dxtRtR_G-dygTM3h0uDvW",tipText_deploy:"_C7vuT0fS7akY3htX8E4H",tipText_customNs:"_2vB_zrrjg9NWWmle0nbsiG",tipText_nodes:"_1wLKsLq1NSgpvmN-kQ6BDh",custom_line:"_22PqM-hqfzd_dXfKMbY1yy"}},function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(24),a(8),a(13),a(9),a(4),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.MBPS_RULE_CONFIG=t.KBS_RULE_CONFIG=t.GB_RULE_CONFIG=t.MIB_RULE_CONFIG=t.GIB_RULE_CONFIG=t.CORE_RULE_CONFIG=t.PERCENT_RULE_CONFIG=t.BASE_RULE_CONFIG=t.getBaseRuleConfig=t.SEVERITY_LEVEL=void 0,a(12),a(32),a(10),a(6),a(27),a(29),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(11),a(7);var n=r(a(31)),l=r(a(1739));function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}l.default.DP=10;var c=[{label:">",value:">"},{label:">=",value:">="},{label:"<",value:"<"},{label:"<=",value:"<="}];t.SEVERITY_LEVEL=[{type:"critical",prefixIcon:"information",color:{primary:"#fae7e5",secondary:"#ca2621"},label:"CRITICAL_ALERT",value:"critical"},{type:"warning",prefixIcon:"information",color:{primary:"#fae7e5",secondary:"#f5a623"},label:"ERROR_ALERT",value:"error"},{className:"tag-ffd939",prefixIcon:"information",color:{primary:"#fae7e5",secondary:"#FFD939"},label:"WARNING_ALERT",value:"warning"},{type:"secondary",prefixIcon:"information",color:{primary:"#fae7e5",secondary:"#79879c"},label:"INFO_ALERT",value:"info"}];var s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.comparator,a=void 0===t?{}:t,r=e.thresholds,n=void 0===r?{}:r;return[o({name:"comparator",placeholder:"CONDITION_OPERATOR",options:c},a),o({type:"number",name:"thresholds",placeholder:"THRESHOLD"},n)]};t.getBaseRuleConfig=s;var i=s({thresholds:{min:0,converter:function(e){return Number(e)},reverser:function(e){return Number(e)}}});t.BASE_RULE_CONFIG=i;var f=s({thresholds:{min:0,max:100,unit:"%",converter:function(e){var t=new l.default(e);return Number(t.div(100).toString())},reverser:function(e){var t=new l.default(e);return Number(t.times(100).toString())}}});t.PERCENT_RULE_CONFIG=f;var d=s({thresholds:{unit:"core",min:0,converter:function(e){return Number(e)},reverser:function(e){return Number(e)}}});t.CORE_RULE_CONFIG=d;var p=s({thresholds:{unit:"GiB",min:0,converter:function(e){var t=new l.default(e),a=new l.default(1024).pow(3);return Number(t.times(a).toString())},reverser:function(e){var t=new l.default(e),a=new l.default(1024).pow(3);return Number(t.div(a).toString())}}});t.GIB_RULE_CONFIG=p;var m=s({thresholds:{unit:"MiB",min:0,converter:function(e){var t=new l.default(e),a=new l.default(1024).pow(2);return Number(t.times(a).toString())},reverser:function(e){var t=new l.default(e),a=new l.default(1024).pow(2);return Number(t.div(a).toString())}}});t.MIB_RULE_CONFIG=m;var h=s({thresholds:{unit:"GB",min:0,converter:function(e){var t=new l.default(e),a=new l.default(1e3).pow(3);return Number(t.times(a).toString())},reverser:function(e){var t=new l.default(e),a=new l.default(1e3).pow(3);return Number(t.div(a).toString())}}});t.GB_RULE_CONFIG=h;var v=s({thresholds:{unit:"KB/s",min:0,converter:function(e){var t=new l.default(e),a=new l.default(1e3);return Number(t.times(a).toString())},reverser:function(e){var t=new l.default(e),a=new l.default(1e3);return Number(t.div(a).toString())}}});t.KBS_RULE_CONFIG=v;var E=s({thresholds:{unit:"Mbps",min:0,converter:function(e){var t=new l.default(e),a=new l.default(1e3).pow(2);return Number(t.times(a).toString())},reverser:function(e){var t=new l.default(e),a=new l.default(1e3).pow(2);return Number(t.div(a).toString())}}});t.MBPS_RULE_CONFIG=E},function(e,t,a){e.exports={label:"Z-U5IRNMWQ86yMexKXFy_",contentGroup:"_3iuHSG0DlTJROaoRhluNmB",tabs:"_1f6pOyyTC6xWPfuFxAfWTG",message:"_2yhuv-i7q81rHoZEnWGGmR",inputs:"_2M-O1nHcgH9pf40USSZCUQ"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(0)),l=r(a(1745)),u=r(a(1750)),o=function(e){return n.default.createElement(n.default.Fragment,null,"node"===e.monitorLevel?n.default.createElement(u.default,e):n.default.createElement(l.default,e))};t.default=o},,function(e,t,a){e.exports={wrapper:"_1XYyYYvYayNUeKHCLUkDcE",selectItem:"_2OghTLA3ttMuOQjFqKoA06",clusterOpt:"yQVuKAnQFpVogTB3Q8Xsv",optionText:"Oy3oB1xosot1HkUKVam_p",wsOpt:"_4d1NB0qWhSZF4SC2t_X98",nodeOpt:"KAQNxPFjvnFz8KkqcZ-2m",hideIcon:"_1lzSYBwuFPVomAzy61XuID",nodeLabel:"_2Slyrr8z8XfjO5JIyKcYTr"}},function(e,t,a){e.exports={wrapper:"QMfWpdzbQ_252plwez1mP",selectItem:"fsU_RMLERoGrDF334gfqT",clusterOpt:"_25YaDFZxkbBIUWnBbcaSCW",optionText:"_29LqfeQuZ3B8QaVK8NGwdx",nodeOpt:"_1ogev-xPEF_bLqsYI4KYPl",hideIcon:"QMIzUILF1iAqXJFr7F3Sk",nodeLabel:"_1yXRFwaWgZWmRn6Wp9Dvo9"}},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var l=n(a(25)),u=n(a(28)),o=n(a(41)),c=n(a(42)),s=n(a(37)),i=r(a(0)),f=n(a(1266)),d=n(a(1102));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).state={isOpen:!1},e.ref=i.default.createRef(),e.handleDOMClick=function(t){e.ref&&!e.ref.current.contains(t.target)&&e.setState({isOpen:!1})},e.handleSelect=function(t){e.props.onSelect(t),e.setState({isOpen:!1})},e.triggerOpen=function(){e.setState((function(e){return{isOpen:!e.isOpen}}))},e}return(0,u.default)(a,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDOMClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDOMClick)}},{key:"getOptionsStyle",value:function(e){var t=e.length>=8?8:e.length,a={};if(this.ref&&this.ref.current){var r=this.ref.current.getBoundingClientRect();window.innerHeight-r.top>31.5*t+8+r.height?a.top=r.top+r.height+8:a.top=r.top-8-31.5*t,a.left=r.left}return a}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.options,r=this.state.isOpen;return i.default.createElement("div",{className:d.default.wrapper,ref:this.ref},i.default.createElement("div",{className:d.default.trigger,onClick:this.triggerOpen},t),r&&i.default.createElement(f.default,{style:this.getOptionsStyle(a),options:a,level:0,onSelect:this.handleSelect}))}}]),a}(i.Component);t.default=m,m.defaultProps={options:[],children:"",onSelect:function(){}}},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(4),a(18),a(43),a(11);var l=n(a(25)),u=n(a(28)),o=n(a(41)),c=n(a(42)),s=n(a(37)),i=r(a(0)),f=n(a(1765)),d=n(a(1102));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).state={openKey:""},e.handleClick=function(t){e.setState({openKey:t})},e}return(0,u.default)(a,[{key:"render",value:function(){var e=this,t=this.state.openKey,a=this.props,r=a.style,n=a.options,l=a.level,u=a.onSelect;return i.default.createElement("div",{className:d.default.options,style:r},n.map((function(a){return i.default.createElement(f.default,{key:a.value,data:a,level:l,isOpen:a.value===t,onClick:e.handleClick,onSelect:u})})))}}]),a}(i.Component);t.default=m,m.defaultProps={level:0,options:[],onSelect:function(){}}},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(70),a(4),a(18),a(11),a(73),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(70),a(27),a(29),a(4),a(18),a(43),a(11),a(73);var l=n(a(25)),u=n(a(28)),o=n(a(41)),c=n(a(42)),s=n(a(37)),i=r(a(0)),f=n(a(1766)),d=a(1769),p=n(a(1772)),m=n(a(1773));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(a,e);var t=h(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).state={value:e.props.value,visible:!1},e.editor=i.default.createRef(),e.wrapper=i.default.createRef(),e.valueHistory=new p.default,e.cursorHistory=new p.default,e.triggerChange=function(t){var a=e.props.onChange;e.valueHistory.push(t),e.cursorHistory.push(e.state.position),a(t)},e.handleValueUpdateFromProps=function(t){e.editor.current.innerHTML=(0,d.highlightPromql)(t)},e.handleInput=function(t){var a=t.target,r=(0,d.getCaretCharacterOffsetWithin)(a),n=a.innerText;if(t.data&&d.PUNCTUATION_MAP[t.data]){var l=n.substring(0,r),u=n.substring(r);n=l+d.PUNCTUATION_MAP[t.data]+u}a.innerHTML=(0,d.highlightPromql)(n),(0,d.setCaretPosition)(a,r);var o=window.getSelection().getRangeAt(0).startContainer,c=o.textContent,s=(0,d.getTokenContext)(e.editor.current,o);e.setState({value:n,focusValue:c,position:r,tokenContext:s,visible:!0},(function(){return e.triggerChange(n)}))},e.handleKeyDown=function(t){e.keydownHandler[t.keyCode]&&e.keydownHandler[t.keyCode](t),t.metaKey&&90===t.keyCode&&(t.stopPropagation(),t.preventDefault(),t.shiftKey?e.handleRedo():e.handleUndo())},e.handleKeyUp=function(t){e.keyupHandler[t.keyCode]&&e.keyupHandler[t.keyCode](t)},e.handleRedo=function(){var t=e.valueHistory.redo(),a=e.cursorHistory.redo();e.setState({position:a},(function(){e.props.onChange(t)}))},e.handleUndo=function(){var t=e.valueHistory.undo(),a=e.cursorHistory.undo();e.setState({position:a},(function(){e.props.onChange(t)}))},e.handleCursorChange=function(){var t=e.editor.current,a=(0,d.getCaretCharacterOffsetWithin)(t),r=window.getSelection().getRangeAt(0).startContainer,n=r.textContent,l=(0,d.getTokenContext)(e.editor.current,r);e.setState({focusValue:n,position:a,tokenContext:l,visible:!0})},e.handleLabelSearch=function(){var t=e.state.focusValue,a=e.props.onLabelSearch;t&&a&&a(t)},e.handleSuggestionSelect=function(t){var a=e.state,r=a.value,n=a.focusValue,l=a.position,u=0,o=n.length;if(d.OPERATORS.includes(n))u=l,o=0;else for(var c=l-1;c>=0;c--)if(d.OPERATORS.includes(r[c])||""===r[c]){u=c+1;break}var s=r.substring(0,u)+t+r.substring(u+o),i=u+t.length;e.setState({visible:!1,value:s,focusValue:t,position:i},(function(){if(e.triggerChange(s),"{"===r[i]&&e.handleLabelSearch(),e.editor.current){var t=e.editor.current;t.innerHTML=(0,d.highlightPromql)(s),(0,d.setCaretPosition)(t,i)}}))},e.handleDOMClick=function(t){e.wrapper&&e.wrapper.current&&!e.wrapper.current.contains(t.target)&&e.setState({visible:!1}),e.editor&&e.editor.current&&e.editor.current.contains(t.target)&&e.handleCursorChange()},e}return(0,u.default)(a,[{key:"componentDidMount",value:function(){if(this.editor.current){var e=this.state.value;this.editor.current.addEventListener("input",this.handleInput),this.editor.current.addEventListener("keydown",this.handleKeyDown),this.editor.current.addEventListener("keyup",this.handleKeyUp),this.handleValueUpdateFromProps(e)}document.addEventListener("click",this.handleDOMClick)}},{key:"componentDidUpdate",value:function(e,t){var a=this,r=this.props.value;t.value!==r&&this.setState({value:r},(function(){a.handleValueUpdateFromProps(r)}))}},{key:"componentWillUnmount",value:function(){this.editor.current&&(this.editor.current.removeEventListener("input",this.handleInput),this.editor.current.removeEventListener("keydown",this.handleKeyDown),this.editor.current.removeEventListener("keyup",this.handleKeyUp)),document.removeEventListener("click",this.handleDOMClick)}},{key:"render",value:function(){var e=this.state,t=e.visible,a=e.focusValue,r=e.tokenContext,n=this.props,l=n.metrics,u=n.labelsets;return i.default.createElement("div",{className:m.default.wrapper,ref:this.wrapper},i.default.createElement("pre",null,i.default.createElement("code",{className:m.default.input,ref:this.editor,spellCheck:"false",contentEditable:!0})),t&&a&&i.default.createElement(f.default,{className:m.default.suggestions,value:a,metrics:l,tokenContext:r,labelsets:u,onSelect:this.handleSuggestionSelect}))}},{key:"keydownHandler",get:function(){return{219:this.handleLabelSearch}}},{key:"keyupHandler",get:function(){return{37:this.handleCursorChange,39:this.handleCursorChange}}}]),a}(i.Component);t.default=v,v.defaultProps={value:""}},function(e,t,a){"use strict";a(16),a(3),a(66),a(20),a(143),a(30),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.FUNCTIONS=t.OPERATORS=t.RATE_RANGES=void 0,a(3),a(66),a(20),a(143),a(251),a(30),a(252),a(11);t.RATE_RANGES=[{label:"$__interval",sortText:"$__interval"},{label:"$__rate_interval",sortText:"$__rate_interval"},{label:"1m",sortText:"00:01:00"},{label:"5m",sortText:"00:05:00"},{label:"10m",sortText:"00:10:00"},{label:"30m",sortText:"00:30:00"},{label:"1h",sortText:"01:00:00"},{label:"1d",sortText:"24:00:00"}];var r=["by","group_left","group_right","ignoring","on","offset","without"];t.OPERATORS=r;var n=[].concat([{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate φ-quantile (0 ≤ φ ≤ 1) over dimensions"}],[{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(φ float, b instant-vector)",documentation:"Calculates the φ-quantile (0 ≤ φ ≤ 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The φ-quantile (0 ≤ φ ≤ 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}]);t.FUNCTIONS=n;var l={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=})/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp("\\b(?:".concat(n.map((function(e){return e.label})).join("|"),")(?=\\s*\\()"),"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp("/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:".concat(r.join("|"),")\\b"),"i"),punctuation:/[{};()`,.]/};t.default=l},function(e,t,a){e.exports={wrapper:"_14f5Z8AW-sO-D5eOUy8VOK",group:"_3IFETh-yDAtvA1RpJm_nuS",groupTitle:"_1EI8CS41YrdnEKUGY2JhS4",item:"_1L9wOQP2fgWpJRSXX_gfSy"}},,,,,,,function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(20),r(51),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(20),r(51),r(29),r(4),r(18),r(43),r(30),r(195),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(798)),d=r(878),p=n(r(831)),m=r(17),h=n(r(1)),v=n(r(0)),E=r(61),y=n(r(980)),g=n(r(1789));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var S=function(e){(0,o.default)(r,e);var a=b(r);function r(e){var n;return(0,l.default)(this,r),(n=a.call(this,e)).handleOk=function(e){var t=n.props,a=t.onOk,r=t.store,l=t.detail,u=r.list,o=(0,m.toJS)(u.selectedRowKeys),c=o?o.filter((function(e){return e!==l.uid})):"";a(e),o&&u.setSelectRowKeys(c)},n.timeValidator=function(e,a,r){var n=a.slice(0,-1);if(!/^[0-9]*$/.test(n))return r({message:t("INVALID_TIME_DESC")});r()},n.state={formData:(0,p.default)((0,m.toJS)(e.detail._originData||e.detail))},n}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,p.default)((0,m.toJS)(this.props.detail._originData||this.props.detail))})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=this.state.formData;return v.default.createElement(f.default.Form,{data:l,width:691,title:t("EDIT_INFORMATION"),icon:"pen",onOk:this.handleOk,okText:t("OK"),onCancel:n,visible:a,isSubmitting:r},v.default.createElement(i.Form.Item,{label:t("NAME")},v.default.createElement(i.Input,{name:"metadata.name",disabled:!0})),v.default.createElement(i.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:E.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},v.default.createElement(i.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),v.default.createElement(i.Form.Item,{label:t("CHECK_INTERVAL"),desc:t("ALERTING_POLICY_CHECK_INTERVAL_DESC"),rules:[{validator:this.timeValidator}]},v.default.createElement(y.default,{className:g.default.duration,name:"spec.interval",unitOptions:this.durationUnitOptions,defaultValue:this.durationUnitOptions[1].value})),v.default.createElement(i.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},v.default.createElement(i.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))}},{key:"durationUnitOptions",get:function(){return[{label:t("SECONDS"),value:"s"},{label:t("MINUTES"),value:"m"},{label:t("HOURS"),value:"h"}]}},{key:"severities",get:function(){return d.SEVERITY_LEVEL.map((function(e){return{label:t(e.label),value:e.value,level:e}}))}}]),r}(v.default.Component);a.default=S,S.propTypes={detail:h.default.object,visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func,isSubmitting:h.default.bool},S.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(24),r(193),r(8),r(13),r(9),r(4),r(190),r(18),r(11),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(141),r(29),r(14),r(120),r(24),r(193),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(440),r(21),r(18),r(43),r(11),r(7),r(110);var l=n(r(38)),u=n(r(31));r(35);var o=n(r(39)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(189),h=n(r(798)),v=n(r(26)),E=n(r(140)),y=n(r(67)),g=r(820),b=n(r(954)),S=r(847),_=r(944),O=r(803),C=n(r(1906));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var k=function(e){(0,i.default)(r,e);var a=D(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).state={metrics:[],currentMetric:[],step:"30s",times:60,isLoading:!0,autoFetch:!1},e.timer=null,e.transformValue=function(t){if("Custom"===e.ruleType)return t;var a=e.ruleConfig,r=a.reverser,n=a.unit,l=parseFloat(r(Number(t))).toFixed(2);return n?"".concat(l).concat(n):l},e.fetchMetrics=function(){var t=(0,o.default)(l.default.mark((function t(a){var r,n,u,o,c,s,i,f,d,p;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props,n=r.cluster,u=r.namespace,o=e.state,c=o.step,s=o.times,e.setState({isLoading:!0}),i=(0,S.getTimeRange)({step:c,times:s}),f=i.start,d=i.end,t.next=6,e.props.store.fetchMetric(R({expr:e.expr,end:d,start:f,step:c,cluster:n,namespace:u},a));case 6:p=t.sent,e.setState({metrics:p,times:s,step:c,isLoading:!1,timer:null});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.autoFetch=function(){e.timer=setInterval((function(){e.fetchMetrics(),e.fetchCurrentMetic()}),5e3)},e.handleAutoFetch=function(){e.setState((function(e){return{autoFetch:!e.autoFetch}}),(function(){e.autoFetch()}))},e.stopAutoFetch=function(){var t=e.state.autoFetch;clearInterval(e.timer),e.timer=null,e.setState({autoFetch:!t})},e.fetchCurrentMetic=(0,o.default)(l.default.mark((function t(){var a,r,n,u,o;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props,r=a.cluster,n=a.namespace,t.next=3,e.props.store.fetchMetric({expr:e.expr,cluster:r,namespace:n});case 3:u=t.sent,o=u.map((function(e){var t=(0,v.default)(e,"value",["",""]),a=(0,v.default)(e,"metric",{});return{time:(0,O.getFormatTime)(1e3*t[0],!0),value:t[1],metric:JSON.stringify(a)}})),e.setState({currentMetric:o});case 6:case"end":return t.stop()}}),t)}))),e.handleChange=function(t){var a=t.step,r=t.times;e.timer&&(clearInterval(e.timer),e.timer=null),e.setState({step:(0,S.getMinuteValue)(a),times:r,autoFetch:!1},(function(){e.fetchMetrics(),e.fetchCurrentMetic()}))},e.handleRefresh=function(){e.setState({autoFetch:!1},(function(){e.timer&&(clearInterval(e.timer),e.timer=null),e.fetchMetrics(),e.fetchCurrentMetic()}))},e.renderOperations=function(){var t=e.state,a=t.step,r=t.times,n=t.autoFetch;return p.default.createElement("div",{className:C.default.opts},p.default.createElement("div",{className:C.default.time},p.default.createElement(b.default,{step:a,times:r,onChange:e.handleChange})),p.default.createElement(m.Button,{className:C.default.refresh,type:"control",icon:n?"pause":"start",iconType:"light",onClick:n?e.stopAutoFetch:e.handleAutoFetch}),p.default.createElement(m.Button,{className:C.default.refresh,type:"control",icon:"refresh",iconType:"light",onClick:e.handleRefresh}))},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.fetchMetrics(),this.fetchCurrentMetic()}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"render",value:function(){var e=this,a=this.props,r=a.visible,n=a.isSubmitting,l=a.onCancel,u=this.state,o=u.isLoading,c=u.metrics,s=u.currentMetric,i=(0,O.getAreaChartOps)({height:396,title:this.chartTitle,unit:this.chartTitleUnit,tailText:this.tailText,data:c,legend:c.map((function(e){return e.metric?JSON.stringify((0,E.default)(e.metric,"__name__")):""}))});return p.default.createElement(h.default,{headerClassName:C.default.header,bodyClassName:C.default.body,visible:r,isSubmitting:n,onCancel:l,imageIcon:"/extensions-static/ks-console-embed/dist/v3dist/assets/monitor.svg",title:t("VIEW_METRIC_DATA_TCAP"),operations:this.renderOperations(),hideFooter:!0,fullScreen:!0},p.default.createElement(m.Loading,{spinning:o},c.length<1?p.default.createElement("div",{className:C.default.metricEmpty},t("NO_MONITOR_METRIC")):p.default.createElement(g.MultiArea,i)),p.default.createElement("div",{className:C.default.current},p.default.createElement("div",{className:C.default.main},p.default.createElement("div",{className:C.default.title},p.default.createElement("span",{className:C.default.time},t("TIME")),p.default.createElement("span",{className:C.default.value},t("VALUE")),p.default.createElement("span",{className:C.default.metric},t("MONITORING_TARGETS"))),p.default.createElement("div",{className:C.default.body},s.map((function(t,a){return p.default.createElement("div",{key:a,className:C.default.line},p.default.createElement("span",{className:C.default.time},t.time),p.default.createElement("span",{className:C.default.value},e.transformValue(t.value)),p.default.createElement("span",{className:C.default.metric},t.metric))}))))))}},{key:"resourceType",get:function(){var e=this.props.rule;return Object.keys(e.exprBuilder)[0]}},{key:"exprBuilder",get:function(){var e=this.props.rule;return(0,v.default)(e,"exprBuilder",{})}},{key:"ruleType",get:function(){return(0,y.default)(this.exprBuilder)?"Custom":"Template"}},{key:"thresholdType",get:function(){var e=(0,v.default)(this.exprBuilder,"".concat([this.resourceType],".metricThreshold"),{}),t=Object.keys(this.exprBuilder)[0],a=Object.keys(e)[0],r=Object.keys(e[a])[0],n="".concat(a,":").concat(r);return _.RESOURCE_METRICS_CONFIG[t][n]}},{key:"threshold",get:function(){if("Template"===this.ruleType){var e=(0,v.default)(this.exprBuilder,"".concat([this.resourceType],".metricThreshold"),{}),t=Object.keys(e)[0];return Object.values(e[t])[0]}return""}},{key:"ruleConfig",get:function(){return this.thresholdType.ruleConfig.filter((function(e){return"thresholds"===e.name}))[0]}},{key:"chartTitleUnit",get:function(){if("Custom"===this.ruleType)return null;var e=this.ruleConfig.unit;return""!==e?e:null}},{key:"chartTitle",get:function(){return"Custom"===this.ruleType?"CUSTOM_RULE":this.thresholdType.tcapLabel}},{key:"tailText",get:function(){return"Custom"===this.ruleType?null:t("THRESHOLD_VALUE",{value:this.threshold})}},{key:"tableColumns",get:function(){return[{title:t("TIME"),dataIndex:"time",width:"21.1%",render:function(e){return p.default.createElement("div",null,e)}},{title:t("VALUE"),dataIndex:"value",width:"21.1%",render:function(e){return p.default.createElement("div",null,e)}},{title:t("MONITORING_TARGETS"),dataIndex:"metric",render:function(e){return p.default.createElement("div",null,e)}}]}},{key:"expr",get:function(){var e=this.props,t=e.ruleStatus,a=e.expr,r=(0,v.default)(t,"expr","");return""!==r?r:a}}]),r}(p.default.Component);a.default=k},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(51),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(51),r(29),r(4),r(18),r(43),r(30),r(195),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=r(189),d=r(878),p=r(243),m=n(r(0)),h=r(61),v=n(r(980));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=(0,p.observer)(l=function(e){(0,c.default)(r,e);var a=E(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).nameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:r,namespace:e.namespace,cluster:e.props.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e.timeValidator=function(e,a,r){var n=a.slice(0,-1);if(!/^[0-9]*$/.test(n))return r({message:t("INVALID_TIME_DESC")});r()},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.isEdit,r=e.formRef,n=e.formTemplate,l=a?[]:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:h.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("NAME_DESC")})},{validator:this.nameValidator}];return m.default.createElement(f.Form,{data:n,ref:r},m.default.createElement(f.Columns,null,m.default.createElement(f.Column,null,m.default.createElement(f.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:l},m.default.createElement(f.Input,{name:"metadata.name",onChange:this.handleNameChange,maxLength:63,readOnly:a}))),m.default.createElement(f.Column,null,m.default.createElement(f.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:h.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},m.default.createElement(f.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),m.default.createElement(f.Columns,null,m.default.createElement(f.Column,null,m.default.createElement(f.Form.Item,{label:t("CHECK_INTERVAL"),desc:t("ALERTING_POLICY_CHECK_INTERVAL_DESC"),rules:[{validator:this.timeValidator}]},m.default.createElement(v.default,{name:"spec.interval",unitOptions:this.durationUnitOptions,defaultValue:this.durationUnitOptions[1].value}))),m.default.createElement(f.Column,null,m.default.createElement(f.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},m.default.createElement(f.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))))}},{key:"namespace",get:function(){return this.props.namespace}},{key:"durationUnitOptions",get:function(){return[{label:t("SECONDS"),value:"s"},{label:t("MINUTES"),value:"m"},{label:t("HOURS"),value:"h"}]}},{key:"severities",get:function(){return d.SEVERITY_LEVEL.map((function(e){return{label:t(e.label),value:e.value,level:e}}))}}]),r}(m.default.Component))||l;a.default=y},function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(10),a(6),a(194),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(10),a(6),a(27),a(194),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var l=n(a(317)),u=n(a(31)),o=n(a(97)),c=r(a(0)),s=n(a(26)),i=n(a(119)),f=n(a(67)),d=n(a(68)),p=a(189),m=n(a(1910)),h=n(a(1914));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=function(e){var t=(0,c.useState)(!1),a=(0,o.default)(t,2),r=a[0],n=a[1],u=(0,c.useState)((0,s.default)(e,"formTemplate")),v=(0,o.default)(u,2),y=v[0],g=v[1],b=(0,c.useState)(null),S=(0,o.default)(b,2),_=S[0],O=S[1],C=(0,c.useState)({}),T=(0,o.default)(C,2),R=T[0],D=T[1],k=function(){O(null),D({})};return c.default.createElement(c.default.Fragment,null,c.default.createElement(p.Form,{data:y,ref:e.formRef}),c.default.createElement("div",null,r?c.default.createElement(h.default,(0,l.default)({},e,{formTemplate:y,onCancel:function(){n(!1),k()},onSave:function(e){var t=(0,s.default)(y,"spec.rules",[]);if((0,f.default)(R))t.push(e);else{var a=E(E({},(0,i.default)(t[_])),e);t.splice(_,1,a)}g(E(E({},y),{},{spec:E(E({},y.spec),{},{rules:t})})),n(!1),k()},editRule:R})):c.default.createElement(m.default,{formTemplate:y,AddRuleClick:function(){return n(!0)},handleEdit:function(e,t){n(!0),D((0,i.default)(t)),O(e)},handleDisable:function(e,t){var a=(0,s.default)(y,"spec.rules",[]);(0,d.default)(a[e],"disable",t),g(E(E({},y),{},{spec:E(E({},y.spec),{},{rules:a})}))},handleDelete:function(e){var t=(0,s.default)(y,"spec.rules",[]);t.splice(e,1),g(E(E({},y),{},{spec:E(E({},y.spec),{},{rules:t})}))},onEdit:e.onEdit,index:"ruleList",builtInRule:"builtin"===(0,s.default)(e,"type","custom")})))};t.default=y},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(20),r(14),r(24),r(99),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(71),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(97)),u=n(r(317)),o=n(r(50)),c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37));r(12),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(24),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(71),r(7);var m=n(r(0)),h=n(r(1)),v=n(r(5)),E=n(r(119)),y=n(r(444)),g=n(r(26)),b=n(r(67)),S=n(r(76)),_=r(189),O=n(r(805)),C=r(944),T=n(r(945)),R=r(922),D=n(r(1918));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var P=[1,5,15,30,60].map((function(e){return{label:t.html("LASTING_MINUTES",{minutes:e}),value:"".concat(e,"m")}})),A=R.severityOptions.map((function(e){return{label:e.label,value:e.value}})),w=function(e){(0,f.default)(r,e);var a=I(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).getMetricType=function(e){var t=(0,g.default)(e.value,"metricThreshold",{});if((0,b.default)(t))return n.metricConfig[0].value;var a=Object.keys(t)[0];return"".concat(a,":").concat(Object.keys(t[a])[0])},n.getStateFromProps=function(e){var t=e.value,a=(0,g.default)(t,"metricThreshold",{}),r=n.metricConfig[0].value.split(":"),l=r[0],u=r[1];if(!(0,b.default)(a)){var o=Object.keys(a)[0];l=o,u=Object.keys(a[o])[0]}var c=(0,g.default)(t,"for",""),s=(0,g.default)(t,"severity","");return{nodeResourceType:l,monitorType:u,comparator:(0,g.default)(t,"comparator",""),duration:""!==c?c:P[0].value,severity:""!==s?s:A[0].value}},n.getSelectOptions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var a=e.prefixIcon,r=e.color,n=e.type,l=e.label,u=e.value,o=e.disabled,c={label:t(l,{value:u}),value:u};return a&&(c.label=m.default.createElement("div",{className:(0,v.default)(D.default.optionLabel,D.default[n])},m.default.createElement(_.Icon,{name:a,size:20,color:r}),c.label)),o&&(c.disabled=o),c}))},n.handleMetricTypeChange=function(e){var t=e.split(":")[0],a=e.split(":")[1],r=n.state,l=r.comparator,u=r.severity,o=r.duration;n.setState({metricType:e,nodeResourceType:t,monitorType:a,thresholds:""},(function(){n.props.onChange({names:n.props.value.names,kind:n.props.value.kind,metricThreshold:(0,c.default)({},t,(0,c.default)({},a,"")),comparator:l,for:o,severity:u})}))},n.handleItemChange=function(e,t){return function(a,r){var l=n.props.onChange,u=(0,S.default)(r)||!r?a:r;"thresholds"===e&&(u=""!==(u=String(u).replace(/([a-zA-Z%/])+$/g,""))?(0,y.default)(u,".")?u:t(Number(u)):""),n.setState((0,c.default)({},e,u),(function(){var t=n.state,a=t.nodeResourceType,r=t.monitorType,o=t.comparator,s=t.duration,i=t.severity,f=(0,g.default)(n.props.value,"metricThreshold.".concat(a,".").concat(r));l({names:n.props.value.names,kind:n.props.value.kind,metricThreshold:(0,c.default)({},a,(0,c.default)({},r,"comparator"===e?f:u)),comparator:"comparator"===e?u:o,for:s,severity:i})}))}},n.handleDurationChange=function(e){var t=n.state,a=t.severity,r=t.nodeResourceType,l=t.monitorType,u=t.comparator,o=(0,g.default)(n.props.value,"metricThreshold.".concat(r,".").concat(l));n.setState({duration:e},(function(){n.props.onChange({names:n.props.value.names,kind:n.props.value.kind,metricThreshold:(0,c.default)({},r,(0,c.default)({},l,o)),for:e,severity:a,comparator:u})}))},n.handleSeverityChange=function(e){var t=n.state,a=t.duration,r=t.nodeResourceType,l=t.monitorType,u=t.comparator,o=(0,g.default)(n.props.value,"metricThreshold.".concat(r,".").concat(l));n.setState({severity:e},(function(){n.props.onChange({names:n.props.value.names,kind:n.props.value.kind,metricThreshold:(0,c.default)({},r,(0,c.default)({},l,o)),for:a,comparator:u,severity:e})}))},n.renderConfigItem=function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.props.value,l=n.state,c=l.nodeResourceType,s=l.monitorType,i=a.type,f=a.name,d=a.placeholder,p=a.options,h=void 0===p?[]:p,v=a.converter,E=a.reverser,b=(0,o.default)(a,["type","name","placeholder","options","converter","reverser"]);if(E){var S=(0,g.default)(r,"metricThreshold.".concat(c,".").concat(s),"");e=""!==S?(0,y.default)(S,".")?S:E(Number(S)):""}var C={key:f,className:D.default[f],placeholder:t(d),value:"comparator"===f?n.state.comparator:e,onChange:n.handleItemChange(f,v)};switch(i){default:case"select":var T=n.getSelectOptions(h);return m.default.createElement(_.Select,(0,u.default)({options:T},C,b));case"number":return m.default.createElement(O.default,(0,u.default)({showUnit:!0},C,b))}},n.state=N({metricType:n.getMetricType(e)},n.getStateFromProps(e)),n.metricOps=n.getSelectOptions(n.metricConfig),n}return(0,i.default)(r,[{key:"render",value:function(){var e=this.state,a=e.metricType,r=e.duration,n=e.severity,l=this.ruleConfig;return m.default.createElement("div",{className:D.default.inputs},m.default.createElement("div",{className:D.default.type},m.default.createElement(_.Select,{options:this.metricOps,value:a,onChange:this.handleMetricTypeChange})),l.map(this.renderConfigItem),m.default.createElement(_.Select,{className:D.default.normalSelect,value:r,options:P,onChange:this.handleDurationChange,placeholder:t("DURATION")}),m.default.createElement(T.default,{className:D.default.normalSelect,value:n,options:A,onChange:this.handleSeverityChange,placeholder:t("SEVERITY")}))}},{key:"resourceMetricsConfig",get:function(){var e=this.props.resourceType;return(0,E.default)(C.RESOURCE_METRICS_CONFIG[e||"node"])||{}}},{key:"metricConfig",get:function(){var e=this.resourceMetricsConfig;return Object.entries(e).map((function(e){var t=(0,l.default)(e,2);return N({value:t[0]},t[1])}))}},{key:"selectMetricConfig",get:function(){var e=this.state.metricType;return this.metricConfig.find((function(t){return t.value===e}))}},{key:"ruleConfig",get:function(){return(0,g.default)(this.selectMetricConfig,"ruleConfig")||[]}}]),r}(m.default.Component);w.propTypes={metricConfig:h.default.array,value:h.default.object,onChange:h.default.func},w.defaultProps={metricConfig:[],value:{},onChange:function(){}};var L=w;a.default=L},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u=l(r(31)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(244)),m=r(189),h=l(r(1920));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=function(e){(0,s.default)(r,e);var a=y(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).selectRef=d.default.createRef(),e.handleNamesChange=function(t){var a=e.props,r=a.value;(0,a.onChange)(E(E({},r),{},{names:t}))},e.handlekindChange=function(t){e.props.onChange(E(E({},e.props.value),{},{kind:t,names:[]})),e.props.fetchWorkloads(t,{}),e.selectRef.current.state.value=[]},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.value,r=e.workloads,n=e.fetchWorkloads,l=e.isLoading;return d.default.createElement(d.default.Fragment,null,d.default.createElement("div",null,d.default.createElement(m.Select,{value:a.kind,options:[{label:t("DEPLOYMENT"),value:"Deployment"},{label:t("STATEFULSET"),value:"StatefulSet"},{label:t("DAEMONSET"),value:"DaemonSet"}],onChange:this.handlekindChange})),d.default.createElement("div",null,d.default.createElement("label",{className:h.default.alertRule},t("MONITORING_TARGETS")),d.default.createElement(m.Select,{value:a.names,ref:this.selectRef,options:r,pagination:this.pagination,isLoading:l,onFetch:function(e){return n(a.kind,e)},onChange:this.handleNamesChange,searchable:!0,multi:!0,placeholder:t("WORKLOAD")})))}},{key:"pagination",get:function(){var e=this.props,t=e.stores,a=e.value;return(0,p.default)(t[a.kind].list,["page","limit","total"])}}]),r}(d.Component);a.default=g},function(e,t,a){e.exports={label:"_3N0hD89apn-au9VwkWOsLH",contentGroup:"_2cBNFxxs4dV56YhfT2DlkZ",message:"_5C0rQ50OG-WwQSQZEC7Ok",inputs:"_3sptfKWD6lFkuuKyi5NyZH"}},,,,,function(e,t,a){"use strict";a(16);var r=a(19),n=a(162);a(10),a(70),a(20),a(4),a(18),a(11),a(73),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(10),a(70),a(20),a(29),a(4),a(21),a(18),a(43),a(11),a(73);var l=r(a(317)),u=r(a(50)),o=r(a(38));a(35);var c,s,i,f=r(a(39)),d=r(a(25)),p=r(a(28)),m=r(a(41)),h=r(a(42)),v=r(a(37)),E=n(a(0)),y=r(a(1)),g=a(17),b=a(243),S=r(a(26)),_=r(a(68)),O=r(a(244)),C=r(a(808)),T=r(a(119)),R=r(a(127)),D=a(189),k=r(a(798)),N=r(a(1956)),I=r(a(1962)),P=r(a(1964)),A=r(a(1967)),w=r(a(887)),L=r(a(1968));function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var x=(0,b.observer)((i=s=function(e){(0,m.default)(a,e);var t=M(a);function a(e){var r;return(0,d.default)(this,a),(r=t.call(this,e)).handleAppChange=(0,C.default)((function(e,t){var a=r.state.detail,n=(0,T.default)(a);(0,_.default)(n,t,e),r.setState({detail:n})}),200),r.handleOk=(0,f.default)(o.default.mark((function e(){var t,a,n,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=(0,O.default)(r.state.detail,["name","aliasName","abstraction","description","appHome","categoryName","readme","icon"]),(null===(t=r.state.detail)||void 0===t?void 0:t.attachments)&&(a.attachments=((null===(n=r.state.detail)||void 0===n?void 0:n.attachments)||[]).map((function(e){return(0,R.default)(e)[0]}))),(l=r.formRef.current)&&l.validate((function(){var e,t=null===(e=r.props.detail.attachments)||void 0===e?void 0:e.filter((function(e){var t;return!(null===(t=a.attachments)||void 0===t?void 0:t.includes(e))}));(null==t?void 0:t.length)&&t.map((function(e){var t;return r.store.deleteImage({id:e,workspace:null===(t=r.state.detail)||void 0===t?void 0:t.workspace})})),r.props.onOk(a)}));case 4:case"end":return e.stop()}}),e)}))),r.onCancel=function(){var e=r.state.oldScreenshots;r.handleAppChange(e,"attachments"),r.props.onCancel()},r.store=r.props.store,r.categoryStore=new A.default,r.fileStore=new w.default,r.formRef=E.default.createRef(),r.state={detail:(0,T.default)((0,g.toJS)(r.props.detail)),oldScreenshots:(0,S.default)(r.props.detail,"attachments")},r}return(0,p.default)(a,[{key:"componentDidMount",value:function(){this.categoryStore.fetchList({noLimit:!0})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.isSubmitting,r=(e.onCancel,(0,u.default)(e,["visible","isSubmitting","onCancel"])),n=(0,g.toJS)((0,S.default)(this.categoryStore,"list.data",[])),o=this.state.detail;return E.default.createElement(k.default,(0,l.default)({},r,{className:L.default.modal,bodyClassName:L.default.body,onOk:this.handleOk,onCancel:this.onCancel,visible:t,isSubmitting:a,fullScreen:!0}),E.default.createElement(D.Columns,{className:"height-full is-gapless"},E.default.createElement(D.Column,{className:"is-narrow"},E.default.createElement(N.default,{store:this.store,formData:o,categories:n,fileStore:this.fileStore,formRef:this.formRef,handleChange:this.handleAppChange})),E.default.createElement(D.Column,null,E.default.createElement(I.default,{handleChange:this.handleAppChange,store:this.store,detail:o,fileStore:this.fileStore}),E.default.createElement(P.default,{handleChange:this.handleAppChange,store:this.store,detail:o}))))}}]),a}(E.Component),s.propTypes={store:y.default.object,detail:y.default.object,visible:y.default.bool,onOk:y.default.func,onCancel:y.default.func},s.defaultProps={store:{},detail:{},visible:!1,onOk:function(){},onCancel:function(){}},c=i))||c;t.default=x},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(911)),l=r(a(1127)),u=r(a(1979)),o=[{title:"BASIC_INFORMATION",icon:"cdn",component:n.default,required:!0},{title:"ROUTING_RULES",icon:"cdn",component:l.default,required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:u.default,required:!0}];t.default=o},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(44),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u,o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=l(r(0)),m=n(r(119)),h=n(r(26)),v=n(r(68)),E=r(17),y=r(243),g=r(189),b=n(r(798)),S=n(r(824)),_=n(r(805)),O=r(56),C=n(r(447)),T=n(r(2228)),R=n(r(2233));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var I=(0,y.observer)(u=function(e){(0,i.default)(r,e);var a=N(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).store=e.props.store,e.secretStore=new C.default,e.state={formTemplate:(0,m.default)(e.props.formTemplate)},e.updateFormTemplate=function(){var t=e.props.detail;if(e.store.list.data.length>0){var a=e.store.list.data.find((function(e){return e.name===t.name}))||e.store.list.data[0],r=(0,E.toJS)(a._originData),n=(0,h.default)(r,"spec.endpoints",[]);n.length>0&&(n.forEach((function(e){e.tlsConfig?e.authType="tlsConfig":e.bearerTokenSecret?e.authType="bearerTokenSecret":e.basicAuth?e.authType="basicAuth":e.authType=""})),r.spec.interval=(0,h.default)(n,"[0].interval"),r.spec.scrapeTimeout=(0,h.default)(n,"[0].scrapeTimeout")),e.setState({formTemplate:r})}},e.handleOk=function(t){var a=e.props,r=a.onOk,n=a.detail,l=(0,h.default)(t,"spec.interval"),u=(0,h.default)(t,"spec.scrapeTimeout");(0,h.default)(t,"spec.endpoints",[]).forEach((function(e){e.interval=l,e.scrapeTimeout=u})),(0,v.default)(t,"spec.selector.matchLabels",n.labels),(0,v.default)(t,"metadata.labels",k(k({},n.labels||{}),{},{"app.kubernetes.io/vendor":"kubesphere"})),r(t)},e.checkItemValid=function(e){return e.port&&e.path&&e.scheme},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.cluster,r=t.namespace,n=t.detail;this.store.fetchListByK8s({cluster:a,namespace:r,labelSelector:(0,O.joinSelector)(n.labels)}).then((function(){return e.updateFormTemplate()})),this.secretStore.fetchListByK8s({cluster:a,namespace:r})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.workspace,n=e.namespace,l=e.cluster,u=e.detail,o=e.isSubmitting,c=e.onCancel,s=this.state.formTemplate;return p.default.createElement(b.default.Form,{icon:"linechart",title:t("EDIT_MONITORING_EXPORTER"),width:960,data:s,visible:a,onOk:this.handleOk,onCancel:c,isSubmitting:o},p.default.createElement("div",{className:R.default.wrapper},p.default.createElement(g.Form.Item,{label:t("PATH_PL")},p.default.createElement(S.default,{className:R.default.endpoints,name:"spec.endpoints",defaultValue:this.defaultEndpoints,checkItemValid:this.checkItemValid,itemType:"object",addText:t("ADD")},p.default.createElement(T.default,{detail:u,secretStore:this.secretStore,cluster:l,namespace:n,workspace:r}))),p.default.createElement("div",{className:R.default.timeout},p.default.createElement(g.Columns,null,p.default.createElement(g.Column,null,p.default.createElement(g.Form.Item,{label:t("COLLECTION_INTERVAL_MIN"),desc:t("COLLECTION_INTERVAL_MIN_DESC")},p.default.createElement(_.default,{name:"spec.interval",defaultValue:"1m",min:0,unit:"m",integer:!0}))),p.default.createElement(g.Column,null,p.default.createElement(g.Form.Item,{label:t("TIMEOUT_PERIOD_S"),desc:t("COLLECTION_TIMEOUT_DESC")},p.default.createElement(_.default,{name:"spec.scrapeTimeout",defaultValue:"10s",min:0,unit:"s",integer:!0})))))))}},{key:"defaultEndpoints",get:function(){return[{scheme:"http",path:"/metrics",authType:""}]}}]),r}(p.Component))||u;a.default=I},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(20),r(14),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(20),r(29),r(14),r(9),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=r(56),m=n(r(2230));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).handleNameChange=function(t){(0,e.props.onChange)({name:t})},e.handleKeyChange=function(t){var a=e.props,r=a.value;(0,a.onChange)({name:r.name,key:t})},e}return(0,u.default)(r,[{key:"getResourceOptions",value:function(){return this.props.secrets.map((function(e){return{label:(0,p.getDisplayName)(e),value:e.name}}))}},{key:"getKeysOptions",value:function(){var e=this.props,t=e.value,a=e.secrets.find((function(e){return e.name===t.name}));return a?Object.keys(a.data||{}).map((function(e){return{label:e,value:e}})):[]}},{key:"render",value:function(){var e=this.props,a=e.name,r=e.value,n=void 0===r?{}:r;return i.default.createElement("div",{className:m.default.wrapper},i.default.createElement(d.Select,{name:"name",key:"".concat(a,".name"),value:n.name,prefixIcon:"".concat(t("SECRET"),": "),options:this.getResourceOptions(),onChange:this.handleNameChange,placeholder:" "}),i.default.createElement(d.Select,{name:"key",key:"".concat(a,".key"),value:n.key,prefixIcon:"".concat(t("KEY"),": "),options:this.getKeysOptions(),onChange:this.handleKeyChange,placeholder:" "}))}}]),r}(i.default.Component);a.default=v,v.propTypes={value:f.default.object,onChange:f.default.func,secrets:f.default.array},v.defaultProps={name:"",value:{},onChange:function(){},secrets:[]}},,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports={wrapper:"_2WM8RaHnX302GtVMQoockj",wrapper_item_com:"KbHgVKqkYN8OupMTkbuFy",columns:"_1yKeq_LeyKarIIzY73TOgp",column:"_1YPZVH0-nIPRRoaimprUFZ",checkbox_item:"_3WSjc9REBmpf1Sx1-QYZ5x",checkbox_item_info:"_3JHpRYGlKl_mW0VdmtimLO",array_checkbox_item:"_25-qgVfpNBo6V8u3KmIz6t",align_center:"_1tpx4OfFomxsv7vQk0ZogN"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.NEW_CLUSTER=t.IMPORT_CLUSTER=void 0;var n=r(a(2340)),l=r(a(2343)),u=r(a(2349)),o=r(a(2351)),c=r(a(2353)),s=r(a(2362)),i=r(a(2365)),f=[{title:"BASIC_INFORMATION",component:l.default,required:!0},{title:"CONNECTION_SETTINGS",component:u.default,required:!0,isForm:!1},{title:"CLUSTER_CONFIG",component:o.default,required:!1,isForm:!1}];t.IMPORT_CLUSTER=f;var d=[{title:"HOW_TO_ADD",component:n.default,required:!0},{title:"BASIC_INFORMATION",component:l.default,required:!0},{title:"CONNECTION_SETTINGS",component:c.default,required:!0},{title:"SYSTEM_COMPONENT_PL",component:i.default,required:!0},{title:"ADVANCED_SETTINGS",component:s.default,required:!0}];t.NEW_CLUSTER=d},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=l(r(119)),p=l(r(26)),m=l(r(5)),h=r(189),v=l(r(798)),E=l(r(805)),y=r(56),g=r(61),b=l(r(1403));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=function(e){(0,c.default)(r,e);var a=S(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={formData:(0,d.default)(e.props.data||{}),authMode:(0,p.default)(e.props.data,"privateKey")?"secret":"password"},e.handleAuthModeChange=function(t){e.setState({authMode:t})},e}return(0,o.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible!==e.visible&&this.setState({formData:(0,d.default)(this.props.data||{})})}},{key:"renderAuthentication",value:function(){return"password"===this.state.authMode?f.default.createElement(f.default.Fragment,null,f.default.createElement(h.Form.Item,{label:t("USERNAME"),desc:t("NODE_USERNAME_DESC")},f.default.createElement(h.Input,{name:"user",defaultValue:"root",autoComplete:"off"})),f.default.createElement(h.Form.Item,{label:t("PASSWORD"),desc:t("NODE_PASSWORD_DESC")},f.default.createElement(h.InputPassword,{name:"password",autoComplete:"off"}))):f.default.createElement(f.default.Fragment,null,f.default.createElement(h.Form.Item,{label:t("SSH_KEY_TCAP")},f.default.createElement(h.TextArea,{name:"privateKey",autoResize:!0})))}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onOk,n=e.onCancel,l=e.addAfterCreate,u=this.state,o=u.authMode,c=u.formData,s=l?["worker"]:void 0;return f.default.createElement(v.default.Form,{icon:"add",title:t("ADD_NODE"),width:600,data:c,visible:a,onOk:r,onCancel:n},f.default.createElement(h.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("NODE_NAME_EMPTY_DESC")}]},f.default.createElement(h.Input,{name:"name",defaultValue:"node-".concat((0,y.generateId)(4))})),f.default.createElement(h.Form.Item,{label:t("ROLE"),desc:t("NODE_ROLE_DESC"),rules:[{required:!0,message:t("NODE_ROLE_EMPTY_DESC")}]},f.default.createElement(h.Select,{name:"roles",options:this.nodeRoles,closeOnSelect:!1,defaultValue:s,multi:!0})),f.default.createElement(h.Form.Item,{label:t("INTERNAL_IP_ADDRESS"),desc:t("NODE_INTERNAL_IP_DESC"),rules:[{required:!0,message:t("NODE_INTERNAL_IP_EMPTY_DESC")},{pattern:g.PATTERN_IP,message:t("INVALID_IP_DESC")}]},f.default.createElement(h.Input,{name:"internalAddress",placeholder:"0.0.0.0",autoComplete:"off"})),f.default.createElement(h.Columns,{className:(0,m.default)("is-1",b.default.ssh)},f.default.createElement(h.Column,null,f.default.createElement(h.Form.Item,{label:t("EXTERNAL_IP"),desc:t("NODE_EXTERNAL_IP_DESC"),rules:[{required:!0,message:t("NODE_EXTERNAL_IP_EMPTY_DESC")},{pattern:g.PATTERN_IP,message:t("INVALID_IP_DESC")}]},f.default.createElement(h.Input,{name:"address",placeholder:"0.0.0.0",autoComplete:"off"}))),f.default.createElement(h.Column,{className:"is-narrow"},f.default.createElement(h.Form.Item,{className:b.default.port,label:t("PORT")},f.default.createElement(E.default,{name:"port",defaultValue:22,max:65535,min:0,integer:!0})))),f.default.createElement(h.Form.Item,{label:t("SSH_AUTH_MODE"),desc:t("SSH_AUTH_MODE_DESC")},f.default.createElement(h.Select,{value:o,options:this.authModes,onChange:this.handleAuthModeChange})),this.renderAuthentication())}},{key:"authModes",get:function(){return[{label:t("USERNAME_AND_PASSWORD"),value:"password"},{label:t("SSH_KEY_SCAP"),value:"secret"}]}},{key:"nodeRoles",get:function(){return this.props.addAfterCreate?[{label:t("WORKER"),value:"worker"}]:[{label:t("CONTROL_PLANE"),value:"master"},{label:t("WORKER"),value:"worker"}]}}]),r}(f.Component);a.default=_},function(e,t,a){e.exports={wrapper:"_2Lqd91xpnojlUPUV9ctSeb",limits:"PSykLg06vAq1JTXkFmeFG",limit:"_2Lz4hSqqVH5vHSuGLXd3d1",ssh:"_1UBN3MNiZ33uaQH0qUUoY-",port:"_1Kt3RHCGg3eTgBC56yJKrH"}},function(e,t,a){e.exports={tagAddTitle:"_2AoqIskVk90cT_-DU6idIj",tagItem:"_1w1aaZzYfSihEk_pyyFs8b",tagItemUpdate:"_3oQ1Q0ko0NvYhoh4Vb_x06",alert:"_2hRtVfJZtkM36YkFqUhBKR"}},function(e,t,a){e.exports={wrapper:"_1mXUGC3QLcMvh_WRGOMWlG",item:"_1mI0Vx1Zbj3RQs1NbfwfQs",delete:"_2vE10WwlHhPJrj7Mvxh3dh",add:"_2HBElUzvwbSytJoKWc8k1a",desc:"_3MWZHeTqugN1hKIYTD6XOM"}},function(e,t,a){e.exports={wrapper:"_2CAwl5k2oIda9YcGXDwM47",empty:"_3C9m_Ocvi6i3FCZFQiyvBo",formWrapper:"_1jC1_JGlPNjzoMoHEuIG7b",contentWrapper:"_3JvS-OEcBUyHzzrjUgyD7y",repoTypes:"_33Emj6yHpbs8UNlQpSvS1c",selectType:"_2LA7h2xfYPhnWXS4cXQMv8",gitIcon:"_1rzx7uWPAi4m6DkTVIZE42",light:"_2PM3xrM_mfV8Y7SzcKac3z",dark:"_2Cs9GTPWGQkHlPwuBJL_zq",branch:"_2i7wzfSnXXny7hXWwWF_VU",action:"_1q1nBwyG-e01cNjPngSVyL",icon:"G4yuPTBjFVlQK_43eBXWg",info:"_1IE8Wqz9EbuS8uyK2uvvW2",name:"_2s59L_OotKhaMchVqNIcPK",desc:"_2_Av3lQmokJgJ9tWlA3Vbz",branch__show:"_1X_Zvts1SpLSCmF6cm-nQ7",deleteRepoBtn:"_1ACD7-Hng8w7KKOYn0JT7H",disabled:"_3YX-W9JYPf64LAZKgJRIYs"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(79),r(817),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(79),r(817),r(7);var l=n(r(38));r(35);var u,o,c,s,i,f,d,p=n(r(39)),m=n(r(31)),h=n(r(62)),v=n(r(25)),E=n(r(28)),y=n(r(74)),g=n(r(41)),b=n(r(42)),S=n(r(37)),_=n(r(45)),O=(n(r(63)),n(r(0))),C=n(r(1)),T=n(r(5)),R=r(17),D=r(243),k=n(r(26)),N=n(r(201)),I=n(r(67)),P=n(r(457)),A=n(r(68)),w=r(189),L=n(r(1408)),M=r(61),x=r(848),j=n(r(1058)),U=n(r(2399)),F=n(r(1409)),V=n(r(2402)),G=n(r(2404)),B=n(r(1406)),z=n(r(2406)),Y=r(56);function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){(0,m.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,S.default)(e);if(t){var n=(0,S.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,b.default)(this,a)}}var W=(0,D.observer)((d=f=function(e){(0,g.default)(r,e);var a=K(r);function r(e){var t;return(0,v.default)(this,r),t=a.call(this,e),(0,h.default)(t,"source_type",c,(0,y.default)(t)),(0,h.default)(t,"credentialFormData",s,(0,y.default)(t)),(0,h.default)(t,"showCredential",i,(0,y.default)(t)),t.restoreSourceData=function(){var e=t.props.sourceData,a=e.source_type;t.store.formData=(0,m.default)({},M.REPO_KEY_MAP[a],(0,P.default)(e[M.REPO_KEY_MAP[a]],(function(e,t){return t&&t.startsWith("discover")&&(0,I.default)(e)}))),(0,N.default)(e,"credentialId")&&("github"===a&&(t.store.tokenFormData={credentialId:e.credentialId}),"git"===a&&(0,A.default)(t.store.formData,"".concat(M.REPO_KEY_MAP[a],".credential_id"),e.credentialId),"gitlab"===a&&(0,A.default)(t.store.formData,"".concat(M.REPO_KEY_MAP[a]),{})),"single_svn"===a&&(t.store.formData={svn_source:q({type:"single_svn"},t.store.formData.single_svn_source)})},t.setCredentialsFormData=function(e){(0,N.default)(e,"type")&&(t.credentialFormData=q({},e))},t.showCreateCredential=function(){t.showCredential=!0},t.hideCreateCredential=(0,p.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showCredential=!1;case 1:case"end":return e.stop()}}),e)}))),t.handleCreateCredential=function(){var e=(0,p.default)(l.default.mark((function e(a,r){var n,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,u=n.devops,o=n.cluster,e.next=3,t.store.createCredential(a,{devops:u,cluster:o});case 3:return e.next=5,t.store.getCredentials({devops:u,cluster:o});case 5:r(),t.hideCreateCredential();case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),t.handleGoBack=function(){var e=t.context.resetSubRoute;e&&e(),t.props.onCancel()},t.handleSubmit=function(e){var a=t.props.onSave,r=t.context.resetSubRoute,n=t.store.formData;if(["github","bitbucket_server"].includes(t.source_type)){if((0,I.default)(e))return;return a(t.source_type,e),void(r&&r())}t.formRef.current&&t.formRef.current.validate((function(){if("git"===t.source_type&&a("git",{git_source:q(q({},n.git_source),{},{discover_branches:!0})}),"gitlab"===t.source_type&&a("gitlab",{gitlab_source:q(q({},n.gitlab_source),{},{discover_branches:1,discover_pr_from_forks:{strategy:2,trust:2},discover_pr_from_origin:2,discover_tags:!0})}),["svn","single_svn"].includes(t.source_type)){var e=(0,k.default)(n,"svn_source.type","svn");a(e,(0,m.default)({},M.REPO_KEY_MAP[e],q(q({},n.svn_source),{},{remote:(0,k.default)(n,"svn_source.remote","").trim()})))}r&&r()}))},t.handleTypeChange=function(e){var a=t.props.sourceData,r=e.currentTarget.dataset.type;t.source_type=r,t.credentialFormData={type:"username_password"},t.store.resetStore(),(0,I.default)(a)||a.source_type!==r||t.restoreSourceData()},t.formRef=O.default.createRef(),t.tokenFormRef=O.default.createRef(),t.store=new L.default,t}return(0,E.default)(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.onCancel,a=e.devops,r=e.name,n=e.cluster,l=this.context.registerSubRoute,u=this.props.sourceData;l&&l(this.handleSubmit,t),this.store.getCredentials({devops:a,cluster:n}),this.store.name=r,(0,I.default)(u)||(this.source_type=u.source_type,this.restoreSourceData())}},{key:"renderTypes",value:function(){var e=this,t=this.props,a=t.enableTypeChange,r=t.cluster,n=t.noSVN,l="single_svn"===this.source_type?"svn":this.source_type,u=globals.app.isMultiCluster?(0,k.default)(globals,"clusterConfig.".concat(r,".ksVersion")):(0,k.default)(globals,"ksConfig.ksVersion"),o=(0,Y.compareVersion)(u,"3.1.0");return O.default.createElement("ul",{className:B.default.repoTypes},M.REPO_TYPES.map((function(t){var r;return!(o<0&&"gitlab"===t.value)&&((!n||"svn"!==t.value)&&O.default.createElement("li",{className:(0,T.default)((r={},(0,m.default)(r,B.default.selectType,t.value===l),(0,m.default)(r,B.default.disabled,!a&&l!==t.value),r)),key:t.value,"data-type":t.value,onClick:e.handleTypeChange},O.default.createElement(w.Icon,{name:t.icon,type:t.value===l?"light":"dark",size:32}),O.default.createElement("span",null,t.name)))})))}},{key:"renderForm",value:function(){var e=this.props,t=e.devops,a=e.enableTypeChange,r=e.cluster,n=e.noJenkins,l=void 0!==n&&n;return"github"===this.source_type?O.default.createElement(F.default,{store:this.store,formRef:this.formRef,handleSubmit:this.handleSubmit,showCredential:this.showCreateCredential,setCredentialsFormData:this.setCredentialsFormData,cluster:r,devops:t}):["svn","single_svn"].includes(this.source_type)?O.default.createElement(V.default,{store:this.store,formRef:this.formRef,handleSubmit:this.handleSubmit,devops:t,showCredential:this.showCreateCredential,enableTypeChange:a,cluster:r}):"bitbucket_server"===this.source_type?O.default.createElement(G.default,{store:this.store,formRef:this.formRef,showCredential:this.showCreateCredential,handleSubmit:this.handleSubmit,cluster:r,devops:t}):"gitlab"===this.source_type?O.default.createElement(z.default,{store:this.store,formRef:this.formRef,handleSubmit:this.handleSubmit,cluster:r,devops:t,showCredential:this.showCreateCredential}):O.default.createElement(U.default,{store:this.store,formRef:this.formRef,handleSubmit:this.handleSubmit,devops:t,cluster:r,showCredential:this.showCreateCredential,noJenkins:l})}},{key:"render",value:function(){var e=this.props,a=e.devops,r=e.cluster,n=e.type;return O.default.createElement("div",{className:B.default.formWrapper},"import"!==n?O.default.createElement("div",{className:"h4"},O.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},O.default.createElement(x.ReactComponent,null)),t("SELECT_CODE_REPOSITORY")):null,O.default.createElement("div",{className:B.default.contentWrapper},this.renderTypes(),this.renderForm()),O.default.createElement(j.default,{visible:this.showCredential,onOk:this.handleCreateCredential,onCancel:this.hideCreateCredential,devops:a,cluster:r,formTemplate:(0,R.toJS)(this.credentialFormData),sourceType:this.source_type}))}}]),r}(O.default.Component),f.propTypes={onSave:C.default.func,onCancel:C.default.func,sourceData:C.default.object,enableTypeChange:C.default.bool},f.defaultProps={onSave:function(){},onCancel:function(){},sourceData:{},enableTypeChange:!0},f.contextTypes={registerSubRoute:C.default.func,resetSubRoute:C.default.func},o=d,c=(0,_.default)(o.prototype,"source_type",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"github"}}),s=(0,_.default)(o.prototype,"credentialFormData",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{type:"username_password"}}}),i=(0,_.default)(o.prototype,"showCredential",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=o))||u;a.default=W},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(87),r(14),r(8),r(13),r(9),r(4),r(21),r(18),r(30),r(11),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(87),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(195),r(11),r(7);var l=n(r(58)),u=n(r(31)),o=n(r(50)),c=n(r(38));r(35);var s,i,f,d,p,m,h,v,E,y,g,b,S,_,O,C,T=n(r(39)),R=n(r(62)),D=n(r(25)),k=n(r(28)),N=n(r(74)),I=n(r(41)),P=n(r(42)),A=n(r(37)),w=n(r(45)),L=(n(r(63)),r(17)),M=n(r(64)),x=n(r(67)),j=n(r(26)),U=r(56),F=n(r(248)),V=n(r(330)),G=n(r(1164));function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,A.default)(e);if(t){var n=(0,A.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,P.default)(this,a)}}var H=(s=function(e){(0,I.default)(P,e);var a,r,n,u,s=Y(P);function P(e){var a;return(0,D.default)(this,P),a=s.call(this,e),(0,R.default)(a,"isAccessTokenWrong",i,(0,N.default)(a)),(0,R.default)(a,"credentials",f,(0,N.default)(a)),(0,R.default)(a,"orgList",d,(0,N.default)(a)),(0,R.default)(a,"repoList",p,(0,N.default)(a)),(0,R.default)(a,"activeRepoIndex",m,(0,N.default)(a)),(0,R.default)(a,"formData",h,(0,N.default)(a)),(0,R.default)(a,"creatBitBucketServersError",v,(0,N.default)(a)),(0,R.default)(a,"orgParams",E,(0,N.default)(a)),a.getClusterVersion=function(e){return a.isMultiCluster?(0,j.default)(window,"parent.globals.clusterConfig.".concat(e,".ksVersion")):(0,j.default)(window,"parent.globals.ksConfig.ksVersion")},a.isNeedUpdate=function(e){return(0,U.compareVersion)(a.getClusterVersion(e),"3.3.0")<0},(0,R.default)(a,"getCredentials",y,(0,N.default)(a)),a.getCredentialDetail=function(){var e=(0,T.default)(c.default.mark((function e(t){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.credentialStore.fetchDetail(t);case 2:return e.abrupt("return",a.credentialStore.detail);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.createCredential=function(){var e=(0,T.default)(c.default.mark((function e(t,r){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.credentialStore.handleCreate(t,r);case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),(0,R.default)(a,"creatBitBucketServers",g,(0,N.default)(a)),(0,R.default)(a,"clearBitbucketErrors",b,(0,N.default)(a)),a.getBitbucketList=function(){var e=(0,T.default)(c.default.mark((function e(t){var r,n,l;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.cluster,e.next=3,request.get("".concat(a.getDevopsUrlV2({cluster:r}),"scms/bitbucket-server/servers"));case 3:return n=e.sent,l=[],l=!(0,x.default)(n)&&(0,M.default)(n)?n.map((function(e){return{label:e.apiUrl,value:e.apiUrl}})):[{label:"https://bitbucket.org",value:"https://bitbucket.org"}],e.abrupt("return",l);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(0,R.default)(a,"resetStore",S,(0,N.default)(a)),(0,R.default)(a,"checkCronScript",_,(0,N.default)(a)),(0,R.default)(a,"fetchGitLabServerList",O,(0,N.default)(a)),(0,R.default)(a,"fetchGitLabProjectList",C,(0,N.default)(a)),a.credentialStore=new G.default,a.verifyAccessErrorHandle={github:function(e,t){var r=t.headers?e:t;return 428===t.code?(a.isAccessTokenWrong=!0,void(a.orgList.isLoading=!1)):(window.onunhandledrejection&&window.onunhandledrejection(r),Promise.reject(r))},"bitbucket-server":function(e,r){var n=r.headers?e:r;if(428!==n.code){if(!(0,M.default)(n.errors)||(0,x.default)(n.errors))return a.creatBitBucketServersError={all:n.message},window.onunhandledrejection&&window.onunhandledrejection(n),Promise.reject(n);a.creatBitBucketServersError=n.errors.reduce((function(e,t){return e[t.field]={message:t.message},e}),{})}else a.creatBitBucketServersError={password:{message:t("INCORRECT_USERNAME_OR_PASSWORD")}}}},a}return(0,k.default)(P,[{key:"getOrganizationList",value:(u=(0,T.default)(c.default.mark((function e(t,a,r){var n,u,s,i,f,d,p,m,h,v,E;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageNumber,u=void 0===n?1:n,s=t.pageSize,i=void 0===s?100:s,f=t.more,d=void 0!==f&&f,p=t.credentialId,m=(0,o.default)(t,["pageNumber","pageSize","more","credentialId"]),this.orgList.isLoading=!0,this.scmType=a,this.orgParams=m,h="".concat(this.getDevopsUrlV3({cluster:r}),"scms/").concat(a||"github","/organizations?").concat((0,U.getQueryString)(z({pageNumber:u,pageSize:i},m),!1)),v="".concat(this.getDevopsUrlV2({cluster:r}),"scms/").concat(a||"github","/organizations/?").concat((0,U.getQueryString)(z(z({},m),{},{credentialId:p}),!1)),e.next=8,request.get(this.isNeedUpdate(r)?v:h).catch((function(){return[]}));case 8:return E=e.sent,(0,M.default)(E)&&(this.orgList.data=d?[].concat((0,l.default)(this.orgList.data),(0,l.default)(E)):E),this.orgList.isLoading=!1,this.orgList.isEnd=E.length<i,this.orgList.pagination={pageSize:i,pageNumber:u},e.abrupt("return",this.orgList);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return u.apply(this,arguments)})},{key:"handleChangeActiveRepoIndex",value:function(e){this.activeRepoIndex=e}},{key:"handleChangeAccessTokenWrong",value:function(){this.isAccessTokenWrong=!1}},{key:"getRepoList",value:(n=(0,T.default)(c.default.mark((function e(t){var a,r,n,u,o,s,i,f,d,p,m,h,v,E=this;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.cluster,r=t.activeRepoIndex,n=t.pageNumber,u=void 0===n?1:n,o=t.pageSize,s=void 0===o?100:o,i=t.more,f=void 0!==i&&i,d=void 0!==r?r:""===this.activeRepoIndex?0:this.activeRepoIndex,p=this.scmType||"github",m=this.isNeedUpdate(a)&&"bitbucket-server"===p?this.orgList.data[d].key:this.orgList.data[d].name,this.repoList.isLoading=!0,h="".concat(this.isNeedUpdate(a)?this.getDevopsUrlV2({cluster:a}):this.getDevopsUrlV3({cluster:a}),"scms/").concat(p,"/organizations/").concat(m,"/repositories?").concat((0,U.getQueryString)(z(z({},this.orgParams),{},{pageNumber:u,pageSize:s}),!1)),e.next=8,request.get(h,{},null,(function(e,t){return E.repoList.isLoading=!1,E.repoList.data=[],window.onunhandledrejection&&window.onunhandledrejection(t),Promise.reject(t)}));case 8:return(v=e.sent).repositories&&((0,M.default)((0,L.toJS)(this.repoList.data))?(this.repoList.data=f?[].concat((0,l.default)(this.repoList.data),(0,l.default)(v.repositories.items)):(0,l.default)(v.repositories.items),this.repoList.isEnd=v.repositories.items.length<s,this.repoList.pagination={pageSize:s,pageNumber:u}):this.repoList.data=v.repositories),this.repoList.isLoading=!1,e.abrupt("return",this.repoList);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"putAccessName",value:(r=(0,T.default)(c.default.mark((function e(t){var a,r,n,l,u;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.secretName,r=t.secretNamespace,n=t.cluster,l=t.token,this.isAccessTokenWrong=!1,e.next=4,this.verifySecretForRepo({secret:a,secretNamespace:r},{scmType:"github",cluster:n,accessToken:l});case 4:if(!(u=e.sent)||!u.credentialId){e.next=8;break}return e.next=8,this.getOrganizationList({secret:a,secretNamespace:r,includeUser:!0,credentialId:u.credentialId},"github",n);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"verifySecretForRepo",value:(a=(0,T.default)(c.default.mark((function e(t,a){var r,n,l,u,s,i,f;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.scmType,n=a.cluster,a.devops,l=a.accessToken,u=(0,o.default)(a,["scmType","cluster","devops","accessToken"]),s=r,/https:\/\/bitbucket.org\/?/gm.test("".concat(u.apiUrl))&&(s="bitbucket_cloud"),i="".concat(this.getDevopsUrlV2({cluster:n}),"scms/").concat(s,"/verify/"),f="".concat(this.getDevopsUrlV3({cluster:n}),"scms/").concat(s,"/verify?").concat((0,U.getQueryString)(t,!1)),e.next=7,request.post(this.isNeedUpdate(n)?i:f,this.isNeedUpdate(n)?z(z({},u),{},{accessToken:l}):u,null,this.verifyAccessErrorHandle[r]);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"isMultiCluster",get:function(){var e;return null===(e=window.parent)||void 0===e?void 0:e.globals.ksConfig.multicluster}}]),P}(V.default),i=(0,w.default)(s.prototype,"isAccessTokenWrong",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=(0,w.default)(s.prototype,"credentials",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{isLoading:!1,data:[]}}}),d=(0,w.default)(s.prototype,"orgList",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{isLoading:!1,data:[],isEnd:!1,pagination:{pageNumber:1,pageSize:100}}}}),p=(0,w.default)(s.prototype,"repoList",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{isLoading:!1,data:[],isEnd:!1,pagination:{pageNumber:1,pageSize:100}}}}),m=(0,w.default)(s.prototype,"activeRepoIndex",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),h=(0,w.default)(s.prototype,"formData",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),v=(0,w.default)(s.prototype,"creatBitBucketServersError",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),E=(0,w.default)(s.prototype,"orgParams",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),(0,w.default)(s.prototype,"getOrganizationList",[L.action],Object.getOwnPropertyDescriptor(s.prototype,"getOrganizationList"),s.prototype),(0,w.default)(s.prototype,"handleChangeActiveRepoIndex",[L.action],Object.getOwnPropertyDescriptor(s.prototype,"handleChangeActiveRepoIndex"),s.prototype),(0,w.default)(s.prototype,"handleChangeAccessTokenWrong",[L.action],Object.getOwnPropertyDescriptor(s.prototype,"handleChangeAccessTokenWrong"),s.prototype),(0,w.default)(s.prototype,"getRepoList",[L.action],Object.getOwnPropertyDescriptor(s.prototype,"getRepoList"),s.prototype),y=(0,w.default)(s.prototype,"getCredentials",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,T.default)(c.default.mark((function t(a){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.credentials.loading=!0,t.next=3,e.credentialStore.fetchList(z({},a));case 3:e.credentials=e.credentialStore.list,e.credentials.loading=!1;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),g=(0,w.default)(s.prototype,"creatBitBucketServers",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var a=(0,T.default)(c.default.mark((function a(r){var n,l,u,o,s,i,f,d,p;return c.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=r.apiUrl,l=r.cluster,u=r.secretName,o=r.secretNamespace,s=r.username,i=r.password,e.creatBitBucketServersError={},e.tokenFormData={username:s,password:i,apiUrl:n,credentialId:u},!(0,x.default)((0,U.parseUrl)(n))){a.next=6;break}return e.creatBitBucketServersError={apiUrl:{message:(0,x.default)(n)?t("BITBUCKET_ADDRESS_EMPTY_TIP"):t("BITBUCKET_ADDRESS_INVALID_TIP")}},a.abrupt("return");case 6:if(!e.isNeedUpdate(l)){a.next=20;break}if(f={id:(0,U.generateId)(4)},/https:\/\/bitbucket.org\/?/gm.test("".concat(n))){a.next=12;break}return a.next=11,request.post("".concat(e.getDevopsUrlV2({cluster:l}),"scms/bitbucket-server/servers"),{apiUrl:n,name:u},null,e.verifyAccessErrorHandle["bitbucket-server"]);case 11:f=a.sent;case 12:if(f&&f.id){a.next=14;break}return a.abrupt("return");case 14:return a.next=16,e.verifySecretForRepo({},{apiUrl:n,scmType:"bitbucket-server",cluster:l,userName:s,password:i});case 16:(d=a.sent)&&d.credentialId&&(e.orgList.isLoading=!1,e.getOrganizationList({credentialId:d.credentialId,apiUrl:n},d.credentialId,l)),a.next=30;break;case 20:return a.next=22,e.verifySecretForRepo({secret:u,secretNamespace:o,server:n},{scmType:"bitbucket-server",cluster:l,apiUrl:n});case 22:if(!(p=a.sent)||0!==p.code){a.next=29;break}return e.orgList.isLoading=!1,a.next=27,e.getOrganizationList({secret:u,secretNamespace:o,server:n},"bitbucket-server",l);case 27:a.next=30;break;case 29:p&&0!==p.code&&(e.creatBitBucketServersError={apiUrl:{message:p.message}});case 30:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}}),b=(0,w.default)(s.prototype,"clearBitbucketErrors",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.creatBitBucketServersError={}}}}),S=(0,w.default)(s.prototype,"resetStore",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.orgList={isLoading:!1,data:[]},e.activeRepoIndex="",e.isAccessTokenWrong=!1,e.formData={},e.tokenFormData={},e.creatBitBucketServersError={}}}}),_=(0,w.default)(s.prototype,"checkCronScript",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.devops,r=t.script,n=t.pipeline,l=t.cluster;return request.post("".concat(e.getDevopsUrlV2({cluster:l,devops:a}),"checkCron"),{cron:r,name:n})}}}),O=(0,w.default)(s.prototype,"fetchGitLabServerList",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,T.default)(c.default.mark((function t(a){var r,n,l,u,o;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,n=a.devops,l="".concat(e.getDevopsUrlV2({cluster:r,devops:n}),"jenkins/gitlab/serverList"),t.next=4,request.post(l,{},{},(function(){return[]}));case 4:return u=t.sent,o=[],"ok"===u.status&&(0,M.default)(u.data)&&(o=u.data.map((function(e){return{label:e.name,value:e.name}}))),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),C=(0,w.default)(s.prototype,"fetchGitLabProjectList",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,T.default)(c.default.mark((function t(a){var r,n,l,u,o,s,i;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.cluster,n=a.devops,l=a.server,u=a.owner,o="".concat(e.getDevopsUrlV2({cluster:r,devops:n}),"jenkins/gitlab/projectList"),o+="?".concat(F.default.stringify({server:l,owner:u})),t.next=5,request.post(o,{},{},(function(){return[]}));case 5:return s=t.sent,i=[],"ok"===s.status&&(0,M.default)(s.data)&&(i=s.data.map((function(e){return{label:e,value:e.split("/").pop()}}))),t.abrupt("return",i);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),s);a.default=H},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(44),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(200),r(18),r(30),r(11),r(73),r(197),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(321),r(21),r(200),r(18),r(43),r(30),r(11),r(73),r(197),r(7);var l=n(r(58)),u=n(r(38));r(35);var o,c,s,i,f,d=n(r(39)),p=n(r(31)),m=n(r(62)),h=n(r(25)),v=n(r(28)),E=n(r(74)),y=n(r(41)),g=n(r(42)),b=n(r(37)),S=n(r(45)),_=(n(r(63)),n(r(0))),O=n(r(5)),C=r(17),T=r(243),R=n(r(26)),D=n(r(67)),k=n(r(244)),N=n(r(889)),I=r(324),P=r(189),A=r(61),w=n(r(844)),L=n(r(2401));function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,b.default)(e);if(t){var n=(0,b.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,g.default)(this,a)}}var U=(0,T.observer)((c=function(e){(0,y.default)(r,e);var a=j(r);function r(){var e;(0,h.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).tokenFormRef=_.default.createRef(),e.state={isLoading:!1,searchValue:""},(0,m.default)(e,"repoListData",s,(0,E.default)(e)),e.handleFormChange=function(){e.props.store.isAccessTokenWrong&&e.props.store.handleChangeAccessTokenWrong()},(0,m.default)(e,"handleActiveOrgChange",i,(0,E.default)(e)),e.handleSubmit=function(t){var a=(0,p.default)({},A.REPO_KEY_MAP[e.scmType],{repo:(0,R.default)(e.repoListData,"".concat(t,".name")),credential_id:e.credentialId,owner:(0,R.default)((0,C.toJS)(e.orgList),"data[".concat(e.activeRepoIndex,"].name")),discover_branches:1,discover_pr_from_forks:{strategy:2,trust:2},discover_pr_from_origin:2,discover_tags:!0,description:(0,R.default)(e.repoListData,"".concat(t,".description"))});e.props.handleSubmit(a)},(0,m.default)(e,"handlePasswordConfirm",f,(0,E.default)(e)),e.getCredentialsListData=function(t){var a=e.props,r=a.devops,n=a.cluster;return e.props.store.getCredentials(x({devops:r,cluster:n},t))},e.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return _.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",_.default.createElement(P.Tag,{type:n?"":"warning"},r&&t("CREDENTIAL_TYPE_".concat(r.toUpperCase()))))},e.handleUpdateOrgList=function(){var t=(0,d.default)(u.default.mark((function t(a){var r,n,l;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=e.orgList.pagination,t.next=3,e.props.store.getOrganizationList(x({pageNumber:null!==(r=null==a?void 0:a.page)&&void 0!==r?r:1,pageSize:l.pageSize,more:null!==(n=null==a?void 0:a.more)&&void 0!==n&&n},e.props.store.orgParams),e.scmType,e.props.cluster);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleUpdateRepoList=function(){var t=(0,d.default)(u.default.mark((function t(a){var r,n,o,c;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.repoList.pagination,t.next=3,e.props.store.getRepoList({activeRepoIndex:e.activeRepoIndex,cluster:e.props.cluster,pageNumber:null!==(r=null==a?void 0:a.page)&&void 0!==r?r:1,pageSize:o.pageSize,more:null!==(n=null==a?void 0:a.more)&&void 0!==n&&n});case 3:c=t.sent,e.repoListData=(0,l.default)(c.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.renderSearch=function(){return _.default.createElement("div",{className:L.default.search},_.default.createElement(P.InputSearch,{value:e.state.searchValue,onSearch:e.filterResource,placeholder:t("SEARCH_BY_NAME")}))},e.filterResource=function(t){(0,D.default)(t)?e.repoListData=(0,l.default)(e.repoList.data):e.repoListData=e.repoList.data.filter((function(e){return e.name.includes(t)})),e.setState({searchValue:t})},e.renderEmpty=function(a){return _.default.createElement("div",{className:L.default.tabContent},a.isLoading?_.default.createElement(P.Loading,null,_.default.createElement("div",{className:L.default.orgList})):_.default.createElement("div",{className:L.default.orgList},e.renderAccessTokenForm()),_.default.createElement("div",{className:L.default.emptyRepoList},_.default.createElement("div",{className:L.default.placeHolder},_.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/empty-card.svg",alt:""}),_.default.createElement("p",{className:L.default.title},t("".concat(e.scmType.toUpperCase(),"_CREDENTIAL_EMPTY"))))))},e}return(0,v.default)(r,[{key:"renderAccessTokenForm",value:function(){var e=this,a=this.props.store,r=a.tokenFormData,n=a.credentials,l=a.isAccessTokenWrong;return _.default.createElement("div",{className:L.default.card},_.default.createElement(P.Form,{data:r,onSubmit:this.handlePasswordConfirm,onChange:this.handleFormChange,ref:this.tokenFormRef},_.default.createElement(P.Form.Item,{label:t("CREDENTIAL"),rules:[{required:!0,message:t("PIPELINE_CREDENTIAL_EMPTY_TIP")}],error:l?{message:{message:t.html("INCORRECT_GITHUB_TOKEN_DESC")}}:void 0,desc:_.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),_.default.createElement("span",{className:L.default.clickable,onClick:function(){e.props.showCredential(),e.props.setCredentialsFormData({type:"username_password",data:{username:"admin"}})}},t("CREATE_CREDENTIAL")))},_.default.createElement(P.Select,{name:"credentialId",options:this.credentialsList,pagination:(0,k.default)(n,["page","limit","total"]),isLoading:n.isLoading,onFetch:this.getCredentialsListData,optionRenderer:this.optionRender,valueRenderer:this.optionRender,placeholder:" ",searchable:!0,clearable:!0,onChange:function(t){e.props.store.tokenFormData={credentialId:t}}})),_.default.createElement(P.Button,{className:L.default.confirmButton,loading:this.state.isLoading,onClick:this.handlePasswordConfirm},t("OK"))))}},{key:"renderOrgList",value:function(){var e=this,t=this.orgList,a=t.data,r=t.isEnd,n=t.pagination,l=void 0===n?{}:n,u=t.isLoading;return _.default.createElement(N.default,{data:(0,C.toJS)(a),isEnd:r,page:l.pageNumber||1,loading:u,onFetch:this.handleUpdateOrgList,noMount:!0},!(0,D.default)(a)&&a.map((function(t,a){return _.default.createElement("div",{key:t.name,className:(0,O.default)(L.default.repo,(0,p.default)({},L.default["repo-active"],e.activeRepoIndex===a)),onClick:function(){return e.handleActiveOrgChange(a)}},_.default.createElement("div",{className:L.default.avatar},_.default.createElement("img",{src:t.avatar,alt:t.name})),_.default.createElement("div",{className:L.default.name},t.name))})))}},{key:"renderRepoList",value:function(){var e=this,a=this.repoList,r=a.isEnd,n=a.pagination,l=void 0===n?{}:n,u=a.isLoading;return(0,D.default)(this.repoListData)?_.default.createElement(P.Loading,{spinning:u},_.default.createElement(w.default,{className:L.default.empty,icon:"exclamation",title:t("NO_DATA"),desc:t("NO_REPO_FOUND_DESC")})):_.default.createElement(N.default,{data:(0,C.toJS)(this.repoListData),isEnd:r,page:l.pageNumber||1,loading:u,onFetch:this.handleUpdateRepoList,wrapperClassName:L.default.repoListBox,noMount:!0},this.repoListData.map((function(a,r){return _.default.createElement("div",{className:L.default.repo,key:"".concat(a.name,"-").concat(r)},_.default.createElement("div",{className:L.default.icon},_.default.createElement(P.Icon,{name:"bitbucket_server"===e.scmType?"bitbucket":e.scmType,size:40})),_.default.createElement("div",{className:L.default.info},_.default.createElement("div",{className:L.default.name},a.name),_.default.createElement("div",{className:L.default.desc},a.description)),_.default.createElement("div",{className:L.default.action,onClick:function(){return e.handleSubmit(r)},"data-repo-index":r},_.default.createElement(P.Button,{type:"control"},t("SELECT"))))})))}},{key:"render",value:function(){return!this.orgList.isLoading&&(0,D.default)((0,C.toJS)(this.orgList.data))?this.renderEmpty(this.orgList.data):_.default.createElement("div",{className:L.default.tabContent},_.default.createElement("div",{className:L.default.orgList},this.renderOrgList()),_.default.createElement("div",{className:L.default.repoListContainer},_.default.createElement(_.default.Fragment,null,this.renderSearch()),_.default.createElement("div",{className:L.default.repoList},this.renderRepoList())))}},{key:"orgList",get:function(){return this.props.store.orgList}},{key:"activeRepoIndex",get:function(){return this.props.store.activeRepoIndex}},{key:"repoList",get:function(){return this.props.store.repoList}},{key:"scmType",get:function(){return"github"}},{key:"credentialsList",get:function(){return(0,l.default)(this.props.store.credentials.data.map((function(e){return{label:e.name,value:e.name,type:e.type,namespace:e.namespace,token:(0,R.default)(e,"_originData.data.password")}})).filter((function(e){return"username_password"===e.type})))}}]),r}(_.default.Component),s=(0,S.default)(c.prototype,"repoListData",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i=(0,S.default)(c.prototype,"handleActiveOrgChange",[C.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,d.default)(u.default.mark((function t(a){var r;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.props.store.handleChangeActiveRepoIndex(parseInt(a,10)),t.next=3,e.props.store.getRepoList({activeRepoIndex:parseInt(a,10),cluster:e.props.cluster,more:!1});case 3:r=t.sent,e.repoListData=(0,l.default)(r.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),f=(0,S.default)(c.prototype,"handlePasswordConfirm",[C.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,d.default)(u.default.mark((function t(){var a,r,n,l,o,c,s,i;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props,r=a.cluster,n=a.devops,l=e.tokenFormRef.current.getData(),e.credentialId=l.credentialId,e.credentialId){t.next=5;break}return t.abrupt("return",!1);case 5:if(e.setState({isLoading:!0}),o=e.credentialsList.find((function(t){return t.value===e.credentialId})),(0,D.default)(o)){t.next=15;break}return c=(0,R.default)(o,"value"),s=(0,R.default)(o,"namespace"),i=(0,I.safeAtob)((0,R.default)(o,"token")),t.next=13,e.props.store.putAccessName({secretName:c,secretNamespace:s,cluster:r,devops:n,token:i}).finally((function(){e.setState({isLoading:!1})}));case 13:t.next=16;break;case 15:e.setState({isLoading:!1});case 16:case"end":return t.stop()}}),t)})))}}),o=c))||o;a.default=U},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=n(r(68)),m=r(61),h=r(189),v=n(r(2411)),E=n(r(2413));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var S=function(e){(0,c.default)(r,e);var a=b(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={state:"",selectDataKey:""},e.handleData=function(t){var a=e.state.selectDataKey,r=(0,d.default)(e.fedFormTemplate,"data",{});a&&delete r[a],(0,p.default)(e.fedFormTemplate,"data",g(g({},r),t)),e.hideDataForm()},e.showDataForm=function(){e.setState({state:"data",selectDataKey:""})},e.hideDataForm=function(){e.setState({state:"",selectDataKey:""})},e.handleDataItemEdit=function(t){e.setState({state:"data",selectDataKey:t})},e}return(0,o.default)(r,[{key:"renderDataForm",value:function(){var e=this.state.selectDataKey,t=(0,d.default)(this.fedFormTemplate,"data",{});return f.default.createElement(E.default,{detail:t,selectKey:e,onOk:this.handleData,onCancel:this.hideDataForm})}},{key:"render",value:function(){var e=this.props.formRef;return"data"===this.state.state?this.renderDataForm():f.default.createElement(h.Form,{data:this.fedFormTemplate,ref:e},f.default.createElement(h.Form.Item,{label:t("DATA")},f.default.createElement(v.default,{name:"data",onEdit:this.handleDataItemEdit,onAdd:this.showDataForm})))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,m.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,d.default)(this.formTemplate,"spec.template"):this.formTemplate}}]),r}(f.default.Component);a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(808)),p=r(189),m=n(r(800)),h=n(r(838)),v=n(r(2419));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(e){var t;(0,l.default)(this,r),(t=a.call(this,e)).triggerChange=(0,d.default)((function(){var e=t.state,a=e.mode,r=e.config;t.props.onChange({mode:a,config:r})}),300),t.handleModeChange=function(e){t.setState({mode:e},(function(){t.triggerChange()}))},t.handleConfigChange=function(e){t.setState({config:e},(function(){t.triggerChange()}))};var n=e.data,u=n.mode,o=n.config;return t.state={mode:u,config:o},t}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.title,r=e.showSelect,n=e.selectDisabled,l=e.editorClassName,u=e.readOnly,o=this.state,c=o.mode,s=o.config;return i.default.createElement("div",{className:v.default.wrapper},i.default.createElement("div",{className:v.default.header},i.default.createElement("div",{className:v.default.title},i.default.createElement(p.Icon,{name:"coding",size:20}),i.default.createElement(m.default,{title:t(a)})),r&&i.default.createElement("div",{className:v.default.select},i.default.createElement(p.Select,{disabled:n,options:this.options,value:c,onChange:this.handleModeChange}))),i.default.createElement(h.default,{className:l,options:{readOnly:u},mode:c,value:s,onChange:this.handleConfigChange}))}},{key:"options",get:function(){return[{label:"YAML",value:"yaml"},{label:"Properties",value:"properties"},{label:"JSON",value:"json"},{label:"Text",value:"text"}]}}]),r}(i.default.Component);a.default=y,y.propTypes={data:f.default.object,showSelect:f.default.bool,onChange:f.default.func},y.defaultProps={data:{mode:"yaml",config:""},showSelect:!0,onChange:function(){}}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n,l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(243),d=r(a(2427)),p=r(a(2428)),m=r(a(2430)),h=r(a(2433)),v=r(a(2436)),E=r(a(2442)),y=r(a(2447)),g=r(a(2495)),b=r(a(2519)),S=r(a(2520)),_=r(a(2521)),O=r(a(2525)),C=r(a(2527));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var R=(0,f.observer)(n=function(e){(0,o.default)(a,e);var t=T(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).store=e.props.store,e.modalStore=new C.default,e.labelStore=new d.default,e.subForm=i.default.createRef(),e.handleSave=function(t){var a=e.props.onOk;e.subForm&&e.subForm.current&&e.subForm.current.handleSubmit(),a(t)},e}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.readOnly,a=e.onCancel,r=e.isSubmitting,n=this.modalStore.selectedMonitor,l=this.store.isEditing,u=n&&l;return i.default.createElement(f.Provider,{monitoringStore:this.store,labelStore:this.labelStore,modalStore:this.modalStore},i.default.createElement(_.default,{theme:this.modalStore.theme,onCancel:a,title:i.default.createElement(m.default,null),description:i.default.createElement(S.default,null),operations:i.default.createElement(i.default.Fragment,null,i.default.createElement(b.default,null),i.default.createElement(v.default,null),i.default.createElement(h.default,null),!t&&i.default.createElement(p.default,{onSaveClick:this.handleSave,isSubmitting:r}))},i.default.createElement(O.default,{sidebar:i.default.createElement(E.default,null),content:u?i.default.createElement(y.default,{ref:this.subForm}):i.default.createElement(g.default,null)})))}}]),a}(i.default.Component))||n;t.default=R},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u.default.createElement(c.Button,(0,n.default)({className:(0,o.default)(s.default.wrapper,(0,l.default)({},s.default.danger,"danger"===e.type))},e))};var n=r(a(317)),l=r(a(31)),u=r(a(0)),o=r(a(5)),c=a(189),s=r(a(2429))},function(e,t,a){"use strict";a(16),Object.defineProperty(t,"__esModule",{value:!0}),t.recentTimeRange=t.refreshInterval=void 0;t.refreshInterval=["","3s","5s","10s","30s"];t.recentTimeRange=["30m","1h","5h","12h","24h","7d"]},,function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(837),a(20),a(87),a(14),a(24),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(246)),l=r(a(97)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(31));a(32),a(3),a(837),a(20),a(87),a(442),a(29),a(14),a(24),a(4),a(321),a(18),a(43),a(11);var d,p=r(a(0)),m=r(a(26)),h=r(a(245)),v=r(a(5)),E=r(a(950)),y=r(a(879)),g=r(a(851)),b=r(a(883)),S=r(a(907)),_=r(a(852)),O=r(a(853)),C=r(a(2464)),T=r(a(2467));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var D=function(e){var t=e.from,a=e.to,r=e.count,n=parseInt((a-t)/(r+1),10);return Array(r).fill({}).reduce((function(e,a,r){return e.concat(t+n*(r+1))}),[])},k=(d={},(0,f.default)(d,6e4,"mm:ss"),(0,f.default)(d,36e5,"HH:mm"),(0,f.default)(d,864e5,"ddd HH:mm"),(0,f.default)(d,1296e6,"MMM Do"),(0,f.default)(d,"Infinity","MMM YYYY"),d);function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return(0,h.default)(e).format("YYYY-MM-DD HH:mm:ss")}var I=function(e){(0,c.default)(a,e);var t=R(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).ref=p.default.createRef(),e}return(0,o.default)(a,[{key:"getTickCount",value:function(){var e=(0,m.default)(this.ref,"current.offsetWidth");return e?Math.floor(e/75):5}},{key:"getXAxisExpand",value:function(){var e=this.props,t=e.data,a=e.timeRange,r=e.bar,n=t.length,l=a.end-a.start;return n>1&&r?l/(2*n-2):0}},{key:"getTicks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=this.getDomain(),a=(0,l.default)(t,2),r=a[0],n=a[1];return D({from:r,to:n,count:e})}},{key:"getDomain",value:function(){var e=this.props.timeRange,t=e.start,a=e.end,r=this.getXAxisExpand();return[t-r,a+r]}},{key:"getTickFormatter",value:function(e){var t=this.getDomain(),a=(0,l.default)(t,2),r=a[0],u=(a[1]-r)/e;for(var o in k)if(u<=Number(o)){var c=function(){var e=k[o];return{v:function(t){return(0,h.default)(t).format(e)}}}();if("object"===(0,n.default)(c))return c.v}}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,r=t.legends,n=t.line,l=t.bar,u=t.cartesianGrid,o=void 0===u||u,c=t.stacked,s=void 0!==c&&c,i=t.yAxis,f=void 0===i||i,d=t.className,m=t.valueFormatter;return p.default.createElement("div",{style:{height:"300px"},className:(0,v.default)(T.default.wrapper,d),ref:this.ref},p.default.createElement(O.default,{debounce:100},p.default.createElement(C.default,{data:a},o&&p.default.createElement(S.default,{vertical:!1}),this.renderTimeXAxis(),f&&p.default.createElement(b.default,{tickFormatter:m,tickLine:null,axisLine:null}),l&&r.map((function(t){return p.default.createElement(E.default,{isAnimationActive:!1,connectNulls:!0,key:"".concat(t.ID," - bar"),name:t.name,dataKey:t.ID,fill:t.color,stroke:t.color,stackId:s?"A":void 0,fillOpacity:t.opacity||1,barSize:e.singleBarSize})})),n&&r.map((function(e){return p.default.createElement(y.default,{isAnimationActive:!1,connectNulls:!0,key:"".concat(e.ID," - area"),name:e.name,dataKey:e.ID,fill:e.color,stroke:e.color,stackId:s?"A":void 0,fillOpacity:e.opacity||.4})})),p.default.createElement(g.default,{wrapperStyle:{zIndex:1e3},formatter:m,labelFormatter:N}))))}},{key:"renderTimeXAxis",value:function(){var e=this.props.xAxis,t=void 0===e||e,a=this.getDomain(),r=this.getTickCount(),n=this.getTicks(r),l=this.getTickFormatter(r),u=this.XAxisShouldPadding?30:0;return p.default.createElement(_.default,{hide:!t,type:"number",dataKey:"time",scale:"time",interval:0,tickLine:null,domain:a,ticks:n,tickFormatter:l,allowDataOverflow:"false",padding:{left:u,right:u}})}},{key:"singleBarSize",get:function(){var e=this.props.legends;return this.XAxisShouldPadding?Math.floor(60/e.length):void 0}},{key:"XAxisShouldPadding",get:function(){var e=this.props,t=e.data,a=e.timeRange,r="YYYY-MM-DD HH:mm:ss";if(1===t.length){var n=(0,h.default)(a.start).format(r),l=(0,h.default)(a.end).format(r),u=(0,h.default)(t[0].time).format(r);return u===n||u===l}return!1}}]),a}(p.default.PureComponent);t.default=I,I.defaultProps={valueFormatter:function(e){return e}}},,function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(20),a(194),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(194),a(29),a(14),a(4),a(18),a(43),a(11);var n=r(a(58)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(17),d=r(a(119));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,u=new Array(r),o=0;o<r;o++)u[o]=arguments[o];return(e=t.call.apply(t,[this].concat(u))).onAdd=function(){var t=e.props,a=t.onChange,r=t.value,l=void 0===r?[]:r,u=t.defaultItemValue;a([].concat((0,n.default)(l),[u]))},e.add=function(t){var a=e.props,r=a.onChange,l=a.value;r([].concat((0,n.default)(l),[t]))},e}return(0,u.default)(a,[{key:"onDelete",value:function(e){var t=this;return function(){var a=t.props,r=a.value,n=a.onChange,l=(0,d.default)((0,f.toJS)(r));l.splice(e,1),n(l)}}},{key:"onUpClick",value:function(e){var t=this;return function(){var a=t.props,r=a.value,n=a.onChange,l=(0,d.default)((0,f.toJS)(r)),u=l[e],o=(e-1+l.length)%l.length;l[e]=l[o],l[o]=u,n(l)}}},{key:"onDownClick",value:function(e){var t=this;return function(){var a=t.props,r=a.value,n=a.onChange,l=(0,d.default)((0,f.toJS)(r)),u=l[e],o=(e+1+l.length)%l.length;l[e]=l[o],l[o]=u,n(l)}}},{key:"render",value:function(){var e=this,t=this.props,a=t.value,r=t.header,n=t.children,l=t.name;return i.default.createElement("div",null,r&&r({onAdd:this.onAdd,value:a,add:this.add}),i.default.createElement("div",null,a.map((function(t,a){return n({index:a,value:t,formItemName:"".concat(l,"[").concat(a,"]"),onDelete:e.onDelete(a),onUpClick:e.onUpClick(a),onDownClick:e.onDownClick(a)})}))))}}]),a}(i.default.Component);t.default=m,m.defaultProps={defaultItemValue:{},value:[]}},function(e,a,r){"use strict";r(16);var n=r(19);r(320),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.prefix,r=e.onUpClick,n=e.onDownClick,p=e.onDelete,m=(0,u.default)(e,["prefix","onUpClick","onDownClick","onDelete"]);return o.default.createElement("div",{className:d.default.wrapper},o.default.createElement("div",{className:d.default.sort},o.default.createElement(c.Icon,{name:"sort-ascending",onClick:r}),o.default.createElement(c.Icon,{name:"sort-descending",onClick:n})),o.default.createElement("div",{className:d.default.form},o.default.createElement("div",{className:d.default.firstLine},o.default.createElement("div",null,o.default.createElement(c.Form.Item,{className:d.default.name},o.default.createElement(s.default,{name:"".concat(a,".legendFormat"),debounce:800},(function(e){var a=e.onChange,r=e.value;return o.default.createElement("div",null,o.default.createElement(i.default,{label:t("METRIC_NAME"),tips:""},o.default.createElement(c.Input,{className:d.default.input,value:r,onChange:a})))}))),o.default.createElement(c.Form.Item,{className:d.default.interval},o.default.createElement(s.default,{name:"".concat(a,".step"),debounce:500},(function(e){var a=e.onChange,r=e.value;return o.default.createElement("div",null,o.default.createElement(i.default,{label:t("INTERVAL"),tips:""},o.default.createElement(c.Input,{className:d.default.input,value:r,onChange:a})))})))),o.default.createElement(c.Icon,{name:"trash",onClick:p})),o.default.createElement("div",{className:d.default.exprInput},o.default.createElement(c.Form.Item,null,o.default.createElement(s.default,{name:"".concat(a,".expr"),debounce:500},(function(e){var t=e.onChange,a=e.value;return o.default.createElement(f.default,(0,l.default)({value:a,onChange:t},m))}))))))},r(320),r(14);var l=n(r(317)),u=n(r(50)),o=n(r(0)),c=r(189),s=n(r(962)),i=n(r(1004)),f=n(r(1101)),d=n(r(2471))},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.left,a=e.right;return n.default.createElement("div",{className:l.default.wrapper},n.default.createElement("div",null,t),a)};var n=r(a(0)),l=r(a(2472))},,function(e,t,a){"use strict";var r=a(19),n=a(162);a(12),a(109),a(3),a(10),a(6),a(20),a(87),a(51),a(14),a(138),a(8),a(13),a(9),a(30),a(69),a(71),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(3),a(10),a(6),a(20),a(27),a(87),a(51),a(442),a(29),a(14),a(138),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(30),a(69),a(71),a(7);var l=r(a(38));a(35);var u,o,c,s,i,f,d,p,m,h=r(a(39)),v=r(a(58)),E=r(a(1274)),y=r(a(31)),g=r(a(62)),b=r(a(25)),S=r(a(28)),_=r(a(45)),O=(r(a(63)),r(a(26))),C=r(a(68)),T=r(a(140)),R=a(17),D=r(a(245)),k=a(803),N=a(466),I=a(61),P=n(a(1171)),A=r(a(2528)),w=r(a(2529)),L=r(a(2530));function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var j={from:"now-30m",to:"now"},U={graph:w.default,signlestat:A.default},F=(u=function(){function e(t){var a=t.title,r=void 0===a?"":a,n=t.cluster,l=void 0===n?"":n,u=t.namespace,h=void 0===u?"":u,v=t.datasource,E=void 0===v?"prometheus":v,y=t.description,S=void 0===y?"":y,_=t.panels,O=void 0===_?[]:_,C=t.templatings,T=void 0===C?[]:C,R=t.time,D=void 0===R?j:R,N=t.isEditing,I=void 0!==N&&N,P=t.refresh,A=void 0===P?"":P,w=t.name,M=void 0===w?"":w,x=t.formTemplate;(0,b.default)(this,e),(0,g.default)(this,"title",o,this),(0,g.default)(this,"refresh",c,this),(0,g.default)(this,"time",s,this),(0,g.default)(this,"isEditing",i,this),(0,g.default)(this,"textMonitors",f,this),this.unNameGraphRow=new L.default({config:{id:0}}),(0,g.default)(this,"graphMonitorRows",d,this),(0,g.default)(this,"targetsMetadata",p,this),(0,g.default)(this,"changeTitle",m,this),this.title=r,this.cluster=l,this.namespace=h,this.datasource=E,this.description=S,this.panels=O,this.templatings=T,this.time=D,this.refresh=A,this.name=M,this.formTemplate=x,this.isEditing=I,this.generateMonitorList(),this.uidFactory=(0,k.CreateUidFactory)(this.panels.map((function(e){return e.id})))}var t;return(0,S.default)(e,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cluster,a=e.namespace,r="";return t&&(r+="/clusters/".concat(t)),a&&(r+="/namespaces/".concat(a)),r}},{key:"getTimeRange",value:function(){var e=this.time,t=e.from,a=e.to;return{from:(0,D.default)(this.parseGrafanaTime(t)),to:(0,D.default)(this.parseGrafanaTime(a))}}},{key:"refreshMs",get:function(){return this.refresh?(0,N.getMsFromTimeAlias)(this.refresh):0}},{key:"timeRange",get:function(){var e=this.time,t=e.from,a=e.to;return{from:(0,D.default)(this.parseGrafanaTime(t)),to:(0,D.default)(this.parseGrafanaTime(a))}}}]),(0,S.default)(e,[{key:"changeRefreshInterval",value:function(e){this.refresh=e}},{key:"changeTimeRange",value:function(e){var t=e.from,a=e.to;this.time.from=t,this.time.to=a}},{key:"switchEditingMode",value:function(e){this.isEditing=e}},{key:"changeModeToEditing",value:function(){return this.switchEditingMode(!0),this}},{key:"generateMonitorList",value:function(){var e=this.panels.reduce((function(e,t){return e[t.type===P.MONITOR_PANEL_TYPE.TEXT?"textPanels":"otherPanels"].push(t),e}),{textPanels:[],otherPanels:[]}),t=e.textPanels,a=e.otherPanels;this.textMonitors=this.generateTextMonitors(t);var r=this.gennerateGraphMonitorRows(a),n=r.unNameGraphRow,l=r.graphRows;this.unNameGraphRow=n,this.graphMonitorRows=l}},{key:"generateTextMonitors",value:function(e){var t=this,a=e.map((function(e){return new A.default(x(x({},e),{},{namespace:t.namespace,cluster:t.cluster}))}));return new L.default({monitors:a})}},{key:"gennerateGraphMonitorRows",value:function(e){var t=this,a=e.reduce((function(e,a){if(a.type===P.MONITOR_PANEL_TYPE.ROW)return[].concat((0,v.default)(e),[new L.default({config:a})]);var r=new(U[a.type]||P.default)(x(x({},a),{},{namespace:t.namespace,cluster:t.cluster})),n=e.pop();return n.push(r),[].concat((0,v.default)(e),[n])}),[this.unNameGraphRow]),r=(0,E.default)(a);return{unNameGraphRow:r[0],graphRows:r.slice(1)}}},{key:"addNewRow",value:function(){this.graphMonitorRows.push(new L.default({config:{id:this.uidFactory.generateUID(),title:"New Row",type:"row"}}))}},{key:"generateNewTextMonitor",value:function(){var e=new A.default({id:this.uidFactory.generateUID(),title:"",format:"none",type:"singlestat",decimals:0,namespace:this.namespace,cluster:this.cluster,valueName:"last",targets:[{expr:""}]});return e.belong(this.textMonitors),e}},{key:"generatGraphMonitor",value:function(e){var t=e.bars,a=e.lines,r=new w.default({id:this.uidFactory.generateUID(),type:"graph",title:"",lines:a,bars:t,description:"",namespace:this.namespace,cluster:this.cluster,stack:!1,targets:[{expr:"",legendFormat:"",step:"1m",refId:1}],yaxes:[{format:"none",decimals:0}],colors:I.MONITOR_GRAPH_COLORS[0].colors});return r.belong(this.unNameGraphRow),r}},{key:"generatTableMonitor",value:function(){var e=new P.default({id:this.uidFactory.generateUID(),title:"",format:"none",type:"graph",decimals:0,namespaces:this.namespace,cluster:this.cluster,targets:[{expr:""}]});return e.belong(this.unNameGraphRow),e}},{key:"parseGrafanaTime",value:function(e){if(this.isGrafanaTimeFormat(e)){var t=e.replace(/now-?/,""),a=(0,N.getMsFromTimeAlias)(t);return Date.now()-a}return new Date(e).valueOf()}},{key:"isGrafanaTimeFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.match(/^now$|^now-(\d+[smhd])$/)}},{key:"fetchMetadata",value:(t=(0,h.default)(l.default.mark((function e(){var t,a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,request.get("kapis/monitoring.kubesphere.io/v1beta1/targets/metadata",{cluster:this.cluster,namespace:this.namespace});case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={data:[]};case 5:t=e.t0,a=t.data,this.targetsMetadata=a||[];case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"toJS",value:function(){var e=this.textMonitors,t=this.unNameGraphRow,a=this.graphMonitorRows,r=[].concat((0,v.default)(t.monitors),(0,v.default)(e.monitors)).map((function(e){return(0,T.default)((0,R.toJS)(e.config),["cluster","namespace"])})),n=a.reduce((function(e,t){var a=t.monitors.map((function(e){return(0,T.default)((0,R.toJS)(e.config),["cluster","namespace"])}));return e.concat(t.config,a)}),[]);return(0,C.default)(this.formTemplate,"spec",Object.assign((0,O.default)(this.formTemplate,"spec",{}),{title:this.title,templatings:this.templatings,refresh:this.refresh,time:(0,R.toJS)(this.time),panels:[].concat((0,v.default)(r),(0,v.default)(n))})),this.formTemplate}}]),e}(),o=(0,_.default)(u.prototype,"title",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),c=(0,_.default)(u.prototype,"refresh",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s=(0,_.default)(u.prototype,"time",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{from:"now",to:"now"}}}),(0,_.default)(u.prototype,"refreshMs",[R.computed],Object.getOwnPropertyDescriptor(u.prototype,"refreshMs"),u.prototype),(0,_.default)(u.prototype,"timeRange",[R.computed],Object.getOwnPropertyDescriptor(u.prototype,"timeRange"),u.prototype),i=(0,_.default)(u.prototype,"isEditing",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=(0,_.default)(u.prototype,"textMonitors",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),d=(0,_.default)(u.prototype,"graphMonitorRows",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=(0,_.default)(u.prototype,"targetsMetadata",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),m=(0,_.default)(u.prototype,"changeTitle",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.title=t}}}),(0,_.default)(u.prototype,"changeRefreshInterval",[R.action],Object.getOwnPropertyDescriptor(u.prototype,"changeRefreshInterval"),u.prototype),(0,_.default)(u.prototype,"changeTimeRange",[R.action],Object.getOwnPropertyDescriptor(u.prototype,"changeTimeRange"),u.prototype),(0,_.default)(u.prototype,"switchEditingMode",[R.action],Object.getOwnPropertyDescriptor(u.prototype,"switchEditingMode"),u.prototype),(0,_.default)(u.prototype,"generateMonitorList",[R.action],Object.getOwnPropertyDescriptor(u.prototype,"generateMonitorList"),u.prototype),u);t.default=F},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(12),a(109),a(3),a(10),a(70),a(20),a(4),a(18),a(11),a(73),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(32),a(3),a(10),a(70),a(20),a(29),a(4),a(18),a(43),a(11),a(73);var l=n(a(31)),u=n(a(58)),o=n(a(25)),c=n(a(28)),s=n(a(41)),i=n(a(42)),f=n(a(37)),d=r(a(0)),p=n(a(5)),m=n(a(1)),h=a(189),v=n(a(64)),E=n(a(2539));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=function(e){(0,s.default)(a,e);var t=y(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={value:e.props.value},e.handleClick=function(t){var a=t,r=e.state.value,n=e.props.onChange;(0,v.default)(r)?r.includes(a)?e.setState({value:r.filter((function(e){return e!==a}))},(function(){n(r.filter((function(e){return e!==a})))})):e.setState({value:[].concat((0,u.default)(r),[a])},(function(){n([].concat((0,u.default)(r),[a]))})):e.setState({value:a},(function(){n(a)}))},e.selectedCheck=function(t){var a=e.state.value;return(0,v.default)(a)?a.includes(t):t===a},e}return(0,c.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.className,r=t.options,n=t.selectedClassName;return d.default.createElement("ul",{className:(0,p.default)(E.default.container,a)},r.map((function(t){var a=t.icon,r=void 0===a?"picture":a,u=t.image,o=t.label,c=t.value,s=t.description;return d.default.createElement("li",{key:c,"data-value":c,onClick:function(){return e.handleClick(c)},className:(0,p.default)((0,l.default)({},n,e.selectedCheck(c))),style:{paddingTop:s?"12px":"18px"}},d.default.createElement("figure",null,u?d.default.createElement("img",{src:u}):d.default.createElement(h.Icon,{name:r})),d.default.createElement("h3",null,o),s&&d.default.createElement("p",null,s))})))}}]),a}(d.Component);t.default=g,g.propTypes={options:m.default.array,value:m.default.oneOfType([m.default.array,m.default.string]),selectedClassName:m.default.string,iconSize:m.default.oneOfType([m.default.number,m.default.string])},g.defaultProps={selectedClassName:E.default.selected}},function(e){e.exports=JSON.parse('{"Elasticsearch Overview":{"settings":{"datasource":"prometheus","panels":[{"decimals":0,"format":"none","id":11,"targets":[{"expr":"sum by(cluster) (elasticsearch_cluster_health_status{color=\\"red\\"})"}],"title":"Red Clusters","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":12,"targets":[{"expr":"sum by(cluster) (elasticsearch_cluster_health_status{color=\\"yellow\\"})"}],"title":"Yellow Clusters","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":14,"targets":[{"expr":"elasticsearch_cluster_health_number_of_nodes"}],"title":"Number of Nodes","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":16,"targets":[{"expr":"elasticsearch_cluster_health_number_of_data_nodes"}],"title":"Number of Data Nodes","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":17,"targets":[{"expr":"elasticsearch_cluster_health_number_of_pending_tasks"}],"title":"Pending Tasks","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":21,"targets":[{"expr":"sum (elasticsearch_process_open_files_count)"}],"title":"Open File Descriptors","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":22,"targets":[{"expr":"elasticsearch_cluster_health_active_primary_shards"}],"title":"Active primary shards","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":25,"targets":[{"expr":"elasticsearch_cluster_health_active_shards"}],"title":"Active shards","type":"singlestat","valueName":"last"},{"id":37,"title":"JVM","type":"row"},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":15,"lines":true,"stack":false,"targets":[{"expr":"sum by(name) (elasticsearch_jvm_memory_used_bytes) / sum by(name) (elasticsearch_jvm_memory_max_bytes)","legendFormat":"{{name}}","refId":1,"step":"1m"}],"title":"JVM Memory Used","type":"graph","yaxes":[{"decimals":2,"format":"percent (0.0-1.0)"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":30,"lines":true,"stack":false,"targets":[{"expr":"elasticsearch_jvm_memory_committed_bytes","legendFormat":"{{name}} committed: {{area}}","refId":1,"step":"1m"},{"expr":"elasticsearch_jvm_memory_max_bytes","legendFormat":"{{name}} max: {{area}}","refId":2,"step":"1m"}],"title":"JVM Memory Committed","type":"graph","yaxes":[{"decimals":3,"format":"Byte"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":27,"lines":true,"stack":false,"targets":[{"expr":"irate(elasticsearch_jvm_gc_collection_seconds_count[3m])","legendFormat":"{{name}} {{gc}}","refId":1,"step":"1m"}],"title":"GC Count","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":28,"lines":true,"stack":false,"targets":[{"expr":"irate(elasticsearch_jvm_gc_collection_seconds_sum[3m])","legendFormat":"{{name}} {{gc}}","refId":1,"step":"1m"}],"title":"GC Time","type":"graph","yaxes":[{"decimals":3,"format":"none"}]},{"id":38,"title":"Resource Consumption","type":"row"},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":29,"lines":true,"stack":false,"targets":[{"expr":"elasticsearch_os_load1","legendFormat":"load1: {{name}}","refId":1,"step":"1m"},{"expr":"elasticsearch_os_load5","legendFormat":"load5: {{name}}","refId":2,"step":"1m"},{"expr":"elasticsearch_os_load15","legendFormat":"load15: {{name}}","refId":3,"step":"1m"}],"title":"Load Average","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":32,"lines":true,"stack":false,"targets":[{"expr":"elasticsearch_filesystem_data_available_bytes","legendFormat":"{{name}}: {{path}}","refId":1,"step":"1m"}],"title":"Disk Usage","type":"graph","yaxes":[{"decimals":3,"format":"Byte"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":33,"lines":true,"stack":false,"targets":[{"expr":"irate(elasticsearch_transport_tx_size_bytes_total[3m])","legendFormat":"{{name}}: sent","refId":1,"step":"1m"},{"expr":"irate(elasticsearch_transport_rx_size_bytes_total[3m])","legendFormat":"{{name}}: received","refId":2,"step":"1m"}],"title":"Network Usage","type":"graph","yaxes":[{"decimals":2,"format":"Byte"}]},{"id":39,"title":"Documents and Indices","type":"row"},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":34,"lines":true,"stack":false,"targets":[{"expr":"elasticsearch_indices_docs","legendFormat":"{{name}}","refId":1,"step":"1m"}],"title":"Documents Count on Node","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":26,"lines":true,"stack":false,"targets":[{"expr":"elasticsearch_cluster_health_initializing_shards","legendFormat":"Initializing Shards","refId":1,"step":"1m"},{"expr":"elasticsearch_cluster_health_relocating_shards","legendFormat":"Relocating Shards","refId":2,"step":"1m"},{"expr":"elasticsearch_cluster_health_active_shards","legendFormat":"Active Shards","refId":3,"step":"1m"},{"expr":"elasticsearch_cluster_health_active_primary_shards","legendFormat":"Active Primary Shards","refId":4,"step":"1m"},{"expr":"elasticsearch_cluster_health_unassigned_shards","legendFormat":"Unassigned Shards","refId":5,"step":"1m"},{"expr":"elasticsearch_cluster_health_delayed_unassigned_shards","legendFormat":"Delayed Unassigned Shards","refId":6,"step":"1m"}],"title":"Shards","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":35,"lines":true,"stack":false,"targets":[{"expr":"irate(elasticsearch_indices_search_query_time_seconds[3m]) ","legendFormat":"{{name}}","refId":1,"step":"1m"}],"title":"Query Time","type":"graph","yaxes":[{"decimals":3,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":42,"lines":true,"stack":false,"targets":[{"expr":"elasticsearch_indices_query_cache_memory_size_bytes","legendFormat":"{{name}}","refId":1,"step":"1m"}],"title":"Query Cache Size","type":"graph","yaxes":[{"decimals":3,"format":"Byte"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":36,"lines":true,"stack":false,"targets":[{"expr":"irate(elasticsearch_indices_indexing_index_time_seconds_total[5m])","legendFormat":"{{name}}","refId":1,"step":"1m"}],"title":"Indexing Time","type":"graph","yaxes":[{"decimals":3,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":43,"lines":true,"stack":false,"targets":[{"expr":"elasticsearch_indices_segments_count","legendFormat":"{{name}}","refId":1,"step":"1m"}],"title":"Count of Index Segments","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":44,"lines":true,"stack":false,"targets":[{"expr":"elasticsearch_indices_segments_memory_bytes","legendFormat":"{{name}}","refId":1,"step":"1m"}],"title":"Current Memory of Segments","type":"graph","yaxes":[{"decimals":3,"format":"Byte"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"Total size of stored index data in bytes with all shards on all nodes","id":45,"lines":true,"stack":false,"targets":[{"expr":"sum by(index) (elasticsearch_indices_store_size_bytes_total)","legendFormat":"{{index}}","refId":1,"step":"1m"}],"title":"Total Size Stored Index Data","type":"graph","yaxes":[{"decimals":3,"format":"Byte"}]}],"title":"Elasticsearch Overview"},"name":"Elasticsearch","logo":"/assets/elasticsearch-das.svg"},"MySQL Overview":{"settings":{"datasource":"prometheus","panels":[{"decimals":2,"format":"none","id":2,"targets":[{"expr":"mysql_global_status_uptime / (3600*24)"}],"title":"MySQL Uptime (days)","type":"singlestat","valueName":"last"},{"decimals":2,"format":"none","id":3,"targets":[{"expr":"rate(mysql_global_status_queries[5m]) or irate(mysql_global_status_queries[5m])"}],"title":"Current QPS","type":"singlestat","valueName":"last"},{"decimals":0,"format":"Byte","id":6,"targets":[{"expr":"mysql_global_variables_innodb_buffer_pool_size"}],"title":"InnoDB Buffer Pool Size","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":9,"targets":[{"expr":"mysql_global_variables_max_connections"}],"title":"Max Permitted Connections","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":12,"targets":[{"expr":"mysql_global_variables_thread_cache_size"}],"title":"Thread Cache Size","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":21,"targets":[{"expr":"mysql_global_variables_long_query_time"}],"title":"Long Query Time (second)","type":"singlestat","valueName":"last"},{"id":4,"title":"Connections and Threads","type":"row"},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"The maximum number of connections that have been in use simultaneously since the server started.","id":8,"lines":true,"stack":false,"targets":[{"expr":"mysql_global_status_max_used_connections","legendFormat":"Max Used Connections","refId":1,"step":"1m"}],"title":"Connections","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"Threads Cached: The number of threads in the thread cache. Threads Connected: The number of currently open connections. Threads Created: The number of threads created to handle connections. Threads Running: The number of threads that are not sleeping.","id":5,"lines":true,"stack":false,"targets":[{"expr":"mysql_global_status_threads_connected","legendFormat":"Threads Connected","refId":1,"step":"1m"},{"expr":"mysql_global_status_threads_created","legendFormat":"Threads Created","refId":2,"step":"1m"},{"expr":"mysql_global_status_threads_running","legendFormat":"Threads Running","refId":3,"step":"1m"},{"expr":"mysql_global_status_threads_cached","legendFormat":"Threads Cached","refId":4,"step":"1m"}],"title":"Threads","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"Aborted_clients: The number of connections that were aborted because the client died without closing the connection properly. Aborted_connects: The number of failed attempts to connect to the MySQL server.","id":22,"lines":true,"stack":false,"targets":[{"expr":"rate(mysql_global_status_aborted_connects[5m]) or irate(mysql_global_status_aborted_connects[5m])","legendFormat":"Aborted Connects (attempts)","refId":1,"step":"1m"},{"expr":"rate(mysql_global_status_aborted_clients[5m]) or irate(mysql_global_status_aborted_clients[5m])","legendFormat":"Aborted Clients (timeout)","refId":2,"step":"1m"}],"title":"Aborted Connections","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"id":10,"title":"Queries and Questions","type":"row"},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"The number of statements executed by the server. This includes only statements sent to the server by clients and not statements executed within stored programs, unlike the Queries variable.","id":13,"lines":true,"stack":false,"targets":[{"expr":"rate(mysql_global_status_questions[5m]) or irate(mysql_global_status_questions[5m])","legendFormat":"Questions","refId":1,"step":"1m"}],"title":"Questions","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":18,"lines":true,"stack":false,"targets":[{"expr":"rate(mysql_global_status_select_full_join[5m]) or irate(mysql_global_status_select_full_join[5m])","legendFormat":"Full Join","refId":1,"step":"1m"},{"expr":"rate(mysql_global_status_select_full_range_join[5m]) or irate(mysql_global_status_select_full_range_join[5m])","legendFormat":"Full Range Join","refId":2,"step":"1m"},{"expr":"rate(mysql_global_status_select_scan[5m]) or irate(mysql_global_status_select_scan[5m])","legendFormat":"Scan","refId":3,"step":"1m"},{"expr":"rate(mysql_global_status_select_range[5m]) or irate(mysql_global_status_select_range[5m])","legendFormat":"Range","refId":4,"step":"1m"},{"expr":"rate(mysql_global_status_select_range_check[5m]) or irate(mysql_global_status_select_range_check[5m])","legendFormat":"Range Check","refId":5,"step":"1m"}],"title":"Select By Types","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":19,"lines":true,"stack":false,"targets":[{"expr":"rate(mysql_global_status_sort_rows[5m]) or irate(mysql_global_status_sort_rows[5m])","legendFormat":"Rows","refId":1,"step":"1m"},{"expr":"rate(mysql_global_status_sort_range[5m]) or irate(mysql_global_status_sort_range[5m])","legendFormat":"Range","refId":2,"step":"1m"},{"expr":"rate(mysql_global_status_sort_merge_passes[5m]) or irate(mysql_global_status_sort_merge_passes[5m])","legendFormat":"Merge Passes","refId":3,"step":"1m"},{"expr":"rate(mysql_global_status_sort_scan[5m]) or irate(mysql_global_status_sort_scan[5m])","legendFormat":"Scan","refId":4,"step":"1m"}],"title":"Sort By Types","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"The number of queries that have taken more than long_query_time seconds. This counter increments regardless of whether the slow query log is enabled.","id":20,"lines":true,"stack":false,"targets":[{"expr":"rate(mysql_global_status_slow_queries[5m]) or irate(mysql_global_status_slow_queries[5m])","legendFormat":"Slow Queries","refId":1,"step":"1m"}],"title":"Slow Queries","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"id":15,"title":"Temporary Objects","type":"row"},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":16,"lines":true,"stack":false,"targets":[{"expr":"rate(mysql_global_status_created_tmp_tables[5m]) or irate(mysql_global_status_created_tmp_tables[5m])","legendFormat":"Created Tmp Tables","refId":1,"step":"1m"},{"expr":"rate(mysql_global_status_created_tmp_disk_tables[5m]) or irate(mysql_global_status_created_tmp_disk_tables[5m])","legendFormat":"Created Tmp Disk Tables","refId":2,"step":"1m"},{"expr":"rate(mysql_global_status_created_tmp_files[5m]) or irate(mysql_global_status_created_tmp_files[5m])","legendFormat":"Created Tmp Files","refId":3,"step":"1m"}],"title":"Tmp Tables and Files","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"id":23,"title":"Table Locks","type":"row"},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"The number of times that a request for a table lock could be granted immediately, or could not be granted immediately and a wait was needed. ","id":24,"lines":true,"stack":false,"targets":[{"expr":"rate(mysql_global_status_table_locks_immediate[5m]) or irate(mysql_global_status_table_locks_immediate[5m])","legendFormat":"Table Locks Immediate","refId":1,"step":"1m"},{"expr":"rate(mysql_global_status_table_locks_waited[5m]) or irate(mysql_global_status_table_locks_waited[5m])","legendFormat":"Table Locks Waited","refId":2,"step":"1m"}],"title":"Locks By Types","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"id":25,"title":"Network Traffic","type":"row"},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":26,"lines":true,"stack":false,"targets":[{"expr":"rate(mysql_global_status_bytes_received[5m]) or irate(mysql_global_status_bytes_received[5m])","legendFormat":"Inbound","refId":1,"step":"1m"},{"expr":"rate(mysql_global_status_bytes_sent[5m]) or irate(mysql_global_status_bytes_sent[5m])","legendFormat":"Outbound","refId":2,"step":"1m"}],"title":"Inbound vs Outbound","type":"graph","yaxes":[{"decimals":0,"format":"Byte/s"}]}],"title":"MySQL Overview"},"name":"MySQL","logo":"/assets/mysql.svg"},"Redis Overview":{"settings":{"datasource":"prometheus","panels":[{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":6,"lines":true,"stack":false,"targets":[{"expr":"irate(redis_keyspace_hits_total[5m])","legendFormat":"Hits","refId":1,"step":"1m"},{"expr":"irate(redis_keyspace_misses_total[5m])","legendFormat":"Misses","refId":2,"step":"1m"}],"title":"Hits / Misses per Sec","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":7,"lines":true,"stack":false,"targets":[{"expr":"rate(redis_net_input_bytes_total[5m])","legendFormat":"Input","refId":1,"step":"1m"},{"expr":"rate(redis_net_output_bytes_total[5m])","legendFormat":"Output","refId":2,"step":"1m"}],"title":"Network I/O","type":"graph","yaxes":[{"decimals":2,"format":"Byte/s"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":8,"lines":true,"stack":false,"targets":[{"expr":"sum (redis_db_keys) by (db)","legendFormat":"{{db}}","refId":1,"step":"1m"}],"title":"Total Items per DB","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":9,"lines":true,"stack":false,"targets":[{"expr":"sum (redis_db_keys) - sum (redis_db_keys_expiring) ","legendFormat":"Not Expiring","refId":1,"step":"1m"},{"expr":"sum (redis_db_keys_expiring) ","legendFormat":"Expiring","refId":2,"step":"1m"}],"title":"Expiring vs Not-Expiring Keys","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":10,"lines":true,"stack":false,"targets":[{"expr":"sum(rate(redis_expired_keys_total[5m])) by (instance)","legendFormat":"Expired","refId":1,"step":"1m"},{"expr":"sum(rate(redis_evicted_keys_total[5m])) by (instance)","legendFormat":"Evicted","refId":2,"step":"1m"}],"title":"Expired / Evicted","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":11,"lines":true,"stack":false,"targets":[{"expr":"topk(5, irate(redis_commands_total[3m]))","legendFormat":"{{cmd}}","refId":1,"step":"1m"}],"title":"Command Calls / sec","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"bars":false,"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"","id":12,"lines":true,"stack":false,"targets":[{"expr":"redis_connected_clients","legendFormat":"total","refId":1,"step":"1m"}],"title":"Redis connected clients","type":"graph","yaxes":[{"decimals":0,"format":"none"}]},{"decimals":2,"format":"none","id":1,"targets":[{"expr":"redis_uptime_in_seconds / (3600 * 24)"}],"title":"Uptime (days)","type":"singlestat","valueName":"last"},{"decimals":0,"format":"none","id":3,"targets":[{"expr":"redis_connected_clients"}],"title":"Clients","type":"singlestat","valueName":"last"},{"decimals":2,"format":"percent (0-100)","id":4,"targets":[{"expr":"redis_memory_used_bytes  / redis_memory_max_bytes"}],"title":"Memory Usage","type":"singlestat","valueName":"last"},{"decimals":2,"format":"none","id":5,"targets":[{"expr":"rate(redis_commands_processed_total[2m])"}],"title":"Commands Executed / sec","type":"singlestat","valueName":"last"}],"title":"Redis Overview"},"name":"Redis","logo":"/assets/redis-das.svg"},"Jenkins Overview":{"settings":{"datasource":"prometheus","panels":[{"format":"none","id":56,"targets":[{"expr":"process_open_fds{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}"}],"title":"Open File Descriptors","type":"singlestat"},{"decimals":0,"format":"none","id":57,"targets":[{"expr":"jenkins_queue_blocked_value{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}"}],"title":"Queue Blocked","type":"singlestat"},{"decimals":0,"format":"none","id":58,"targets":[{"expr":"jenkins_executor_in_use_value{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}"}],"title":"Executors in Use","type":"singlestat"},{"decimals":0,"format":"none","id":59,"targets":[{"expr":"jenkins_queue_buildable_value{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}"}],"title":"Queue Buildable","type":"singlestat"},{"decimals":0,"format":"none","id":60,"targets":[{"expr":"jenkins_runs_total_total{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}\\n"}],"title":"Total Run","type":"singlestat"},{"id":35,"title":"JVM","type":"row"},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":37,"lines":true,"targets":[{"expr":"sum by(namespace, container, instance) (jvm_memory_bytes_used) / sum by(namespace, container, instance) (jvm_memory_bytes_max)","legendFormat":"{{container}}-{{instance}}","refId":1,"step":"1m"}],"title":"JVM Memory Used","type":"graph","yaxes":[{"decimals":2,"format":"percent (0.0-1.0)"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":38,"lines":true,"targets":[{"expr":"jvm_memory_bytes_committed","legendFormat":"{{container}}-{{instance}} committed: {{area}}","refId":1,"step":"1m"},{"expr":"jvm_memory_bytes_max","legendFormat":"{{container}}-{{instance}} max: {{area}}","refId":2,"step":"1m"}],"title":"JVM Memory Committed","type":"graph","yaxes":[{"decimals":3,"format":"Byte"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":39,"lines":true,"targets":[{"expr":"irate(jvm_gc_collection_seconds_count[3m])","legendFormat":"{{container}}-{{instance}}: {{gc}}","refId":1,"step":"1m"}],"title":"GC Count","type":"graph","yaxes":[{"decimals":2,"format":"none"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":40,"lines":true,"targets":[{"expr":"irate(jvm_gc_collection_seconds_sum[3m])\\n","legendFormat":"{{container}}-{{instance}}: {{gc}}","refId":1,"step":"1m"}],"title":"GC Time","type":"graph","yaxes":[{"decimals":3,"format":"seconds"}]},{"id":42,"title":"Resource Consumption","type":"row"},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":43,"lines":true,"targets":[{"expr":"vm_cpu_load_x100_history{quantile=\\"0.999\\"} / 100\\n","legendFormat":"load1: {{container}}-{{instance}}","refId":1,"step":"1m"},{"expr":"vm_cpu_load_x100_window_5m{quantile=\\"0.999\\"} / 100","legendFormat":"load5: {{container}}-{{instance}}","refId":2,"step":"1m"},{"expr":"vm_cpu_load_x100_window_15m{quantile=\\"0.999\\"} / 100","legendFormat":"load15: {{container}}-{{instance}}","refId":3,"step":"1m"}],"title":"Load Average","type":"graph","yaxes":[{"decimals":3,"format":"none"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":44,"lines":true,"targets":[{"expr":"default_jenkins_disk_usage_bytes{container=\\"ks-jenkins\\", namespace=\\"kubesphere-devops-system\\", job=\\"ks-jenkins\\"}","legendFormat":"{{container}}-{{instance}}: {{directory}}","refId":1,"step":"1m"}],"title":"Disk Usage","type":"graph","yaxes":[{"decimals":3,"format":"Byte"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":55,"lines":true,"targets":[{"expr":"process_open_fds{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}","legendFormat":"open fds","refId":1,"step":"1m"},{"expr":"process_max_fds{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}","legendFormat":"max fds","refId":2,"step":"1m"}],"title":"File Descriptor","type":"graph","yaxes":[{"format":"none"}]},{"id":46,"title":"Job","type":"row"},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":47,"lines":true,"targets":[{"expr":"jenkins_runs_total_total","legendFormat":"total jobs","refId":1,"step":"1m"},{"expr":"jenkins_runs_success_total\\n\\n","legendFormat":"successful jobs","refId":2,"step":"1m"},{"expr":"jenkins_runs_failure_total","legendFormat":"failure jobs","refId":3,"step":"1m"},{"expr":"jenkins_runs_aborted_total","legendFormat":"aborted jobs","refId":4,"step":"1m"}],"title":"Job Statistics","type":"graph","yaxes":[{"format":"none"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":48,"lines":true,"targets":[{"expr":"jenkins_queue_stuck_history{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\", quantile=\\"0.999\\"}","legendFormat":"{{container}}-{{instance}}","refId":1,"step":"1m"}],"title":"Stuck Job History","type":"graph","yaxes":[{"format":"none"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"description":"Amount of disk usage (bytes) for each job in Jenkins","id":49,"lines":true,"targets":[{"expr":"default_jenkins_job_usage_bytes","legendFormat":"{{url}}","refId":1,"step":"1m"}],"title":"Job Disk Usage","type":"graph","yaxes":[{"decimals":3,"format":"Byte"}]},{"id":51,"title":"Status","type":"row"},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"id":53,"lines":true,"targets":[{"expr":"jenkins_health_check_score{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}\\n","legendFormat":"{{container}}-{{instance}}-health-score","refId":1,"step":"1m"},{"expr":"default_jenkins_up{namespace=\\"kubesphere-devops-system\\", container=\\"ks-jenkins\\", job=\\"ks-jenkins\\"}","legendFormat":"{{container}}-{{instance}}-up","refId":2,"step":"1m"}],"title":"Jenkins Health","type":"graph","yaxes":[{"decimals":2,"format":"none"}]}],"title":"Jenkins Overview"},"name":"Jenkins","logo":"/assets/jenkins.svg"},"GPU Overview":{"settings":{"datasource":"prometheus","panels":[{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"datasource":"${DS_PROMETHEUS}","id":12,"legend":["as_table","to_the_right","max","avg","current"],"lines":true,"targets":[{"expr":"DCGM_FI_DEV_GPU_TEMP","legendFormat":"Host {{node}} / Device {{device}} / GPU {{gpu}}","refId":1,"step":"1m"}],"title":"GPU Temperature","type":"graph","xaxis":{},"yaxes":[{"format":"none"}]},{"datasource":"${DS_PROMETHEUS}","id":14,"format":"none","targets":[{"expr":"avg(DCGM_FI_DEV_GPU_TEMP)","refId":1,"step":"1m"}],"title":"GPU Avg. Temp","type":"singlestat"},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"datasource":"${DS_PROMETHEUS}","id":10,"legend":["as_table","to_the_right","max","avg","current"],"lines":true,"targets":[{"expr":"sum without(Hostname, UUID, service, endpoint, container, job, pod, instance, namespace) (DCGM_FI_DEV_POWER_USAGE * on(pod,namespace) group_left(node) kube_pod_info)","legendFormat":"Host {{node}} / Device {{device}} / GPU {{gpu}}","refId":1,"step":"1m"}],"title":"GPU Power Usage","type":"graph","xaxis":{},"yaxes":[{"format":"none"}]},{"datasource":"${DS_PROMETHEUS}","id":16,"format":"none","targets":[{"expr":"sum(DCGM_FI_DEV_POWER_USAGE)","step":"1m"}],"title":"GPU Power Total","type":"singlestat"},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"datasource":"${DS_PROMETHEUS}","id":2,"legend":["as_table","to_the_right","max","avg","current"],"lines":true,"targets":[{"expr":"sum without(Hostname, UUID, service, endpoint, container, job, pod, instance, namespace) (DCGM_FI_DEV_SM_CLOCK * on(pod,namespace) group_left(node) kube_pod_info) * 1000000","legendFormat":"Host {{node}} / Device {{device}} / GPU {{gpu}}","refId":1,"step":"1m"}],"title":"GPU SM Clocks","type":"graph","xaxis":{},"yaxes":[{"format":"none"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"datasource":"${DS_PROMETHEUS}","id":6,"legend":["as_table","to_the_right","max","avg","current"],"lines":true,"targets":[{"expr":"sum without(Hostname, UUID, service, endpoint, container, job, pod, instance, namespace) (DCGM_FI_DEV_GPU_UTIL * on(pod,namespace) group_left(node) kube_pod_info)","legendFormat":"Host {{node}} / Device {{device}} / GPU {{gpu}}","refId":1,"step":"1m"}],"title":"GPU Utilization","type":"graph","xaxis":{},"yaxes":[{"format":"percent (0.0-1.0)"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"datasource":"${DS_PROMETHEUS}","id":18,"legend":["to_the_right","max","avg"],"lines":true,"targets":[{"expr":"sum without(Hostname, UUID, service, endpoint, container, job, pod, instance, namespace) (DCGM_FI_DEV_FB_USED * on(pod,namespace) group_left(node) kube_pod_info)","legendFormat":"Host {{node}} / Device {{device}} / GPU {{gpu}}","refId":1,"step":"1m"}],"title":"GPU Framebuffer Mem Used","type":"graph","xaxis":{},"yaxes":[{"format":"none"}]},{"colors":["#60acfc","#23c2db","#64d5b2","#d5ec5a","#ffb64e","#fb816d","#d15c7f"],"datasource":"${DS_PROMETHEUS}","id":4,"legend":["as_table","to_the_right","max","avg","current"],"lines":true,"targets":[{"expr":"sum without(Hostname, UUID, service, endpoint, container, job, pod, instance, namespace) (DCGM_FI_PROF_PIPE_TENSOR_ACTIVE * on(pod,namespace) group_left(node) kube_pod_info)","legendFormat":"Host {{node}} / Device {{device}} / GPU {{gpu}}","refId":1,"step":"1m"}],"title":"Tensor Core Utilization","type":"graph","xaxis":{},"yaxes":[{"format":"percent (0.0-1.0)"}]}],"title":"GPU Overview"},"description":" ","name":"GPU","logo":"/assets/GPU.svg"},"Grafana":{"settings":{"datasource":"prometheus","panels":[],"title":"Grafana"},"name":"Grafana","description":" ","logo":"/assets/grafana.svg"},"Custom Monitoring":{"settings":{"datasource":"prometheus","panels":[],"title":"Custom Monitoring"},"name":"Custom","description":" ","logo":"/assets/prometheus.svg"}}')},function(e,a,r){"use strict";r(16);var n=r(19);r(98),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(27),r(98),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(997)),d=r(1060),p=n(r(899)),m=n(r(119)),h=n(r(26)),v=n(r(68)),E=n(r(196)),y=n(r(0)),g=n(r(2562)),b=n(r(2563)),S=n(r(2567)),_=n(r(2571));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var C=function(e){(0,o.default)(r,e);var a=O(r);function r(e){var n;return(0,l.default)(this,r),(n=a.call(this,e)).minCountRef=y.default.createRef(),n.onShowAddTrigger=function(){n.setState({visible:!0,currentTrigger:{},currentTriggerIndex:void 0})},n.onShowEdit=function(e,t){n.setState({visible:!0,currentTrigger:e,currentTriggerIndex:t})},n.resetState=function(){n.setState({visible:!1,currentTrigger:{},currentTriggerIndex:void 0})},n.handleFallback=function(e){if(e){(0,v.default)(n.props.formTemplate,"spec.fallback",{failureThreshold:3,replicas:6})}else(0,E.default)(n.props.formTemplate,"spec.fallback");n.setState({fallback:e})},n.onSave=function(e){var t=n.state.currentTriggerIndex,a=(0,h.default)(n.props.formTemplate,"spec.triggers",[]);void 0!==t?a[t]=e:a.push(e),(0,v.default)(n.props.formTemplate,"spec.triggers",a),n.setState({visible:!1,currentTrigger:{},currentTriggerIndex:void 0,shouldValidate:n.state.shouldValidate+1})},n.validator=function(e,a,r){a||!(0,h.default)(n.props.formTemplate,"spec.triggers",[]).some((function(e){return"prometheus"===e.type}))?(a&&a>(0,h.default)(n.props.formTemplate,"spec.maxReplicaCount",0)&&r(t("MIN_REPLICA_COUNT_LESS_THAN_MAX")),r()):r(t("PROMETHEUS_MIN_REPLICA_COUNT_DESC"))},n.state={visible:!1,currentTriggerIndex:void 0,currentTrigger:{},fallback:!!(0,h.default)(e.formTemplate,"spec.fallback"),shouldValidate:0},n}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e,t){var a;t.shouldValidate!==this.state.shouldValidate&&(null===(a=this.minCountRef.current)||void 0===a||a.validate({"spec.minReplicaCount":(0,h.default)(this.props.formTemplate,"spec.minReplicaCount")}))}},{key:"render",value:function(){var e=this,a=this.props,r=a.formRef,n=a.formTemplate,l=this.state,u=l.visible,o=l.currentTrigger;return u?y.default.createElement(S.default,{trigger:(0,m.default)(o),onCancel:this.resetState,onSave:this.onSave}):y.default.createElement(i.Form,{data:n,ref:r},y.default.createElement(i.Columns,null,y.default.createElement(i.Column,null,y.default.createElement(i.Form.Item,{ref:this.minCountRef,label:t("MINIMUM_REPLICAS"),desc:t("SCALE_MINIMUM_REPLICAS_DESC"),rules:[{validator:this.validator}]},y.default.createElement(d.NumberInput,{name:"spec.minReplicaCount",integer:!0,min:0}))),y.default.createElement(i.Column,null,y.default.createElement(i.Form.Item,{label:t("MAXIMUM_REPLICAS"),desc:t("SCALE_MAXIMUM_REPLICAS_DESC")},y.default.createElement(d.NumberInput,{name:"spec.maxReplicaCount",integer:!0,min:0})))),y.default.createElement(i.Columns,null,y.default.createElement(i.Column,null,y.default.createElement(i.Form.Item,{label:t("POLLING_INTERVAL"),desc:t("POLLING_INTERVAL_DESC")},y.default.createElement(d.TimeUnitInput,{name:"spec.pollingInterval",integer:!0,min:0}))),y.default.createElement(i.Column,null,y.default.createElement(i.Form.Item,{label:t("WAITING_TIME"),desc:t("WAITING_TIME_DESC")},y.default.createElement(d.TimeUnitInput,{name:"spec.cooldownPeriod",integer:!0,min:0})))),y.default.createElement(i.Form.Group,{label:t("ROLL_BACK"),desc:t("SCALE_ROLL_BACK_DESC"),checkable:!0,onChange:this.handleFallback,key:this.state.fallback},y.default.createElement("div",{className:"padding-12"},y.default.createElement(i.Columns,null,y.default.createElement(i.Column,null,y.default.createElement(i.Form.Item,{label:t("FAILURE_THRESHOLD"),desc:t("SCALE_FAILURE_THRESHOLD_DESC"),rules:[{required:this.state.fallback,message:t("EMPTY_FAILURE_THRESHOLD")}]},y.default.createElement(d.NumberInput,{name:"spec.fallback.failureThreshold",integer:!0,min:0}))),y.default.createElement(i.Column,null,y.default.createElement(i.Form.Item,{label:t("FALLBACK_NUMBER"),desc:t("FALLBACK_NUMBER_DESC"),rules:[{required:this.state.fallback,message:t("EMPTY_FALLBACK_NUMBER_DESC")}]},y.default.createElement(d.NumberInput,{name:"spec.fallback.replicas",integer:!0,min:0})))))),y.default.createElement("div",{className:g.default.triggerWrapper},y.default.createElement("div",{className:g.default.title},t("TRIGGER_SETTING")),y.default.createElement("div",{className:g.default.desc},t("TRIGGER_SETTING_DESC")),y.default.createElement(i.Form.Item,null,y.default.createElement(_.default,{name:"spec.triggers",onShowTrigger:this.onShowAddTrigger,onShowEdit:this.onShowEdit,onCancel:this.resetState,onChange:function(t){(0,v.default)(n,"spec.triggers",t),e.setState({shouldValidate:e.state.shouldValidate+1})}}))),y.default.createElement(p.default,{className:g.default.advanced},y.default.createElement("div",{className:g.default.checkableText},y.default.createElement(i.Form.Item,null,y.default.createElement(f.default,{name:"spec.advanced.restoreToOriginalReplicaCount",title:t("RESTORE_TO_ORIGINAL_REPLICA_COUNT"),description:t("RESTORE_TO_ORIGINAL_REPLICA_COUNT_DESC")}))),y.default.createElement(i.Form.Group,{label:t("SCALE_BEHAVIOR"),desc:t("SCALE_BEHAVIOR_DESC"),keepDataWhenUnCheck:!0,checkable:!0},y.default.createElement(b.default,{type:"scaleUp",prefix:"spec.advanced.horizontalPodAutoscalerConfig.behavior.scaleUp"}),y.default.createElement(b.default,{type:"scaleDown",prefix:"spec.advanced.horizontalPodAutoscalerConfig.behavior.scaleDown"}))))}}]),r}(y.default.Component);a.default=C},,,function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(30),a(11),a(69),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(30),a(11),a(69);var n=r(a(97)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(189),d=a(61),p=r(a(2552));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(a,e);var t=m(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,u=new Array(r),o=0;o<r;o++)u[o]=arguments[o];return(e=t.call.apply(t,[this].concat(u))).handleInputChange=function(t,a){var r=(a=a.toLowerCase()).match(d.SCHEME_REG)||[],l=(0,n.default)(r,4),u=l[1],o=void 0===u?e.schemeValue:u,c=l[3],s=void 0===c?"":c;e.props.onChange("".concat(o).concat(s))},e.handleSchemeChange=function(t){e.props.onChange("".concat(t).concat(e.inputValue))},e}return(0,u.default)(a,[{key:"render",value:function(){return i.default.createElement("div",{className:p.default.container},i.default.createElement(f.Select,{value:this.schemeValue,className:p.default.select,options:d.SCHEME_OPTIONS,onChange:this.handleSchemeChange}),i.default.createElement(f.Input,{className:p.default.input,onChange:this.handleInputChange,value:this.inputValue,autoComplete:"off"}))}},{key:"inputValue",get:function(){var e=this.props.value.match(d.SCHEME_REG)||[],t=(0,n.default)(e,4)[3];return void 0===t?"":t}},{key:"schemeValue",get:function(){var e=this.props.value.match(d.SCHEME_REG)||[],t=(0,n.default)(e,2)[1];return void 0===t?"https://":t}}]),a}(i.default.Component);t.default=h,h.defaultProps={className:"",value:"",onChange:function(){}}},function(e,t,a){e.exports={filterInput:"_1MAMYv0UrOlESlnzVfu722",autosuggest:"F1O1y45zwuVzWE1dlw2Gd",autosuggestInput:"_3fF_SwZ-22BGOTCZ-kjnjq","form-item":"_3YZtMb8CsU0LUi7NvmB1RK","error-item":"_3vxyKMkvbZdJrwkvPrScKl"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(1)),m=n(r(5)),h=r(189),v=n(r(2558));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var y=function(e){(0,s.default)(r,e);var a=E(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={inputValue:e.props.value||e.props.defaultValue,userEmail:globals.user.email},e.handleInputChange=function(t){var a,r,n=null!==(a=null==t||null===(r=t.target)||void 0===r?void 0:r.value)&&void 0!==a?a:t;e.setState({inputValue:n}),e.props.onChange&&e.props.onChange(n)},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.className,n=(a.onChange,a.showIcon),o=(0,u.default)(a,["className","onChange","showIcon"]),c=this.props.inputValue;return d.default.createElement("div",{className:(0,m.default)(v.default.extraBox,r,{"input-padding-right-30":n})},d.default.createElement(h.Input,(0,l.default)({value:c},o,{onChange:this.handleInputChange})),n&&d.default.createElement(h.Tooltip,{content:t("ADD_CURRENT_USER"),modifiers:{preventOverflow:{enabled:!1}}},d.default.createElement(h.Icon,{className:v.default.IconBox,name:"link",onClick:function(){return e.handleInputChange(e.state.userEmail)}})))}}]),r}(d.default.Component);a.default=y,y.propTypes={showIcon:p.default.bool},y.defaultProps={showIcon:!1}},function(e,t,a){e.exports={card:"_2OMNiqGgcmhtrdbU8imCvj",action:"_2_wMN8F5TCW7GW6joHCSz_"}},function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(44),a(6),a(20),a(14),a(24),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(44),a(6),a(121),a(20),a(27),a(29),a(14),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(7);var n=r(a(38)),l=r(a(58)),u=r(a(31)),o=r(a(50));a(35);var c,s,i,f,d,p,m,h=r(a(39)),v=r(a(62)),E=r(a(25)),y=r(a(28)),g=r(a(74)),b=r(a(41)),S=r(a(42)),_=r(a(37)),O=r(a(45)),C=(r(a(63)),r(a(140))),T=r(a(67)),R=r(a(201)),D=r(a(26)),k=a(17),N=r(a(49)),I=a(56);function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,_.default)(e);if(t){var n=(0,_.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,S.default)(this,a)}}var L=(c=function(e){(0,b.default)(k,e);var t,a,r,u,c,S,_,O=w(k);function k(){var e;(0,E.default)(this,k);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=O.call.apply(O,[this].concat(a))).module="cds",(0,v.default)(e,"list",s,(0,g.default)(e)),(0,v.default)(e,"clustersList",i,(0,g.default)(e)),(0,v.default)(e,"detail",f,(0,g.default)(e)),(0,v.default)(e,"syncResult",d,(0,g.default)(e)),(0,v.default)(e,"summary",p,(0,g.default)(e)),e.getListUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat(e.apiVersion).concat(e.getPath(t),"/applications").concat(t.dryRun?"?dryRun=All":"")},e.getResourceUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat(e.apiVersion).concat(e.getPath(t),"/applications")},e.getDetailUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat(e.getListUrl(t),"/").concat(t.name)},(0,v.default)(e,"setSelectRowKeys",m,(0,g.default)(e)),e}return(0,y.default)(k,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cluster,a=e.namespace,r=e.workspace,n=e.devops,l="";return t&&(l+="/klusters/".concat(t)),r&&(l+="/workspaces/".concat(r)),a&&(l+="/namespaces/".concat(a)),n&&(l+="/namespaces/".concat(n)),l}},{key:"fetchList",value:(_=(0,h.default)(n.default.mark((function e(){var t,a,r,u,c,s,i,f,d=this,p=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},a=t.devops,t.workspace,r=t.cluster,u=t.more,c=(0,o.default)(t,["devops","workspace","cluster","more"]),this.list.isLoading=!0,c.limit!==1/0&&-1!==c.limit||(c.limit=-1,c.page=1),c.limit=c.limit||10,s="".concat(this.getResourceUrl({namespace:a,cluster:r})),e.next=7,request.get(s,A({},c),{},(function(){return[]}));case 7:return i=e.sent,f=Array.isArray(i.items)?i.items.map((function(e){return A({},d.mapper(A(A({},e),{},{devops:a})))})):[],this.list.update(A(A({data:u?[].concat((0,l.default)(this.list.data),(0,l.default)(f)):f,total:i.totalItems||i.total_count||f.length||0},c),{},{limit:Number(c.limit)||10,page:Number(c.page)||1,isLoading:!1},this.list.silent?{}:{selectedRowKeys:[]})),e.abrupt("return",f);case 11:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"create",value:(S=(0,h.default)(n.default.mark((function e(t){var a,r,l,u,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,r=t.devops,l=t.cluster,u="".concat(this.getResourceUrl({namespace:r,cluster:l})),e.next=4,request.post(u,a);case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"updateSync",value:(c=(0,h.default)(n.default.mark((function e(t){var a,r,l,u,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,r=t.application,l=t.devops,u=t.cluster,o="".concat(this.getResourceUrl({namespace:l,cluster:u}),"/").concat(r,"/sync"),e.abrupt("return",this.submitting(request.post(o,a)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"update",value:(u=(0,h.default)(n.default.mark((function e(t,a){var r;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(this.getResourceUrl({namespace:t.devops,cluster:t.cluster}),"/").concat(a.metadata.name),e.abrupt("return",this.submitting(request.put(r,a)));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"patch",value:function(e,t){var a="".concat(this.getResourceUrl({namespace:e.devops,cluster:e.cluster}),"/").concat(t.metadata.name);return this.submitting(request.put(a,t))}},{key:"delete",value:function(e){var t=(0,C.default)(A(A({},e),{},{namespace:e.devops}),"devops");return this.submitting(request.delete("".concat(this.getDetailUrl(t)).concat(t.isRelated?"?cascade=true":"")))}},{key:"fetchDetail",value:(r=(0,h.default)(n.default.mark((function e(t){var a,r,l,u,o,c;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,r=t.isSilent,l=t.devops,u=t.cluster,r||(this.isLoading=!0),e.next=4,request.get("".concat(this.getResourceUrl({namespace:l,cluster:u}),"/").concat(a));case 4:return o=e.sent,c=this.mapper(A(A({},o),{},{devops:l})),this.detail=c,this.isLoading=!1,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getClustersList",value:(a=(0,h.default)(n.default.mark((function e(t){var a,r,l,u,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.apiVersion,"/clusters"),e.next=3,request.get(a,null,null,(function(){return[]}));case 3:if(r=e.sent,l="default",!globals.app.isMultiCluster){e.next=11;break}return e.next=8,request.get("kapis/tenant.kubesphere.io/v1beta1/clusters");case 8:u=e.sent,o=u.items.find((function(e){return(0,R.default)(e,'metadata.labels["cluster-role.kubesphere.io/host"]')})),l=(0,D.default)(o,"metadata.name",t||(0,I.getHostClusterName)());case 11:(0,T.default)(r)?this.clustersList=[{server:"https://kubernetes.default.svc",name:"in-cluster",label:l}]:this.clustersList=r.map((function(e){return A(A({},e),{},{label:"in-cluster"===e.name?l:e.name})})),globals.hostClusterName=l;case 13:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchStatusSummary",value:(t=(0,h.default)(n.default.mark((function e(t){var a,r,l,u;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.devops,r=t.cluster,l="".concat(this.apiVersion).concat(this.getPath({namespace:a,cluster:r}),"/application-summary"),e.next=4,request.get(l);case 4:u=e.sent,this.summary=u||{};case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),k}(N.default),s=(0,O.default)(c.prototype,"list",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",filters:{},isLoading:!1,selectedRowKeys:[]}}}),i=(0,O.default)(c.prototype,"clustersList",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=(0,O.default)(c.prototype,"detail",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),d=(0,O.default)(c.prototype,"syncResult",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,total:0,filters:{},isLoading:!1}}}),p=(0,O.default)(c.prototype,"summary",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),m=(0,O.default)(c.prototype,"setSelectRowKeys",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.list.selectedRowKeys=t}}}),(0,O.default)(c.prototype,"fetchList",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchList"),c.prototype),(0,O.default)(c.prototype,"create",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"create"),c.prototype),(0,O.default)(c.prototype,"updateSync",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"updateSync"),c.prototype),(0,O.default)(c.prototype,"update",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"update"),c.prototype),(0,O.default)(c.prototype,"patch",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"patch"),c.prototype),(0,O.default)(c.prototype,"delete",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"delete"),c.prototype),(0,O.default)(c.prototype,"fetchDetail",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchDetail"),c.prototype),(0,O.default)(c.prototype,"getClustersList",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"getClustersList"),c.prototype),(0,O.default)(c.prototype,"fetchStatusSummary",[k.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchStatusSummary"),c.prototype),c);t.default=L},function(e,t,a){e.exports={option:"_37Sc6Br1RJMiXP59t5p3P0"}},,function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(189),d=r(a(1339));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){return(0,l.default)(this,a),t.apply(this,arguments)}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.formTemplate,a=e.formRef,r=e.formProps,l=e.module,u=e.cluster,o=e.namespace;return i.default.createElement("div",{className:"margin-t12"},i.default.createElement(f.Form,(0,n.default)({data:t,ref:a},r),i.default.createElement(d.default,{formProps:r,data:t,module:l,cluster:u,namespace:o})))}}]),a}(i.default.Component);t.default=m},function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var n=r(a(317)),l=r(a(31)),u=r(a(25)),o=r(a(28)),c=r(a(74)),s=r(a(41)),i=r(a(42)),f=r(a(37)),d=r(a(0)),p=r(a(26)),m=r(a(67)),h=r(a(140)),v=a(189),E=r(a(900));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=function(e){(0,s.default)(a,e);var t=b(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).handleContainer=function(t){var a=e.props.formProps;E.default.prototype.handleContainer.call((0,c.default)(e),t),a.onChange()},e.handleSidecarContainer=function(t){var a=e.props.formProps;E.default.prototype.handleSidecarContainer.call((0,c.default)(e),t),a.onChange()},e}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formProps,r=e.isFederated,l=e.isEdit,u=this.state,o=u.showContainer,c=u.selectContainer,s=u.showSideCarContainer,i=r&&l?this.fedFormTemplate:this.formTemplate,f=JSON.parse((0,p.default)(i,'spec.template.metadata.annotations["kubesphere.io/imagepullsecrets"]',"{}"));if(o)return this.renderContainerForm(g(g({},c),{},{annotationOfImagePullSecrets:f}));(0,p.default)(i,"spec.template.spec.containers",[]).forEach((function(e){var t=g({},e),a=(0,p.default)(t,"resources.requests"),r=(0,m.default)(a)?null:(0,h.default)(a,["cpu","memory"]);if(!(0,m.default)(r)){var n=Object.keys(r)[0],l={type:n,value:r[n]};e.resources.gpu=l}}));var E=(0,p.default)(this.fedFormTemplate,"spec.template.metadata.labels",{});return s?this.renderInjectSidecarForm({spec:{template:{metadata:{labels:E}}}}):d.default.createElement(v.Form,(0,n.default)({data:i,ref:t},a),this.renderContainerList())}},{key:"formTemplate",get:function(){return this.props.formTemplate}}]),a}(E.default);t.default=S},function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(189),d=r(a(1146));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){return(0,l.default)(this,a),t.apply(this,arguments)}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.formTemplate,a=e.formRef,r=e.formProps,l=e.module,u=e.isFederated,o=e.isEdit;return i.default.createElement("div",{className:"margin-t12"},i.default.createElement(f.Form,(0,n.default)({data:t,ref:a},r),i.default.createElement(d.default,{module:l,data:t,isFederated:u,isEdit:o})))}}]),a}(i.default.Component);t.default=m},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(74)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=a(915);function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var f=function(e){(0,u.default)(a,e);var t=i(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,u=new Array(r),o=0;o<r;o++)u[o]=arguments[o];return(e=t.call.apply(t,[this].concat(u))).handleVolume=function(){for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];s.Component.prototype.handleVolume.apply((0,l.default)(e),a),e.props.formProps.onChange()},e.handleVolumeTemplate=function(){for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];s.Component.prototype.handleVolumeTemplate.apply((0,l.default)(e),a),e.props.formProps.onChange()},e.handleLogToggle=function(){s.Component.prototype.handleLogToggle.apply((0,l.default)(e)),e.props.formProps.onChange()},e}return a}(s.Component);t.default=f},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(189),p=n(r(1344));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(r,e);var a=m(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formTemplate,r=e.formRef,n=e.formProps,u=e.isFederated;return f.default.createElement("div",{className:"margin-t12"},f.default.createElement(d.Form,(0,l.default)({data:a,ref:r},n),f.default.createElement(d.Form.Group,{label:t("POD_GRACE_PERIOD"),desc:t("POD_GRACE_PERIOD_DESC"),keepDataWhenUnCheck:!0,checkable:!0},f.default.createElement(p.default,{isFederated:u}))))}}]),r}(f.default.Component);a.default=h},function(e,t,a){e.exports={modalBody:"_3ooh-L6FH1heTE2W25ptXy",body:"_1baKVvR8wM2DfwvvD-CQS-",title:"_3EXz6wxYbQX9UTIbuE8ZWX",content:"_2RPgGxlrT4c_RbdEQcp480",results:"_3DvL6vqwfNBXYrsp_WXO7-",footer:"_2p963RzqYeHJquBZuiurFu",item:"_3mQ04Ri3duB-7QNjJrTMpb",menu:"iskifxbBA3n3yoiQmXRq2",avatar:"_1fNpt_vmHQYqlACN4TYie8"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=r(189),o=l(r(26)),c=l(r(67)),s=n(r(0)),i=l(r(1001)),f=r(56),d=r(61),p=l(r(2651)),m=function(e){var a=e.cluster,r=e.namespace,n=s.useMemo((function(){if(!globals.app.isMultiCluster)return!1;var e=(0,o.default)(globals,"clusterConfig.".concat(a,".ksVersion"));return(0,f.compareVersion)(e,"3.4.0")<0}),[a]),l=e.prefix||"spec.template.",m=s.useRef(new i.default("ippools")),h=(0,c.default)(e.data);return s.createElement(u.Form.Group,{label:h?t("ADD_EDGE_IPPOOL"):"",desc:h?t("ADD_EDGE_IPPOOL_DES"):"",checkable:h,keepDataWhenUnCheck:!0},s.createElement(p.default,{isOutdated:n,type:"array",cluster:a,namespace:r,name:"".concat(l,'metadata.annotations["cni.projectcalico.org/ipv4pools"]'),icon:d.ICON_TYPES[m.current.module],hideColumns:["workspace"],rootStore:e.rootStore,formTemplate:e.formTemplate,data:e.data,formProps:e.formProps}))};a.default=m},,,function(e,t,a){e.exports={body:"_3rLLKpT8IgpcqWhzTXPWzb",footer:"_1FN6kDx_4OYTrAeMzmz6lJ",nodes:"_2K0nFAD8XjT_-g3jP0gfYz",item:"_2szAjgdbfftm9dnv4On9sC",selected:"_4IuUl9x4GeLgtthhM3Cby",ring:"_2mjDKl7noCA52Dkwojasqj",name:"sgFMlcJBkaU6RLJu0NSHo",taints:"_3VFxaVUiKAEp4AZAT4_tG5"}},,,function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(109),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(87),r(98),r(14),r(8),r(13),r(9),r(4),r(30),r(71),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(3),r(10),r(6),r(70),r(121),r(36),r(66),r(20),r(27),r(87),r(98),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(30),r(71),r(7),r(40);var u=l(r(38));r(35);var o=l(r(50)),c=l(r(31)),s=l(r(39)),i=l(r(58)),f=l(r(97)),d=n(r(0)),p=r(189),m=l(r(5)),h=l(r(824)),v=l(r(805)),E=l(r(858)),y=l(r(861)),g=l(r(26)),b=l(r(2670)),S=l(r(244)),_=l(r(68)),O=l(r(443)),C=r(56),T=r(61),R=l(r(2671)),D=l(r(2673)),k=l(r(1448));function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var P=p.Tabs.TabPanel,A="__ALL__",w=function(e){var a=e.formRef,r=e.formTemplate,n=e.goBack,l=e.isOutdated,c=e.onFormChange,N=e.hideWorkspace,w=void 0!==N&&N,L="node_range";r.nodeSelectorLable&&(L="label_select"),r.nodeSelectorText&&(L="custom");var M=d.default.useState(!0),x=(0,f.default)(M,2),j=x[0],U=x[1],F=d.default.useState(L),V=(0,f.default)(F,2),G=V[0],B=V[1],z=d.default.useState(!1),Y=(0,f.default)(z,2),H=Y[0],q=Y[1],K=d.default.createRef(),W=d.default.useRef(new O.default),Q=d.default.useState(!0),J=(0,f.default)(Q,2),X=J[0],Z=J[1],$=W.current.list,ee=[{label:t("ALL"),value:A}].concat((0,i.default)($.data.map((function(e){return{label:(0,C.showNameAndAlias)(e),value:e.name}})))),te=function(e){return d.default.createElement("div",{className:k.default.option},d.default.createElement("p",{className:k.default.label},e.label),d.default.createElement("p",{className:k.default.description},e.description||"-"))};function ae(e){return re.apply(this,arguments)}function re(){return(re=(0,s.default)(u.default.mark((function t(a){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Z(!0),t.next=3,W.current.fetchList(I({cluster:e.cluster},a));case 3:Z(!1);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ne=function(e){(0,b.default)(e.spec,(function(e,t){(0,_.default)(r,t,e)})),(0,_.default)(r,"aliasName",(0,g.default)(e,'metadata.annotations["kubesphere.io/alias-name"]',"")),(0,_.default)(r,"description",(0,g.default)(e,'metadata.annotations["kubesphere.io/description"]',""))};(0,d.useEffect)((function(){ae()}),[]);var le=function(e){var t=e.name,a=e.aliasName,r=e.description;e.key;return{apiVersion:"crd.projectcalico.org/v1",kind:"IPPool",metadata:{name:t,annotations:{"kubesphere.io/description":r||"","kubesphere.io/alias-name":a||""}},spec:I({},(0,o.default)(e,["name","aliasName","description","key"]))}},ue=function(){var e,t,a;H?(r.nodeSelectorText=r.nodeSelector,r.nodeSelector="all()",r.natOutgoing=Boolean(r.natOutgoing),B("custom")):(r.nodeSelectorLable&&(r.nodeSelector=(t=r.nodeSelectorLable,a="",t.forEach((function(e){var t="",r="";switch(e.operator){case"NotIn":r=e.values.map((function(e){return'"'.concat(e,'"')})).join(","),t="".concat(e.key," not in {").concat(r,"}");break;case"In":r=e.values.map((function(e){return'"'.concat(e,'"')})).join(","),t="".concat(e.key," in {").concat(r,"}");break;case"Exists":t="has(".concat(e.key,")");break;case"DoesNotExist":t="!has(".concat(e.key,")")}a=a?"".concat(a," && ").concat(t):t})),a),delete r.nodeSelectorLable),r.nodeSelectorText&&(r.nodeSelector=r.nodeSelectorText.replace(/'/g,'"'),delete r.nodeSelectorText),U({obj:le((e=r,Array.isArray(e)?e.reduce((function(e,t){return I(I({},e),t)}),{}):e))})),q(!H)},oe=function(e){"node_range"===e&&(delete r.nodeSelectorLable,delete r.nodeSelectorText),"label_select"===e&&delete r.nodeSelectorText,"custom"===e&&delete r.nodeSelectorLable,B(e)},ce=function(e){var t=e.key&&e.operator;return t&&["In","NotIn"].includes(e.operator)&&(t=t&&e.values.length>0),"Match"===e.operator&&(t=t&&e.regexValue),t},se=function(e,a,r){return a?a.some((function(e){return!ce(e)}))?r({message:t("INVALID_NOTIFICATION_CONDITION")}):void r():r()};return d.default.createElement(p.Form,{ref:a,data:r,onChange:c,className:k.default.editForm},d.default.createElement(E.default,{className:k.default.switch,text:t("EDIT_YAML"),onChange:ue,checked:H}),d.default.createElement("div",{className:k.default.editContainer},d.default.createElement("div",null,d.default.createElement(p.Icon,{name:"return",size:20,className:"margin-r4",clickable:!!n,onClick:n}),d.default.createElement("span",{className:k.default.title},t("EDIT_POD_IP_POOL"))),H?d.default.createElement("div",{className:k.default.codeWrapper},d.default.createElement(y.default,{ref:K,value:j,returnType:"obj",onChange:ne})):d.default.createElement("div",{className:k.default.container},d.default.createElement("div",{className:(0,m.default)(k.default.card,k.default.editRow)},d.default.createElement(p.Form.Item,{label:t("NETWORK_SEGMENT"),rules:[{required:!0,message:t("ENTER_NETWORK_SEGMENT")}],desc:t("POD_IP_POOL_IP_RANGE")},d.default.createElement(p.Input,{name:"cidr"})),d.default.createElement(p.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:T.PATTERN_NAME,message:t("POD_IP_POOL_NAME_DESC")}],desc:t("POD_IP_POOL_NAME_DESC")},d.default.createElement(p.Input,{name:"name",maxLength:63})),d.default.createElement(p.Form.Item,{label:t("IPPOOL_BLOCK_SIZE"),desc:t("IP_POOL_BLOCK_SIZE_DESC")},d.default.createElement(v.default,{name:"blockSize",min:0,max:32})),!w&&d.default.createElement(p.Form.Item,{label:t("WORKSPACE"),desc:t("IPPOOL_ASSIGN_WORKSPACE_DESC")},d.default.createElement(p.Select,{name:"workspace",options:ee,pagination:(0,S.default)($,["page","total","limit"]),isLoading:X,onFetch:ae,searchable:!0,clearable:!0,placeholder:" "})),d.default.createElement(p.Form.Item,{label:t("NAT outgoing"),desc:t("NAT_OUTGOING_DESC")},d.default.createElement(p.Select,{options:[{label:t("OPEN"),value:!0},{label:t("CLOSE"),value:!1}],name:"natOutgoing",onChange:function(e){(0,_.default)(r,"natOutgoing",e)}})),d.default.createElement(p.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:T.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},d.default.createElement(p.Input,{maxLength:63,name:"aliasName"})),d.default.createElement(p.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},d.default.createElement(p.TextArea,{maxLength:256,name:"description"}))),d.default.createElement(p.Form.Group,{label:t("SELECT_NODES"),desc:t("SELECT_NODE_DES"),keepDataWhenUnCheck:!0,checkable:!0},d.default.createElement(p.Tabs,{type:"button",activeName:G,onChange:oe},d.default.createElement(P,{label:t("NODE_RANGE"),name:"node_range"},d.default.createElement(p.Form.Item,null,d.default.createElement(p.Select,{options:[{label:t("ALL"),value:"all()",description:t("SELECT_LABEL_ALL_RESOUCE")},{label:t("ALL_DISABLED"),value:"!all()",description:t("DISABLE_SELECT_NODE")}],name:"nodeSelector",optionRenderer:te,className:k.default.tabPanel}))),d.default.createElement(P,{label:t("LABEL_SELECT"),name:"label_select"},d.default.createElement(p.Form.Item,{label:t("LABEL"),rules:[{validator:se,checkOnSubmit:!0}]},d.default.createElement(h.default,{name:"nodeSelectorLable",itemType:"object",addText:t("ADD"),checkItemValid:ce,desc:d.default.createElement("div",{className:k.default.annotation},d.default.createElement(p.Icon,{name:"question"}),d.default.createElement("p",{className:k.default.desc},t.html("NOTIFICATION_CONDITION_SETTING_TIP")))},d.default.createElement(D.default,null)))),d.default.createElement(P,{label:t("CUSTOM"),name:"custom"},d.default.createElement(p.Form.Item,{label:t("EXPRESSION")},d.default.createElement(p.TextArea,{className:k.default.tabPanel,name:"nodeSelectorText",placeholder:'a in {"A", "B"} || a not in {"A", "B"} || has(A) || !has(A)'}))))),!l&&d.default.createElement(R.default,{value:(0,S.default)(r,["ipipMode","vxlanMode"]),onChange:function(e){var t=e.ipipMode,a=e.vxlanMode;(0,_.default)(r,"ipipMode",t),(0,_.default)(r,"vxlanMode",a)}}))))};a.default=w},function(e,t,a){e.exports={editContainer:"_2TTFcQ4vnnv51E8aVOlqFz",title:"_3PgCFKRywYHFJwJrJKxF3m",container:"_2fym1soTGH0nCcnJNCZACw",card:"_25qqt5BRSnexUkWmCPRQcM",listItem:"_1h6ZZgEGOGKQWEfx1sDpzn",action:"f7esabqGfBkJU8t1jqErp",workspace:"Mp4BNazHY5E22a2HDXjTP",edit:"_2CYvqg-lEuCoI3kTR9LSG_",info:"_29cU7cbTcEu9SKI99wmXj0",editRow:"_2MaigTYE6ndKSETELA5RYY",confirm:"_3DMLykQMW4cpIWefbESdUs",editForm:"osoVqI1mtNOROFTJFuHTq",switch:"_2cBLDmbg9s7yq1QtcE2ZnP",codeWrapper:"_2kpTK_dneC0klEnq214ET9",tabPanel:"fiprQmqMIUoOnRlM_XLHP",option:"_3A-tSaOoHgsRn0jXj7EHqh",label:"_2PaxwDrSSXY0bv-vsZ3gR-",description:"i8TRLE1iF7-TfKCpvwaFM",desc:"rVLbCCPYagcj54caTsfVJ"}},function(e,t,a){e.exports={panel_p:"Yqh06RmBoRyo4EPMas8bQ",panel_s:"dcZ_PAxGuga9-dQ_R2F21",list:"_2y3_DkkZyu00IzO_2f7K0T",sheader:"_3AiwhP8qwgUhqH8LPnE7h1",sbody:"_3IhxAI3DyVi9gF9OH56ieB",cidr:"_1i1AudKOZMc9YALrUQQS_w",cidr_desc:"_2Y96COk5j42afC8WBhITrx",rulerow:"_1n385-u3bi3R_AxmEjXF5f",copy:"GRzd1aYlLJjc7ladECAGF",cidrrow:"_2F6Vl_l7l7oBHC3-FteUB6",error:"_2Rv2uP_LWQnnpK8_zqJ6Q7",errColor:"_2hhhSXsdc04b-WXptqNUWF",addBtn:"k2fG1ygGy-TCFEvSpdn5L",title:"_3qqAkQa-lFclxQniJas3A6",disp:"_28E97ro-MMoMS8FI6jmtFg",dirCheck:"_1INyMtM5lz6S-84-U9Lo8i"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(192),r(10),r(199),r(70),r(20),r(87),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(10),r(199),r(70),r(20),r(87),r(29),r(446),r(4),r(18),r(43),r(11),r(73);var l=n(r(31)),u=n(r(58)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(1)),m=n(r(5)),h=n(r(26)),v=n(r(67)),E=n(r(163)),y=n(r(253)),g=r(189),b=n(r(2702)),S=n(r(1451));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var O=function(e){(0,s.default)(r,e);var a=_(r);function r(e){var n;return(0,o.default)(this,r),(n=a.call(this,e)).showKeyError=function(e){var t=e.index,a=e.message,r=(0,y.default)([].concat((0,u.default)(n.state.errorKeys),[t]));n.setState({errorKeys:r,errorMsg:a})},n.hideKeyError=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.index,a=t?n.state.errorKeys.filter((function(e){return e!==t})):[];n.setState({errorKeys:a,errorMsg:""})},n.handleAdd=function(){var e=n.props,t=e.value;(0,e.onChange)([].concat((0,u.default)(t),[n.defaultValue]),n.defaultValue)},n.handleChange=function(e,a){var r=n.props,l=r.value,o=r.onChange,c=(0,h.default)(a,"currentTarget.value",a),s=l.findIndex((function(e){return(0,v.default)(e.key)}));if(-1!==s)return n.showKeyError({index:s,message:t("EMPTY_KEY")}),!1;var i=n.commonKeys.includes(c.key);if(l.reduce((function(e,t){return e.key===t.key&&(i=!0),t})),i)return n.showKeyError({index:e,message:t("DUPLICATE_KEYS")}),!1;var f=[];(0,E.default)(l[e])?(f=(0,u.default)(l))[e]=c:f=l.map((function(t,a){return a===e?c:t})),n.hideKeyError({index:e}),o(f)},n.handleSelect=function(e){var t=n.props,a=t.value;(0,t.onSelect)(a[e],e)},n.handleDelete=function(e){var t=n.props,a=t.value,r=t.onChange;n.state.errorKeys.includes(e)&&n.hideKeyError({index:e}),r(a.filter((function(t,a){return a!==e})),a[e])},n.state={errorKeys:[],errorMsg:""},n}return(0,c.default)(r,[{key:"isAddEnable",value:function(){var e=this.props,t=e.value,a=e.checkItemValid,r=this.state.errorKeys;return a?t.every(a):(0,v.default)(r)&&t.every((function(e){return!(0,v.default)(e)}))}},{key:"renderItems",value:function(){var e=this,t=this.props,a=t.value,r=t.onSelect,n=this.state,u=n.errorKeys,o=n.errorMsg;return a.map((function(t,a){return d.default.createElement("div",{key:a,className:(0,m.default)(S.default.inputItem,(0,l.default)({},S.default.errorItem,u.includes(a)))},d.default.createElement(b.default,{value:t||e.defaultValue,disabled:!e.isAddEnable(),onChange:e.handleChange.bind(e,a),onSelect:r&&e.handleSelect.bind(e,a),onDelete:e.handleDelete.bind(e,a)}),d.default.createElement("div",{className:S.default.error},o))}))}},{key:"render",value:function(){var e=this.props.className;return d.default.createElement("div",{className:(0,m.default)(S.default.wrapper,e)},this.renderItems(),d.default.createElement("div",{className:"text-right"},d.default.createElement(g.Button,{className:S.default.add,onClick:this.handleAdd,disabled:!this.isAddEnable()},t("ADD"))))}},{key:"defaultValue",get:function(){return{}}},{key:"commonKeys",get:function(){return this.props.common.map((function(e){return e.key})).filter((function(e){return e}))}}]),r}(d.default.Component);a.default=O,O.propTypes={name:p.default.string,common:p.default.array,value:p.default.array,onChange:p.default.func,checkItemValid:p.default.func},O.defaultProps={name:"",common:[],value:[""],onChange:function(){}}},function(e,t,a){e.exports={wrapper:"_2hrn5wbxI2jsY7exfmVzFH",errorItem:"_31W58zIFRX1O9saFOI6x4I",error:"_30Sh5N4eWp_n22gaC2P3FM",inputItem:"_1yjzijgTlKOp64WGBuvfOo",item:"_3sooMgh3beAV1uQaOpmOxt",inputs:"_1JgwJ_WoRTYC6bT-3V58mE",tips:"_1F6_WzB42ymqfDdQg6zo6R",actions:"_1vi3GhIAi_AW1pstmvuD4z",add:"_26Yju3vipEPXQJKW_DGxxk"}},function(e,t,a){e.exports={body:"_3RwgPGeCeOOduMFEd44ASI",wrapper:"_1JCx9E2tplQfD8l57CrHIk",title:"_1KEovvXekDcG9tkMjMIWmy",subTitle:"_334hw3UpGJoftYa6r6Wb2g",content:"tre555QRya-kDb6XM4o21"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(70),r(36),r(20),r(4),r(18),r(11),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(70),r(36),r(20),r(29),r(4),r(18),r(43),r(30),r(195),r(11),r(40);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(67)),p=r(189),m=n(r(191)),h=n(r(1174)),v=r(878),E=r(61),y=n(r(2712));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var b=function(e){(0,c.default)(r,e);var a=g(r);function r(e){var n;return(0,u.default)(this,r),(n=a.call(this,e)).handleNameChange=function(e,t){n.setState({keyName:t})},n.handleAddItem=function(){var e=n.state,a=e.keyItems,r=e.keyName;E.PATTERN_TAG.test(r)?n.setState({keyItems:[].concat((0,l.default)(a),[{label:r,value:r}]),keyName:""}):m.default.error({content:t("PATTERN_TAG_INVALID_TIP")})},n.handleKeyChange=function(e){n.setState({key:e,values:[]},(function(){return n.handleChange()}))},n.handleOperatorChange=function(e){var t=n.state.values;["Exists","DoesNotExist"].includes(e)&&(t=void 0),"Match"===e&&(t=""),n.setState({operator:e,values:t},(function(){return n.handleChange()}))},n.handleValueChange=function(e){n.setState({values:e},(function(){return n.handleChange()}))},n.handleChange=function(){var e=n.state,t=e.key,a=e.operator,r=e.values,l=["Exists","DoesNotExist"].includes(a)?void 0:r||[],u={key:t,operator:a};l&&(u.values=l),"Match"===a&&(u.regexValue=r,delete u.values),n.props.onChange(u)},n.dorpdownRender=function(e){var t=n.state.keyName;return f.default.createElement("div",{className:y.default.optionsContainer},f.default.createElement("div",{className:y.default.optionsList},e),f.default.createElement("div",{className:y.default.customSelect},f.default.createElement(p.Input,{className:y.default.customInput,value:t,onChange:n.handleNameChange}),f.default.createElement("div",{className:y.default.iconWrapper,onClick:n.handleAddItem},f.default.createElement(p.Icon,{name:"add",type:"light",size:12}))))},n.state=n.getInitialData(),n}return(0,o.default)(r,[{key:"componentDidUpdate",value:function(e){if(e.value!==this.props.value){var t=this.props.value||{},a=t.key,r=void 0===a?"":a,n=t.operator,l=void 0===n?"":n,u=t.values,o=void 0===u?[]:u,c=t.regexValue;this.setState({values:c||o,key:r,operator:l})}}},{key:"getInitialData",value:function(){var e=this.props.value||{},t=e.key,a=e.operator,r=e.values,n=e.regexValue;return{key:t,operator:a,values:n||r,keyName:"",keyItems:t&&(0,d.default)(this.keys.find((function(e){return e.value===t})))?[].concat((0,l.default)(this.keys),[{label:t,value:t}]):(0,l.default)(this.keys)}}},{key:"renderValues",value:function(){var e=this,a=this.state,r=a.key,n=a.operator,l=a.values;return"Exists"===n||"DoesNotExist"===n?null:"Match"===n?f.default.createElement("div",null,f.default.createElement(p.Input,{name:"regexValue",value:l,onChange:function(t,a){return e.handleValueChange(a)},placeholder:t("VALUES")})):"severity"===r?f.default.createElement(p.Select,{name:"values",value:l,options:this.severities,multi:!0,onChange:this.handleValueChange,placeholder:t("VALUES")}):f.default.createElement(h.default,{name:"values",placeholder:t("VALUES"),value:l,onChange:this.handleValueChange})}},{key:"render",value:function(){var e=this.state,a=e.key,r=e.operator,n=e.keyItems;return f.default.createElement("div",{className:y.default.selectWrapper},f.default.createElement(p.Select,{name:"key",value:a,options:n,placeholder:t("KEY"),onChange:this.handleKeyChange,dorpdownRender:this.dorpdownRender}),f.default.createElement(p.Select,{name:"operator",value:r,options:this.operators,onChange:this.handleOperatorChange,placeholder:t("CONDITION_OPERATOR")}),this.renderValues())}},{key:"keys",get:function(){return[{label:t("ALERTING_NAME"),value:"alertname"},{label:t("ALERTING_SEVERITY"),value:"severity"},{label:t("CLUSTER"),value:"cluster"},{label:t("PROJECT"),value:"namespace"},{label:t("POD"),value:"pod"},{label:t("CONTAINER"),value:"container"}]}},{key:"operators",get:function(){return[{label:t("CONTAIN"),value:"In"},{label:t("NOT_CONTAIN"),value:"NotIn"},{label:t("EXIST"),value:"Exists"},{label:t("NOT_EXIST"),value:"DoesNotExist"},{label:t("REGEX_MATCH"),value:"Match"}]}},{key:"severities",get:function(){return v.SEVERITY_LEVEL.map((function(e){return{label:t(e.label),value:e.value,level:e}}))}}]),r}(f.default.Component);a.default=b},function(e,t,a){e.exports={title:"Bq_DxvwoIbzNgUSGKKu74",urlInput:"_2iZy25kg8Y2xv_sPplOguB",row:"hJoducYzaKZSPuoAyXEF2",item:"_3Ut4KGvHM3y-EKah95yER_",wrapper:"_1y_QA9-eVFRkSPgVLTD4wj",listWrapper:"_2nnbmvgr5xxxdGUFDz24co",listItem:"_3QzQe3Rj1Hb6gV7rN2TR6t",annotation:"_1T2F7a_9lb3gfvILxQLV-b",desc:"_1oKV-aygbwGohZMHFzZVge"}},function(e,t,a){e.exports={title:"IKj2QMOz04C12iP1VFDNL",subTitle:"_3K5t_PpqMH_7kKHPzcLCco",row:"ChmNt1kcK1XD-oKuGaup5",wrapper:"Z0KFimX54l9rVcMJUe3wp",item:"_1s7eK7cotVqGxPePQ3rUw7",boxWrapper:"_3AstjCLI3Fv8pmh3KAOBP8",empty:"_1W7NXKcHzz0De9UuYrjWm",tag:"_1Sx0_dd2bUpcOt6bBuHbQH"}},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.app,r=e.iconSize,n=void 0===r?20:r,s=e.isShowTip,i=void 0===s||s,f=(0,o.isAppIsRadonDBAndAuthorized)(a),d=f.isRadondb,p=f.isSupport;if(d){var m=p?{primary:"#fff",secondary:"#55BC8A"}:{primary:"#fff",secondary:"#CCD3DB"};return l.default.createElement("div",{className:c.default.content},l.default.createElement(u.Tooltip,{content:i?p?l.default.createElement("div",{className:c.default.authorizedTip},l.default.createElement("div",{className:c.default.authorizedTipTitle},l.default.createElement(u.Icon,{name:"success",color:{primary:"#fff",secondary:"#55BC8A"}}),l.default.createElement("span",null,t("APP_AUTHORIZED")))):l.default.createElement("div",{className:c.default.authorizedTip},l.default.createElement("div",{className:c.default.authorizedTipTitle},l.default.createElement(u.Icon,{name:"information",color:{primary:"#fff",secondary:"#F5A623"}}),l.default.createElement("span",null,t("APP_UNAUTHORIZED")))):""},l.default.createElement(u.Icon,{name:"certification",size:n,color:m})))}return null};var l=n(r(0)),u=r(189),o=r(56),c=n(r(2735))},,function(e,a,r){"use strict";r(16);var n=r(19);r(66),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(66),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(5)),p=n(r(26)),m=n(r(67)),h=n(r(245)),v=r(56),E=r(873),y=n(r(2743));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var b=function(e){(0,o.default)(r,e);var a=g(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.className,r=e.app,n=(0,v.safeParseJSON)((0,p.default)(r,"latest_app_version.maintainers",[]),[]).map((function(e){return e.name})),l=(0,v.safeParseJSON)((0,p.default)(r,"latest_app_version.sources",[]),[]);return i.default.createElement("div",{className:(0,d.default)(y.default.appBase,a)},i.default.createElement("h3",null,t("BASIC_INFORMATION")),i.default.createElement("dl",null,i.default.createElement("dt",null,t("CATEGORY_COLON")),i.default.createElement("dd",null,(0,E.getAppCategoryNames)((0,p.default)(r,"category_set",[]))),i.default.createElement("dt",null,t("HOMEPAGE_COLON")),i.default.createElement("dd",null,r.home||"-"),i.default.createElement("dt",null,t("RELEASE_DATE_COLON")),i.default.createElement("dd",null,(0,h.default)(r.status_time).format("YYYY-MM-DD")),i.default.createElement("dt",null,t("APP_ID_COLON")),i.default.createElement("dd",null,r.app_id||"-"),!(0,m.default)(n)&&i.default.createElement(i.default.Fragment,null,i.default.createElement("dt",null,t("MAINTAINER_COLON")),i.default.createElement("dd",null,n.join("、"))),!(0,m.default)(l)&&i.default.createElement(i.default.Fragment,null,i.default.createElement("dt",null,t("SOURCE_CODE_ADDRESS_COLON")),i.default.createElement("dd",null,l.map((function(e){return i.default.createElement("p",null,e)}))))))}}]),r}(i.default.PureComponent);a.default=b,b.propTypes={className:f.default.string,app:f.default.object.isRequired},b.defaultProps={app:{}}},,,function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(320),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(320),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(73),r(7);var l=n(r(317)),u=n(r(38)),o=n(r(31));r(35);var c,s,i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(45)),E=r(189),y=n(r(800)),g=r(815),b=n(r(26)),S=n(r(244)),_=r(17),O=r(243),C=n(r(0)),T=r(56),R=r(873),D=r(61),k=n(r(2786)),N=n(r(2787));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var w=(0,O.observer)((s=function(e){(0,p.default)(r,e);var a=A(r);function r(){var e;(0,f.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).versionOptionRender=function(a){var r=a.label,n=a.value;return C.default.createElement("span",{style:{display:"flex",alignItem:"center"}},r,"  ",n===e.latestVersion&&C.default.createElement(E.Tag,{type:"warning"},t("LATEST_VERSION_SCAP")))},e.fetchVersions=(0,i.default)(u.default.mark((function t(){var a,r,n,l,o,c=arguments;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>0&&void 0!==c[0]?c[0]:{},r=e.props,n=r.appId,l=r.versionStore,o=r.fromStore,t.abrupt("return",l.fetchList(P(P({},a),{},{app_id:n,status:o?"active":void 0})));case 3:case"end":return t.stop()}}),t)}))),e.handleVersionChange=function(t){e.props.fileStore.fetch({version_id:t})},e}return(0,d.default)(r,[{key:"renderStaticPlacement",value:function(){var e=this.props,a=e.cluster,r=e.namespace,n=e.workspace;return C.default.createElement("div",{className:k.default.placementWrapper},C.default.createElement("div",{className:k.default.placementContent},C.default.createElement(y.default,{title:(0,T.showNameAndAlias)(n,"workspace"),description:t("WORKSPACE")}),C.default.createElement(y.default,{title:(0,T.showNameAndAlias)(a,"cluster"),description:t("CLUSTER")}),C.default.createElement(y.default,{icon:"project",title:(0,T.showNameAndAlias)(r,"project"),description:t("PROJECT")})))}},{key:"render",value:function(){var e=this.props,a=e.formData,r=e.formRef,n=e.namespace,u=e.versionStore;return C.default.createElement("div",{className:k.default.wrapper},C.default.createElement(E.Form,{data:a,ref:r},C.default.createElement("div",{className:k.default.title},t("BASIC_INFORMATION")),C.default.createElement(E.Columns,null,C.default.createElement(E.Column,null,C.default.createElement(E.Form.Item,{label:t("NAME"),desc:t("CLUSTER_NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:D.PATTERN_SERVICE_NAME,message:t("CLUSTER_NAME_DESC")}]},C.default.createElement(E.Input,{name:"name",maxLength:32}))),C.default.createElement(E.Column,null,C.default.createElement(E.Form.Item,{label:t("VERSION"),rules:[{required:!0,message:t("VERSION_EMPTY_DESC")}]},C.default.createElement(E.Select,{name:"version_id",options:this.sortedVersions,placeholder:" ",pagination:(0,S.default)(u.list,["page","limit","total"]),isLoading:u.list.isLoading,onFetch:this.fetchVersions,onChange:this.handleVersionChange,optionRenderer:this.versionOptionRender,valueRenderer:this.versionOptionRender})))),C.default.createElement(E.Columns,null,C.default.createElement(E.Column,null,C.default.createElement(E.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},C.default.createElement(E.TextArea,{name:"description",maxLength:256}))),C.default.createElement(E.Column,null)),C.default.createElement("br",null),C.default.createElement("div",{className:k.default.title},t("LOCATION")),C.default.createElement("div",{className:k.default.placement},n?this.renderStaticPlacement():C.default.createElement(E.Form.Item,{rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")}]},C.default.createElement(N.default,(0,l.default)({name:"namespace"},this.props))))))}},{key:"sortedVersions",get:function(){var e=this.props.appId,t=g.RadonDBAppIds.includes(e);return this.props.versionStore.list.data.map((function(e){return{label:e.name,value:t?e.name:e.version_id}})).sort((function(e,t){return(0,R.compareVersion)(t.name,e.name)}))}},{key:"latestVersion",get:function(){return(0,b.default)(this.sortedVersions,"[0].value","")}}]),r}(C.default.Component),(0,v.default)(s.prototype,"sortedVersions",[_.computed],Object.getOwnPropertyDescriptor(s.prototype,"sortedVersions"),s.prototype),(0,v.default)(s.prototype,"latestVersion",[_.computed],Object.getOwnPropertyDescriptor(s.prototype,"latestVersion"),s.prototype),c=s))||c;a.default=w},,,,function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(70),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(20),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var l=n(r(38));r(35);var u,o,c,s=n(r(39)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=r(189),v=n(r(805)),E=n(r(26)),y=n(r(67)),g=n(r(68)),b=r(243),S=n(r(0)),_=n(r(1009)),O=n(r(1408)),C=r(56),T=r(61),R=n(r(2860)),D=n(r(2862)),k=n(r(2864));function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var I=(0,b.observer)((c=o=function(e){(0,d.default)(r,e);var a=N(r);function r(e){var n;return(0,i.default)(this,r),(n=a.call(this,e)).handleChange=function(e){return function(t){var a=n.props.formTemplate;(0,g.default)(a,e,t),n.forceUpdate()}},n.removeCronError=function(){n.state.cronMessage&&n.setState({cronMessage:{}})},n.checkCronScript=function(){var e=(0,s.default)(l.default.mark((function e(a,r,u){var o,c,s,i,f,d,p,m,h;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.props,c=o.formTemplate,s=o.type,i=c.name,f=c.cluster,d=c.devops,p=r,e.next=5,n.scmStore.checkCronScript({devops:d,script:p,cluster:f,pipeline:"create"===s?void 0:i});case 5:if("error"!==(m=e.sent).result){e.next=10;break}return n.setState({cronMessage:{error:m.message}},(function(){})),u(m.message),e.abrupt("return");case 10:"ok"===m.result&&(h=t("PIPELINE_CRON_DESC",{nextTime:(0,C.getLocalTime)(m.nextTime).format("YYYY-MM-DD HH:mm:ss")}),n.setState({cronMessage:{message:h}}),u());case 11:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),n.handleScrollToBottom=function(){var e=n.props.formTemplate,t=e.devopsName,a=e.cluster,r=e.devops,l=n.pipelineStore.list,u=l.total,o=l.page;u<=l.limit*o||n.pipelineStore.fetchList({devopsName:t,cluster:a,devops:r,filter:"no-folders",page:o+1})},n.renderDisCarder=function(){var e=n.props.formTemplate,a=(0,E.default)(e,"multi_branch_pipeline");if(e.enable_discarder)return(0,y.default)(a)?S.default.createElement("div",{className:k.default.wrapper},S.default.createElement(h.Columns,null,S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("BUILD_RECORD_RETENTION_PERIOD_DAYS"),desc:t("BUILD_RECORD_RETENTION_PERIOD_DAYS_DESC"),rules:[{pattern:/^(?!0)\d+$/,message:t("BUILD_RECORD_RETENTION_PERIOD_DAYS_INVALID_TIP")}]},S.default.createElement(h.Input,{name:"".concat(n.prefix,".discarder.days_to_keep"),defaultValue:"7"}))),S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("MAXIMUM_BUILD_RECORDS"),desc:t("MAXIMUM_BUILD_RECORDS_DESC"),rules:[{pattern:/^(?!0)\d+$/,message:t("MAXIMUM_BUILD_RECORDS_INVALID_TIP")}]},S.default.createElement(h.Input,{name:"".concat(n.prefix,".discarder.num_to_keep"),defaultValue:"10"}))))):S.default.createElement("div",{className:k.default.wrapper},S.default.createElement(h.Columns,null,S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("BRANCH_RETENTION_PERIOD_DAYS"),desc:t("BRANCH_RETENTION_PERIOD_DAYS_DESC"),rules:[{pattern:/^(?!0)\d+$/,message:t("BUILD_RECORD_RETENTION_PERIOD_DAYS_INVALID_TIP")}]},S.default.createElement(h.Input,{name:"".concat(n.prefix,".discarder.days_to_keep"),defaultValue:"7"}))),S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("MAXIMUM_BRANCHES"),desc:t("MAXIMUM_BRANCHES_DESC"),rules:[{pattern:/^(?!0)\d+$/,message:t("MAXIMUM_BUILD_RECORDS_INVALID_TIP")}]},S.default.createElement(h.Input,{name:"".concat(n.prefix,".discarder.num_to_keep"),defaultValue:"5"})))))},n.scmStore=new O.default,n.pipelineStore=new _.default,n.state={cronMessage:{}},n}return(0,f.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.formTemplate,t=e.devopsName,a=e.cluster,r=e.devops;this.pipelineStore.fetchList({devopsName:t,devops:r,cluster:a,filter:"no-folders"})}},{key:"renderTip",value:function(e){return S.default.createElement(h.Tooltip,{content:e,placement:"right"},S.default.createElement(h.Icon,{name:"question",className:"margin-l12"}))}},{key:"renderNoSource",value:function(){var e=this.props.formTemplate,a=(0,E.default)(e,"enable_timer_trigger"),r=t.html("PIPELINE_SCHEDULE_DESC");return S.default.createElement("div",null,S.default.createElement(h.Form.Item,{desc:t("NO_CONCURRENT_BUILD_DESC")},S.default.createElement(h.Checkbox,{name:"".concat(this.prefix,".disable_concurrent"),checked:(0,E.default)(e,"".concat(this.prefix,".disable_concurrent")),onChange:this.handleChange("".concat(this.prefix,".disable_concurrent"))},t("NO_CONCURRENT_BUILDS"))),S.default.createElement("div",{className:"h6"},S.default.createElement(S.default.Fragment,null,t("BUILD_PARAMETERS"),this.renderTip(t("BUILD_PARAMETERS_TIP")))),S.default.createElement(D.default,{name:"".concat(this.prefix,".parameters"),formTemplate:this.props.formTemplate}),S.default.createElement("div",{className:"h6"},t("BUILD_TRIGGER")),S.default.createElement(h.Form.Item,null,S.default.createElement(h.Checkbox,{name:"enable_timer_trigger",checked:a,onChange:this.handleChange("enable_timer_trigger")},t("BUILD_PERIODICALLY"),this.renderTip(t("BUILD_PERIODICALLY_TIP")))),a&&S.default.createElement("div",{className:k.default.wrapper},S.default.createElement(h.Columns,null,S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("SCHEDULE"),desc:this.state.cronMessage.message||(0,C.learnMoreTip)(r),tip:t("tips_timer_trigger"),rules:[{validator:this.checkCronScript}]},S.default.createElement(h.Input,{name:"".concat(this.prefix,".timer_trigger.cron"),placeholder:" ",onChange:this.removeCronError}))))))}},{key:"renderGitOptions",value:function(){var e=this.props.formTemplate,a="".concat(this.scmPrefix,".git_clone_option.shallow"),r=(0,E.default)(e,a);return S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{className:"h6"},t("CLONE_SETTINGS")),S.default.createElement(h.Form.Item,null,S.default.createElement(h.Checkbox,{checked:r,name:a,onChange:this.handleChange(a)},t("ENABLE_SHALLOW_CLONE"))),r&&S.default.createElement("div",{className:k.default.wrapper},S.default.createElement(h.Columns,null,S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("CLONE_DEPTH")},S.default.createElement(v.default,{name:"".concat(this.scmPrefix,".git_clone_option.depth"),defaultValue:1}))),S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("CLONE_TIMEOUT_PERIOD")},S.default.createElement(v.default,{name:"".concat(this.scmPrefix,".git_clone_option.timeout"),defaultValue:20}))))),S.default.createElement("div",{className:"h6"},"Webhook"),S.default.createElement(h.Form.Item,{label:t("WEBHOOK_PUSH_URL"),desc:t("WEBHOOK_PUSH_DESC")},S.default.createElement("div",{className:"disabled-input"},this.webhookUrl)))}},{key:"renderRegFilter",value:function(){var e=this.props.formTemplate.enable_regex_filter;return S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{className:"h6"},t("FILTER_BY_REGEX")),S.default.createElement(h.Form.Item,null,S.default.createElement(h.Checkbox,{checked:e,name:"enable_regex_filter",onChange:this.handleChange("enable_regex_filter")},t("FILTER_BY_REGEX_DESC"))),e&&S.default.createElement("div",{className:k.default.wrapper},S.default.createElement(h.Form.Item,{label:t("REGEX")},S.default.createElement(h.Input,{name:"".concat(this.scmPrefix,".regex_filter"),defaultValue:".*"}))))}},{key:"renderWithSource",value:function(){var e=this.props.formTemplate,a=(0,E.default)(e,"multi_branch_pipeline.source_type",""),r=e.enable_timer_trigger,n=e.enable_multibranch_job_trigger,l=this.pipelineStore.list.isLoading,u=["git","github","bitbucket_server"].includes(a),o=["git","github","bitbucket_server","gitlab"].includes(a);return S.default.createElement("div",null,"git"!==a&&"svn"!==a?S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{className:"h6"},t("STRATEGY_SETTINGS")),S.default.createElement("div",{className:k.default.wrapper},S.default.createElement(h.Form.Item,null,S.default.createElement(R.default,{sourceType:a,name:"multi_branch_pipeline.".concat(a,"_source")})))):null,o?this.renderRegFilter():null,S.default.createElement("div",{className:"h6"},t("SCRIPT_PATH")),S.default.createElement(h.Form.Item,{label:t("PATH"),desc:t("SCRIPT_PATH_DESC")},S.default.createElement(h.Input,{name:"".concat(this.prefix,".script_path"),defaultValue:"Jenkinsfile"})),S.default.createElement("div",{className:"h6"},t("SCAN_TRIGGER")),S.default.createElement(h.Form.Item,null,S.default.createElement(h.Checkbox,{checked:r,name:"enable_timer_trigger",onChange:this.handleChange("enable_timer_trigger")},t("SCAN_PERIODICALLY"),this.renderTip(t("TIME_TRIGGER_DESC")))),r&&S.default.createElement("div",{className:k.default.wrapper},S.default.createElement(h.Form.Item,{label:t("SCAN_INTERVAL")},S.default.createElement(h.Select,{name:"".concat(this.prefix,".timer_trigger.interval"),options:T.TIMETRIGGERINTERVALS,defaultValue:"svn"===a||"single_svn"===a?"600000":"3600000"}))),S.default.createElement("div",{className:"h6"},t("BUILD_TRIGGER")),S.default.createElement(h.Form.Item,null,S.default.createElement(h.Checkbox,{checked:n,name:"enable_multibranch_job_trigger",onChange:this.handleChange("enable_multibranch_job_trigger")},t("PIPELINE_EVENT_TRIGGER"))),n&&S.default.createElement("div",{className:k.default.wrapper},S.default.createElement(h.Columns,null,S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("WHEN_CREATE_PIPELINE"),desc:t("WHEN_CREATE_PIPELINE_DESC")},S.default.createElement(h.Select,{name:"".concat(this.prefix,".multibranch_job_trigger.create_action_job_to_trigger"),isLoading:l,isLoadingAtBottom:!0,onMenuScrollToBottom:this.handleScrollToBottom,options:this.pipelineLists,placeholder:t("SELECT_PIPELINE_SCAP")}))),S.default.createElement(h.Column,null,S.default.createElement(h.Form.Item,{label:t("WHEN_DELETE_PIPELINE"),desc:t("WHEN_DELETE_PIPELINE_DESC")},S.default.createElement(h.Select,{name:"".concat(this.prefix,".multibranch_job_trigger.delete_action_job_to_trigger"),isLoading:l,isLoadingAtBottom:!0,onMenuScrollToBottom:this.handleScrollToBottom,options:this.pipelineLists,placeholder:t("SELECT_PIPELINE_SCAP")}))))),u?this.renderGitOptions():null)}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=(0,E.default)(r,"multi_branch_pipeline");return S.default.createElement("div",{className:k.default.advance},S.default.createElement(h.Form,{data:r,ref:a},S.default.createElement("div",{className:"h6"},(0,y.default)(n)?t("BUILD_SETTINGS"):t("BRANCH_SETTINGS")),S.default.createElement(h.Form.Item,null,S.default.createElement(h.Checkbox,{checked:r.enable_discarder,name:"enable_discarder",onChange:this.handleChange("enable_discarder")},(0,y.default)(n)?t("DELETE_OUTDATED_BUILD_RECORDS"):t("DELETE_OUTDATED_BRANCHES"),this.renderTip((0,y.default)(n)?t("DELETE_OUTDATED_BUILD_RECORDS_TIP"):t("DELETE_OUTDATED_BRANCHES_TIP")))),this.renderDisCarder(),(0,y.default)(n)?this.renderNoSource():this.renderWithSource()))}},{key:"sourceType",get:function(){var e=this.props.formTemplate;return(0,E.default)(e,"multi_branch_pipeline.source_type","")}},{key:"prefix",get:function(){return this.sourceType?"multi_branch_pipeline":"pipeline"}},{key:"scmPrefix",get:function(){return"multi_branch_pipeline.".concat(T.REPO_KEY_MAP[this.sourceType])}},{key:"webhookUrl",get:function(){var e=this.props.formTemplate,t=(0,E.default)(e,"".concat(this.scmPrefix,".url"),""),a=(0,E.default)(e,"".concat(this.scmPrefix,".api_uri"),""),r=(0,E.default)(e,"".concat(this.scmPrefix,".owner"),""),n=(0,E.default)(e,"".concat(this.scmPrefix,".repo"),""),l="".concat(a,"/scm/").concat(r,"/").concat(n,".git");switch(this.sourceType){case"bitbucket_server":return"".concat(window.location.protocol,"//").concat(window.location.host,"/devops_webhook/git/?url=").concat(l);case"github":return"".concat(window.location.protocol,"//").concat(window.location.host,"/devops_webhook/").concat(this.sourceType,"/");default:return"".concat(window.location.protocol,"//").concat(window.location.host,"/devops_webhook/git/?url=").concat(t)}}},{key:"pipelineLists",get:function(){return this.pipelineStore.list.data.map((function(e){return{label:e.name,value:e.fullName}}))}}]),r}(S.default.Component),o.defaultProps={type:"create"},u=c))||u;a.default=I},function(e,t,a){e.exports={wrapper:"_9Yk0qNR2FCG_MPOHVb5JL",header:"_2yTyFqoCxQzx3hRKBg6rRu",content:"T-SCFAAauUJ-x1ldEYntT",itemWrapper:"_1_HVr5DcfYh3ao-5xi6WZV",itemTitle:"_17CzlSkNwriw1ibCqf5Bty",delete:"_26CIQvJti4RrsEj55MYDZc"}},function(e,t,a){e.exports={wrapper:"_28_VGcUL3ubpH0qmzQAKfV",header:"_3-qLqDcljl_m43YCxIxJZ3",content:"_12apY-AeTVbwQd6ffG8WxD",itemWrapper:"_1LRPWkPDcmmt4VdZRlrFLS",itemTitle:"_1LBhdFwEbnrlSDmT97sxs-",delete:"_5TmTBPrXcOuz8pGbj7JH2"}},function(e,t,a){e.exports={pipeline_column:"nWZ33DmaBbhEDSesc0DiU",content:"_1-oRV7NPr1NxWnH05jzHGL",clickable:"_3YhfWUE0e_VnI4wVC083Mj"}},function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(14),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(20),a(141),a(14),a(120);var n=r(a(64)),l=r(a(67)),u=a(17),o=r(a(0)),c=r(a(2906)),s=function(e){var t=e.zIndex,a=e.listType,r=e.steps,s=(0,u.toJS)(r);return o.default.createElement(o.default.Fragment,null,!(0,l.default)(s)&&(0,n.default)(s)&&s.map((function(e,r){return o.default.createElement(c.default,{key:JSON.stringify((0,u.toJS)(e.name))+r,step:(0,u.toJS)(e),index:r,zIndex:t,listType:a,isLast:s.length-1===r})})))};t.default=s},function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(14),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(20),a(141),a(14),a(120);var n=r(a(64)),l=r(a(67)),u=a(17),o=r(a(0)),c=r(a(2920)),s=function(e){var t=e.zIndex,a=e.listType,r=e.steps,s=(0,u.toJS)(r);return o.default.createElement(o.default.Fragment,null,!(0,l.default)(s)&&(0,n.default)(s)&&s.map((function(e,r){return o.default.createElement(c.default,{key:JSON.stringify((0,u.toJS)(e.name))+r,step:(0,u.toJS)(e),index:r,zIndex:t,listType:a,isLast:s.length-1===r})})))};t.default=s},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.option;function r(){var e;return l.default.createElement(u.Form.Item,{label:a.name,desc:a.description,rules:[{required:null!==(e=a.required)&&void 0!==e&&e,message:t("PARAM_REQUIRED")}]},l.default.createElement(u.Input,{name:"paramsForm.".concat(a.name),defaultValue:a.default||""}))}return l.default.createElement("div",{className:o.default.itemWrapper},function(e){var t=null;switch(e){case"string":t=r();break;case"bool":t=l.default.createElement(u.Form.Item,{label:a.name},l.default.createElement(u.RadioGroup,{name:"paramsForm.".concat(a.name),defaultValue:a.default||!1},l.default.createElement(u.Radio,{value:!0},"True"),l.default.createElement(u.Radio,{value:!1},"False")));break;default:t=r()}return t}(a.type))},r(12),r(109),r(14);var l=n(r(0)),u=r(189),o=n(r(1190))},,,function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(317)),u=n(a(97)),o=n(a(50)),c=r(a(0)),s=n(a(958)),i=n(a(1133)),f=function(e){return(0,s.default)(e)?e:""},d=function(e){var t=e.onChange,a=e.value,r=(0,o.default)(e,["onChange","value"]),n=(0,c.useState)(f(a)),s=(0,u.default)(n,2),d=s[0],p=s[1];(0,c.useEffect)((function(){p(f(a))}),[a]);return c.default.createElement(i.default,(0,l.default)({},r,{value:d,onChange:function(e){p(e),t(e)}}))};t.default=d},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(87),r(24),r(1067),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(87),r(29),r(1067),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(830)),p=n(r(958)),m=r(189),h=n(r(2947));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=function(e){(0,o.default)(r,e);var a=v(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).triggerChange=function(e){var a=e.right,r=t.props,n=r.marks;(0,r.onChange)(t.getValueFromPercent(n,a))},t.handleResize=function(){t.rect=t.ref.current.getBoundingClientRect()},t.handleMouseDown=function(e){if(document.addEventListener("mouseup",t.handleMouseUp),"slider"===e.target.getAttribute("role"))document.addEventListener("mousemove",t.handleMouseMove),t.type=e.target.dataset.type;else if(t.ref.current.contains(e.target)){var a=(e.x-t.rect.x)/t.rect.width*100;a>t.endPercent&&(a=100),t.triggerChange({right:a})}},t.handleMouseMove=function(e){var a=100*(e.x-t.rect.x)/t.rect.width;return a>t.endPercent&&(a=100),a<0&&(a=0),t.triggerChange({right:a})},t.handleMouseUp=function(){document.removeEventListener("mousemove",t.handleMouseMove)},t.totalWeight=e.marks.reduce((function(e,t){return e+(t.weight||1)}),0)-1,t.endPercent=100*t.totalWeight/(t.totalWeight+1),t.state=t.getStateFromProps(e),t.ref=i.default.createRef(),t}return(0,u.default)(r,[{key:"getValuePercent",value:function(e,t){for(var a=0,r=0;r<e.length-1;r++){var n=e[r].weight||1;if(t>=e[r+1].value)a+=n/this.totalWeight;else if(t>=e[r].value&&t<e[r+1].value){a+=n*((t-e[r].value)/(e[r+1].value-e[r].value))/this.totalWeight}}return a}},{key:"getValueFromPercent",value:function(e,t){for(var a=this.props.valueFormatter,r=this.totalWeight*t/100,n=0,l=0,u=0;u<e.length-1;u++){var o=e[u].weight||1;if((l+=o)>=r&&l<o+r){var c=(r+o-l)/o;n=(e[u+1].value-e[u].value)*c+e[u].value}}return a?Number.parseInt(a(n),10):Number.parseInt(n,10)}},{key:"getStateFromProps",value:function(e){var t=e.marks,a=e.value;return{right:100*this.getValuePercent(t,a)}}},{key:"componentDidUpdate",value:function(e){if(!(0,d.default)(e.value,this.props.value)){var t=this.getStateFromProps(this.props).right;this.setState({right:t})}}},{key:"componentDidMount",value:function(){this.ref&&this.ref.current&&(this.ref.current.addEventListener("mousedown",this.handleMouseDown),this.rect=this.ref.current.getBoundingClientRect(),window.addEventListener("resize",this.handleResize))}},{key:"componentWillUnmount",value:function(){this.ref&&this.ref.current&&(this.ref.current.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("resize",this.handleResize))}},{key:"render",value:function(){var e=this,a=this.state.right,r=this.props,n=r.value,l=r.unit,u=r.marks,o=0;return i.default.createElement("div",{className:h.default.slider,ref:this.ref},i.default.createElement("div",{className:h.default.rail}),i.default.createElement("div",{className:h.default.track,role:"track",style:{left:"0%",width:"".concat(a,"%")}}),i.default.createElement(m.Tooltip,{content:i.default.createElement("span",null,(0,p.default)(n)?"".concat(n," ").concat(l):t("NO_LIMIT"))},i.default.createElement("div",{className:h.default.handler,role:"slider","data-type":"right",style:{left:"calc(".concat(a,"% - 10px)")}})),i.default.createElement("div",{className:h.default.mark},u.map((function(t){var a=t.weight||1,r=100*((o+=a)-a)/e.totalWeight;return i.default.createElement("span",{key:t.value,style:{left:"".concat(r,"%")}},t.label)}))))}}]),r}(i.default.Component);a.default=E,E.propTypes={marks:f.default.array,value:f.default.number,defaultValue:f.default.array,unit:f.default.string,onChange:f.default.func,valueFormatter:f.default.func},E.defaultProps={marks:[],value:0,unit:"",onChange:function(){}}},function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(87),a(14),a(99),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.FEDERATED_PROJECT_UNSOPPORT_QUOTA=t.QUOTAS_KEY_MODULE_MAP=t.RESERVED_MODULES=void 0;var n=r(a(31));a(12),a(10),a(6),a(27),a(87),a(14),a(33),a(16),a(99),a(8),a(13),a(9),a(4),a(7);var l=a(61);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.RESERVED_MODULES=["limits.cpu","requests.cpu","limits.memory","requests.memory"];var c=Object.entries(l.QUOTAS_MAP).reduce((function(e,t){return o(o({},e),{},(0,n.default)({},t[1].name,t[0]))}),{});t.QUOTAS_KEY_MODULE_MAP=c;t.FEDERATED_PROJECT_UNSOPPORT_QUOTA=["daemonsets","jobs","cronjobs"]},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(70),r(20),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(73),r(7);var l,u,o,c=n(r(31)),s=n(r(58)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(26)),v=n(r(845)),E=n(r(326)),y=n(r(445)),g=n(r(253)),b=n(r(0)),S=n(r(5)),_=r(243),O=n(r(1)),C=n(r(863)),T=n(r(798)),R=n(r(800)),D=r(56),k=n(r(2967)),N=r(2968),I=n(r(1478));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var L=(0,_.observer)((o=u=function(e){(0,d.default)(r,e);var a=w(r);function r(e){var t,n,l;(0,i.default)(this,r),(l=a.call(this,e)).handleOk=function(){var e=l.props.basicRoleTemplates,t=e?e.map((function(e){return e.name})):[];l.props.onOk((0,g.default)([].concat((0,s.default)(l.state.roleTemplates),(0,s.default)(t))))},l.handleTabChange=function(e){var t=e.currentTarget.dataset.module;l.setState({currentModule:t})},l.handleCheckChange=function(e){var t=l.state,a=t.currentModule,r=t.roleModules,n=t.groupedTemplates,u=r.find((function(e){return e.name===a}));u&&(u.state=n[a].some((function(t){return e.includes(t.name)}))?"ENABLED":"NOT_ENABLED"),l.setState({roleTemplates:e})};var u=(0,E.default)(l.props.roleTemplates,"name"),o=(0,h.default)(l.props.formTemplate,"aggregationRoleTemplates.templateNames",[]),c=(0,v.default)(l.props.roleTemplates,'labels["iam.kubesphere.io/category"]'),f=null===(t=l.props.roleModules)||void 0===t||null===(n=t.map((function(e){return A(A({},e),{},{icon:N.ROLE_MODULES_ICON[e.name]||"templet",state:o.some((function(t){return(0,h.default)(u[t],'labels["iam.kubesphere.io/category"]')===e.name}))?"ENABLED":"NOT_ENABLED"})})))||void 0===n?void 0:n.filter((function(e){var t=c[e.name];return t&&t.length>0}));return l.state={roleTemplates:o,roleModules:f,roleTemplatesMap:u,currentModule:f&&f.length>0?f[0].name:"",groupedTemplates:c},l}return(0,f.default)(r,[{key:"renderTabs",value:function(){var e=this,a=this.state,r=a.roleModules,n=void 0===r?[]:r,l=a.currentModule,u=(0,h.default)(globals.user,"lang")||(0,D.getBrowserLang)();return b.default.createElement("div",{className:I.default.tabs},b.default.createElement("div",{className:I.default.title},t("CATEGORIES")),b.default.createElement("div",{className:I.default.tabsWrapper},n.map((function(a){return b.default.createElement("div",{key:a.name,className:(0,S.default)(I.default.tab,(0,c.default)({},I.default.enabled,l===a.name)),onClick:e.handleTabChange,"data-module":a.name},b.default.createElement(R.default,{icon:a.icon,title:a.displayName[u]||a.displayName.en,description:l===a.name?t("CURRENT"):"ENABLED"===a.state?t("AUTHORIZED"):t("UNAUTHORIZED")}),b.default.createElement(C.default,{className:I.default.indicator,type:"ENABLED"===a.state?"running":"disabled"}))}))))}},{key:"renderContent",value:function(){var e=this,a=this.state,r=a.groupedTemplates,n=a.roleTemplates,l=a.roleTemplatesMap,u=a.currentModule,o=(0,y.default)(r[u]||[],"name");return b.default.createElement("div",{className:I.default.content},b.default.createElement("div",{className:I.default.title},t("PERMISSION_PL")),b.default.createElement("div",{className:I.default.contentWrapper},o.map((function(t){return b.default.createElement(k.default,{key:t.name,data:t,roleTemplates:n,roleTemplatesMap:l,onChange:e.handleCheckChange})}))))}},{key:"render",value:function(){var e=this.props,a=e.title,r=e.visible,n=e.onCancel,l=e.isSubmitting;return b.default.createElement(T.default,{title:a||t("EDIT_PERMISSIONS"),icon:"role",onCancel:n,onOk:this.handleOk,visible:r,isSubmitting:l,fullScreen:!0},b.default.createElement("div",{className:I.default.wrapper},this.renderTabs(),this.renderContent()))}}]),r}(b.default.Component),u.propTypes={roleTemplates:O.default.array,formTemplate:O.default.object,visible:O.default.bool,onOk:O.default.func,onCancel:O.default.func,isSubmitting:O.default.bool},u.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=L},function(e,t,a){e.exports={wrapper:"_1zXt7JS-5wTeq2O3Yyq-JL",title:"_2R6_3gQaWfGc-54ApbjvK6",tabs:"_1sRMn6-7VQwsP-i502ZCQI",tabsWrapper:"_13UODiQ-dkFqD1c7buDIbo",tab:"_13nyoRlsA_NwzkmCiVg_cF",enabled:"_1l3zLl936dTPcn3AIOkq-x",indicator:"_1DujT8XDf3EuRJJ2LydBom",content:"_1tK-XesSh-xcD5WpN9xJnR",contentWrapper:"_29j0loE5wpYw0YS-LWiFTg",checkItem:"_3rhvJqZScieMGWwx8WyyK4",extra:"_1lZdigIdMb29HKGS7xLlDe",tag:"LujNwnnNKKpJOW-0bi7Yj"}},,,function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(98),r(14),r(99),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(27),r(98),r(29),r(14),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(97)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(26)),p=n(r(163)),m=n(r(68)),h=n(r(196)),v=n(r(0)),E=r(189),y=r(56),g=r(61),b=n(r(2984)),S=n(r(2986)),_=n(r(2988)),O=n(r(2989));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var D=["Opaque","kubernetes.io/tls","kubernetes.io/dockerconfigjson","kubernetes.io/basic-auth"],k=function(e){(0,s.default)(r,e);var a=R(r);function r(){var e;(0,o.default)(this,r);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(e=a.call.apply(a,[this].concat(l))).state={type:(0,d.default)(e.fedFormTemplate,"type",""),state:"",selectDataKey:"",isSkipVerify:"true"===(0,d.default)(e.formTemplate,'metadata.annotations["secret.kubesphere.io/force-insecure"]',"false")},e.imageRegistryRef=v.default.createRef(),e.getTypeOptions=function(){return[{label:t("DEFAULT"),value:"Opaque"},{label:t("TLS_INFORMATION"),value:"kubernetes.io/tls"},{label:t("IMAGE_REGISTRY_INFORMATION"),value:"kubernetes.io/dockerconfigjson"},{label:t("USERNAME_PASSWORD"),value:"kubernetes.io/basic-auth"}]},e.handleTypeChange=function(t){t&&!D.includes(t)||(0,m.default)(e.fedFormTemplate,"data",{});"kubernetes.io/dockerconfigjson"===t?((0,m.default)(e.fedFormTemplate,"metadata.annotations['secret.kubesphere.io/force-insecure']","true"),e.setState({isSkipVerify:!0})):(e.setState({isSkipVerify:!1}),(0,h.default)(e.fedFormTemplate,"metadata.annotations['secret.kubesphere.io/force-insecure']")),e.setState({type:t})},e.dataValidator=function(e,a,r){return(0,p.default)(a)?r():Object.entries(a).some((function(e){var t=(0,u.default)(e,2),a=t[0],r=t[1];return(0,y.hasChinese)(a)||(0,y.hasChinese)(r)}))?r({message:t("SECRET_NO_CHINESE_CODE_DESC")}):void r()},e.imageValidator=function(t,a,r){if(e.imageRegistryRef.current.validate())return r()},e.handleData=function(t){var a=e.state.selectDataKey,r=(0,d.default)(e.fedFormTemplate,"data",{});a&&delete r[a],(0,m.default)(e.fedFormTemplate,"data",T(T({},r),t)),e.hideDataForm()},e.showDataForm=function(){e.setState({state:"data",selectDataKey:""})},e.hideDataForm=function(){e.setState({state:"",selectDataKey:""})},e.handleDataItemEdit=function(t){e.setState({state:"data",selectDataKey:t})},e.handleChangeSkipVerify=function(t){(0,m.default)(e.fedFormTemplate,'metadata.annotations["secret.kubesphere.io/force-insecure"]',t?"true":"false"),e.setState({isSkipVerify:t})},e}return(0,c.default)(r,[{key:"renderDataForm",value:function(){var e=this.state.selectDataKey,t=(0,d.default)(this.fedFormTemplate,"data",{});return v.default.createElement(S.default,{detail:t,selectKey:e,onOk:this.handleData,onCancel:this.hideDataForm})}},{key:"renderDefault",value:function(){return v.default.createElement(E.Form.Item,{label:t("DATA"),rules:[{required:!0,message:t("ENTER_DATA_DESC")},{validator:this.dataValidator}]},v.default.createElement(b.default,{name:"data",onEdit:this.handleDataItemEdit,onAdd:this.showDataForm}))}},{key:"renderTLS",value:function(){return v.default.createElement("div",{key:"tls",className:"margin-t8"},v.default.createElement(E.Form.Item,{label:t("CERTIFICATE"),rules:[{required:!0,message:t("CREDENTIAL_NAME_EMPTY_DESC")},{validator:this.dataValidator}]},v.default.createElement(_.default,{name:"data['tls.crt']"},v.default.createElement(E.TextArea,{rows:"6",resize:!0}))),v.default.createElement(E.Form.Item,{label:t("PRIVATE_KEY_TCAP"),rules:[{required:!0,message:t("ENTER_PRIVATE_KEY_DESC")},{validator:this.dataValidator}]},v.default.createElement(_.default,{name:"data['tls.key']"},v.default.createElement(E.TextArea,{rows:"6",resize:!0}))))}},{key:"renderImage",value:function(){var e=this,t=this.props,a=t.cluster,r=t.isFederated,n=(0,d.default)(this.formTemplate,"metadata"),l=n.name,u=n.namespace;return v.default.createElement("div",{key:"image",className:"margin-t8"},v.default.createElement(E.Form.Item,{rules:[{validator:this.imageValidator}]},v.default.createElement(_.default,{name:"data['.dockerconfigjson']"},v.default.createElement(O.default,{fedFormTemplate:this.fedFormTemplate,cluster:a,isDefault:this.isDefault,onChangeDefault:function(t){return(0,m.default)(e.fedFormTemplate,'metadata.annotations["secret.kubesphere.io/is-default-class"]',t?"true":"false")},onChangeState:function(t){e.setState({changeData:t})},isSkipVerify:this.state.isSkipVerify,onChangeSkipVerify:this.handleChangeSkipVerify,namespace:u,isFederated:r,screatName:l,ref:this.imageRegistryRef}))),v.default.createElement(E.Form.Item,null,this.renderDefault()))}},{key:"renderBasicAuth",value:function(){return v.default.createElement("div",{key:"basic",className:"margin-t8"},v.default.createElement(E.Form.Item,{label:t("USERNAME"),rules:[{required:!0,message:t("USERNAME_EMPTY_DESC")},{validator:this.dataValidator}]},v.default.createElement(_.default,{name:"data.username"},v.default.createElement(E.Input,{autoComplete:"nope"}))),v.default.createElement(E.Form.Item,{label:t("PASSWORD"),rules:[{required:!0,message:t("PASSWORD_EMPTY_DESC")},{validator:this.dataValidator}]},v.default.createElement(_.default,{name:"data.password"},v.default.createElement(E.InputPassword,{type:"password",autoComplete:"new-password"}))))}},{key:"renderContent",value:function(){var e=null;switch(this.state.type){case"Opaque":e=this.renderDefault();break;case"kubernetes.io/tls":e=this.renderTLS();break;case"kubernetes.io/dockerconfigjson":e=this.renderImage();break;case"kubernetes.io/basic-auth":e=this.renderBasicAuth();break;default:e=this.renderDefault()}return e}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.disableSelect;return"data"===this.state.state?this.renderDataForm():v.default.createElement(E.Form,{data:this.fedFormTemplate,ref:a},v.default.createElement(E.Form.Item,{label:t("TYPE"),desc:r?"":t("SECRET_TYPE_DESC")},v.default.createElement(E.Select,{name:"type",options:this.getTypeOptions(),onChange:this.handleTypeChange,placeholder:" ",disabled:r,searchable:!1})),this.renderContent())}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,g.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,d.default)(this.formTemplate,"spec.template"):this.formTemplate}},{key:"isDefault",get:function(){return"true"===(0,d.default)(this.formTemplate,'metadata.annotations["secret.kubesphere.io/is-default-class"]',"false")}}]),r}(v.default.Component);a.default=k},function(e,t,a){e.exports={wrapper:"_3q9ZPljm8JK-39rDuXZgdr",label:"_2PJR1P70-qnZ16hFmDUchO",control:"E8wY6oMs417J6WSOmAX2U",desc:"Ds9TCkSEvwwDt_0FrmqoE",requiredIcon:"_2Qu1AVZafJ8A1J4T7WmNMt",tip:"_2PrZvRpUWImjuzMe8HfkOE",password:"_3M7PW0eiW35GKVm_PzsTGI",defaultContainer:"_27a4IDiJ2eA4Wodlaf-kXo",title:"_2dxoduAZQV0i1cswbu5FSg",disc:"_5Jn-MRyPjp-UN9PVyq27G",skip_verify:"_3i5x-DxzaVvWrOZ4Vch20L"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(98),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(98),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=n(r(68)),p=r(189),m=n(r(805)),h=n(r(824)),v=r(61),E=n(r(3015));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var g=function(e){(0,o.default)(r,e);var a=y(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).itemValidator=function(e,a,r){return a?a.some((function(e){return!e}))?r({message:t("EMPTY_KEY")}):void r():r()},e.handleOk=function(){var t=e.props,a=t.onOk,r=t.formTemplate;e.form.current.validator((function(){var e=(0,f.default)(r,"metadata.name");(0,d.default)(r,"spec.routes[0].id",e),a(r)}))},e.nameValidator=function(a,r,n){if(!r||e.props.isEditMode)return n();e.props.store.checkName({name:r,namespace:e.props.namespace,cluster:e.props.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=e.detail;return i.default.createElement(p.Form,{ref:a,data:r},i.default.createElement(p.Columns,null,i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:v.PATTERN_NAME,message:t("PATTERN_NAME_INVALID_TIP")},{validator:this.nameValidator}]},i.default.createElement(p.Input,{name:"metadata.name",autoFocus:!0,maxLength:63,disabled:!!n}))),i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("GATEWAY")},i.default.createElement(p.Input,{disabled:!0,name:"spec.gateway"})))),i.default.createElement(p.Columns,null,i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("MICROSERVICE_ORDER"),desc:t("MICROSERVICE_ORDER_DESC")},i.default.createElement(m.default,{name:"spec.routes[0].order",integer:!0,min:0}))),i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("URL"),desc:t("MICROSERVICE_ROUTE_URL_DESC")},i.default.createElement(p.Input,{name:"spec.routes[0].uri"})))),i.default.createElement(p.Form.Item,{label:t("PREDICATE"),rules:[{validator:this.itemValidator,checkOnSubmit:!0}]},i.default.createElement(h.default,{name:"spec.routes[0].predicates",addText:t("ADD")},i.default.createElement(E.default,{options:v.SERVICE_ROUTING_PREDICATES}))),i.default.createElement(p.Form.Item,{label:t("MICROSERVICE_ROUTE_FILTER"),rules:[{validator:this.itemValidator,checkOnSubmit:!0}]},i.default.createElement(h.default,{name:"spec.routes[0].filters",addText:t("ADD")},i.default.createElement(E.default,{options:v.SERVICE_ROUTING_FILTERS}))))}}]),r}(i.default.Component);a.default=g},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(6),r(20),r(14),r(99),r(8),r(13),r(9),r(4),r(190),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(190),r(18),r(43),r(11),r(7);var u,o=n(r(58)),c=n(r(31)),s=n(r(97)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=l(r(0)),v=r(243),E=n(r(839)),y=n(r(68)),g=r(189),b=r(61),S=r(486),_=n(r(3020)),O=n(r(3021)),C=n(r(3023)),T=n(r(1193));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var N=[{label:t("SILENCE_EVERY_DAY"),value:1},{label:t("SILENCE_EVERY_WEEK"),value:2},{label:t("SILENCE_EVERY_MONTH"),value:3}],I={hour:void 0,minute:Boolean,second:Boolean},P={hour:void 0,minute:function(e){return e<59},second:function(e){return e<59}},A=(0,v.observer)(u=function(e){(0,d.default)(r,e);var a=k(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).types=Object.values(b.silentPolicyTypes).map((function(e){return{label:t(e.name),value:e.value}})),e.validateCron=function(e,a,r){if(!a)return r();try{(0,S.parseExpression)(a)}catch(e){return r(t("CRON_EXPRESSION_ERROR_DESC"))}r()},e.renderCron=function(){return h.createElement(g.Form.Item,{label:t("CRON_EXPRESSION"),desc:t("CRON_EXPRESSION_DESC"),rules:[{validator:e.validateCron},{required:!0,message:t("CRON_EXPRESSION_REQUIRE_DESC")}]},h.createElement(g.Input,{name:"cron"}))},e.validateDateRange=function(e){return function(a,r,n){var l=(0,s.default)(r,2),u=l[0],o=l[1];return(0,E.default)(u)||(0,E.default)(o)?n(t("SILENCE_TIME_RANGE_EMPTY_DESC")):(e?new Date(u).getTime()>=new Date(o).getTime():u>=o)?n(t("TIMERANGE_SELECTOR_MSG")):n()}},e.renderSpecific=function(){return h.createElement(g.Form.Item,{label:t("TIME_RANGE"),desc:t("SELECT_START_TIME_AND_END_TIME"),rules:[{required:!0,message:t("SILENCE_TIME_RANGE_EMPTY_DESC")},{validator:e.validateDateRange(!0)}]},h.createElement(C.default,{type:"date",name:"dateRange"}))},e.renderSilentTime=function(){return h.createElement(g.Form.Item,{label:t("TIME_RANGE"),desc:t("SELECT_START_TIME_AND_END_TIME"),rules:[{required:!0,message:t("SILENCE_TIME_RANGE_EMPTY_DESC")},{validator:e.validateDateRange(!1)}]},h.createElement(C.default,{type:"time",name:"timeRange",disabled:[I,P],minuteStep:59,secondStep:59}))},e.renderDays=function(e){return h.createElement(g.Form.Item,{rules:[{required:!0,message:t("SELECT_DATE")}]},h.createElement(O.default,e))},e.renderWeek=function(){var t,a=e.props.formTemplate;return e.renderDays({name:"week",type:"week",defaultValue:null!==(t=a.week)&&void 0!==t?t:[],multi:!0})},e.renderMonth=function(){var t,a=e.props.formTemplate;return e.renderDays({name:"month",type:"month",defaultValue:null!==(t=a.month)&&void 0!==t?t:[],multi:!0})},e.renderSilentPeriod=function(){return h.createElement(g.Form.Item,{label:t("SILENCE_DATE")},h.createElement(g.Select,{name:"timeType",options:N,defaultValue:e.props.formTemplate.timeType,onChange:function(t){e.handleChange(D({timeType:t},{week:[],month:[]}))}}))},e.renderPeriodic=function(){var t=e.props.formTemplate.timeType;return h.createElement(h.Fragment,null,e.renderSilentPeriod(),2===t&&e.renderWeek(),3===t&&e.renderMonth(),e.renderSilentTime())},e.handleChange=function(t){Object.entries(t).forEach((function(t){y.default.apply(void 0,[e.props.formTemplate].concat((0,o.default)(t)))})),e.forceUpdate()},e.renderSilent=function(){var a=e.props.formTemplate.type;return h.createElement(h.Fragment,null,h.createElement(g.Form.Item,{label:t("TYPE"),desc:t("SILENCE_TIME_TYPE_DESC")},h.createElement(g.Select,{name:"type",options:e.unCustomTypes,defaultValue:a,onChange:function(t){e.handleChange({type:t,duration:null})}})),2===a&&e.renderSpecific(),3===a&&e.renderPeriodic())},e}return(0,f.default)(r,[{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formTemplate;return h.createElement("div",null,a.isDefaultCron&&h.createElement(T.default,this.tabs),h.createElement("div",{className:_.default.formContainer},h.createElement("div",null,a.isCron?h.createElement(g.Form,{key:a.isCron.toString(),ref:t,data:a},this.renderCron()):h.createElement(g.Form,{ref:t,data:a},this.renderSilent()))))}},{key:"unCustomTypes",get:function(){return this.types.filter((function(e){return 4!==e.value}))}},{key:"tabs",get:function(){var e=this;return{value:this.props.formTemplate.isCron,onChange:function(t){return e.handleChange({isCron:t})},options:[{value:!1,label:t("SILENT_TEMPLATE")},{value:!0,label:t("SILENT_CRON")}]}}}]),r}(h.Component))||u;a.default=A},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=r(189),d=n(r(0)),p=r(61);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(r,e);var a=m(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).nameValidator=function(a,r,n){if(!r||e.props.isEdit)return n();e.props.store.checkName({name:r,namespace:e.props.namespace,cluster:e.props.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=e.isEdit,l=void 0!==n&&n;return d.createElement(f.Form,{ref:a,data:r},d.createElement(f.Columns,null,d.createElement(f.Column,null,d.createElement(f.Form.Item,{label:t("NAME"),desc:t("PROJECT_NAME_DESC"),ref:this.nameRef,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:p.PATTERN_SERVICE_NAME,message:t("PROJECT_NAME_INVALID_DESC")},{validator:this.nameValidator}]},d.createElement(f.Input,{name:"name",autoFocus:!0,maxLength:63,disabled:l}))),d.createElement(f.Column,null,d.createElement(f.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:p.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},d.createElement(f.Input,{name:"aliasName",maxLength:63})))),d.createElement(f.Columns,null,d.createElement(f.Column,null,d.createElement(f.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},d.createElement(f.TextArea,{name:"desc",maxLength:256}))),d.createElement(f.Column,null)))}}]),r}(d.Component);a.default=h},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(70),r(36),r(98),r(4),r(18),r(11),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(36),r(98),r(29),r(4),r(18),r(43),r(11),r(40);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=r(189),p=l(r(68)),m=r(865),h=r(1060),v=l(r(1453)),E=l(r(3027));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=[{label:t("ALL_SILENT_NOTIFICATIONS_TCAP"),description:t("ALL_SILENT_NOTIFICATIONS_DESC"),icon:"timed-task",value:1},{label:t("CUSTOM_SILENT_NOTIFICATIONS_TCAP"),description:t("CUSTOM_SILENT_NOTIFICATIONS_DESC"),icon:"timed-task",value:2}],b=function(e){(0,c.default)(r,e);var a=y(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).handleChange=function(t){var a=e.props.formTemplate;(0,p.default)(a,"condition",t),1===t?(0,p.default)(a,"matchExpressions",[]):(0,p.default)(a,"matchExpressions",[{}]),e.forceUpdate()},e.checkItemValid=function(e){var t=e.key&&e.operator;return t&&["In","NotIn"].includes(e.operator)&&(t=t&&e.values.length>0),"Match"===e.operator&&(t=t&&e.regexValue),t},e.itemValidator=function(a,r,n){return r?r.some((function(t){return!e.checkItemValid(t)}))?n({message:t("INVALID_SILENCE_CONDITION")}):void n():n()},e}return(0,o.default)(r,[{key:"renderControlAnnotation",value:function(){return f.createElement("div",{className:E.default.annotation},f.createElement(d.Icon,{name:"question"}),f.createElement("p",{className:E.default.desc},t.html("NOTIFICATION_CONDITION_SETTING_TIP")))}},{key:"renderControlSetting",value:function(){return f.createElement("div",{className:E.default.conditionContainer},f.createElement(d.Form.Item,{rules:[{validator:this.itemValidator,checkOnSubmit:!0}]},f.createElement(h.ArrayInput,{name:"matchExpressions",itemType:"object",addText:t("ADD"),checkItemValid:this.checkItemValid,desc:this.renderControlAnnotation()},f.createElement(v.default,null))))}},{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formTemplate;return f.createElement(d.Form,{ref:t,data:a},f.createElement(d.Form.Item,null,f.createElement(m.TypeSelect,{name:"condition",defaultValue:1,options:g,onChange:this.handleChange})),2===a.condition&&this.renderControlSetting())}}]),r}(f.Component);a.default=b},,function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(66),r(20),r(87),r(51),r(99),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(111),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(97)),u=n(r(31)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37));r(12),r(32),r(3),r(10),r(6),r(66),r(20),r(27),r(87),r(51),r(141),r(29),r(120),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(321),r(18),r(43),r(30),r(195),r(11),r(111),r(7);var d,p,m,h=n(r(0)),v=n(r(1)),E=r(189),y=n(r(798)),g=n(r(800)),b=n(r(858)),S=n(r(805)),_=r(243),O=n(r(26)),C=n(r(1487)),T=n(r(985)),R=n(r(68)),D=n(r(914)),k=n(r(444)),N=n(r(3032)),I=n(r(3034)),P=n(r(3036));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var M=function(e,t,a,r){return(0,O.default)(e.formData,"metadata.annotations['".concat(t,".kubesphere.io/").concat(a,"']"),r)},x=1e4,j=0,U="Gi",F=(0,_.observer)((m=p=function(e){(0,s.default)(r,e);var a=L(r);function r(e){var n;return(0,o.default)(this,r),(n=a.call(this,e)).enable=function(){var e=n.state.resize;n.setState({resize:w(w({},e),{},{enabled:!e.enabled})})},n.NumberEndDot=function(e){var t,a=null!==(t=/^[0-9]+(\.[0-9]{0,})?/g.exec(e))&&void 0!==t?t:[];return(0,k.default)(a[0],".")?e.split(".").join(""):e},n.handleOk=function(){n.formRef.current.validate((function(){var e=n.state,t=e.resize,a=e.restart,r={resize:t,restart:a},u=Object.entries(r).map((function(e){var t=(0,l.default)(e,2),a=t[0],r=t[1],u={};return Object.entries(r).forEach((function(e){var t=(0,l.default)(e,2),r=t[0],o=t[1],c=(0,C.default)(o)?JSON.stringify(o):n.NumberEndDot(o);(0,R.default)(u,"annotations['".concat(a,".kubesphere.io/").concat(r,"']"),c)})),u.annotations}));n.props.onOk(w(w(w({},u[0]),u[1]),{},{"restart.kubesphere.io/online-expansion-support":"".concat(!a.enabled)}))}))},n.handleLimitChange=function(e){var t=n.state.resize,a=U,r=/^[0-9]+(\.[0-9]{0,})?/g.test(e)?"".concat((0,D.default)(e)).concat(a):"10000Gi";n.setState({resize:w(w({},t),{},{"storage-limit":r}),fakeLimit:e})},n.handleThreshold=function(e){var t=n.state.resize,a="%"===e?"10%":e;n.setState({resize:w(w({},t),{},{threshold:a}),fakeThreshold:e})},n.handleIncrease=function(e){var t=n.state.resize,a="Gi"===e?"10Gi":e;n.setState({resize:w(w({},t),{},{increase:a}),fakeIncrease:e})},n.handleMaxTime=function(e){var t=n.state.restart;/^[0-9]*$/g.test(e)&&n.setState({restart:w(w({},t),{},{"max-time":""===e?"300":"".concat((0,D.default)(e))}),fakeMaxTime:(0,D.default)(e)})},n.restartEnable=function(){var e=n.state.restart;n.setState({restart:w(w({},e),{},{enabled:!e.enabled})})},n.renderMaxTime=function(){var e=n.state.fakeMaxTime;return h.default.createElement(h.default.Fragment,null,h.default.createElement(E.Alert,{type:"warning",message:t("RESTART_WORKLOAD_AUTOMATICALLY_TIP")}),h.default.createElement("div",{className:P.default.settings},h.default.createElement(E.Form.Item,{label:t("TIMEOUT_PERIOD_S")},h.default.createElement(S.default,{onChange:n.handleMaxTime,value:e,min:0}))))},n.formRef=h.default.createRef(),n.state={resize:{enabled:JSON.parse(M(e,"resize","enabled",!1)),increase:M(e,"resize","increase","10Gi"),"storage-limit":M(e,"resize","storage-limit","10000Gi"),threshold:M(e,"resize","threshold","10%")},restart:{enabled:JSON.parse(M(e,"restart","enabled",!1)),"max-time":M(e,"restart","max-time","300")},fakeIncrease:M(e,"resize","increase","10Gi"),fakeThreshold:M(e,"resize","threshold","10%"),fakeLimit:M(e,"resize","storage-limit","10000Gi"),fakeMaxTime:M(e,"restart","max-time","300")},n}return(0,c.default)(r,[{key:"getMarks",value:function(){var e=x,t=U;return(0,T.default)(6).reduce((function(a,r){var n=e*r/5,l=0===n?"0":"".concat(Math.floor(n)).concat(t);return w(w({},a),{},(0,u.default)({},n,l))}),{})}},{key:"render",value:function(){var e,a=this.props,r=a.visible,n=a.onCancel,l=a.formData,u=a.isSubmitting,o=this.state,c=o.resize,s=o.restart,i=o.fakeThreshold,f=o.fakeIncrease,d=o.fakeLimit,p=c.enabled,m=s.enabled,v=this.getMarks(),S=null===(e=/[0-9]+/g.exec(d))||void 0===e?void 0:e[0],_=S?parseInt(S,10):"",O=/[0-9]+/g.test(f)?f.endsWith("%")?f.slice(0,-1):f.slice(0,-2):"",C=""!==f?i.slice(0,-1):f;return h.default.createElement(y.default,{width:960,onOk:this.handleOk,onCancel:n,visible:r,title:t("SET_AUTO_EXPANSION"),okText:t("OK"),cancelText:t("CANCEL"),isSubmitting:u},h.default.createElement(E.Form,{formData:l,ref:this.formRef},h.default.createElement(E.Form.Item,null,h.default.createElement("div",{className:P.default.wrapper},h.default.createElement(g.default,{className:P.default.text,icon:function(){return h.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/autoscaling.svg",style:{width:"32px",marginRight:"16px"}})},title:t("AUTO_EXPANSION"),description:t("AUTO_EXPANSION_DESC")}),h.default.createElement(b.default,{className:P.default.switch,text:p?t("ENABLED"):t("DISABLED"),checked:p,onChange:this.enable}))),h.default.createElement("div",{className:P.default.settings},h.default.createElement("div",{className:P.default.title},t("AUTO_EXPANSION_SETTINGS")),h.default.createElement("div",{className:P.default.container},h.default.createElement("div",{className:P.default.limit},h.default.createElement(E.Form.Item,{label:t("MAXIMUM_SIZE")},h.default.createElement(N.default,{size:_,max:x,min:j,marks:v,unit:U,onChange:this.handleLimitChange}))),h.default.createElement(E.Columns,null,h.default.createElement(E.Column,null,h.default.createElement(E.Form.Item,null,h.default.createElement(I.default,{title:t("THRESHOLD"),unit:"%",max:100,value:C,onChange:this.handleThreshold}))),h.default.createElement(E.Column,null,h.default.createElement(E.Form.Item,{desc:t("INCREMENT_DESC")},h.default.createElement(I.default,{title:t("INCREMENT"),value:O,unit:"Gi",onChange:this.handleIncrease}))))),h.default.createElement("div",{className:P.default.group},h.default.createElement("div",{className:P.default.container},h.default.createElement("div",{className:P.default.checkItem},h.default.createElement(E.Checkbox,{checked:m,onChange:this.restartEnable}),h.default.createElement("div",{className:P.default.text},h.default.createElement("span",{className:P.default.title},t("RESTART_WORKLOAD_AUTOMATICALLY")),h.default.createElement("span",{className:P.default.des},t("RESTART_WORKLOAD_AUTOMATICALLY_DESC")))),m&&this.renderMaxTime())))))}},{key:"increaseOptions",get:function(){return[{label:"GiB",value:"Gi"},{label:"%",value:"%"}]}},{key:"increaseUnit",get:function(){var e,t=this.state.fakeIncrease;return null!==(e=this.increaseOptions.filter((function(e){return t.endsWith(e.value)}))[0].value)&&void 0!==e?e:"%"}}]),r}(h.default.Component),p.propTypes={visible:v.default.bool,onOk:v.default.func,onCancel:v.default.func,isSubmitting:v.default.bool},d=m))||d;a.default=F},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=r(189),d=l(r(26)),p=n(r(0)),m=r(61);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(r,e);var a=h(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).nameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:r,cluster:e.props.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props.formRef;return p.createElement("div",null,p.createElement(f.Form,{data:this.formTemplate,ref:e},p.createElement(f.Columns,null,p.createElement(f.Column,null,p.createElement(f.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:m.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("NAME_DESC")})},{validator:this.nameValidator}]},p.createElement(f.Input,{name:"metadata.name",autoFocus:!0,maxLength:63}))),p.createElement(f.Column,null,p.createElement(f.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:m.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},p.createElement(f.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),p.createElement(f.Columns,null,p.createElement(f.Column,null,p.createElement(f.Form.Item,{label:t("storageclasses")},p.createElement(f.Select,{name:'metadata.labels["storage.kubesphere.io/storagetype"]',options:this.options,clearable:!0}))),p.createElement(f.Column,null,p.createElement(f.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},p.createElement(f.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256}))))))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,m.MODULE_KIND_MAP[a],t)}},{key:"options",get:function(){return[{value:"BlockStorage",label:t("BLOCK_STORAGE")},{value:"ObjectStorage",label:t("OBJECT_STORAGE")},{value:"FileStorage",label:t("FILE_STORAGE")}]}}]),r}(p.Component);a.default=v},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(8),a(4),a(21),a(18),a(43),a(11);var n=r(a(38));a(35);var l,u,o,c,s,i,f=r(a(39)),d=r(a(62)),p=r(a(25)),m=r(a(28)),h=r(a(74)),v=r(a(41)),E=r(a(42)),y=r(a(37)),g=r(a(45)),b=(r(a(63)),a(17)),S=r(a(872)),_=r(a(26));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,y.default)(e);if(t){var n=(0,y.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,E.default)(this,a)}}var C=(l=function(e){(0,v.default)(r,e);var t,a=O(r);function r(){var e;(0,p.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=a.call.apply(a,[this].concat(n)),(0,d.default)(e,"startTime",u,(0,h.default)(e)),(0,d.default)(e,"endTime",o,(0,h.default)(e)),(0,d.default)(e,"interval",c,(0,h.default)(e)),(0,d.default)(e,"histograms",s,(0,h.default)(e)),(0,d.default)(e,"logsCount",i,(0,h.default)(e)),e}return(0,m.default)(r,[{key:"fetch",value:(t=(0,f.default)(n.default.mark((function e(){var t,a,r,l=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},a={operation:"histogram",start_time:this.startTime,end_time:this.endTime,interval:this.interval},e.next=4,this.request((0,S.default)(a,t));case 4:r=e.sent,this.histograms=(0,_.default)(r,"histogram.histograms",[])||[],this.logsCount=(0,_.default)(r,"histogram.total",0);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleResult",value:function(e){return e}}]),r}(r(a(1195)).default),u=(0,g.default)(l.prototype,"startTime",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=(0,g.default)(l.prototype,"endTime",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),c=(0,g.default)(l.prototype,"interval",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"15m"}}),s=(0,g.default)(l.prototype,"histograms",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i=(0,g.default)(l.prototype,"logsCount",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),(0,g.default)(l.prototype,"fetch",[b.action],Object.getOwnPropertyDescriptor(l.prototype,"fetch"),l.prototype),l);t.default=C},,,,,,,,,,,function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(20),a(320),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(320),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(7);var n=r(a(50)),l=r(a(38)),u=r(a(31));a(35);var o,c,s,i,f,d,p,m,h,v,E,y=r(a(39)),g=r(a(62)),b=r(a(25)),S=r(a(28)),_=r(a(74)),O=r(a(41)),C=r(a(42)),T=r(a(37)),R=r(a(45)),D=(r(a(63)),a(17)),k=r(a(872)),N=r(a(26)),I=a(248),P=r(a(1199)),A=a(56);function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,T.default)(e);if(t){var n=(0,T.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,C.default)(this,a)}}var x=(o=function(e){(0,O.default)(o,e);var t,a,r,u=M(o);function o(){var e;(0,b.default)(this,o);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return e=u.call.apply(u,[this].concat(a)),(0,g.default)(e,"size",c,(0,_.default)(e)),(0,g.default)(e,"from",s,(0,_.default)(e)),(0,g.default)(e,"total",i,(0,_.default)(e)),(0,g.default)(e,"records",f,(0,_.default)(e)),(0,g.default)(e,"log_query",d,(0,_.default)(e)),(0,g.default)(e,"startTime",p,(0,_.default)(e)),(0,g.default)(e,"endTime",m,(0,_.default)(e)),(0,g.default)(e,"workspace",h,(0,_.default)(e)),(0,g.default)(e,"pods",v,(0,_.default)(e)),(0,g.default)(e,"containers",E,(0,_.default)(e)),e}return(0,S.default)(o,[{key:"setQuery",value:function(e){this.log_query=e}},{key:"loadMoreLogs",value:(r=(0,y.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.fetch(L(L({},this.preParams),{},{from:this.from+this.size}),{loadMore:!0});case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"requestLogs",value:(a=(0,y.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetch",value:(t=(0,y.default)(l.default.mark((function e(){var t,a,r,n,u,o,c,s=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},a=s.length>1&&void 0!==s[1]?s[1]:{},r={operation:"query",start_time:this.startTime,end_time:this.endTime,log_query:this.log_query,pods:this.pods,sort:this.sort,containers:this.containers,from:this.from,size:this.size},n=(0,k.default)(r,t),e.next=6,this.requestLogs(n);case 6:u=e.sent,o=(0,N.default)(u,"query",{}),c=this.stripAnsiRecords(o.records),this.records=a.loadMore?this.records.concat(c):c,this.workspace=u.workspace,this.total=o.total||0,this.from=n.from,this.size=n.size,this.preParams=n;case 15:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stripAnsiRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return L(L({},e),{},{logStripANSI:(0,P.default)(e.log)})}))}},{key:"exportLinkFactory",value:function(e){var t=e.cluster,a=e.start_time,r=e.end_time,l=(0,n.default)(e,["cluster","start_time","end_time"]),u=(0,A.getClusterUrl)(this.getApiPath(t));return"/".concat(u,"?").concat((0,I.stringify)(L(L({sort:"asc"},l),{},{start_time:Math.floor(a/1e3),end_time:Math.floor(r/1e3),operation:"export",cluster:t})))}},{key:"haveMore",get:function(){return this.total>this.from+this.size}}]),o}(r(a(1195)).default),c=(0,R.default)(o.prototype,"size",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),s=(0,R.default)(o.prototype,"from",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),i=(0,R.default)(o.prototype,"total",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),f=(0,R.default)(o.prototype,"records",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=(0,R.default)(o.prototype,"log_query",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),p=(0,R.default)(o.prototype,"startTime",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=(0,R.default)(o.prototype,"endTime",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=(0,R.default)(o.prototype,"workspace",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),v=(0,R.default)(o.prototype,"pods",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),E=(0,R.default)(o.prototype,"containers",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),(0,R.default)(o.prototype,"setQuery",[D.action],Object.getOwnPropertyDescriptor(o.prototype,"setQuery"),o.prototype),(0,R.default)(o.prototype,"haveMore",[D.computed],Object.getOwnPropertyDescriptor(o.prototype,"haveMore"),o.prototype),(0,R.default)(o.prototype,"loadMoreLogs",[D.action],Object.getOwnPropertyDescriptor(o.prototype,"loadMoreLogs"),o.prototype),(0,R.default)(o.prototype,"fetch",[D.action],Object.getOwnPropertyDescriptor(o.prototype,"fetch"),o.prototype),o);t.default=x},,function(e,t,a){"use strict";(function(e){var r=a(19);a(12),a(3),a(10),a(6),a(20),a(8),a(13),a(970),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(3),a(10),a(6),a(20),a(27),a(442),a(33),a(16),a(8),a(13),a(970),a(9),a(4),a(21),a(7);var n=r(a(31)),l=r(a(38)),u=r(a(50));a(35);var o,c,s,i,f,d,p,m,h,v,E,y,g,b=r(a(39)),S=r(a(62)),_=r(a(25)),O=r(a(28)),C=r(a(45)),T=(r(a(63)),a(17)),R=r(a(872)),D=r(a(26)),k=a(56),N=r(a(245)),I=r(a(1199));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var w=(o=function(){function t(){var a=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,_.default)(this,t),(0,S.default)(this,"isLoading",c,this),(0,S.default)(this,"histogramTodayData",s,this),(0,S.default)(this,"histogramData",i,this),(0,S.default)(this,"interval",f,this),(0,S.default)(this,"data",d,this),(0,S.default)(this,"from",p,this),(0,S.default)(this,"total",m,this),(0,S.default)(this,"size",h,this),(0,S.default)(this,"namespaces",v,this),(0,S.default)(this,"logsCount",E,this),(0,S.default)(this,"headers",y,this),(0,S.default)(this,"changeTimeRang",g,this),Object.getOwnPropertyNames(r).forEach((function(e){a[e]=r[e]})),this.headers={"X-Remote-User":e.globals.user.username}}var a,r,n;return(0,O.default)(t,[{key:"fetchUrl",value:function(){return"kapis/logging.kubesphere.io/v1alpha2/events"}},{key:"fetchTodayHistogram",value:(n=(0,b.default)(l.default.mark((function e(){var t,a,r,n,o,c,s,i=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=t.cluster,r=(0,u.default)(t,["cluster"]),this.isLoading=!0,n={operation:"statistics",start_time:Math.ceil((0,N.default)().startOf("day").valueOf()/1e3),end_time:Math.ceil(Date.now()/1e3),interval:this.interval,cluster:a},e.next=5,(0,k.to)(request.get(this.fetchUrl(),(0,R.default)(n,r),{headers:this.headers}));case 5:o=e.sent,c=o.statistics,s=void 0===c?{}:c,this.isLoading=!1,this.histogramTodayData=s;case 10:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"fetchHistogram",value:(r=(0,b.default)(l.default.mark((function e(){var t,a,r,n,o,c,s,i=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=t.cluster,r=(0,u.default)(t,["cluster"]),this.isLoading=!0,n={operation:"histogram",start_time:Math.ceil(Date.now()/1e3)-43200,end_time:Math.ceil(Date.now()/1e3),interval:this.interval,cluster:a},e.next=5,(0,k.to)(request.get(this.fetchUrl(),(0,R.default)(n,r),{headers:this.headers}));case 5:o=e.sent,c=o.histogram,s=void 0===c?{}:c,this.logsCount=s.total||0,this.isLoading=!1,this.histogramData=s;case 11:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"fetchQuery",value:(a=(0,b.default)(l.default.mark((function e(){var t,a,r,n,o,c,s,i,f,d=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},a=t.cluster,r=(0,u.default)(t,["cluster"]),n=d.length>1&&void 0!==d[1]?d[1]:{},this.isLoading=!0,o={operation:"query",from:this.from,size:this.size,cluster:a},c=(0,R.default)(o,r),e.next=7,(0,k.to)(request.get(this.fetchUrl(),c),{headers:this.headers});case 7:s=e.sent,i=(0,D.default)(s,"query",{}),f=this.stripAnsiRecords(i.records||[]),this.data=n.loadMore?this.data.concat(f):f,this.total=i.total||0,this.isLoading=!1,this.from=c.from,this.size=c.size,this.preParams=c;case 16:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"stripAnsiRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return A(A({},e),{},{logStripANSI:(0,I.default)(e.log)})}))}}]),t}(),c=(0,C.default)(o.prototype,"isLoading",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),s=(0,C.default)(o.prototype,"histogramTodayData",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),i=(0,C.default)(o.prototype,"histogramData",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),f=(0,C.default)(o.prototype,"interval",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"30m"}}),d=(0,C.default)(o.prototype,"data",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=(0,C.default)(o.prototype,"from",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=(0,C.default)(o.prototype,"total",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=(0,C.default)(o.prototype,"size",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),v=(0,C.default)(o.prototype,"namespaces",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=(0,C.default)(o.prototype,"logsCount",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y=(0,C.default)(o.prototype,"headers",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),g=(0,C.default)(o.prototype,"changeTimeRang",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.time_rang=t,e.fetchQuery()}}}),(0,C.default)(o.prototype,"fetchTodayHistogram",[T.action],Object.getOwnPropertyDescriptor(o.prototype,"fetchTodayHistogram"),o.prototype),(0,C.default)(o.prototype,"fetchHistogram",[T.action],Object.getOwnPropertyDescriptor(o.prototype,"fetchHistogram"),o.prototype),(0,C.default)(o.prototype,"fetchQuery",[T.action],Object.getOwnPropertyDescriptor(o.prototype,"fetchQuery"),o.prototype),o);t.default=w}).call(this,a(75))},function(e,a,r){"use strict";r(16),r(4),r(21);var n=r(19);r(20),r(9),r(30),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.toArray=function e(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],n=Object.keys(t),l=a+1,c=0,s=n.length;c<s;c++){var i=n[c];if("object"===(0,o.default)(t[i])&&null!=t[i]){var f,d=t[i],p=e(d,l);r.push((f={},(0,u.default)(f,i,p),(0,u.default)(f,"collapsed",!1),(0,u.default)(f,"level",a),f))}else{var m;r.push((m={},(0,u.default)(m,i,t[i]),(0,u.default)(m,"level",a),m))}}return r},a.supportQueryParams=a.getSecond=a.queryModeOptions=a.dropDownItems=a.queryKeyMapping=void 0;var l=n(r(97)),u=n(r(31)),o=n(r(246));r(20),r(27),r(9),r(30),r(69);a.queryKeyMapping={workspace_filter:"workspace_search",involved_object_namespace_filter:"involved_object_namespace_search",involved_object_kind_filter:"involved_object_kind_filter",involved_object_name_filter:"involved_object_name_search",reason_filter:"reason_search",message_search:"message_search",type_filter:"type_filter"};var c={message_search:{icon:"magnifier",text:t("MESSAGE")},workspace_filter:{icon:"appcenter",text:t("WORKSPACE")},involved_object_namespace_filter:{icon:"project",text:t("PROJECT")},involved_object_kind_filter:{icon:"vnc",text:t("RESOURCE_TYPE")},involved_object_name_filter:{icon:"strategy-group",text:t("RESOURCE_NAME")},reason_filter:{icon:"resource",text:t("REASON")},type_filter:{icon:"cardview",text:t("CATEGORY")}};a.dropDownItems=c;var s=[1,0].map((function(e){return{value:e,label:e?t("EXACT_QUERY"):t("FUZZY_QUERY")}}));a.queryModeOptions=s;a.getSecond=function(e){var t=e.match(/(\d+)(\w+)/),a=(0,l.default)(t,3),r=a[1],n=void 0===r?0:r,u=a[2];return n*{s:1,m:60,h:3600,d:86400}[void 0===u?"s":u]};var i=[{icon:"magnifier",title:t("SEARCH_BY_MESSAGE"),tips:t("RESOURCE_EVENT_MESSAGE_TIP"),key:"message_search"},{icon:"appcenter",title:t("SEARCH_BY_WORKSPACE"),tips:t("RESOURCE_EVENT_WORKSPACE_TIP"),key:"workspace_filter"},{icon:"project",title:t("SEARCH_BY_PROJECT"),tips:t("RESOURCE_EVENT_PROJECT_TIP"),key:"involved_object_namespace_filter"},{icon:"vnc",title:t("SEARCH_BY_RESOURCE_TYPE"),tips:t("RESOURCE_EVENT_RESOURCE_TYPE_TIP"),key:"involved_object_kind_filter"},{icon:"strategy-group",title:t("SEARCH_BY_RESOURCE_NAME"),tips:t("RESOURCE_EVENT_RESOURCE_NAME_TIP"),key:"involved_object_name_filter"},{icon:"resource",title:t("SEARCH_BY_REASON"),tips:t("RESOURCE_EVENT_REASON_TIP"),key:"reason_filter"},{icon:"cardview",title:t("SEARCH_BY_CATEGORY"),tips:t("RESOURCE_EVENT_CATEGORY_TIP"),key:"type_filter"}];a.supportQueryParams=i},function(e,t,a){"use strict";(function(e){var r=a(19);a(12),a(3),a(10),a(6),a(20),a(8),a(13),a(970),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(3),a(10),a(6),a(20),a(27),a(442),a(33),a(16),a(8),a(13),a(970),a(9),a(4),a(21),a(7);var n=r(a(31)),l=r(a(38)),u=r(a(50));a(35);var o,c,s,i,f,d,p,m,h,v,E,y,g,b,S,_=r(a(39)),O=r(a(62)),C=r(a(25)),T=r(a(28)),R=r(a(45)),D=(r(a(63)),a(17)),k=r(a(872)),N=r(a(26)),I=a(56),P=r(a(245)),A=r(a(1199));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var M=(o=function(){function t(){var a=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,C.default)(this,t),(0,O.default)(this,"isLoading",c,this),(0,O.default)(this,"isHistogramTodayLoading",s,this),(0,O.default)(this,"isHistogramLoading",i,this),(0,O.default)(this,"histogramTodayData",f,this),(0,O.default)(this,"histogramData",d,this),(0,O.default)(this,"interval",p,this),(0,O.default)(this,"data",m,this),(0,O.default)(this,"from",h,this),(0,O.default)(this,"total",v,this),(0,O.default)(this,"size",E,this),(0,O.default)(this,"namespaces",y,this),(0,O.default)(this,"logsCount",g,this),(0,O.default)(this,"headers",b,this),(0,O.default)(this,"changeTimeRang",S,this),Object.getOwnPropertyNames(r).forEach((function(e){a[e]=r[e]})),this.headers={"X-Remote-User":e.globals.user.username}}var a,r,n;return(0,T.default)(t,[{key:"fetchUrl",value:function(){return"kapis/logging.kubesphere.io/v1alpha2/auditing"}},{key:"fetchTodayHistogram",value:(n=(0,_.default)(l.default.mark((function e(){var t,a,r,n,o,c,s,i=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=t.cluster,r=(0,u.default)(t,["cluster"]),this.isLoading=!0,this.isHistogramTodayLoading=!0,n={operation:"statistics",start_time:Math.ceil((0,P.default)().startOf("day").valueOf()/1e3),end_time:Math.ceil(Date.now()/1e3),interval:this.interval,cluster:a},e.next=6,(0,I.to)(request.get(this.fetchUrl(),(0,k.default)(n,r),{headers:this.headers}));case 6:o=e.sent,c=o.statistics,s=void 0===c?{}:c,this.isLoading=!1,this.isHistogramTodayLoading=!1,this.histogramTodayData=s;case 12:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"fetchHistogram",value:(r=(0,_.default)(l.default.mark((function e(){var t,a,r,n,o,c,s,i=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=t.cluster,r=(0,u.default)(t,["cluster"]),this.isLoading=!0,this.isHistogramLoading=!0,n={operation:"histogram",start_time:Math.ceil(Date.now()/1e3)-43200,end_time:Math.ceil(Date.now()/1e3),interval:this.interval,cluster:a},e.next=6,(0,I.to)(request.get(this.fetchUrl(),(0,k.default)(n,r),{headers:this.headers}));case 6:o=e.sent,c=o.histogram,s=void 0===c?{}:c,this.logsCount=s.total||0,this.isLoading=!1,this.isHistogramLoading=!1,this.histogramData=s;case 13:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"fetchQuery",value:(a=(0,_.default)(l.default.mark((function e(){var t,a,r,n,o,c,s,i,f,d=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},a=t.cluster,r=(0,u.default)(t,["cluster"]),n=d.length>1&&void 0!==d[1]?d[1]:{},this.isLoading=!0,o={operation:"query",from:this.from,size:this.size,cluster:a},c=(0,k.default)(o,r),e.next=7,(0,I.to)(request.get(this.fetchUrl(),c,{headers:this.headers}));case 7:s=e.sent,i=(0,N.default)(s,"query",{}),f=this.stripAnsiRecords(i.records||[]),this.data=n.loadMore?this.data.concat(f):f,this.total=i.total||0,this.isLoading=!1,this.from=c.from,this.size=c.size,this.preParams=c;case 16:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"stripAnsiRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return L(L({},e),{},{logStripANSI:(0,A.default)(e.log)})}))}}]),t}(),c=(0,R.default)(o.prototype,"isLoading",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),s=(0,R.default)(o.prototype,"isHistogramTodayLoading",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),i=(0,R.default)(o.prototype,"isHistogramLoading",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f=(0,R.default)(o.prototype,"histogramTodayData",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),d=(0,R.default)(o.prototype,"histogramData",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),p=(0,R.default)(o.prototype,"interval",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"30m"}}),m=(0,R.default)(o.prototype,"data",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=(0,R.default)(o.prototype,"from",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=(0,R.default)(o.prototype,"total",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),E=(0,R.default)(o.prototype,"size",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),y=(0,R.default)(o.prototype,"namespaces",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),g=(0,R.default)(o.prototype,"logsCount",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b=(0,R.default)(o.prototype,"headers",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),S=(0,R.default)(o.prototype,"changeTimeRang",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.time_rang=t,e.fetchQuery()}}}),(0,R.default)(o.prototype,"fetchTodayHistogram",[D.action],Object.getOwnPropertyDescriptor(o.prototype,"fetchTodayHistogram"),o.prototype),(0,R.default)(o.prototype,"fetchHistogram",[D.action],Object.getOwnPropertyDescriptor(o.prototype,"fetchHistogram"),o.prototype),(0,R.default)(o.prototype,"fetchQuery",[D.action],Object.getOwnPropertyDescriptor(o.prototype,"fetchQuery"),o.prototype),o);t.default=M}).call(this,a(75))},function(e,a,r){"use strict";r(16),r(4),r(21);var n=r(19);r(20),r(9),r(30),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.toArray=function e(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],n=Object.keys(t),l=a+1,c=0,s=n.length;c<s;c++){var i=n[c];if("object"===(0,o.default)(t[i])&&null!=t[i]){var f,d=t[i],p=e(d,l);r.push((f={},(0,u.default)(f,i,p),(0,u.default)(f,"collapsed",!1),(0,u.default)(f,"level",a),f))}else{var m;r.push((m={},(0,u.default)(m,i,t[i]),(0,u.default)(m,"level",a),m))}}return r},a.supportQueryParams=a.getSecond=a.queryModeOptions=a.dropDownItems=a.queryKeyMapping=a.httpcodes=void 0;var l=n(r(97)),u=n(r(31)),o=n(r(246));r(20),r(27),r(9),r(30),r(69);a.httpcodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested range not satisfiable",417:"Expectation Failed",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version not supported"};a.queryKeyMapping={workspace_filter:"workspace_search",objectref_namespace_filter:"objectref_namespace_search",objectref_name_filter:"objectref_name_search",objectref_resource_filter:"objectref_resource_filter",verb_filter:"verb_filter",response_code_filter:"response_code_filter",user_filter:"user_search",source_ip_search:"source_ip_search"};var c={workspace_filter:{icon:"appcenter",text:t("WORKSPACE")},objectref_namespace_filter:{icon:"project",text:t("PROJECT")},objectref_resource_filter:{icon:"resource",text:t("RESOURCE_TYPE")},objectref_name_filter:{icon:"strategy-group",text:t("RESOURCE_NAME")},verb_filter:{icon:"wrench",text:t("VERB")},response_code_filter:{icon:"logout",text:t("STATUS_CODE")},user_filter:{icon:"human",text:t("OPERATOR")},source_ip_search:{icon:"ip",text:t("SOURCE_IP_ADDRESS")}};a.dropDownItems=c;var s=[1,0].map((function(e){return{value:e,label:e?t("EXACT_QUERY"):t("FUZZY_QUERY")}}));a.queryModeOptions=s;a.getSecond=function(e){var t=e.match(/(\d+)(\w+)/),a=(0,l.default)(t,3),r=a[1],n=void 0===r?0:r,u=a[2];return n*{s:1,m:60,h:3600,d:86400}[void 0===u?"s":u]};var i=[{icon:"appcenter",title:t("SEARCH_BY_WORKSPACE"),tips:t("AUDIT_LOG_WORKSPACE_TIP"),key:"workspace_filter"},{icon:"project",title:t("SEARCH_BY_PROJECT"),tips:t("AUDIT_LOG_PROJECT_TIP"),key:"objectref_namespace_filter"},{icon:"resource",title:t("SEARCH_BY_RESOURCE_TYPE"),tips:t("AUDIT_LOG_RESOURCE_TYPE_TIP"),key:"objectref_resource_filter"},{icon:"strategy-group",title:t("SEARCH_BY_RESOURCE_NAME"),tips:t("AUDIT_LOG_RESOURCE_NAME_TIP"),key:"objectref_name_filter"},{icon:"wrench",title:t("SEARCH_BY_VERB"),tips:t("AUDIT_LOG_VERB_TIP"),key:"verb_filter"},{icon:"logout",title:t("SEARCH_BY_STATUS_CODE"),tips:t("AUDIT_LOG_STATUS_CODE_TIP"),key:"response_code_filter"},{icon:"human",title:t("SEARCH_BY_OPERATOR"),tips:t("AUDIT_LOG_OPERATOR_TIP"),key:"user_filter"},{icon:"ip",title:t("SEARCH_BY_SOURCE_IP_ADDRESS"),tips:t("AUDIT_LOG_SOURCE_IP_ADDRESS_TIP"),key:"source_ip_search"}];a.supportQueryParams=i},,,,,,,,,function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=n(r(326)),m=r(61),h=r(189),v=n(r(1131)),E=n(r(3214));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=function(e){(0,c.default)(r,e);var a=y(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.formRef,n=a.projectDetail,u=a.editModalTitle,o=a.title,c=a.formProps,s=(0,p.default)(n.clusters,"name");return f.default.createElement(h.Form,(0,l.default)({data:this.formTemplate.spec,ref:r},c),f.default.createElement(h.Form.Group,{label:t("STORAGE_SETTINGS"),desc:t("CLUSTER_VOLUME_DIFF_DESC"),checkable:!0},f.default.createElement(v.default,{clusters:this.clusters,clustersDetail:s,namespace:this.namespace},(function(t){return f.default.createElement(E.default,(0,l.default)({},t,{formTemplate:e.formTemplate,editModalTitle:u,title:o},c))}))))}},{key:"namespace",get:function(){return(0,d.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,m.MODULE_KIND_MAP[a],t)}},{key:"clusters",get:function(){return(0,d.default)(this.formTemplate,"spec.placement.clusters",[])}}]),r}(f.default.Component);a.default=g},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(44),r(6),r(20),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=n(r(38));r(35);var o=n(r(39)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(31));r(12),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var m,h,v,E=l(r(0)),y=n(r(26)),g=n(r(68)),b=n(r(67)),S=n(r(889)),_=r(17),O=r(243),C=n(r(5)),T=r(189),R=n(r(1)),D=n(r(541)),k=n(r(504)),N=n(r(451)),I=r(56),P=r(61),A=n(r(3221));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var x=(0,O.observer)((v=h=function(e){(0,i.default)(r,e);var a=M(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).snapshotStore=new D.default,e.snapshotClassStore=new k.default,e.volumeStore=new N.default,e.fetchSnapshots=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{limit:10},a=e.props,r=a.namespace,n=a.cluster;e.snapshotStore.fetchList(L(L({},t),{},{namespace:r,cluster:n,status:"ready"})).then((function(){var t=e.snapshotStore.list.data,a=(0,y.default)(t,"[0].name");a&&((0,g.default)(e.context.formData,"spec.dataSource.name",a),e.handeSnapshotChange(a))}))},e.fetchStorageClassDetail=function(){e.storageClassName&&e.storageClassName!==e.snapshotClassStore.detail.name&&e.snapshotClassStore.fetchDetail({cluster:e.props.cluster,name:e.storageClassName})},e.getSnapshotSourceVolumeInfo=function(t){var a=e.props,r=a.namespace,n=a.cluster;return e.volumeStore.fetchDetail({name:t,namespace:r,cluster:n})},e.handeSnapshotChange=function(){var t=(0,o.default)(u.default.mark((function t(a){var r,n;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.snapshotStore.list.data,n=(0,_.toJS)(r).find((function(e){return e.name===a}))||{},t.next=4,e.getSnapshotSourceVolumeInfo(n.snapshotSourceName);case 4:(0,g.default)(e.context.formData,"spec.resources.requests.storage",n.restoreSize),(0,g.default)(e.context.formData,"spec.storageClassName",e.volumeStore.detail.storageClassName),(0,g.default)(e.context.formData,"spec.dataSource.kind","VolumeSnapshot"),(0,g.default)(e.context.formData,"spec.dataSource.apiGroup","snapshot.storage.k8s.io"),e.fetchStorageClassDetail();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.storageClassName&&this.fetchStorageClassDetail()}},{key:"render",value:function(){var e=this.snapshotStore.list,a=e.data,r=e.total,n=e.page,l=e.isLoading,u=this.snapshotClassStore.isLoading,o=this.supportedAccessModes,c=(0,b.default)(o)?Object.keys(P.ACCESS_MODES):o,s=c.map((function(e){return{value:e,label:e}})),i="ReadWriteOnce"in c?["ReadWriteOnce"]:c.slice(0,1);return(0,g.default)(this.context.formData,"spec.accessModes",i),E.default.createElement(E.default.Fragment,null,E.default.createElement(T.Form.Item,{label:t("VOLUME_SNAPSHOT"),rules:[{required:!0,message:t("PARAM_REQUIRED")}],className:A.default.snapshotContainer},E.default.createElement(j,{className:A.default.snapshots,name:"spec.dataSource.name",snapshots:(0,_.toJS)(a),total:r,page:n,loading:l,onChange:this.handeSnapshotChange,onFetch:this.fetchSnapshots})),this.storageClassName&&E.default.createElement(T.Loading,{spinning:u},E.default.createElement(T.Form.Item,{className:"margin-t12",label:t("ACCESS_MODE"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},E.default.createElement(T.Select,{name:"spec.accessModes",options:s,multi:!0}))))}},{key:"storageClassName",get:function(){return(0,y.default)(this.context.formData,"spec.storageClassName")}},{key:"supportedAccessModes",get:function(){return(0,I.safeParseJSON)((0,y.default)(this.snapshotClassStore.detail,'annotations["storageclass.kubesphere.io/supported-access-modes"]',""))}}]),r}(E.Component),h.contextTypes={formData:R.default.object},m=v))||m;function j(e){var a=e.onChange,r=e.snapshots,n=e.total,l=e.page,u=e.loading,o=e.onFetch,c=e.value,s=e.className;return E.default.createElement(S.default,{className:s,data:r,total:n,page:l,loading:u,onFetch:o},r.map((function(e){return E.default.createElement("div",{className:(0,C.default)((0,p.default)({},A.default.selected,e.name===c),A.default.snapshot),key:e.uid,onClick:function(){return a(e.name)}},E.default.createElement(T.Icon,{name:"snapshot",type:e.name===c?"light":"dark",size:40}),E.default.createElement("div",null,E.default.createElement("h3",null,e.name),E.default.createElement("p",null,e.snapshotClassName)),E.default.createElement("div",null,E.default.createElement("h3",null,e.restoreSize||0),E.default.createElement("p",null,t("CAPACITY"))),E.default.createElement("div",null,E.default.createElement("h3",null,e.createTime),E.default.createElement("p",null,t("CREATION_TIME_TCAP"))))})))}a.default=x},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(70),r(14),r(4),r(18),r(11),r(73),r(79),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(70),r(29),r(14),r(4),r(18),r(43),r(11),r(73),r(79);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(119)),d=n(r(26)),p=n(r(68)),m=n(r(196)),h=r(61),v=r(189),E=n(r(827)),y=n(r(996)),g=n(r(1516)),b=n(r(3222)),S=n(r(3224)),_=n(r(3225));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var C=[{icon:"snapshot",value:"snapshot",get label(){return t("CREATE_VOLUME_BY_SNAPSHOT")},get description(){return t("SELECT_SNAPSHOT_TO_CREATE_VOLUME")}},{icon:"database",value:"storageClass",get label(){return t("CREATE_VOLUME_BY_STORAGE_CLASS")},get description(){return t("SELECT_STORAGE_CLASS_CREATE_VOLUME")}},{icon:"meta-data",value:"pv",get label(){return t("BIND_EXISTING_PVC")},get description(){return t("BIND_EXISTING_PVC_DESC")}},{icon:"storage",value:"nas",get label(){return t("BIND_EXISTING_NAS")},get description(){return t("BIND_EXISTING_NAS_DESC")}}],T=function(e){return(0,d.default)(e,"spec.volumeName")?"pv":(0,d.default)(e,"spec.dataSource.name")?"snapshot":(0,d.default)(e,'metadata.annotations["storage.kubesphere.io/nfs-static-provision"]')?"nas":"storageClass"},R=function(e){(0,o.default)(r,e);var a=O(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).state={fromSnapshot:T(e.formTemplate)},e.isClusterAdmin=function(){return(0,d.default)(window,"globals.user.globalRules.clusters",[]).includes("manage")},e.handleChangePv=function(t,a){var r,n=null!==(r=a.find((function(e){return(null==e?void 0:e.name)===t})))&&void 0!==r?r:{};(0,p.default)(e.fedFormTemplate,"spec.accessModes",n.accessModes),(0,p.default)(e.fedFormTemplate,"spec.resources.requests.storage",n.capacity),(0,p.default)(e.fedFormTemplate,"spec.storageClassName",n.storageClassName||""),(0,p.default)(e.fedFormTemplate,"spec.volumeMode",n.volumeMode)},e.handleChange=function(t){if(t!==e.state.fromSnapshot){var a=e.fedFormTemplate.metadata.annotations;if((0,m.default)(e.fedFormTemplate,"spec.storageClassName"),(0,p.default)(e.fedFormTemplate,"spec.accessModes",[]),(0,p.default)(e.fedFormTemplate,"spec.dataSource",{}),(0,p.default)(e.fedFormTemplate,"spec.resources.requests.storage","0Gi"),"storageClass"!==t&&"nas"!==t||(0,p.default)(e.fedFormTemplate,"spec.resources.requests.storage","10Gi"),"nas"!==t)for(var r in a)r.startsWith("storage.kubesphere.io/")&&delete a[r];e.setState({fromSnapshot:t})}},e}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.isFederated,n=e.cluster,l=e.namespace,u=this.state.fromSnapshot;return i.default.createElement(v.Form,{data:this.fedFormTemplate,ref:a,className:_.default.wrapper},!r&&i.default.createElement(v.Form.Item,{label:t("CREATION_METHOD")},i.default.createElement(E.default,{value:u,options:this.createTypeOption,onChange:this.handleChange})),"snapshot"===u&&i.default.createElement(g.default,{namespace:(0,d.default)(this.formTemplate,"metadata.namespace"),cluster:n}),"nas"===u&&i.default.createElement(b.default,{namespace:(0,d.default)(this.formTemplate,"metadata.namespace"),cluster:n,fedFormTemplate:this.fedFormTemplate}),"pv"===u&&i.default.createElement(v.Form.Item,{label:t("PERSISTENT_VOLUME"),rules:[{required:!0,message:t("PLEASE_SELECT_PERSISTENT_VOLUME")}],desc:this.isClusterAdmin()&&this.props.onAddPv?i.default.createElement("span",{className:_.default.action,onClick:this.props.onAddPv},t.html("ADMIN_CREATE_PV_DESC")):t("PV_EMPTY_DESC")},i.default.createElement(S.default,{name:"spec.volumeName",cluster:n,onChange:this.handleChangePv})),"snapshot"!==u&&"pv"!==u&&"nas"!==u&&i.default.createElement(y.default,{cluster:n,isFederated:r,namespace:l}))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,h.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,d.default)(this.formTemplate,"spec.template"):this.formTemplate}},{key:"createTypeOption",get:function(){var e=(0,f.default)(C);return globals.app.hasKSModule("storage-utils")||e.shift(),e}}]),r}(i.default.Component);a.default=R},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(56),l=r(a(911)),u=r(a(900)),o=r(a(915)),c=r(a(963)),s=[{title:"BASIC_INFORMATION",icon:"cdn",component:l.default,required:!0},{title:"POD_SETTINGS",icon:"docker",component:(0,n.withProps)(u.default,{withService:!0}),required:!0},{title:"STORAGE_SETTINGS",icon:"storage",component:o.default,required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:c.default,required:!0}];t.default=s},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(911)),l=r(a(900)),u=r(a(915)),o=r(a(963)),c=[{title:"BASIC_INFORMATION",icon:"cdn",component:n.default,required:!0},{title:"POD_SETTINGS",icon:"docker",component:l.default,required:!0},{title:"STORAGE_SETTINGS",icon:"storage",component:u.default,required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:o.default,required:!0}];t.default=c},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=r(189),p=n(r(805)),m=r(61);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props.formRef;return i.default.createElement(d.Form,{data:this.formTemplate,ref:e},i.default.createElement(d.Columns,null,i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("MAXIMUM_RETRIES"),desc:t("MAXIMUM_RETRIES_DESC")},i.default.createElement(p.default,{min:0,name:"".concat(this.prefix,"backoffLimit"),integer:!0})),i.default.createElement(d.Form.Item,{label:t("PARALLEL_PODS"),desc:t("PARALLEL_PODS_DESC")},i.default.createElement(p.default,{min:0,name:"".concat(this.prefix,"parallelism"),integer:!0}))),i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("COMPLETE_PODS"),desc:t("COMPLETE_PODS_DESC")},i.default.createElement(p.default,{min:0,name:"".concat(this.prefix,"completions"),integer:!0})),i.default.createElement(d.Form.Item,{label:t("MAXIMUM_DURATION"),desc:t("MAXIMUM_DURATION_DESC")},i.default.createElement(p.default,{min:0,name:"".concat(this.prefix,"activeDeadlineSeconds"),integer:!0})))))}},{key:"prefix",get:function(){return this.props.prefix||"spec."}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,f.default)(t,m.MODULE_KIND_MAP[a],t)}}]),r}(i.default.Component);a.default=v},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(243),p=r(189),m=n(r(900));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=(0,d.observer)(l=function(e){(0,c.default)(r,e);var a=h(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"getRestartPolicyOptions",value:function(){return[{label:t("RESTART_POLICY_NEVER_DESC"),value:"Never"},{label:t("RESTART_POLICY_ONFAILURE_DESC"),value:"OnFailure"}]}},{key:"renderRestartPolicy",value:function(){return f.default.createElement(p.Form.Item,{label:t("RESTART_POLICY"),desc:t("RESTART_POLICY_DESC")},f.default.createElement(p.Select,{name:"".concat(this.prefix,"spec.restartPolicy"),options:this.getRestartPolicyOptions()}))}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.showContainer,r=t.selectContainer;return a?this.renderContainerForm(r):f.default.createElement(p.Form,{data:this.formTemplate,ref:e},this.renderRestartPolicy(),this.renderContainerList())}}]),r}(m.default))||l;a.default=v},,,function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(51),Object.defineProperty(t,"__esModule",{value:!0}),t.CREATE_WORKLOAD_TEMPLATE_FORM_STEPS=t.default=void 0,a(3),a(51);var n=r(a(58)),l=r(a(1178)),u=r(a(1518)),o=r(a(1519)),c=r(a(3274)),s={deployments:l.default,statefulsets:u.default,daemonsets:o.default};t.default=s;var i={deployments:[{title:"BASIC_INFORMATION",icon:"cdn",component:c.default,required:!0}].concat((0,n.default)(l.default.slice(1))),statefulsets:[{title:"BASIC_INFORMATION",icon:"cdn",component:c.default,required:!0}].concat((0,n.default)(u.default.slice(1))),daemonsets:[{title:"BASIC_INFORMATION",icon:"cdn",component:c.default,required:!0}].concat((0,n.default)(o.default.slice(1)))};t.CREATE_WORKLOAD_TEMPLATE_FORM_STEPS=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){var r={"./PV.js":1696,"./alarm.center.js":1730,"./alerting.js":1909,"./appedgetemplate.js":1955,"./application.js":1969,"./apptemplates.js":2234,"./cd.js":2320,"./cluster.js":2333,"./clusterPod.js":2380,"./clusterTags.js":2383,"./codeRepo.js":2395,"./configmap.js":2409,"./configuration.js":2417,"./custom.monitoring.js":2425,"./customScaling.js":2541,"./devops.credential.js":2584,"./devops.js":2585,"./edgeNode.js":2592,"./federated.js":2593,"./gateways.js":2617,"./group.js":2624,"./imagebuilder.js":2625,"./index.js":791,"./license.js":2631,"./log.collection.js":2634,"./member.js":2644,"./microservice.js":2649,"./microservicegateway.js":2660,"./network.js":2668,"./node.group.ext.js":2691,"./node.js":2694,"./notification.js":2706,"./openpitrix.js":2730,"./pipeline.js":2856,"./platform.js":2938,"./project.js":2943,"./resource.delete.js":2960,"./resource.edit.js":2963,"./role.js":2965,"./router.js":2974,"./secret.js":2982,"./service.js":2995,"./serviceaccount.js":3008,"./servicerouting.js":3013,"./silentPolicy.js":3018,"./storageclass.js":3029,"./toolbox.js":3048,"./user.js":3196,"./volume.js":3208,"./whizard.js":3232,"./workload.js":3252,"./workloadTemplate.js":3271,"./workspace.js":3279};function n(e){var t=l(e);return a(t)}function l(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=l,e.exports=n,n.id=1695},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(70),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(44),r(6),r(70),r(36),r(66),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(798)),f=n(r(822)),d=n(r(819)),p=n(r(438)),m=n(r(26)),h=n(r(244)),v=n(r(1722));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={"pv.delete":{on:function(e){var a=e.store,r=e.detail,n=(e.type,e.rowKey,e.success),l=(0,c.default)(e,["store","detail","type","rowKey","success"]),u=i.default.open(y({onOk:function(){a.delete(r).then((function(){i.default.close(u),s.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n()}))},store:a,modal:f.default,type:"PERSISTENT_VOLUME",resource:r.name},l))}},"pv.batch.delete":{on:function(e){var a,r=e.store,n=e.success,o=e.rowKey,d=(0,c.default)(e,["store","success","rowKey"]),p=r.list,m=p.data,h=p.selectedRowKeys,v=m.filter((function(e){return h.includes(e[o])})).map((function(e){return{name:e.name,namespace:e.namespace}})),E=v.map((function(e){return e.name})),g=i.default.open(y({onOk:(a=(0,u.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],m.forEach((function(e){v.find((function(t){return t.name===e.name&&t.namespace===e.namespace}))&&a.push(r.delete(e))})),e.next=4,Promise.all(a);case 4:i.default.close(g),s.default.success({content:t("DELETED_SUCCESSFULLY")}),r.setSelectRowKeys([]),n&&n();case 8:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),resource:E.join(", "),type:"PERSISTENT_VOLUME",modal:f.default,store:r},d))}},"pv.create":{on:function(e){var a,r,n=e.store,l=e.success,u=(0,c.default)(e,["store","success"]),o={PersistentVolume:null!==(a=null===(r=p.default[n.module])||void 0===r?void 0:r.call(p.default))&&void 0!==a?a:{}},f=i.default.open(y({onOk:function(e){var a=(0,m.default)(e,"PersistentVolume");n.create((0,h.default)(u,["cluster","workspace","namespace"]),a).then((function(){i.default.close(f),s.default.success({content:t("CREATED_SUCCESSFULLY")}),l&&l()}))},name:"PERSISTENT_VOLUME",formTemplate:o,modal:d.default,module:n.module,steps:v.default,store:n},u))}}};a.default=g},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1723)),l=r(a(1724)),u=[{title:"BASIC_INFORMATION",component:n.default,required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:l.default,required:!0}];t.default=u},function(e,a,r){"use strict";r(16);var n=r(162);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(0)),u=r(189),o=r(61),c=function(e){var a=e.formRef,r=e.formTemplate;return l.createElement(u.Form,{ref:a,data:r.PersistentVolume},l.createElement(u.Columns,null,l.createElement(u.Column,null,l.createElement(u.Form.Item,{label:t("NAME"),desc:t("LONG_NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:o.PATTERN_NAME,message:t("LONG_NAME_DESC")}]},l.createElement(u.Input,{name:"metadata.name",maxLength:253}))),l.createElement(u.Column,null,l.createElement(u.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:o.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},l.createElement(u.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),l.createElement(u.Columns,null,l.createElement(u.Column,null,l.createElement(u.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},l.createElement(u.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))))};a.default=c},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(44),r(6),r(20),r(51),r(14),r(24),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(44),r(6),r(20),r(27),r(51),r(860),r(14),r(24),r(33),r(16),r(8),r(13),r(9),r(4),r(321),r(30),r(195),r(7);var u=l(r(317)),o=l(r(31)),c=l(r(97)),s=r(189),i=l(r(894)),f=l(r(26)),d=l(r(67)),p=l(r(163)),m=l(r(244)),h=l(r(68)),v=l(r(196)),E=r(17),y=r(243),g=n(r(0)),b=l(r(453)),S=r(56),_=r(61),O=l(r(1725)),C=l(r(1729));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var D=(0,y.observer)((function(e){var a=e.formRef,r=e.formTemplate,n=(0,y.useLocalStore)((function(){return new b.default})),l=g.useState(!1),o=(0,c.default)(l,2),T=o[0],D=o[1],k=g.useState([]),N=(0,c.default)(k,2),I=N[0],P=N[1],A=g.useState({}),w=(0,c.default)(A,2),L=w[0],M=w[1],x=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};D(!0);var l=e.formData,u=(0,f.default)(l,"spec.storageClassName");return n.fetchList(R(R({},a),{},{cluster:e.cluster})).then((function(){var e=(0,E.toJS)(n.list.data),a=e.map((function(e){return{label:e.name,value:e.name}}));a.unshift({label:t("EMPTY"),value:""}),P(a);var l=e.find((function(e){return u===e.name}))||e.find((function(e){return e.default}))||{};M(l),(0,d.default)(r.PersistentVolume,"spec.csi")||(0,f.default)(r.PersistentVolume,"spec.csi.driver")||!/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/.test(l.provisioner)||(0,h.default)(r.PersistentVolume,"spec.csi.driver",l.provisioner),D(!1)}))};(0,g.useEffect)((function(){x()}),[]);var j=n.list||{},U=g.useMemo((function(){var e,t=(e=null,L&&(e=(0,S.safeParseJSON)((0,f.default)(L,'annotations["storageclass.kubesphere.io/supported-access-modes"]',""))),(0,p.default)(e)?[]:e);return(0,d.default)(t)?Object.keys(_.ACCESS_MODES):t}),[L]),F=g.useMemo((function(){return U.map((function(e){return{value:e,label:e}}))}),[U]),V=g.useMemo((function(){return"ReadWriteOnce"in U?["ReadWriteOnce"]:U.slice(0,1)}),[U]);return g.createElement("div",{className:C.default.wrapper},g.createElement(s.Form,{ref:a,data:r.PersistentVolume},g.createElement(s.Columns,null,g.createElement(s.Column,null,g.createElement(s.Form.Item,{label:t("STORAGE_CLASS"),desc:t("VOLUME_STORAGE_CLASS_DESC")},g.createElement(s.Select,{name:"spec.storageClassName",defaultValue:L.name,pagination:(0,m.default)(j,["page","limit","total"]),isLoading:j.isLoading,onChange:function(e){var t=n.list.data.find((function(t){return t.name===e}))||{};(0,v.default)(r.PersistentVolume,"spec.accessModes"),(0,f.default)(r.PersistentVolume,"spec.csi")&&(0,h.default)(r.PersistentVolume,"spec.csi.driver",t.provisioner),M(t)},options:I,onFetch:x,searchable:!0,clearable:!0}))),g.createElement(s.Column,null,g.createElement(s.Form.Item,{label:t("ACCESS_MODE"),rules:[{required:!0,message:t("PARAM_REQUIRED")}],desc:t("ACCESS_MODES_DESC")},g.createElement(s.Select,{name:"spec.accessModes",options:F,loading:T,defaultValue:V,multi:!0})))),g.createElement("div",{className:C.default.slider},g.createElement(s.Form.Item,{className:C.default.slider,label:t("VOLUME_CAPACITY"),rules:[{validator:function(e,a,r){return parseInt(a,10)<=0?r({message:t("VOLUME_SIZE_TIP"),field:e.field}):r()}}]},g.createElement(i.default,(0,u.default)({name:"spec.capacity.storage"},function(){var e={min:0,max:2048,defaultValue:"10Gi",step:1,unit:"Gi"},t=Number((0,f.default)(L,"parameters.minSize")),a=Number((0,f.default)(L,"parameters.maxSize")),r=Number((0,f.default)(L,"parameters.stepSize"));isNaN(t)||(e.min=t),isNaN(a)||(e.max=a),isNaN(r)||(e.step=r);for(var n=(e.max/e.step-e.min/e.step)/4,l={},u=0;u<4;u++){var o=Math.floor(n*u)*e.step+e.min;l[o]=0===o?"0":"".concat(o,"Gi")}return l[e.max]="".concat(e.max,"Gi"),e.marks=l,e}(),{withInput:!0})))),g.createElement(s.Columns,null,g.createElement(s.Column,null,g.createElement(s.Form.Item,{label:t("VOLUME_MODE")},g.createElement(s.Select,{name:"spec.volumeMode",options:[{label:t("VOLUME_MODE_FILESYSTEM"),value:"Filesystem"},{label:t("BLOCK"),value:"Block"}]}))),g.createElement(s.Column,null,g.createElement(s.Form.Item,{label:t("RECLAIM_POLICY")},g.createElement(s.Select,{name:"spec.persistentVolumeReclaimPolicy",options:[{label:"Retain",value:"Retain"},{label:"Delete",value:"Delete"}]})))),g.createElement(O.default,{formTemplate:r.PersistentVolume})))}));a.default=D},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(44),r(6),r(20),r(99),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(44),r(6),r(20),r(27),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(7);var u=l(r(31)),o=l(r(97)),c=r(189),s=l(r(119)),i=l(r(26)),f=l(r(67)),d=l(r(68)),p=l(r(196)),m=n(r(0)),h=l(r(829)),v=l(r(1728));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g=[{label:"NODE_EXPAND_KEY",key:"nodeExpandSecretRef"},{label:"NODE_PUBLISH_KEY",key:"nodePublishSecretRef"},{label:"NODE_STAGING_KEY",key:"nodeStageSecretRef"},{label:"CONTROLLER_EXPAND_KEY",key:"controllerExpandSecretRef"},{label:"CONTROLLER_PUBLISH_KEY",key:"controllerPublishSecretRef"}],b=[{label:"ANY_PATH",value:""},{label:"DIRECTORY_OR_CREATE",value:"DirectoryOrCreate"},{label:"FILE_OR_CREATE",value:"FileOrCreate"},{label:"DIRECTORY_EXIST",value:"Directory"},{label:"FILE_EXIST",value:"File"},{label:"SOCKET_EXIST",value:"Socket"},{label:"CHARACTER_DEVICE_EXIST",value:"CharDevice"},{label:"BLOCK_DEVICE_EXIST",value:"BlockDevice"}],S={CSI:"spec.csi",HostPath:"spec.hostPath",NFS:"spec.nfs"},_=function(e){var a,r,n=e.formTemplate,l=m.useState(null!==(a=null===(r=Object.entries(S).find((function(e){var t=(0,o.default)(e,2)[1];return!(0,f.default)((0,i.default)(n,t))})))||void 0===r?void 0:r[0])&&void 0!==a?a:"CSI"),u=(0,o.default)(l,2),E=u[0],_=u[1],O=m.useState(!1),C=(0,o.default)(O,2),T=C[0],R=C[1],D=m.useRef((0,s.default)(n)),k=function(){R(!T)};return m.createElement("div",{className:v.default.wrapper},m.createElement("div",{className:v.default.title},t("VOLUME_TYPE")),m.createElement("div",{className:v.default.container},m.createElement("div",{className:v.default.radioGroup},m.createElement(c.RadioGroup,{value:E,onChange:function(e){(0,d.default)(D.current,S[E],(0,s.default)((0,i.default)(n,S[E]))),(0,p.default)(n,S[E]),(0,f.default)((0,i.default)(n,S[e]))&&!(0,f.default)((0,i.default)(D.current,S[e]))&&(0,d.default)(n,S[e],(0,i.default)(D.current,S[e])),_(e)}},["CSI","HostPath","NFS"].map((function(e){return m.createElement(c.RadioButton,{key:e,value:e},e)})))),m.createElement("div",{className:v.default.itemWrapper},"CSI"!==E?null:m.createElement("div",null,m.createElement("div",{className:v.default.itemGrid},m.createElement(c.Form.Item,{label:t("DRIVER"),rules:[{required:!0,message:t("DRIVER_REQUIRED")},{pattern:/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/,message:t("DRIVER_FORMAT_ERROR")}]},m.createElement(c.Input,{placeholder:t("DRIVER_PLACEHOLDER"),name:"spec.csi.driver"})),m.createElement(c.Form.Item,{label:t("FSTYPE")},m.createElement(c.Input,{placeholder:t("FSTYPE_PLACEHOLDER"),name:"spec.csi.fsType"})),m.createElement(c.Form.Item,{label:t("VOLUME_HANDLE"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},m.createElement(c.Input,{name:"spec.csi.volumeHandle"})),m.createElement(c.Form.Item,{label:t("READ_ONLY")},m.createElement(c.Select,{defaultValue:!1,name:"spec.csi.readOnly",options:[{label:t("TRUE"),value:!0},{label:t("FALSE"),value:!1}]}))),m.createElement(c.Form.Item,{label:t("VOLUME_ATTRIBUTES"),className:"margin-t12"},m.createElement(h.default,{name:"spec.csi.volumeAttributes",addText:t("ADD")})),m.createElement("div",{className:v.default.advanced,onClick:k},m.createElement("span",null,t("ADVANCED_SETTINGS")),m.createElement(c.Icon,{name:T?"chevron-up":"chevron-down",size:"20",color:{primary:"#329dce"}})),T&&m.createElement("div",{className:v.default.advancedContainer},g.map((function(e){return m.createElement("div",{className:v.default.advancedItem,key:e.key},m.createElement("span",{className:v.default.advancedItemTitle},t(e.label)),m.createElement(c.Form.Item,null,m.createElement(c.Input,{name:"spec.csi.".concat(e.key,".name"),placeholder:t("NAME")})),m.createElement(c.Form.Item,null,m.createElement(c.Input,{placeholder:t("PROJECT"),name:"spec.csi.".concat(e.key,".namespace")})))})))),"HostPath"!==E?null:m.createElement("div",{className:v.default.itemGrid},m.createElement(c.Form.Item,{label:t("HOST_PATH"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},m.createElement(c.Input,{name:"spec.hostPath.path"})),m.createElement(c.Form.Item,{label:t("PATH_TYPE")},m.createElement(c.Select,{name:"spec.hostPath.type",defaultValue:"",options:b.map((function(e){return y(y({},e),{},{label:t(e.label)})}))}))),"NFS"!==E?null:m.createElement("div",{className:v.default.itemGrid},m.createElement(c.Form.Item,{label:t("PATH"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},m.createElement(c.Input,{name:"spec.nfs.path"})),m.createElement(c.Form.Item,{label:t("SERVER_IP_ADDRESS"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},m.createElement(c.Input,{name:"spec.nfs.server"})),m.createElement(c.Form.Item,{label:t("READ_ONLY")},m.createElement(c.Select,{defaultValue:!1,name:"spec.nfs.readOnly",options:[{label:t("TRUE"),value:!0},{label:t("FALSE"),value:!1}]}))))))};a.default=_},,,function(e,t,a){e.exports={wrapper:"_3hU0gfsokxtJmojpZ7dno_",title:"_3lQt_YNhnKM35H-UFisN2D",container:"_3SRENc1cP-xe_SYvL2hkXj",itemWrapper:"jUX-oWNxLfbT_aMD_i3O_",itemGrid:"_3owrGQcJ9GedSfdqKm8pc4",radioGroup:"dWhyvTjqv55p87DIhQg2v",advanced:"SguGGr331-i5zEZhcPqKm",advancedItem:"_3lWqb1SrJ0OFHrRD3ncFUX",advancedItemTitle:"_2MSEwtb_WH_a_nMPRi1JCr"}},function(e,t,a){e.exports={wrapper:"_1lRAg4c9GRI767PP_ovCWl",slider:"vkbOgMKlSx5hi1gKBjf43"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(88),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(88),r(36),r(66),r(20),r(27),r(141),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(119)),i=n(r(26)),f=n(r(67)),d=n(r(68)),p=r(17),m=n(r(191)),h=n(r(978)),v=n(r(798)),E=n(r(822)),y=n(r(819)),g=n(r(1256)),b=n(r(1276)),S=n(r(1277)),_=n(r(1124)),O=r(61),C=n(r(438)),T=n(r(864)),R=n(r(1908)),D=r(56);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var I={"alerting.multi.policy.create":{on:function(e){var a,r=e.store,n=e.cluster,o=e.namespace,p=e.module,h=e.success,E=e.detail,g=(0,c.default)(e,["store","cluster","namespace","module","success","detail"]),b=O.MODULE_KIND_MAP[p],S=E?(0,s.default)(E):C.default[p]({multi:!0}),_=v.default.open(N({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((u=(0,i.default)(a,"spec.rules",[])).length<1)){e.next=3;break}return e.abrupt("return",m.default.warning({content:t("RULES_LIST_EMPTY")}));case 3:if(u.forEach((function(e){var t=(0,i.default)(e,"exprBuilder",{}),a=(0,i.default)(e,"namespaceSelector.inValues",[]);if((0,f.default)(t)&&!(0,f.default)(a)){var r=a.map((function(e){return e.namespace}));e.namespaceSelector.inValues=r}if(!(0,f.default)(t)){if(t.workload){var n=e.exprBuilder.workload.kind;(0,d.default)(e,"exprBuilder.workload.kind",(0,D.capitalize)(n))}delete e.clusterSelector}})),!E){e.next=10;break}return e.next=7,r.update(E,a);case 7:m.default.success({content:t("UPDATE_SUCCESSFUL")}),e.next=13;break;case 10:return e.next=12,r.create(a,{name:a.metadata.name,cluster:n,namespace:o});case 12:m.default.success({content:t("CREATE_SUCCESSFUL")});case 13:v.default.close(_),h&&h(),T.default.delete("".concat(p,"_create_form"));case 16:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),module:p,cluster:n,namespace:o,name:b,formTemplate:S,modal:y.default,steps:R.default,noCodeEdit:!0,isEdit:!!E,okBtnText:E?t("OK"):t("CREATE"),store:r},g))}},"multi.alerting.baseInfo.edit":{on:function(e){var a=e.type,r=e.store,n=e.detail,l=e.success,u=(0,c.default)(e,["type","store","detail","success"]),o=v.default.open(N({onOk:function(e){var u=(0,s.default)(e);(0,i.default)(u,"spec.interval").length<2&&(0,d.default)(u,"spec.interval",""),r.patch(N(N({},n),{},{type:a}),u).then((function(){v.default.close(o),m.default.success({content:t("UPDATE_SUCCESSFUL")}),l&&l()}))},detail:n,modal:b.default,store:r},u))}},"multi.alerting.yaml.edit":{on:function(e){var a=e.type,r=e.store,n=e.detail,o=e.success,s=(e.cluster,e.namespace,(0,c.default)(e,["type","store","detail","success","cluster","namespace"])),f="";"builtin"===a&&(f=(0,i.default)(n._originData,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',""));var p,E=v.default.open(N({onOk:(p=(0,u.default)(l.default.mark((function e(u){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"builtin"===a&&((0,d.default)(u,"apiVersion",r.yamlApiVersion),(0,d.default)(u,"kind","GlobalRuleGroup"),(0,d.default)(u,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',f)),e.next=3,r.update(N(N({},n),{},{type:a}),u);case 3:m.default.success({content:t("UPDATE_SUCCESSFUL")}),v.default.close(E),o&&o();case 6:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)}),detail:N(N({},n),{},{type:a}),store:r,type:a,modal:h.default},s))}},"multi.alerting.rule.edit":{on:function(e){var a=e.type,r=e.store,n=e.detail,o=e.success,s=e.cluster,p=e.namespace,h=(e.title,(0,c.default)(e,["type","store","detail","success","cluster","namespace","title"])),E="";"builtin"===a&&(E=(0,i.default)(n._originData,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',""));var b,S=v.default.open(N({onOk:(b=(0,u.default)(l.default.mark((function e(u){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return""===(0,i.default)(n,"_originData.apiVersion","")&&((0,d.default)(u,"apiVersion",r.yamlApiVersion),(0,d.default)(u,"kind","GlobalRuleGroup")),(0,i.default)(u,"spec.rules",[]).forEach((function(e){var t=(0,i.default)(e,"exprBuilder",{}),a=(0,i.default)(e,"namespaceSelector.inValues",[]);if((0,f.default)(t)&&!(0,f.default)(a)){var r=a.map((function(e){return e.namespace}));e.namespaceSelector.inValues=r}if(!(0,f.default)(t)){if(t.workload){var n=e.exprBuilder.workload.kind;(0,d.default)(e,"exprBuilder.workload.kind",(0,D.capitalize)(n))}delete e.clusterSelector}})),"builtin"===a&&(0,d.default)(u,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',E),e.next=6,r.update(N(N({},n),{},{type:a}),u);case 6:m.default.success({content:t("UPDATE_SUCCESSFUL")}),v.default.close(S),o&&o();case 9:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)}),store:r,resource:n.name,detail:n,title:t("EDIT_ALERT_RULES"),icon:"pen",modal:y.default,steps:[{title:"ALERTING_RULE",component:g.default,required:!0}],noCodeEdit:!0,okBtnText:t("OK"),formTemplate:n._originData,namespace:p,cluster:s,editMode:!0,type:a},h))}},"multi.enable.alarm.rule":{on:function(e){var a=e.type,r=e.store,n=e.detail,l=e.success,u=e.cluster,o=void 0===u?"":u,c=e.namespace,s=void 0===c?"":c,f=e.batchMode,d=e.enabled,h=void 0!==d&&d,v=(0,i.default)((0,p.toJS)(r.list),"selectedRowKeys",[]);f?r.batchPatch(v,{cluster:o,namespace:s,type:a},{metadata:{labels:{"alerting.kubesphere.io/enable":JSON.stringify(!h)}}}).then((function(){m.default.success({content:t("ENABLE_SUCCESSFUL")}),l&&l()})):r.patch({cluster:o,namespace:s,name:n.name,type:a},{metadata:{labels:{"alerting.kubesphere.io/enable":JSON.stringify(!h)}}}).then((function(){m.default.success({content:t("ENABLE_SUCCESSFUL")}),l&&l()}))}},"multi.alarm.rule.update":{on:function(e){var a=e.type,r=e.store,n=e.detail,l=e.success,u=e.cluster,o=void 0===u?"":u,s=e.namespace,f=void 0===s?"":s,d=e.title,h=e.batchMode,y=e.resourceName,g=e.enabled,b=void 0!==g&&g,S=(0,c.default)(e,["type","store","detail","success","cluster","namespace","title","batchMode","resourceName","enabled"]),_=(0,i.default)((0,p.toJS)(r.list),"selectedRowKeys",[]),O=h?_.join(","):n.name,C=v.default.open(N({onOk:function(){h?r.batchPatch(_,{cluster:o,namespace:f,type:a},{metadata:{labels:{"alerting.kubesphere.io/enable":JSON.stringify(!b)}}}).then((function(){v.default.close(C),m.default.success({content:t("UPDATE_SUCCESSFUL")}),l&&l()})):r.patch({cluster:o,namespace:f,name:n.name,type:a},{metadata:{labels:{"alerting.kubesphere.io/enable":JSON.stringify(!b)}}}).then((function(){v.default.close(C),m.default.success({content:t("UPDATE_SUCCESSFUL")}),l&&l()}))},store:r,icon:"information",modal:E.default,type:y,resource:O,title:d},S))}},"multi.alerting.rule.delete":{on:function(e){var a=e.type,r=e.store,n=e.detail,l=e.success,u=e.name,o=(0,c.default)(e,["type","store","detail","success","name"]),s=v.default.open(N({onOk:function(){r.delete(N(N({},n),{},{type:a})).then((function(){v.default.close(s),m.default.success({content:t("DELETED_SUCCESSFULLY")}),l&&l()}))},store:r,type:u,modal:E.default,resource:n.name},o))}},"multi.alerting.rule.monitor":{on:function(e){var t=e.store,a=e.expr,r=e.rule,n=(0,c.default)(e,["store","expr","rule"]),l=v.default.open(N({onOk:function(){v.default.close(l)},rule:r,expr:a,store:t,modal:S.default},n))}},"multi.alarm.rule.reset":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,c=e.type,s=(0,i.default)((0,p.toJS)(r.list),"data",[]),f=(0,i.default)((0,p.toJS)(r.list),"selectedRowKeys",[]),h=s.filter((function(e){return-1!==f.indexOf(e.name)})),E=v.default.open({onOk:(a=(0,u.default)(l.default.mark((function e(){var a,u,s,p;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(f.length>0)){e.next=7;break}return a=[],h.forEach((function(e){var t=(0,i.default)(e._originData,"metadata.annotations",""),n=(0,i.default)(e._originData,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',"");if(""!==n){var l=JSON.parse(n),u=(0,d.default)(l,"metadata.annotations",t);a.push(r.update(N(N({},e),{},{type:c}),u))}})),e.next=5,Promise.all(a);case 5:e.next=14;break;case 7:if(""!==(u=(0,i.default)(n._originData,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',""))){e.next=10;break}return e.abrupt("return");case 10:return s=JSON.parse(u),p=(0,d.default)(s,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',u),e.next=14,r.update(N(N({},n),{},{type:c}),p);case 14:m.default.success({content:t("RESET_SUCCESSFUL")}),v.default.close(E),o&&o();case 17:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),title:t("RESET_ALERTING_POLICY"),desc:f.length>0?t.html("RESET_MULTIPLE_ALERTING_POLICIES_DESC",{name:f.join(",")}):t("RESET_ALERTING_POLICY_DESC"),modal:_.default})}}};a.default=I},function(e,t,a){e.exports={editor:"_3JQlRh-o6JuniWSRDk3cbe",readOnly:"_1-NRR0ZvVwGhsXzTyFruig"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20);var u=l(r(97)),o=n(r(0)),c=l(r(26)),s=r(61),i=l(r(1733)),f=l(r(1734)),d=function(e){var a=e.AddRuleClick,r=e.formTemplate,n=e.handleEdit,l=e.handleDisable,d=e.handleDelete,p=e.onEdit,m=e.allClusters,h=e.isEditRule,v=(0,o.useState)((0,c.default)(r,"spec.rules",[])),E=(0,u.default)(v,1)[0],y=function(e,t){n(e,t),p&&p()};return o.default.createElement("div",{className:i.default.ruleContainer},E.map((function(t,a){return o.default.createElement(f.default,{rule:t,key:a,handleEdit:function(){return y(a,t)},handleDisable:function(e){return l(a,e)},handleDelete:function(){return d(a)},allClusters:m,isEditRule:h,builtInRule:e.builtInRule})})),!e.builtInRule&&E.length<s.ALERT_GROUP_MAX_LIMIT&&o.default.createElement("div",{className:i.default.addRuleContainer,onClick:function(){a()}},o.default.createElement("span",null,t("ADD_ALERTING_RULE")),o.default.createElement("span",null,t("ADD_ALERTING_RULE_DESC"))))};a.default=d},function(e,t,a){e.exports={ruleContainer:"_23zw7SqWj89QqPycAPDLaI",addRuleContainer:"_2CAeawr8kTC_3_F34VcSNw"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(0)),l=r(a(26)),u=r(a(67)),o=r(a(1735)),c=r(a(1737)),s=function(e){var t=e.rule;return"template"===((0,u.default)((0,l.default)(t,"exprBuilder",""))?"custom":"template")?n.default.createElement(c.default,e):n.default.createElement(o.default,e)};t.default=s},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(20),r(51),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(20),r(51);var u=l(r(31)),o=l(r(97)),c=n(r(0)),s=r(189),i=l(r(979)),f=l(r(26)),d=l(r(5)),p=l(r(1257)),m=l(r(1258)),h=function(e){var a,r,n,l=(0,c.useState)((function(){var t=e.rule;return(0,f.default)(t,"disable",!1)})),h=(0,o.default)(l,2),v=h[0],E=h[1],y=(0,c.useCallback)((function(){var e;return c.default.createElement("div",{className:(0,d.default)(m.default.icon,(e={},(0,u.default)(e,m.default.iconDisabled,v),(0,u.default)(e,m.default.iconOn,!v),e))},c.default.createElement(s.Icon,{name:"computing-setting",size:40}))}),[v]),g=(0,c.useCallback)((function(){var t=e.rule;return c.default.createElement("span",{className:m.default.ruleName},t.alert)}));return c.default.createElement("div",{className:m.default.container},c.default.createElement("div",{className:m.default.head},c.default.createElement("div",{className:m.default.title},y(),c.default.createElement("div",{className:m.default.text},c.default.createElement("p",null,g(),c.default.createElement(i.default,{data:(0,f.default)(e.rule,"severity")})),c.default.createElement("p",null,v?t("DISABLED"):t("ENABLED")))),c.default.createElement("div",{className:m.default.opt},!e.builtInRule&&c.default.createElement("div",{className:m.default.iconBg},c.default.createElement(s.Icon,{name:"trash",size:16,onClick:function(){return e.handleDelete()}})),c.default.createElement("div",{className:m.default.iconBg},c.default.createElement(s.Icon,{name:"pen",size:16,onClick:function(){return e.handleEdit()}})),c.default.createElement("div",{className:m.default.sToggle},c.default.createElement("div",{className:m.default.tooltip},c.default.createElement("span",null,v?t("ENABLE_RULE"):t("DISABLE_RULE"))),c.default.createElement("div",{className:m.default.triangle}),c.default.createElement(s.Toggle,{checked:!v,onChange:function(){E(!v),e.handleDisable(!v)}})))),c.default.createElement("div",{className:m.default.desc},(a=(0,f.default)(e.rule,"clusterSelector.inValues",[]).map((function(e){return{cluster:e}})),r=a.slice(0,3),n=a.slice(3),c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:m.default.exprLine},c.default.createElement("span",{className:m.default.title},t("CLUSTER"),":"),c.default.createElement("span",{className:m.default.descTextCL},r.length>0?r.map((function(t,a){var r=t.cluster;return c.default.createElement("div",{key:"".concat(r,"-").concat(a)},c.default.createElement(p.default,{cluster:r,allClusters:e.allClusters}))})):t("ALL_CLUSTERS"),n.length>0&&function(t){var a=c.default.createElement("div",{className:m.default.tipContentBox,style:{minWidth:"0px"}},t.map((function(t,a){return c.default.createElement("div",{className:(0,d.default)(m.default.tipLineItem,m.default.custom_line),key:"".concat(t.cluster,"-").concat(a)},c.default.createElement(p.default,{cluster:t.cluster,allClusters:e.allClusters}))})));return c.default.createElement(s.Tooltip,{content:a,placement:"top"},c.default.createElement("div",{className:m.default.targetTipRest},t.length))}(n))),c.default.createElement("div",{className:m.default.cus_text},c.default.createElement("span",{className:m.default.pr_title},t("RULE_EXPRESSION"),":"),c.default.createElement("span",{className:m.default.exprText},e.rule.expr))))))};a.default=h},function(e,t,a){e.exports={tags:"_72IXnbKwDL_C2VKhWGqOF"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(10),r(6),r(66),r(20),r(87),r(51),r(14),r(24),r(99),r(9),r(190),r(30),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(58)),o=l(r(31)),c=l(r(97));r(3),r(10),r(6),r(66),r(20),r(87),r(51),r(14),r(24),r(99),r(9),r(4),r(190),r(30),r(71),r(7);var s=r(189),i=l(r(5)),f=r(944),d=l(r(119)),p=l(r(26)),m=l(r(1257)),h=l(r(979)),v=n(r(0)),E=r(56),y=l(r(1258)),g={cpu:"cpu",pod:"pod",memory:"memory",disk:"storage",network:"network"},b=function(e){var a,r,n,l,b,S,_,O,C,T,R,D,k,N,I=e.rule,P=e.handleEdit,A=e.allClusters,w=void 0===A?[]:A,L=Object.keys(I.exprBuilder)[0],M=(0,p.default)(I,"exprBuilder.workload.kind","Deployment"),x=(0,v.useState)((0,p.default)(I,"disable",!1)),j=(0,c.default)(x,2),U=j[0],F=j[1],V=(0,v.useReducer)((function(e){return e+1}),0),G=(0,c.default)(V,2)[1],B=function(e){return(0,E.showNameAndAlias)(e,"cluster",{},!0,(function(){G()}))},z=function(e){return v.default.createElement("div",{className:y.default.tipContentBox,style:{minWidth:"200px"}},e.map((function(e,a){return v.default.createElement("div",{className:y.default.tipLineItem,style:{alignItems:"flex-start"},key:a},v.default.createElement("div",{className:y.default.tipText_title},v.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/alarmProject.svg"}),v.default.createElement("span",null,e.namespace)),v.default.createElement("div",{className:y.default.tipText_deploy},v.default.createElement("span",null,t("".concat(M.toUpperCase(),"S_VALUES"),{values:e.names.join(", ")}))))})))},Y=function(){var e=(0,p.default)(I,"exprBuilder.".concat(L,".names"),[]),a={};e.forEach((function(e){a[e.cluster]?a[e.cluster]=[].concat((0,u.default)(a[e.cluster]),[{cluster:e.cluster,namespace:(0,p.default)(e,"namespace",""),names:(0,p.default)(e,"names",[])}]):a[e.cluster]=[{cluster:e.cluster,namespace:(0,p.default)(e,"namespace",""),names:(0,p.default)(e,"names",[])}]}));var r=Object.entries(a).map((function(e){var t=(0,c.default)(e,2);return[t[0],t[1]]})),n=r.slice(0,3),l=r.slice(3).map((function(e){return(0,c.default)(e,2)[1]}));return v.default.createElement(v.default.Fragment,null,n.map((function(e,a){var r="".concat(B(e[0])," | ").concat(e[1].reduce((function(e,t){return e+t.names.length}),0));return v.default.createElement(s.Tooltip,{content:"node"===L?v.default.createElement("div",{className:y.default.tipContentBox_cluster},v.default.createElement("span",null,t("NODES_VALUES",{values:e[1][0].names.join(", ")}))):z(e[1]),key:e},v.default.createElement("div",{key:a},v.default.createElement(m.default,{cluster:e[0],allClusters:w,title:r})))})),l.length>0&&function(e){var a=v.default.createElement("div",{className:y.default.tipContentBox,style:{minWidth:"200px"}},e.map((function(e,a){var r=e.reduce((function(e,t){return e+t.names.length}),0);return v.default.createElement("div",{className:y.default.tipLineItem,style:{alignItems:"flex-start"},key:a},v.default.createElement("div",{style:{marginBottom:"8px"}},v.default.createElement(m.default,{cluster:e.cluster,allClusters:w,title:"".concat(B(e[0].cluster)," | ").concat(r)})),"node"===L?v.default.createElement(v.default.Fragment,null,e.map((function(e,a){return v.default.createElement("div",{className:y.default.tipText_nodes,key:a},t("NODES_VALUES",{values:e.names.join(", ")}))}))):v.default.createElement(v.default.Fragment,null,e.map((function(e,a){return v.default.createElement(v.default.Fragment,null,v.default.createElement("div",{className:y.default.tipText_title,key:"".concat(a,"_0")},v.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/alarmProject.svg"}),v.default.createElement("span",null,e.namespace)),v.default.createElement("div",{className:y.default.tipText_deploy,key:"".concat(a,"_1")},v.default.createElement("span",null,t("".concat(M.toUpperCase(),"S_VALUES"),{values:e.names.join(",")}))))}))))})));return v.default.createElement(s.Tooltip,{content:a,placement:"right"},v.default.createElement("div",{className:y.default.targetTipRest},e.length))}(l))},H=(0,d.default)(f.RESOURCE_METRICS_CONFIG[L||"node"])||{};return v.default.createElement("div",{className:y.default.container},v.default.createElement("div",{className:y.default.head},v.default.createElement("div",{className:y.default.title},(N=Object.keys((0,p.default)(I.exprBuilder,"".concat(L,".metricThreshold."),{}))[0]||"pod",v.default.createElement("div",{className:(0,i.default)(y.default.icon,(k={},(0,o.default)(k,y.default.iconDisabled,U),(0,o.default)(k,y.default.iconOn,!U),k))},v.default.createElement(s.Icon,{size:40,name:g[N]}))),v.default.createElement("div",{className:y.default.text},v.default.createElement("p",null,v.default.createElement("span",{className:y.default.ruleName},I.alert),v.default.createElement(h.default,{data:(0,p.default)(I,"severity")})),v.default.createElement("p",null,U?t("DISABLED"):t("ENABLED")))),v.default.createElement("div",{className:y.default.opt},!e.builtInRule&&v.default.createElement("div",{className:y.default.iconBg},v.default.createElement(s.Icon,{name:"trash",size:16,onClick:function(){e.handleDelete()}})),v.default.createElement("div",{className:y.default.iconBg},v.default.createElement(s.Icon,{name:"pen",size:16,onClick:function(){return P()}})),v.default.createElement("div",{className:y.default.sToggle},v.default.createElement("div",{className:y.default.tooltip},v.default.createElement("span",null,U?t("ENABLE_RULE"):t("DISABLE_RULE"))),v.default.createElement("div",{className:y.default.triangle}),v.default.createElement(s.Toggle,{checked:!U,onChange:function(){F(!U),e.handleDisable(!U)}})))),v.default.createElement("div",{className:y.default.desc},(a=(0,p.default)(I,"exprBuilder.".concat(L,".metricThreshold")),r=Object.keys(a)[0],n=Object.keys(a[r])[0],l="".concat(r,":").concat(n),b=H[l],S=b.ruleConfig.filter((function(e){return"thresholds"===e.name}))[0].reverser,_=t("".concat(b.label)).replace(/[(（]%[)）]/g,""),O=(0,p.default)(I,"exprBuilder.".concat(L,".comparator")),C=S(Number(Object.values(a[r])[0])),T="core"===b.ruleConfig[1].unit?1===C?t("CORE"):t("CORE_PL"):b.ruleConfig[1].unit,R=I.for.slice(0,-1),D=I.for.slice(-1),v.default.createElement(v.default.Fragment,null,v.default.createElement("div",{className:y.default.exprLine},v.default.createElement("span",{className:y.default.title},"".concat(t("MONITORING_TARGET"),":")),v.default.createElement("span",{className:y.default.descTextCL},Y())),v.default.createElement("div",{className:y.default.exprLine},v.default.createElement("span",{className:y.default.pr_title},"".concat(t("ALERTING_RULE"),":")),v.default.createElement("span",{className:y.default.exprText},"%"===T?t({s:"ALERT_RULE_TEXT_PERCENT_SECOND",m:"ALERT_RULE_TEXT_PERCENT_MINUTE",h:"ALERT_RULE_TEXT_PERCENT_HOUR"}[D],{alterTypeText:_,comparator:O,thresholds:C,durationValue:R}):t({s:"ALERT_RULE_TEXT_SECOND",m:"ALERT_RULE_TEXT_MINUTE",h:"ALERT_RULE_TEXT_HOUR"}[D],{alterTypeText:_,comparator:O,thresholds:C,unit:T,durationValue:R})))))))};a.default=b},function(e,t,a){"use strict";a(16),Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.NODE_ALERTING_CONFIG=void 0;var r=a(1259),n={"cpu:utilization":{label:"CPU_UTILIZATION_SCAP",tcapLabel:"CPU_UTILIZATION_NO_PERCENT_TCAP",prefixIcon:"cpu",ruleConfig:r.PERCENT_RULE_CONFIG},"cpu:load1m":{label:"CPU_LOAD_1",tcapLabel:"CPU_LOAD_1_TCAP",prefixIcon:"cpu",ruleConfig:r.BASE_RULE_CONFIG},"cpu:load5m":{label:"CPU_LOAD_5",tcapLabel:"CPU_LOAD_5_TCAP",prefixIcon:"cpu",ruleConfig:r.BASE_RULE_CONFIG},"cpu:load15m":{label:"CPU_LOAD_15",tcapLabel:"CPU_LOAD_15_TCAP",prefixIcon:"cpu",ruleConfig:r.BASE_RULE_CONFIG},"memory:utilization":{label:"MEMORY_UTILIZATION_SCAP",tcapLabel:"MEMORY_UTILIZATION_NO_PERCENT_TCAP",prefixIcon:"memory",ruleConfig:r.PERCENT_RULE_CONFIG},"memory:available":{label:"MEMORY_AVAILABLE",tcapLabel:"MEMORY_AVAILABLE_TCAP",prefixIcon:"memory",ruleConfig:r.GIB_RULE_CONFIG},"network:transmittedRate":{label:"DATA_SEND_RATE",tcapLabel:"DATA_SEND_RATE_TCAP",prefixIcon:"network",ruleConfig:r.MBPS_RULE_CONFIG},"network:receivedRate":{label:"DATA_RECEIVE_RATE",tcapLabel:"DATA_RECEIVE_RATE_TCAP",prefixIcon:"network",ruleConfig:r.MBPS_RULE_CONFIG},"disk:spaceUtilization":{label:"DISK_SPACE_UTILIZATION",tcapLabel:"DISK_SPACE_UTILIZATION_NO_PERCENT_TCAP",prefixIcon:"storage",ruleConfig:r.PERCENT_RULE_CONFIG},"disk:spaceAvailable":{label:"DISK_SPACE_AVAILABLE",tcapLabel:"DISK_SPACE_AVAILABLE_TCAP",prefixIcon:"storage",ruleConfig:r.GB_RULE_CONFIG},"disk:inodeUtilization":{label:"INODE_UTILIZATION",tcapLabel:"INODE_UTILIZATION_NO_PERCENT_TCAP",prefixIcon:"storage",ruleConfig:r.PERCENT_RULE_CONFIG},"disk:iopsRead":{label:"DISK_READ_IOPS",tcapLabel:"DISK_READ_IOPS_TCAP",prefixIcon:"storage",ruleConfig:r.BASE_RULE_CONFIG},"disk:iopsWrite":{label:"DISK_WRITE_IOPS",tcapLabel:"DISK_WRITE_IOPS_TCAP",prefixIcon:"storage",ruleConfig:r.BASE_RULE_CONFIG},"disk:throughputRead":{label:"DISK_READ_THROUGHPUT",tcapLabel:"DISK_READ_THROUGHPUT_TCAP",prefixIcon:"storage",ruleConfig:r.KBS_RULE_CONFIG},"disk:throughputWrite":{label:"DISK_WRITE_THROUGHPUT",tcapLabel:"DISK_WRITE_THROUGHPUT_TCAP",prefixIcon:"storage",ruleConfig:r.KBS_RULE_CONFIG},"pod:abnormalRatio":{label:"UNAVAILABLE_POD_RATIO",tcapLabel:"UNAVAILABLE_POD_RATIO_NO_PERCENT_TCAP",prefixIcon:"pod",ruleConfig:r.PERCENT_RULE_CONFIG},"pod:utilization":{label:"POD_QUOTA_UTILIZATION_SCAP",tcapLabel:"POD_QUOTA_UTILIZATION_NO_PERCENT_TCAP",prefixIcon:"pod",ruleConfig:r.PERCENT_RULE_CONFIG}};t.NODE_ALERTING_CONFIG=n;var l=n;t.default=l},,function(e,t,a){"use strict";a(16),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(1259),n={"cpu:usage":{label:"CPU_USAGE_SCAP",tcapLabel:"CPU_USAGE_TCAP",prefixIcon:"cpu",ruleConfig:r.CORE_RULE_CONFIG},"memory:usage":{label:"MEMORY_USAGE_SCAP",tcapLabel:"MEMORY_USAGE_TCAP",prefixIcon:"memory",ruleConfig:r.MIB_RULE_CONFIG},"memory:usageWoCache":{label:"MEMORY_USAGE_WO_CACHE_SCAP",tcapLabel:"MEMORY_USAGE_WO_CACHE_TCAP",prefixIcon:"memory",ruleConfig:r.MIB_RULE_CONFIG},"network:transmittedRate":{label:"DATA_SEND_RATE",tcapLabel:"DATA_SEND_RATE_TCAP",prefixIcon:"network",ruleConfig:r.MBPS_RULE_CONFIG},"network:receivedRate":{label:"DATA_RECEIVE_RATE",tcapLabel:"DATA_RECEIVE_RATE_TCAP",prefixIcon:"network",ruleConfig:r.MBPS_RULE_CONFIG},"replica:unavailableRatio":{label:"UNAVAILABLE_WORKLOAD_REPLICA_RATIO",tcapLabel:"UNAVAILABLE_WORKLOAD_REPLICA_RATIO_NO_PERCENT_TCAP",prefixIcon:"backup",ruleConfig:r.PERCENT_RULE_CONFIG}};t.default=n},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20),r(9);var u=l(r(317)),o=l(r(97)),c=n(r(0)),s=l(r(1)),i=r(189),f=l(r(67)),d=l(r(26)),p=l(r(68)),m=l(r(196)),h=l(r(1742)),v=l(r(1743)),E=l(r(1761)),y=[{label:t("RULE_TEMPLATE"),value:"ruleTemplate"},{label:t("CUSTOM_RULE"),value:"customRule"}],g=function(e,a){var r=e.editRule,n=(0,f.default)(r)?y[0].value:(0,f.default)((0,d.default)(r,"exprBuilder",{}))?y[1].value:y[0].value,l=(0,c.useState)(n),s=(0,o.default)(l,2),g=s[0],b=s[1],S=(0,c.useRef)(),_=function(t){var a=e.onSave,r=S.current.target;r&&r.validate((function(){var e=r.getData();if("ruleTemplate"===g){var n=Object.keys((0,d.default)(e,"exprBuilder"))[0],l=(0,d.default)(e,"exprBuilder.".concat(n,".for")),u=(0,d.default)(e,"exprBuilder.".concat(n,".severity"));(0,p.default)(e,"for",l),(0,p.default)(e,"severity",u),(0,m.default)(e,"exprBuilder.".concat(n,".for")),(0,m.default)(e,"exprBuilder.".concat(n,".severity"))}else(0,p.default)(e,"exprBuilder",{});a(e),t&&t()}))};return(0,c.useEffect)((function(){var t=a.registerSubRoute,r=e.onCancel;t&&t(_,r)}),[g]),c.default.createElement("div",{className:h.default.AddRuleContainer},c.default.createElement("div",{className:"h6",style:{display:"flex",alignItems:"center"}},c.default.createElement(i.Icon,{name:"return",size:20,onClick:function(){var t=a.resetSubRoute;t&&t(),e.onCancel()}}),c.default.createElement("span",null,t("ADD_ALERTING_RULE"))),c.default.createElement("div",{className:h.default.AddForm},c.default.createElement(i.RadioGroup,{buttonWidth:132,value:g,wrapClassName:"radio",onChange:function(e){return b(e)}},y.map((function(e){return c.default.createElement(i.RadioButton,{key:e.value,value:e.value},e.label)}))),"ruleTemplate"===g?c.default.createElement(v.default,(0,u.default)({ref:S},e)):c.default.createElement(E.default,(0,u.default)({ref:S},e))))};g.contextTypes={registerSubRoute:s.default.func,resetSubRoute:s.default.func};var b=g;a.default=b},function(e,t,a){e.exports={AddRuleContainer:"WpgwYfFtGYQ9bOabv902A",AddForm:"xiV4clfTcv89q6y8rXZlp"}},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(9),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(9);var l=n(a(317)),u=n(a(97)),o=r(a(0)),c=n(a(26)),s=n(a(1744)),i=n(a(1757)),f=function(e,t){var a=e.editRule,r=(0,c.default)(a,"exprBuilder",{node:{}}),n=(0,o.useState)(Object.keys(r)[0]),f=(0,u.default)(n,2),d=f[0],p=f[1],m=(0,o.useRef)(),h=(0,o.useRef)();return(0,o.useImperativeHandle)(t,(function(){return{target:"node"===d?m.current.target:h.current.target}})),"node"===d?o.default.createElement(s.default,(0,l.default)({ref:m,exprBuilderTypeChange:p},e)):o.default.createElement(i.default,(0,l.default)({ref:h,exprBuilderTypeChange:p},e))},d=(0,o.forwardRef)(f);t.default=d},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(10),r(44),r(6),r(98),r(14),r(99),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(3),r(10),r(44),r(6),r(98),r(14),r(99),r(9),r(4),r(7);var u=l(r(97)),o=n(r(0)),c=r(189),s=l(r(26)),i=l(r(67)),f=l(r(253)),d=l(r(845)),p=l(r(444)),m=l(r(163)),h=l(r(1260)),v=l(r(1261)),E=l(r(1752)),y=l(r(923)),g=c.Tabs.TabPanel,b=function(e,a){var r=e.editRule,n=e.exprBuilderTypeChange,l=(0,o.useState)("node"),b=(0,u.default)(l,1)[0],S=(0,o.useState)((function(){return(0,s.default)(r,"clusterSelector.inValues",[])})),_=(0,u.default)(S,1)[0],O=(0,o.useCallback)((function(e,t){return!!r.exprBuilder?(0,s.default)(r,e,t):t}),[r]),C=(0,o.useState)((function(){var e="node";if(!(0,i.default)(r)&&r.exprBuilder){var t=r.exprBuilder;e=Object.keys(t)[0]}var a="node"!==e;return{alert:O("alert",""),annotations:{summary:O("annotations.summary",""),message:O("annotations.message","")},clusterSelector:{inValues:O("clusterSelector.inValues",[])},exprBuilder:{node:{names:a?[{cluster:"",names:[]}]:O("exprBuilder.node.names",[{cluster:"",names:[]}]),comparator:O("exprBuilder.node.comparator",">"),metricThreshold:a?{}:O("exprBuilder.node.metricThreshold",{}),for:O("for","1m"),severity:O("severity","critical")}},disable:O("disable",!1),labels:(0,s.default)(r,"labels")}})),T=(0,u.default)(C,1)[0],R=(0,o.useRef)();(0,o.useImperativeHandle)(a,(function(){return{target:R.current}}));var D=function(e,a,r){if(!a)return r();if((0,i.default)(a.comparator))return r({message:t("OPERATOR_REQUIRED"),field:e.field});if((0,i.default)(a.metricThreshold))return r({message:t("THRESHOLD_REQUIRED"),field:e.field});var n=Object.keys(a.metricThreshold)[0],l=Object.keys(a.metricThreshold[n])[0],u=a.metricThreshold[n][l];return""===u||!u||(0,m.default)(u)?r({message:t("THRESHOLD_REQUIRED"),field:e.field}):(0,p.default)(u,".")?r({message:t("THRESHOLD_INVALID"),field:e.field}):void r()},k=function(a,r,n){var l=(0,d.default)(r.filter((function(e){return""!==e&&""!==e.cluster})),(function(e){return e.cluster}));return Object.entries(l).some((function(e){var t=(0,u.default)(e,2)[1],a=[];return t.forEach((function(e){a=a.concat(e.names)})),(0,f.default)(a).length!==a.length}))?n({message:t("NODE_TARGET_REPEAT")}):(r.forEach((function(a){return""===a?n({message:t("MONITOR_TARGET_EMPTY")}):""===a.cluster?n({message:t("CLUSTER_FIELD_EMPTY")}):e.allClusters.find((function(e){return e.name===a.cluster}))?(0,i.default)(a.names)?n({message:t("SELECT_A_TARGET_NODE")}):void 0:n({message:t("MONITOR_TARGET_CLUSTER_DELETED_DESC")})})),n())};return o.default.createElement(c.Form,{data:T,ref:R},o.default.createElement("div",{className:h.default.label},t("RULE_SETTINGS")),o.default.createElement("div",{className:h.default.contentGroup},o.default.createElement(c.Form.Item,{label:t("RULE_NAME"),desc:t("CUSTOM_RULE_NAME_DESC"),rules:[{required:!0,message:t("RULE_NAME_REQUIRED")}]},o.default.createElement(c.Input,{name:"alert",maxLength:63})),o.default.createElement("div",{className:h.default.tabs},o.default.createElement(c.Tabs,{type:"button",activeName:b,onChange:function(e){return n(e)}},o.default.createElement(g,{label:t("NODE"),name:"node"}),o.default.createElement(g,{label:t("WORKLOAD"),name:"workload"}))),o.default.createElement(c.Form.Item,{label:t("MONITORING_TARGETS"),rules:[{required:!0,message:t("MONITOR_TARGET_EMPTY")},{validator:k}]},o.default.createElement(v.default,{monitorLevel:"node",resourceType:"node",name:"exprBuilder.node.names",clusterTargets:_,allClusters:e.allClusters})),o.default.createElement(c.Form.Item,{label:t("TRIGGER_CONDITION"),rules:[{required:!0,message:t("SET_ACTIVATION_CONDITION_DESC")},{validator:D}]},o.default.createElement(E.default,{resourceType:"node",name:"exprBuilder.node"}))),o.default.createElement(y.default,null),o.default.createElement("div",{className:h.default.label},t("MESSAGE_SETTINGS")),o.default.createElement("div",{className:h.default.contentGroup},o.default.createElement(c.Form.Item,{className:h.default.message,label:t("MESSAGE_SUMMARY"),desc:t("MESSAGE_SUMMARY_DESC"),rules:[{required:!0,message:t("MESSAGE_REQUIRED")}]},o.default.createElement(c.Input,{name:"annotations.summary",maxLength:63})),o.default.createElement(c.Form.Item,{className:h.default.message,label:t("MESSAGE_DETAILS"),desc:t("MESSAGE_DETAILS_DESC")},o.default.createElement(c.TextArea,{name:"annotations.message",maxLength:256}))))},S=(0,o.forwardRef)(b);a.default=S},function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(3),a(10),a(6),a(20),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var l=n(a(31)),u=n(a(25)),o=n(a(28)),c=n(a(41)),s=n(a(42)),i=n(a(37)),f=r(a(0)),d=n(a(824)),p=n(a(441)),m=n(a(140)),h=n(a(1747)),v=n(a(1263));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var b=function(e){(0,c.default)(a,e);var t=g(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).store=new p.default,e.handleSelectChange=function(t){var a=e.props,r=a.onChange;(0,a.handleChangeNs)(t),r(t.map((function(e){return(0,m.default)(e,"id")})))},e.checkItemValid=function(e){return!!(e.cluster&&""!==e.cluster&&e.names&&e.names.length>0)},e.fetchNsList=function(t){var a=t.cluster,r=t.workspace;return e.store.fetchList({cluster:a,workspace:r,labelSelector:"kubefed.io/managed!=true, kubesphere.io/kubefed-host-namespace!=true",limit:-1})},e}return(0,o.default)(a,[{key:"render",value:function(){return f.default.createElement("div",{className:v.default.wrapper},f.default.createElement(d.default,{value:this.props.value.map((function(e,t){return y(y({},e),{},{id:t})})),onChange:this.handleSelectChange,checkItemValid:this.checkItemValid,itemType:"object"},f.default.createElement(h.default,{clusterOptions:this.clusterOptions,fetchNsList:this.fetchNsList,allWorkspace:this.props.allWorkspace,workloadType:this.props.workloadType})))}},{key:"clusterOptions",get:function(){return this.props.allClusters}}]),a}(f.Component);t.default=b},,function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(10),r(6),r(36),r(20),r(14),r(4),r(21),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(10),r(6),r(36),r(20),r(14),r(4),r(21),r(46),r(7),r(40);var u=n(r(58)),o=n(r(97)),c=r(189),s=n(r(26)),i=n(r(67)),f=n(r(1100)),d=l(r(0)),p=n(r(319)),m=r(56),h=r(61),v=n(r(1263)),E=n(r(1748));function y(e,t){var a=(y.canvas||(y.canvas=document.createElement("canvas"))).getContext("2d");return a.font=t,a.measureText(e).width}var g=function(e){var a,r,n=e.clusterOptions,l=e.value,g=e.onChange,b=e.workloadType,S=(0,d.useRef)({Deployment:new p.default("deployments"),StatefulSet:new p.default("statefulsets"),DaemonSet:new p.default("daemonsets")}),_=(0,d.useRef)(),O=(0,d.useState)(""),C=(0,o.default)(O,2),T=C[0],R=C[1],D=(0,d.useState)([]),k=(0,o.default)(D,2),N=k[0],I=k[1],P=(0,d.useState)([]),A=(0,o.default)(P,2),w=A[0],L=A[1],M=(0,d.useRef)("");(0,d.useEffect)((function(){var e=l.names,t=void 0===e?[]:e;if(!(t.length<1)){var a=!1,r=0,n=-1,o=_.current.selectRef.current.children[0].children[0].children,c=o[o.length-1].offsetParent.offsetWidth;t.forEach((function(e,t){r+=y(e,"12px PingFang SC")+36,!a&&r>c-30&&(n=t,a=!0)}));var s=t.map((function(e,t){return{label:e,value:e,hide:-1!==n&&t>n}}));r>c-30?(s[n].label="+".concat(t.length-n),I((0,u.default)(s))):I((0,u.default)(s));var i=_.current.selectRef.current.children[0].children[0].children;s.forEach((function(e,t){if(i[t]&&(e.hide||i[t].setAttribute("style","display:inline-block;"),(0,f.default)(e.label,"+"))){var a=v.default.hideIcon;i[t]&&i[t].setAttribute("class","tag tag-default select-multi-value-item ".concat(a))}}))}}),[l]),(0,d.useEffect)((function(){var e=l.cluster,t=void 0===e?"":e,a=l.namespace,r=void 0===a?"":a;""!==t&&""!==r&&r!==M.current&&Promise.all([S.current[b].fetchList({cluster:l.cluster,namespace:l.namespace,limit:-1})]).then((function(e){var t=(0,o.default)(e,1)[0];L(t.map((function(e){return e.name})))})),M.current=l.namespace}),[l,b]);var x=(0,d.useCallback)((function(e){e!==l.cluster&&(R(""),g({cluster:e,namespace:"",names:[]}))}),[l]),j=(0,d.useCallback)((function(e){var t=e.namespace,a=e.workspace;R(a),g({cluster:l.cluster,namespace:t,names:[]})}),[l]),U=(0,d.useCallback)((function(e){g({cluster:l.cluster,namespace:l.namespace,names:e})}),[l]),F=(0,d.useCallback)((function(e){var t=n.filter((function(t){return t.name===e.value}))[0];return e.value?d.default.createElement(d.default.Fragment,null,d.default.createElement(c.Icon,{name:h.CLUSTER_PROVIDER_ICON[t.provider]||"kubernetes",size:20,type:"light"}),d.default.createElement("span",{className:v.default.optionText},e.label)):null}),[n]),V=(0,d.useCallback)((function(e){if(""===e.value)return d.default.createElement("span",null,e.label);var t=n.filter((function(t){return t.name===e.value}))[0];if(!t)return d.default.createElement(d.default.Fragment,null,d.default.createElement(c.Icon,{name:"question",size:20}),d.default.createElement("span",{className:v.default.optionText},e.label));var a=(0,s.default)(t,"provider",!1)?h.CLUSTER_PROVIDER_ICON[t.provider]:"kubernetes";return d.default.createElement(d.default.Fragment,null,d.default.createElement(c.Icon,{name:a,size:20}),d.default.createElement("span",{className:v.default.optionText},e.label))}),[n]),G=(0,d.useCallback)((function(e){var t=N.filter((function(t){return t.value===e.value}));return t.length>0&&d.default.createElement("span",{className:v.default.nodeLabel},t[0].label)}),[N]);return d.default.createElement("div",{className:v.default.selectItem},d.default.createElement(c.Select,{className:v.default.clusterOpt,value:null!==(a=null===(r=n.filter((function(e){return e.name===l.cluster}))[0])||void 0===r?void 0:r.name)&&void 0!==a?a:l.cluster,options:n.map((function(e){return{label:(0,m.getDomTitle)((0,m.showNameAndAlias)(e.name,"cluster",{},!0,(function(){return(void 0).forceUpdate()}))),value:e.name}})),onChange:x,optionRenderer:F,valueRenderer:V,placeholder:t("CLUSTER")}),d.default.createElement(E.default,{selectedWs:T,value:l.namespace,allWorkspace:e.allWorkspace,fetchNsList:e.fetchNsList,cluster:l.cluster,onChange:j}),d.default.createElement(c.Select,{ref:_,className:v.default.nodeOpt,value:(0,i.default)(l.names)?"":l.names,options:w.map((function(e){return{label:e,value:e}})),valueRenderer:G,onChange:U,placeholder:t("WORKLOAD"),multi:!0}))};a.default=g},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(10),r(44),r(36),r(20),r(98),r(14),r(4),r(21),r(46),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(10),r(44),r(36),r(20),r(98),r(14),r(4),r(21),r(46),r(40);var u=l(r(31)),o=l(r(58)),c=l(r(97)),s=r(189),i=l(r(5)),f=n(r(0)),d=r(56),p=l(r(1749)),m=function(e){var a,r=e.allWorkspace,n=void 0===r?[]:r,l=e.cluster,m=void 0===l?"":l,h=e.selectedWs,v=e.value,E=(0,f.useState)(!1),y=(0,c.default)(E,2),g=y[0],b=y[1],S=(0,f.useState)(h),_=(0,c.default)(S,2),O=_[0],C=_[1],T=(0,f.useState)([]),R=(0,c.default)(T,2),D=R[0],k=R[1],N=(0,f.useState)([]),I=(0,c.default)(N,2),P=I[0],A=I[1],w=(0,f.useState)(!1),L=(0,c.default)(w,2),M=L[0],x=L[1],j=(0,f.useRef)();(0,f.useEffect)((function(){""!==O&&""!==m&&Promise.all([e.fetchNsList({cluster:m,workspace:O})]).then((function(e){var t=(0,c.default)(e,1)[0];x(!1),t.length>0?A(t.map((function(e){return{label:(0,d.getDisplayNameNew)(e),value:e.name}}))):A([])})),m&&v&&!h&&e.fetchNsList({cluster:m}).then((function(e){if(x(!1),e.length>0){var t=e.find((function(e){return e.name===v}));t&&C(t.workspace)}}))}),[O,m]),(0,f.useEffect)((function(){var e=n.filter((function(e){return e.clusters.some((function(e){return e.name===m}))||"system-workspace"===e.name}));k((0,o.default)(e))}),[m,n]),(0,f.useEffect)((function(){var e=function(e){var t=e.target,a=j.current;a&&!a.contains(t)&&b(!1)};return document.addEventListener("click",e),function(){return document.removeEventListener("click",e)}}),[]);var U=(0,f.useCallback)((function(){b(!g)}),[]);return f.default.createElement("div",{className:p.default.selectBox,ref:j},f.default.createElement("div",{className:(0,i.default)("select-control",p.default.innerBox),onClick:U},f.default.createElement("input",{readOnly:!0,autoComplete:"off",placeholder:t("PROJECT"),value:(null===(a=P.find((function(e){return e.value===v})))||void 0===a?void 0:a.label)||""}),f.default.createElement("div",{className:(0,i.default)((0,u.default)({},p.default.iconRotate,g))},f.default.createElement(s.Icon,{name:"chevron-down",size:16}))),f.default.createElement("div",{className:(0,i.default)(p.default.options,(0,u.default)({},p.default.show,g))},f.default.createElement("ul",null,D.map((function(e){return f.default.createElement("li",{className:(0,i.default)(p.default.ws,(0,u.default)({},p.default.isActive,O===e.name)),key:e.name,onClick:function(){var t;(t=e.name)!==O&&(C(t),x(!0))}},f.default.createElement(s.Icon,{name:"enterprise",color:{primary:"#fff"},size:16}),f.default.createElement("span",{className:p.default.wsName},(0,d.showNameAndAlias)(e.name,"workspace",{},!1,void 0,!0)),f.default.createElement(s.Icon,{name:"chevron-right",color:{primary:"#fff"},size:16}))}))),f.default.createElement("ul",{className:p.default.ListWrapper},""===m?f.default.createElement("div",{className:p.default.loadingBox},t("CLUSTER_FIELD_EMPTY")):M?f.default.createElement("div",{className:p.default.loadingBox},t("LOADING")):P.length<1?f.default.createElement("div",{className:p.default.loadingBox},t("NO_DATA_DESC")):P.map((function(t){return f.default.createElement("li",{key:t.value,className:(0,i.default)(p.default.nsItem,(0,u.default)({},p.default.isActive,v===t.value)),onClick:function(){return(a=t.value)!==v&&e.onChange({namespace:a,workspace:O}),void b(!1);var a}},(0,d.getDomTitle)(t.label))})))))};a.default=m},function(e,t,a){e.exports={selectBox:"_2HZWNNmjenFUgAAucLbTvP",innerBox:"_2W7W_pAH828HoNZ29CUlyv",placeholder:"_89eAxB9DH2UN7qcx12dIk",options:"l1crorAaNjCxL9hdrnMS8",ws:"_1LPbr6qwuZqa4UWJ73i5OL",wsName:"_2cyzMAYZEd4fSRzsGJKkvS",isActive:"_3dQHRBXMOnHdo4MY-xqfxj",ListWrapper:"_3_0Sw2Pq9JisypKNfYCm-V",nsItem:"_31EvXA_mmdBOpZaFB_ICVg",loadingBox:"_32e-dGX3Y1qlexnPJPK1hp",show:"_34BZ8bF4uqtVdZ-P3nbaV8",iconRotate:"_3LfZXCNHbyBVhN9KdOAUjs"}},function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(3),a(10),a(6),a(20),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var l=n(a(31)),u=n(a(25)),o=n(a(28)),c=n(a(41)),s=n(a(42)),i=n(a(37)),f=r(a(0)),d=n(a(824)),p=n(a(140)),m=n(a(1751)),h=n(a(1264));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=function(e){(0,c.default)(a,e);var t=y(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).handleSelectChange=function(t){(0,e.props.onChange)(t.map((function(e){return(0,p.default)(e,"id")})))},e.checkItemValid=function(e){return!!(e.cluster&&""!==e.cluster&&e.names&&e.names.length>0)},e}return(0,o.default)(a,[{key:"render",value:function(){return f.default.createElement("div",{className:h.default.wrapper},f.default.createElement(d.default,{value:this.props.value.map((function(e,t){return E(E({},e),{},{id:t})})),onChange:this.handleSelectChange,checkItemValid:this.checkItemValid},f.default.createElement(m.default,{clusterOptions:this.clusterOptions})))}},{key:"clusterOptions",get:function(){return this.props.allClusters}}]),a}(f.Component);t.default=g},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(10),r(6),r(36),r(20),r(14),r(4),r(21),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(10),r(6),r(36),r(20),r(14),r(4),r(21),r(46),r(7),r(40);var u=n(r(58)),o=n(r(97)),c=r(189),s=n(r(5)),i=n(r(808)),f=n(r(26)),d=n(r(67)),p=n(r(1100)),m=l(r(0)),h=n(r(454)),v=r(56),E=r(61),y=n(r(1264));function g(e,t){var a=(g.canvas||(g.canvas=document.createElement("canvas"))).getContext("2d");return a.font=t,a.measureText(e).width}var b=function(e){var a,r,n,l=e.clusterOptions,b=e.value,S=e.onChange,_=(0,m.useRef)(new h.default),O=(0,m.useState)([]),C=(0,o.default)(O,2),T=C[0],R=C[1],D=(0,m.useState)(null!==(a=null==b?void 0:b.names)&&void 0!==a?a:[]),k=(0,o.default)(D,2),N=k[0],I=k[1],P=(0,m.useRef)(),A=(0,m.useState)([]),w=(0,o.default)(A,2),L=w[0],M=w[1];(0,m.useEffect)((function(){var e=b.cluster,t=void 0===e?"":e;""!==t&&Promise.all([_.current.fetchList({limit:-1,cluster:t})]).then((function(e){var t=(0,o.default)(e,1)[0];R(t)}))}),[b.cluster]),(0,m.useEffect)((function(){if(!(N.length<1)){var e=!1,t=0,a=-1,r=P.current.selectRef.current.children[0].children[0].children,n=r[r.length-1].offsetParent.offsetWidth;N.forEach((function(r,l){t+=g(r,"12px PingFang SC")+36,!e&&t>n&&(a=l,e=!0)}));var l=N.map((function(e,t){return{label:e,value:e,hide:-1!==a&&t>a}}));t>n?(l[a].label="+".concat(N.length-a),M((0,u.default)(l))):M((0,u.default)(l))}}),[N]),(0,m.useEffect)((function(){var e=P.current.selectRef.current.children[0].children[0].children;L.forEach((function(t,a){if(e[a]&&(t.hide||e[a].setAttribute("style","display:inline-block;"),(0,p.default)(t.label,"+"))){var r=y.default.hideIcon;e[a].setAttribute("class","tag tag-default select-multi-value-item ".concat(r))}}))}),[L]);var x=(0,m.useCallback)((0,i.default)((function(e){I([]),S({cluster:e,names:[]})}),1e3)),j=(0,m.useCallback)((function(e){I(e),S({cluster:b.cluster,names:e})})),U=(0,m.useCallback)((function(e){var t=l.filter((function(t){return t.name===e.value}))[0];return e.value?m.default.createElement(m.default.Fragment,null,m.default.createElement(c.Icon,{name:E.CLUSTER_PROVIDER_ICON[t.provider]||"kubernetes",size:20,type:"light"}),m.default.createElement("span",{className:y.default.optionText},e.label)):null}),[l]),F=(0,m.useCallback)((function(e){if(""===e.value)return m.default.createElement("span",null,e.label);var t=l.filter((function(t){return t.name===e.value}))[0];if(!t)return m.default.createElement(m.default.Fragment,null,m.default.createElement(c.Icon,{name:"question",size:20}),m.default.createElement("span",{className:y.default.optionText},e.label));var a=(0,f.default)(t,"provider",!1)?E.CLUSTER_PROVIDER_ICON[t.provider]:"kubernetes";return m.default.createElement(m.default.Fragment,null,m.default.createElement(c.Icon,{name:a,size:20}),m.default.createElement("span",{className:y.default.optionText},e.label))}),[l]);return m.default.createElement("div",{className:y.default.selectItem},m.default.createElement(c.Select,{className:y.default.clusterOpt,value:null!==(r=null===(n=l.filter((function(e){return e.name===b.cluster}))[0])||void 0===n?void 0:n.name)&&void 0!==r?r:b.cluster,options:l.map((function(e){return{label:(0,v.getDomTitle)((0,v.showNameAndAlias)(e.name,"cluster",{},!0,(function(){return(void 0).forceUpdate()}))),value:e.name}})),onChange:x,optionRenderer:U,valueRenderer:F,placeholder:t("CLUSTER")}),m.default.createElement(c.Select,{ref:P,className:(0,s.default)(y.default.nodeOpt),value:(0,d.default)(N)?"":N,options:T.map((function(e){return{label:e.name,value:e.name}})),valueRenderer:function(e){var t=L.filter((function(t){return t.value===e.value}));return t.length>0&&m.default.createElement("span",{className:y.default.nodeLabel},t[0].label)},onChange:j,multi:!0,placeholder:t("NODE")}))};a.default=b},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(20),r(98),r(14),r(24),r(99),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(71),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(97)),u=n(r(317)),o=n(r(50)),c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37));r(12),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(98),r(29),r(14),r(24),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(71),r(7);var m=n(r(0)),h=n(r(1)),v=n(r(5)),E=n(r(76)),y=n(r(26)),g=n(r(119)),b=n(r(67)),S=n(r(444)),_=r(189),O=n(r(805)),C=r(944),T=r(922),R=n(r(945)),D=n(r(1755));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var P=[1,5,15,30,60].map((function(e){return{label:t.html("LASTING_MINUTES",{minutes:e}),value:"".concat(e,"m")}})),A=function(e){(0,f.default)(r,e);var a=I(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).getMetricType=function(e){var t=n.metricConfig[0].value,a=(0,y.default)(e,"value.metricThreshold",{});if((0,b.default)(a))return n.metricConfig[0].value;var r=Object.keys(a)[0],l=Object.keys(a[r])[0];return n.metricConfig.some((function(e){return e.value==="".concat(r,":").concat(l)}))?"".concat(r,":").concat(l):t},n.getStateFromProps=function(e){var t=e.value,a=void 0===t?{}:t,r=(0,y.default)(a,"metricThreshold",{}),l=n.metricConfig[0].value.split(":"),u=l[0],o=l[1];if(!(0,b.default)(r)){var c=Object.keys(r)[0];n.metricConfig.some((function(e){return e.value==="".concat(c,":").concat(Object.keys(r[c])[0])}))&&(u=c,o=Object.keys(r[c])[0])}var s=(0,y.default)(a,"for",""),i=(0,y.default)(a,"severity","");return{resourceType:"node",nodeResourceType:u,monitorType:o,comparator:(0,y.default)(a,"comparator",""),duration:""!==s?s:P[0].value,severity:""!==i?i:n.alertingTypeOptions[0].value}},n.getSelectOptions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var a=e.prefixIcon,r=e.color,n=e.type,l=e.label,u=e.value,o=e.disabled,c={label:t(l,{value:u}),value:u};return a&&(c.label=m.default.createElement("div",{className:(0,v.default)(D.default.optionLabel,D.default[n])},m.default.createElement(_.Icon,{name:a,size:20,color:r}),c.label)),o&&(c.disabled=o),c}))},n.handleMetricTypeChange=function(e){var t=e.split(":")[0],a=e.split(":")[1],r=n.state,l=r.comparator,u=r.severity,o=r.duration;n.setState({metricType:e,nodeResourceType:t,monitorType:a,thresholds:""},(function(){n.props.onChange({names:n.props.value.names,metricThreshold:(0,c.default)({},t,(0,c.default)({},a,"")),comparator:l,severity:u,for:o})}))},n.handleItemChange=function(e,t){return function(a,r){var l=n.props.onChange,u=(0,E.default)(r)||!r?a:r;"thresholds"===e&&(u=""!==(u=String(u).replace(/([a-zA-Z%/])+$/g,""))?(0,S.default)(u,".")?u:t(Number(u)):""),n.setState((0,c.default)({},e,u),(function(){var t=n.state,a=t.nodeResourceType,r=t.monitorType,o=t.comparator,s=t.duration,i=t.severity,f=(0,y.default)(n.props.value,"metricThreshold.".concat(a,".").concat(r));l({names:n.props.value.names,metricThreshold:(0,c.default)({},a,(0,c.default)({},r,"thresholds"===e?u:f)),comparator:"comparator"===e?u:o,for:s,severity:i})}))}},n.handleDurationChange=function(e){var t=n.state,a=t.severity,r=t.nodeResourceType,l=t.monitorType,u=t.comparator,o=(0,y.default)(n.props.value,"metricThreshold.".concat(r,".").concat(l));n.setState({duration:e},(function(){n.props.onChange({names:n.props.value.names,metricThreshold:(0,c.default)({},r,(0,c.default)({},l,o)),for:e,severity:a,comparator:u})}))},n.handleSeverityChange=function(e){var t=n.state,a=t.duration,r=t.nodeResourceType,l=t.monitorType,u=t.comparator,o=(0,y.default)(n.props.value,"metricThreshold.".concat(r,".").concat(l));n.setState({severity:e},(function(){n.props.onChange({names:n.props.value.names,metricThreshold:(0,c.default)({},r,(0,c.default)({},l,o)),for:a,comparator:u,severity:e})}))},n.renderConfigItem=function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.props.value,l=n.state,c=l.nodeResourceType,s=l.monitorType,i=a.type,f=a.name,d=a.placeholder,p=a.options,h=void 0===p?[]:p,v=a.reverser,E=a.converter,g=(0,o.default)(a,["type","name","placeholder","options","reverser","converter"]);if(v){var b=(0,y.default)(r,"metricThreshold.".concat(c,".").concat(s),"");e=""!==b?(0,S.default)(b,".")?b:v(Number(b)):""}var C={key:f,className:D.default[f],placeholder:t(d),value:"comparator"===f?n.state.comparator:e,onChange:n.handleItemChange(f,E)};switch(i){default:case"select":var T=n.getSelectOptions(h);return m.default.createElement(_.Select,(0,u.default)({options:T},C,g));case"number":return m.default.createElement(O.default,(0,u.default)({showUnit:!0},C,g,{integer:!1}))}},n.state=N(N({metricType:n.getMetricType(e)},n.getStateFromProps(e)),{},{metricOps:n.getSelectOptions(n.metricConfig)}),n}return(0,i.default)(r,[{key:"render",value:function(){var e=this.state,a=e.metricType,r=e.duration,n=e.severity,l=this.ruleConfig;return m.default.createElement("div",{className:D.default.inputs},m.default.createElement("div",{className:D.default.type},m.default.createElement(_.Select,{options:this.state.metricOps,value:a,onChange:this.handleMetricTypeChange})),l.map(this.renderConfigItem),m.default.createElement(_.Select,{value:r,className:D.default.normalSelect,options:P,onChange:this.handleDurationChange,placeholder:t("DURATION")}),m.default.createElement(R.default,{value:n,className:D.default.normalSelect,options:this.alertingTypeOptions,onChange:this.handleSeverityChange,placeholder:t("SEVERITY")}))}},{key:"resourceMetricsConfig",get:function(){return(0,g.default)(C.RESOURCE_METRICS_CONFIG.node)||{}}},{key:"alertingTypeOptions",get:function(){return T.severityOptions.map((function(e){return{label:e.label,value:e.value}}))}},{key:"metricConfig",get:function(){var e=this.resourceMetricsConfig;return Object.entries(e).map((function(e){var t=(0,l.default)(e,2);return N({value:t[0]},t[1])}))}},{key:"selectMetricConfig",get:function(){var e=this.state.metricType;return this.metricConfig.find((function(t){return t.value===e}))}},{key:"ruleConfig",get:function(){return(0,y.default)(this.selectMetricConfig,"ruleConfig")||[]}}]),r}(m.default.Component);A.propTypes={metricConfig:h.default.array,value:h.default.object,onChange:h.default.func},A.defaultProps={metricConfig:[],value:{},onChange:function(){}};var w=A;a.default=w},,function(e,t,a){e.exports={critical:"_28huuzFgXrJ6A5awxlLmo3",error:"_2bY9jX-FcyeLAsVRSTadc4",warning:"_38IIdf4HUwM0dVDJZueSYQ",info:"_28OI9ApLFda1TO7f4ri8Bu"}},function(e,t,a){e.exports={inputs:"_1yVUajtAef8AhyQtZ2UGfF",type:"rVNaKjX5dXQGjZ6T7OuFi",comparator:"_1yPrzflD49gPjizoYXpqaa",thresholds:"_28w2cWTwatHJT2puBGeAGe",normalSelect:"_2xhhjqI0Rhdg-vrU4jjwWs",optionLabel:"_1XLcPFr1dFfIXq9BiAT512",slider:"_3FGbsXervaDG5M0e7nQhO7",condition_type:"_25t0zn0luRkHFmHakj0RD_"}},function(e,t,a){e.exports={label:"OTDgTwIj2gmBcD0BMGmC6",contentGroup:"_3nfVSV6R6UI-KMSyFNGODe",inline:"_3iClSviv5wuM7iCH0ta61O",tabs:"_32qgHgW_mbXFffugytUxdz"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(44),r(6),r(20),r(98),r(14),r(99),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(44),r(6),r(20),r(27),r(98),r(14),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(7);var u=l(r(31)),o=l(r(97)),c=n(r(0)),s=r(189),i=l(r(26)),f=l(r(67)),d=l(r(253)),p=l(r(845)),m=l(r(119)),h=l(r(68)),v=l(r(444)),E=l(r(163)),y=l(r(1758)),g=l(r(1261)),b=l(r(1759)),S=l(r(1260)),_=l(r(923));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var T=s.Tabs.TabPanel,R={Deployment:"Deployment",Statefulset:"StatefulSet",Daemonset:"DaemonSet"},D=function(e,a){var r=e.editRule,n=e.exprBuilderTypeChange,l=(0,c.useState)("workload"),u=(0,o.default)(l,1)[0],O=(0,c.useState)("Deployment"),D=(0,o.default)(O,2),k=D[0],N=D[1],I=(0,c.useState)((function(){return(0,i.default)(r,"clusterSelector.inValues",[])})),P=(0,o.default)(I,1)[0],A=(0,y.default)(),w=(0,o.default)(A,1)[0],L=(0,c.useCallback)((function(e,t){return!!r.exprBuilder?(0,i.default)(r,e,t):t}),[r]),M=(0,c.useState)((function(){var e="workload";if(!(0,f.default)(r)&&r.exprBuilder){var t=r.exprBuilder;e=Object.keys(t)[0]}var a="workload"!==e;return{alert:L("alert",""),annotations:{summary:L("annotations.summary",""),message:L("annotations.message","")},clusterSelector:{inValues:L("clusterSelector.inValues",[])},namespaceSelector:{inValues:L("namespaceSelector.inValues",[])},expr:"",exprBuilder:{workload:{names:a?[{cluster:"",namespace:"",names:[]}]:L("exprBuilder.workload.names",[{cluster:"",namespace:"",names:[]}]),kind:R[L("exprBuilder.workload.kind","Deployment")],metricThreshold:a?{}:L("exprBuilder.workload.metricThreshold",{}),comparator:L("exprBuilder.workload.comparator",">"),for:L("for","1m"),severity:L("severity","critical")}},disable:L("disable",!1),labels:(0,i.default)(r,"labels")}})),x=(0,o.default)(M,2),j=x[0],U=x[1],F=(0,c.useRef)();(0,c.useImperativeHandle)(a,(function(){return{target:F.current}}));return c.default.createElement("div",null,c.default.createElement(s.Form,{data:j,ref:F,key:"workload"},c.default.createElement("div",{className:S.default.label},t("RULE_SETTINGS")),c.default.createElement("div",{className:S.default.contentGroup},c.default.createElement(s.Form.Item,{label:t("RULE_NAME"),desc:t("CUSTOM_RULE_NAME_DESC"),rules:[{required:!0,message:t("RULE_NAME_REQUIRED")}]},c.default.createElement(s.Input,{name:"alert",maxLength:63})),c.default.createElement("div",{className:S.default.tabs},c.default.createElement(s.Tabs,{type:"button",activeName:u,onChange:function(e){return n(e)}},c.default.createElement(T,{label:t("NODE"),name:"node"}),c.default.createElement(T,{label:t("WORKLOAD"),name:"workload"}))),c.default.createElement(s.Form.Item,{label:t("RESOURCE_TYPE")},c.default.createElement(s.Select,{className:S.default.workloadType,name:"exprBuilder.workload.kind",options:[{label:t("DEPLOYMENT"),value:"Deployment"},{label:t("STATEFULSET"),value:"StatefulSet"},{label:t("DAEMONSET"),value:"DaemonSet"}],onChange:function(e){N(e);var t=(0,m.default)(j);(0,h.default)(t,"exprBuilder.workload.names",[{cluster:"",namespace:"",names:[]}]),U(t)}})),c.default.createElement(s.Form.Item,{label:t("MONITORING_TARGETS"),rules:[{required:!0,message:t("MONITOR_TARGET_EMPTY")},{validator:function(a,r,n){var l=(0,p.default)(r.filter((function(e){return""!==e&&""!==e.namespace})),(function(e){return e.cluster}));return Object.entries(l).some((function(e){var t=(0,o.default)(e,2)[1].map((function(e){return e.namespace}));return(0,d.default)(t).length!==t.length}))?n({message:t("NAME_SPACE_REPEAT")}):(r.filter((function(e){return""!==e})).forEach((function(a){return""===a.cluster?n({message:t("CLUSTER_FIELD_EMPTY")}):e.allClusters.find((function(e){return e.name===a.cluster}))?""===a.namespace?n({message:t("SET_NAMESPACE_BELONGS_TO")}):(0,f.default)(a.names)?n({message:t("MONITOR_TARGET_EMPTY")}):void 0:n({message:t("MONITOR_TARGET_CLUSTER_DELETED_DESC")})})),n())}}]},c.default.createElement(g.default,{monitorLevel:"workload",workloadType:k,name:"exprBuilder.workload.names",clusterTargets:P,allClusters:e.allClusters,allWorkspace:w,handleChangeNs:function(e){var t=e.filter((function(e){return""!==e&&""!==e.namespace})).map((function(e){return e.namespace}));U(C(C({},j),{},{namespaceSelector:{inValues:(0,d.default)(t)}}))}})),c.default.createElement(s.Form.Item,{label:t("TRIGGER_CONDITION"),rules:[{required:!0,message:t("SET_ACTIVATION_CONDITION_DESC")},{validator:function(e,a,r){if(!a)return r();if((0,f.default)(a.comparator))return r({message:t("OPERATOR_REQUIRED"),field:e.field});if((0,f.default)(a.metricThreshold))return r({message:t("THRESHOLD_REQUIRED"),field:e.field});var n=Object.keys(a.metricThreshold)[0],l=Object.keys(a.metricThreshold[n])[0],u=a.metricThreshold[n][l];return""===u||!u||(0,E.default)(u)?r({message:t("THRESHOLD_REQUIRED"),field:e.field}):(0,v.default)(u,".")?r({message:t("THRESHOLD_INVALID"),field:e.field}):void r()}}]},c.default.createElement(b.default,{name:"exprBuilder.workload"}))),c.default.createElement(_.default,null),c.default.createElement("div",{className:S.default.label},t("MESSAGE_SETTINGS")),c.default.createElement("div",{className:S.default.contentGroup},c.default.createElement(s.Form.Item,{className:S.default.message,label:t("MESSAGE_SUMMARY"),desc:t("MESSAGE_SUMMARY_DESC"),rules:[{required:!0,message:t("MESSAGE_REQUIRED")}]},c.default.createElement(s.Input,{name:"annotations.summary",maxLength:63})),c.default.createElement(s.Form.Item,{className:S.default.message,label:t("MESSAGE_DETAILS"),desc:t("MESSAGE_DETAILS_DESC")},c.default.createElement(s.TextArea,{name:"annotations.message",maxLength:256})))))},k=(0,c.forwardRef)(D);a.default=k},function(e,t,a){"use strict";a(16);var r=a(19);a(36),a(20),a(14),a(4),a(21),a(46),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(36),a(20),a(14),a(4),a(21),a(46),a(40);var n=r(a(97)),l=a(0),u=r(a(443)),o=function(){var e=(0,l.useRef)(new u.default),t=(0,l.useState)([]),a=(0,n.default)(t,2),r=a[0],o=a[1];return(0,l.useEffect)((function(){Promise.all([e.current.fetchList({limit:-1})]).then((function(e){var t=(0,n.default)(e,1)[0].map((function(e){return{name:e.name,clusters:e.clusters}}));o(t)}))}),[]),[r]};t.default=o},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(20),r(98),r(14),r(24),r(99),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(71),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(97)),u=n(r(317)),o=n(r(50)),c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37));r(12),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(98),r(29),r(14),r(24),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(71),r(7);var m=n(r(0)),h=n(r(1)),v=n(r(5)),E=n(r(76)),y=n(r(26)),g=n(r(119)),b=n(r(67)),S=n(r(444)),_=r(189),O=n(r(805)),C=r(944),T=n(r(945)),R=r(922),D=n(r(1760));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var P=[1,5,15,30,60].map((function(e){return{label:t.html("LASTING_MINUTES",{minutes:e}),value:"".concat(e,"m")}})),A=R.severityOptions.map((function(e){return{label:e.label,value:e.value}})),w=function(e){(0,f.default)(r,e);var a=I(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).getMetricType=function(e){var t=n.metricConfig[0].value,a=(0,y.default)(e,"value.metricThreshold",{});if((0,b.default)(a))return n.metricConfig[0].value;var r=Object.keys(a)[0],l=Object.keys(a[r])[0];return n.metricConfig.some((function(e){return e.value==="".concat(r,":").concat(l)}))?"".concat(r,":").concat(l):t},n.getStateFromProps=function(e){var t=e.value,a=void 0===t?{}:t,r=(0,y.default)(a,"metricThreshold",{}),l=n.metricConfig[0].value.split(":"),u=l[0],o=l[1];if(!(0,b.default)(r)){var c=Object.keys(r)[0];n.metricConfig.some((function(e){return e.value==="".concat(c,":").concat(Object.keys(r[c])[0])}))&&(u=c,o=Object.keys(r[c])[0])}var s=(0,y.default)(a,"for",""),i=(0,y.default)(a,"severity","");return{resourceType:"workload",nodeResourceType:u,monitorType:o,comparator:(0,y.default)(a,"comparator",""),duration:""!==s?s:P[0].value,severity:""!==i?i:A[0].value}},n.getSelectOptions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var a=e.prefixIcon,r=e.color,n=e.type,l=e.label,u=e.value,o=e.disabled,c={label:t(l,{value:u}),value:u};return a&&(c.label=m.default.createElement("div",{className:(0,v.default)(D.default.optionLabel,D.default[n])},m.default.createElement(_.Icon,{name:a,size:20,color:r}),c.label)),o&&(c.disabled=o),c}))},n.handleMetricTypeChange=function(e){var t=e.split(":")[0],a=e.split(":")[1],r=n.state,l=r.comparator,u=r.severity,o=r.duration;n.setState({metricType:e,nodeResourceType:t,monitorType:a,thresholds:""},(function(){n.props.onChange({names:n.props.value.names,metricThreshold:(0,c.default)({},t,(0,c.default)({},a,"")),kind:n.props.value.kind,comparator:l,severity:u,for:o})}))},n.handleItemChange=function(e,t){return function(a,r){var l=n.props.onChange,u=(0,E.default)(r)||!r?a:r;"thresholds"===e&&(u=""!==(u=String(u).replace(/([a-zA-Z%/])+$/g,""))?(0,S.default)(u,".")?u:t(Number(u)):""),n.setState((0,c.default)({},e,u),(function(){var t=n.state,a=t.nodeResourceType,r=t.monitorType,o=t.comparator,s=t.duration,i=t.severity,f=(0,y.default)(n.props.value,"metricThreshold.".concat(a,".").concat(r));l({names:n.props.value.names,metricThreshold:(0,c.default)({},a,(0,c.default)({},r,"comparator"===e?f:u)),comparator:"comparator"===e?u:o,for:s,kind:n.props.value.kind,severity:i})}))}},n.handleDurationChange=function(e){var t=n.state,a=t.severity,r=t.nodeResourceType,l=t.monitorType,u=t.comparator,o=(0,y.default)(n.props.value,"metricThreshold.".concat(r,".").concat(l));n.setState({duration:e},(function(){n.props.onChange({names:n.props.value.names,metricThreshold:(0,c.default)({},r,(0,c.default)({},l,o)),kind:n.props.value.kind,for:e,severity:a,comparator:u})}))},n.handleSeverityChange=function(e){var t=n.state,a=t.duration,r=t.nodeResourceType,l=t.monitorType,u=t.comparator,o=(0,y.default)(n.props.value,"metricThreshold.".concat(r,".").concat(l));n.setState({severity:e},(function(){n.props.onChange({names:n.props.value.names,metricThreshold:(0,c.default)({},r,(0,c.default)({},l,o)),kind:n.props.value.kind,for:a,comparator:u,severity:e})}))},n.renderConfigItem=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.props.value,r=n.state,l=r.nodeResourceType,c=r.monitorType,s=t.type,i=t.name,f=(t.placeholder,t.options),d=void 0===f?[]:f,p=t.reverser,h=t.converter,v=(0,o.default)(t,["type","name","placeholder","options","reverser","converter"]);if(p){var E=(0,y.default)(a,"metricThreshold.".concat(l,".").concat(c),"");e=""!==E?(0,S.default)(E,".")?E:p(Number(E)):""}var g={key:i,className:D.default[i],value:"comparator"===i?n.state.comparator:e,onChange:n.handleItemChange(i,h)};switch(s){default:case"select":var b=n.getSelectOptions(d);return m.default.createElement(_.Select,(0,u.default)({options:b},g,v));case"number":return m.default.createElement(O.default,(0,u.default)({showUnit:!0},g,v,{integer:!1}))}},n.state=N(N({metricType:n.getMetricType(e)},n.getStateFromProps(e)),{},{metricOps:n.getSelectOptions(n.metricConfig)}),n}return(0,i.default)(r,[{key:"render",value:function(){var e=this.state,a=e.metricType,r=e.duration,n=e.severity,l=this.ruleConfig;return m.default.createElement("div",{className:D.default.inputs},m.default.createElement("div",{className:D.default.type},m.default.createElement(_.Select,{options:this.state.metricOps,value:a,onChange:this.handleMetricTypeChange})),l.map(this.renderConfigItem),m.default.createElement(_.Select,{className:D.default.normalSelect,value:r,options:P,onChange:this.handleDurationChange,placeholder:t("DURATION")}),m.default.createElement(T.default,{className:D.default.normalSelect,value:n,options:A,onChange:this.handleSeverityChange,placeholder:t("SEVERITY")}))}},{key:"resourceMetricsConfig",get:function(){return(0,g.default)(C.RESOURCE_METRICS_CONFIG.workload)||{}}},{key:"metricConfig",get:function(){var e=this.resourceMetricsConfig;return Object.entries(e).map((function(e){var t=(0,l.default)(e,2);return N({value:t[0]},t[1])}))}},{key:"selectMetricConfig",get:function(){var e=this.state.metricType;return this.metricConfig.find((function(t){return t.value===e}))}},{key:"ruleConfig",get:function(){return(0,y.default)(this.selectMetricConfig,"ruleConfig")||[]}}]),r}(m.default.Component);w.propTypes={metricConfig:h.default.array,value:h.default.object,onChange:h.default.func},w.defaultProps={metricConfig:[],value:{},onChange:function(){}};var L=w;a.default=L},function(e,t,a){e.exports={inputs:"_22dSEjReyNtRAovrRqwepd",type:"_1qKnJhTbQ9P1K8b5C7isFh",comparator:"_2934urzRpfiaiE2H1aYeKn",thresholds:"_3KU0ZSAcGoucHIrPp4tB74",normalSelect:"_3_DRDDTACzLkLCwuHgq14h",optionLabel:"khN9msWTcWOcL2-iNjmnk",slider:"_8373eD5TRR5yoHsXbknSr",condition_type:"_2XU1Q-On54b6cNM-_2iKc4"}},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(317)),u=r(a(0)),o=n(a(1762)),c=function(e,t){var a=(0,u.useRef)();return(0,u.useImperativeHandle)(t,(function(){return{target:a.current.target}})),u.default.createElement(o.default,(0,l.default)({ref:a},e))},s=(0,u.forwardRef)(c);t.default=s},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(51),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(51),r(30),r(195);var u=l(r(97)),o=n(r(0)),c=r(189),s=l(r(26)),i=l(r(5)),f=r(56),d=l(r(980)),p=l(r(1764)),m=l(r(1775)),h=l(r(1787)),v=r(922),E=l(r(923)),y=l(r(945)),g=function(e,a){var r=e.editRule,n=(0,o.useRef)();(0,o.useImperativeHandle)(a,(function(){return{target:n.current}}));var l=(0,o.useState)((function(){return{alert:(0,s.default)(r,"alert",""),annotations:{summary:(0,s.default)(r,"annotations.summary",""),message:(0,s.default)(r,"annotations.message","")},clusterSelector:{inValues:(0,s.default)(r,"clusterSelector.inValues",[])},for:(0,s.default)(r,"for",""),expr:(0,s.default)(r,"expr",""),severity:(0,s.default)(r,"severity","critical"),disable:(0,s.default)(r,"disable",!1),labels:(0,s.default)(r,"labels")}})),g=(0,u.default)(l,1)[0],b=(0,o.useCallback)((function(e,a,r){var n=a.slice(0,-1);if(!/^[0-9]*$/.test(n))return r({message:t("INVALID_TIME_DESC")});r()}),[]),S=(0,o.useCallback)((function(e,a,r){if(!a)return r({message:t("CLUSTER_SETTINGS_LIMIT_DESC")});r()}),[]);return o.default.createElement(c.Form,{data:g,ref:n},o.default.createElement("div",{className:h.default.label},t("CLUSTER_SETTINGS")),o.default.createElement("div",{className:h.default.contentGroup},o.default.createElement("div",null,o.default.createElement(c.Form.Item,{rules:[{validator:S}]},o.default.createElement(m.default,{name:"clusterSelector.inValues",allClusters:e.allClusters,fetchClusterList:e.fetchClusterList})))),o.default.createElement("div",{className:h.default.label},t("RULE_SETTINGS")),o.default.createElement("div",{className:h.default.contentGroup},o.default.createElement(c.Columns,{className:h.default.inline},o.default.createElement(c.Column,null,o.default.createElement(c.Form.Item,{label:t("RULE_NAME"),desc:t("CUSTOM_RULE_NAME_DESC"),rules:[{required:!0,message:t("RULE_NAME_REQUIRED")}]},o.default.createElement(c.Input,{name:"alert",maxLength:63})))),o.default.createElement(c.Columns,{className:h.default.inline},o.default.createElement(c.Column,null,o.default.createElement(c.Form.Item,{label:t("DURATION"),desc:t("ALERT_DURATION"),rules:[{validator:b}]},o.default.createElement(d.default,{name:"for",inputClassName:h.default.duration,unitOptions:v.durationUnitOptions,defaultValue:v.durationUnitOptions[1].value}))),o.default.createElement(c.Column,null,o.default.createElement(c.Form.Item,{label:t("SEVERITY"),rules:[{required:!0,message:t("SEVERITY_REQUIRED")}]},o.default.createElement(y.default,{name:"severity",defaultValue:"critical"})))),o.default.createElement(c.Form.Item,{label:t("RULE_EXPRESSION"),desc:(0,f.learnMoreTip)(t.html("ALERT_RULE_EXPRESSION_DESC")),rules:[{required:!0,message:t("ALERT_RULE_REQUIRED")}]},o.default.createElement(p.default,{name:"expr",store:e.store,cluster:e.cluster}))),o.default.createElement(E.default,null),o.default.createElement("div",{className:h.default.label},t("MESSAGE_SETTINGS")),o.default.createElement("div",{className:(0,i.default)(h.default.contentGroup,h.default.lineContent)},o.default.createElement(c.Form.Item,{label:t("MESSAGE_SUMMARY"),desc:t("MESSAGE_SUMMARY_DESC"),rules:[{required:!0,message:t("MESSAGE_REQUIRED")}]},o.default.createElement(c.Input,{name:"annotations.summary",maxLength:63})),o.default.createElement(c.Form.Item,{label:t("MESSAGE_DETAILS"),desc:t("MESSAGE_DETAILS_DESC")},o.default.createElement(c.TextArea,{name:"annotations.message",maxLength:256}))))},b=(0,o.forwardRef)(g);a.default=b},function(e,t,a){e.exports={box:"_2cba8IQmk8PkrIeuCYMHpS",value:"_8HQz1aKq2aTQNQgiSBLkX",unit:"_1NbuZuw18npuIgdF-lDVT5"}},function(e,t,a){"use strict";a(16);var r=a(19),n=a(162);a(20),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(20),a(29),a(8),a(4),a(18),a(43),a(11);var l,u,o=r(a(317)),c=r(a(25)),s=r(a(28)),i=r(a(41)),f=r(a(42)),d=r(a(37)),p=r(a(45)),m=n(a(0)),h=a(243),v=a(17),E=r(a(1101));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var g=(0,h.observer)((u=function(e){(0,i.default)(a,e);var t=y(a);function a(){return(0,c.default)(this,a),t.apply(this,arguments)}return(0,s.default)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.cluster,a=e.namespace;this.hasMonitoring&&this.props.store.fetchMetadata({cluster:t,namespace:a})}},{key:"render",value:function(){return m.default.createElement(E.default,(0,o.default)({},this.props,{supportMetrics:this.supportMetrics}))}},{key:"hasMonitoring",get:function(){var e=this.props.cluster;return globals.app.hasClusterModule(e,"whizard-monitoring")}},{key:"supportMetrics",get:function(){return this.hasMonitoring?this.props.store.targetsMetadata.map((function(e){return{value:e.metric,desc:e.help,type:e.type}})):[]}}]),a}(m.Component),(0,p.default)(u.prototype,"supportMetrics",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"supportMetrics"),u.prototype),l=u))||l;t.default=g},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var l=n(a(31)),u=n(a(25)),o=n(a(28)),c=n(a(41)),s=n(a(42)),i=n(a(37)),f=r(a(0)),d=n(a(5)),p=a(189),m=n(a(1266)),h=n(a(1102));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=function(e){(0,c.default)(a,e);var t=v(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).ref=f.default.createRef(),e.handleClick=function(){var t=e.props,a=t.data;(0,t.onClick)(a.value)},e.handleSelect=function(){var t=e.props,a=t.data;(0,t.onSelect)(a.value)},e}return(0,o.default)(a,[{key:"getOptionsStyle",value:function(){var e={};if(this.ref&&this.ref.current){var t=this.props.data;if(t.children){var a=Math.min(t.children.length,8),r=this.ref.current.getBoundingClientRect(),n=this.ref.current.parentNode.getBoundingClientRect();r.top-n.top>n.height/2?e.top=r.top-4-32*(a-1):e.top=r.top-4,e.left=r.left+r.width,window.innerHeight-e.top<252&&(e.maxHeight=window.innerHeight-e.top-8)}}return e}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.level,r=e.isOpen,n=e.onSelect;return t.children?f.default.createElement("div",{ref:this.ref},f.default.createElement("div",{className:(0,d.default)(h.default.item,h.default.hasChildren,(0,l.default)({},h.default.isOpen,r)),onClick:this.handleClick},t.label,f.default.createElement(p.Icon,{name:"chevron-right",type:"light"})),r&&f.default.createElement(m.default,{level:a+1,options:t.children,onSelect:n,style:this.getOptionsStyle()})):f.default.createElement("div",{className:h.default.item,onClick:this.handleSelect},t.label)}}]),a}(f.Component);t.default=E},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(10),r(88),r(20),r(9),r(4),r(18),r(30),r(11),r(197),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(58)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37));r(32),r(3),r(10),r(88),r(20),r(29),r(9),r(4),r(18),r(43),r(30),r(11),r(197);var d=l(r(67)),p=n(r(0)),m=l(r(5)),h=l(r(830)),v=l(r(1767)),E=r(1268),y=l(r(1768)),g=l(r(1269));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=function(e){(0,s.default)(r,e);var a=b(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={focusIndex:0,labels:[],functions:[],metrics:[],rateRanges:[]},e.wrapper=p.default.createRef(),e.handleArrowDown=function(){e.setState((function(e){var t=e.focusIndex,a=e.labels,r=e.functions,n=e.metrics,l=e.rateRanges;return{focusIndex:t>=a.length+r.length+n.length+l.length-1?0:t+1}}),e.scrollToFocus)},e.handleArrowUp=function(){e.setState((function(e){var t=e.focusIndex,a=e.labels,r=e.functions,n=e.metrics,l=e.rateRanges,u=a.length+r.length+n.length+l.length;return{focusIndex:t<=0?u-1:t-1}}),e.scrollToFocus)},e.handleEnter=function(){var t=e.props.onSelect,a=e.state,r=a.focusIndex,n=a.functions,l=a.metrics,o=a.rateRanges,c=a.labels,s=[].concat((0,u.default)(c),(0,u.default)(n),(0,u.default)(l),(0,u.default)(o))[r];s&&t(s.value||s.label)},e.handleKeyDown=function(t){e.keydownHandler[t.keyCode]&&(t.stopPropagation(),t.preventDefault(),e.keydownHandler[t.keyCode](t))},e.scrollToFocus=function(){if(e.wrapper&&e.wrapper.current){var t=e.wrapper.current,a=t.querySelector(".is-focus");if(!a)return;var r=t.scrollTop,n=r+t.offsetHeight,l=a.offsetTop,u=l+a.offsetHeight;(r>l||n<u)&&(t.scrollTop=a.offsetTop-6)}},e.searchMetrics=function(t){return e.fuse.search(t,{limit:50}).map((function(e){return{value:e.item}}))},e}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.fuse=new v.default(this.props.metrics.map((function(e){return e.value}))),this.getSuggestions(),document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(e){e.value===this.props.value&&(0,h.default)(e.tokenContext,this.props.tokenContext)&&(0,h.default)(e.labelsets,this.props.labelsets)||this.getSuggestions(),(0,h.default)(e.metrics,this.props.metrics)||(this.fuse=new v.default(this.props.metrics.map((function(e){return e.value}))),this.getSuggestions())}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"getSuggestions",value:function(){var e=this.props,t=e.value,a=e.labelsets,r=e.tokenContext,n=[],l=[],u=[],o=[];r&&r.type.indexOf("context-labels")>-1?o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,r=Object.keys(e);if("{"===t||","===t)return r.map((function(e){return{value:e}}));if(a.label){var n=e[a.label]||[];return"="===t?n.map((function(e){return{value:'"'.concat(e,'"')}})):'""'===t||"''"===t?n.map((function(e){return{value:e}})):n.map((function(e){return'"'.concat(e,'"')})).filter((function(e){return e.indexOf(t)>=0})).map((function(e){return{value:e}}))}return r.filter((function(e){return e.indexOf(t)>=0})).map((function(e){return{value:e}}))}(a,t,r):(n=function(e){return E.FUNCTIONS.filter((function(t){return t.label.indexOf(e)>=0}))}(t),l=this.searchMetrics(t),u=function(e){return"["===e?E.RATE_RANGES:[]}(t)),this.setState({functions:n,metrics:l,rateRanges:u,labels:o})}},{key:"renderList",value:function(e,t){var a=this.props,r=a.value,n=a.onSelect,l=this.state.focusIndex;return(0,d.default)(e)?null:p.default.createElement("div",{className:g.default.group},p.default.createElement("div",{className:g.default.groupTitle},t),p.default.createElement("div",{className:g.default.options},e.map((function(e,t){return p.default.createElement(y.default,{key:e.value||e.label,data:e.value||e.label,inputValue:r,isFocused:l===t,onSelect:n})}))))}},{key:"render",value:function(){var e=this.props.className,a=this.state,r=a.functions,n=a.metrics,l=a.rateRanges,u=a.labels;return(0,d.default)(r)&&(0,d.default)(n)&&(0,d.default)(l)&&(0,d.default)(u)?null:p.default.createElement("div",{className:(0,m.default)(g.default.wrapper,e),ref:this.wrapper},this.renderList(u,t("ALERT_LABELS")),this.renderList(r,t("ALERT_FUNCTIONS")),this.renderList(l,t("ALERT_RATE_RANGES")),this.renderList(n,t("ALERT_METRICS")))}},{key:"keydownHandler",get:function(){return{38:this.handleArrowUp,40:this.handleArrowDown,13:this.handleEnter,14:this.handleEnter}}}]),r}(p.Component);a.default=S},,function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(51),a(4),a(18),a(30),a(11),a(139),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(51),a(29),a(4),a(18),a(43),a(30),a(11),a(139);var l=n(a(25)),u=n(a(28)),o=n(a(41)),c=n(a(42)),s=n(a(37)),i=r(a(0)),f=n(a(5)),d=n(a(1269));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).handleClick=function(){var t=e.props,a=t.data;(0,t.onSelect)(a)},e}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.inputValue,r=e.isFocused,n=t.split(a)[0];return i.default.createElement("div",{className:(0,f.default)(d.default.item,{"is-focus":r}),onClick:this.handleClick},i.default.createElement("span",null,n),t.length>n.length&&i.default.createElement(i.default.Fragment,null,i.default.createElement("span",{className:"highlight"},a),i.default.createElement("span",null,t.slice(n.length+a.length))))}}]),a}(i.Component);t.default=m},function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(88),a(66),a(20),a(8),a(13),a(9),a(4),a(30),a(11),a(71),a(139),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.getTokenContext=t.highlightPromql=t.OPERATORS=t.PUNCTUATION_MAP=t.setCaretPosition=t.getCaretCharacterOffsetWithin=void 0;var n=r(a(31));a(12),a(32),a(10),a(6),a(88),a(66),a(20),a(27),a(247),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(30),a(11),a(71),a(7);var l=r(a(26)),u=r(a(1770)),o=r(a(1268));function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}a(1771),u.default.languages.promql=o.default;t.getCaretCharacterOffsetWithin=function(e){var t=0,a=e.ownerDocument||e.document,r=a.defaultView||a.parentWindow;if(void 0!==r.getSelection){if(r.getSelection().rangeCount>0){var n=r.getSelection().getRangeAt(0),l=n.cloneRange();l.selectNodeContents(e),l.setEnd(n.endContainer,n.endOffset),t=l.toString().length}}else if("Control"!==a.selection.type){var u=a.selection.createRange(),o=a.body.createTextRange();o.moveToElementText(e),o.setEndPoint("EndToEnd",u),t=o.text.length}return t};t.setCaretPosition=function(e,t){var a=document.createRange(),r=window.getSelection(),n=[];!function e(t,a){t&&3===t.nodeType&&a.push(t);for(var r=t.childNodes,n=0;n<r.length;n++)e(r[n],a)}(e,n);for(var u=t,o=0;u>0;)u-=(0,l.default)(n,"[".concat(o,"].length"),0),o++;var c=n[o-1];null!=c&&(a.setStart(c,u+c.length),a.collapse(!0),r.removeAllRanges(),r.addRange(a))};t.PUNCTUATION_MAP={"(":")","[":"]","{":"}",'"':'"',"'":"'"};t.OPERATORS=["(","[","{",'"',"'",'""',"''","=",","];t.highlightPromql=function(e){return u.default.highlight(e,u.default.languages.promql,"promql")};t.getTokenContext=function(e,t){for(var a=[],r=t;r.parentNode&&e!==r.parentNode;)a.push(r.parentNode),r=r.parentNode;var u=a.reverse().map((function(e){return e.className&&e.className.split(" ")[1]||""})).join("."),o={},s=t.parentNode.className;return s.indexOf("label-key")>-1?o.label="":s.indexOf("label-value")>-1?(o.label=(0,l.default)(t,"parentNode.previousSibling.previousSibling.textContent",""),o.value=""):s.indexOf("context-labels")>-1&&(t.previousSibling?t.previousSibling.className.indexOf("label-key")>-1?(o.label=t.previousSibling.textContent.replace(/{,/g,""),o.value=""):t.previousSibling.className.indexOf("label-value")>-1&&(o.label=t.textContent.replace(/{,/g,"")):o.label=""),function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({type:u},o)}},,function(e,t,a){},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(27);var n=r(a(25)),l=r(a(28)),u=function(){function e(t){(0,n.default)(this,e),this.data=[],this.maxLength=50,this.cursor=0,isNaN(t)||(this.maxLength=t)}return(0,l.default)(e,[{key:"push",value:function(e){this.data.length>=this.maxLength&&this.data.shift(),this.data.push(e),this.cursor=0}},{key:"undo",value:function(){return this.cursor<this.data.length-1&&(this.cursor+=1),this.data[this.data.length-1-this.cursor]}},{key:"redo",value:function(){return this.cursor>0&&(this.cursor-=1),this.data[this.data.length-1-this.cursor]}}]),e}();t.default=u},function(e,t,a){e.exports={wrapper:"_2Djs149fKvXq0cuQnoPLWv",input:"_3r2beirvrZ6qtbzzlFsRsd",suggestions:"Q7oMYSMcW984KaLwUtxe0"}},function(e,t,a){e.exports={wrapper:"_1w-rN95sN7ztXIW47qpxDr",trigger:"_3RKOgK42gRQ35DXoTa7VUE",input:"_1_1MeGWNh944JJ0DAi3osN",debug:"_3Ftx4Zx_7HgfhQ47jLEOEi"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(10),r(44),r(6),r(202),r(88),r(36),r(20),r(14),r(327),r(4),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(10),r(44),r(6),r(202),r(88),r(36),r(20),r(14),r(327),r(4),r(46),r(7),r(40);var u=l(r(97)),o=n(r(0)),c=r(189),s=l(r(67)),i=l(r(846)),f=l(r(800)),d=r(905),p=l(r(5)),m=l(r(1785)),h=l(r(1786)),v=function(e){var a=(0,o.useState)(""),r=(0,u.default)(a,2),n=r[0],l=r[1],v=(0,o.useState)([]),E=(0,u.default)(v,2),y=E[0],g=E[1],b=(0,m.default)(),S=(0,u.default)(b,1)[0],_=(0,o.useState)(new Map),O=(0,u.default)(_,2),C=O[0],T=O[1],R=(0,o.useState)(!1),D=(0,u.default)(R,2),k=D[0],N=D[1];(0,o.useEffect)((function(){var t=new Map,a=e.value;e.allClusters.forEach((function(e){(-1!==a.indexOf(e.name)||(0,s.default)(a))&&t.set(e.name,e)})),T(t),N(t.size===e.allClusters.length),g(e.allClusters)}),[]),(0,o.useEffect)((function(){e.fetchClusterList({name:n,limit:-1})}),[n]);var I=function(t,a){var r=Array.from(t.values()).map((function(e){return e.name})),n=e.onChange;n(a?[]:(0,s.default)(r)?void 0:r)},P=function(e){return o.default.createElement("ul",{className:(0,p.default)(h.default.clusterList,h.default.longList)},e.map((function(e){return o.default.createElement("li",{className:h.default.cluster,key:e.uid},o.default.createElement(c.Columns,{className:h.default.inline},o.default.createElement(c.Column,{className:(0,p.default)("is-6",h.default.left)},o.default.createElement(c.Checkbox,{className:h.default.checkBox,checked:C.has(e.name),onChange:function(){return function(e){if(C.has(e.name))C.delete(e.name),T(new Map(C)),N(!1),I(C,!1);else{var t=new Map(C.set(e.name,e)),a=t.size===y.length;T(t),N(a),I(t,a)}}(e)}}),o.default.createElement(i.default,{className:"flex",cluster:e})),o.default.createElement(c.Column,{className:"is-6"},o.default.createElement(f.default,{title:o.default.createElement(d.ClusterTagGroup,{data:e.tags.map((function(e){return(S||[]).find((function(t){return e.name===t.name}))})).filter(Boolean),empty:"-"}),description:t("CLUSTER_TAG")}))))})))},A=function(e){l(e)},w=function(e){var t=new Map;e?(y.forEach((function(e){t.set(e.name,e)})),T(t)):T(t),N(!k),I(t,!k)};return o.default.createElement("div",{className:h.default.clusterListBox},o.default.createElement("div",{className:(0,p.default)(h.default.clusterContainer)},o.default.createElement("div",{className:h.default.clusterSearch},o.default.createElement(c.Checkbox,{checked:k,onChange:w,className:h.default.checkBox,indeterminate:!(y.length===C.size||0===C.size)},t("SELECT_ALL")),o.default.createElement(c.InputSearch,{className:h.default.input,placeholder:t("SEARCH"),value:n,onSearch:A})),P(e.allClusters)))};a.default=v},,,,,,,,,,function(e,t,a){"use strict";a(16);var r=a(19);a(36),a(4),a(21),a(46),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(36),a(4),a(21),a(46),a(40);var n=r(a(97)),l=a(0),u=r(a(946)),o=function(){var e=(0,l.useRef)(new u.default),t=(0,l.useState)([]),a=(0,n.default)(t,2),r=a[0],o=a[1];return(0,l.useEffect)((function(){Promise.all([e.current.fetchGroupList({limit:-1})]).then((function(){o(e.current.tags)}))}),[]),[r,o]};t.default=o},function(e,t,a){e.exports={clusterListBox:"_3E7nfg18gc4YMpsXgkwewv",addBox:"_1bSE9f95Y6l3IUXRFqHiFq",clusterContainer:"iy_9AILE49q6oYEKPACE0",clusterSearch:"dY5lk9YVyLd2SKquC2Ipp",checkBox:"_3vsqcs9oAi9KmEj--p0mwz",input:"_1WOOb0mOWoitW54WM_TKhb",clusterList:"_1mEvnbfJL19vM01-pNmIzr",cluster:"HClXzP_agDUOBsD0DJB6U",inline:"_1jaGfWoiirbQyPg-EuCumT",left:"AwqUeOTDH3PUXkcCg2vXk",opt:"_3f745MPKWGUCPKuoEPpZNN",confirm:"FXS6GkOHCxUqj1785Bm_-",closeBt:"_2WxNJ61Iksv2sR--6616Xa",longList:"_2zueFWuIjAUgYy6xVBFRMq"}},function(e,t,a){e.exports={label:"_3lNFoNYnAqovuExjDshs8H",contentGroup:"FtMWAlt2Tg-L4j3LNBR9C",inline:"_11BH9gaIIj9QroYWoqVvz1",tabs:"_1DlseBgXppe_l3oWxUut-q",lineContent:"Y-jejgDishnXFaxP6vPRR",duration:"_3kmRCD04N-liwEB5XNldbW"}},function(e,t,a){"use strict";a(16);var r=a(19);a(36),a(4),a(21),a(46),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(36),a(4),a(21),a(46),a(40);var n=r(a(38));a(35);var l=r(a(39)),u=r(a(97)),o=a(0),c=r(a(448)),s=function(){var e=(0,o.useRef)(new c.default),t=(0,o.useState)([]),a=(0,u.default)(t,2),r=a[0],s=a[1],i=function(){var t=(0,l.default)(n.default.mark((function t(a){var r;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.current.fetchList(a);case 2:r=t.sent,s(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,o.useEffect)((function(){Promise.all([e.current.fetchList({limit:-1})]).then((function(e){var t=(0,u.default)(e,1)[0];s(t)}))}),[]),[r,i]};t.default=s},function(e,t,a){e.exports={duration:"-SaLSCfbFV8IwEL3sGldL"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports={body:"_2wR1cHcoTFPowct6lhS7sm",header:"_1jOqrejT-N_BHHdCQb-0Mn",opts:"iZMjxLb3Eo6Hq9DIXiv0b",time:"_1VVyg3AhHjMJpzBLLXWl5s",refresh:"qyYd8KZQc7CrY6RZPRGB",metricEmpty:"_2Bq7rWkA-A9qLWEUe0UDGi",current:"_2KeSgv26nHtSAyiv2ry3s6",main:"_3mYfaiozhmmBh1g4b3-36p",title:"_19Wuw4SPjjZLpELOQMdDMp",line:"_1uAPor3uobJmIoidRolK-y",value:"_1NNfBFfwOyu5pKlP62ABDz",metric:"_2QKdphcMV0-7S4aBy3GYSH"}},function(e,t,a){e.exports={icon:"_3zoeqnSkF53g0SBCoEq19K",title:"_3cXx0QrPrFQYMxrUWD2eD",desc:"_21s3yDXppxrTySFmLkEatQ"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1313)),l=r(a(1256)),u=[{title:"BASIC_INFORMATION",component:n.default,required:!0,icon:"cdn"},{title:"ALERTING_RULE",component:l.default,required:!0,icon:"bell"}];t.default=u},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(88),r(36),r(66),r(14),r(8),r(13),r(9),r(4),r(21),r(30),r(46),r(139),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(88),r(36),r(66),r(27),r(141),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(119)),i=n(r(26)),f=n(r(68)),d=r(17),p=n(r(191)),m=n(r(978)),h=n(r(798)),v=n(r(822)),E=n(r(819)),y=n(r(1314)),g=n(r(1276)),b=n(r(1277)),S=n(r(1124)),_=r(61),O=n(r(438)),C=n(r(864)),T=n(r(1928)),R=n(r(1929));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var N=function(e){var t=e.namespace,a=e.type;return t?"RuleGroup":"builtin"===a?"GlobalRuleGroup":"ClusterRuleGroup"},I={"alerting.policy.create":{on:function(e){var a,r=e.store,n=e.cluster,o=e.namespace,f=e.module,d=e.success,m=e.detail,v=(0,c.default)(e,["store","cluster","namespace","module","success","detail"]),y=_.MODULE_KIND_MAP[f],g=m?(0,s.default)(m):O.default[f]({namespace:o}),b=h.default.open(k({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((0,i.default)(a,"spec.rules",[]).length<1)){e.next=3;break}return e.abrupt("return",p.default.warning({content:t("RULES_LIST_EMPTY")}));case 3:if(!m){e.next=9;break}return e.next=6,r.update(m,a);case 6:p.default.success({content:t("UPDATE_SUCCESSFUL")}),e.next=12;break;case 9:return e.next=11,r.create(a,k({name:a.metadata.name,cluster:n,namespace:o},v));case 11:p.default.success({content:t("CREATE_SUCCESSFUL")});case 12:h.default.close(b),d&&d(),C.default.delete("".concat(f,"_create_form"));case 15:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),module:f,cluster:n,namespace:o,name:y,formTemplate:g,modal:E.default,steps:v.app_id?R.default:T.default,noCodeEdit:!0,isEdit:!!m,okBtnText:m?t("OK"):t("CREATE"),store:r},v))}},"alerting.baseinfo.edit":{on:function(e){var a=e.type,r=e.store,n=e.detail,l=e.success,u=(0,c.default)(e,["type","store","detail","success"]),o=h.default.open(k({onOk:function(e){var u=(0,s.default)(e);(0,i.default)(u,"spec.interval").length<2&&(0,f.default)(u,"spec.interval",""),r.patch(k(k({},n),{},{type:a}),u).then((function(){h.default.close(o),p.default.success({content:t("UPDATE_SUCCESSFUL")}),l&&l()}))},detail:n,modal:g.default,store:r},u))}},"alerting.yaml.edit":{on:function(e){var a=e.type,r=e.store,n=e.detail,o=e.success,s=(e.cluster,e.namespace),d=(0,c.default)(e,["type","store","detail","success","cluster","namespace"]),v="",E=N({namespace:s,type:a});"builtin"===a&&(v=(0,i.default)(n._originData,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',""));var y,g=h.default.open(k({onOk:(y=(0,u.default)(l.default.mark((function e(u){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"builtin"===a&&((0,f.default)(u,"apiVersion",r.yamlApiVersion),(0,f.default)(u,"kind",E),(0,f.default)(u,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',v)),e.next=3,r.update(k(k({},n),{},{type:a}),u);case 3:p.default.success({content:t("UPDATE_SUCCESSFUL")}),h.default.close(g),o&&o();case 6:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)}),detail:k(k({},n),{},{type:a}),store:r,type:a,modal:m.default},d))}},"alerting.rule.edit":{on:function(e){var a,r=e.type,n=e.store,o=e.detail,s=e.success,d=e.cluster,m=e.namespace,v=(e.title,(0,c.default)(e,["type","store","detail","success","cluster","namespace","title"])),g=N({namespace:m,type:r}),b=h.default.open(k({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"builtin"!==r&&a.Kind||((0,f.default)(a,"apiVersion",n.yamlApiVersion),(0,f.default)(a,"kind",g)),e.next=3,n.update(k(k({},o),{},{type:r}),a);case 3:p.default.success({content:t("UPDATE_SUCCESSFUL")}),h.default.close(b),s&&s();case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:n,resource:o.name,detail:o,title:t("EDIT_ALERT_RULES"),icon:"pen",modal:E.default,steps:(0,i.default)(o,"_originData.metadata.labels.openpitrix_app_id")?[R.default[1]]:[{title:"ALERTING_RULE",component:y.default,required:!0}],noCodeEdit:!0,okBtnText:t("OK"),formTemplate:o._originData,namespace:m,cluster:d,type:r},v))}},"enable.alerting.rule":{on:function(e){var a=e.type,r=e.store,n=e.detail,l=e.success,u=e.cluster,o=void 0===u?"":u,c=e.namespace,s=void 0===c?"":c,f=e.batchMode,m=e.enabled,h=void 0!==m&&m,v=(0,i.default)((0,d.toJS)(r.list),"selectedRowKeys",[]);f?r.batchPatch(v,{cluster:o,namespace:s,type:a},{metadata:{labels:{"alerting.kubesphere.io/enable":JSON.stringify(!h)}}}).then((function(){p.default.success({content:t("ENABLE_SUCCESSFUL")}),l&&l()})):r.patch({cluster:o,namespace:s,name:n.name,type:a},{metadata:{labels:{"alerting.kubesphere.io/enable":JSON.stringify(!h)}}}).then((function(){p.default.success({content:t("ENABLE_SUCCESSFUL")}),l&&l()}))}},"alerting.rule.update":{on:function(e){var a=e.type,r=e.store,n=e.detail,l=e.success,u=e.cluster,o=void 0===u?"":u,s=e.namespace,f=void 0===s?"":s,m=(e.title,e.batchMode),E=e.resourceName,y=e.enabled,g=void 0!==y&&y,b=(0,c.default)(e,["type","store","detail","success","cluster","namespace","title","batchMode","resourceName","enabled"]),S=(0,i.default)((0,d.toJS)(r.list),"selectedRowKeys",[]),_=m?S.join(", "):n.name,O=h.default.open(k({onOk:function(){m?r.batchPatch(S,{cluster:o,namespace:f,type:a},{metadata:{labels:{"alerting.kubesphere.io/enable":JSON.stringify(!g)}}}).then((function(){h.default.close(O),p.default.success({content:t("DISABLE_SUCCESSFUL")}),l&&l()})):r.patch({cluster:o,namespace:f,name:n.name,type:a},{metadata:{labels:{"alerting.kubesphere.io/enable":JSON.stringify(!g)}}}).then((function(){h.default.close(O),p.default.success({content:t("UPDATE_SUCCESSFUL")}),l&&l()}))},store:r,icon:"information",modal:v.default,tip:g?t("DISABLE_ALARM_TIP"):"",type:E,title:1===_.split(", ").length?t("DISABLE_ALERTING_POLICY"):t("DISABLE_MULTIPLE_ALERTING_POLICIES"),resource:_},b))}},"alerting.rule.delete":{on:function(e){var a=e.type,r=e.store,n=e.detail,l=e.success,u=e.name,o=(0,c.default)(e,["type","store","detail","success","name"]),s=h.default.open(k({onOk:function(){r.delete(k(k({},n),{},{type:a})).then((function(){h.default.close(s),p.default.success({content:t("DELETED_SUCCESSFULLY")}),l&&l()}))},store:r,type:u,modal:v.default,resource:n.name},o))}},"alerting.rule.monitor":{on:function(e){var t=e.store,a=e.expr,r=e.rule,n=(0,c.default)(e,["store","expr","rule"]),l=h.default.open(k({onOk:function(){h.default.close(l)},rule:r,expr:a,store:t,modal:b.default},n))}},"alerting.rule.reset":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,c=e.type,s=(0,i.default)((0,d.toJS)(r.list),"data",[]),m=(0,i.default)((0,d.toJS)(r.list),"selectedRowKeys",[]),v=s.filter((function(e){return-1!==m.indexOf(e.name)})),E=h.default.open({onOk:(a=(0,u.default)(l.default.mark((function e(){var a,u,s,d;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(m.length>0)){e.next=7;break}return a=[],v.forEach((function(e){var t=(0,i.default)(e._originData,"metadata.annotations",""),n=(0,i.default)(e._originData,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',"");if(""!==n){var l=JSON.parse(n),u=(0,f.default)(l,"metadata.annotations",t);a.push(r.update(k(k({},e),{},{type:c}),u))}})),e.next=5,Promise.all(a);case 5:e.next=14;break;case 7:if(""!==(u=(0,i.default)(n._originData,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',""))){e.next=10;break}return e.abrupt("return");case 10:return s=JSON.parse(u),d=(0,f.default)(s,'metadata.annotations["alerting.kubesphere.io/initial-configuration"]',u),e.next=14,r.update(k(k({},n),{},{type:c}),d);case 14:p.default.success({content:t("RESET_SUCCESSFUL")}),h.default.close(E),o&&o();case 17:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),title:m.length>0?t("RESET_MULTIPLE_ALERTING_POLICIES"):t("RESET_ALERTING_POLICY"),desc:m.length>0?t.html("RESET_MULTIPLE_ALERTING_POLICIES_DESC",{name:m.join(",")}):t("RESET_ALERTING_POLICY_DESC"),modal:S.default})}}};a.default=I},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20);var u=l(r(97)),o=n(r(0)),c=r(61),s=l(r(26)),i=l(r(1911)),f=l(r(1912)),d=function(e){var a=e.AddRuleClick,r=e.formTemplate,n=e.handleEdit,l=e.handleDisable,d=e.handleDelete,p=e.onEdit,m=(0,o.useState)((0,s.default)(r,"spec.rules",[])),h=(0,u.default)(m,1)[0],v=function(e,t){n(e,t),p&&p()};return o.default.createElement("div",{className:i.default.ruleContainer},h.map((function(t,a){return o.default.createElement(f.default,{rule:t,key:a,handleEdit:function(){return v(a,t)},handleDisable:function(e){return l(a,e)},handleDelete:function(){return d(a)},builtInRule:e.builtInRule})})),!e.builtInRule&&h.length<c.ALERT_GROUP_MAX_LIMIT&&o.default.createElement("div",{className:i.default.addRuleContainer,onClick:function(){a()}},o.default.createElement("span",null,t("ADD_ALERTING_RULE")),o.default.createElement("span",null,t("ADD_ALERTING_RULE_DESC"))))};a.default=d},function(e,t,a){e.exports={ruleContainer:"tNWaj6nnUr8V2gxRTMdBe",addRuleContainer:"_2JdpGFOLxOJlmRICU9K51_"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(10),r(66),r(51),r(14),r(24),r(9),r(190),r(30),r(71),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(31)),o=l(r(97));r(3),r(10),r(66),r(51),r(14),r(24),r(9),r(4),r(190),r(30),r(71);var c=n(r(0)),s=r(189),i=l(r(26)),f=l(r(67)),d=l(r(119)),p=l(r(5)),m=r(944),h=l(r(979)),v=l(r(1913)),E={cpu:"cpu",pod:"pod",memory:"memory",disk:"storage",network:"network"},y=function(e){var a,r,n,l,y,g,b,S,_,O,C,T,R,D,k,N=e.rule,I=e.handleEdit,P=(0,f.default)((0,i.default)(N,"exprBuilder",""))?"custom":"template",A=!(0,f.default)((0,i.default)(N,"exprBuilder",""))&&Object.keys(N.exprBuilder)[0],w=(0,c.useState)((0,i.default)(N,"disable",!1)),L=(0,o.default)(w,2),M=L[0],x=L[1],j=(0,d.default)(m.RESOURCE_METRICS_CONFIG[A||"node"])||{};return c.default.createElement("div",{className:v.default.container},c.default.createElement("div",{className:v.default.head},c.default.createElement("div",{className:v.default.title},(k=Object.keys((0,i.default)(N.exprBuilder,"".concat(A,".metricThreshold."),{}))[0]||"pod",c.default.createElement("div",{className:(0,p.default)(v.default.icon,(D={},(0,u.default)(D,v.default.iconDisabled,M),(0,u.default)(D,v.default.iconOn,!M),D))},"custom"===P?c.default.createElement(s.Icon,{name:"computing-setting",size:40}):c.default.createElement(s.Icon,{size:40,name:E[k]}))),c.default.createElement("div",{className:v.default.text},c.default.createElement("p",null,c.default.createElement("span",{className:v.default.ruleName},N.alert),c.default.createElement(h.default,{data:(0,i.default)(N,"severity")})),c.default.createElement("p",null,M?t("DISABLED"):t("ENABLED")))),c.default.createElement("div",{className:v.default.opt},!e.builtInRule&&c.default.createElement("div",{className:v.default.iconBg},c.default.createElement(s.Icon,{name:"trash",size:16,onClick:function(){e.handleDelete()}})),c.default.createElement("div",{className:v.default.iconBg},c.default.createElement(s.Icon,{name:"pen",size:16,onClick:function(){return I()}})),c.default.createElement("div",{className:v.default.sToggle},c.default.createElement("div",{className:v.default.tooltip},c.default.createElement("span",null,M?t("ENABLE_RULE"):t("DISABLE_RULE"))),c.default.createElement("div",{className:v.default.triangle}),c.default.createElement(s.Toggle,{checked:!M,onChange:function(){x(!M),e.handleDisable(!M)}})))),c.default.createElement("div",{className:v.default.desc},"template"===P?(a=(0,i.default)(N,"exprBuilder.".concat(A,".names"),[]),r=(0,i.default)(N,"exprBuilder.".concat(A,".metricThreshold")),n=Object.keys(r)[0],l=Object.keys(r[n])[0],y="".concat(n,":").concat(l),g=j[y],b=t("".concat(g.label)).replace(/[(（]%[)）]/g,"").replace(/\s$/,""),S=g.ruleConfig.filter((function(e){return"thresholds"===e.name}))[0].reverser,_=(0,i.default)(N,"exprBuilder.".concat(A,".comparator")),O=S(Number(Object.values(r[n])[0])),C="core"===g.ruleConfig[1].unit?1===O?t("CORE"):t("CORE_PL"):g.ruleConfig[1].unit,T=N.for.slice(0,-1),R=N.for.slice(-1),c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:v.default.rule_inline},c.default.createElement("span",{className:v.default.title},t("MONITORING_TARGETS"),":"),c.default.createElement("span",{className:v.default.descText},a.join(", "))),c.default.createElement("div",{className:v.default.last_inline},c.default.createElement("span",{className:v.default.title},t("TRIGGER_CONDITION"),":"),c.default.createElement("span",{className:v.default.descText},"%"===C?t({s:"ALERT_RULE_TEXT_PERCENT_SECOND",m:"ALERT_RULE_TEXT_PERCENT_MINUTE",h:"ALERT_RULE_TEXT_PERCENT_HOUR"}[R],{alterTypeText:b,comparator:_,thresholds:O,durationValue:T}):t({s:"ALERT_RULE_TEXT_SECOND",m:"ALERT_RULE_TEXT_MINUTE",h:"ALERT_RULE_TEXT_HOUR"}[R],{alterTypeText:b,comparator:_,thresholds:O,unit:C,durationValue:T}))))):c.default.createElement("div",{className:v.default.customLine},c.default.createElement("span",{className:v.default.title},t("RULE_EXPRESSION"),":"),c.default.createElement("span",{className:v.default.exprText},N.expr))))};a.default=y},function(e,t,a){e.exports={container:"_2GzfKX80Eke0zPeLXxPfM2",head:"_2-pYgB5f9M6c_dxEp3V-OA",title:"R12JDPJT80No5oZ4FiztO",icon:"_3j4f6EuAn61hWKaSfklSE9",iconDisabled:"_1i1vhIIoULv2lNF3VDZoDF",iconOn:"_3QxA9rxWLkeRRxUH232AYp",text:"GV4iNVpiZNi5y1eYC-T14",ruleName:"_131xteJjdwC-YER3D9sImU",opt:"_2JQS0c3hgKIpWOK_ZBNqhl",sToggle:"_1aLV7CjsMuz2qfIYoR0vcH",tooltip:"_3LrHPXIR_8Kl77N3lioHBg",triangle:"_12XVt_fPIF8OcnHxmeqdTd",icon_margin:"_1A7yLbbzn3pUU69BIERrDK",iconBg:"_33fXsJOVt-jfqMbyD6aM_m",desc:"SwG1GXUV75i58LL77WMxT",descText:"_1Xua_Y5-zLL20dIy5AC2OM",customLine:"_3H0BkBDaPA0ijgEG-3WRcu",rule_inline:"_2WB2cLO-VflGOmsOCEihps",last_inline:"_2LpyqiHLn7uxoUZyOaGmi_"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20),r(9);var u=l(r(317)),o=l(r(58)),c=l(r(97)),s=n(r(0)),i=l(r(1)),f=r(189),d=l(r(67)),p=l(r(26)),m=l(r(68)),h=l(r(196)),v=r(56),E=l(r(1915)),y=l(r(1916)),g=l(r(1923)),b=[{label:t("RULE_TEMPLATE"),value:"ruleTemplate"},{label:t("CUSTOM_RULE"),value:"customRule"}],S=function(e,a){var r=e.editRule,n=e.namespace,l=(0,d.default)(r)?b[0].value:(0,d.default)((0,p.default)(r,"exprBuilder",{}))?b[1].value:b[0].value,i=(0,s.useState)(l),S=(0,c.default)(i,2),_=S[0],O=S[1],C=(0,s.useRef)(),T=function(t){var a=e.onSave,r=C.current.target;r&&r.validate((function(){var e=r.getData();if("ruleTemplate"===_){var l=Object.keys((0,p.default)(e,"exprBuilder"))[0],u=(0,p.default)(e,"exprBuilder.".concat(l,".for")),c=(0,p.default)(e,"exprBuilder.".concat(l,".severity"));(0,m.default)(e,"for",u),(0,m.default)(e,"severity",c),(0,m.default)(e,"expr",""),(0,h.default)(e,"exprBuilder.".concat(l,".for")),(0,h.default)(e,"exprBuilder.".concat(l,".severity")),n&&((0,m.default)(e,"exprBuilder.workload.kind",(0,v.capitalize)((0,p.default)(e,"exprBuilder.workloadKind.kind"))),(0,m.default)(e,"exprBuilder.workload.names",(0,o.default)((0,p.default)(e,"exprBuilder.workloadKind.names"))),(0,h.default)(e,"exprBuilder.workloadKind"))}a(e),t&&t()}))};return(0,s.useEffect)((function(){var t=a.registerSubRoute,r=e.onCancel;t&&t(T,r)}),[_]),s.default.createElement("div",{className:E.default.AddRuleContainer},s.default.createElement("div",{className:"h6",style:{display:"flex",alignItems:"center"}},s.default.createElement(f.Icon,{name:"return",size:20,onClick:function(){var t=a.resetSubRoute;t&&t(),e.onCancel()}}),s.default.createElement("span",null,t("ADD_ALERTING_RULE"))),s.default.createElement("div",{className:E.default.AddForm},s.default.createElement(f.RadioGroup,{buttonWidth:132,value:_,wrapClassName:"radio",onChange:function(e){return O(e)}},b.map((function(e){return s.default.createElement(f.RadioButton,{key:e.value,value:e.value},e.label)}))),"ruleTemplate"===_?s.default.createElement(y.default,(0,u.default)({ref:C},e)):s.default.createElement(g.default,(0,u.default)({ref:C},e))))};S.contextTypes={registerSubRoute:i.default.func,resetSubRoute:i.default.func};var _=S;a.default=_},function(e,t,a){e.exports={AddRuleContainer:"_2mxIeOmShBUCQjQDhW8eZr",AddForm:"_2h7QSnC2ng2eLW5rvXhNqm"}},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(317)),u=r(a(0)),o=n(a(1917)),c=n(a(1922)),s=function(e,t){var a=e.namespace,r=(0,u.useRef)(),n=(0,u.useRef)();return(0,u.useImperativeHandle)(t,(function(){return{target:a?n.current.target:r.current.target}})),a?u.default.createElement(c.default,(0,l.default)({ref:n},e)):u.default.createElement(o.default,(0,l.default)({ref:r},e))},i=(0,u.forwardRef)(s);t.default=i},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(9);var u=l(r(97)),o=n(r(0)),c=l(r(444)),s=l(r(26)),i=l(r(67)),f=l(r(163)),d=r(189),p=l(r(1315)),m=l(r(1919)),h=l(r(923)),v=l(r(1317)),E=function(e,a){var r=e.editRule,n=(0,o.useState)((function(){return{alert:(0,s.default)(r,"alert",""),annotations:{summary:(0,s.default)(r,"annotations.summary",""),message:(0,s.default)(r,"annotations.message","")},exprBuilder:{node:{names:(0,s.default)(r,"exprBuilder.node.names",[]),comparator:(0,s.default)(r,"exprBuilder.node.comparator",">"),metricThreshold:(0,s.default)(r,"exprBuilder.node.metricThreshold",{}),for:(0,s.default)(r,"for","1m"),severity:(0,s.default)(r,"severity","critical")}},disable:(0,s.default)(r,"disable",!1),labels:(0,s.default)(r,"labels")}})),l=(0,u.default)(n,1)[0],E=(0,o.useRef)();(0,o.useImperativeHandle)(a,(function(){return{target:E.current}}));return o.default.createElement(d.Form,{data:l,ref:E},o.default.createElement("div",{className:v.default.label},t("RULE_SETTINGS")),o.default.createElement("div",{className:v.default.contentGroup},o.default.createElement(d.Form.Item,{label:t("RULE_NAME"),desc:t("CUSTOM_RULE_NAME_DESC"),rules:[{required:!0,message:t("RULE_NAME_REQUIRED")}]},o.default.createElement(d.Input,{name:"alert",maxLength:63})),o.default.createElement(m.default,{resourceType:"node",targetName:"exprBuilder.node.names",namespace:e.namespace,cluster:e.cluster,formTemplate:l}),o.default.createElement(d.Form.Item,{label:t("TRIGGER_CONDITION"),rules:[{required:!0,message:t("SET_ACTIVATION_CONDITION_DESC")},{validator:function(e,a,r){if(!a)return r();if((0,i.default)(a.comparator))return r({message:t("OPERATOR_REQUIRED"),field:e.field});if((0,i.default)(a.metricThreshold))return r({message:t("THRESHOLD_REQUIRED"),field:e.field});var n=Object.keys(a.metricThreshold)[0],l=Object.keys(a.metricThreshold[n])[0],u=a.metricThreshold[n][l];return""===u||!u||(0,f.default)(u)?r({message:t("THRESHOLD_REQUIRED"),field:e.field}):(0,c.default)(u,".")?r({message:t("THRESHOLD_INVALID"),field:e.field}):void r()}}]},o.default.createElement(p.default,{resourceType:"node",name:"exprBuilder.node"}))),o.default.createElement(h.default,null),o.default.createElement("div",{className:v.default.label},t("MESSAGE_SETTINGS")),o.default.createElement("div",{className:v.default.contentGroup},o.default.createElement(d.Form.Item,{className:v.default.message,label:t("MESSAGE_SUMMARY"),desc:t("MESSAGE_SUMMARY_DESC"),rules:[{required:!0,message:t("MESSAGE_REQUIRED")}]},o.default.createElement(d.Input,{name:"annotations.summary",maxLength:63})),o.default.createElement(d.Form.Item,{className:v.default.message,label:t("MESSAGE_DETAILS"),desc:t("MESSAGE_DETAILS_DESC")},o.default.createElement(d.TextArea,{name:"annotations.message",maxLength:256}))))},y=(0,o.forwardRef)(E);a.default=y},function(e,t,a){e.exports={inputs:"_N1QK3FSwZyUhmC5jvOfQ",type:"_3O6Tj_XW8-2d_0gkNgidLZ",comparator:"_3BQEWdpKyP0mgOK1FmNQ8l",thresholds:"WhWgUkL7AhyqWObEY28sj",normalSelect:"_2H5F4jdmw4f72x69vMsbXf",optionLabel:"_1KeB3k29XzD3WLjiYFmIQS",slider:"_17HczGprJRLyJeH8J4rvWL",condition_type:"_2zLx0kVpfomH5fkfT6F4Io"}},function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(28)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(0)),i=r(a(1316)),f=r(a(1921));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var p=function(e){(0,u.default)(a,e);var t=d(a);function a(){return(0,n.default)(this,a),t.apply(this,arguments)}return(0,l.default)(a,[{key:"render",value:function(){return this.props.namespace?s.default.createElement(i.default,this.props):s.default.createElement(f.default,this.props)}}]),a}(s.default.Component);t.default=p},function(e,t,a){e.exports={alertRule:"_316Veyextczp08TAHWy-rA"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u=l(r(31)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(244)),m=r(189),h=l(r(454));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=function(e){(0,s.default)(r,e);var a=y(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).store=new h.default,e.state={node:[],isLoading:!1},e.fetchData=function(t){var a=e.props.cluster;e.setState({isLoading:!1}),e.store.fetchList(E({cluster:a},t)).then((function(){e.setState({nodes:e.store.list.data.map((function(e){return{label:e.name,value:e.name}})),isLoading:!1})}))},e}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props.targetName,a=(0,p.default)(this.store.list,["page","limit","total"]);return d.default.createElement(m.Form.Item,{label:t("MONITORING_TARGETS"),rules:[{required:!0,message:t("SELECT_NODE_TIP")}]},d.default.createElement(m.Select,{name:e,options:this.state.nodes,pagination:a,isLoading:this.state.isLoading,onFetch:this.fetchData,searchable:!0,multi:!0,placeholder:t("NODE")}))}}]),r}(d.Component);a.default=g},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var u=l(r(31)),o=l(r(97)),c=n(r(0)),s=r(189),i=l(r(444)),f=l(r(26)),d=l(r(67)),p=l(r(163)),m=l(r(319)),h=l(r(1315)),v=l(r(1316)),E=l(r(923)),y=l(r(1317));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var b={Deployment:"Deployment",Statefulset:"StatefulSet",Daemonset:"DaemonSet"},S=function(e,a){var r=e.editRule,n=(0,c.useState)((function(){return{alert:(0,f.default)(r,"alert",""),annotations:{summary:(0,f.default)(r,"annotations.summary",""),message:(0,f.default)(r,"annotations.message","")},exprBuilder:{workload:{comparator:(0,f.default)(r,"exprBuilder.workload.comparator",">"),metricThreshold:(0,f.default)(r,"exprBuilder.workload.metricThreshold",{}),for:(0,f.default)(r,"for","1m"),severity:(0,f.default)(r,"severity","critical")},workloadKind:{kind:b[(0,f.default)(r,"exprBuilder.workload.kind","Deployment")],names:(0,f.default)(r,"exprBuilder.workload.names",[])}},disable:(0,f.default)(r,"disable",!1),labels:(0,f.default)(r,"labels")}})),l=(0,o.default)(n,1)[0],S=(0,c.useState)(!1),_=(0,o.default)(S,2),O=_[0],C=_[1],T=(0,c.useState)([]),R=(0,o.default)(T,2),D=R[0],k=R[1],N=(0,c.useRef)({Deployment:new m.default("deployments"),StatefulSet:new m.default("statefulsets"),DaemonSet:new m.default("daemonsets")}),I=(0,c.useRef)();(0,c.useImperativeHandle)(a,(function(){return{target:I.current}}));var P=(0,c.useCallback)((function(t,a){var r=e.cluster,n=e.namespace,l=N.current[t];C(!0),l.fetchList(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({cluster:r,namespace:n},a)).then((function(){k(l.list.data.map((function(e){return{label:e.name,value:e.name}}))),C(!1)}))}),[]);(0,c.useEffect)((function(){P("Deployment",{})}),[]);return c.default.createElement(s.Form,{data:l,ref:I},c.default.createElement("div",{className:y.default.label},t("RULE_SETTINGS")),c.default.createElement("div",{className:y.default.contentGroup},c.default.createElement(s.Form.Item,{label:t("RULE_NAME"),desc:t("CUSTOM_RULE_NAME_DESC"),rules:[{required:!0,message:t("RULE_NAME_REQUIRED")}]},c.default.createElement(s.Input,{name:"alert",maxLength:63})),c.default.createElement(s.Form.Item,{label:t("RESOURCE_TYPE"),rules:[{validator:function(e,a,r){return(0,d.default)(a.names)?r({message:t("MONITOR_TARGET_EMPTY")}):r()}}]},c.default.createElement(v.default,{name:"exprBuilder.workloadKind",namespace:e.namespace,cluster:e.cluster,workloads:D,fetchWorkloads:P,stores:N.current,isLoading:O})),c.default.createElement(s.Form.Item,{label:t("TRIGGER_CONDITION"),rules:[{required:!0,message:t("SET_ACTIVATION_CONDITION_DESC")},{validator:function(e,a,r){if(!a)return r();if((0,d.default)(a.comparator))return r({message:t("OPERATOR_REQUIRED"),field:e.field});if((0,d.default)(a.metricThreshold))return r({message:t("THRESHOLD_REQUIRED"),field:e.field});var n=Object.keys(a.metricThreshold)[0],l=Object.keys(a.metricThreshold[n])[0],u=a.metricThreshold[n][l];return""===u||!u||(0,p.default)(u)?r({message:t("THRESHOLD_REQUIRED"),field:e.field}):(0,i.default)(u,".")?r({message:t("THRESHOLD_INVALID"),field:e.field}):void r()}}]},c.default.createElement(h.default,{name:"exprBuilder.workload",resourceType:"workload"}))),c.default.createElement(E.default,null),c.default.createElement("div",{className:y.default.label},t("MESSAGE_SETTINGS")),c.default.createElement("div",{className:y.default.contentGroup},c.default.createElement(s.Form.Item,{className:y.default.message,label:t("MESSAGE_SUMMARY"),desc:t("MESSAGE_SUMMARY_DESC"),rules:[{required:!0,message:t("MESSAGE_REQUIRED")}]},c.default.createElement(s.Input,{name:"annotations.summary",maxLength:63})),c.default.createElement(s.Form.Item,{className:y.default.message,label:t("MESSAGE_DETAILS"),desc:t("MESSAGE_DETAILS_DESC")},c.default.createElement(s.TextArea,{name:"annotations.message",maxLength:256}))))},_=(0,c.forwardRef)(S);a.default=_},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(51),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(51),r(30),r(195);var u=l(r(97)),o=n(r(0)),c=r(189),s=l(r(26)),i=r(56),f=r(922),d=l(r(980)),p=l(r(1924)),m=l(r(923)),h=l(r(945)),v=l(r(1927)),E=function(e,a){var r=e.editRule,n=(0,o.useRef)();(0,o.useImperativeHandle)(a,(function(){return{target:n.current}}));var l=(0,o.useState)({alert:(0,s.default)(r,"alert",""),annotations:{summary:(0,s.default)(r,"annotations.summary",""),message:(0,s.default)(r,"annotations.message","")},for:(0,s.default)(r,"for",""),expr:(0,s.default)(r,"expr",""),severity:(0,s.default)(r,"severity","critical"),disable:(0,s.default)(r,"disable",!1),labels:(0,s.default)(r,"labels")}),E=(0,u.default)(l,1)[0];return o.default.createElement(c.Form,{data:E,ref:n},o.default.createElement("div",{className:v.default.label},t("RULE_SETTINGS")),o.default.createElement("div",{className:v.default.contentGroup},o.default.createElement(c.Columns,null,o.default.createElement(c.Column,null,o.default.createElement(c.Form.Item,{label:t("RULE_NAME"),desc:t("CUSTOM_RULE_NAME_DESC"),rules:[{required:!0,message:t("RULE_NAME_REQUIRED")}]},o.default.createElement(c.Input,{name:"alert",maxLength:63}))),o.default.createElement(c.Column,null)),o.default.createElement(c.Columns,null,o.default.createElement(c.Column,null,o.default.createElement(c.Form.Item,{label:t("DURATION"),desc:t("ALERT_DURATION"),rules:[{validator:function(e,a,r){var n=a.slice(0,-1);if(!/^[0-9]*$/.test(n))return r({message:t("INVALID_TIME_DESC")});r()}}]},o.default.createElement(d.default,{name:"for",inputClassName:v.default.duration,unitOptions:f.durationUnitOptions,defaultValue:f.durationUnitOptions[1].value}))),o.default.createElement(c.Column,null,o.default.createElement(c.Form.Item,{label:t("SEVERITY"),rules:[{required:!0,message:t("SEVERITY_REQUIRED")}]},o.default.createElement(h.default,{name:"severity",defaultValue:"critical"})))),o.default.createElement(c.Form.Item,{label:t("RULE_EXPRESSION"),desc:(0,i.learnMoreTip)(t.html("ALERT_RULE_EXPRESSION_DESC")),rules:[{required:!0,message:t("ALERT_RULE_REQUIRED")}]},o.default.createElement(p.default,{name:"expr",store:e.store,cluster:e.cluster,namespace:e.namespace}))),o.default.createElement(m.default,null),o.default.createElement("div",{className:v.default.label},t("MESSAGE_SETTINGS")),o.default.createElement("div",{className:v.default.contentGroup},o.default.createElement(c.Form.Item,{className:v.default.message,label:t("MESSAGE_SUMMARY"),desc:t("MESSAGE_SUMMARY_DESC"),rules:[{required:!0,message:t("MESSAGE_REQUIRED")}]},o.default.createElement(c.Input,{name:"annotations.summary",maxLength:63})),o.default.createElement(c.Form.Item,{className:v.default.message,label:t("MESSAGE_DETAILS"),desc:t("MESSAGE_DETAILS_DESC")},o.default.createElement(c.TextArea,{name:"annotations.message",maxLength:256}))))},y=(0,o.forwardRef)(E);a.default=y},function(e,t,a){"use strict";a(16);var r=a(19),n=a(162);a(20),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(20),a(29),a(8),a(4),a(18),a(43),a(11);var l,u,o=r(a(317)),c=r(a(25)),s=r(a(28)),i=r(a(41)),f=r(a(42)),d=r(a(37)),p=r(a(45)),m=n(a(0)),h=a(243),v=a(17),E=r(a(1925));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var g=(0,h.observer)((u=function(e){(0,i.default)(a,e);var t=y(a);function a(){return(0,c.default)(this,a),t.apply(this,arguments)}return(0,s.default)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.cluster,a=e.namespace;this.hasMonitoring&&this.props.store.fetchMetadata({cluster:t,namespace:a})}},{key:"render",value:function(){return m.default.createElement(E.default,(0,o.default)({},this.props,{supportMetrics:this.supportMetrics}))}},{key:"hasMonitoring",get:function(){var e=this.props.cluster;return globals.app.hasClusterModule(e,"whizard-monitoring")}},{key:"supportMetrics",get:function(){return this.hasMonitoring?this.props.store.targetsMetadata.map((function(e){return{value:e.metric,desc:e.help,type:e.type}})):[]}}]),a}(m.Component),(0,p.default)(u.prototype,"supportMetrics",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"supportMetrics"),u.prototype),l=u))||l;t.default=g},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(10),r(20),r(14),r(8),r(4),r(18),r(30),r(11),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(29),r(14),r(8),r(4),r(18),r(43),r(30),r(195),r(11);var u,o,c=n(r(58)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(45)),h=l(r(0)),v=n(r(862)),E=n(r(845)),y=n(r(445)),g=r(17),b=r(243),S=n(r(5)),_=r(189),O=n(r(1265)),C=n(r(1267)),T=n(r(1926));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var D=(0,b.observer)((o=function(e){(0,f.default)(r,e);var a=R(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleMetricSelect=function(t){e.props.onChange(t)},e}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props,a=e.name,r=e.value,n=e.onChange,l=e.labelsets,u=e.onLabelSearch,o=e.supportMetrics,c=e.supportDebugButton,s=void 0!==c&&c,i=e.className;return h.default.createElement("div",{className:(0,S.default)(T.default.wrapper,i)},h.default.createElement(O.default,{options:this.groupedMetrics,onSelect:this.handleMetricSelect},h.default.createElement("span",{className:T.default.trigger},t("MONITOR_METRIC"),h.default.createElement(_.Icon,{type:"light",name:"caret-down"}))),h.default.createElement("div",{className:T.default.input},h.default.createElement(C.default,{name:a,value:r,onChange:n,metrics:o,labelsets:l,onLabelSearch:u})),s&&h.default.createElement("div",{onClick:this.props.onDebugClick,className:(0,S.default)(T.default.debug,T.default.btn)},h.default.createElement(_.Icon,{name:"terminal",type:"light"})," ",h.default.createElement("span",null,t("DEBUGB_DATA"))))}},{key:"groupedMetrics",get:function(){var e=/:\w+:/,t=(0,c.default)(this.props.supportMetrics);return t=t.filter((function(t){return!e.test(t.value)})),t=(0,E.default)(t,(function(e){return e.value.split("_")[0]})),t=(0,v.default)(t,(function(e,t){var a=1===e.length&&e[0]===t?[]:e.map((function(e){return{label:e.value,value:e.value,desc:e.desc}}));return{children:(0,y.default)(a,"label"),label:t,value:t}})),(0,y.default)(t,"label")}}]),r}(h.Component),(0,m.default)(o.prototype,"groupedMetrics",[g.computed],Object.getOwnPropertyDescriptor(o.prototype,"groupedMetrics"),o.prototype),u=o))||u;a.default=D},function(e,t,a){e.exports={wrapper:"_16Pt4wQ6HRvTCyF6zExdXE",trigger:"_19O6Dob9Y5t0xlUg0Cfy1D",input:"_15nLj_uwsZw-azdXehcyDi",debug:"_3rxaO3HkvVvkYP-Y4tRSGS"}},function(e,t,a){e.exports={label:"_2g32MT4YhUAiyoPaC_JbEj",contentGroup:"_2mbv2p5P2vAqJxbzEUvb94",message:"_1FdjkvGFoIHEmOzv2WLH__",duration:"_3R3dvfKDRUF1BTUUZHupBM",CustomExpr:"gpoBCKKdLW0lKPy2tOU4O"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1313)),l=r(a(1314)),u=[{title:"BASIC_INFORMATION",component:n.default,required:!0,icon:"cdn"},{title:"ALERTING_RULE",component:l.default,required:!0,icon:"bell"}];t.default=u},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1930)),l=r(a(1931)),u=[{title:"BASIC_INFORMATION",component:n.default,required:!0,icon:"cdn"},{title:"ALERTING_RULE",component:l.default,required:!0}];t.default=u},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(51),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(51),r(29),r(4),r(18),r(43),r(30),r(195),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=r(189),d=n(r(980)),p=r(878),m=r(243),h=n(r(0)),v=r(61);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=(0,m.observer)(l=function(e){(0,c.default)(r,e);var a=E(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).nameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:"".concat(e.props.cluster_id,"-").concat(r),namespace:e.namespace,cluster:e.props.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e.timeValidator=function(e,a,r){var n=a.slice(0,-1);if(!/^[0-9]*$/.test(n))return r({message:t("INVALID_TIME_DESC")});r()},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.isEdit,r=e.formRef,n=e.formTemplate,l=a?[]:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:v.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("NAME_DESC")})},{validator:this.nameValidator}];return h.default.createElement(f.Form,{data:n,ref:r},h.default.createElement(f.Columns,null,h.default.createElement(f.Column,null,h.default.createElement(f.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:l},h.default.createElement(f.Input,{name:"metadata.name",onChange:this.handleNameChange,maxLength:63,readOnly:a}))),h.default.createElement(f.Column,null,h.default.createElement(f.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:v.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},h.default.createElement(f.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),h.default.createElement(f.Columns,null,h.default.createElement(f.Column,null,h.default.createElement(f.Form.Item,{label:t("CHECK_INTERVAL"),desc:t("ALERTING_POLICY_CHECK_INTERVAL_DESC"),rules:[{validator:this.timeValidator}]},h.default.createElement(d.default,{name:"spec.interval",unitOptions:this.durationUnitOptions,defaultValue:this.durationUnitOptions[1].value}))),h.default.createElement(f.Column,null,h.default.createElement(f.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},h.default.createElement(f.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))))}},{key:"namespace",get:function(){return this.props.namespace}},{key:"durationUnitOptions",get:function(){return[{label:t("SECONDS"),value:"s"},{label:t("MINUTES"),value:"m"},{label:t("HOURS"),value:"h"}]}},{key:"severities",get:function(){return p.SEVERITY_LEVEL.map((function(e){return{label:t(e.label),value:e.value,level:e}}))}}]),r}(h.default.Component))||l;a.default=y},function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(10),a(6),a(194),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(10),a(6),a(27),a(194),a(141),a(120),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var l=n(a(317)),u=n(a(31)),o=n(a(50)),c=n(a(97)),s=r(a(0)),i=n(a(26)),f=n(a(119)),d=n(a(67)),p=n(a(68)),m=a(189),h=n(a(1932)),v=n(a(1936));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g=function(e){var t=(0,s.useState)(!1),a=(0,c.default)(t,2),r=a[0],n=a[1],u=(0,s.useState)((0,i.default)(e,"formTemplate")),E=(0,c.default)(u,2),g=E[0],b=E[1],S=(0,s.useState)(null),_=(0,c.default)(S,2),O=_[0],C=_[1],T=(0,s.useState)({}),R=(0,c.default)(T,2),D=R[0],k=R[1],N=function(){C(null),k({})};(0,s.useEffect)((function(){e.cluster_id&&(0,p.default)(g,"metadata.labels.app_instance",e.cluster_id),e.app_id&&(0,p.default)(g,"metadata.labels.openpitrix_app_id",e.app_id)}),[]);return s.default.createElement(s.default.Fragment,null,s.default.createElement(m.Form,{data:g,ref:e.formRef}),s.default.createElement("div",null,r?s.default.createElement(v.default,(0,l.default)({},e,{formTemplate:g,onCancel:function(){n(!1),N()},onSave:function(e){var t=e.rule,a=(0,o.default)(e,["rule"]),r=(0,i.default)(g,"spec.rules",[]),l=JSON.parse((0,i.default)(g,"metadata.annotations.dmp_managed_field","[]"));(0,d.default)(D)?(r.push(a),l.push(t)):(r.splice(O,1,a),l.splice(O,1,t)),(0,p.default)(g,"metadata.annotations.dmp_managed_field",JSON.stringify(l)),b(y(y({},g),{},{spec:y(y({},g.spec),{},{rules:r})})),n(!1),N()},editRule:D})):s.default.createElement(h.default,{formTemplate:g,AddRuleClick:function(){return n(!0)},handleEdit:function(e,t){n(!0);var a=(0,i.default)(JSON.parse((0,i.default)(g,"metadata.annotations.dmp_managed_field","[]")),"[".concat(e,"]"));k(y(y({},(0,f.default)(t)),{},{exprBuilder:a})),C(e)},handleDisable:function(e,t){var a=(0,i.default)(g,"spec.rules",[]);(0,p.default)(a[e],"disable",t),b(y(y({},g),{},{spec:y(y({},g.spec),{},{rules:a})}))},handleDelete:function(e){var t=(0,i.default)(g,"spec.rules",[]);t.splice(e,1),b(y(y({},g),{},{spec:y(y({},g.spec),{},{rules:t})}))},onEdit:e.onEdit,index:"ruleList"})))};t.default=g},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20);var u=l(r(97)),o=n(r(0)),c=l(r(26)),s=l(r(1933)),i=l(r(1934)),f=function(e){var a=e.AddRuleClick,r=e.formTemplate,n=e.handleEdit,l=e.handleDisable,f=e.handleDelete,d=e.onEdit,p=(0,o.useState)((0,c.default)(r,"spec.rules",[])),m=(0,u.default)(p,1)[0],h=function(e,t){n(e,t),d&&d()};return o.default.createElement("div",{className:s.default.ruleContainer},m.map((function(e,t){return o.default.createElement(i.default,{rule:e,key:t,handleEdit:function(){return h(t,e)},handleDisable:function(e){return l(t,e)},handleDelete:function(){return f(t)}})})),o.default.createElement("div",{className:s.default.addRuleContainer,onClick:function(){a()}},o.default.createElement("span",null,t("ADD_ALERTING_RULE")),o.default.createElement("span",null,t("ADD_ALERTING_RULE_DESC"))))};a.default=f},function(e,t,a){e.exports={ruleContainer:"_2Tc8iph0naZ2K8oti1xUS5",addRuleContainer:"_3p9eZbjIvTe2c64CnnPTGI"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(31)),o=l(r(97));r(9);var c=n(r(0)),s=r(189),i=l(r(979)),f=l(r(26)),d=l(r(67)),p=l(r(5)),m=l(r(1935)),h={cpu:"cpu",pod:"pod",memory:"memory",disk:"storage",network:"network"},v=function(e){var a,r,n=e.rule,l=e.handleEdit,v=!(0,d.default)((0,f.default)(n,"exprBuilder",""))&&Object.keys(n.exprBuilder)[0],E=(0,c.useState)((0,f.default)(n,"disable",!1)),y=(0,o.default)(E,2),g=y[0],b=y[1];return c.default.createElement("div",{className:m.default.container},c.default.createElement("div",{className:m.default.head},c.default.createElement("div",{className:m.default.title},(r=Object.keys((0,f.default)(n.exprBuilder,"".concat(v,".thresholds."),{}))[0]||"pod",c.default.createElement("div",{className:(0,p.default)(m.default.icon,(a={},(0,u.default)(a,m.default.iconDisabled,g),(0,u.default)(a,m.default.iconOn,!g),a))},c.default.createElement(s.Icon,{size:40,name:h[r]}))),c.default.createElement("div",{className:m.default.text},c.default.createElement("p",null,c.default.createElement("span",null,n.alert),c.default.createElement(i.default,{data:(0,f.default)(n,"severity")})),c.default.createElement("p",null,g?t("DISABLED"):t("ENABLED")))),c.default.createElement("div",{className:m.default.opt},c.default.createElement(s.Icon,{name:"trash",size:16,onClick:function(){e.handleDelete()}}),c.default.createElement(s.Icon,{name:"pen",size:16,onClick:function(){return l()}}),c.default.createElement("div",{className:m.default.sToggle},c.default.createElement("div",{className:m.default.tooltip},g?t("DISABLED"):t("ENABLED")),c.default.createElement("div",{className:m.default.triangle}),c.default.createElement(s.Toggle,{checked:!g,onChange:function(){b(!g),e.handleDisable(!g)}})))),c.default.createElement("div",{className:m.default.desc},c.default.createElement("div",null,c.default.createElement("span",{className:m.default.title},"".concat(t("RULE_EXPRESSION"),":")),c.default.createElement("span",{className:m.default.descText},n.expr))))};a.default=v},function(e,t,a){e.exports={container:"_2ClEdhbYmUEQz1Ns3z2oBm",head:"JahgMrDpOJ7IeoQM6gjY8",title:"_2oWQ1UiDBVYOpSMoq36nDo",icon:"_8uv0_owFNgDTHY82HdguE",iconDisabled:"_7ZVf12G3z7bPwUA0kTaFe",iconOn:"_2c2QQSCxzhSwMb5qUtCMRF",text:"iJjVxOOjndl34TfCm6bKo",opt:"_2ORwrYMF6gq7YoM2vXssKg",sToggle:"_1nBYDpMnB1IS60TYL8GX4",tooltip:"_1XGDMRuyjU3okCY0sTVb90",triangle:"JYn0e1e3uiIQxqILkeBBY",desc:"_1SFrnr2CqgHgXHa0IPMAl4",descText:"_1JMIexA-OB-7psECMogEuN"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var u=l(r(317)),o=l(r(31)),c=l(r(50)),s=n(r(0)),i=l(r(26)),f=l(r(1)),d=r(848),p=l(r(1937)),m=l(r(1938)),h=r(885);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=function(e,a){var r=(0,s.useRef)(),n=(0,i.default)(e.formTemplate,"metadata.labels.app_instance",e.cluster_id),l=function(t){var a=e.onSave,l=r.current.target;l&&r.current.target.validate((function(){var r=l.getData(),u=r.exprBuilder,o=(0,c.default)(r,["exprBuilder"]),s=(0,h.getDMPQuery)({rule:u,duration:o.for,cluster_id:n,namespace:e.namespace});a(E(E({},o),{},{expr:s,rule:u})),t&&t()}))};return(0,s.useEffect)((function(){var t=a.registerSubRoute,r=e.onCancel;t&&t(l,r)}),[]),s.default.createElement("div",{className:p.default.AddRuleContainer},s.default.createElement("div",{className:"h6"},s.default.createElement("span",{style:{cursor:"pointer"},onClick:function(){var t=a.resetSubRoute;t&&t(),e.onCancel()}},s.default.createElement(d.ReactComponent,null),s.default.createElement("span",null,t("ADD_ALERTING_RULE")))),s.default.createElement("div",{className:p.default.AddForm},s.default.createElement(m.default,(0,u.default)({ref:r},e))))};y.contextTypes={registerSubRoute:f.default.func,resetSubRoute:f.default.func};var g=y;a.default=g},function(e,t,a){e.exports={AddRuleContainer:"Md_cN9Ekv_uoIpHYWwRHm",AddForm:"_1RHUtXqsCI2SkvAwklsRyp"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(9),r(30),r(71),r(991);var u=l(r(97)),o=n(r(0)),c=r(189),s=l(r(26)),i=l(r(119)),f=l(r(68)),d=l(r(67)),p=l(r(1939)),m=l(r(1940)),h=r(1125),v=l(r(923)),E=function(e,a){var r=e.editRule,n=(0,s.default)(e.formTemplate,"metadata.labels.app_instance",e.cluster_id),l=(0,s.default)(e.formTemplate,"metadata.labels.openpitrix_app_id",e.app_id),E=(0,o.useState)({alert:(0,s.default)(r,"alert",""),annotations:{summary:(0,s.default)(r,"annotations.summary",""),message:(0,s.default)(r,"annotations.message","")},exprBuilder:{metricType:(0,s.default)(r,"exprBuilder.metricType",""),comparator:(0,s.default)(r,"exprBuilder.comparator",""),thresholds:(0,s.default)(r,"exprBuilder.thresholds","")},for:(0,s.default)(r,"for","1m"),severity:(0,s.default)(r,"severity","warning"),disable:(0,s.default)(r,"disable",!1),labels:(0,s.default)(r,"labels")}),y=(0,u.default)(E,2),g=y[0],b=y[1],S=(0,o.useRef)();(0,o.useImperativeHandle)(a,(function(){return{target:S.current}}));return o.default.createElement(c.Form,{data:g,ref:S},o.default.createElement("div",{className:p.default.label},t("RULE_SETTINGS")),o.default.createElement("div",{className:p.default.contentGroup},o.default.createElement(c.Form.Item,{label:t("RULE_NAME"),desc:t("CUSTOM_RULE_NAME_DESC"),rules:[{required:!0,message:t("RULE_NAME_REQUIRED")}]},o.default.createElement(c.Input,{name:"alert",maxLength:63})),o.default.createElement(c.Form.Item,{label:t("TRIGGER_CONDITION"),rules:[{required:!0,message:t("SET_ACTIVATION_CONDITION_DESC")},{validator:function(e,a,r){if(!a)return r();if((0,d.default)(a.comparator))return r({message:t("OPERATOR_REQUIRED"),field:e.field});if(!(0,d.default)(a.thresholds)){var n=Object.keys(a.thresholds)[0],l=Object.keys(a.thresholds[n])[0];if(""===a.thresholds[n][l])return r({message:t("THRESHOLD_REQUIRED"),field:e.field})}r()}}]},o.default.createElement(m.default,{resourceType:l,name:"exprBuilder",metricType:(0,s.default)(g,"exprBuilder.metricType"),thresholds:(0,s.default)(g,"exprBuilder.thresholds"),comparator:(0,s.default)(g,"exprBuilder.comparator"),severity:(0,s.default)(g,"severity"),for:(0,s.default)(g,"for"),handleMetricChange:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{unit:""},l=a.unit,u=(0,i.default)(g);if((0,f.default)(u,"exprBuilder.thresholds",e.thresholds),(0,f.default)(u,"exprBuilder.comparator",e.comparator),t&&((0,f.default)(u,"exprBuilder.metricType",t),(0,d.default)(r))){var o=(0,s.default)(h.ALL_SUMMARY_CONFIG,t,"").replaceAll("$CLUSTERID",n).replaceAll("$THRESHOLD"," ").replaceAll("$UNIT",l),c=(0,s.default)(h.ALL_MESSAGE_CONFIG,t,"").replaceAll("$CLUSTERID",n).replaceAll("$THRESHOLD"," ").replaceAll("$UNIT",l);(0,f.default)(u,"annotations.summary",o),(0,f.default)(u,"annotations.message",c)}(0,f.default)(u,"for",e.duration),(0,f.default)(u,"severity",e.severity),b(u)}}))),o.default.createElement(v.default,null),o.default.createElement("div",{className:p.default.label},t("MESSAGE_SETTINGS")),o.default.createElement("div",{className:p.default.contentGroup},o.default.createElement(c.Form.Item,{label:t("MESSAGE_SUMMARY"),desc:t("MESSAGE_SUMMARY_DESC"),rules:[{required:!0,message:t("MESSAGE_REQUIRED")}]},o.default.createElement(c.Input,{name:"annotations.summary",maxLength:63})),o.default.createElement(c.Form.Item,{label:t("MESSAGE_DETAILS"),desc:t("MESSAGE_DETAILS_DESC")},o.default.createElement(c.TextArea,{name:"annotations.message",maxLength:256}))))},y=(0,o.forwardRef)(E);a.default=y},function(e,t,a){e.exports={label:"XS1LS4IFOQ8CNQ2AsfMJv",contentGroup:"j3tnwlodcDpj5qv8eo3k8",inputs:"_1iFffDJTXDmoJLjUhAqOwd"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(20),r(14),r(24),r(99),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(97)),u=n(r(317)),o=n(r(50)),c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(74)),d=n(r(41)),p=n(r(42)),m=n(r(37));r(12),r(32),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(24),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(71),r(7);var h=n(r(0)),v=n(r(1)),E=n(r(5)),y=n(r(76)),g=n(r(26)),b=n(r(119)),S=r(56),_=r(189),O=n(r(805)),C=n(r(945)),T=n(r(1941)),R=r(885),D=r(1125);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var P=[1,5,15,30,60].map((function(e){return{label:t.html("LASTING_MINUTES",{minutes:e}),value:"".concat(e,"m")}})),A=R.severityOptions.map((function(e){return{label:e.label,value:e.value}})),w=function(e){(0,d.default)(r,e);var a=I(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).getStateFromProps=function(e){var t=e.thresholds;return{comparator:e.comparator,thresholds:""!==t?Number(t):t,duration:(0,g.default)(e,"for",P[0].value),severity:(0,g.default)(e,"severity",A[0].value)}},n.getSelectOptions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var a=e.prefixIcon,r=e.color,n=e.type,l=e.label,u=e.value,o=e.disabled,c={label:t(l,{value:u}),value:u};return a&&(c.label=h.default.createElement("div",{className:(0,E.default)(T.default.optionLabel,T.default[n])},h.default.createElement(_.Icon,{name:a,size:20,color:r}),c.label)),o&&(c.disabled=o),c}))},n.handleMetricTypeChange=function(e){var t=n.state,a=t.severity,r=t.duration,l=n.metricConfig.find((function(t){return t.value===e})),u=(0,g.default)(l,"ruleConfig[0].value","");n.setState({metricType:e,thresholds:"",comparator:u},(function(){n.props.handleMetricChange({thresholds:"",comparator:u,severity:a,duration:r},e,{unit:(0,g.default)(l,"ruleConfig[1].unit")})}))},n.handleItemChange=function(e){return(0,S.cacheFunc)(e,(function(t,a){var r=n.props.handleMetricChange,l=(0,y.default)(a)||!a?t:a;"thresholds"===e&&(l=String(l).replace(/([a-zA-Z%/])+$/g,"")),n.setState((0,c.default)({},e,l),(function(){var t=n.state,a=t.comparator,u=t.thresholds,o=t.duration,c=t.severity;r({thresholds:"thresholds"===e?Number(l):u,comparator:"comparator"===e?l:a,duration:o,severity:c})}))}),(0,f.default)(n))},n.handleDurationChange=function(e){var t=n.state,a=t.severity,r=t.thresholds,l=t.comparator;n.setState({duration:e},(function(){n.props.handleMetricChange({thresholds:r,duration:e,severity:a,comparator:l})}))},n.handleSeverityChange=function(e){var t=n.state,a=t.duration,r=t.thresholds,l=t.comparator;n.setState({severity:e},(function(){n.props.handleMetricChange({thresholds:r,duration:a,comparator:l,severity:e})}))},n.renderConfigItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.type,r=e.name,l=e.placeholder,c=e.options,s=void 0===c?[]:c,i=(e.converter,(0,o.default)(e,["type","name","placeholder","options","converter"])),f={key:r,className:T.default[r],placeholder:t(l),value:(0,g.default)(n.state,r),onChange:n.handleItemChange(r)};switch(a){default:case"select":var d=n.getSelectOptions(s);return h.default.createElement(_.Select,(0,u.default)({options:d},f,i));case"number":return h.default.createElement(O.default,(0,u.default)({showUnit:!0},f,i))}},n.state=N({metricType:e.metricType||n.metricConfig[0].value},n.getStateFromProps(e)),n.metricOps=n.getSelectOptions(n.metricConfig),n}return(0,i.default)(r,[{key:"componentDidMount",value:function(){var e=this;if(!this.props.metricType){var t=this.state,a=t.comparator,r=t.thresholds;this.setState({comparator:a||(0,g.default)(this.ruleConfig,"[0].value",a),thresholds:""!==r?Number(r):(0,g.default)(this.ruleConfig,"[1].value",r)},(function(){e.props.handleMetricChange({thresholds:e.state.thresholds,duration:e.state.duration,severity:e.state.severity,comparator:e.state.comparator},e.state.metricType,{unit:(0,g.default)(e.ruleConfig,"[1].unit")})}))}}},{key:"render",value:function(){var e=this.state,t=e.metricType,a=e.duration,r=e.severity,n=this.ruleConfig;return h.default.createElement("div",{className:T.default.inputs},h.default.createElement(_.Select,{className:T.default.type,options:this.metricOps,value:t,onChange:this.handleMetricTypeChange}),n.map(this.renderConfigItem),h.default.createElement(_.Select,{value:a,options:P,onChange:this.handleDurationChange}),h.default.createElement(C.default,{value:r,options:A,onChange:this.handleSeverityChange}))}},{key:"resourceMetricsConfig",get:function(){var e=this.props.resourceType;return(0,b.default)(D.RESOURCE_METRICS_CONFIG[e])||{}}},{key:"metricConfig",get:function(){var e=this.resourceMetricsConfig;return Object.entries(e).map((function(e){var t=(0,l.default)(e,2);return N({value:t[0]},t[1])}))}},{key:"selectMetricConfig",get:function(){var e=this.state.metricType;return this.metricConfig.find((function(t){return t.value===e}))}},{key:"ruleConfig",get:function(){return(0,g.default)(this.selectMetricConfig,"ruleConfig")||[]}}]),r}(h.default.Component);w.propTypes={value:v.default.object,onChange:v.default.func},w.defaultProps={metricConfig:[],value:{},onChange:function(){}};var L=w;a.default=L},function(e,t,a){e.exports={inputs:"_1ElkAbsvtdzOOkcnK66XzH",type:"_3cqi7bYJMHmrQClJeRoobj",optionLabel:"_2Rm48iWjjbNabO0sdXSIeT",slider:"UOTqYNeayjqXhLKY5L4Nt",condition_type:"_21FGEK2QjdUrcDOZPnqz3c"}},,,,,,function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(20);var l=a(910),u=a(885),o=[{NameZh:"MySQL下线",NameEn:"MySQLIsDown",Expression:'mysql_up{namespace="$NAMESPACE",service="$CLUSTERID-metrics"} == 0',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"MySQL下线",Summary:"RadonDB MySQL 【$CLUSTERID】 MySQL下线",Message:"RadonDB MySQL: $CLUSTERID，MySQL下线。 当前值：{{ $value }}"},{NameZh:"主从复制延迟",NameEn:"MySQLSlaveBehindMaster",Expression:'rate(mysql_slave_status_seconds_behind_master{namespace="$NAMESPACE",service="$CLUSTERID-metrics"}[1m])',Operator:">",Unit:"s",ProposedDuration:"1m",Explain:"从库落后主库$THRESHOLD$UNIT ",Summary:"RadonDB MySQL 【$CLUSTERID】 从库落后主库$THRESHOLD$UNIT ",Message:"RadonDB MySQL: $CLUSTERID，从库落后主库$THRESHOLD$UNIT 。 当前值：{{ $value }}"},{NameZh:"CPU使用率",NameEn:"MySQLCPUUtilization",Expression:'(sum(irate(container_cpu_usage_seconds_total{namespace="$NAMESPACE",pod=~".*$CLUSTERID.*",container!="POD",container!=""}[3m])) by (pod)) / (sum(kube_pod_container_resource_limits{resource="cpu",namespace="$NAMESPACE",pod=~".*$CLUSTERID.*"}) by (pod)) * 100',Operator:">",Unit:"%",ProposedDuration:"1m",Explain:"CPU使用率超过$THRESHOLD$UNIT",Summary:"RadonDB MySQL 【$CLUSTERID】 CPU使用率超过$THRESHOLD$UNIT",Message:"RadonDB MySQL: $CLUSTERID，CPU使用率超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"内存使用率",NameEn:"MySQLMemUtilization",Expression:'(sum(container_memory_working_set_bytes{namespace="$NAMESPACE",pod=~".*$CLUSTERID.*",container!="POD",container!=""}) by (pod)) / (sum(kube_pod_container_resource_limits{resource="memory",namespace="$NAMESPACE",pod=~".*$CLUSTERID.*"}) by (pod)) * 100',Operator:">",Unit:"%",ProposedDuration:"1m",Explain:"内存使用率超过$THRESHOLD$UNIT",Summary:"RadonDB MySQL 【$CLUSTERID】 内存使用率超过$THRESHOLD$UNIT",Message:"RadonDB MySQL: $CLUSTERID，内存使用率超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"磁盘使用率",NameEn:"MySQLDisk",Expression:'(kubelet_volume_stats_used_bytes{persistentvolumeclaim=~".*$CLUSTERID.*"} / kubelet_volume_stats_capacity_bytes{persistentvolumeclaim=~".*$CLUSTERID.*"} * 100)',Operator:">",Unit:"%",ProposedDuration:"1m",Explain:"磁盘使用率超过$THRESHOLD$UNIT",Summary:"RadonDB MySQL 【$CLUSTERID】 磁盘使用率超过$THRESHOLD$UNIT",Message:"RadonDB MySQL: $CLUSTERID，磁盘使用率超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"连接数利用率",NameEn:"MySQLTooManyConnections",Expression:'mysql_global_status_max_used_connections{namespace="$NAMESPACE",service="$CLUSTERID-metrics"} / mysql_global_variables_max_connections{namespace="$NAMESPACE",service="$CLUSTERID-metrics"} * 100',Operator:">",Unit:"%",ProposedDuration:"1m",Explain:"连接数使用超过$THRESHOLD$UNIT",Summary:"RadonDB MySQL 【$CLUSTERID】 连接数使用超过$THRESHOLD$UNIT",Message:"RadonDB MySQL: $CLUSTERID，连接数使用超过$THRESHOLD$UNIT。 当前值：{{ $value }}"}],c={Metric:{MySQLIsDown:{label:"MySQLIsDown",autoComplete:!0,ruleConfig:l.disabledRuleConfig},MySQLSlaveBehindMaster:{label:"MySQLSlaveBehindMaster",ruleConfig:l.TIME_RULE_CONFIG},MySQLCPUUtilization:{label:"MySQLCPUUtilization",ruleConfig:l.PERCENT_RULE_CONFIG},MySQLMemUtilization:{label:"MySQLMemUtilization",ruleConfig:l.PERCENT_RULE_CONFIG},MySQLDisk:{label:"MySQLDisk",ruleConfig:l.PERCENT_RULE_CONFIG},MySQLTooManyConnections:{label:"MySQLTooManyConnections",ruleConfig:l.PERCENT_RULE_CONFIG}},Query:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Expression)}))),Message:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Message)}))),Summary:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Summary)})))};t.default=c},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(20);var l=a(885),u=a(910),o=[{NameEn:"PGUnhealth",Expression:'pg_auto_failover_unhealth_count{namespace="$NAMESPACE",service="$CLUSTERID-autofailover"} != 0',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Summary:"PostgreSQL 节点不健康。",Message:"PostgreSQL 节点不健康。"},{NameEn:"PGAsync",Expression:'pg_auto_failover_async_count{namespace="$NAMESPACE",service="$CLUSTERID-autofailover"} != 0',Operator:">",Unit:"s",ProposedDuration:"1m",Summary:"PostgreSQL 节点出现异步模式。",Message:"PostgreSQL 节点出现异步模式。"},{NameEn:"PGNotRunning",Expression:'pg_auto_failover_not_running_count{namespace="$NAMESPACE",service="$CLUSTERID-autofailover"} != 0',Operator:">",Unit:"s",ProposedDuration:"1m",Summary:"PostgreSQL 未运行。",Message:"PostgreSQL 未运行。"},{NameEn:"PGInvalid",Expression:'pg_auto_failover_not_running_count{namespace="$NAMESPACE",service="$CLUSTERID-autofailover"} != 0 ',Operator:">",Unit:"s",ProposedDuration:"1m",Summary:"PostgreSQL 存在无效节点。",Message:"PostgreSQL 存在无效节点。"},{NameEn:"PGCPUUtilization",Expression:'(sum(irate(container_cpu_usage_seconds_total{namespace="$NAMESPACE",pod=~".*$CLUSTERID-readwriteinstance.*|.*$CLUSTERID-readonlyinstance.*",container="postgresql"}[3m])) by (pod)) / (sum(kube_pod_container_resource_limits{resource="cpu", container="postgresql", namespace="$NAMESPACE",pod=~".*$CLUSTERID-readwriteinstance.*|.*$CLUSTERID-readonlyinstance.*"}) by (pod)) * 100',Operator:">",Unit:"%",ProposedDuration:"1m",Summary:"RadonDB PostgreSQL 【$CLUSTERID】 CPU使用率超过$THRESHOLD$UNIT。",Message:"RadonDB PostgreSQL: $CLUSTERID，CPU使用率超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameEn:"PGMemUtilization",Expression:'(sum(container_memory_working_set_bytes{namespace="$NAMESPACE",pod=~".*$CLUSTERID-readwriteinstance.*|.*$CLUSTERID-readonlyinstance.*",container="postgresql"}) by (pod)) / (sum(kube_pod_container_resource_limits{resource="memory", container="postgresql", namespace="$NAMESPACE", pod=~".*$CLUSTERID-readwriteinstance.*|.*$CLUSTERID-readonlyinstance.*"}) by (pod)) * 100',Operator:">",Unit:"%",ProposedDuration:"1m",Summary:"RadonDB PostgreSQL 【$CLUSTERID】 内存使用率超过$THRESHOLD$UNIT。",Message:"RadonDB PostgreSQL: $CLUSTERID，内存使用率超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameEn:"PGDisk",Expression:'kubelet_volume_stats_used_bytes{persistentvolumeclaim=~".*$CLUSTERID-readwriteinstance.*|.*$CLUSTERID-readonlyinstance.*"} / kubelet_volume_stats_capacity_bytes{persistentvolumeclaim=~".*$CLUSTERID-readwriteinstance.*|.*$CLUSTERID-readonlyinstance.*"} * 100',Operator:">",Unit:"%",ProposedDuration:"1m",Summary:"RadonDB PostgreSQL 【$CLUSTERID】 磁盘使用率超过$THRESHOLD$UNIT。",Message:"RadonDB PostgreSQL: $CLUSTERID，磁盘使用率超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameEn:"PGConnPerc",Expression:'(sum(pg_stat_database_numbackends{namespace="$NAMESPACE",service=~"$CLUSTERID-readwrite|$CLUSTERID-standby-readonly"}) by (pod) / sum(pg_settings_max_connections{namespace="$NAMESPACE",service=~"$CLUSTERID-readwrite|$CLUSTERID-standby-readonly"}) by (pod)) * 100',Operator:">",Unit:"%",ProposedDuration:"1m",Summary:"RadonDB PostgreSQL 【$CLUSTERID】 连接数消耗已超过最大可用连接数的$THRESHOLD$UNIT",Message:"RadonDB PostgreSQL: $CLUSTERID，连接数消耗已超过最大可用连接数的$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameEn:"PGCacheHitRatio",Expression:'round(100*sum(pg_stat_database_blks_hit{namespace="$NAMESPACE",service=~"$CLUSTERID-readwrite|$CLUSTERID-standby-readonly"}) by(pod) / (sum(pg_stat_database_blks_hit{namespace="$NAMESPACE",service=~"$CLUSTERID-readwrite|$CLUSTERID-standby-readonly"}) by(pod) + sum(pg_stat_database_blks_read{namespace="$NAMESPACE",service=~"$CLUSTERID-readwrite|$CLUSTERID-standby-readonly"}) by(pod)),0.1)',Operator:">",Unit:"%",ProposedDuration:"1m",Summary:"RadonDB PostgreSQL 【$CLUSTERID】 缓存命中率小于$THRESHOLD$UNIT。",Message:"RadonDB PostgreSQL: $CLUSTERID，缓存命中率小于$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameEn:"MaxTxDuration",Expression:'max(pg_stat_activity_max_tx_duration{namespace="$NAMESPACE",service=~"$CLUSTERID-readwrite|$CLUSTERID-standby-readonly"})',Operator:">",Unit:"%",ProposedDuration:"1m",Summary:"RadonDB PostgreSQL 【$CLUSTERID】 最大事务持续时间超过$THRESHOLD$UNIT。",Message:"RadonDB PostgreSQL: $CLUSTERID，最大事务持续时间超过$THRESHOLD$UNIT。 当前值：{{ $value }}"}],c={Metric:{PGUnhealth:{label:"PGUnhealth",autoComplete:!0,ruleConfig:u.disabledRuleConfig},PGAsync:{label:"PGAsync",ruleConfig:u.disabledRuleConfig},PGNotRunning:{label:"PGNotRunning",ruleConfig:u.disabledRuleConfig},PGInvalid:{label:"PGInvalid",ruleConfig:u.disabledRuleConfig},PGCPUUtilization:{label:"PGCPUUtilization",ruleConfig:u.PERCENT_RULE_CONFIG},PGMemUtilization:{label:"PGMemUtilization",ruleConfig:u.PERCENT_RULE_CONFIG},PGDisk:{label:"PGDisk",autoComplete:!0,ruleConfig:u.PERCENT_RULE_CONFIG},PGConnPerc:{label:"PGConnPerc",ruleConfig:u.PERCENT_RULE_CONFIG},PGCacheHitRatio:{label:"PGCacheHitRatio",ruleConfig:u.PERCENT_RULE_CONFIG},MaxTxDuration:{label:"MaxTxDuration",autoComplete:!0,ruleConfig:u.TIME_RULE_CONFIG}},Query:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Expression)}))),Message:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Message)}))),Summary:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Summary)})))};t.default=c},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(20);var l=a(885),u=a(910),o=[{NameZh:"ClickHouse服务下线",NameEn:"ClickHouseServerDown",Expression:'chi_clickhouse_metric_fetch_errors{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID",fetch_type="system.metrics"} > 0',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"ClickHouse 无法提供数据库服务",Summary:"RadonDB ClickHouse 【$CLUSTERID】 ClickHouse 无法提供数据库服务",Message:"RadonDB ClickHouse: $CLUSTERID，ClickHouse 无法提供数据库服务。 当前值：{{ $value }}"},{NameZh:"ClickHouse服务重启",NameEn:"ClickHouseServerRestartRecently",Expression:'chi_clickhouse_metric_Uptime{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"} > 1 < 180',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"clickhouse server进程已在不到3分钟前启动",Summary:"RadonDB ClickHouse 【$CLUSTERID】 clickhouse server进程已在不到3分钟前启动",Message:"RadonDB ClickHouse: $CLUSTERID，clickhouse server进程已在不到3分钟前启动。查看之前的ClickHouse pod日志，以调查重启原因。 当前值：{{ $value }}"},{NameZh:"ClickHouse分布式表文件插入频繁",NameEn:"ClickHouseDistributedFilesToInsertHigh",Expression:'chi_clickhouse_metric_DistributedFilesToInsert{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}',Operator:">",Unit:"个",ProposedDuration:"1m",Explain:"clickhouse服务器超过$THRESHOLD$UNIT分布式文件在做插入操作",Summary:"RadonDB ClickHouse 【$CLUSTERID】 clickhouse服务器超过$THRESHOLD$UNIT分布式文件在做插入操作",Message:"RadonDB ClickHouse: $CLUSTERID，clickhouse服务器超过$THRESHOLD$UNIT分布式文件在做插入操作。 当前值：{{ $value }}"},{NameZh:"ClickHouse分布式连接异常",NameEn:"ClickHouseDistributedConnectionExceptions",Expression:'increase(chi_clickhouse_event_DistributedConnectionFailTry{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}[1m]) > 0 or increase(chi_clickhouse_event_DistributedConnectionFailAtAll{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}[1m]) > 0',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"分布式连接发生异常",Summary:"RadonDB ClickHouse 【$CLUSTERID】 分布式连接发生异常",Message:"RadonDB ClickHouse: $CLUSTERID，分布式连接发生异常。 当前值：{{ $value }}"},{NameZh:"ClickHouse拒绝Insert操作",NameEn:"ClickHouseRejectedInsert",Expression:'increase(chi_clickhouse_event_RejectedInserts{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}[1m]) > 0',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"出现拒绝插入异常",Summary:"RadonDB ClickHouse 【$CLUSTERID】 出现拒绝插入异常",Message:"RadonDB ClickHouse: $CLUSTERID，出现拒绝插入异常。 当前值：{{ $value }}"},{NameZh:"ClickHouse低插入元组数",NameEn:"ClickHouseLowInsertedRowsPerQuery",Expression:'increase(chi_clickhouse_event_InsertQuery{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}[1m]) > 0 and (increase(chi_clickhouse_event_InsertedRows{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}[1m]) / increase(chi_clickhouse_event_InsertQuery{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}[1m]) <= 1000)',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"建议增加每次Insert操作的插入元组数",Summary:"RadonDB ClickHouse 【$CLUSTERID】 建议增加每次Insert操作的插入元组数",Message:"RadonDB ClickHouse: $CLUSTERID，建议增加每次Insert操作的插入元组数。 当前值：{{ $value }}"},{NameZh:"ClickHouse慢查询",NameEn:"ClickHouseLongestRunningQuery",Expression:'chi_clickhouse_metric_LongestRunningQuery{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"} > 600',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"出现了长时间运行的慢查询",Summary:"RadonDB ClickHouse 【$CLUSTERID】 出现了长时间运行的慢查询",Message:"RadonDB ClickHouse: $CLUSTERID，出现了长时间运行的慢查询。 当前值：{{ $value }}"},{NameZh:"ClickHouse抢占查询",NameEn:"ClickHouseQueryPreempted",Expression:'chi_clickhouse_metric_QueryPreempted{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"} > 0',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"发生了抢占查询",Summary:"RadonDB ClickHouse 【$CLUSTERID】 发生了抢占查询",Message:"RadonDB ClickHouse: $CLUSTERID，发生了抢占查询。 当前值：{{ $value }}"},{NameZh:"ClickHouse太多连接数",NameEn:"ClickHouseTooManyConnections",Expression:'chi_clickhouse_metric_HTTPConnection{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"} + chi_clickhouse_metric_TCPConnection{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"} + chi_clickhouse_metric_MySQLConnection{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}',Operator:">",Unit:"个",ProposedDuration:"1m",Explain:"总连接数超过了$THRESHOLD$UNIT",Summary:"RadonDB ClickHouse 【$CLUSTERID】 总连接数超过了$THRESHOLD$UNIT",Message:"RadonDB ClickHouse: $CLUSTERID，总连接数超过了$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"ClickHouse太多查询",NameEn:"ClickHouseTooManyRunningQueries",Expression:'chi_clickhouse_metric_Query{namespace="$NAMESPACE",service="clickhouse-$CLUSTERID"}',Operator:">",Unit:"个",ProposedDuration:"1m",Explain:"太多运行着的查询，超过了$THRESHOLD$UNIT",Summary:"RadonDB ClickHouse 【$CLUSTERID】 太多运行着的查询，超过了$THRESHOLD$UNIT",Message:"RadonDB ClickHouse: $CLUSTERID，太多运行着的查询，超过了$THRESHOLD$UNIT。 当前值：{{ $value }}"}],c={Metric:{ClickHouseServerDown:{label:"ClickHouseServerDown",autoComplete:!0,ruleConfig:u.disabledRuleConfig},ClickHouseServerRestartRecently:{label:"ClickHouseServerRestartRecently",autoComplete:!0,ruleConfig:u.disabledRuleConfig},ClickHouseDistributedFilesToInsertHigh:{label:"ClickHouseDistributedFilesToInsertHigh",ruleConfig:u.ITEM_RULE_CONFIG},ClickHouseLowInsertedRowsPerQuery:{label:"ClickHouseLowInsertedRowsPerQuery",autoComplete:!0,ruleConfig:u.disabledRuleConfig},ClickHouseLongestRunningQuery:{label:"ClickHouseLongestRunningQuery",autoComplete:!0,ruleConfig:u.disabledRuleConfig},ClickHouseQueryPreempted:{label:"ClickHouseQueryPreempted",autoComplete:!0,ruleConfig:u.disabledRuleConfig},ClickHouseTooManyConnections:{label:"ClickHouseTooManyConnections",ruleConfig:u.ITEM_RULE_CONFIG},ClickHouseTooManyRunningQueries:{label:"ClickHouseTooManyRunningQueries",ruleConfig:u.ITEM_RULE_CONFIG}},Query:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Expression)}))),Message:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Message)}))),Summary:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Summary)})))};t.default=c},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(20);var l=a(885),u=a(910),o=[{NameZh:"当前连接数过多",NameEn:"MongodbTooManyConnections",Expression:'mongodb_connections_current{namespace="$NAMESPACE",cluster_name="$CLUSTERID"}',Operator:">",Unit:"个",ProposedDuration:"1m",Explain:"当前连接数超过$THRESHOLD$UNIT",Summary:"RadonDB MongoDB 【$CLUSTERID】 当前连接数超过$THRESHOLD$UNIT",Message:"RadonDB MongoDB: $CLUSTERID，当前连接数超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"当前游标打开数量过多",NameEn:"MongodbTooManyCursors",Expression:'mongodb_metrics_cursor_open_total{namespace="$NAMESPACE",cluster_name="$CLUSTERID"}',Operator:">",Unit:"个",ProposedDuration:"1m",Explain:"当前游标打开数量大于$THRESHOLD$UNIT",Summary:"RadonDB MongoDB 【$CLUSTERID】 当前游标打开数量大于$THRESHOLD$UNIT",Message:"RadonDB MongoDB: $CLUSTERID，当前游标打开数量大于$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"当前事务读并发已达到最大值",NameEn:"MongodbMaxTransactionConcurrentRead",Expression:'mongodb_wiredTiger_concurrentTransactions_read_out{namespace="$NAMESPACE",cluster_name="$CLUSTERID"} >= 128',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"当前事务读并发已达到最大值128",Summary:"RadonDB MongoDB 【$CLUSTERID】 当前事务读并发已达到最大值128",Message:"RadonDB MongoDB: $CLUSTERID，当前事务读并发已达到最大值128。 当前值：{{ $value }}"},{NameZh:"当前事务写并发已达到最大值",NameEn:"MongodbMaxTransactionConcurrentWrite",Expression:'mongodb_wiredTiger_concurrentTransactions_write_out{namespace="$NAMESPACE",cluster_name="$CLUSTERID"} >= 128',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"当前事务写并发已达到最大值128",Summary:"RadonDB MongoDB 【$CLUSTERID】 当前事务写并发已达到最大值128",Message:"RadonDB MongoDB: $CLUSTERID，当前事务写并发已达到最大值128。 当前值：{{ $value }}"},{NameZh:"WiredTiger 内存使用达到90%",NameEn:"MongoDBWiredTigerUsageEvition",Expression:'mongodb_wiredTiger_cache_bytes_currently_in_the_cache{namespace="$NAMESPACE",cluster_name="$CLUSTERID"}/mongodb_wiredTiger_cache_maximum_bytes_configured{namespace="$NAMESPACE",cluster_name="$CLUSTERID"} * 100 >= 90',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"WiredTiger 内存使用达到90%",Summary:"RadonDB MongoDB 【$CLUSTERID】 WiredTiger 内存使用达到90%",Message:"RadonDB MongoDB: $CLUSTERID，WiredTiger 内存使用达到90%。 当前值：{{ $value }}"},{NameZh:"WiredTiger 内存脏页达到20%",NameEn:"MongoDBWiredTigerDirtyEvition",Expression:'mongodb_wiredTiger_cache_tracked_dirty_bytes_in_the_cache{namespace="$NAMESPACE",cluster_name="$CLUSTERID"}/mongodb_wiredTiger_cache_maximum_bytes_configured{namespace="$NAMESPACE",cluster_name="$CLUSTERID"} * 100 >= 20',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"WiredTiger 内存脏页达到20%",Summary:"RadonDB MongoDB 【$CLUSTERID】 WiredTiger 内存脏页达到20%",Message:"RadonDB MongoDB: $CLUSTERID，WiredTiger 内存脏页达到20%。 当前值：{{ $value }}"}],c={Metric:{MongodbTooManyConnections:{label:"MongodbTooManyConnections",ruleConfig:u.ITEM_RULE_CONFIG},MongodbTooManyCursors:{label:"MongodbTooManyCursors",ruleConfig:u.ITEM_RULE_CONFIG},MongodbMaxTransactionConcurrentRead:{label:"MongodbMaxTransactionConcurrentRead",autoComplete:!0,ruleConfig:u.disabledRuleConfig},MongodbMaxTransactionConcurrentWrite:{label:"MongodbMaxTransactionConcurrentWrite",autoComplete:!0,ruleConfig:u.disabledRuleConfig},MongoDBWiredTigerUsageEvition:{label:"MongoDBWiredTigerUsageEvition",autoComplete:!0,ruleConfig:u.disabledRuleConfig},MongoDBWiredTigerDirtyEvition:{label:"MongoDBWiredTigerDirtyEvition",autoComplete:!0,ruleConfig:u.disabledRuleConfig}},Query:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Expression)}))),Message:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Message)}))),Summary:(0,l.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Summary)})))};t.default=c},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(20);var l=a(910),u=a(885),o=[{NameZh:"Redis连接数过多",NameEn:"Redis Client Usage",Expression:'redis_connected_clients{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"}/redis_config_maxclients{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"}*100',Operator:">",Unit:"%",ProposedDuration:"1m",Explain:"当前连接数使用超过$THRESHOLD$UNIT",Summary:"RadonDB Redis 【$CLUSTERID】 当前连接数使用超过$THRESHOLD$UNIT",Message:"RadonDB Redis: $CLUSTERID，当前连接数使用超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"被拒绝的Key个数",NameEn:"Evicted Keys",Expression:'redis_evicted_keys_total{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"}',Operator:">",Unit:"个",ProposedDuration:"1m",Explain:"被拒绝的key的个数达到$THRESHOLD$UNIT",Summary:"RadonDB Redis 【$CLUSTERID】 被拒绝的key的个数达到$THRESHOLD$UNIT",Message:"RadonDB Redis: $CLUSTERID，被拒绝的key的个数达到$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"内存使用率",NameEn:"Memory Usage",Expression:'redis_memory_used_bytes{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"}/redis_memory_max_bytes{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"}*100',Operator:">",Unit:"%",ProposedDuration:"1m",Explain:"当前内存使用率超过$THRESHOLD$UNIT",Summary:"RadonDB Redis 【$CLUSTERID】 当前内存使用率超过$THRESHOLD$UNIT",Message:"RadonDB Redis: $CLUSTERID，当前内存使用率超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"阻塞的客户端数",NameEn:"Blocked Clients",Expression:'redis_blocked_clients{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"}',Operator:">",Unit:"个",ProposedDuration:"1m",Explain:"阻塞客户端数超过$THRESHOLD$UNIT",Summary:"RadonDB Redis 【$CLUSTERID】 阻塞客户端数超过$THRESHOLD$UNIT",Message:"RadonDB Redis: $CLUSTERID，阻塞客户端数超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"拒绝的连接数",NameEn:"Rejected Connections",Expression:'rate(redis_rejected_connections_total{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"}[5m])',Operator:">",Unit:"%",ProposedDuration:"1m",Explain:"拒绝的连接数超过$THRESHOLD$UNIT",Summary:"RadonDB Redis 【$CLUSTERID】 拒绝的连接数超过$THRESHOLD$UNIT",Message:"RadonDB Redis: $CLUSTERID，拒绝的连接数超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"已使用的rss字节数",NameEn:"Used RSS Bytes",Expression:'redis_memory_used_rss_bytes{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"}',Operator:">",Unit:"byte",ProposedDuration:"1m",Explain:"内存已经使用的内存大小超过$THRESHOLD$UNIT",Summary:"RadonDB Redis 【$CLUSTERID】 内存已经使用的内存大小超过$THRESHOLD$UNIT",Message:"RadonDB Redis: $CLUSTERID，内存已经使用的内存大小超过$THRESHOLD$UNIT。 当前值：{{ $value }}"},{NameZh:"内存碎片率",NameEn:"Memory Fragmentation Ratio",Expression:'redis_mem_fragmentation_ratio{namespace="$NAMESPACE",service=~".*$CLUSTERID.*"} > 1.5 ',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"内存碎片率过大，超过1.5",Summary:"RadonDB Redis 【$CLUSTERID】 内存碎片率过大，超过1.5",Message:"RadonDB Redis: $CLUSTERID，内存碎片率过大，超过1.5。 当前值：{{ $value }}"}],c={Metric:{"Redis Client Usage":{label:"Redis Client Usage",ruleConfig:l.PERCENT_RULE_CONFIG},"Evicted Keys":{label:"Evicted Keys",ruleConfig:l.ITEM_RULE_CONFIG},"Memory Usage":{label:"Memory Usage",ruleConfig:l.PERCENT_RULE_CONFIG},"Blocked Clients":{label:"Blocked Clients",ruleConfig:l.ITEM_RULE_CONFIG},"Rejected Connections":{label:"Rejected Connections",ruleConfig:l.PERCENT_RULE_CONFIG},"Used RSS Bytes":{label:"Used RSS Bytes",ruleConfig:l.BYTE_RULE_CONFIG},"Memory Fragmentation Ratio":{label:"Memory Fragmentation Ratio",autoComplete:!0,ruleConfig:l.disabledRuleConfig}},Query:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Expression)}))),Message:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Message)}))),Summary:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Summary)})))};t.default=c},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(20);var l=a(910),u=a(885),o=[{NameZh:"集群健康状态为 yellow",NameEn:"ClusterHealthStatusYellow",Expression:'elasticsearch_cluster_health_status{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE",color="yellow"} == 1',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Explain:"集群健康状态为 yellow",Summary:"RadonDB Elasticsearch 【$CLUSTERID】 集群健康状态为 yellow",Message:"RadonDB Elasticsearch: $CLUSTERID，集群健康状态为 yellow。 当前值：{{ $value }}"},{NameZh:"集群健康状态为 red",NameEn:"ClusterHealthStatusRed",Expression:'elasticsearch_cluster_health_status{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE",color="red"} == 1',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Explain:"集群健康状态为 red",Summary:"RadonDB Elasticsearch 【$CLUSTERID】 集群健康状态为 red",Message:"RadonDB Elasticsearch: $CLUSTERID，集群健康状态为 red。 当前值：{{ $value }}"},{NameZh:"堆内存使用率超过85%",NameEn:"HeapMemTooHigh85%",Expression:'max(round(elasticsearch_jvm_memory_used_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE",area="heap"}/elasticsearch_jvm_memory_max_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE",area="heap"}*100,0.1)) > 85',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Explain:"堆内存使用率超过85%",Summary:"RadonDB Elasticsearch 【$CLUSTERID】 堆内存使用率超过85%",Message:"RadonDB Elasticsearch: $CLUSTERID，堆内存使用率超过85%。 当前值：{{ $value }}"},{NameZh:"堆内存使用率超过90%",NameEn:"HeapMemTooHigh90%",Expression:'max(round(elasticsearch_jvm_memory_used_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE",area="heap"}/elasticsearch_jvm_memory_max_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE",area="heap"}*100,0.1)) > 90',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Explain:"堆内存使用率超过90%",Summary:"RadonDB Elasticsearch 【$CLUSTERID】 堆内存使用率超过90%",Message:"RadonDB Elasticsearch: $CLUSTERID，堆内存使用率超过90%。 当前值：{{ $value }}"},{NameZh:"CPU使用率超过90%",NameEn:"CPUUsageOver90%",Expression:'max(elasticsearch_os_cpu_percent{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE"}) > 90',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Explain:"CPU使用率超过90%",Summary:"RadonDB Elasticsearch 【$CLUSTERID】 CPU使用率超过90%",Message:"RadonDB Elasticsearch: $CLUSTERID，CPU使用率超过90%。 当前值：{{ $value }}"},{NameZh:"磁盘可用百分比小于15%",NameEn:"AvailableDiskLessThan15%",Expression:'min(round(elasticsearch_filesystem_data_free_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE"}/elasticsearch_filesystem_data_size_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE"}*100,0.1)) < 15',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"磁盘可用百分比小于15%",Summary:"RadonDB Elasticsearch 【$CLUSTERID】 磁盘可用百分比小于15%",Message:"RadonDB Elasticsearch: $CLUSTERID，磁盘可用百分比小于15%。 当前值：{{ $value }}"},{NameZh:"磁盘可用百分比小于10%",NameEn:"AvailableDiskLessThan10%",Expression:'min(round(elasticsearch_filesystem_data_free_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE"}/elasticsearch_filesystem_data_size_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE"}*100,0.1)) < 10',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"磁盘可用百分比小于10%",Summary:"RadonDB Elasticsearch 【$CLUSTERID】 磁盘可用百分比小于10%",Message:"RadonDB Elasticsearch: $CLUSTERID，磁盘可用百分比小于10%。 当前值：{{ $value }}"},{NameZh:"磁盘可用百分比小于5%",NameEn:"AvailableDiskLessThan5%",Expression:'min(round(elasticsearch_filesystem_data_free_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE"}/elasticsearch_filesystem_data_size_bytes{service="$CLUSTERID-es-elasticsearch-exporter",namespace="$NAMESPACE"}*100,0.1)) < 5',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Explain:"磁盘可用百分比小于5%",Summary:"RadonDB Elasticsearch 【$CLUSTERID】 磁盘可用百分比小于5%",Message:"RadonDB Elasticsearch: $CLUSTERID，磁盘可用百分比小于5%。 当前值：{{ $value }}"}],c={Metric:{ClusterHealthStatusYellow:{label:"ClusterHealthStatusYellow",autoComplete:!0,ruleConfig:l.disabledRuleConfig},ClusterHealthStatusRed:{label:"ClusterHealthStatusRed",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"HeapMemTooHigh85%":{label:"HeapMemTooHigh85%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"HeapMemTooHigh90%":{label:"HeapMemTooHigh90%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"CPUUsageOver90%":{label:"CPUUsageOver90%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"AvailableDiskLessThan15%":{label:"AvailableDiskLessThan15%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"AvailableDiskLessThan10%":{label:"AvailableDiskLessThan10%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"AvailableDiskLessThan5%":{label:"AvailableDiskLessThan5%",autoComplete:!0,ruleConfig:l.disabledRuleConfig}},Query:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Expression)}))),Message:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Message)}))),Summary:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Summary)})))};t.default=c},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(20);var l=a(910),u=a(885),o=[{NameZh:"存在不可用的 partitions",NameEn:"ExistOfflinePartitions",Expression:'sum(kafka_controller_kafkacontroller_offlinepartitionscount{namespace="$NAMESPACE",strimzi_io_cluster="$CLUSTERID"}) > 0',Operator:"N/A",Unit:"N/A",Summary:"存在不可用的partitions。",Message:""},{NameZh:"存在ISR数目小于最小ISR的partitions",NameEn:"ExistPartitionsUnderMinimumISR",Expression:'sum(kafka_cluster_partition_underminisr{namespace="$NAMESPACE",strimzi_io_cluster="$CLUSTERID"}) > 0',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"存在ISR数目小于最小ISR的partitions。",Message:""},{NameZh:"堆内存使用率超过85%",NameEn:"KafkaHeapMemTooHigh85%",Expression:'round(sum(jvm_memory_bytes_used{namespace="$NAMESPACE",strimzi_io_name="$CLUSTERID-kafka"})/sum(jvm_memory_bytes_max{namespace="$NAMESPACE",strimzi_io_name="$CLUSTERID-kafka"})*100,0.1) > 85',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"堆内存使用率超过85%。",Message:""},{NameZh:"磁盘可用百分比小于15%",NameEn:"KafkaAvailableDiskLessThan15%",Expression:'round(sum(kubelet_volume_stats_available_bytes{namespace="$NAMESPACE",persistentvolumeclaim=~"data-0-$CLUSTERID-kafka.*"})/sum(kubelet_volume_stats_capacity_bytes{namespace="$NAMESPACE",persistentvolumeclaim=~"data-0-$CLUSTERID-kafka.*"})*100,0.1) < 15',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"磁盘可用百分比小于15%。",Message:""},{NameZh:"磁盘可用百分比小于10%",NameEn:"KafkaAvailableDiskLessThan10%",Expression:'round(sum(kubelet_volume_stats_available_bytes{namespace="$NAMESPACE",persistentvolumeclaim=~"data-0-$CLUSTERID-kafka.*"})/sum(kubelet_volume_stats_capacity_bytes{namespace="$NAMESPACE",persistentvolumeclaim=~"data-0-$CLUSTERID-kafka.*"})*100,0.1) < 10',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"磁盘可用百分比小于10%。",Message:""},{NameZh:"磁盘可用百分比小于5%",NameEn:"KafkaAvailableDiskLessThan5%",Expression:'round(sum(kubelet_volume_stats_available_bytes{namespace="$NAMESPACE",persistentvolumeclaim=~"data-0-$CLUSTERID-kafka.*"})/sum(kubelet_volume_stats_capacity_bytes{namespace="$NAMESPACE",persistentvolumeclaim=~"data-0-$CLUSTERID-kafka.*"})*100,0.1) < 5',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Summary:"磁盘可用百分比小于5%。",Message:""},{NameZh:"平均响应时间超过1000ms",NameEn:"RequestLatencyAverage1s",Expression:'zookeeper_avgrequestlatency{namespace="$NAMESPACE",kubernetes_pod_name=~"$CLUSTERID-zookeeper.*"} > 1000',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Summary:"平均响应时间超过1000ms。",Message:""}],c={Metric:{ExistOfflinePartitions:{label:"ExistOfflinePartitions",autoComplete:!0,ruleConfig:l.disabledRuleConfig},ExistPartitionsUnderMinimumISR:{label:"ExistPartitionsUnderMinimumISR",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"KafkaHeapMemTooHigh85%":{label:"HeapMemTooHigh85%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"KafkaAvailableDiskLessThan15%":{label:"AvailableDiskLessThan15%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"KafkaAvailableDiskLessThan10%":{label:"AvailableDiskLessThan10%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"KafkaAvailableDiskLessThan5%":{label:"AvailableDiskLessThan5%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},RequestLatencyAverage1s:{label:"RequestLatencyAverage1s",autoComplete:!0,ruleConfig:l.disabledRuleConfig}},Query:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Expression)}))),Message:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Message)}))),Summary:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Summary)})))};t.default=c},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(31));a(20);var l=a(910),u=a(885),o=[{NameEn:"OpenSearchClusterHealthStatusYellow",Expression:'max(opensearch_cluster_status{service="$CLUSTERID",namespace="$NAMESPACE"})==1',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"RadonDB OpenSearch 【$CLUSTERID】 集群健康状态为 yellow",Message:"RadonDB OpenSearch: $CLUSTERID，集群健康状态为 yellow。 当前值：{{ $value }}"},{NameEn:"OpenSearchClusterHealthStatusRed",Expression:'max(opensearch_cluster_status{service="$CLUSTERID",namespace="$NAMESPACE"})==2',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"RadonDB OpenSearch 【$CLUSTERID】 集群健康状态为 red",Message:"RadonDB OpenSearch: $CLUSTERID，集群健康状态为 red。 当前值：{{ $value }}"},{NameEn:"OpenSearchHeapMemTooHigh85%",Expression:'max(opensearch_jvm_mem_heap_used_percent{service="$CLUSTERID",namespace="$NAMESPACE"})>85',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"RadonDB OpenSearch 【$CLUSTERID】 堆内存使用率超过85%",Message:"RadonDB OpenSearch: $CLUSTERID，堆内存使用率超过85%。 当前值：{{ $value }}"},{NameEn:"OpenSearchHeapMemTooHigh90%",Expression:'max(opensearch_jvm_mem_heap_used_percent{service="$CLUSTERID",namespace="$NAMESPACE"})>90',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"RadonDB OpenSearch 【$CLUSTERID】 堆内存使用率超过90%",Message:"RadonDB OpenSearch: $CLUSTERID，堆内存使用率超过90%。 当前值：{{ $value }}"},{NameEn:"OpenSearchCPUUsageOver90%",Expression:'max(opensearch_os_cpu_percent{service="$CLUSTERID",namespace="$NAMESPACE"})>90',Operator:"N/A",Unit:"N/A",ProposedDuration:"3m",Summary:"RadonDB OpenSearch 【$CLUSTERID】 CPU使用率超过90%",Message:"RadonDB OpenSearch: $CLUSTERID，CPU使用率超过90%。 当前值：{{ $value }}"},{NameEn:"OpenSearchAvailableDiskLessThan15%",Expression:'min(round(opensearch_fs_total_available_bytes{service="$CLUSTERID",namespace="$NAMESPACE"}/opensearch_fs_total_total_bytes{service="$CLUSTERID",namespace="$NAMESPACE"}*100,0.1))<15',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Summary:"RadonDB OpenSearch 【$CLUSTERID】 磁盘可用百分比小于15%",Message:"RadonDB OpenSearch: $CLUSTERID，磁盘可用百分比小于15%。 当前值：{{ $value }}"},{NameEn:"OpenSearchAvailableDiskLessThan10%",Expression:'min(round(opensearch_fs_total_available_bytes{service="$CLUSTERID",namespace="$NAMESPACE"}/opensearch_fs_total_total_bytes{service="$CLUSTERID",namespace="$NAMESPACE"}*100,0.1))<10',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Summary:"RadonDB OpenSearch 【$CLUSTERID】 磁盘可用百分比小于10%",Message:"RadonDB OpenSearch: $CLUSTERID，磁盘可用百分比小于10%。 当前值：{{ $value }}"},{NameEn:"OpenSearchAvailableDiskLessThan5%",Expression:'min(round(opensearch_fs_total_available_bytes{service="$CLUSTERID",namespace="$NAMESPACE"}/opensearch_fs_total_total_bytes{service="$CLUSTERID",namespace="$NAMESPACE"}*100,0.1))<5',Operator:"N/A",Unit:"N/A",ProposedDuration:"1m",Summary:"RadonDB OpenSearch 【$CLUSTERID】 磁盘可用百分比小于5%",Message:"RadonDB OpenSearch: $CLUSTERID，磁盘可用百分比小于5%。 当前值：{{ $value }}"}],c={Metric:{OpenSearchClusterHealthStatusYellow:{label:"ClusterHealthStatusYellow",autoComplete:!0,ruleConfig:l.disabledRuleConfig},OpenSearchClusterHealthStatusRed:{label:"ClusterHealthStatusRed",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"OpenSearchHeapMemTooHigh85%":{label:"HeapMemTooHigh85%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"OpenSearchHeapMemTooHigh90%":{label:"HeapMemTooHigh90%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"OpenSearchCPUUsageOver90%":{label:"CPUUsageOver90%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"OpenSearchAvailableDiskLessThan15%":{label:"AvailableDiskLessThan15%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"OpenSearchAvailableDiskLessThan10%":{label:"AvailableDiskLessThan10%",autoComplete:!0,ruleConfig:l.disabledRuleConfig},"OpenSearchAvailableDiskLessThan5%":{label:"AvailableDiskLessThan5%",autoComplete:!0,ruleConfig:l.disabledRuleConfig}},Query:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Expression)}))),Message:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Message)}))),Summary:(0,u.arrayToObject)(o.map((function(e){return(0,n.default)({},e.NameEn,e.Summary)})))};t.default=c},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(798)),f=n(r(1322));function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m={"openpitrix.template.edit.v2":{on:function(e){var a,r=e.store,n=e.success,o=e.workspace,d=(0,c.default)(e,["store","success","workspace"]),m=i.default.open(p({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.update(p(p({},a),{},{workspace:o,app_id:a.name}));case 2:i.default.close(m),s.default.success({content:t("MODIFY_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,modal:f.default,success:n},d))}}};a.default=m},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),r(4),r(21),r(18),r(30),r(11),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var l=n(r(58)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(1),h=r(189),v=n(r(456)),E=n(r(449)),y=n(r(897)),g=n(r(826)),b=r(61),S=r(329),_=r(873),O=n(r(1961));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var T=function(e){(0,i.default)(r,e);var a=C(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).checkPackage=function(){var e=(0,o.default)(u.default.mark((function e(a){var r,n,l,c,s,i;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.props.fileStore,n=r.checkFile,l=r.handleFileByBase64Str,c=r.validateImageSize,!(s=n(a,"icon"))){e.next=6;break}t.setState({error:s,base64Str:""}),e.next=9;break;case 6:return i=(0,E.default)(a.name.toLocaleLowerCase().split(".")),e.next=9,l(a,function(){var e=(0,o.default)(u.default.mark((function e(a){var r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="data:image/".concat("svg"===i?"svg+xml":i,";base64,").concat(a),e.next=4,c(r);case 4:e.sent?(t.handleAppChange(a,"icon"),t.setState({error:"",base64Str:a})):t.setState({error:"FILE_MAX_SIZE_ICON",base64Str:""});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:return e.abrupt("return",Promise.reject());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.handleAppChange=function(e,a){t.props.handleChange(e,a)},t.state={base64Str:""},t}return(0,s.default)(r,[{key:"renderIcon",value:function(){var e=this.props.formData,a=this.state,r=a.base64Str,n=void 0===r?e.icon:r,l=a.error;return p.default.createElement(p.default.Fragment,null,p.default.createElement("div",{className:O.default.uploadIcon},p.default.createElement("div",{className:O.default.iconShow},p.default.createElement(g.default,{iconSize:96,className:O.default.image,isBase64Str:Boolean(n||e.icon),src:n||e.icon,iconLetter:e.name})),p.default.createElement("div",{className:O.default.word},p.default.createElement("div",{className:O.default.note},t("APP_ICON_FORMAT")," ",p.default.createElement("br",null),t("APP_ICON_SIZE")),p.default.createElement(y.default,{beforeUpload:this.checkPackage,accept:S.UPLOAD_FILE_TYPES.icon},p.default.createElement(h.Button,null,t("UPLOAD"))))),l&&p.default.createElement("div",{className:O.default.error},t(l)))}},{key:"render",value:function(){var e=this,a=this.props,r=a.formData,n=a.formRef,l=(0,v.default)(r.category_set,{status:"enabled"})||{};return r.category_id=r.category_id||l.category_id,p.default.createElement("div",{className:O.default.wrapper},p.default.createElement("div",{className:"h5"},t("BASIC_INFORMATION")),p.default.createElement(h.Form,{data:r,ref:n},p.default.createElement(h.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC")},p.default.createElement(h.Input,{name:"aliasName",onChange:function(t){return e.handleAppChange(t,"aliasName")},maxLength:20})),p.default.createElement(h.Form.Item,{label:t("DESCRIPTION"),desc:t("APP_DESCRIPTION_DESC")},p.default.createElement(h.TextArea,{name:"description",maxLength:120,onChange:function(t){return e.handleAppChange(t,"description")}})),p.default.createElement(h.Form.Item,{label:t("ICON"),className:O.default.upload},this.renderIcon()),p.default.createElement(h.Form.Item,{label:t("APP_CATEGORY"),desc:t("CHOOSE_APP_CATEGORY_DESC")},p.default.createElement(h.Select,{name:"categoryName",options:this.categories,onChange:this.handleAppChange,placeholder:" "})),p.default.createElement(h.Form.Item,{label:t("SERVICE_PROVIDER_WEBSITE_TCAP"),desc:t("SERVICE_PROVIDER_WEBSITE_DESC"),rules:[{pattern:b.PATTERN_URL,message:t("WRONG_ADDRESS_TIP")}]},p.default.createElement(h.Input,{name:"appHome",onChange:function(t){return e.handleAppChange(t,"appHome")},maxLength:100}))))}},{key:"categories",get:function(){return(0,l.default)(this.props.categories.map((function(e){return{label:(0,_.getAppCategoryNames)(e),value:e.metadata.name}})))}}]),r}(p.default.Component);a.default=T,T.propTypes={formData:m.PropTypes.object,categories:m.PropTypes.array,handleChange:m.PropTypes.func,fileStore:m.PropTypes.object},T.defaultProps={formData:{},categories:[],handleChange:function(){},fileStore:function(){}}},,,,,function(e,t,a){e.exports={wrapper:"Rk4l1po88HDeYzazEMBN_",upload:"ys_3xaDsyuU_BwmYso3da",uploadIcon:"xazERK8IwIU5mMNlOh0ov",iconShow:"_2O2_iCxVqr5NIU8iXwgeKw",image:"dB9UI_QxazYVhoEEGXV2Q",word:"_3FSAieuafxZbkRTeupWSZ4",note:"_3SDtD1U6KJUZH49mws95gu",error:"BJosedTpMR7xNtx-4boXe"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(190),r(21),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(190),r(21),r(18),r(43),r(11);var l=n(r(38));r(35);var u,o,c,s=n(r(39)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=r(243),E=n(r(1)),y=n(r(5)),g=r(189),b=n(r(26)),S=n(r(826)),_=n(r(897)),O=r(329),C=n(r(1963));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var R=(0,v.observer)((c=o=function(e){(0,d.default)(r,e);var a=T(r);function r(){var e;(0,i.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).state={error:""},e.onUploadClick=function(){e.uploadRef.onClick()},e.uploadScreenshot=function(){var t=(0,s.default)(l.default.mark((function t(a){var r,n,u,o,c,i,f,d;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props.fileStore,n=r.checkFile,u=r.handleFileByBase64Str,o=e.props.store.uploadScreenshot2,c=e.props,i=c.handleChange,f=c.detail,(d=n(a,"screenshots"))?e.setState({error:d}):u(a,function(){var t=(0,s.default)(l.default.mark((function t(r){var n;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({error:""}),t.next=3,o(a,r,null==f?void 0:f.workspace);case 3:n=t.sent,i(n,"attachments");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.abrupt("return",Promise.reject());case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.deleteScreenshot=function(){var t=(0,s.default)(l.default.mark((function t(a,r){var n,u,o,c;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.props,u=n.handleChange,o=n.store,c=o.deleteScreenshot(a,r),u(c,"attachments");case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e}return(0,f.default)(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.detail,a=e.handleChange,r=(0,b.default)(t,"attachments",[]);this.props.store.getImageUrlList(r,null==t?void 0:t.workspace).then((function(e){a(e,"attachments")}))}},{key:"render",value:function(){var e=this,a=this.state.error,r=this.props.detail,n=(0,b.default)(r,"attachments",[]).map((function(e){return"string"==typeof e?"":e})),l=n.length;return h.default.createElement("div",null,h.default.createElement("div",{className:C.default.title},t("APP_SCREENSHOTS")),h.default.createElement("div",{className:C.default.screenshot},h.default.createElement("ul",{className:C.default.pictures},null==n?void 0:n.map((function(a,n){return h.default.createElement("li",{key:n},!!Object.values(a)[0]&&h.default.createElement(h.default.Fragment,null,h.default.createElement(S.default,{src:Object.values(a)[0],isBase64Str:!!Object.values(a)[0]})),h.default.createElement("div",{className:C.default.delete},h.default.createElement("label",{onClick:function(){e.deleteScreenshot(n,r)}},h.default.createElement(g.Icon,{name:"trash",size:20,className:C.default.icon}),t("DELETE"))))})),l<O.SCREENSHOTS_LIMIT&&h.default.createElement("li",{className:C.default.upload},h.default.createElement(_.default,{multiple:!0,className:C.default.upload,beforeUpload:this.uploadScreenshot,ref:function(t){e.uploadRef=t},accept:O.UPLOAD_FILE_TYPES.screenshot},h.default.createElement(g.Icon,{name:"add",size:48,className:C.default.add})))),a?h.default.createElement("div",{className:C.default.error},t(this.state.error)):h.default.createElement("div",{className:C.default.words},t("SCREENSHOTS_COLON"),l,"/",O.SCREENSHOTS_LIMIT,t("FILE_MAX_SCREENSHOTS"),l>0?h.default.createElement("label",{className:C.default.deleteAll,onClick:function(){e.deleteScreenshot(-1,r)}},t("DELETE_ALL")):h.default.createElement("label",{className:(0,y.default)(C.default.deleteAll,C.default.disabled)},t("DELETE_ALL")))))}}]),r}(h.default.Component),o.propTypes={detail:E.default.object,store:E.default.object,fileStore:E.default.object},o.defaultProps={detail:{},store:{},fileStore:function(){}},u=c))||u;a.default=R},function(e,t,a){e.exports={title:"_2uPiYzFDOXR72WfG9uGqfU",screenshot:"_2YKRw87avTolrxMvvqKdUw",pictures:"_2mut4J5F7tqeF_yGoONfAl",upload:"_3Y5SOweqK4JOLgJYTWXwWB",add:"svj73vqzmkHDs00vaMNKa",delete:"_2CvCSpyGVDD7j2kE2aPl6g",icon:"_19kdNNakltP3B4lu8OnnPQ",error:"gtPg-cI0R-ryIQiNIwS3N",words:"_2w8iv_6c2wn1jOzU9DFnYk",disabled:"LwrGabyBVUqWJUr4TYWl",deleteAll:"_2nkH5dSh2jhtOpVwtll5Dp"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(243),h=n(r(1)),v=n(r(1965)),E=n(r(1966));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var g={h1:!0,h2:!0,h3:!0,h4:!0,img:!1,link:!0,code:!0,preview:!0,expand:!0,undo:!0,redo:!0,save:!1,subfield:!0},b=(0,m.observer)((o=u=function(e){(0,i.default)(r,e);var a=y(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleChange=function(e){t.setState({readme:e}),t.props.handleChange(e,"abstraction")},t.state={readme:e.detail.abstraction},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.state.readme;return p.default.createElement(p.default.Fragment,null,p.default.createElement("div",{className:E.default.header},t("APP_INTRODUCTION")),p.default.createElement("div",{className:E.default.readmeEdit},p.default.createElement(v.default,{value:e,onChange:this.handleChange,placeholder:t("START_EDITING"),toolbar:g})))}}]),r}(p.default.Component),u.propTypes={detail:h.default.object,store:h.default.object,handleChange:h.default.func},u.defaultProps={detail:{},store:{},handleChange:function(){}},l=o))||l;a.default=b},,function(e,t,a){e.exports={header:"ovSS-AWa-ZyP2A-ngZTMO",readmeEdit:"Y_xQq9aBBqoFkxZrwNVBS"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(21),a(18),a(43),a(11);var n=r(a(38)),l=r(a(50));a(35);var u,o,c,s=r(a(39)),i=r(a(62)),f=r(a(25)),d=r(a(74)),p=r(a(41)),m=r(a(42)),h=r(a(37)),v=r(a(45)),E=(r(a(63)),a(17));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var g=(u=function(e){(0,p.default)(a,e);var t=y(a);function a(){var e;(0,f.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).resourceName="categories",e.getUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.category_id;return a?"".concat(e.baseUrl,"/").concat(e.resourceName,"/").concat(a):"".concat(e.baseUrl,"/").concat(e.resourceName)},(0,i.default)(e,"update",o,(0,d.default)(e)),(0,i.default)(e,"delete",c,(0,d.default)(e)),e}return a}(r(a(460)).default),o=(0,v.default)(u.prototype,"update",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,s.default)(n.default.mark((function t(){var a,r,u,o=arguments;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.length>0&&void 0!==o[0]?o[0]:{},r=a.category_id,u=(0,l.default)(a,["category_id"]),t.next=3,e.submitting(request.patch(e.getUrl({category_id:r}),u));case 3:case"end":return t.stop()}}),t)})))}}),c=(0,v.default)(u.prototype,"delete",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.category_id;return e.submitting(request.delete(e.getUrl({category_id:a}),{}))}}}),u);t.default=g},function(e,t,a){e.exports={modal:"BdK5ZaX-xYe3UCP_Y1MKV",body:"_2yuMHphDy5tXJVP5ZG_oka"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(68)),f=n(r(67)),d=n(r(140)),p=n(r(191)),m=n(r(798)),h=r(56),v=n(r(438)),E=r(61),y=n(r(1323)),g=n(r(819)),b=n(r(1982)),S=n(r(1327)),_=n(r(1328)),O=n(r(1380)),C=n(r(464)),T=n(r(1157));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k={"app.deploy":{on:function(e){var t=e.store,a=(0,c.default)(e,["store"]),r=m.default.open(D({onOk:function(){m.default.close(r)},modal:b.default,store:t},a))}},"crd.app.create":{on:function(e){var t=e.store,a=e.cluster,r=e.namespace,n=(e.workspace,e.success),l=(0,c.default)(e,["store","cluster","namespace","workspace","success"]),u=m.default.open(D({onOk:function(e){var l=(0,d.default)(e,["application","ingress"]);Object.keys(l).forEach((function(t){e=(0,d.default)(e,(0,E.OMIT_TOTAL_REPLICAS)(t))})),t.create(e,{cluster:a,namespace:r}).then((function(){m.default.close(u),n&&n()}))},store:t,cluster:a,namespace:r,modal:S.default},l))}},"crd.app.addservice":{on:function(e){var a,r=e.store,n=e.detail,o=e.cluster,s=e.namespace,f=e.success,d=(0,c.default)(e,["store","detail","cluster","namespace","success"]),v=m.default.open(D({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,c,E;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n.selector,c=String(n.serviceMeshEnable),E={service:a.Service,workload:a.Deployment||a.StatefulSet},(0,h.mergeLabels)(E.service,u),(0,h.mergeLabels)(E.workload,u),(0,i.default)(E.workload,'metadata.annotations["servicemesh.kubesphere.io/enabled"]',c),(0,i.default)(E.service,'metadata.annotations["servicemesh.kubesphere.io/enabled"]',c),(0,i.default)(E.workload,'spec.template.metadata.annotations["sidecar.istio.io/inject"]',c),!d.isFederated){e.next=15;break}return(0,h.updateFederatedAnnotations)(E.workload),(0,h.updateFederatedAnnotations)(E.service),e.next=13,r.create(E,{namespace:s});case 13:e.next=17;break;case 15:return e.next=17,r.addComponent(E,{name:n.name,cluster:o,namespace:s});case 17:m.default.close(v),p.default.success({content:"".concat(t("SERVICE_ADDED_SUCCESSFULLY"))}),f&&f();case 20:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,cluster:o,namespace:s,modal:_.default},d))}},"crd.app.addroute":{on:function(e){e.store;var a,r=e.detail,n=e.cluster,f=e.namespace,d=e.success,b=(0,c.default)(e,["store","detail","cluster","namespace","success"]),S=new C.default,_=S.module,O=E.MODULE_KIND_MAP[_],T=(0,o.default)({},O,v.default[_]({namespace:f})),R=m.default.open(D(D({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,c,v,E;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=r.selector,o=r.serviceMeshEnable,c=a.Ingress||a,(0,h.mergeLabels)(c,u),o&&(v=b.isFederated?(0,s.default)(c,"spec.template"):c,(E=(0,s.default)(v,"spec.rules[0].http.paths[0].backend.serviceName"))&&(0,i.default)(v,'metadata.annotations["nginx.ingress.kubernetes.io/upstream-vhost"]',"".concat(E,".").concat(f,".svc.cluster.local"))),b.isFederated&&(0,h.updateFederatedAnnotations)(c),e.next=8,S.create(c,{cluster:n,namespace:f});case 8:m.default.close(R),p.default.success({content:t("ADD_ROUTE_SUCCESS")}),d&&d();case 11:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),cluster:n,namespace:f,formTemplate:T,module:_,store:S,steps:y.default,modal:g.default,okBtnText:t("CREATE"),selector:r.selector},b),{},{name:"Route"}))}},"app.service.monitor":{on:function(e){var t,a=e.store,r=e.cluster,n=e.namespace,o=e.success,i=(0,c.default)(e,["store","cluster","namespace","success"]),d=new T.default,p=v.default.servicemonitors({name:"",namespace:n}),h=m.default.open(D({onOk:(t=(0,u.default)(l.default.mark((function e(t){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,s.default)(t,"metadata.name"),e.next=3,d.checkName({name:a,cluster:r,namespace:n});case 3:if(e.sent.exist){e.next=9;break}return e.next=7,d.create(t,{cluster:r,namespace:n});case 7:e.next=16;break;case 9:if(!(0,f.default)((0,s.default)(t,"spec.endpoints"))){e.next=14;break}return e.next=12,d.delete({name:a,cluster:r,namespace:n});case 12:e.next=16;break;case 14:return e.next=16,d.update({name:a,cluster:r,namespace:n},t);case 16:m.default.close(h),o&&o();case 18:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),cluster:r,namespace:n,formTemplate:p,app:a.detail,store:d,modal:O.default},i))}}};a.default=k},,function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(20),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(26)),f=n(r(0)),d=n(r(1)),p=n(r(800)),m=n(r(1324)),h=n(r(1326));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=function(e){(0,o.default)(r,e);var a=v(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"renderContent",value:function(){var e=this.props,a=e.value,r=e.onShow,n=e.onEdit,l=e.onDelete,u=e.projectDetail,o=(0,i.default)(this.context.formData,"spec.tls",[]);return f.default.createElement("ul",null,a.filter((function(e){return e&&e.host})).map((function(e,t){return f.default.createElement(m.default,{rule:e,tls:o,key:t,index:t,onEdit:n,onDelete:l,projectDetail:u})})),f.default.createElement("div",{className:h.default.add,onClick:r},f.default.createElement(p.default,{title:t("ADD_ROUTING_RULE"),description:t("ADD_ROUTING_RULE_DESC")})))}},{key:"render",value:function(){return f.default.createElement("div",{className:h.default.wrapper},this.renderContent())}}]),r}(f.default.Component);a.default=E,E.propTypes={name:d.default.string,value:d.default.array,onDelete:d.default.func,onShow:d.default.func},E.defaultProps={name:"",value:[],onDelete:function(){},onShow:function(){}},E.contextTypes={formData:d.default.object}},,function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(6),r(36),r(20),r(51),r(98),r(14),r(4),r(21),r(18),r(11),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(6),r(36),r(20),r(51),r(98),r(29),r(14),r(4),r(21),r(18),r(43),r(11),r(46),r(7),r(40);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(26)),f=n(r(68)),d=n(r(67)),p=n(r(1974)),m=n(r(0)),h=n(r(5)),v=n(r(1)),E=r(189),y=n(r(824)),g=n(r(1128)),b=r(848),S=n(r(464)),_=r(61),O=n(r(1129)),C=n(r(1978));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var R=function(e){(0,o.default)(r,e);var a=T(r);function r(e){var n;return(0,l.default)(this,r),(n=a.call(this,e)).checkItemValid=function(e){return e.path&&e.backend&&e.backend.service&&e.backend.service.name&&e.backend.service.port&&e.backend.service.port.number},n.pathValidator=function(e,a,r){return a?a.some((function(e){return!n.checkItemValid(e)}))?r({message:t("INVALID_PATH_DESC"),field:e.field}):n.handlePathExistValidator(a)?r({message:t("PATH_EXIST"),field:e.field}):void r():r()},n.handlePathExistValidator=function(e){var t=e.map((function(e){return e.path})),a=!1;return t.forEach((function(e){for(var r=t.length,n=0,l=0;n<=r;){if(e===t[n]&&l++,l>1){a=!0;break}n++}})),a},n.handleGoBack=function(){var e=n.context.resetSubRoute;return e&&e(),n.props.onCancel(),!1},n.handleProtocolChange=function(e){n.setState({protocol:e})},n.handleSubmit=function(e){var t=n.props.onSave,a=n.formRef.current;a&&a.validate((function(){var r=a.getData();t(r),e&&e()}))},n.handleValidator=function(){var e=!1,t=n.formRef.current;return t&&t.validate((function(){e=!0})),e},n.domainValidator=function(e,a,r){var l,u=n.props,o=u.isFederated,c=u.data,s=u.validData,d=u.detail,m=(0,i.default)(d,"clusters",[]).map((function(e){return e.name})),h=!!(null==s||null===(l=s.metadata)||void 0===l?void 0:l.creationTimestamp)?"put":"post";if(!a)return r();var v=n.props.cluster||n.defaultClusters,E=(0,i.default)(s,"metadata.namespace",""),y=(0,i.default)(s,"metadata.name","");o&&((0,f.default)(s,"apiVersion","networking.k8s.io/v1"),(0,f.default)(s,"kind","Ingress"),(0,f.default)(s,"spec",{})),(0,f.default)(s,"spec.rules",[{host:a}]),(null==c?void 0:c.clusters)?Promise.all(c.clusters.map((function(e){return-1===(0,p.default)(m,e)&&(h="post"),n.ingressStore.checkValidDomain({cluster:e,namespace:E,name:y},s,h).then((function(e){return e.exist}))}))).then((function(a){if(a.some((function(e){return e})))return r({message:t("EXIT_DOMAIN_DESC"),field:e.field});r()})):(v=o?"":v,n.ingressStore.checkValidDomain({cluster:v,namespace:E,name:y},s,h).then((function(a){if(a.exist)return r({message:t("EXIT_DOMAIN_DESC"),field:e.field});r()})))},n.state={service:"",protocol:(0,i.default)(e,"data.protocol","http")},n.formRef=m.default.createRef(),n.ingressStore=new S.default,n}return(0,u.default)(r,[{key:"componentDidMount",value:function(){var e=this.context.registerSubRoute;e&&e(this.handleSubmit,this.handleGoBack)}},{key:"getType",value:function(e){var t=(0,i.default)(e,"host");if(!t)return"auto";var a=this.props,r=a.gateway,n=a.projectDetail,l=a.namespace,u=(0,i.default)(e,"http.paths[0].backend.service.name"),o=(0,i.default)(n,'_originData.metadata.labels["kubesphere.io/namespace"]')||l;return t===(r.isHostName?r.defaultIngress:"".concat(u,".").concat(o,".").concat(r.defaultIngress,".nip.io"))?"auto":"specify"}},{key:"renderForm",value:function(){var e,a,r=this.state.protocol;return m.default.createElement(m.default.Fragment,null,m.default.createElement(E.Form.Item,{label:t("DOMAIN_NAME_TCAP"),key:null===(e=this.props.data)||void 0===e||null===(a=e.clusters)||void 0===a?void 0:a.length,rules:[{required:!0,message:t("DOMAIN_NAME_EMPTY_DESC")},{pattern:_.PATTERN_HOST,message:t("INVALID_DOMAIN_DESC")},{validator:this.domainValidator}]},m.default.createElement(E.Input,{name:"host",autoFocus:!0})),m.default.createElement(E.Form.Item,{label:t("PROTOCOL")},m.default.createElement(E.Select,{name:"protocol",defaultValue:"http",onChange:this.handleProtocolChange,options:this.protocols})),"https"===r&&m.default.createElement(E.Form.Item,{label:t("SECRET")},m.default.createElement(E.Select,{name:"secretName",options:this.secrets,placeholder:" "})),m.default.createElement(E.Form.Item,{label:t("PATH_PL"),rules:[{required:!0,message:t("PATH_EMPTY_DESC")},{validator:this.pathValidator,checkOnSubmit:!0}]},m.default.createElement(y.default,{name:"http.paths",itemType:"object",addText:t("ADD"),checkItemValid:this.checkItemValid},m.default.createElement(g.default,{services:this.props.services}))))}},{key:"render",value:function(){var e=this,a=this.props,r=a.data,n=a.className,l=a.isFederated;return m.default.createElement("div",{className:(0,h.default)(C.default.wrapper,n)},m.default.createElement("div",{className:"h4"},m.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},m.default.createElement(b.ReactComponent,null)),t("SET_ROUTING_RULES")),m.default.createElement("div",{className:C.default.formWrapper},m.default.createElement(E.Form,{ref:this.formRef,data:r},l&&m.default.createElement(E.Form.Group,{label:t("CLUSTER")},m.default.createElement(E.Form.Item,null,m.default.createElement(O.default,{name:"clusters",options:this.clusters,defaultValue:this.defaultClusters,onChange:function(){(0,f.default)(r,"host",""),e.forceUpdate()}}))),m.default.createElement(E.Form.Group,{noWrapper:!0},this.renderForm()))))}},{key:"protocols",get:function(){return[{label:"HTTP",value:"http"},{label:"HTTPS",value:"https"}]}},{key:"secrets",get:function(){return this.props.secrets.map((function(e){return{label:e.name,value:e.name}}))}},{key:"clusters",get:function(){return(0,i.default)(this.props,"projectDetail.clusters",[]).slice()}},{key:"clusterNames",get:function(){var e;return null==this||null===(e=this.clusters)||void 0===e?void 0:e.map((function(e){return e.name}))}},{key:"defaultClusters",get:function(){return(0,i.default)(this.props,"projectDetail.clusters",[]).map((function(e){return e.name}))}},{key:"enableAutoGenerated",get:function(){var e=this.props,t=e.isFederated,a=e.gateway;return!t&&!(0,d.default)(a.defaultIngress)}}]),r}(m.default.Component);a.default=R,R.propTypes={data:v.default.object,secrets:v.default.array,services:v.default.array,gateway:v.default.object,onSave:v.default.func,onCancel:v.default.func},R.defaultProps={data:{},secrets:[],services:[],gateway:{},onSave:function(){},onCancel:function(){}},R.contextTypes={registerSubRoute:v.default.func,resetSubRoute:v.default.func}},,,,,function(e,t,a){e.exports={wrapper:"_3--VX5nESZHibBLwCNMfSL",advance:"_2EJlmbhXorbkEHtrN5QqEi",toggle:"_2S7NwpmHoQs9jxrplqTMLA",customFormItem:"_1u5SUDiQDf_eLXCZDmMJJO",formWrapper:"_2dDLG5BZ_t68ckVmZFy-RR",form:"_2YOPmzRJE1x018vTgrvqht"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(26)),m=n(r(67)),h=n(r(862)),v=n(r(68)),E=r(61),y=r(189),g=n(r(912)),b=n(r(1980));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=function(e){(0,s.default)(n,e);var a,r=S(n);function n(e){var t;return(0,o.default)(this,n),(t=r.call(this,e)).getGateway=(0,u.default)(l.default.mark((function e(){var a,r,n;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.props.isFederated){e.next=9;break}return a=function(){return t.gatewayStore.getGatewayByProject({namespace:t.namespace,cluster:t.cluster})},t.setState({isLoading:!0}),e.next=5,a();case 5:r=e.sent,(n=r[0]||r[1]||r[2]||{}).serviceMeshEnable&&(0,v.default)(t.formTemplate,'metadata.annotations["nginx.ingress.kubernetes.io/service-upstream"]',"true"),t.setState({gateway:n,isLoading:!1});case 9:case"end":return e.stop()}}),e)}))),t.gatewayStore=new g.default,t.state={ingressNameOption:[]},t}return(0,c.default)(n,[{key:"componentDidMount",value:function(){this.getIngressNameOptions()}},{key:"getIngressNameOptions",value:(a=(0,u.default)(l.default.mark((function e(){var t,a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gatewayStore.getNewGatewayByProject({cluster:this.cluster,namespace:this.namespace});case 2:(t=e.sent).length&&this.getGateway(),a=(0,h.default)(t,(function(e){return{label:"".concat(e.ingressClass,"(").concat(e.name,")"),value:e.ingressClass}})),this.setState({ingressNameOption:a});case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this.props.formRef,a=this.state.ingressNameOption;return d.default.createElement(y.Form,{data:this.formTemplate,ref:e},!(0,m.default)(a)&&d.default.createElement(y.Form.Item,{label:t("SELECT_INGRESSCLASSNAME")},d.default.createElement(y.Select,{name:"spec.ingressClassName",options:a})),d.default.createElement(y.Form.Group,{label:t("ADD_METADATA"),desc:t("ROUTE_ADD_METADATA_DESC"),keepDataWhenUnCheck:!0,checkable:!0},d.default.createElement(b.default,null)))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,p.default)(t,E.MODULE_KIND_MAP[a],t)}},{key:"cluster",get:function(){return this.props.cluster}},{key:"namespace",get:function(){return this.props.namespace||(0,p.default)(this.formTemplate,"metadata.namespace")}}]),n}(d.default.Component);a.default=_},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(98),r(99),r(4),r(190),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(98),r(29),r(99),r(4),r(190),r(18),r(43),r(30),r(195),r(11);var l=n(r(97)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(189),p=n(r(956)),m=n(r(829)),h=r(61);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=function(e){(0,c.default)(r,e);var a=v(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).validator=function(e){return!!Object.values(e).some((function(e){return!h.PATTERN_ANNOTATION.test(e)}))&&t("LABEL_VALUE_PATTERN_MESSAGE")},e}return(0,o.default)(r,[{key:"render",value:function(){return f.default.createElement(f.default.Fragment,null,f.default.createElement(d.Form.Item,{label:t("ANNOTATION_PL")},f.default.createElement(p.default,{name:"metadata.annotations",addText:t("ADD"),hiddenKeys:globals.config.preservedAnnotations})),f.default.createElement(d.Form.Item,{label:t("LABEL_PL"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{validator:function(e,a,r){var n=Object.entries(a);0!==n.length?(n.some((function(e){return!(0,l.default)(e,2)[1]}))&&r(t("LABEL_KEY_VALUE_CANNOT_BE_EMPTY")),n.some((function(e){var t=(0,l.default)(e,2)[1];return!h.PATTERN_ANNOTATION.test(t)}))&&r(t("LABEL_VALUE_PATTERN_MESSAGE")),r()):r()}}]},f.default.createElement(m.default,{name:"metadata.labels",addText:t("ADD")})))}}]),r}(f.default.Component);a.default=E},,function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(50)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(31)),d=n(r(0)),p=n(r(1)),m=n(r(5)),h=r(189),v=n(r(798)),E=n(r(1983));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,f.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var S=function(e){var t=e.icon,a=e.image,r=e.title,n=e.desc,l=e.disabled,u=e.onEnter;return d.default.createElement("div",{className:(0,m.default)(E.default.item,(0,f.default)({},E.default.disable,l)),onClick:u},a?d.default.createElement("img",{src:a,alt:""}):d.default.createElement(h.Icon,{name:t,size:40}),d.default.createElement("div",{className:E.default.text},d.default.createElement("div",null,r),d.default.createElement("p",null,n)))},_=function(e){(0,c.default)(r,e);var a=b(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleAppTemplate=function(){var t=e.props,a=t.namespace,r=t.cluster,n=t.workspace,l=t.routing;(0,t.onOk)(),l.push("/apps?workspace=".concat(n,"&cluster=").concat(r,"&namespace=").concat(a))},e.handleAppRepo=function(){var t=e.props,a=t.onOk,r=t.trigger,n=(0,l.default)(t,["onOk","trigger"]);a(),r("openpitrix.app.create",g({trigger:r},n))},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return d.default.createElement(v.default,{width:600,style:{borderRadius:"8px"},onOk:this.handleOk,onCancel:r,visible:a,bodyClassName:E.default.body,hideHeader:!0},d.default.createElement("div",{className:E.default.header},d.default.createElement("div",{className:E.default.logo},d.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/application.svg",alt:""})),d.default.createElement("div",{className:E.default.text},d.default.createElement("h2",null,t("CREATE_APP")),d.default.createElement("p",null,t("CREATE_APP_DESC")))),d.default.createElement("div",{className:E.default.footer},globals.app.enableAppStore&&d.default.createElement(S,{icon:"templet",title:t("FROM_APP_STORE"),desc:t("FROM_APP_STORE_DESC"),onEnter:this.handleAppTemplate}),d.default.createElement(S,{icon:"catalog",title:t("FROM_APP_TEMPLATE"),desc:t("FROM_APP_TEMPLATE_DESC"),onEnter:this.handleAppRepo})))}}]),r}(d.default.Component);a.default=_,_.propTypes={visible:p.default.bool,onOk:p.default.func,onCancel:p.default.func},_.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={body:"Gr8gQYgDKIMOsI5M37h3o",header:"_1yJrBlU6RwumAfyYPHmrRo",logo:"_22CAaRILPr5La-L4xixVEq",text:"h6bCnuvECDoNlWvtM5_1K",footer:"_7fnLunzyyoPWkN1GAVT7z",item:"izUJvf75kVcnxyQZVcShI",enterIcon:"_2ZrtakZD2Dd3fyBqPk6qNI",disable:"_3XkqeG1sF3XM-emDc0NiOz"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(20),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(14),a(4),a(18),a(43),a(11);var l=n(a(317)),u=n(a(25)),o=n(a(28)),c=n(a(41)),s=n(a(42)),i=n(a(37)),f=r(a(0)),d=n(a(26)),p=n(a(140)),m=a(189),h=n(a(841)),v=n(a(2229)),E=n(a(2232));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=function(e){(0,c.default)(a,e);var t=y(a);function a(){return(0,u.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){return f.default.createElement(h.default,this.props,f.default.createElement(m.Select,{className:E.default.schema,name:"scheme",options:this.protocols,defaultValue:"http"}),f.default.createElement(m.Select,{prefixIcon:f.default.createElement(m.Icon,{name:"network-card"}),name:"port",options:this.ports,placeholder:" "}),f.default.createElement(m.Input,{name:"path",defaultValue:"/metrics"}),f.default.createElement(v.default,(0,l.default)({name:"authType",formData:this.props.value},(0,p.default)(this.props,["value","onChange"]))))}},{key:"protocols",get:function(){return[{label:"HTTPS",value:"https"},{label:"HTTP",value:"http"}]}},{key:"ports",get:function(){return(0,d.default)(this.props,"detail.ports",[]).map((function(e){return{label:e.name?"".concat(e.name," (").concat(e.port,")"):e.port,value:e.name||e.port}}))}}]),a}(f.Component);t.default=g},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(44),r(51),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(51),r(29),r(4),r(18),r(43),r(11);var u,o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=l(r(0)),p=r(243),m=n(r(196)),h=r(189),v=n(r(800)),E=n(r(1381)),y=n(r(2231));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=(0,p.observer)(u=function(e){(0,s.default)(r,e);var a=g(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={showForm:!1,authType:e.props.value||""},e.formRef=d.default.createRef(),e.refreshSecrets=function(){var t=e.props,a=t.cluster,r=t.namespace;e.props.secretStore.fetchListByK8s({cluster:a,namespace:r})},e.toggleForm=function(){e.setState((function(e){return{showForm:!e.showForm}}))},e.hideForm=function(){e.setState({showForm:!1})},e.handleTypeChange=function(t){e.setState({authType:t})},e.handleSubmit=function(){var t=e.formRef.current;t&&t.validate((function(){var t=e.state.authType,a=e.props,r=a.value,n=a.formData,l=a.onChange;r&&r!==t&&(0,m.default)(n,r),l(t),e.hideForm()}))},e}return(0,c.default)(r,[{key:"componentDidUpdate",value:function(e,t){this.props.value&&this.props.value!==t.authType&&this.setState({authType:this.props.value||""})}},{key:"renderFormContent",value:function(){var e;switch(this.state.authType){case"":e=d.default.createElement(h.Alert,{type:"info",message:t("NO_AUTHENTICATION_TIP")});break;case"tlsConfig":e=d.default.createElement("div",null,d.default.createElement(h.Form.Item,{label:t("CERTIFICATE_AUTHORITY")},d.default.createElement(E.default,{name:"tlsConfig.ca.secret",secrets:this.secrets})),d.default.createElement(h.Form.Item,{label:t("CERTIFICATE")},d.default.createElement(E.default,{name:"tlsConfig.cert.secret",secrets:this.secrets})),d.default.createElement(h.Form.Item,{label:t("PRIVATE_KEY")},d.default.createElement(E.default,{name:"tlsConfig.keySecret",secrets:this.secrets})),d.default.createElement(h.Form.Item,{label:t("SERVER_NAME")},d.default.createElement(h.Input,{name:"tlsConfig.serverName"})),d.default.createElement(h.Form.Item,null,d.default.createElement(h.Checkbox,{name:"tlsConfig.insecretSkipVerify"},t("SKIP_TLS_VERFICATION"))));break;case"bearerTokenSecret":e=d.default.createElement("div",null,d.default.createElement(h.Form.Item,{label:t("TOKEN")},d.default.createElement(E.default,{name:"bearerTokenSecret",secrets:this.secrets})));break;case"basicAuth":e=d.default.createElement("div",null,d.default.createElement(h.Form.Item,{label:t("USERNAME")},d.default.createElement(E.default,{name:"basicAuth.username",secrets:this.secrets})),d.default.createElement(h.Form.Item,{label:t("PASSWORD")},d.default.createElement(E.default,{name:"basicAuth.password",secrets:this.secrets})))}return e}},{key:"renderFormFooter",value:function(){return d.default.createElement("div",{className:y.default.footer},d.default.createElement(h.Button,{onClick:this.hideForm},t("CANCEL")),d.default.createElement(h.Button,{type:"control",onClick:this.handleSubmit},t("OK")))}},{key:"renderForm",value:function(){var e=this.props.formData,a=this.state.authType;return d.default.createElement(d.default.Fragment,null,d.default.createElement("div",{className:y.default.form},d.default.createElement(v.default,{className:"margin-b12",title:t("SELECT_AUTHENTICATION_METHOD"),description:t("SELECT_AUTHENTICATION_METHOD_DESC")}),d.default.createElement("div",{className:"margin-b12"},d.default.createElement(h.RadioGroup,{mode:"button",value:a,options:this.authTypes,onChange:this.handleTypeChange})),d.default.createElement(h.Form,{type:"inner",data:e,ref:this.formRef},a&&d.default.createElement(h.Alert,{type:"default",className:"margin-b12",message:d.default.createElement("div",{className:y.default.secrets},d.default.createElement("a",{href:this.secretLink,target:"_blank",rel:"noopener noreferrer"},t("CREATE_A_NEW_SECRET"))," ","or"," ",d.default.createElement("a",{onClick:this.refreshSecrets},t("REFRESH_SECRETS")))}),d.default.createElement("div",{className:y.default.formContent},this.renderFormContent()))),this.renderFormFooter())}},{key:"render",value:function(){var e=this.props.value,a=void 0===e?"":e,r=this.authTypes.find((function(e){return e.value===a}));return d.default.createElement("div",{className:y.default.wrapper},d.default.createElement("div",{className:y.default.value,onClick:this.toggleForm},d.default.createElement(h.Icon,{className:y.default.prefix,name:"ssh"}),d.default.createElement("div",{className:y.default.text},t(r.label))),this.state.showForm&&d.default.createElement("div",{className:y.default.dropdown},this.renderForm()))}},{key:"authTypes",get:function(){return[{label:t("NO_AUTHENTICATION_TCAP"),value:""},{label:t("TLS"),value:"tlsConfig"},{label:t("BEARER_TOKEN_TCAP"),value:"bearerTokenSecret"},{label:t("BASIC_AUTHENTICATION_TCAP"),value:"basicAuth"}]}},{key:"secrets",get:function(){return this.props.secretStore.list.data.slice()}},{key:"secretLink",get:function(){var e=this.props,t=e.workspace,a=e.cluster,r=e.namespace;return"/".concat(t,"/clusters/").concat(a,"/projects/").concat(r,"/secrets")}}]),r}(d.Component))||u;a.default=b},function(e,t,a){e.exports={wrapper:"_7-12p6hcf7X0VthZc5rST"}},function(e,t,a){e.exports={wrapper:"QFLj8UnuHwB8eUvkccuQO",value:"_1N3EbBmVGw449bdtrhZ9tA",active:"_2Nqy5ogxFN8C1LiYg5mwvj",text:"_3TeYR97weviqqH5XNXDNd0",prefix:"qk7WG_i0cGpwd6nhbE0B1",close:"_2tJdLwTubLfIfkXCaMogNv",dropdown:"_1ixGABFhWGnoUHB1rZ2edU",form:"_3DeozV-jza89lR4S6N5UMv",formContent:"_1yrx5rcOi0RSiXneA38jJl",footer:"_1IsQznBkKj9Aj3RhiKr9n",secrets:"_1_J1EL6cHSGETRmetccLEt"}},function(e,t,a){e.exports={schema:"vTyPh-gfAQzV7xLNRFuD6"}},function(e,t,a){e.exports={wrapper:"_3oru1UiNeJWJ7CnfkFN0qI",timeout:"_3aAyTK47_-9SBJRbv5ouVP",endpoints:"_3mSGWi2nNaTPXqvGwCMpCg"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(140)),f=n(r(68)),d=n(r(191)),p=n(r(798)),m=n(r(819)),h=n(r(2235)),v=n(r(438)),E=n(r(2317)),y=r(2318);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S={"app.template.create":{on:function(e){var a,r=e.store,n=e.cluster,o=e.workspace,f=e.success,h=(0,c.default)(e,["store","cluster","workspace","success"]),g=v.default.apptemplates({workspace:o}),S=new E.default,_=p.default.open(b({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,c,m,h,E,y;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,s.default)(a,"metadata.name"),o=(0,i.default)(a,["spec","totalReplicas"]),c=(0,s.default)(a,"spec"),m=null==a?void 0:a.version,h=v.default.apptemplateversions({name:u,version:m}),E={version:m,deploymentSpec:c},y=b(b({},h),{},{spec:E}),e.next=9,S.create({cluster:n},y);case 9:return e.next=11,r.create({cluster:n},o);case 11:d.default.success({content:t("CREATE_SUCCESSFUL")}),f&&f(),p.default.close(_);case 14:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,module:"apptemplates",cluster:n,workspace:o,title:t("CREATE_EDGE_APP_TEMPLATE"),formTemplate:g,onlyDockerHub:!0,modal:m.default,steps:y.APP_TEMPLATES_FORM},h))}},"app.template.version.create":{on:function(e){var a,r=e.isEdit,n=e.cluster,o=e.formTemplate,g=e.templateName,S=(e.workspace,e.success),_=(0,c.default)(e,["isEdit","cluster","formTemplate","templateName","workspace","success"]),O="apptemplateversions",C=new E.default,T=o||v.default[O]({name:g}),R=p.default.open(b({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,c,m,h,v,E;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,s.default)(a,"spec"),c=(0,s.default)(a,"spec.version"),m="".concat(g,"-").concat(c),h=(0,i.default)(o,["version","deploymentSpec"]),v={version:c,deploymentSpec:h},(0,f.default)(a,"metadata.name",m),(0,f.default)(a,["metadata","labels","apps.edgewize.io/apptemplateversion"],c),E=b(b({},a),{},{spec:v}),e.next=10,null===(u=C[r?"patch":"create"])||void 0===u?void 0:u.call(C,{cluster:n},E);case 10:d.default.success({content:r?t("UPDATE_SUCCESSFUL"):t("CREATE_SUCCESSFUL")}),S&&S(),p.default.close(R);case 13:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:C,module:O,cluster:n,title:t("CREATE_APP_TEMPLATE_VERSION"),formTemplate:T,onlyDockerHub:!0,modal:m.default,replicasExtraControl:h.default,steps:y.APP_TEMPLATE_VERSION_FORM,isEdit:r},_))}}};a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(0)),u=n(r(1382)),o=r(189),c=function(e){var a=e.isEdit;return l.default.createElement(o.Form.Item,{label:t("APP_TEMPLATE_VERSION"),desc:t("APP_TEMPLATE_VERSION_DESC"),rules:[{required:!0,message:t("APP_TEMPLATE_VERSION_EMPTY_DESC")},{validator:function(e,a,r){return a?u.default.isSemVer(a)?void r():r({message:t("INVALID_APP_TEMPLATE_VERSION_DESC",{message:t("APP_TEMPLATE_VERSION_DESC")}),field:e.field}):r()}}]},l.default.createElement(o.Input,{name:"spec.version",maxLength:63,disabled:a}))};a.default=c},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(20),a(14),a(24),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(29),a(14),a(24),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(7);var n=r(a(38)),l=r(a(58)),u=r(a(31)),o=r(a(50));a(35);var c,s=r(a(39)),i=r(a(25)),f=r(a(28)),d=r(a(41)),p=r(a(42)),m=r(a(37)),h=r(a(45)),v=r(a(26)),E=a(17);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var S=(c=function(e){(0,d.default)(r,e);var t,a=b(r);function r(){var e;(0,i.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).module="apptemplateversions",e.getUrl=function(t){var a=t.cluster,r=void 0===a?"":a,n=t.name,l=void 0===n?"":n;return"/apis".concat(r&&"/clusters/".concat(r),"/apps.edgewize.io/v1alpha1/").concat(e.module).concat(l&&"/".concat(l))},e}return(0,f.default)(r,[{key:"fetchList",value:(t=(0,s.default)(n.default.mark((function e(){var t,a,r,u,c,s,i,f,d=this,p=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},a=t.cluster,r=t.workspace,u=t.namespace,c=t.more,t.devops,s=(0,o.default)(t,["cluster","workspace","namespace","more","devops"]),this.list.isLoading=!0,s.limit=s.limit||10,s.sortBy="createTime",e.next=6,request.get(this.getUrl({cluster:a,workspace:r}),s);case 6:return i=e.sent,f=(0,v.default)(i,"items",[]).map((function(e){return g({cluster:a,namespace:u,workspace:r},d.mapper(e))})),this.list.update(g(g({data:c?[].concat((0,l.default)(this.list.data),(0,l.default)(f)):f,total:i.totalItems||i.totalCount||i.total_count||f.length||0},s),{},{limit:Number(s.limit)||10,page:Number(s.page)||1,isLoading:!1},this.list.silent?{}:{selectedRowKeys:[]})),e.abrupt("return",f);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"create",value:function(e,t){var a=e.cluster,r=(0,v.default)(t,"metadata.name"),n=this.getUrl({cluster:a,name:r});return this.submitting(request.post(n,t))}},{key:"patch",value:function(e,t){var a=e.cluster,r=(0,v.default)(t,"metadata.name"),n=this.getUrl({cluster:a,name:r});return request.patch(n,t)}},{key:"delete",value:function(e){var t=e.cluster,a=e.name,r=this.getUrl({cluster:t,name:a});return this.submitting(request.delete(r))}}]),r}(r(a(49)).default),(0,h.default)(c.prototype,"fetchList",[E.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchList"),c.prototype),(0,h.default)(c.prototype,"create",[E.action],Object.getOwnPropertyDescriptor(c.prototype,"create"),c.prototype),(0,h.default)(c.prototype,"patch",[E.action],Object.getOwnPropertyDescriptor(c.prototype,"patch"),c.prototype),(0,h.default)(c.prototype,"delete",[E.action],Object.getOwnPropertyDescriptor(c.prototype,"delete"),c.prototype),c);t.default=S},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.APP_TEMPLATE_VERSION_FORM=t.APP_TEMPLATES_FORM=void 0;var n=r(a(2319)),l=r(a(900)),u=[{title:"BASIC_INFORMATION",icon:"cdn",component:n.default,required:!0},{title:"POD_SETTINGS",icon:"docker",component:l.default,required:!0}];t.APP_TEMPLATES_FORM=u;var o=[{title:"BASIC_INFORMATION",icon:"cdn",component:l.default,required:!0}];t.APP_TEMPLATE_VERSION_FORM=o},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=r(243),m=r(189),h=r(61),v=n(r(1382));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=(0,p.observer)(l=function(e){(0,c.default)(r,e);var a=E(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).nameValidator=function(a,r,n){if(!r)return n();var l=e.props,u=l.cluster,o=l.workspace;l.store.checkName({name:r,workspace:o,cluster:u}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e.versionValidator=function(e,a,r){return a?v.default.isSemVer(a)?void r():r({message:t("INVALID_APP_TEMPLATE_VERSION_DESC",{message:t("APP_TEMPLATE_VERSION_DESC")}),field:e.field}):r()},e}return(0,o.default)(r,[{key:"render",value:function(){var e,a,r=this.props,n=r.formRef,l=r.maxNameLength,u=void 0===l?253:l,o=253===u?t("LONG_NAME_DESC"):t("NAME_DESC");return f.default.createElement(m.Form,{data:this.formTemplate,ref:n},f.default.createElement(m.Columns,null,f.default.createElement(m.Column,null,f.default.createElement(m.Form.Item,{label:t("NAME"),desc:o,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:h.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:o})},{validator:this.nameValidator}]},f.default.createElement(m.Input,{name:"metadata.name",disabled:!!(null===(e=this.props.formTemplate)||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.name),maxLength:u,autoFocus:!0}))),f.default.createElement(m.Column,null,f.default.createElement(m.Form.Item,{label:t("APP_TEMPLATE_VERSION"),desc:t("APP_TEMPLATE_VERSION_DESC"),rules:[{required:!0,message:t("APP_TEMPLATE_VERSION_EMPTY_DESC")},{validator:this.versionValidator}]},f.default.createElement(m.Input,{name:"version",maxLength:63,placeholder:t("APP_TEMPLATE_VERSION_DESC")})))),f.default.createElement(m.Columns,null,f.default.createElement(m.Column,null,f.default.createElement(m.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_DESC")},f.default.createElement(m.Input,{name:["metadata","annotations","kubesphere.io/alias-name"],maxLength:63}))),f.default.createElement(m.Column,null,f.default.createElement(m.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},f.default.createElement(m.TextArea,{name:["metadata","annotations","kubesphere.io/description"],maxLength:256})))))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,h.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,d.default)(this.formTemplate,"spec.template"):this.formTemplate}}]),r}(f.default.Component))||l;a.default=y},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(87),r(99),r(8),r(13),r(9),r(30),r(73),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(70),r(27),r(87),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(21),r(30),r(73),r(69),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(819)),i=r(2321),f=n(r(798)),d=n(r(2328)),p=n(r(191)),m=n(r(2330)),h=n(r(438)),v=n(r(68)),E=n(r(67)),y=n(r(119)),g=r(17);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _={"cd.create":{on:function(e){var a,r=e.store,n=e.cluster,d=(e.workspace,e.module),m=e.success,y=(0,c.default)(e,["store","cluster","workspace","module","success"]),g=h.default[d](),b=f.default.open(S({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,c,s,i,d;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=a.syncPolicy.type,c="automated"===u?(0,o.default)({},u,{prune:a.syncPolicy.prune,selfHeal:a.syncPolicy.selfHeal}):(0,o.default)({},u,{}),s=S({repoURL:a.repoURL.match(/\(([\w\W]+)\)/)[1]},a.source),i=(0,E.default)(a.syncOptions)?void 0:Object.entries(a.syncOptions).reduce((function(e,t){var a="".concat(t[0],"=").concat(t[1]);return e.push(a),e}),[]),c.syncOptions=i,d={destination:a.destination,source:s,syncPolicy:c},(0,v.default)(g,"metadata",a.metadata),(0,v.default)(g,"spec.argoApp.spec",d),e.next=10,r.create({data:g,devops:y.devops,cluster:n});case 10:p.default.success({content:t("CREATE_SUCCESSFUL")}),m&&m(),f.default.close(b);case 13:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,module:d,cluster:n,formTemplate:{},modal:s.default,steps:i.CD_FORM},y))}},"cd.sync":{on:function(e){var a,r=e.store,n=e.cluster,o=(e.workspace,e.module),s=e.success,i=e.formTemplate,m=e.application,h=(0,c.default)(e,["store","cluster","workspace","module","success","formTemplate","application"]),g=f.default.open(S(S({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,y.default)(a),o=(0,E.default)(u.syncOptions)?void 0:Object.entries(u.syncOptions).reduce((function(e,t){var a="".concat(t[0],"=").concat(t[1]);return e.push(a),e}),[]),(0,v.default)(u,"syncOptions",o),(0,v.default)(u,"revision",a.repoSource.targetRevision),e.next=6,r.updateSync({data:u,devops:h.devops,cluster:n,application:m});case 6:p.default.success({content:t("SYNC_TRIGGERED")}),s&&s(),f.default.close(g);case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r},h),{},{module:o,cluster:n,formTemplate:i,modal:d.default},h))}},"cd.delete":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=f.default.open(S({onOk:function(){f.default.close(u),p.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n()},store:a,modal:m.default,resource:r},l))}},"cd.batch.delete":{on:function(e){var a=e.store,r=e.success,n=e.rowKey,l=void 0===n?"name":n,u=(0,c.default)(e,["store","success","rowKey"]),o=(0,g.toJS)(a.list),s=o.data,i=o.selectedRowKeys,d=s.filter((function(e){return i.includes(e[l])}));if(!(0,E.default)(d))var h=f.default.open(S({onOk:function(){f.default.close(h),p.default.success({content:t("DELETED_SUCCESSFULLY")}),r&&r()},modal:m.default,resource:d,store:a},u))}}};a.default=_},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.CD_FORM=void 0;var n=r(a(2322)),l=r(a(2325)),u=r(a(2327)),o=[{title:"BASIC_INFORMATION",component:n.default,required:!0},{title:"CODE_REPOSITORY_SETTINGS",component:l.default,required:!0,icon:"code"},{title:"SYNC_SETTINGS",component:u.default,required:!0,icon:"timed-task"}];t.CD_FORM=o},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(38)),o=n(r(31));r(35);var c=n(r(39)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=r(189),h=n(r(0)),v=n(r(1054)),E=r(61),y=n(r(1400)),g=n(r(2323));function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var O=function(e){(0,f.default)(r,e);var a=_(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).codeStore=new v.default,e.state={options:[]},e.getRepoList=function(){var t=(0,c.default)(u.default.mark((function t(a){var r,n,l,o;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props,n=r.devops,l=r.cluster,t.next=3,e.codeStore.fetchList(S({devops:n,cluster:l},a));case 3:o=e.codeStore.list.data.map((function(e){return{label:e.name,value:"".concat(e.name,"(").concat(e.repoURL,")"),icon:"bitbucket_server"===e.provider?"bitbucket":e.provider}})),e.setState({options:o});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.repoOptionRenderer=function(e){return function(t){return h.default.createElement("span",{className:y.default.option},h.default.createElement(m.Icon,{name:e.icon,type:"value"===t?"dark":"light"}),h.default.createElement("span",null,e.value))}},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.getRepoList()}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate;return h.default.createElement(m.Form,{ref:a,data:r},h.default.createElement(m.Columns,null,h.default.createElement(m.Column,null,h.default.createElement(m.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:E.PATTERN_NAME,message:t("INVALID_NAME_DESC")}]},h.default.createElement(m.Input,{name:"metadata.name",maxLength:63})),h.default.createElement(m.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},h.default.createElement(m.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256}))),h.default.createElement(m.Column,null,h.default.createElement(m.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:E.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},h.default.createElement(m.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),h.default.createElement("div",{className:y.default.wrapper},h.default.createElement("h6",null,t("DEPLOY_LOCATION")),h.default.createElement("div",{className:y.default.wrapper_item},h.default.createElement(m.Form.Item,{rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")}]},h.default.createElement(g.default,(0,l.default)({name:"destination",prefix:"destination",formData:r},this.props))))))}}]),r}(h.default.Component);a.default=O},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(44),r(6),r(20),r(14),r(138),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var u=n(r(38)),o=n(r(31));r(35);var c,s,i,f,d=n(r(39)),p=n(r(62)),m=n(r(25)),h=n(r(28)),v=n(r(74)),E=n(r(41)),y=n(r(42)),g=n(r(37)),b=n(r(45)),S=(n(r(63)),r(189)),_=n(r(5)),O=n(r(800)),C=n(r(840)),T=n(r(119)),R=n(r(26)),D=n(r(244)),k=n(r(68)),N=r(17),I=r(243),P=l(r(0)),A=n(r(441)),w=r(56),L=n(r(2324));function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,g.default)(e);if(t){var n=(0,g.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,y.default)(this,a)}}var U=(0,I.observer)((s=function(e){(0,E.default)(l,e);var a,r,n=j(l);function l(){var e;(0,m.default)(this,l);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=n.call.apply(n,[this].concat(r))).state={showForm:!1,initializing:!0,oldFormDate:{},name:""},(0,p.default)(e,"formData",i,(0,v.default)(e)),e.formRef=P.default.createRef(),e.cdStore=e.props.store,e.projectStore=new A.default,e.fetchNamespaces=(0,d.default)(u.default.mark((function t(){var a,r,n,l=arguments;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>0&&void 0!==l[0]?l[0]:{},r=(0,R.default)(e.formData,"".concat(e.prefix,".name"),""),n=(0,w.inCluster2Default)(r),t.next=5,e.projectStore.fetchList(x(x({},a),{},{cluster:n,type:"user"}));case 5:case"end":return t.stop()}}),t)}))),e.handleClusterChange=function(t){e.fetchNamespaces(),e.setState({name:t});var a=e.clusters.find((function(e){return e.value===t})).server;(0,k.default)(e.formData,"".concat(e.prefix,".server"),a),(0,k.default)(e.formData,"".concat(e.prefix,".namespace"),"")},e.handleSubmit=function(){var t=e.formRef.current;t&&t.validate((function(){Object.assign(e.props.formData,x({},e.formData)),e.setState({showForm:!1,oldFormDate:(0,N.toJS)(e.formData)})}))},e.showForm=function(){e.setState({showForm:!0})},(0,p.default)(e,"hideForm",f,(0,v.default)(e)),e.projectOptionRenderer=function(e){return P.default.createElement("span",{className:L.default.option},e.isFedManaged?P.default.createElement("img",{className:L.default.indicator,src:"/extensions-static/ks-console-embed/dist/v3dist/assets/cluster.svg"}):P.default.createElement(S.Icon,{name:"project"}),e.label,e.isFedManaged&&P.default.createElement(S.Tooltip,{content:t("FEDPROJECT_CANNOT_DEPLOY_APP_TIP")},P.default.createElement(S.Icon,{className:L.default.tip,name:"question"})))},e}return(0,h.default)(l,[{key:"componentDidMount",value:function(){this.init()}},{key:"init",value:(r=(0,d.default)(u.default.mark((function e(){var t,a,r,n,l,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({initializing:!0}),t=this.formData["".concat(this.prefix)]||{},a=t.cluster,r=t.server,n=t.namespace,e.next=4,this.fetchClusters();case 4:return a?!r&&a&&(l=this.clusters.find((function(e){return e.value===a})),(0,k.default)(this.formData,"".concat(this.prefix,".name"),(0,R.default)(this.clusters,l.value)),(0,k.default)(this.formData,"".concat(this.prefix,".server"),(0,R.default)(this.clusters,l.server))):((0,k.default)(this.formData,"".concat(this.prefix,".name"),(0,R.default)(this.clusters,"[0].value")),(0,k.default)(this.formData,"".concat(this.prefix,".server"),(0,R.default)(this.clusters,"[0].server"))),e.next=7,this.fetchNamespaces();case 7:n||(o=this.namespaces.find((function(e){return!e.disabled}))||{},(0,k.default)(this.formData,"".concat(this.prefix,".namespace"),o.value||"")),Object.assign(this.props.formData,this.formData),this.setState({initializing:!1,oldFormDate:(0,T.default)((0,N.toJS)(this.formData))});case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"fetchClusters",value:(a=(0,d.default)(u.default.mark((function e(){var t;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.cluster,e.next=3,this.cdStore.getClustersList(t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderPlacement",value:function(){var e=this.props.formData["".concat(this.prefix)]||{},a=(0,w.inCluster2Default)(e.name);return P.default.createElement("div",{className:L.default.placement},P.default.createElement(O.default,{icon:"cluster",title:(0,w.showNameAndAlias)(a,"cluster"),description:t("CLUSTER")}),P.default.createElement(O.default,{icon:"project",title:(0,w.showNameAndAlias)(e.namespace,"project",{cluster:a}),description:t("PROJECT")}),P.default.createElement(S.Icon,{className:L.default.icon,name:"chevron-down",size:20}))}},{key:"renderForm",value:function(){return P.default.createElement("div",{className:L.default.form},P.default.createElement(S.Form,{ref:this.formRef,type:"inner",data:this.formData},P.default.createElement(S.Columns,null,P.default.createElement(S.Column,null,P.default.createElement(S.Form.Item,{label:t("CLUSTER")},P.default.createElement(S.Select,{name:"".concat(this.prefix,".name"),key:this.state.name,placeholder:" ",options:this.clusters,onChange:this.handleClusterChange,prefixIcon:P.default.createElement(S.Icon,{name:"cluster",size:16}),disabled:!globals.app.isMultiCluster,showTip:!0}))),P.default.createElement(S.Column,null,P.default.createElement(S.Form.Item,{label:t("PROJECT"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")}]},P.default.createElement(S.Select,{name:"".concat(this.prefix,".namespace"),placeholder:" ",options:this.namespaces,pagination:(0,D.default)(this.projectStore.list,["page","limit","total"]),isLoading:this.projectStore.list.isLoading,onFetch:this.fetchNamespaces,valueRenderer:this.projectOptionRenderer,optionRenderer:this.projectOptionRenderer,searchable:!0,clearable:!0}))))),P.default.createElement(C.default,{className:L.default.confirm,onOk:this.handleSubmit,onCancel:this.hideForm}))}},{key:"render",value:function(){var e=this.state,a=e.showForm,r=e.initializing;if(a)return this.renderForm();var n=(0,R.default)(this.formData,"".concat(this.prefix,".namespace"),"");return P.default.createElement("div",{className:(0,_.default)(L.default.wrapper,(0,o.default)({},L.default.expand,a)),onClick:this.showForm},n?this.renderPlacement():P.default.createElement("div",{className:L.default.placeholder},r?P.default.createElement(S.Loading,{className:"text-center"}):t("PROJECT_NOT_SELECT_DESC")))}},{key:"prefix",get:function(){return"".concat(this.props.prefix)}},{key:"clusters",get:function(){return this.cdStore.clustersList.map((function(e){return{label:(0,w.showNameAndAlias)((0,w.inCluster2Default)(e.name),"cluster"),value:e.name,server:e.server}}))}},{key:"namespaces",get:function(){return this.projectStore.list.data.filter((function(e){return"Terminating"!==e.status})).map((function(e){return{label:(0,w.showNameAndAlias)(e),value:e.name,disabled:e.isFedManaged||e.isFedHostNamespace,isFedManaged:e.isFedManaged||e.isFedHostNamespace}}))}}]),l}(P.Component),i=(0,b.default)(s.prototype,"formData",[N.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),(0,b.default)(s.prototype,"clusters",[N.computed],Object.getOwnPropertyDescriptor(s.prototype,"clusters"),s.prototype),(0,b.default)(s.prototype,"namespaces",[N.computed],Object.getOwnPropertyDescriptor(s.prototype,"namespaces"),s.prototype),f=(0,b.default)(s.prototype,"hideForm",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.setState({showForm:!1},(function(){e.formData=e.state.oldFormDate,Object.assign(e.props.formData,x({},e.formData))}))}}}),c=s))||c;a.default=U},function(e,t,a){e.exports={wrapper:"_3z2Z9hMemOOjjGphBi-8sh",placeholder:"KK7SUBB92n4Wwek-F2DYR",form:"_3pVLZicpx-Rbr0egCKsLK",confirm:"DslrrnKn_QmqZZLCpJxuA",placement:"_2Q-2XDFS-FUOb9mjjlCrYc",icon:"_1HSRuvA-86V8m58eHsUJvR",option:"Dxyd1qFSZm73dPMUuSqdc",tip:"_3S0tzXh5APNgwIS8ONi0s1"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(38)),u=n(r(31));r(35);var o=n(r(39)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(244)),h=r(189),v=n(r(1054)),E=n(r(2326));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=function(e){(0,i.default)(r,e);var a=b(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).codeStore=new v.default,e.state={options:[]},e.getRepoList=function(){var t=(0,o.default)(l.default.mark((function t(a){var r,n,u,o;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props,n=r.devops,u=r.cluster,t.next=3,e.codeStore.fetchList(g({devops:n,cluster:u},a));case 3:o=e.codeStore.list.data.map((function(e){return{label:e.name,value:"".concat(e.name,"(").concat(e.repoURL,")"),icon:"bitbucket_server"===e.provider?"bitbucket":e.provider}})),e.setState({options:o});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.repoOptionRenderer=function(e){return function(t){return p.default.createElement("span",{className:E.default.option},p.default.createElement(h.Icon,{name:e.icon,type:"value"===t?"dark":"light"}),p.default.createElement("span",null,e.value))}},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.getRepoList()}},{key:"render",value:function(){var e=this,a=this.props,r=a.formRef,n=a.formTemplate;return p.default.createElement(h.Form,{data:n,ref:r},p.default.createElement(h.Form.Item,{label:t("CODE_REPOSITORY"),rules:[{required:!0,message:t("REPO_EMPTY_DESC")}]},p.default.createElement(h.Select,{name:"repoURL",options:this.state.options,valueRenderer:function(t){return e.repoOptionRenderer(t)("value")},optionRenderer:function(t){return e.repoOptionRenderer(t)("option")},pagination:(0,m.default)(this.codeStore.list,["page","limit","total"]),isLoading:this.codeStore.list.isLoading,onFetch:this.getRepoList,searchable:!0,clearable:!0})),p.default.createElement(h.Form.Item,null,p.default.createElement(h.Columns,null,p.default.createElement(h.Column,null,p.default.createElement(h.Form.Item,{label:t("REVISION"),desc:t("REVISIONS_DESC")},p.default.createElement(h.Input,{name:"source.targetRevision",defaultValue:"HEAD"}))),p.default.createElement(h.Column,null,p.default.createElement(h.Form.Item,{label:t("MANIFEST_FILE_PATH"),desc:t("MANIFEST_FILE_PATH_DESC")},p.default.createElement(h.Input,{name:"source.path",defaultValue:"."}))))))}}]),r}(p.default.Component);a.default=S},function(e,t,a){e.exports={option:"_15uAGEdI1ccU0Ut3vp8560"}},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=r(189),m=n(r(827)),h=r(61),v=n(r(26)),E=n(r(68)),y=n(r(1400));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=function(e){(0,s.default)(r,e);var a=g(r);function r(){var e;(0,o.default)(this,r);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=a.call.apply(a,[this].concat(c))).handleCheckboxChange=function(t){return function(a){var r=e.props.formTemplate;(0,E.default)(r,t,a),e.forceUpdate()}},e.handleChange=function(t){var a=e.props.formTemplate;(0,E.default)(a,"syncPolicy.type",t),e.forceUpdate()},e.handlePruneChange=function(t){var a=e.props.formTemplate;(0,E.default)(a,"syncOptions.PrunePropagationPolicy",t),e.forceUpdate()},e.handleReplace=function(t){var a=e.props.formTemplate;(0,E.default)(a,"syncOptions.Replace",t),e.forceUpdate()},e.renderCheckboxItem=function(a){var r=a.title,n=a.desc,o=a.name,c=a.displayTitle,s=a.displayDesc,i=(0,u.default)(a,["title","desc","name","displayTitle","displayDesc"]);return d.default.createElement(p.Form.Item,{key:o},d.default.createElement("div",{className:y.default.checkbox_item},d.default.createElement(p.Checkbox,(0,l.default)({name:o,checked:(0,v.default)(e.props.formTemplate,o,!1),onChange:e.handleCheckboxChange(o)},i)),d.default.createElement("div",{className:y.default.checkbox_item_info},d.default.createElement("p",null,null!=c?c:t(r)),d.default.createElement("span",null,null!=s?s:t(n)))))},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate;return d.default.createElement(p.Form,{data:r,ref:a},d.default.createElement("div",{className:y.default.wrapper},d.default.createElement("h6",null,t("SYNC_STRATEGY_TCAP")),d.default.createElement("div",{className:y.default.wrapper_item},d.default.createElement("div",{className:y.default.wrapper_item_com},d.default.createElement(p.Form.Item,null,d.default.createElement(m.default,{name:"syncPolicy.type",defaultValue:"manual",options:this.syncOptions,onChange:this.handleChange}))),"automated"===this.syncPolicyType&&d.default.createElement("div",{className:y.default.columns},this.syncPolicyTypeOptions.map(this.renderCheckboxItem)))),d.default.createElement("div",{className:y.default.wrapper},d.default.createElement("h6",null,t("SYNC_SETTINGS")),d.default.createElement("div",{className:y.default.wrapper_item},d.default.createElement("div",{className:"".concat(y.default.columns," ").concat(y.default.wrapper_item_com)},this.syncOptionsOptions.map(this.renderCheckboxItem)),d.default.createElement(p.Form.Item,{label:t("PRUNE_PROPAGATION_POLICY")},d.default.createElement(m.default,{name:"syncOptions.PrunePropagationPolicy",defaultValue:"foreground",options:this.prunePropagationPolicyOptions,onChange:this.handlePruneChange})),d.default.createElement(p.Form.Item,null,d.default.createElement("div",{className:y.default.checkbox_item},d.default.createElement(p.Checkbox,{name:"syncOptions.Replace",checked:this.getReplace,onChange:this.handleReplace}),d.default.createElement("div",{className:y.default.checkbox_item_info},d.default.createElement("p",null,t("REPLACE_RESOURCE")),d.default.createElement("span",null,t("REPLACE_RESOURCE_DESC"))))))))}},{key:"syncPolicyTypeOptions",get:function(){return[{title:"PRUNE_RESOURCES",desc:"PRUNE_RESOURCES_DESC",name:"syncPolicy.prune"},{title:"SELF_HEAL",desc:"SELF_HEAL_DESC",name:"syncPolicy.selfHeal"}]}},{key:"syncOptionsOptions",get:function(){return[{title:"SKIP_SCHEMA_VALIDATION",desc:"SKIP_SCHEMA_VALIDATION_DESC",name:"syncOptions.Validate"},{title:"AUTO_CREATE_PROJECT",desc:"AUTO_CREATE_PROJECT_DESC",name:"syncOptions.CreateNamespace"},{title:"PRUNE_LAST",desc:"PRUNE_LAST_DESC",name:"syncOptions.PruneLast"},{title:"APPLY_OUT_OF_SYNC_ONLY",desc:"APPLY_OUT_OF_SYNC_ONLY_DESC",name:"syncOptions.ApplyOutOfSyncOnly"}]}},{key:"prunePropagationPolicyOptions",get:function(){return[{label:"foreground",value:"foreground",description:t("FOREGROUND_DESC")},{label:"background",value:"background",description:t("BACKGROUND_DESC")},{label:"orphan",value:"orphan",description:t("ORPHAN_DESC")}]}},{key:"syncPolicyType",get:function(){var e,t,a=this.props.formTemplate;return null!==(e=null==a||null===(t=a.syncPolicy)||void 0===t?void 0:t.type)&&void 0!==e?e:"manual"}},{key:"syncOptions",get:function(){return h.SYNC_STRATEGY.map((function(e){var a=e.label,r=e.value,n=e.description;return{label:t(a),description:t(n),icon:"timed-task",value:r}}))}},{key:"getReplace",get:function(){var e=this.props.formTemplate;return(0,v.default)(e,"syncOptions.Replace",!1)}}]),r}(d.default.Component);a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(243),h=n(r(1)),v=r(189),E=n(r(798)),y=n(r(26)),g=n(r(68)),b=r(61),S=n(r(2329));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=(0,m.observer)((o=u=function(e){(0,i.default)(r,e);var a=_(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).form=p.default.createRef(),e.handleSubmit=function(){(0,e.props.onOk)(e.form.current.getData())},e.handleCheckboxChange=function(t){return function(a){var r=e.props.formTemplate;(0,g.default)(r,t,a),e.forceUpdate()}},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.title,r=e.visible,n=e.onCancel,l=e.formTemplate;return p.default.createElement(E.default,{width:960,title:a||t("CREATE_ROLE"),onCancel:n,onOk:this.handleSubmit,visible:r},p.default.createElement(v.Form,{ref:this.form,data:l},p.default.createElement("div",{className:S.default.columns},p.default.createElement("div",{className:S.default.column},p.default.createElement(v.Form.Item,{label:t("CODE_REPOSITORY_URL")},p.default.createElement(v.Input,{name:"repoSource.repoURL",disabled:!0}))),p.default.createElement("div",{className:S.default.column},p.default.createElement(v.Form.Item,{label:t("REVISION"),desc:t("REVISION_DESC")},p.default.createElement(v.Input,{name:"repoSource.targetRevision"})))),p.default.createElement("div",{className:S.default.columns},p.default.createElement("div",{className:"".concat(S.default.column," ").concat(S.default.column_card)},p.default.createElement(v.Form.Item,null,p.default.createElement(v.Checkbox,{name:"prune",checked:(0,y.default)(l,"prune",!1),onChange:this.handleCheckboxChange("prune")},t("PRUNE")))),p.default.createElement("div",{className:"".concat(S.default.column," ").concat(S.default.column_card)},p.default.createElement(v.Form.Item,null,p.default.createElement(v.Checkbox,{name:"dryRun",checked:(0,y.default)(l,"dryRun",!1),onChange:this.handleCheckboxChange("dryRun")},t("DRY_RUN")))),p.default.createElement("div",{className:"".concat(S.default.column," ").concat(S.default.column_card)},p.default.createElement(v.Form.Item,null,p.default.createElement(v.Checkbox,{name:"applyOnly",checked:(0,y.default)(l,"applyOnly",!1),onChange:this.handleCheckboxChange("applyOnly")},t("APPLY_ONLY")))),p.default.createElement("div",{className:"".concat(S.default.column," ").concat(S.default.column_card)},p.default.createElement(v.Form.Item,null,p.default.createElement(v.Checkbox,{name:"syncStrategy.apply.force",checked:(0,y.default)(l,"syncStrategy.apply.force",!1),onChange:this.handleCheckboxChange("syncStrategy.apply.force")},t("FORCE"))))),p.default.createElement("div",{className:S.default.wrapper},p.default.createElement("h6",null,t("SYNC_SETTINGS")),p.default.createElement("div",{className:S.default.wrapper_item},p.default.createElement("div",{className:"".concat(S.default.columns," ").concat(S.default.wrapper_item_com)},p.default.createElement("div",{className:"".concat(S.default.column," ").concat(S.default.column_card)},p.default.createElement(v.Form.Item,null,p.default.createElement(v.Checkbox,{name:"syncOptions.Validate",checked:(0,y.default)(l,"syncOptions.Validate",!1),onChange:this.handleCheckboxChange("syncOptions.Validate")},t("SKIP_SCHEMA_VALIDATION")))),p.default.createElement("div",{className:"".concat(S.default.column," ").concat(S.default.column_card)},p.default.createElement(v.Form.Item,null,p.default.createElement(v.Checkbox,{name:"syncOptions.CreateNamespace",checked:(0,y.default)(l,"syncOptions.CreateNamespace",!1),onChange:this.handleCheckboxChange("syncOptions.CreateNamespace")},t("AUTO_CREATE_PROJECT")))),p.default.createElement("div",{className:"".concat(S.default.column," ").concat(S.default.column_card)},p.default.createElement(v.Form.Item,null,p.default.createElement(v.Checkbox,{name:"syncOptions.PruneLast",checked:(0,y.default)(l,"syncOptions.PruneLast",!1),onChange:this.handleCheckboxChange("syncOptions.PruneLast")},t("PRUNE_LAST")))),p.default.createElement("div",{className:"".concat(S.default.column," ").concat(S.default.column_card)},p.default.createElement(v.Form.Item,null,p.default.createElement(v.Checkbox,{name:"syncOptions.ApplyOutOfSyncOnly",checked:(0,y.default)(l,"syncOptions.ApplyOutOfSyncOnly",!1),onChange:this.handleCheckboxChange("syncOptions.ApplyOutOfSyncOnly")},t("APPLY_OUT_OF_SYNC_ONLY"))))),p.default.createElement(v.Form.Item,{label:t("PRUNE_PROPAGATION_POLICY")},p.default.createElement(v.Select,{name:"syncOptions.PrunePropagationPolicy",options:b.PRUNE_PROPAGATION_POLICY_OPTIONS})),p.default.createElement(v.Form.Item,null,p.default.createElement("div",{className:S.default.checkbox_item},p.default.createElement(v.Checkbox,{name:"syncOptions.Replace",checked:(0,y.default)(l,"syncOptions.Replace",!1),onChange:this.handleCheckboxChange("syncOptions.Replace")}),p.default.createElement("div",{className:S.default.checkbox_item_info},p.default.createElement("p",null,t("REPLACE_RESOURCE")),p.default.createElement("span",null,t("REPLACE_RESOURCE_DESC")))))))))}}]),r}(p.default.Component),u.propTypes={store:h.default.object,module:h.default.string,formTemplate:h.default.object,title:h.default.string,visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func},u.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=O},function(e,t,a){e.exports={wrapper:"_1JWzJvszLMHMLyb-TeoMIz",wrapper_item:"jPIV0cqgpuJN1jf3JSDcW",wrapper_item_com:"_1g3AWoSQifeaTpuwYERL_V",columns:"_16FyP4wau96WlEXWJRsJ1R",column:"_20iJTIApnqzOwXgexIuLpL",column_card:"_1uqoIVdzmWb1Y5-WFbQxE2",checkbox_item:"eZ9DmMZilf8qIV78FSsGk",checkbox_item_info:"_2ODKbWRDaRBjg1GoWej9KM"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(18),r(11),r(73),r(46),r(7),r(40),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(73),r(46),r(7),r(40),r(110);var l=n(r(317)),u=n(r(50)),o=n(r(58)),c=n(r(38)),s=n(r(31));r(35);var i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),E=n(r(1)),y=n(r(5)),g=n(r(26)),b=n(r(64)),S=n(r(67)),_=r(189),O=r(56),C=n(r(798)),T=n(r(844)),R=n(r(2332));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var I=function(e){(0,p.default)(n,e);var a,r=N(n);function n(e){var t;return(0,f.default)(this,n),(t=r.call(this,e)).stopPropagation=function(e){return e.stopPropagation()},t.handleOk=(0,i.default)(c.default.mark((function e(){var a,r,n,l,u,o;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,r=a.onOk,n=a.store,l=a.resource,u=t.state.selectedRelatedResourceIds,!(0,b.default)(l)){e.next=10;break}return o=[],l.forEach((function(e){o.push(n.delete(k(k({},e),{},{isRelated:u.includes(e.uid)})))})),e.next=7,Promise.all(o);case 7:n.list.setSelectRowKeys([]),e.next=12;break;case 10:return e.next=12,n.delete(k(k({},l),{},{isRelated:u.includes(l.uid)}));case 12:r();case 13:case"end":return e.stop()}}),e)}))),t.handleItemClick=function(e){var a=e.currentTarget.dataset.id;t.setState((function(e){var t=e.selectedRelatedResourceIds;return{selectedRelatedResourceIds:t.includes(a)?t.filter((function(e){return e!==a})):[].concat((0,o.default)(t),[a])}}))},t.state={enableConfirm:!1,selectedRelatedResourceIds:[],relatedResources:[],timer:3},t}return(0,d.default)(n,[{key:"componentDidMount",value:function(){this.props.visible&&(this.fetchRelatedResources(this.props.resource),this.startTimer())}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"startTimer",value:function(){var e=this;this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){e.setState((function(e){var t=e.timer;return{timer:Math.max(t-1,0),enableConfirm:t<=1}}),(function(){e.state.enableConfirm&&e.timer&&clearInterval(e.timer)}))}),1e3)}},{key:"fetchRelatedResources",value:(a=(0,i.default)(c.default.mark((function e(t){var a;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({isLoading:!0}),a=[],(0,b.default)(t)?a=t.filter((function(e){return(0,g.default)(e,"status.operationState.syncResult.resources")})):(0,g.default)(t,"status.operationState.syncResult.resources")&&a.push(t),this.setState({relatedResources:a,isLoading:!1});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"renderContent",value:function(){var e=this,a=this.state,r=a.isLoading,n=a.relatedResources,l=void 0===n?[]:n,u=a.selectedRelatedResourceIds;return!1===r&&(0,S.default)(l)?v.default.createElement(T.default,{icon:"appcenter",className:R.default.empty,title:t("NO_RELATED_RESOURCE_FOUND"),desc:t("NO_CONTINUOUS_DEPLOYMENT_RELATED_RESOURCE_DESC")}):v.default.createElement("div",{className:R.default.resources},l.map((function(a){return v.default.createElement("div",{key:a.uid,"data-id":a.uid,className:(0,y.default)(R.default.resource,(0,s.default)({},R.default.selected,u.includes(a.uid))),onClick:e.handleItemClick},v.default.createElement(_.Checkbox,{checked:u.includes(a.uid),onClick:e.stopPropagation}),v.default.createElement("span",{className:R.default.resourceName},t("DELETE_CONTINUOUS_DEPLOYMENT_RELATE_DESC",{resourceName:(0,O.getDisplayName)(a)})))})))}},{key:"render",value:function(){var e=this.state,a=e.enableConfirm,r=e.timer,n=this.props,o=n.resource,c=(n.onOk,n.onCancel),s=n.isSubmitting,i=(0,u.default)(n,["resource","onOk","onCancel","isSubmitting"]),f=(0,b.default)(o)&&1!==o.length?t("DELETE_MULTIPLE_CONTINUOUS_DEPLOYMENT"):t("DELETE_CONTINUOUS_DEPLOYMENT"),d=(0,b.default)(o)&&1!==o.length?t.html("DELETE_CONTINUOUS_DEPLOYMENT_DESC_PL",{resource:o.map((function(e){return e.name})).join(", ")}):(0,b.default)(o)?t.html("DELETE_CONTINUOUS_DEPLOYMENT_DESC_SI",{resource:o.map((function(e){return e.name})).join(", ")}):t.html("DELETE_CONTINUOUS_DEPLOYMENT_DESC_SI",{resource:o.name});return v.default.createElement(C.default,(0,l.default)({width:520,icon:"question",title:f,description:d,closable:!1,headerClassName:R.default.modalHeader,bodyClassName:R.default.modalBody,hideFooter:!0},i),v.default.createElement("div",{className:R.default.body},this.renderContent()),v.default.createElement("div",{className:R.default.footer},v.default.createElement(_.Button,{onClick:c},t("CANCEL")),v.default.createElement(_.Button,{type:"danger",loading:s,disabled:!a||s,onClick:this.handleOk},t("OK"),!a&&"(".concat(r,"s)"))))}}]),n}(v.default.Component);a.default=I,I.propTypes={resource:E.default.any,visible:E.default.bool,onOk:E.default.func,onCancel:E.default.func,isSubmitting:E.default.bool},I.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},,function(e,t,a){e.exports={modalHeader:"_2lUQSyRfiU4YeUhpf3zy-S",modalBody:"lqJikp16zKqK2K6UdEZRC",body:"_3fuZLbetwSCcB4MdawzMUz",resources:"_3fvP-ruxRguMGNneJS2MpF",resource:"_2CjGmdFLkb6HwhcdVWr2SY",selected:"ZkJD8LpYhq9rBgigtk_Gk",resourceName:"Z6J-Axt0vkY2P2lsm_aeD",resourceType:"_36zKd2MIRxtDYumA5aAV3C",footer:"TnEEvRuFYrOxJJQybpWrJ",empty:"_32qukyLlop_kvPys-weyK_"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(87),r(14),r(8),r(13),r(9),r(30),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(87),r(141),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(30),r(71),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(119)),i=n(r(26)),f=n(r(68)),d=n(r(196)),p=n(r(191)),m=n(r(798)),h=n(r(2334)),v=r(1401),E=r(1161),y=n(r(1057)),g=r(56),b=n(r(2372)),S=n(r(2376)),_=n(r(2378)),O=r(324);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R={"cluster.add":{on:function(e){var a=e.store,r=e.module,n=e.success,d=(0,c.default)(e,["store","module","success"]);a.kubekey=new y.default;var g,b=(0,s.default)(E.IMPORT_CLUSTER_SPEC),S=m.default.open(T({onOk:(g=(0,u.default)(l.default.mark((function e(r){var u,c,s,d;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:if(u=(0,i.default)(r,'metadata.annotations["kubesphere.io/way-to-add"]'),c=(0,i.default)(r,"metadata.name"),s=(0,i.default)(r,"tags",[]).reduce((function(e,t){return T(T({},e),{},(0,o.default)({},"label.cluster.kubesphere.io/".concat(t.name),""))}),{}),d=(0,i.default)(r,"metadata.labels",{}),(0,f.default)(r,"metadata.labels",T(T(T({},d),s),{},{"kubesphere.io/managed":"true"})),delete r.tags,"new"!==u){e.next=13;break}return e.next=11,k(a.kubekey,r);case 11:e.next=15;break;case 13:return e.next=15,D(a,r);case 15:m.default.close(S),p.default.success({content:t("CREATE_SUCCESSFUL")}),n&&n("/clusters/".concat(c,"/overview"));case 18:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)}),module:r,formTemplate:b,title:t("ADD_CLUSTER"),steps:v.IMPORT_CLUSTER,modal:h.default,store:a},d))}},"cluster.unbind":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,s=(0,c.default)(e,["store","detail","success"]),i=m.default.open(T({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=3;break}return e.next=3,N(r,n);case 3:r.delete(n).then((function(){m.default.close(i),p.default.success({content:t("REMOVE_SUCCESS")}),o&&o()}));case 4:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,modal:b.default,detail:n,title:t("REMOVE_CLUSTER"),resource:n.name,deleteCluster:!0},s))}},"cluster.updateKubeConfig":{on:function(e){var a,r=e.store,n=e.detail,o=(e.cluster,e.success),i=(0,c.default)(e,["store","detail","cluster","success"]),d=m.default.open(T({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,s.default)(a),(0,f.default)(u,"kubeconfig",(0,O.safeBtoa)(u.kubeconfig)),e.next=4,r.updateKubeConfig({cluster:n.name,data:u});case 4:m.default.close(d),p.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o();case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:n,title:t("UPDATE_KUBECONFIG"),formTemplate:{kubeconfig:{}},modal:S.default},i))}},"cluster.viewKubeConfig":{on:function(e){var a=e.store,r=e.detail,n=(e.cluster,e.success,(0,c.default)(e,["store","detail","cluster","success"])),l=m.default.open(T({onOk:function(){return m.default.close(l)},store:a,detail:r,title:t("VIEW_KUBECONFIG"),formTemplate:{kubeconfig:{}},modal:S.default,readOnly:!0},n))}},"cluster.editConfig":{on:function(e){var a,r=e.store,n=e.detail,o=(e.cluster,e.success),d=(0,c.default)(e,["store","detail","cluster","success"]),h={spec:{config:(0,O.safeAtob)((0,i.default)(n._originData,"spec.config",""))}},v=m.default.open(T({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,s.default)(a),(0,f.default)(u,"spec.config",(0,O.safeBtoa)(u.spec.config)),e.next=4,r.patch(n,u);case 4:m.default.close(v),p.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o();case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:n,title:t("EDIT_CONFIG"),formTemplate:h,modal:_.default},d))}}};a.default=R;var D=function(){var e=(0,u.default)(l.default.mark((function e(t,a){var r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,s.default)(a),(0,i.default)(r,"spec.config")&&(n=(0,i.default)(r,"spec.config",""),(0,f.default)(r,"spec.config",(0,O.safeBtoa)(n))),"proxy"!==(0,i.default)(r,"spec.connection.type")){e.next=6;break}(0,d.default)(r,"spec.connection.kubeconfig"),e.next=10;break;case 6:return u=(0,i.default)(r,"spec.connection.kubeconfig",""),(0,f.default)(r,"spec.connection.kubeconfig",(0,O.safeBtoa)(u)),e.next=10,t.validate(r);case 10:return e.next=12,t.create(r);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),k=function(e,t){var a=(0,i.default)(t,"spec.registry.privateRegistry","");a&&(a="".concat(a,"/").replace(/\/\/$/,"/"));var r=(0,g.safeParseJSON)(JSON.stringify(t).replace(/\$\{spec\.registry\.privateRegistry\}/g,a),{});return e.create(r)};function N(e,t){var a={};return(0,f.default)(a,'metadata.annotations["notification.kubesphere.io/cleanup"]',"true"),e.patch(t,a)}},function(e,a,r){"use strict";r(16);var n=r(19);r(66),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(121),r(66),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(74)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(119)),d=n(r(26)),p=n(r(198)),m=n(r(68)),h=n(r(0)),v=n(r(1)),E=r(189),y=n(r(798)),g=n(r(858)),b=r(61),S=n(r(2335)),_=n(r(2337)),O=n(r(2339));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var T=function(e){(0,c.default)(r,e);var a=C(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).setSteps=function(e){t.setState({steps:e})},t.setCurrentStep=function(e){t.setState({currentStep:e})},t.setFormData=function(e){t.setState({formTemplate:e})},t.handleOk=function(){var e;if(t.state.isCodeMode&&(0,p.default)((0,d.default)((0,u.default)(t),"codeRef.current.getData")))e=t.codeRef.current.getData();else{e=t.state.formTemplate;var a=Array.isArray(e.tags)&&e.tags.map((function(e){return e.name})).join(",");a&&(0,m.default)(e,["metadata","annotations","cluster.kubesphere.io/label-ids"],a)}t.props.onOk(e)},t.handlePrev=function(){t.setState((function(e){var t=e.currentStep;return{currentStep:Math.max(0,t-1)}}))},t.handleNext=function(){var e=t.formRef.current,a=t.state.steps;e&&e.validate((function(){t.setState((function(e){var t=e.currentStep;return{currentStep:Math.min(a.length-1,t+1)}}))}))},t.handleModeChange=function(){t.setState((function(e){var a=e.isCodeMode,r=e.formTemplate;return a&&(0,p.default)((0,d.default)((0,u.default)(t),"codeRef.current.getData"))&&(r=t.codeRef.current.getData()),{isCodeMode:!a,formTemplate:r}}))},t.state={currentStep:0,steps:e.steps,formTemplate:(0,f.default)(e.formTemplate)},t.formRef=h.default.createRef(),t.codeRef=h.default.createRef(),t}return(0,o.default)(r,[{key:"getChildContext",value:function(){return{setSteps:this.setSteps,setCurrentStep:this.setCurrentStep,setFormData:this.setFormData}}}]),(0,o.default)(r,[{key:"renderForm",value:function(){var e=this.props,t=e.store,a=e.tagsStore,r=e.onAddTags,n=e.hostedInOptions,l=this.state,u=l.formTemplate,o=l.steps[l.currentStep].component,c={hostedInOptions:n,store:t,formTemplate:u,formRef:this.formRef,tagsStore:a,onAddTags:r};return h.default.createElement("div",{className:O.default.wrapper},h.default.createElement("div",{className:O.default.form},h.default.createElement(o,c)))}},{key:"renderCode",value:function(){var e=this.state.formTemplate;return h.default.createElement(_.default,{ref:this.codeRef,formTemplate:e})}},{key:"renderHeader",value:function(){var e=this.props,a=e.module,r=e.title,n=e.onCancel,l=this.state,u=l.steps,o=l.currentStep,c=l.isCodeMode;return h.default.createElement("div",{className:O.default.header},h.default.createElement("div",{className:O.default.title},h.default.createElement(E.Icon,{name:"close",size:20,clickable:!0,onClick:n}),h.default.createElement("span",null),h.default.createElement(E.Icon,{name:b.ICON_TYPES[a],size:20}),h.default.createElement("span",null,r)),!c&&h.default.createElement("div",{className:O.default.steps},h.default.createElement("div",null),h.default.createElement(S.default,{steps:u,current:o})),h.default.createElement(g.default,{className:O.default.switch,text:t("EDIT_YAML"),onChange:this.handleModeChange,checked:c}),h.default.createElement("div",{className:O.default.headerBottom}))}},{key:"renderFooter",value:function(){var e=this.props,a=e.onCancel,r=e.isSubmitting,n=this.state,l=n.steps,u=n.currentStep;if(n.isCodeMode)return h.default.createElement("div",{className:O.default.footer},h.default.createElement("div",{className:O.default.wrapper},h.default.createElement("div",{className:"text-right"},h.default.createElement(E.Button,{onClick:a},t("CANCEL")),h.default.createElement(E.Button,{type:"control",onClick:this.handleOk,loading:r},t("CREATE")))));var o=l.length-1;return h.default.createElement("div",{className:O.default.footer},h.default.createElement("div",{className:O.default.wrapper},h.default.createElement("div",{className:"text-right"},h.default.createElement(E.Button,{onClick:a},t("CANCEL")),u>0&&h.default.createElement(E.Button,{type:"control",onClick:this.handlePrev},t("PREVIOUS")),u<o?h.default.createElement(E.Button,{type:"control",onClick:this.handleNext},t("NEXT")):h.default.createElement(E.Button,{type:"control",onClick:this.handleOk,loading:r},t("CREATE")))))}},{key:"render",value:function(){var e=this.props.visible,t=this.state.isCodeMode;return h.default.createElement(y.default,{className:O.default.modal,bodyClassName:O.default.body,visible:e,hideHeader:!0,hideFooter:!0,fullScreen:!0},this.renderHeader(),h.default.createElement("div",{className:O.default.content},t?this.renderCode():this.renderForm()),this.renderFooter())}}]),r}(h.default.Component);a.default=T,T.propTypes={formTemplate:v.default.object,steps:v.default.array,visible:v.default.bool,onOk:v.default.func,onCancel:v.default.func},T.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},T.childContextTypes={setSteps:v.default.func,setCurrentStep:v.default.func,setFormData:v.default.func}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(10),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(20),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=r(189),p=l(r(67)),m=l(r(2336));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(r,e);var a=h(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props.current;return(0,p.default)(this.formattedStep)?f.default.createElement(f.default.Fragment,null):f.default.createElement("div",{className:m.default.wrapper},this.formattedStep.map((function(a,r){return f.default.createElement("div",{key:a.title},e>=r?f.default.createElement(d.Icon,{name:"success",type:"coloured",size:12}):f.default.createElement(d.Icon,{name:"dot",type:"light",size:12}),f.default.createElement("span",null,t(a.title)))})))}},{key:"formattedStep",get:function(){return this.props.steps.filter((function(e){return!!e.title}))}}]),r}(f.Component);a.default=v},function(e,t,a){e.exports={wrapper:"VcopeKzgXdwSpnCTVNt0h"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(119)),p=r(189),m=n(r(861)),h=n(r(2338));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=function(e){(0,o.default)(r,e);var a=v(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).data=(0,d.default)(e.formTemplate),t.editor=i.default.createRef(),t}return(0,u.default)(r,[{key:"getData",value:function(){return this.editor.current.getData()}},{key:"render",value:function(){return i.default.createElement("div",{className:h.default.wrapper},i.default.createElement("div",{className:h.default.step},i.default.createElement("div",null,t("EDIT_YAML")),i.default.createElement("p",null,t("CREATE_BY_YAML_DESC"))),i.default.createElement("div",{className:h.default.codeWrapper},i.default.createElement("div",{className:h.default.pane},i.default.createElement("div",{className:h.default.title},i.default.createElement(p.Icon,{name:"coding",size:20}),i.default.createElement("span",null,t("EDIT_YAML"))),i.default.createElement(m.default,{ref:this.editor,className:h.default.editor,value:this.data}))))}}]),r}(i.default.Component);a.default=E,E.propTypes={formTemplate:f.default.object,onOk:f.default.func,isSubmitting:f.default.bool},E.defaultProps={onOk:function(){},isSubmitting:!1}},function(e,t,a){e.exports={wrapper:"_2bLRs43o7z2Z0l0OqV3S3l",step:"_3ABigQDpD_68K0K2-zPwo1",codeWrapper:"_35rMFFtZtEQsJ1XnlGrRIT",pane:"_1IXTMNwey-PU6zqsfimMcO",editor:"_2-LDXYPFV_Swq3SZk8_dTY",title:"_8xagm1IYbXzrlonLdlZLT"}},function(e,t,a){e.exports={modal:"_3udZ9JU41jkQT15SM6VQqy",body:"_3zIqgTb5iRnwYJult2OSjW",wrapper:"_1GY1dBmycuTqs5z5O4U5i1",steps:"_1j6BiFUqlNymOz_lSW28U7",header:"_1y3eAJkaBREv2CFp4dIBeY",headerBottom:"_3srgYWH6bHux51Zn3xQeOG",title:"_3sSfECiQrD_nXjhQGwbY6d",content:"_3_hijI-MOd78wmqLgMzBbx",footer:"_1nQdSbl4yf_TN2MYcxvNhu"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(119)),p=n(r(68)),m=r(189),h=r(1401),v=n(r(1055)),E=r(1161),y=n(r(2342));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var b=function(e){(0,o.default)(r,e);var a=g(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).STEPS={new:h.NEW_CLUSTER,import:h.IMPORT_CLUSTER},e.SPECS={new:E.NEW_CLUSTER_SPEC,import:E.IMPORT_CLUSTER_SPEC},e.handleChange=function(t){e.context.setSteps(e.STEPS[t]);var a=(0,d.default)(e.SPECS[t]);(0,p.default)(a,"metadata.annotations['kubesphere.io/way-to-add']",t),e.context.setFormData(a)},e}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.props.store.kubekey.fetchParameters()}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate;return i.default.createElement("div",{className:y.default.wrapper},i.default.createElement(v.default,{title:t("SELECT_ADD_CLUSTER_METHOD"),description:t("SELECT_ADD_CLUSTER_METHOD_DESC")}),i.default.createElement(m.Form,{data:r,ref:a},i.default.createElement(m.Form.Item,{className:y.default.cards},i.default.createElement(m.RadioGroup,{name:"metadata.annotations['kubesphere.io/way-to-add']",onChange:this.handleChange,defaultValue:"new"},i.default.createElement(m.Radio,{value:"new"},i.default.createElement(m.Icon,{name:"kubernetes",size:48}),i.default.createElement("span",null,t("NEW_CLUSTER"))),i.default.createElement(m.Radio,{value:"import"},i.default.createElement(m.Icon,{name:"hammer",size:48}),i.default.createElement("span",null,t("IMPORT_CLUSTER")))))))}}]),r}(i.default.Component);a.default=b,b.contextTypes={setSteps:f.default.func,setFormData:f.default.func}},function(e,t,a){e.exports={text:"_3y0BRfqtNHZn6ztqSjBlZv"}},function(e,t,a){e.exports={wrapper:"_2rN8KkaFhFv7O2Ix_c84Ib",cards:"cBamJ--YMZwFF5HHxaU-E"}},function(e,a,r){"use strict";r(16);var n=r(19);r(66),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(66),r(27),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=r(189),d=n(r(26)),p=n(r(68)),m=r(243),h=n(r(0)),v=r(61),E=r(905),y=n(r(2344)),g=n(r(2346)),b=n(r(2348));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=(0,m.observer)(l=function(e){(0,c.default)(r,e);var a=S(r);function r(e){var n;(0,u.default)(this,r),(n=a.call(this,e)).groupOptionRenderer=function(e){return h.default.createElement(h.default.Fragment,null,h.default.createElement(f.Tag,{type:v.CLUSTER_GROUP_TAG_TYPE[e.value]},t("ENV_".concat(e.label.toUpperCase()))),"  ",e.label)},n.toggleAdvanced=function(){n.setState((function(e){return{toggleAdvanced:!e.toggleAdvanced}}))},n.providerOptionRenderer=function(e){return h.default.createElement(h.default.Fragment,null,h.default.createElement(f.Icon,{className:"margin-r8",name:e.icon,type:"light",size:20}),e.label)},n.nameValidator=function(e,a,r){if(!a)return r();n.props.store.checkName({name:a}).then((function(a){if(a.exist)return r({message:t("NAME_EXIST_DESC"),field:e.field});r()}))},n.nodesValidator=function(e,a,r){if(!a)return r();var l=(0,d.default)(n.props.formTemplate,"spec.roleGroups.master.length",0),u=(0,d.default)(n.props.formTemplate,"spec.roleGroups.worker.length",0),o=[];if(1!==l&&3!==l&&o.push(t("MASTER_NODE_COUNT_TIP")),0===u&&o.push(t("WORKER_NODE_COUNT_TIP")),o.length>0)return r({message:o.join("; "),field:e.field});r()},n.handleTags=function(e){n.setState({tagsValue:e}),(0,p.default)(n.props.formTemplate,"tags",e)};var l=(0,d.default)(n.props.formTemplate,"tags",[]);return n.state={toggleAdvanced:!1,tagsValue:l},n}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=e.tagsStore.tagsGroup,l=void 0===n?{}:n,u=e.onAddTags,o=this.method;return h.default.createElement("div",{className:b.default.wrapper},h.default.createElement(f.Form,{data:r,ref:a},h.default.createElement(f.Form.Item,{label:t("CLUSTER_NAME"),desc:t("NAME_DESC_LENGTH",{length:60}),rules:[{required:!0,message:t("CLUSTER_NAME_EMPTY")},{pattern:v.PATTERN_NAME,message:t("INVALID_NAME_DESC_LENGTH",{length:60})},{validator:this.nameValidator}]},h.default.createElement(f.Input,{name:"metadata.name",maxLength:60})),h.default.createElement(f.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:v.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},h.default.createElement(f.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),h.default.createElement(f.Form.Item,{label:h.default.createElement("div",{className:b.default.iconTooltip},h.default.createElement("span",null,t("CLUSTER_TAG")),h.default.createElement(f.Tooltip,{content:t("CLUSTER_TAG_TOOLTIP_CONTENT")},h.default.createElement(f.Icon,{name:"question",size:16})))},h.default.createElement("div",{className:b.default.clusterTags},h.default.createElement(E.ClusterTagAdd,{tagsGroup:l,defaultValue:[],value:this.state.tagsValue,name:"tags",onAddTags:u,onChange:this.handleTags}))),h.default.createElement(f.Form.Item,{label:t("PROVIDER"),desc:t("CLUSTER_PROVIDER_DESC")},h.default.createElement(f.Select,{name:"spec.provider",options:v.CLUSTER_PROVIDERS,placeholder:" ",optionRenderer:this.providerOptionRenderer,searchable:!0})),h.default.createElement(f.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},h.default.createElement(f.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})),"new"===o&&h.default.createElement(h.default.Fragment,null,h.default.createElement(g.default,{className:b.default.nodesTitle,title:t("NODE_SETTINGS"),description:t("CLUSTER_NODE_SETTINGS_DESC")}),h.default.createElement(f.Form.Item,{rules:[{required:!0,message:t("PLEASE_ADD_AT_LEAST_ONE_CLUSTER_NODE")},{validator:this.nodesValidator}]},h.default.createElement(y.default,{name:"spec.hosts",formTemplate:r}))),h.default.createElement("div",{className:b.default.advanced,onClick:this.toggleAdvanced},h.default.createElement("span",null,t("ADVANCED_SETTINGS")),h.default.createElement(f.Icon,{name:this.state.showAdvanced?"chevron-up":"chevron-down",size:"20"})),this.state.toggleAdvanced&&h.default.createElement(f.Form.Item,{label:h.default.createElement("div",{className:b.default.iconTooltip},h.default.createElement("span",null,t("CLUSTER_LABEL")),h.default.createElement(f.Tooltip,{content:t("CLUSTER_LABEL_TOOLTIP_CONTENT")},h.default.createElement(f.Icon,{name:"question",size:16}))),desc:t("CLUSTER_LABEL_DESC")},h.default.createElement(f.Select,{name:"metadata.labels['cluster.kubesphere.io/group']",options:v.CLUSTER_PRESET_GROUPS,placeholder:" ",optionRenderer:this.groupOptionRenderer,searchable:!0}))))}},{key:"method",get:function(){return(0,d.default)(this.props.formTemplate,"metadata.annotations['kubesphere.io/way-to-add']")}}]),r}(h.default.Component))||l;a.default=_},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(6),r(20),r(14),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(4),r(18),r(43),r(11),r(7);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(68)),p=n(r(26)),m=n(r(5)),h=n(r(1)),v=n(r(828)),E=n(r(2345)),y=n(r(1402)),g=n(r(1403));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var S=function(e){(0,c.default)(r,e);var a=b(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).state={showAdd:!1,selectIndex:-1},e.showAdd=function(){e.setState({showAdd:!0,selectIndex:-1})},e.hideAdd=function(){e.setState({showAdd:!1,selectIndex:-1})},e.showEdit=function(t){e.setState({showAdd:!0,selectIndex:t})},e.handleAdd=function(t){var a=e.props,r=a.value,n=a.onChange,u=e.state.selectIndex;u>=0?(r[u]=t,n(r)):n([].concat((0,l.default)(r),[t])),e.updateRoleGroups(),e.hideAdd()},e.updateRoleGroups=function(){var t=e.props.formTemplate,a=(0,p.default)(t,"spec.hosts",[]),r={};a.forEach((function(e){e.roles&&e.roles.forEach((function(t){r[t]=r[t]||[],r[t].push(e.name)}))})),r.etcd=r.master,(0,d.default)(t,"spec.roleGroups",r)},e.handleDelete=function(t){var a=e.props,r=a.value;(0,a.onChange)(r.filter((function(e){return e.name!==t.name}))),e.updateRoleGroups()},e}return(0,o.default)(r,[{key:"renderNodes",value:function(){var e=this;return this.props.value.map((function(t,a){return f.default.createElement(E.default,{node:t,key:t.name,index:a,onEdit:e.showEdit,onDelete:e.handleDelete})}))}},{key:"renderAdd",value:function(){return f.default.createElement(v.default.Add,{icon:"add",title:t("ADD_NODE"),description:t("ADD_NODE_TO_THE_CLUSTER"),onClick:this.showAdd})}},{key:"renderModal",value:function(){var e=this.props.value,t=this.state,a=t.showAdd,r=t.selectIndex,n=r>=0?e[r]:void 0;return f.default.createElement(y.default,{visible:a,data:n,onOk:this.handleAdd,onCancel:this.hideAdd})}},{key:"render",value:function(){var e=this.props.className;return f.default.createElement("div",{className:(0,m.default)(g.default.wrapper,e)},this.renderNodes(),this.renderAdd(),this.renderModal())}}]),r}(f.default.Component);a.default=S,S.propTypes={className:h.default.string,name:h.default.string,value:h.default.array,onChange:h.default.func,onDelete:h.default.func},S.defaultProps={className:"",name:"",value:[],readOnlyList:[],specTemplate:{},onChange:function(){}}},function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(14),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(20),a(14);var n=r(a(0)),l=r(a(1)),u=a(189),o=a(61),c=r(a(828)),s=function(e){var t=e.index,a=e.node,r=e.onDelete,l=e.onEdit,s=n.default.createElement("span",null,a.name,a.roles.map((function(e){return n.default.createElement(u.Tag,{key:e,className:"margin-l8",type:o.NODE_ROLE_TAG_TYPE[e]},e)})));return n.default.createElement(c.default.Item,{icon:"nodes",title:s,description:a.address,onDelete:function(){return r(a)},onEdit:function(){return l(t)}})};s.propTypes={node:l.default.object};var i=s;t.default=i},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.className,a=e.title,r=e.description;return n.default.createElement("div",{className:(0,l.default)(u.default.text,t)},n.default.createElement("div",null,a),n.default.createElement("p",null,r))},a(12),a(109);var n=r(a(0)),l=r(a(5)),u=r(a(2347))},function(e,t,a){e.exports={text:"_516bLC4y2eCDP-7u4_h68"}},function(e,t,a){e.exports={wrapper:"_1NNvsOKzvpG4TQpNcfk82r",nodesTitle:"gzd5RQSNJkEmTlh20fpt_",advanced:"_1LUGkOuBopYLmtimgyc8x_",formItem:"_2rS4-K0J9tTDyDPpPETUdF",iconTooltip:"_3wK3EWmKuNT8yWLM2kriP0",clusterTags:"FgjbT7Pql9uy5yeH4XtVg"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(27),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(800)),p=n(r(861)),m=n(r(26)),h=n(r(2350));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=function(e){(0,o.default)(r,e);var a=v(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleTypeChange=function(e){t.setState({connectType:e})},t.state={connectType:(0,m.default)(e.formTemplate,"spec.connection.type","direct")},t}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=this.state.connectType;return i.default.createElement("div",null,i.default.createElement(f.Form,{data:r,ref:a},i.default.createElement(f.Form.Item,{label:t("CONNECTION_MODE"),desc:t("CLUSTER_CONNECT_MODE_DESC")},i.default.createElement(f.Select,{name:"spec.connection.type",options:this.types,onChange:this.handleTypeChange})),"direct"===n&&i.default.createElement("div",{className:h.default.tip},t.html("CLUSTER_DIRECT_IMPORT_TIP")),"direct"===n?i.default.createElement("div",{className:h.default.editorWrapper},i.default.createElement("div",{className:h.default.editor},i.default.createElement("div",{className:h.default.editorTitle},i.default.createElement("div",null,i.default.createElement(f.Icon,{name:"kubernetes",size:20}),t("INPUT_KUBECONFIG"))),i.default.createElement(f.Form.Item,{rules:[{required:!0,message:t("INPUT_KUBECONFIG")}],unControl:!0},i.default.createElement(p.default,{mode:"yaml",name:"spec.connection.kubeconfig",options:this.editOptions})))):i.default.createElement("div",{className:h.default.tip},i.default.createElement(d.default,{title:t("CLUSTER_AGENT_TITLE"),description:t("CLUSTER_AGENT_DESC")}),i.default.createElement("div",{className:"margin-t12"},t.html("CLUSTER_AGENT_IMPORT_TIP")))))}},{key:"types",get:function(){var e=[{label:t("CONNTECT_DIRECT"),value:"direct"}];return globals.app.hasKSModule("tower")&&globals.app.isLicenseAuthorized("tower")&&e.push({label:t("CONNTECT_PROXY"),value:"proxy"}),e}},{key:"editOptions",get:function(){return{width:"100%",height:"100%"}}}]),r}(i.default.Component);a.default=E},function(e,t,a){e.exports={editorWrapper:"_1937BjcVyseLv9DIexIJWG",editor:"_3dm-s3IiWMzYT7kJAfs0sb",editorTitle:"_2xtWVxrXO_EaM9xO19pjBb",tip:"_3wGjRllnO483bHBWlTPvVH",link:"_2oSgKyuIsZA8PujoTg5SLU",banLink:"D8eXHyIVagn58_MMkRq5E"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(861)),p=n(r(2352));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate;return i.default.createElement("div",null,i.default.createElement(f.Form,{data:r,ref:a},i.default.createElement("div",{className:p.default.editorWrapper},i.default.createElement("div",{className:p.default.editor},i.default.createElement(f.Form.Item,{label:t("CLUSTER_CONFIG"),unControl:!0},i.default.createElement(d.default,{mode:"yaml",name:"spec.config",options:this.editOptions}))))))}},{key:"editOptions",get:function(){return{width:"100%",height:"100%"}}}]),r}(i.default.Component);a.default=h},function(e,t,a){e.exports={editorWrapper:"Ma3yI7kh9cSs7I4H_Ksf5",editor:"_3HXgHZRwxXwP-AAfLOMo9v"}},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(44),r(6),r(20),r(14),r(8),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(44),r(6),r(20),r(29),r(14),r(8),r(4),r(18),r(43),r(11),r(7);var l,u,o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(45)),p=n(r(0)),m=n(r(26)),h=n(r(196)),v=n(r(68)),E=n(r(67)),y=r(17),g=r(243),b=r(189),S=n(r(827)),_=r(1161),O=n(r(2354)),C=n(r(1055)),T=n(r(2355)),R=n(r(2357)),D=n(r(2360));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var N=(0,g.observer)((u=function(e){(0,s.default)(r,e);var a=k(r);function r(e){var t;(0,o.default)(this,r),(t=a.call(this,e)).handleNetworkPluginChange=function(e){var a=t.networkPlugins.find((function(t){return t.value===e})),r=t.state.networkParams;t.setState({networkParams:(0,m.default)(a,"params",[])},(function(){var e=t.state.networkParams,a=t.props.formTemplate;r.forEach((function(e){(0,h.default)(a,"spec.network.".concat(e.name))})),e.forEach((function(e){"default"in e&&(0,v.default)(a,"spec.network.".concat(e.name),e.default)}))}))},t.handleStoragePluginChange=function(e){var a=t.storagePlugins.find((function(t){return t.value===e}));a&&(a.template=a.template||{},(0,v.default)(t.props.formTemplate,"spec.addons[0]",(0,y.toJS)(a.template)),t.setState({storageParams:(0,m.default)(a,"params",[])}))};var n=(0,m.default)(e.formTemplate,"spec.network.plugin"),l=t.networkPlugins.find((function(e){return e.value===n})),u=(0,m.default)(e.formTemplate,"spec.storagePlugin")||(0,m.default)(t.storagePlugins,"[0].value");(0,v.default)(e.formTemplate,"spec.storagePlugin",u);var c=t.storagePlugins.find((function(e){return e.value===u}));return c&&c.template&&(0,E.default)((0,m.default)(e.formTemplate,"spec.addons[0]"))&&(0,v.default)(e.formTemplate,"spec.addons[0]",(0,y.toJS)(c.template)),t.state={networkParams:(0,m.default)(l,"params",[]),storageParams:(0,m.default)(c,"params",[])},t}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=this.state,l=n.networkParams,u=n.storageParams;return p.default.createElement("div",{className:O.default.wrapper},p.default.createElement(C.default,{title:t("CLUSTER_SETTINGS"),description:t("K8S_CLUSTER_SETTINGS_DESC")}),p.default.createElement(b.Form,{className:O.default.form,data:r,ref:a},p.default.createElement(b.Form.Item,{label:t("KUBERNETES_VERSION")},p.default.createElement(S.default,{name:"spec.kubernetes.version",options:this.versions,defaultValue:(0,m.default)(this.versions,"0.value")})),p.default.createElement(b.Form.Item,null,p.default.createElement(T.default,{name:"spec.kubernetes"})),p.default.createElement(b.Form.Item,{label:t("NETWORK_PLUGIN")},p.default.createElement(S.default,{name:"spec.network.plugin",options:this.networkPlugins,onChange:this.handleNetworkPluginChange})),p.default.createElement(b.Form.Item,null,p.default.createElement(R.default,{name:"spec.network",params:l})),p.default.createElement(b.Form.Item,{label:t("DEFAULT_STORAGE_PLUGIN")},p.default.createElement(S.default,{name:"spec.storagePlugin",options:this.storagePlugins,onChange:this.handleStoragePluginChange})),p.default.createElement(b.Form.Item,null,p.default.createElement(D.default,{name:"spec.addons[0]",params:u}))))}},{key:"versions",get:function(){return(0,y.toJS)((0,m.default)(this.props.store.kubekey,"parameters.kubernetes.supportedVersions",[])).map((function(e){return{icon:"kubernetes",label:e,value:e,description:"-"}}))}},{key:"networkPlugins",get:function(){return(0,m.default)(this.props.store.kubekey,"parameters.kubernetes.supportedCNIs",[]).map((function(e){return{label:e.title,value:e.name,icon:_.NETWORK_PLUGIN_ICONS[e.name]||"network",description:t(e.description),params:e.parameters}}))}},{key:"storagePlugins",get:function(){return(0,m.default)(this.props.store.kubekey,"parameters.storagePlugins",[]).map((function(e){return{label:e.title,value:e.name,icon:_.STORAGE_PLUGIN_ICONS[e.name]||"network",description:t(e.description),params:e.parameters,template:e.template}}))}}]),r}(p.default.Component),(0,d.default)(u.prototype,"versions",[y.computed],Object.getOwnPropertyDescriptor(u.prototype,"versions"),u.prototype),(0,d.default)(u.prototype,"networkPlugins",[y.computed],Object.getOwnPropertyDescriptor(u.prototype,"networkPlugins"),u.prototype),(0,d.default)(u.prototype,"storagePlugins",[y.computed],Object.getOwnPropertyDescriptor(u.prototype,"storagePlugins"),u.prototype),l=u))||l;a.default=N},function(e,t,a){e.exports={wrapper:"_3IrA5oEEz7IbkJINUqCtMY",form:"_1ZT8fGgQwTzYmasVKaVuvJ"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u=l(r(31)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=r(189),m=l(r(798)),h=l(r(805)),v=l(r(2356));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=function(e){(0,s.default)(r,e);var a=g(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={visible:!1},e.showEdit=function(){e.setState({visible:!0})},e.hideEdit=function(){e.setState({visible:!1})},e.handleEdit=function(t){var a=e.props,r=a.value;(0,a.onChange)(y(y({},r),t)),e.hideEdit()},e}return(0,c.default)(r,[{key:"renderPreview",value:function(){var e=this.props.value;return d.default.createElement("div",{className:v.default.preview},d.default.createElement("div",{className:v.default.item},d.default.createElement("span",null,t("MAX_PODS"),": "),d.default.createElement("span",null,e.maxPods)),d.default.createElement("a",{className:v.default.edit,onClick:this.showEdit},t("EDIT")))}},{key:"renderModal",value:function(){var e=this.props.value;return d.default.createElement(m.default.Form,{title:t("EDIT"),data:e,onOk:this.handleEdit,onCancel:this.hideEdit,visible:this.state.visible},d.default.createElement(p.Form.Item,{label:t("MAX_PODS"),desc:t("CLUSTER_MAX_PODS_DESC")},d.default.createElement(h.default,{name:"maxPods",integer:!0,min:0})))}},{key:"render",value:function(){return d.default.createElement("div",null,this.renderPreview(),this.renderModal())}}]),r}(d.Component);a.default=b},function(e,t,a){e.exports={preview:"_2io9fuI3YWAWSQXIo4HGzq",item:"_2ZfdnOOx1JzSRKNQUCHkeX",edit:"OgJYXUwcqOpUM366Z3SCU"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(109),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u=l(r(31)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=r(189),m=l(r(798)),h=l(r(1056)),v=l(r(2359));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=function(e){(0,s.default)(r,e);var a=g(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={visible:!1},e.showEdit=function(){e.setState({visible:!0})},e.hideEdit=function(){e.setState({visible:!1})},e.handleEdit=function(t){var a=e.props,r=a.value;(0,a.onChange)(y(y({},r),t)),e.hideEdit()},e}return(0,c.default)(r,[{key:"renderPreview",value:function(){var e=this.props.value;return d.default.createElement("div",{className:v.default.preview},d.default.createElement("div",{className:v.default.item},d.default.createElement("span",null,t("PODS_CIDR"),": "),d.default.createElement("span",null,e.kubePodsCIDR)),d.default.createElement("div",{className:v.default.item},d.default.createElement("span",null,t("SERVICE_CIDR"),": "),d.default.createElement("span",null,e.kubeServiceCIDR)),d.default.createElement("a",{className:v.default.edit,onClick:this.showEdit},t("EDIT")))}},{key:"renderModal",value:function(){var e=this.props,a=e.value,r=e.params;return d.default.createElement(m.default.Form,{title:t("EDIT"),data:a,onOk:this.handleEdit,onCancel:this.hideEdit,visible:this.state.visible},d.default.createElement(p.Form.Item,{label:t("PODS_CIDR"),desc:t("KUBE_PODS_CIDR_DESC")},d.default.createElement(p.Input,{name:"kubePodsCIDR"})),d.default.createElement(p.Form.Item,{label:t("SERVICE_CIDR"),desc:t("KUBE_SERVICE_CIDR_DESC")},d.default.createElement(p.Input,{name:"kubeServiceCIDR"})),r.map((function(e){return d.default.createElement(p.Form.Item,{key:e.name,label:t(e.title),desc:t(e.description)},d.default.createElement(h.default,{name:e.name,defaultValue:e.default,param:e}))})))}},{key:"render",value:function(){return d.default.createElement("div",null,this.renderPreview(),this.renderModal())}}]),r}(d.Component);a.default=b},function(e,t,a){e.exports={number:"_371DmavUkXjNjoWxz0hT90"}},function(e,t,a){e.exports={preview:"_1Oz0MD6qwzMKlxKwC4ffgb",item:"IFtL5Z2j_2RlCORNbeI2F",edit:"_1MVWtuYX83YbF3ui7k6txo"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(109),r(3),r(10),r(6),r(20),r(87),r(14),r(99),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(20),r(27),r(87),r(29),r(14),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u=l(r(31)),o=l(r(97)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(26)),h=l(r(67)),v=l(r(68)),E=r(189),y=l(r(798)),g=r(56),b=l(r(1056)),S=l(r(2361));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var T=function(e){(0,i.default)(r,e);var a=C(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={visible:!1,value:e.getFormData()},e.showEdit=function(){e.setState({visible:!0})},e.hideEdit=function(){e.setState({visible:!1})},e.handleEdit=function(t){var a=e.props,r=a.value,n=a.onChange,l=(0,g.flattenObject)(t);e.setState({value:l,visible:!1}),(0,v.default)(r,"sources.chart.values",Object.entries(l).map((function(e){var t=(0,o.default)(e,2),a=t[0],r=t[1];return"".concat(a,"=").concat(r)}))),n(O({},r))},e}return(0,s.default)(r,[{key:"getFormData",value:function(){var e=this.props.value;return(0,m.default)(e,"sources.chart.values",[]).reduce((function(e,t){var a=t.split("="),r=(0,o.default)(a,2),n=r[0],l=r[1];return O(O({},e),{},(0,u.default)({},n,l))}),{})}},{key:"componentDidUpdate",value:function(e){this.props.value!==e.value&&this.setState({value:this.getFormData()})}},{key:"renderPreview",value:function(){var e=this.props.params,a=this.state.value;return(0,h.default)(e)?null:p.default.createElement("div",{className:S.default.preview},e.map((function(e){return p.default.createElement("div",{key:e.name,className:S.default.item},p.default.createElement("span",null,e.title,": "),p.default.createElement("span",null,a[e.name]))})),p.default.createElement("a",{className:S.default.edit,onClick:this.showEdit},t("EDIT")))}},{key:"renderModal",value:function(){var e=this.state,a=e.value,r=e.visible,n=this.props.params;return p.default.createElement(y.default.Form,{title:t("EDIT"),data:a,onOk:this.handleEdit,onCancel:this.hideEdit,visible:r},n.map((function(e){return p.default.createElement(E.Form.Item,{key:e.name,label:t(e.title),desc:t(e.description)},p.default.createElement(b.default,{name:e.name,defaultValue:e.default,param:e}))})))}},{key:"render",value:function(){return p.default.createElement("div",null,this.renderPreview(),this.renderModal())}}]),r}(p.Component);a.default=T},function(e,t,a){e.exports={preview:"_2dYP91XQ9UZJxGes9Vx2Re",item:"_32Vtin5HujaEC_E3VveI4X",edit:"ugChWgWQ-Mjt46Gq2sa3n"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=r(189),p=n(r(805)),m=n(r(2363)),h=n(r(1055)),v=n(r(2364));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.store,r=e.formRef,n=e.formTemplate;return i.default.createElement("div",{className:m.default.wrapper},i.default.createElement(h.default,{title:t("ADVANCED_SETTINGS"),description:t("CLUSTER_ADVANCED_SETTINGS_DESC")}),i.default.createElement(d.Form,{className:m.default.form,data:n,ref:r},i.default.createElement(d.Form.Group,{label:t("KUBESPHERE_SETTINGS"),desc:t("CLUSTER_KUBESPHERE_SETTINGS_DESC"),checkable:!0,keepDataWhenUnCheck:!0},i.default.createElement(d.Form.Item,null,i.default.createElement(v.default,{name:"spec.addons[1].sources.chart.values",components:(0,f.default)(a.kubekey,"parameters.kubesphere.components",[])}))),i.default.createElement(d.Form.Group,{label:t("PRIVATE_REGISTRY_CONFIGURATION"),desc:t("CLUSTER_PRIVATE_REGISTRY_DESC"),checkable:!0,keepDataWhenUnCheck:!0},i.default.createElement(d.Form.Item,{label:t("PRIVATE_REGISTRY")},i.default.createElement(d.Input,{name:"spec.registry.privateRegistry"}))),i.default.createElement(d.Form.Group,{label:t("CLUSTER_CONTROLPLANE_ENDPOINT"),desc:t("CLUSTER_CONTROLPLANE_ENDPOINT_DESC"),checkable:!0,keepDataWhenUnCheck:!0},i.default.createElement(d.Form.Item,{label:t("DOMAIN")},i.default.createElement(d.Input,{name:"spec.controlPlaneEndpoint.domain"})),i.default.createElement(d.Form.Item,{label:t("ADDRESS")},i.default.createElement(d.Input,{name:"spec.controlPlaneEndpoint.address"})),i.default.createElement(d.Form.Item,{label:t("PORT")},i.default.createElement(p.default,{name:"spec.controlPlaneEndpoint.port",integer:!0,min:0,max:65535}))),i.default.createElement(d.Form.Group,{label:t("ETCD_BACKUP"),desc:t("CLUSTER_ETCD_BACKUP_DESC"),checkable:!0,keepDataWhenUnCheck:!0},i.default.createElement(d.Form.Item,{label:t("ETCD_BACKUP_DIR"),desc:t("CLUSTER_ETCD_BACKUP_DIR_DESC")},i.default.createElement(d.Input,{name:"spec.kubernetes.etcdBackupDir"})),i.default.createElement(d.Form.Item,{label:t("ETCD_BACKUP_PERIOD"),desc:t("CLUSTER_ETCD_BACKUP_PERIOD_DESC")},i.default.createElement(p.default,{name:"spec.kubernetes.etcdBackupPeriod",integer:!0,min:0})),i.default.createElement(d.Form.Item,{label:t("KEEP_BACKUP_NUMBER"),desc:t("CLUSTER_ETCD_BACKUP_NUMBER_DESC")},i.default.createElement(p.default,{name:"spec.kubernetes.keepBackupNumber",integer:!0,min:0})))))}}]),r}(i.default.Component);a.default=y},function(e,t,a){e.exports={wrapper:"_1dLQJIy0pH98ZJwhjTVk2n",form:"_10yrEpdtuvtNMsl-9L3bAY"}},function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(109),a(3),a(192),a(10),a(6),a(20),a(87),a(14),a(99),a(8),a(13),a(9),a(4),a(18),a(30),a(11),a(139),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(32),a(3),a(192),a(10),a(6),a(20),a(27),a(87),a(29),a(14),a(33),a(16),a(99),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var l=n(a(58)),u=n(a(97)),o=n(a(31)),c=n(a(25)),s=n(a(28)),i=n(a(41)),f=n(a(42)),d=n(a(37)),p=r(a(0)),m=n(a(1056));function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var y=function(e){(0,i.default)(a,e);var t=E(a);function a(e){var r;(0,c.default)(this,a),(r=t.call(this,e)).handleInputChange=function(e,t){var a=r.props.onChange;r.setState((function(a){var r=a.value;return r[t]=e,v({},r)}),(function(){a(Object.entries(r.state.value).map((function(e){var t=(0,u.default)(e,2),a=t[0],r=t[1];return"".concat(a,"=").concat(r)})))}))};var n=e.components.filter((function(e){return e.parameters&&e.parameters.every((function(e){return"enabled"!==e.name}))})).reduce((function(e,t){return[].concat((0,l.default)(e),(0,l.default)(t.parameters.map((function(e){return v(v({},e),{},{name:"".concat(t.name,".").concat(e.name)})}))))}),[]),s=e.value.reduce((function(e,t){var a=t.split("="),r=(0,u.default)(a,2),n=r[0],l=r[1];return v(v({},e),{},(0,o.default)({},n,l))}),{});return r.state={params:n,value:s},r}return(0,s.default)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.params,r=t.value;return a.map((function(t){return p.default.createElement("div",{key:t.name,className:"form-item"},p.default.createElement("label",{className:"form-label",htmlFor:name},t.title),p.default.createElement("div",{className:"form-control"},p.default.createElement(m.default,{name:t.name,value:r[t.name],param:t,onChange:e.handleInputChange}),p.default.createElement("div",{className:"form-desc"},t.description)))}))}}]),a}(p.Component);t.default=y},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(6),r(14),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(6),r(27),r(29),r(14),r(4),r(18),r(43),r(11),r(7);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=n(r(68)),p=r(17),m=r(189),h=n(r(2366)),v=n(r(2371)),E=n(r(1055));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var g=function(e){(0,o.default)(r,e);var a=y(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).init(),t}return(0,u.default)(r,[{key:"init",value:function(){var e=this.props.formTemplate,t=(0,p.toJS)((0,f.default)(this.props.store.kubekey,"parameters.kubesphere",{})),a=t.template,r=t.components,n=void 0===r?[]:r;(0,d.default)(e,"spec.addons[1]",a);var l=(0,f.default)(e,"spec.addons[1].sources.chart.values",[]);n.forEach((function(e){e.parameters&&e.parameters.forEach((function(t){"default"in t&&l.push("".concat(e.name,".").concat(t.name,"=").concat(t.default))}))})),(0,d.default)(e,"spec.addons[1].sources.chart.values",l)}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate;return i.default.createElement("div",{className:v.default.wrapper},i.default.createElement(E.default,{title:t("SYSTEM_COMPONENT_PL"),description:t("CLUSTER_COMPONENTS_DESC")}),i.default.createElement(m.Form,{className:v.default.form,data:r,ref:a},i.default.createElement(m.Form.Item,null,i.default.createElement(h.default,{name:"spec.addons[1].sources.chart.values",components:(0,f.default)(this.props.store.kubekey,"parameters.kubesphere.components",[])}))))}}]),r}(i.default.Component);a.default=g},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(20),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(20),a(29),a(14),a(4),a(18),a(43),a(11);var l=n(a(25)),u=n(a(28)),o=n(a(41)),c=n(a(42)),s=n(a(37)),i=r(a(0)),f=n(a(2367));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var p=function(e){(0,o.default)(a,e);var t=d(a);function a(){return(0,l.default)(this,a),t.apply(this,arguments)}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.components,r=e.onChange;return i.default.createElement("div",null,a.map((function(e){return i.default.createElement(f.default,{data:e,key:e.name,value:t,onChange:r})})))}}]),a}(i.Component);t.default=p},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(12),r(109),r(3),r(10),r(20),r(87),r(98),r(14),r(9),r(4),r(18),r(30),r(11),r(71),r(139),r(79),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(20),r(87),r(98),r(29),r(14),r(9),r(4),r(18),r(43),r(30),r(11),r(71),r(79);var u=l(r(31)),o=l(r(97)),c=l(r(58)),s=l(r(25)),i=l(r(28)),f=l(r(41)),d=l(r(42)),p=l(r(37)),m=n(r(0)),h=l(r(5)),v=l(r(68)),E=l(r(253)),y=l(r(67)),g=l(r(800)),b=l(r(858)),S=r(61),_=l(r(2368)),O=l(r(2370));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var T=function(e){(0,f.default)(r,e);var a=C(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleSwitch=function(t){var a,r=e.props,n=r.data,l=r.value,u=r.onChange;if(t){var o=n.parameters.filter((function(e){return"default"in e&&"enabled"!==e.name})).map((function(e){return"".concat(n.name,".").concat(e.name,"=").concat(e.default)}));a=(0,E.default)([].concat((0,c.default)(l),["".concat(n.name,".enabled=true")],(0,c.default)(o)))}else a=l.filter((function(e){return!e.startsWith(n.name)}));u(a)},e.handleParamsChange=function(t){var a=e.props,r=a.value,n=a.onChange,l=e.props.data.name,u=Object.keys(t).reduce((function(e,a){return[].concat((0,c.default)(e),["".concat(l,".").concat(a,"=").concat(t[a])])}),[]);n((0,E.default)([].concat((0,c.default)(r.filter((function(e){return!e.startsWith(l)}))),(0,c.default)(u))))},e}return(0,i.default)(r,[{key:"renderParams",value:function(){var e=this.props,t=e.data,a=e.value,r=t.parameters.filter((function(e){return"enabled"!==e.name}));if((0,y.default)(r))return null;var n=a.filter((function(e){return e.startsWith(t.name)})).reduce((function(e,a){var r=a.split("="),n=(0,o.default)(r,2),l=n[0],u=n[1];return(0,v.default)(e,l.replace("".concat(t.name,"."),""),u),e}),{});return m.default.createElement("div",{className:"margin-b12"},m.default.createElement(_.default,{data:r,value:n,onChange:this.handleParamsChange}))}},{key:"render",value:function(){var e=this.props,a=e.data,r=e.value;if(!(a.parameters&&a.parameters.some((function(e){return"enabled"===e.name}))))return null;var n=r.some((function(e){return e==="".concat(a.name,".enabled=true")}));return m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:(0,h.default)(O.default.item,(0,u.default)({},O.default.on,n||a.always))},m.default.createElement(g.default,{icon:S.COMPONENT_ICON_MAP[a.name]||"apps",title:t(a.title),description:t(a.description)}),m.default.createElement(b.default,{className:O.default.switch,text:n?t("ENABLED"):t("DISABLED"),onChange:this.handleSwitch,checked:n})),n&&this.renderParams())}}]),r}(m.Component);a.default=T},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(109),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u=l(r(31)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=r(189),m=l(r(798)),h=l(r(1056)),v=l(r(2369));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=function(e){(0,s.default)(r,e);var a=g(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={visible:!1},e.showEdit=function(){e.setState({visible:!0})},e.hideEdit=function(){e.setState({visible:!1})},e.handleEdit=function(t){var a=e.props,r=a.value;(0,a.onChange)(y(y({},r),t)),e.hideEdit()},e}return(0,c.default)(r,[{key:"renderPreview",value:function(){var e=this.props,a=e.data,r=e.value;return d.default.createElement("div",{className:v.default.preview},a.map((function(e){return d.default.createElement("div",{key:e.name,className:v.default.item},d.default.createElement("span",null,t(e.title)||e.name,": "),d.default.createElement("span",null,r[e.name]))})),d.default.createElement("a",{className:v.default.edit,onClick:this.showEdit},t("EDIT")))}},{key:"renderModal",value:function(){var e=this.props,a=e.data,r=e.value;return d.default.createElement(m.default.Form,{title:t("EDIT"),data:r,onOk:this.handleEdit,onCancel:this.hideEdit,visible:this.state.visible},a.map((function(e){return d.default.createElement(p.Form.Item,{key:e.name,label:t(e.title||e.name),desc:t(e.description)},d.default.createElement(h.default,{name:e.name,defaultValue:e.default,param:e}))})))}},{key:"render",value:function(){return d.default.createElement("div",null,this.renderPreview(),this.renderModal())}}]),r}(d.Component);a.default=b},function(e,t,a){e.exports={preview:"_2_vP7hbw0vWvPRoJ3CgBXR",item:"_24DFpoiC_T7CiYzwk41wlV",edit:"_1L1kquFZKnA3h2S4aYPijz"}},function(e,t,a){e.exports={item:"_1h8oTIRT-o4SN2jbQfhU6l",on:"_1kzfykTUroCIhZNvsNok7E",switch:"J049BIAtXjHOeN76eUO0S"}},function(e,t,a){e.exports={wrapper:"_35UinkaQtV5ns5CtdVPeYg",form:"_1EgJsj4-MPBd2pmWDQGAE_"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(14),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(14);var u=l(r(97)),o=n(r(0)),c=r(17),s=r(189),i=l(r(798)),f=l(r(846)),d=r(56),p=r(905),m=l(r(2373)),h=l(r(2375)),v=function(e){var a=e.visible,r=e.isSubmitting,n=e.onCancel,l=e.onOk,v=e.title,E=(0,c.toJS)(e.detail),y=E.expiredDay,g=y&&y<0,b=(0,o.useState)(!1),S=(0,u.default)(b,2),_=S[0],O=S[1],C=(0,o.useState)(""),T=(0,u.default)(C,2),R=T[0],D=T[1],k=(0,o.useState)(!1),N=(0,u.default)(k,2),I=N[0],P=N[1];return o.default.createElement(i.default,{width:600,showIcon:!0,imageIcon:"/extensions-static/ks-console-embed/dist/v3dist/assets/unbindCluster.svg",headerClassName:h.default.header,bodyClassName:h.default.body,title:v,visible:a,isSubmitting:r,onCancel:n,hideFooter:!0},o.default.createElement("div",{style:{padding:"0px 20px"}},o.default.createElement("div",{className:h.default.tipBox},o.default.createElement("p",{className:h.default.title},t("RISK_WARNING")),o.default.createElement("ul",null,o.default.createElement("li",{className:h.default.des},t("REMOVE_CLUSTER_TIP_A")),o.default.createElement("li",{className:h.default.des},t("REMOVE_CLUSTER_TIP_C")))),o.default.createElement("div",{className:h.default.cluster},o.default.createElement("div",{className:h.default.header},o.default.createElement(f.default,{cluster:E,isExpired:g})),o.default.createElement("div",{className:h.default.info},o.default.createElement("div",{className:h.default.item},o.default.createElement("span",{className:h.default.label},t("NODE_COUNT"),":"),o.default.createElement("span",{className:h.default.value},E.nodeCount)),o.default.createElement("div",{className:h.default.item},o.default.createElement("span",{className:h.default.label},t("KUBERNETES_VERSION"),":"),o.default.createElement("span",{className:h.default.value},E.kubernetesVersion)),o.default.createElement("div",{className:h.default.item},o.default.createElement("span",{className:h.default.label},t("PROVIDER"),":"),o.default.createElement("span",{className:h.default.value},E.provider)),o.default.createElement("div",{className:h.default.item},o.default.createElement("span",{className:h.default.label},t("CREATION_TIME"),":"),o.default.createElement("span",{className:h.default.value},(0,d.getLocalTime)(E.createTime).format("YYYY-MM-DD HH:mm:ss"))),o.default.createElement("div",{className:h.default.row},o.default.createElement("span",{className:h.default.label},t("TAG"),":"),o.default.createElement("span",{className:h.default.value},o.default.createElement(p.ClusterTagGroup,{data:E.tags}))))),!_&&o.default.createElement("div",{style:{marginBottom:20}},o.default.createElement(m.default,{width:560,height:40,borderRadius:40,tipText:t("DELETE_CLUSTER_SWIPE_DESC"),handleSuccess:function(){O(!0)}})),_&&o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:h.default.confirmInput},o.default.createElement("p",null,t.html("ENTER_CLUSTER_NAME",{name:E.name})),o.default.createElement(s.Input,{placeholder:E.name,autoFocus:!0,onChange:function(e){D(e.target.value)}}),o.default.createElement(s.Checkbox,{value:I,onChange:P},t("DELETE_CLUSTER_NOTIFICATION_CONFIGURAITON"))))),_&&o.default.createElement("div",{className:h.default.footer},o.default.createElement(s.Button,{onClick:n},t("CANCEL")),o.default.createElement(s.Button,{type:"danger",loading:r,disabled:r||!!E&&R!==E.name,onClick:function(){l(I)}},t("DROP"))))};a.default=v},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(3);var l=n(a(97)),u=r(a(0)),o=n(a(2374)),c=function(e){var t=e.width,a=void 0===t?560:t,r=e.height,n=void 0===r?40:r,c=e.borderRadius,s=void 0===c?40:c,i=e.tipText,f=e.handleSuccess,d=void 0===f?function(){}:f,p=(0,u.useRef)(!1),m=(0,u.useRef)(0),h=(0,u.useRef)(0),v=(0,u.useRef)(a-56),E=(0,u.useRef)(!1),y=(0,u.useState)(!1),g=(0,l.default)(y,2),b=g[0],S=g[1],_=(0,u.useState)(0),O=(0,l.default)(_,2),C=O[0],T=O[1],R=function(){E.current||(p.current=!1,S(!0),T(0))},D=function(e){if(p.current&&!E.current){e.preventDefault(),e.stopPropagation(),h.current=e.x;var t=h.current-m.current;if(t<0&&(t=0),t>=v.current)return t=v.current,T(t),E.current=!0,void(d&&d());T(t)}};(0,u.useEffect)((function(){return document.body.addEventListener("mouseup",R),document.body.addEventListener("mousemove",D),function(){document.body.removeEventListener("mouseup",R),document.body.removeEventListener("mousemove",D)}}),[]);var k={borderRadius:s,opacity:b&&C/v.current,width:56+C,transitionDuration:b&&p.current?"0s":".3s"},N={borderRadius:s,height:n-8,transitionDuration:b&&p.current?"0s":".3s",transform:"translateX(".concat(C,"px)")},I={color:"rgb(".concat(121+C/v.current*134,",\n    ").concat(135+C/v.current*120,",\n    ").concat(156+C/v.current*99,")")};return u.default.createElement("div",{className:o.default.content,style:{width:a}},u.default.createElement("div",{className:o.default.background,style:{borderRadius:s}},u.default.createElement("span",{style:I},i)),u.default.createElement("div",{className:o.default.sliderBox,style:k}),u.default.createElement("div",{style:N,className:o.default.slider,onMouseEnter:function(){E.current||p.current||(S(!0),T(0))},onMouseLeave:function(){E.current||p.current||S(!1)},onMouseDown:function(e){E.current||0!==e.button||(m.current=e.nativeEvent.x||e.touches[0].clientX,p.current=!0)},onMouseUp:R,onMouseMove:D},u.default.createElement("img",{className:o.default.icon,src:"/extensions-static/ks-console-embed/dist/v3dist/assets/ksLogo.svg"})))};t.default=c},function(e,t,a){e.exports={content:"_3ZGXa4C-gz0RDQXj2EmfRb",background:"_2Afm8HbEo9uoZgLe37Flrk",sliderBox:"FxlG-8w-UIpj5qcb3zmmc",slider:"_2gwZRUIcVJLKmsligzPF_4",icon:"_29rGCR-XxnuoLP6eEOxGz1"}},function(e,t,a){e.exports={header:"tmOOCtHbIrKeQ8xSIv2AW",body:"_3dos96Ex-qOKvh04j-PRSJ",tipBox:"_2KHHBfH6SnNFZSSDy5LW_P",title:"_21vopnnvetJvmePQAbmgFR",des:"_1lAfacHxGBPDt9NhCtFXMX",cluster:"_3Q_fFn8LLUmDCpOfK-E1Op",clusterTitle:"_3zlj5cSf3XzoPveDCPNMHQ",info:"_18tGPRwG9cadANDu3vQcLS",row:"_1xxy6fYDzBimEnXHK6FxMO",item:"_20q4gTYObZ3ANQ0QlgW0st",label:"_2U44bSqRrXu08gFCaUJqUV",value:"MRn9T8BlsTO7P1dEOthpV",confirmInput:"oWd2ADDZjJyfMRttMvVtm",footer:"_1QKfPS2L1dQ1O14549Kh-J"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(50)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=r(189),E=n(r(861)),y=n(r(846)),g=n(r(798)),b=n(r(800)),S=n(r(1)),_=r(243),O=n(r(67)),C=n(r(2377));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var R=(0,_.observer)((o=u=function(e){(0,d.default)(r,e);var a=T(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).formRef=h.default.createRef(),e.configValidator=function(e,a,r){return a?(0,O.default)(a)?r({message:t("INPUT_KUBECONFIG"),field:e.field}):void r():r()},e.handleSubmit=function(){var t=e.formRef.current;t&&t.validate((function(){var t=e.props,a=t.formTemplate;(0,t.onOk)(a)}))},e}return(0,f.default)(r,[{key:"render",value:function(){var e=this.props,a=e.detail,r=e.formTemplate,n=e.visible,l=e.store,u=e.readOnly,o=(0,s.default)(e,["detail","formTemplate","visible","store","readOnly"]),i=a.expiredDay,f=i&&i<0;return h.default.createElement(g.default,(0,c.default)({width:960,visible:n},o,{onOk:this.handleSubmit,okText:t("UPDATE"),isSubmitting:l.isSubmitting,store:l,hideFooter:u}),h.default.createElement(v.Columns,null,h.default.createElement(v.Column,{className:"is-6"},h.default.createElement(y.default,{cluster:a,onClick:this.handleClick,isExpired:f})),h.default.createElement(v.Column,{className:"is-6"},h.default.createElement(b.default,{title:a.provider,description:t("PROVIDER")}))),h.default.createElement(v.Form,{data:r,ref:this.formRef},h.default.createElement("div",{className:C.default.editor},h.default.createElement("div",{className:C.default.editorTitle},h.default.createElement(v.Icon,{name:"kubernetes",size:20}),h.default.createElement("span",null,t("INPUT_KUBECONFIG"))),h.default.createElement(v.Form.Item,{rules:[{required:!0,message:t("INPUT_KUBECONFIG")},{validator:this.configValidator}],unControl:!0},h.default.createElement(E.default,{mode:"yaml",name:"kubeconfig",readOnly:u})))))}}]),r}(h.default.Component),u.propTypes={formTemplate:S.default.object,visible:S.default.bool,onOk:S.default.func,readOnly:S.default.bool,onCancel:S.default.func},u.defaultProps={formTemplate:{},visible:!1,readOnly:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=R},function(e,t,a){e.exports={editorTitle:"_3DMYLlAewAg7Yk43i5Zu59",editor:"_2hVhMe5kfVPZtx-aI4_B8Z",link:"_uoUc30jYg3tddfXLhIou"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=r(189),m=n(r(798)),h=r(17),v=n(r(831)),E=n(r(861)),y=n(r(1)),g=n(r(204)),b=n(r(2379));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=function(e){(0,s.default)(r,e);var a=S(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).formRef=d.default.createRef(),t.handleSubmit=function(){var e=t.formRef.current,a=t.state.formData;e&&e.validate((function(){var e=t.props,r=e.formTemplate;(0,e.onOk)((0,g.default)({},a,r))}))},t.state={formData:(0,v.default)((0,h.toJS)(e.detail._originData||e.detail))},t}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formTemplate,r=e.visible,n=e.readOnly,o=e.store,c=(e.onOk,(0,u.default)(e,["formTemplate","visible","readOnly","store","onOk"]));return d.default.createElement(m.default,(0,l.default)({width:960,visible:r},c,{onOk:this.handleSubmit,okText:t("OK"),isSubmitting:o.isSubmitting,store:o,hideFooter:n}),d.default.createElement(p.Form,{data:a,ref:this.formRef},d.default.createElement("div",{className:b.default.editor},d.default.createElement(p.Form.Item,{label:t("CLUSTER_CONFIG"),unControl:!0},d.default.createElement(E.default,{mode:"yaml",name:"spec.config",options:this.editOptions})))))}},{key:"editOptions",get:function(){return{width:"100%",height:"100%"}}}]),r}(d.default.Component);a.default=_,_.propTypes={formTemplate:y.default.object,visible:y.default.bool,onOk:y.default.func,readOnly:y.default.bool,onCancel:y.default.func},_.defaultProps={formTemplate:{},visible:!1,readOnly:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={editor:"_36_GyGwWMvnHoN-unWOC9G"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=r(865),c=n(r(2381));function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var i={"pod.events":{on:function(e){var a=e.store,r=e.detail,n=e.success,i=(0,u.default)(e,["store","detail","success"]),f=o.Modal.open(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({onOk:function(){o.Modal.close(f),n&&n()},store:a,modal:c.default,title:t("REMOVE_CLUSTER"),resource:r.name,detail:r,hideFooter:!0},i))}}};a.default=i},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(138),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(247),r(29),r(138),r(4),r(21),r(18),r(43),r(11);var u=n(r(317)),o=n(r(38));r(35);var c,s=n(r(39)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=l(r(0)),v=n(r(26)),E=n(r(1162)),y=r(243),g=r(189),b=n(r(1163)),S=r(865),_=r(56),O=n(r(2382));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var T=(0,y.observer)(c=function(e){(0,d.default)(n,e);var a,r=C(n);function n(e){var a;return(0,i.default)(this,n),(a=r.call(this,e)).getColumns=function(){return[{title:t("TYPE"),dataIndex:"type",width:"10%",render:function(e){return h.createElement(S.Status,{type:e,name:t("EVENT_".concat(e.toUpperCase()))})}},{title:t("REASON"),dataIndex:"reason",width:"16%"},{title:t("EVENT_AGE"),dataIndex:"age",width:"16%",sorter:!0,sortOrder:a.state.reverse},{title:t("SOURCE"),dataIndex:"from",width:"18%"},{title:t("MESSAGE"),dataIndex:"message"}]},a.handleSort=function(e,t){a.setState({reverse:t.order})},a.state={reverse:"descend"},a.eventStore=new b.default,a}return(0,f.default)(n,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:(a=(0,s.default)(o.default.mark((function e(){var t,a,r,n,l,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,a=t.detail,r=void 0===a?{}:a,n=t.cluster,l=(0,v.default)(r,"namespace",""),u={"involvedObject.name":(0,v.default)(r,"name",""),"involvedObject.namespace":l,"involvedObject.uid":(0,v.default)(r,"uid","")},this.eventStore.fetchList({namespace:l,cluster:n,fieldSelector:(0,_.joinSelector)(u)});case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderList",value:function(){var e=this.eventStore.list,a=e.data,r=void 0===a?[]:a,n=e.isLoading,l=(0,E.default)(r,"lastTimestamp","descend"===this.state.reverse?"desc":"asc");return h.createElement(g.Table,{className:O.default.table,dataSource:l,columns:this.getColumns(),onChange:this.handleSort,loading:n,emptyText:h.createElement("div",{className:O.default.emptyText},h.createElement("span",{className:O.default.emptyTipIcon},h.createElement(g.Icon,{name:"exclamation",size:48})),h.createElement("div",null,t("NO_MATCHING_RESULT_FOUND")))})}},{key:"render",value:function(){var e=Object.assign({},this.props);return h.createElement(S.Modal,(0,u.default)({},e,{width:1160}),this.renderList())}}]),n}(h.Component))||c;a.default=T},function(e,t,a){e.exports={table:"tOiaKatBjeSawrS1dQYnx",emptyText:"_39sGt_r6mkkkzM7UceM_fW",emptyTipIcon:"_1nh-INf1jINzuI-ko6Q3d-"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(66),r(20),r(14),r(8),r(13),r(9),r(30),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(66),r(20),r(27),r(446),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(67)),f=r(865),d=n(r(2384)),p=n(r(2387)),m=n(r(2388)),h=n(r(2393));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={"cluster.tag.add":{on:function(e){var a,r=e.store,n=e.module,o=e.success,i=(0,c.default)(e,["store","module","success"]),p=f.Modal.open(E({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.create(a);case 4:f.Modal.close(p),s.default.success({content:t("CREATE_SUCCESSFUL")}),o&&o();case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),okText:t("CREATE"),module:n,title:t("CREATE_TAGS"),modal:d.default,isAdd:!0,store:r},i))}},"cluster.tag.edit":{on:function(e){var a,r=e.store,n=e.module,o=e.success,i=(0,c.default)(e,["store","module","success"]),p=f.Modal.open(E({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,g(r,a,i.name);case 4:f.Modal.close(p),s.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o();case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),module:n,title:t("EDIT_TAG"),modal:d.default,isAdd:!1,store:r},i))}},"cluster.tag.delete":{on:function(e){var a,r=e.store,n=e.module,o=e.detail,i=e.success,d=(0,c.default)(e,["store","module","detail","success"]),m=[].concat(o).map((function(e){return"".concat(e.label,":").concat(e.value)})).join(", "),h=f.Modal.open(E(E({onOk:(a=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(r,o);case 2:f.Modal.close(h),s.default.success({content:t("DELETED_SUCCESSFULLY")}),i&&i();case 5:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),module:n,title:1===m.split(", ").length?t("DELETE_TAG"):t("DELETE_MULTIPLE_TAGS"),modal:p.default,store:r},d),{},{resource:m,desc:1===m.split(", ").length?t.html("DELETE_CLUSTER_TAG_CONFIRM_DESC",{resource:m}):t.html("DELETE_CLUSTER_TAGS_CONFIRM_DESC",{resource:m})}))}},"cluster.tag.bind":{on:function(e){var a,r=e.store,n=e.module,o=e.success,d=(0,c.default)(e,["store","module","success"]),p=f.Modal.open(E({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,i.default)(a)){e.next=3;break}return e.next=3,_(r,a,[d.detail]);case 3:f.Modal.close(p),s.default.success({content:t("ADD_TAG_SUCCESSFUL")}),o&&o();case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),title:t("ADD_TAG_TO_CLUSTERS"),module:n,modal:m.default,hasBundled:!1,store:r},d))}},"cluster.tag.hasBundled":{on:function(e){var a,r=e.store,n=e.module,o=e.success,i=(0,c.default)(e,["store","module","success"]),d=f.Modal.open(E({onOk:function(e,t){f.Modal.close(d),o&&t&&o()},module:n,title:t("REMOVE_TAG_FROM_CLUSTERS"),modal:m.default,hasBundled:!0,onUnBind:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(r,a,i.detail.name);case 2:s.default.success({content:t("REMOVE_TAG_SUCCESSFUL")});case 3:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r},i))}},"cluster.tag.clusterItemTags":{on:function(e){var a,r=e.store,n=e.module,o=e.success,s=(0,c.default)(e,["store","module","success"]),d=f.Modal.open(E({onOk:(a=(0,u.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,i.default)(t)){e.next=3;break}return e.next=3,_(r,[].concat(s.detail),t);case 3:f.Modal.close(d),!(0,i.default)(t)&&o&&o();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),title:t("ADD_TAGS"),module:n,modal:h.default,isAdd:!1,store:r},s))}}};function g(e,t,a){return e.update(t[0],{name:a})}function b(e,t){return e.delete([].concat(t).map((function(e){return e.name})))}function S(e,t,a){return e.unBind({clusters:[t.name]},{name:a})}function _(e,t,a){return e.bind({labels:a.map((function(e){return e.name})),clusters:t.map((function(e){return e.name}))})}a.default=y},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(192),r(4),r(18),r(11),r(817),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(317)),o=l(r(31)),c=l(r(50)),s=l(r(25)),i=l(r(28)),f=l(r(41)),d=l(r(42)),p=l(r(37));r(32),r(192),r(29),r(4),r(18),r(43),r(11),r(817);var m=n(r(0)),h=l(r(798)),v=r(189),E=l(r(5)),y=l(r(67)),g=l(r(163)),b=l(r(1404)),S=l(r(2385));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var O=function(e){(0,f.default)(r,e);var a=_(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).handleOk=function(){var e,t=n.props.onOk,a=n.state.value;null===(e=n.ref.current)||void 0===e||e.validate((function(){t(a)}))},n.handleTagsInputError=function(e){if(null==e?void 0:e.message)return n.setState({notValidTags:!0});n.setState({notValidTags:!1})},n.labelsValidator=function(e,a,r){return(0,g.default)(a)?r():(0,y.default)(a)?r({message:t("CLUSTER_TAG_EMPTY_DESC")}):!!a.every((function(e){var t=e.key.trim(),a=e.value.trim();return t.length<=63&&a.length<=63&&""!==t&&""!==a}))||r({message:t("ENT_CLUSTER_TAG_DESC")})},n.state={value:e.detail,notValidTags:!1},n.ref=m.createRef(),n}return(0,i.default)(r,[{key:"componentDidUpdate",value:function(e){e.detail!==this.props.detail&&this.props.detail!==this.state.value&&this.setState({value:this.props.item})}},{key:"render",value:function(){var e=this.props,a=e.isAdd,r=void 0===a||a,n=(0,c.default)(e,["isAdd"]);return m.createElement(h.default.Form,(0,u.default)({width:960},n,{formRef:this.ref,data:this.state,onOk:this.handleOk,disableOk:this.state.notValidTags}),r&&m.createElement(m.Fragment,null,m.createElement(v.Alert,{type:"info",message:t("CREATE_TAGS_DESC")}),m.createElement("div",{className:(0,E.default)(b.default.tagAddTitle)},t("TAG_PL"))),m.createElement(v.Form.Item,{rules:[{required:!0,message:t("CLUSTER_TAG_EMPTY_DESC")},{validator:this.labelsValidator}]},m.createElement(S.default,{name:"value",addText:t("ADD"),onError:this.handleTagsInputError,className:(0,E.default)(b.default.tagItem,(0,o.default)({},b.default.tagItemUpdate,!r))})))}}]),r}(m.Component);a.default=O},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(192),r(10),r(6),r(20),r(98),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(10),r(6),r(20),r(98),r(29),r(4),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(58)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(5)),m=r(189),h=n(r(67)),v=n(r(119)),E=n(r(2386)),y=n(r(1405));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=function(e){(0,s.default)(r,e);var a=g(r);function r(e){var n;return(0,o.default)(this,r),(n=a.call(this,e)).handleAdd=function(){n.setState((function(e){var t=e.arrayValues;return{arrayValues:[].concat((0,u.default)(t),[{key:""}])}}))},n.triggerChange=function(e){var a=n.props.onChange;n.props.onError();var r=e.some((function(e){return(0,h.default)(e.key)})),l=!1,u=(0,v.default)(e);e.forEach((function(e,t){u[t]=void 0;var a=u.filter((function(t){return t&&t.key===e.key&&t.value===e.value}));(0,h.default)(a)||(l=!0)})),n.setState({arrayValues:e},(function(){r||a(e)})),r?n.props.onError({message:t("EMPTY_KEY")}):l?n.props.onError({message:t("DUPLICATE_LABELS")}):n.props.onError()},n.handleItemChange=function(e,t){var a=n.state.arrayValues;a[e]=t,n.triggerChange(a)},n.handleItemDelete=function(e){var t=n.state.arrayValues;n.triggerChange(t.filter((function(t,a){return a!==e})))},n.state={isValidValues:!0,arrayValues:e.value||[{key:"",value:""}]},n}return(0,c.default)(r,[{key:"isAddEnable",value:function(){return this.state.arrayValues.every((function(e){return!((0,h.default)(e)||!e.key&&!e.value)}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.className,r=t.addText,n=t.itemProps,u=this.state.arrayValues;return d.default.createElement("div",{className:(0,p.default)(y.default.wrapper,a)},u.map((function(t,a){return d.default.createElement(E.default,(0,l.default)({key:"array-".concat(a),index:a,value:t||{},onChange:e.handleItemChange,onDelete:e.handleItemDelete,keyProps:{maxlength:63},valueProps:{maxlength:63}},n))})),d.default.createElement("div",{className:"text-right"},d.default.createElement(m.Button,{className:y.default.add,onClick:this.handleAdd,disabled:!this.isAddEnable()},r)))}}]),r}(d.default.Component);a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=r(189),m=n(r(841)),h=n(r(1405));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var E=function(e){(0,s.default)(r,e);var a=v(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleChange=function(t){var a=e.props,r=a.index;(0,a.onChange)(r,t)},e.handleDelete=function(){var t=e.props,a=t.index;(0,t.onDelete)(a)},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.readOnly,r=(e.onDelete,e.onChange,e.keyProps),n=void 0===r?{}:r,o=e.valueProps,c=void 0===o?{}:o,s=(0,u.default)(e,["readOnly","onDelete","onChange","keyProps","valueProps"]),i=n.component,f=void 0===i?p.Input:i,v=(0,u.default)(n,["component"]),E=c.component,y=void 0===E?p.Input:E,g=(0,u.default)(c,["component"]);return d.default.createElement("div",{className:h.default.item},d.default.createElement(m.default,(0,l.default)({},s,{onChange:this.handleChange}),d.default.createElement(f,(0,l.default)({name:"key",placeholder:t("KEY"),readOnly:a},v)),d.default.createElement(y,(0,l.default)({name:"value",placeholder:t("VALUE"),readOnly:a},g))),!a&&d.default.createElement(p.Button,{type:"flat",icon:"trash",className:h.default.delete,onClick:this.handleDelete}))}}]),r}(d.default.Component);a.default=E},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=r(189),p=l(r(822)),m=l(r(1404));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(r,e);var a=h(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).width=600,e}return(0,o.default)(r,[{key:"renderAlert",value:function(){return f.createElement(d.Alert,{className:m.default.alert,type:"warning",message:t("DELETE_CLUSTER_TAG_DESC")})}}]),r}(p.default);a.default=v},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(44),r(6),r(70),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(66),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(73),r(7);var u,o=n(r(317)),c=n(r(50)),s=n(r(31)),i=n(r(58)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=r(189),E=n(r(5)),y=n(r(67)),g=n(r(140)),b=n(r(1107)),S=r(243),_=l(r(0)),O=n(r(946)),C=r(865),T=n(r(1049)),R=n(r(1048)),D=n(r(2389)),k=n(r(2390));function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var A=(0,S.observer)(u=function(e){(0,p.default)(r,e);var a=P(r);function r(e){var n;return(0,f.default)(this,r),(n=a.call(this,e)).getParamsLabel=function(e){var t=e.group,a=e.tags,r=void 0===a?[]:a;return t&&(t="cluster.kubesphere.io/group=".concat(t)),r=r.map((function(e){return"label.cluster.kubesphere.io/".concat(e)})),[t].concat((0,i.default)(r)).filter(Boolean).join(",")},n.getList=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.props,r=a.hasBundled,l=a.detail.name,u=a.getList;(n.setState({loading:!0}),r)&&(t.tags=(null!==(e=t.tags)&&void 0!==e?e:[]).concat(l));var o=I(I({},(0,g.default)(t,"group","tags","__index")),{},{labelSelector:n.getParamsLabel(t)});u(o).then((function(e){n.setState({loading:!1,list:r?e:e.filter((function(e){return!e.tags.find((function(e){return e.name===l}))}))})}))},n.handleAdd=function(e){n.setState((function(t){var a=t.value;return{value:[].concat((0,i.default)(a),[e])}}))},n.handleDelete=function(e){n.setState((function(t){return{value:t.value.filter((function(t){return t.name!==e.name}))}}))},n.handleOk=function(){var e=n.props.onOk;e&&e(n.state.value,!!n.state.hasRemoved.length)},n.handleCancel=function(){var e=n.props,t=e.onCancel,a=e.onOk;n.state.hasRemoved.length?a&&a(n.state.value,!0):t&&t()},n.handleOnUnBind=function(e){var t=n.props.onUnBind;t&&t(e),n.setState({hasRemoved:[].concat((0,i.default)(n.state.hasRemoved),[e.name])})},n.handleReset=function(){n.getList(n.state.filters)},n.clearFilter=function(){n.setState({filters:{}}),n.getList()},n.renderEmpty=function(){var e=n.props.hasBundled;return _.createElement(T.default,{icon:"exclamation",title:t("NO_CLUSTER_FOUND"),desc:null,action:e?null:_.createElement("p",null,t("YOU_CAN_TRY_TO"),_.createElement("span",{className:D.default.action,onClick:n.handleReset,"data-test":"table-empty-refresh"},t("REFRESH_DATA")),t("OR"),_.createElement("span",{className:D.default.action,onClick:n.clearFilter,"data-test":"table-empty-clear-filter"},t("CLEAR_SEARCH_CONDITIONS")))})},n.state={list:[],filters:{},value:[],hasRemoved:[],loading:!1},n.tagsStore=new O.default,n}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.getList(),this.tagsStore.fetchGroupList()}},{key:"render",value:function(){var e=this,a=this.props,r=a.hasBundled,n=(a.onUnBind,a.detail),l=(0,c.default)(a,["hasBundled","onUnBind","detail"]),u=this.state,s=u.list,i=u.hasRemoved,f=u.loading,d=u.value,p=s.filter((function(e){return!i.includes(e.name)})),m=n&&"[".concat(n.label,":").concat(n.value,"]");return _.createElement(C.Modal,(0,o.default)({headerClassName:D.default.header,width:960},l,{title:r?_.createElement("span",{className:D.default["title-text"]},t("REMOVE_TAG_FROM_CLUSTERS")," ",m):t("ADD_TAG_TO_CLUSTERS"),onOk:this.handleOk,onCancel:this.handleCancel,hideFooter:r}),_.createElement(v.Alert,{type:"warning",message:t("ADD_TAG_DESC")}),_.createElement("div",{className:D.default.title},t("CLUSTER_PL")),_.createElement("div",null,f&&_.createElement(v.Loading,{size:"large",className:D.default.loading}),_.createElement("div",{className:D.default.bindContainer},!r&&_.createElement(R.default,{placeholder:t("SEARCH_BY_NAME"),columns:this.columns,onChange:function(t){e.setState({filters:t}),e.getList(t)},filters:this.state.filters}),p.map((function(t){var a=I(I({},t),{},{tags:t.tags.map((function(t){return e.tagsStore.tags.find((function(e){return e.name===t.name}))})).filter(Boolean)}),n=a.expiredDay,l=n&&n<0,u=(0,b.default)(d,{uid:a.uid});return _.createElement(k.default,{key:a.uid,data:a,hasBundled:r,isExpired:l,isChecked:u,onAdd:e.handleAdd,onDelete:e.handleDelete,onUnBind:e.handleOnUnBind})})),(0,y.default)(p)&&this.renderEmpty())))}},{key:"columns",get:function(){var e,a;return[{dataIndex:"name",title:t("NAME"),search:!0},{dataIndex:"alias",title:t("ALIAS")},{dataIndex:"group",title:t("TYPE"),search:!0,filters:(null!==(e=this.tagsStore.group)&&void 0!==e?e:[]).map((function(e){return{text:e,value:e}})),renderSearch:function(e){return _.createElement("div",{className:"flex"},_.createElement("div",{className:(0,E.default)(D.default.clusterGroupTag,(0,s.default)({},D.default[e.key],!0))},t("ENV_".concat(e.label.toUpperCase()))),e.label)}},{dataIndex:"tags",title:t("TAG_PL"),filters:(null!==(a=this.tagsStore.tags)&&void 0!==a?a:[]).map((function(e){return{text:"".concat(e.label,":").concat(e.value),value:e.name}})),search:!0,multi:!0,renderSearch:function(e){return _.createElement("div",null,e.label)}}]}}]),r}(_.Component))||u;a.default=A},function(e,t,a){e.exports={header:"_2cr4-2fn6ZVxjsxSMcZUig",bindContainer:"tNOa2EL27AfZiO2ZR8X2N",title:"_27U9qtKLZLLaVaV962NmSl","title-text":"_2bwXmI1jjYYEgBER_lIpVn",clusterGroupTag:"asBnEP-QmaK_c2rUi_em1",production:"_1oup3lUa7IHFoiyXgT3MTn",development:"_2vOI0ZGF4Kix3qif4cdDsq",testing:"_1pAhmfcRN1P3di10eJhrD-",demo:"_3BgkAEAOGO_uworLTWtfAQ",loading:"PBENJVDRQo4Ld4LJ4G6Ps",action:"_1cbBeiU9Q3bwhtrTCd8Vvi"}},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var u,o,c,s=n(r(31)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=l(r(0)),v=n(r(1)),E=r(189),y=n(r(5)),g=n(r(846)),b=r(865),S=r(905),_=n(r(2391));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var C=(0,n(r(961)).default)(["chain-off-duotone"])((c=o=function(e){(0,d.default)(r,e);var a=O(r);function r(e){var n;return(0,i.default)(this,r),(n=a.call(this,e)).handleChange=function(e){var t=n.props,a=t.onAdd,r=t.onDelete,l=t.data;e?a&&a(l):r&&r(l)},n.renderPopconfirm=function(){var e=n.props,a=e.onUnBind,r=e.data;return h.createElement("div",null,h.createElement("div",{className:_.default.body},h.createElement("div",{className:_.default.header},h.createElement(E.Icon,{name:"information",type:"green",size:20}),h.createElement("span",null,t("REMOVE_TAG"))),h.createElement("div",{className:_.default.desc},t("REMOVE_TAG_DESC"))),h.createElement("div",{className:_.default.footer},h.createElement(E.Button,null,t("CANCEL")),h.createElement(E.Button,{type:"control",onClick:function(){return a(r)}},t("OK"))))},n.state={},n}return(0,f.default)(r,[{key:"render",value:function(){var e,a,r=this.props,n=r.data,l=r.isExpired,u=r.isChecked,o=r.hasBundled;return h.createElement("li",{className:(0,y.default)(_.default.wrapper,(e={},(0,s.default)(e,_.default.itemWithCheckbox,!o),(0,s.default)(e,_.default.itemWithButton,o),e)),"data-test":"cluster-item"},!o&&h.createElement("div",null,h.createElement(E.Checkbox,{checked:u,disabled:n.tags.length>=5,onChange:this.handleChange})),h.createElement(g.default,{cluster:n,isExpired:l}),h.createElement(b.Text,{title:h.createElement(S.ClusterTagGroup,{empty:"-",data:null!==(a=null==n?void 0:n.tags)&&void 0!==a?a:[]}),description:t("TAG_PL")}),o&&h.createElement("div",null,h.createElement(E.Dropdown,{className:_.default.popconfirm,content:this.renderPopconfirm(),placement:"left"},h.createElement(E.Button,{className:_.default.itemCloseButton},h.createElement(E.Icon,{name:"chain-off-duotone"}))),h.createElement("span",{className:_.default.itemCloseIcon},h.createElement(E.Icon,{name:"chain-off-duotone"}))))}}]),r}(h.Component),o.propTypes={data:v.default.object,isExpired:v.default.bool,isChecked:v.default.bool,hasBundled:v.default.bool,onAdd:v.default.func,onDelete:v.default.func,onUnBind:v.default.func},u=c))||u;a.default=C},function(e,t,a){e.exports={wrapper:"_3TrpZAZ3rgo39zOFZHy8xz",icon:"Zi3B5-Wsb-8T_s2aNJNQq",indicator:"_15a5i-zVfIE2ZvIsIlbMHx",itemWithButton:"_1ezmOe2ce-Ti0CMtdJM-yv",itemWithCheckbox:"EwrSmju5xej7jB6369Iie",itemCloseButton:"_3C8K2FArTgOSTqJcodaziA",itemCloseIcon:"_4puH2z6rvpiySiIfOO-2g",popconfirm:"oUkiKzGAnbQh8iG6baohw",body:"mHrc4zc9iyde_dCL2NmHL",header:"_1IEA6_50QyV57w4Qsr27Is",desc:"_2cNWy8q3JOj7RqEkTJZb3b",footer:"_3KkbOlGfceZx6Dql_Lrl5V"}},,function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(10),r(44),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(44),r(29),r(14),r(4),r(18),r(43),r(11);var u,o=n(r(317)),c=n(r(50)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=l(r(0)),h=r(189),v=r(243),E=r(17),y=r(865),g=r(905),b=n(r(2394));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,v.observer)(u=function(e){(0,f.default)(r,e);var a=S(r);function r(e){var t;return(0,s.default)(this,r),(t=a.call(this,e)).handleChange=function(e){t.setState({value:e})},t.handleOk=function(){var e=t.props,a=e.onOk,r=e.defaultValue,n=t.state.value;a((void 0===n?[]:n).filter((function(e){return!r.find((function(t){return t.name===e.name}))})))},t.state={list:e.list,value:e.value},t}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props,a=(e.tagsGroup,e.tags),r=e.onAddTags,n=e.defaultValue,l=void 0===n?[]:n,u=(0,c.default)(e,["tagsGroup","tags","onAddTags","defaultValue"]),s=this.state.value;return m.createElement(y.Modal,(0,o.default)({width:600},u,{onOk:this.handleOk}),m.createElement("div",{className:b.default.wrapper},m.createElement(h.Alert,{type:"info",message:t("ADD_TAG_DESC")}),m.createElement("div",{className:b.default.title},t("ADD_TAGS")),m.createElement(g.ClusterTagAdd,{value:s,tagsGroup:(0,E.toJS)(this.props.store.tagsGroup),onChange:this.handleChange,defaultValue:l,onAddTags:r,tags:a})))}}]),r}(m.Component))||u;a.default=_},function(e,t,a){e.exports={wrapper:"FiDtjjOYi_dnAFmvmrS9j",title:"_1LaxNlg30y7jjTiSh0zwsn"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(50)),c=n(r(31)),s=n(r(798)),i=n(r(191)),f=n(r(822)),d=n(r(2396)),p=n(r(438)),m=n(r(119)),h=n(r(26)),v=n(r(68)),E=r(1165);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b=function(e){var t,a=e.data,r=e.module,n=e.devops,l=p.default[r]({namespace:n}),u=a.sources.source_type,o=(0,h.default)(a,"sources.".concat(u,"_source"),{}),c={git:E.getGitSource,github:E.getGithubSource,bitbucket_server:E.getBitbucketSource,gitlab:E.getGitlabSource}[u],s=g({provider:a.sources.source_type,secret:{name:o.credential_id||a.sources.credentialId,namespace:n}},null!==(t=null==c?void 0:c(o))&&void 0!==t?t:{});return(0,v.default)(l,"metadata",a.metadata),(0,v.default)(l,"spec",s),l},S={"codeRepo.create":{on:function(e){var a,r=e.store,n=e.cluster,c=e.devops,f=e.module,p=e.success,m=(0,o.default)(e,["store","cluster","devops","module","success"]),h=s.default.open(g({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=b({data:a,module:f,devops:c}),e.next=3,r.create({data:u,devops:c,cluster:n});case 3:i.default.success({content:t("CREATE_SUCCESSFUL")}),p&&p(),s.default.close(h);case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,module:f,cluster:n,devops:c,formTemplate:{},modal:d.default},m))}},"codeRepo.edit":{on:function(e){var a,r,n=e.store,f=e.cluster,p=e.devops,v=e.module,E=e.detail,y=e.success,S=(0,o.default)(e,["store","cluster","devops","module","detail","success"]),_=(0,m.default)(E),O=(0,h.default)(_,"_originData.metadata",{}),C="git"===_.provider?"url":"repo",T={metadata:O,sources:(a={source_type:_.provider},(0,c.default)(a,"".concat(_.provider,"_source"),(0,c.default)({},C,_.repoURL)),(0,c.default)(a,"credentialId",_.secret.name),a)},R=s.default.open(g({onOk:(r=(0,u.default)(l.default.mark((function e(a){var r;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=b({data:a,module:v,devops:p}),e.next=3,n.edit({data:r,devops:p,name:E.name,cluster:f});case 3:i.default.success({content:t("UPDATE_SUCCESSFUL")}),y&&y(),s.default.close(R);case 6:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)}),store:n,module:v,cluster:f,devops:p,formTemplate:T,modal:d.default,isEdit:!0},S))}},"codeRepo.delete":{on:function(e){var a,r=e.store,n=e.detail,c=e.devops,d=e.success,p=(0,o.default)(e,["store","detail","devops","success"]),m=s.default.open(g({onOk:(a=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.delete(g(g({},n),{},{devops:c,cluster:p.cluster}));case 2:s.default.close(m),i.default.success({content:t("DELETED_SUCCESSFULLY")}),d&&d();case 5:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),store:r,modal:f.default,resource:n.name},p))}}};a.default=S},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(50)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=r(189),m=n(r(798)),h=n(r(840)),v=n(r(2397)),E=n(r(1407)),y=n(r(1)),g=n(r(0)),b=r(61),S=n(r(2408));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var C=function(e){(0,i.default)(r,e);var a=O(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).resetSubRoute=function(){t.setState({subRoute:{}})},t.registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.showSelectRepo=function(){t.setState({showSelectRepo:!0})},t.hideSelectRepo=function(){t.setState({showSelectRepo:!1})},t.handleSubFormSave=function(){var e=t.state.subRoute;e&&e.onSave&&e.onSave((function(){t.setState({subRoute:{}})}))},t.handleSubFormCancel=function(){var e=t.state.subRoute;e&&e.onCancel&&(e.onCancel(),t.setState({subRoute:{}}))},t.handleRepoChange=function(e,a){t.setState({showSelectRepo:!1},(function(){t.scmRef.current.onChange(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({source_type:e},a))}))},t.handleDeleteSource=function(){t.scmRef.current.onChange()},t.submit=function(){var e=t.props,a=e.formTemplate,r=e.onOk;t.formRef.current.validate((function(){r(a)}))},t.state={showSelectRepo:!1},t.scmRef=g.default.createRef(),t.formRef=g.default.createRef(),t}return(0,s.default)(r,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}},{key:"renderRepoSelectForm",value:function(){var e=this.props,t=e.formTemplate,a=e.devops,r=e.cluster,n=(0,u.default)(e,["formTemplate","devops","cluster"]),o=this.state.showSelectRepo;return g.default.createElement(m.default,(0,l.default)({width:970},n,{disableSubmit:o}),g.default.createElement("div",{className:S.default.wrapper},g.default.createElement(E.default,{sourceData:t.sources,devops:a,name:t.name,cluster:r,onSave:this.handleRepoChange,onCancel:this.hideSelectRepo,noSVN:!0,noJenkins:!0}),g.default.createElement(h.default,{className:S.default.confirm,onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel})))}},{key:"render",value:function(){var e=this.props,a=e.formTemplate,r=e.isEdit,n=(0,u.default)(e,["formTemplate","isEdit"]);return this.state.showSelectRepo?this.renderRepoSelectForm():g.default.createElement(m.default,(0,l.default)({width:970},n,{onOk:this.submit}),g.default.createElement(p.Form,{ref:this.formRef,data:a},g.default.createElement(p.Columns,null,g.default.createElement(p.Column,null,g.default.createElement(p.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:b.PATTERN_NAME,message:t("INVALID_NAME_DESC")}]},g.default.createElement(p.Input,{name:"metadata.name",maxLength:63,disabled:r})),g.default.createElement(p.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},g.default.createElement(p.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256}))),g.default.createElement(p.Column,null,g.default.createElement(p.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:b.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},g.default.createElement(p.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),g.default.createElement(p.Form.Item,{label:t("CODE_REPOSITORY"),rules:[{required:!0,message:t("REPO_EMPTY_DESC")}]},g.default.createElement(v.default,{name:"sources",ref:this.scmRef,onClick:this.showSelectRepo,handleDeleteSource:this.handleDeleteSource,devops:this.props.devops,type:"cd"}))))}}]),r}(g.default.Component);a.default=C,C.childContextTypes={registerSubRoute:y.default.func,resetSubRoute:y.default.func}},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(67)),f=n(r(26)),d=n(r(0)),p=n(r(5)),m=n(r(1)),h=r(189),v=r(61),E=n(r(1406));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var g=function(e){(0,o.default)(r,e);var a=y(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).onChange=function(t){e.props.onChange(t)},e.handleDeleteSource=function(){e.props.handleDeleteSource()},e.getIconName=function(e){var t="";switch(e){case"single_svn":t="svn";break;case"bitbucket_server":t="bitbucket";break;default:t=e}return t},e}return(0,u.default)(r,[{key:"renderEmpty",value:function(){var e=this.props,a=e.onClick,r=e.type;return d.default.createElement("div",{className:E.default.empty,onClick:a},d.default.createElement("p",null,"cd"===r?t("CD_SELECT_CODE_REPO_DESC"):t("SELECT_CODE_REPO_DESC")))}},{key:"render",value:function(){var e=this.props.value;if((0,i.default)(e))return this.renderEmpty();var a=(0,f.default)(e,"".concat(v.REPO_KEY_MAP[e.source_type]),{}),r=this.getIconName(e.source_type);return d.default.createElement("div",{className:E.default.wrapper},d.default.createElement("div",{className:(0,p.default)(E.default.branch,E.default.branch__show)},d.default.createElement("div",{className:E.default.icon},d.default.createElement(h.Icon,{name:r,size:48})),d.default.createElement("div",{className:E.default.info},d.default.createElement("div",{className:E.default.name},a.repo||a.url||a.remote),d.default.createElement("div",{className:E.default.desc},a.description||"")),d.default.createElement("div",{className:E.default.action},d.default.createElement(h.Button,{onClick:this.props.onClick},t("RESELECT")),this.props.handleDeleteSource?d.default.createElement("span",{onClick:this.handleDeleteSource,className:E.default.deleteRepoBtn},d.default.createElement(h.Icon,{name:"trash"})):null)))}}]),r}(d.default.Component);a.default=g,g.propTypes={name:m.default.string,value:m.default.object,onClick:m.default.func},g.defaultProps={name:"",value:{},onClick:function(){}}},function(e,t,a){e.exports={desc:"_2tdVqiHSAO-_hh2j8kmDdY",narrowItem:"_2dCR56ukrNg2YglIMXZMEw"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u=n(r(58)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(243),h=n(r(244)),v=r(189),E=n(r(2400));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,m.observer)(l=function(e){(0,i.default)(r,e);var a=b(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).getCredentialsListData=function(t){var a=e.props,r=a.devops,n=a.cluster;return e.props.store.getCredentials(g({devops:r,cluster:n},t))},e.getCredentialsList=function(){return(0,u.default)(e.props.store.credentials.data.map((function(e){return{label:e.name,value:e.name,type:e.type}})))},e.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return p.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",p.default.createElement(v.Tag,{type:n?"":"warning"},r&&t("CREDENTIAL_TYPE_".concat(r.toUpperCase()))))},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props.store,a=e.formData,r=e.credentials,n=this.props,l=n.formRef,u=n.noJenkins;return p.default.createElement("div",{className:E.default.card},p.default.createElement(v.Form,{data:a,ref:l},p.default.createElement(v.Form.Item,{label:t("CODE_REPOSITORY_ADDRESS"),desc:u?"":t("CODE_REPOSITORY_ADDRESS_DESC"),rules:[{required:!0,message:t("CODE_REPOSITORY_ADDRESS_EMPTY_TIP")}]},p.default.createElement(v.Input,{name:"git_source.url"})),p.default.createElement(v.Form.Item,{label:t("CREDENTIAL_SI"),desc:p.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),p.default.createElement("span",{className:E.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL")))},p.default.createElement(v.Select,{name:"git_source.credential_id",options:this.getCredentialsList(),pagination:(0,h.default)(r,["page","limit","total"]),isLoading:r.isLoading,onFetch:this.getCredentialsListData,optionRenderer:this.optionRender,valueRenderer:this.optionRender,placeholder:" ",searchable:!0,clearable:!0}))))}}]),r}(p.default.Component))||l;a.default=S},function(e,t,a){e.exports={clickable:"_1gg18qWju-mAY-nQq_wdeZ",card:"Lfxi8U7_UunjUufMzWdBz"}},function(e,t,a){e.exports={repo:"_2p3YQU1s-Jm35rylroph5m",action:"_4hyWUFLHNlMCYVduuXirL",icon:"_3ExFuxeLW6lWai1lnNqxtQ",info:"_EMxlduMvguoNNIR0oevJ",name:"_6pmeCQT-XkYoRk9twIzRV",desc:"_2GvMjgDMVpyPEIYhLtLTkw",clickable:"_1VDCoIb7SHp8BlL0BnfLbk",orgList:"_3OjQ6FBtiYtMxF_WhVM8oF","repo-active":"_1aieEoEWdb7fCb6xaNNzt1",avatar:"_1rDnsFlzHVWKOZEtOF-Tz4",repoListContainer:"_3V7b_dRGTuudpdxU3LEU3-",search:"_3t0-vWM2-wlTI8801-_EkB",repoList:"_3WOIadWjprr42UyzPFB69o",repoListBox:"Xxk199TNV8RTQZcHu248B",placeHolder:"Tqy0wenhjpAlL1GshpcOJ",title:"_2JDeRQtou3Jh08bRyb9Eec",empty:"lhvh5kqnBPzEpJ0Q8tIVH",emptyRepoList:"kOa5BcMdFK_sDJw6vwaCH",tabContent:"uAwxIP0ixLgzm8ubNcemE",card:"_17o_ie-l9rkXfXzLUqIAGc",loadMore:"_2YUIaajHHx2tjO10XpPy2_",confirmButton:"uEDGotlFnf5vO86nHDgQi"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u=n(r(58)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(244)),h=r(189),v=r(243),E=n(r(2403));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,v.observer)(l=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var n;return(0,c.default)(this,r),(n=a.call(this,e)).handleTypeChange=function(e){n.setState({type:e})},n.getCredentialsListData=function(e){var t=n.props,a=t.devops,r=t.cluster;return n.props.store.getCredentials(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({devops:a,cluster:r},e))},n.getCredentialsList=function(){return(0,u.default)(n.props.store.credentials.data.map((function(e){return{label:e.name,value:e.name,type:e.type}})))},n.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return p.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",p.default.createElement(h.Tag,{type:n?"":"warning"},r&&t("CREDENTIAL_TYPE_".concat(r.toUpperCase()))))},n.state={type:"svn"},n}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props.store,a=e.formData,r=e.credentials,n=this.props,l=n.formRef,u=n.enableTypeChange;return p.default.createElement("div",{className:E.default.card},p.default.createElement(h.Form,{data:a,ref:l},p.default.createElement(h.Form.Item,{label:t("TYPE")},p.default.createElement(h.Select,{name:"svn_source.type",disabled:!1===u,onChange:this.handleTypeChange,options:[{label:t("SINGLE_SVN"),value:"single_svn"},{label:t("SVN"),value:"svn"}],defaultValue:"svn"})),p.default.createElement(h.Form.Item,{label:t("CODE_REPOSITORY_ADDRESS"),rules:[{required:!0,message:t("CODE_REPOSITORY_ADDRESS_EMPTY_TIP")}]},p.default.createElement(h.Input,{name:"svn_source.remote"})),p.default.createElement(h.Form.Item,{label:t("CREDENTIAL_SI"),desc:p.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),p.default.createElement("span",{className:E.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL"))),rules:[{required:!0,message:t("PIPELINE_CREDENTIAL_EMPTY_TIP")}]},p.default.createElement(h.Select,{name:"svn_source.credential_id",options:this.getCredentialsList(),pagination:(0,m.default)(r,["page","limit","total"]),isLoading:r.isLoading,onFetch:this.getCredentialsListData,optionRenderer:this.optionRender,valueRenderer:this.optionRender,placeholder:" ",searchable:!0,clearable:!0})),"single_svn"!==this.state.type?p.default.createElement(p.default.Fragment,null,p.default.createElement(h.Form.Item,{label:t("BRANCH_INCLUDED")},p.default.createElement(h.Input,{name:"svn_source.includes",defaultValue:"trunk,branches/*,tags/*,sandbox/*"})),p.default.createElement(h.Form.Item,{label:t("BRANCH_EXCLUDED")},p.default.createElement(h.Input,{name:"svn_source.excludes"}))):null))}}]),r}(p.default.Component))||l;a.default=b},function(e,t,a){e.exports={clickable:"_3SXyP40oxP_JzSVCH3rffR",card:"_2czWZ1FvP3FEYMjudoFdDT"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(200),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(200),r(18),r(43),r(11),r(7);var l=n(r(58)),u=n(r(31)),o=n(r(62)),c=n(r(38));r(35);var s,i,f,d=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(74)),v=n(r(41)),E=n(r(42)),y=n(r(37)),g=n(r(45)),b=(n(r(63)),n(r(0))),S=r(17),_=r(243),O=n(r(67)),C=n(r(26)),T=n(r(244)),R=r(189),D=r(61),k=n(r(1409)),N=n(r(2405));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,y.default)(e);if(t){var n=(0,y.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,E.default)(this,a)}}var w=(0,_.observer)((i=function(e){(0,v.default)(r,e);var a=A(r);function r(e){var n;return(0,p.default)(this,r),(n=a.call(this,e)).getBitbucketList=(0,d.default)(c.default.mark((function e(){var t;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.store.getBitbucketList({cluster:n.props.cluster});case 2:t=e.sent,n.setState({bitbucketList:t});case 4:case"end":return e.stop()}}),e)}))),n.handleFormChange=function(){var e=n.props.store.creatBitBucketServersError,t=void 0===e?{}:e;(0,O.default)(t)||n.props.store.clearBitbucketErrors()},(0,o.default)(n,"handlePasswordConfirm",f,(0,h.default)(n)),n.handleSubmit=function(e){var t=n.props.store.tokenFormData,a=(0,u.default)({},D.REPO_KEY_MAP[n.scmType],{repo:(0,C.default)(n.repoListData,"".concat(e,".name")),credential_id:n.credentialId,owner:(0,C.default)(n.orgList[n.activeRepoIndex],"key")||(0,C.default)((0,S.toJS)(n.orgList),"data[".concat(n.activeRepoIndex,"].name")),api_uri:(0,C.default)(t,"apiUrl"),discover_branches:1,discover_pr_from_forks:{strategy:2,trust:2},discover_pr_from_origin:2,discover_tags:!0,description:(0,C.default)(n.repoListData,"".concat(e,".description"))});n.props.handleSubmit(a)},n.renderAccessTokenForm=function(){var e=n.props.store,a=e.tokenFormData,r=e.creatBitBucketServersError,l=void 0===r?{}:r,u=e.credentials,o=(0,S.toJS)(l);return b.default.createElement("div",{className:N.default.card},b.default.createElement(R.Form,{data:a,onChange:n.handleFormChange,onSubmit:n.handlePasswordConfirm,ref:n.tokenFormRef},b.default.createElement(R.Form.Item,{label:t("BITBUCKET_SERVER_ADDRESS"),error:o.apiUrl,rules:[{required:!0,message:t("BITBUCKET_SERVER_EMPTY_TIP")}]},b.default.createElement(R.Select,{name:"apiUrl",options:n.state.bitbucketList,placeholder:" ",searchable:!0})),b.default.createElement(R.Form.Item,{label:t("CREDENTIAL_SI"),rules:[{required:!0,message:t("PIPELINE_CREDENTIAL_EMPTY_TIP")}],error:o.username||o.password,desc:b.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),b.default.createElement("span",{className:N.default.clickable,onClick:n.props.showCredential},t("CREATE_CREDENTIAL")))},b.default.createElement(R.Select,{name:"credentialId",options:n.credentialsList,pagination:(0,T.default)(u,["page","limit","total"]),isLoading:u.isLoading,onFetch:n.getCredentialsListData,optionRenderer:n.optionRender,valueRenderer:n.optionRender,placeholder:" ",searchable:!0,clearable:!0})),o.all?b.default.createElement("p",{className:N.default.error},o.all):null,b.default.createElement(R.Button,{className:N.default.confirmButton,onClick:n.handlePasswordConfirm,loading:n.state.isLoading},t("OK"))))},n.state={isLoading:!1,bitbucketList:[]},n}return(0,m.default)(r,[{key:"componentDidMount",value:function(){this.getBitbucketList()}},{key:"scmType",get:function(){return"bitbucket_server"}},{key:"credentialsList",get:function(){return(0,l.default)(this.props.store.credentials.data.map((function(e){return{label:e.name,value:e.name,type:e.type,data:e.data}})))}}]),r}(k.default),f=(0,g.default)(i.prototype,"handlePasswordConfirm",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(0,d.default)(c.default.mark((function t(){var a,r,n,l,u;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props,r=a.cluster,n=a.devops,l=e.tokenFormRef.current.getData(),e.credentialId=l.credentialId,!(0,O.default)(l)&&e.credentialId){t.next=5;break}return t.abrupt("return",!1);case 5:return e.setState({isLoading:!0}),u=e.credentialsList.find((function(t){return t.value===e.credentialId})),t.next=9,e.props.store.creatBitBucketServers(P({cluster:r,devops:n,apiUrl:l.apiUrl,secretName:e.credentialId,secretNamespace:n},u.data)).finally((function(){e.setState({isLoading:!1})}));case 9:case"end":return t.stop()}}),t)})))}}),s=i))||s;a.default=w},function(e,t,a){e.exports={confirmButton:"_3WyVYo6dsKouGyudCKTfGh",card:"_3bXiGYjf3r8UN3JsehNubP",error:"_1aFTZO1gaDC0el8Y1x6-3s",clickable:"_2qLBXrEWfUzfXuLt7CVS_S"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(58)),u=n(r(31)),o=n(r(38));r(35);var c,s=n(r(39)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=r(243),E=r(189),y=n(r(244)),g=n(r(26)),b=n(r(2407));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var C=(0,v.observer)(c=function(e){(0,d.default)(n,e);var a,r=O(n);function n(){var e;(0,i.default)(this,n);for(var a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];return(e=r.call.apply(r,[this].concat(u))).state={serverList:[],projectList:[]},e.getProjectListByOwner=function(){var t=(0,s.default)(o.default.mark((function t(a){var r,n,l,u,c,s,i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a.target.value,n=e.props,l=n.devops,u=n.cluster,c=e.props.store.formData,!(s=(0,g.default)(c,"gitlab_source.server_name"))){t.next=9;break}return t.next=7,e.props.store.fetchGitLabProjectList({devops:l,cluster:u,owner:r,server:s});case 7:i=t.sent,e.setState({projectList:i});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getProjectListByServerName=function(){var t=(0,s.default)(o.default.mark((function t(a){var r,n,l,u,c,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.props.store.formData,n=e.props,l=n.devops,u=n.cluster,!(c=(0,g.default)(r,"gitlab_source.owner"))){t.next=8;break}return t.next=6,e.props.store.fetchGitLabProjectList({devops:l,cluster:u,owner:c,server:a});case 6:s=t.sent,e.setState({projectList:s});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getCredentialsListData=function(t){var a=e.props,r=a.devops,n=a.cluster;return e.props.store.getCredentials(_({devops:r,cluster:n},t))},e.getCredentialsList=function(){return(0,l.default)(e.props.store.credentials.data.map((function(e){return{label:e.name,value:e.name,type:e.type}})))},e.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return h.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",h.default.createElement(E.Tag,{type:n?"":"warning"},r&&t("CREDENTIAL_TYPE_".concat(r.toUpperCase()))))},e}return(0,f.default)(n,[{key:"componentDidMount",value:(a=(0,s.default)(o.default.mark((function e(){var t,a,r,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.devops,r=t.cluster,e.next=3,this.props.store.fetchGitLabServerList({devops:a,cluster:r});case 3:n=e.sent,this.setState({serverList:n});case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this.props.store,a=e.formData,r=e.credentials,n=this.props.formRef,l=this.state,u=l.serverList,o=l.projectList;return h.default.createElement("div",{className:b.default.card},h.default.createElement(E.Form,{data:a,ref:n},h.default.createElement(E.Form.Item,{label:t("GITLAB_SERVER_ADDRESS"),rules:[{required:!0,message:t("GITLAB_SERVER_EMPTY_TIP")}]},h.default.createElement(E.Select,{name:"gitlab_source.server_name",options:u,onChange:this.getProjectListByServerName,placeholder:" "})),h.default.createElement(E.Form.Item,{label:t("PROJECT_GROUP_OWNER"),rules:[{required:!0,message:t("PROJECT_GROUP_OWNER_EMPTY_TIP")}]},h.default.createElement(E.Input,{name:"gitlab_source.owner",onBlur:this.getProjectListByOwner})),h.default.createElement(E.Form.Item,{label:t("CREDENTIAL_SI"),desc:h.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),h.default.createElement("span",{className:b.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL")))},h.default.createElement(E.Select,{name:"gitlab_source.credential_id",options:this.getCredentialsList(),pagination:(0,y.default)(r,["page","limit","total"]),isLoading:r.isLoading,onFetch:this.getCredentialsListData,optionRenderer:this.optionRender,valueRenderer:this.optionRender,placeholder:" ",searchable:!0,clearable:!0})),h.default.createElement(E.Form.Item,{label:t("REPOSITORY_NAME"),rules:[{required:!0,message:t("REPOSITORY_NAME_EMPTY_TIP")}]},h.default.createElement(E.Select,{name:"gitlab_source.repo",options:o,placeholder:" ",clearable:!0}))))}}]),n}(h.default.Component))||c;a.default=C},function(e,t,a){e.exports={card:"_13oeDy1bgQEqiST5zgdTVo",clickable:"_3St1Q1uzn_3bzPUMmRXnAA"}},function(e,t,a){e.exports={wrapper:"_2Ci1IpapLDP0oCq47izo7Z",confirm:"_3cJ_baJ-iZer6sWsQZ64dG"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(26)),c=n(r(68)),s=n(r(191)),i=n(r(798)),f=n(r(819)),d=n(r(2410)),p=r(61),m=n(r(438)),h=n(r(864)),v=n(r(2416));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={"configmap.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,c=e.module,d=e.isFederated,E=e.success,g=(0,u.default)(e,["store","cluster","namespace","module","isFederated","success"]),b=p.MODULE_KIND_MAP[c],S=(0,l.default)({},b,m.default[c]({namespace:n}));d&&Object.keys(S).forEach((function(e){S[e]=m.default.federated({data:S[e],clusters:g.projectDetail.clusters.map((function(e){return e.name})),kind:e})}));var _=i.default.open(y({onOk:function(e){var l=(0,o.default)(e,b);l&&a.create(l,{cluster:r,namespace:n||(0,o.default)(l,"metadata.namespace")}).then((function(){i.default.close(_),s.default.success({content:t("CREATE_SUCCESSFUL")}),E&&E(l),h.default.delete("".concat(c,"_create_form"))}))},module:c,cluster:r,namespace:n,name:b,isFederated:d,formTemplate:S,steps:v.default,modal:f.default,store:a},g))}},"configmap.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,u.default)(e,["store","detail","success"]),o=i.default.open(y({onOk:function(e){(0,c.default)(e,"metadata.resourceVersion",r.resourceVersion),l.isFederated&&((0,c.default)(e,"apiVersion",a.version),(0,c.default)(e,"kind","FederatedConfigMap")),a.update(r,e).then((function(){i.default.close(o),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},store:a,detail:r,modal:d.default},l))}}};a.default=g},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(67)),m=n(r(798)),h=n(r(840)),v=n(r(1410)),E=n(r(2415));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var g=function(e){(0,o.default)(r,e);var a=y(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleSubFormSave=function(){var e=t.state.subRoute;e&&e.onSave&&e.onSave((function(){t.setState({subRoute:{}})}))},t.handleSubFormCancel=function(){var e=t.state.subRoute;e&&e.onCancel&&(e.onCancel(),t.setState({subRoute:{}}))},t.handleOk=function(){var e=t.props,a=e.onOk,r=e.store,n=e.detail,l=r.list,u=(0,d.toJS)(l.selectedRowKeys).filter((function(e){return e!==n.uid}));a(t.state.formTemplate),l.setSelectRowKeys(u)},t.state={formTemplate:(0,d.toJS)(e.detail._originData),subRoute:{}},t}return(0,u.default)(r,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}}]),(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.detail,r=t.visible;a._originData!==e.detail._originData&&this.setState({formTemplate:(0,d.toJS)(a._originData)}),r&&r!==e.visible&&this.setState({subRoute:{}})}},{key:"renderSaveBar",value:function(){var e=this.state.subRoute;return(0,p.default)(e)?null:i.default.createElement(h.default,{className:E.default.confirm,onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel})}},{key:"render",value:function(){var e=this.state,a=e.subRoute,r=e.formTemplate,n=this.props,l=n.visible,u=n.isSubmitting,o=n.onCancel,c=n.isFederated;return i.default.createElement(m.default,{width:960,title:t("EDIT_SETTINGS"),icon:"pen",bodyClassName:E.default.body,onOk:this.handleOk,okText:t("OK"),onCancel:o,visible:l,disableSubmit:!(0,p.default)(a),isSubmitting:u},i.default.createElement(v.default,{formTemplate:r,isFederated:c}),this.renderSaveBar())}}]),r}(i.default.Component);a.default=g,g.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},g.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1},g.childContextTypes={registerSubRoute:f.default.func,resetSubRoute:f.default.func}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(99),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(99),r(4),r(18),r(43),r(11);var l=n(r(97)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(140)),p=n(r(828)),m=n(r(2412));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(r,e);var a=h(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleDelete=function(t){return function(){var a=e.props,r=a.value;(0,a.onChange)((0,d.default)(r,t))}},e.handleEdit=function(t){return function(){(0,e.props.onEdit)(t)}},e}return(0,o.default)(r,[{key:"renderContent",value:function(){var e=this,a=this.props,r=a.value,n=a.onAdd;return f.default.createElement(p.default,null,Object.entries(r).map((function(t){var a=(0,l.default)(t,2),r=a[0],n=a[1];return f.default.createElement(p.default.Item,{key:r,icon:"hammer",title:r,description:n||"-",onDelete:e.handleDelete(r),onEdit:e.handleEdit(r)})})),f.default.createElement(p.default.Add,{title:t("ADD_DATA_TCAP"),description:t("ADD_DATA_DESC"),onClick:n}))}},{key:"render",value:function(){return f.default.createElement("div",{className:m.default.wrapper},this.renderContent())}}]),r}(f.default.Component);a.default=v,v.defaultProps={value:{}}},function(e,t,a){e.exports={wrapper:"aDvnSfC_PO0cjwQXPRxri"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(1)),p=n(r(914)),m=r(189),h=r(848),v=n(r(2414));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=function(e){(0,c.default)(r,e);var a=E(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).formRef=f.default.createRef(),e.state={formData:e.getFormData()},e.registerForm=function(){var t=e.context.registerSubRoute,a=e.props.onCancel;t&&t(e.handleSubmit,a)},e.handleGoBack=function(){var t=e.context.resetSubRoute;t&&t(),e.props.onCancel()},e.handleSubmit=function(t){var a=e.props.onOk,r=e.formRef&&e.formRef.current;r&&r.validate((function(){var e=r.getData(),n=e.key,u=e.value;a((0,l.default)({},(0,p.default)(n),u)),t&&t()}))},e}return(0,o.default)(r,[{key:"componentDidMount",value:function(){this.registerForm()}},{key:"getFormData",value:function(){var e=this.props,t=e.detail,a=e.selectKey;return{key:a||"",value:t[a]||""}}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.selectKey;return f.default.createElement("div",{className:v.default.wrapper},f.default.createElement("div",{className:"h6"},f.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},f.default.createElement(h.ReactComponent,null)),a[r]?t("EDIT_DATA_TCAP"):t("ADD_DATA_TCAP")),f.default.createElement("div",{className:v.default.formWrapper},f.default.createElement(m.Form,{data:this.state.formData,ref:this.formRef},f.default.createElement(m.Form.Item,{label:t("DATA_KEY"),description:t("CONFIG_FIELD_DESC")},f.default.createElement(m.Input,{name:"key"})),f.default.createElement(m.Form.Item,{label:t("DATA_VALUE"),description:t("ENTER_CONFIG_VALUE_DESC")},f.default.createElement(m.TextArea,{maxHeight:430,name:"value",rows:4,autoResize:!0})))))}}]),r}(f.default.Component);a.default=y,y.defaultProps={detail:{},selectKey:""},y.contextTypes={registerSubRoute:d.default.func,resetSubRoute:d.default.func}},function(e,t,a){e.exports={wrapper:"_1PdX-zg-RHkGdxETpgh8ot",formWrapper:"_3EIYglevz_Swh5nEFNZG3i",confirm:"SELJh5FgVGbyygztYusqG"}},function(e,t,a){e.exports={body:"_19MqCvqWGMl_Dtx4SLmQc",confirm:"_1LGqnJ3hh7Zg7eM0EMj72o"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(56),l=r(a(911)),u=r(a(1410)),o=[{title:"BASIC_INFORMATION",component:(0,n.withProps)(l.default,{maxNameLength:63}),required:!0},{title:"DATA_SETTINGS",component:u.default,required:!0}];t.default=o},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(26)),c=n(r(68)),s=n(r(191)),i=n(r(798)),f=n(r(438)),d=n(r(2418)),p=n(r(2420)),m=n(r(2422));function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E={"configuration.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.module,c=e.success,p=(0,u.default)(e,["store","cluster","namespace","module","success"]),m=i.default.open(v({onOk:function(e){e&&a.create(e,{cluster:r,namespace:n||(0,o.default)(e,"metadata.namespace")}).then((function(){i.default.close(m),s.default.success({content:t("CREATE_SUCCESSFUL")}),c&&c(e)}))},module:l,cluster:r,namespace:n,modal:d.default,formTemplate:f.default[l]({namespace:n}),store:a,okText:t("CREATE")},p))}},"configuration.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,u.default)(e,["store","detail","success"]),o=i.default.open(v({onOk:function(e){(0,c.default)(e,"metadata.resourceVersion",r.resourceVersion),a.update(r,e).then((function(){i.default.close(o),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},store:a,detail:r,modal:p.default},l))}},"configuration.copy":{on:function(e){var a=e.cluster,r=e.namespace,n=e.store,l=e.detail,c=e.success,f=(0,u.default)(e,["cluster","namespace","store","detail","success"]),p=i.default.open(v({onOk:function(e){n.create(e,{cluster:a||(0,o.default)(l,"cluster"),namespace:r||(0,o.default)(l,"namespace")}).then((function(){i.default.close(p),s.default.success({content:t("COPY_SUCCESSFUL")}),c&&c(e)}))},store:n,detail:l,modal:d.default},f))}},"configuration.rollback":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,u.default)(e,["store","detail","success"]),o=i.default.open(v({onOk:function(e){a.rollBack(r,e).then((function(){i.default.close(o),s.default.success({content:t("ROLLBACK_SUCCESSFUL")}),n&&n()}))},detail:r,modal:m.default,store:a},l))}}};a.default=E},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(17),p=n(r(26)),m=n(r(68)),h=n(r(67)),v=n(r(831)),E=r(189),y=n(r(191)),g=n(r(798)),b=n(r(1411)),S=r(61);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var O=function(e){(0,c.default)(r,e);var a=_(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).formRef=f.default.createRef(),e.formTemplate=e.getFormTemplate(),e.state={codeData:e.getCodeData()},e.handleData=function(t){e.setState({codeData:t})},e.handleOk=function(a){var r=e.formRef.current;r&&r.validate((function(){var r=e.state.codeData,n=r.mode,u=r.config,o=(0,p.default)(a,"metadata.name");if((0,h.default)(u))return y.default.error({content:t("CONFIGURATION_CONTENT_EMPTY_DESC")});a.data=(0,l.default)({},"".concat(o,".").concat(n),u),(0,m.default)(a,'metadata.labels["springcloud.kubesphere.io/configuration.name"]',o),(0,m.default)(a,'metadata.annotations["springcloud.kubesphere.io/extension"]',n),(0,m.default)(a,'metadata.annotations["kubesphere.io/configuration-data"]',u),(0,m.default)(a,'metadata.annotations["springcloud.kubesphere.io/dataid"]',"".concat(o,".").concat(n)),e.props.onOk(a)}))},e.nameValidator=function(a,r,n){var l=e.props,u=l.store,o=l.namespace,c=l.cluster;if(!r)return n();u.checkName({name:r,namespace:o,cluster:c}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e}return(0,o.default)(r,[{key:"getFormTemplate",value:function(){var e=this.props.formTemplate||(0,v.default)((0,d.toJS)(this.props.detail._originData));return this.props.isCopy&&(0,m.default)(e,"metadata.name",""),e}},{key:"getCodeData",value:function(){return{mode:(0,p.default)(this.formTemplate,'metadata.annotations["springcloud.kubesphere.io/extension"]',"yaml"),config:(0,p.default)(this.formTemplate,'metadata.annotations["kubesphere.io/configuration-data"]',"")}}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.title,n=e.isSubmitting,l=e.onCancel,u=this.state.codeData;return f.default.createElement(g.default.Form,{width:960,title:r,visible:a,onCancel:l,onOk:this.handleOk,isSubmitting:n,formRef:this.formRef,data:this.formTemplate},f.default.createElement(E.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:S.PATTERN_NAME,message:t("PATTERN_NAME_INVALID_TIP")},{validator:this.nameValidator}]},f.default.createElement(E.Input,{name:"metadata.name",autoFocus:!0,maxLength:63})),f.default.createElement(E.Form.Item,null,f.default.createElement(b.default,{data:u,title:t("CONFIGURATION_CONTENT"),onChange:this.handleData})))}}]),r}(f.default.Component);a.default=O},function(e,t,a){e.exports={wrapper:"_2KCv1PnULxt1qFyQJeysBX",header:"_1F-0HDMWN3VFriGu-tr3Yx",title:"_13MPI-7qlosXGEs9LAnahA",select:"_3NcEBNmpoac-j5yvlYEfRp"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(17),p=n(r(26)),m=n(r(68)),h=n(r(67)),v=n(r(831)),E=n(r(191)),y=n(r(798)),g=n(r(1411)),b=n(r(2421));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=function(e){(0,c.default)(r,e);var a=S(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).state={data:e.getData()},e.handleData=function(t){e.setState({data:t})},e.handleOk=function(){var a=e.props.detail.name,r=e.state.data,n=r.mode,u=r.config,o=e.formTemplate;if((0,h.default)(u))return E.default.error({content:t("CONFIGURATION_CONTENT_EMPTY_DESC")});o.data=(0,l.default)({},"".concat(a,".").concat(n),u),(0,m.default)(o,'metadata.annotations["kubesphere.io/configuration-data"]',u),e.props.onOk(o)},e}return(0,o.default)(r,[{key:"getData",value:function(){return{mode:(0,p.default)(this.formTemplate,'metadata.annotations["springcloud.kubesphere.io/extension"]'),config:(0,p.default)(this.formTemplate,'metadata.annotations["kubesphere.io/configuration-data"]',"")}}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=this.state.data;return f.default.createElement(y.default,{width:1400,title:t("EDIT_CONFIGURATION"),icon:"pen",visible:a,onCancel:n,onOk:this.handleOk,isSubmitting:r},f.default.createElement("div",{className:b.default.wrapper},f.default.createElement(g.default,{showSelect:!0,selectDisabled:!0,readOnly:!0,editorClassName:b.default.readOnly,data:this.getData(),title:t("ORIGINAL_CONFIGURATION_CONTENT_READONLY")}),f.default.createElement(g.default,{showSelect:!0,selectDisabled:!0,data:l,title:t("CURRENT_CONFIGURATION_CONTENT"),onChange:this.handleData})))}},{key:"formTemplate",get:function(){return(0,v.default)((0,d.toJS)(this.props.detail._originData))}}]),r}(f.default.Component);a.default=_},function(e,t,a){e.exports={wrapper:"_290-iM3J4EKkn5unochQzg",readOnly:"_1YCO0MLsFgmLSHmt0z3JP_"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(20),r(51),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(20),r(51),r(29),r(14),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(17),h=r(243),v=n(r(1)),E=n(r(26)),y=r(189),g=n(r(798)),b=r(56),S=n(r(2423));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=_(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).form=p.default.createRef(),e.historyStore=new S.default,e.fetchData=function(t){var a=t.namespace,r=t.cluster,n=t.name;e.historyStore.fetchList({cluster:r,namespace:a,labelSelector:"springcloud.kubesphere.io/configuration.name=".concat(n)})},e.getFormData=function(){return{name:e.props.detail.name,currentRevision:(0,E.default)(e.revisions,"[0].name")}},e.getRevisionOps=function(){return e.revisions.slice(1).map((function(e){var t=e.name,a=e.createTime;return{label:"".concat(t," ").concat((0,b.getLocalTime)(a).format("YYYY-MM-DD HH:mm:ss")),value:t}}))},e.handleOk=function(){if(e.form&&e.form.current){var t=e.form.current;t&&t.validate((function(){var a=t.getData(),r=(0,m.toJS)(e.revisions).find((function(e){return e.name===a.revision}));e.props.onOk({data:(0,E.default)(r,"data"),metadata:{annotations:{"kubesphere.io/configuration-data":(0,E.default)(r,'annotations["kubesphere.io/configuration-data"]')}}})}))}},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.props.visible&&this.fetchData(this.props.detail)}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=this.getFormData();return p.default.createElement(g.default.Form,{formRef:this.form,data:l,width:600,title:t("ROLL_BACK"),icon:"timed-task",onOk:this.handleOk,onCancel:r,visible:a,isSubmitting:n},p.default.createElement(y.Form.Item,{label:t("RESOURCE_NAME")},p.default.createElement(y.Input,{name:"name",disabled:!0})),p.default.createElement(y.Form.Item,{label:t("CURRENT_REVISION_RECORD")},p.default.createElement(y.Input,{name:"currentRevision",disabled:!0})),p.default.createElement(y.Form.Item,{label:t("TARGET_REVISION_RECORD"),rules:[{required:!0,message:t("TARGET_REVISION_EMPTY_DESC")}]},p.default.createElement(y.Select,{name:"revision",placeholder:" ",options:this.getRevisionOps()})))}},{key:"revisions",get:function(){var e=this.historyStore.list,t=e.data;return e.isLoading?[]:t}},{key:"curRevisionItem",get:function(){var e=this.props.detail.resourceVersion;return this.revisions.find((function(t){return t.resourceVersion===e}))}}]),r}(p.default.Component),u.propTypes={visible:v.default.bool,detail:v.default.object,onOk:v.default.func,onCancel:v.default.func},u.defaultProps={visible:!1,detail:{},onOk:function(){},onCancel:function(){}},l=o))||l;a.default=O},function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(20),a(320),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(320),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(18),a(43),a(11),a(7);var n=r(a(38)),l=r(a(58)),u=r(a(31)),o=r(a(50));a(35);var c,s=r(a(39)),i=r(a(25)),f=r(a(28)),d=r(a(41)),p=r(a(42)),m=r(a(37)),h=r(a(45)),v=a(17),E=r(a(26));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var S=(c=function(e){(0,d.default)(r,e);var t,a=b(r);function r(){var e;(0,i.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).module="configurationhistories",e}return(0,f.default)(r,[{key:"fetchList",value:(t=(0,s.default)(n.default.mark((function e(){var t,a,r,u,c,s,i,f,d,p,m=this,h=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.length>0&&void 0!==h[0]?h[0]:{},a=t.cluster,r=t.workspace,u=t.namespace,c=t.more,s=t.devops,i=t.searchByApp,f=(0,o.default)(t,["cluster","workspace","namespace","more","devops","searchByApp"]),this.list.isLoading=!0,e.next=4,request.get(this.getResourceUrl({cluster:a,workspace:r,namespace:u,devops:s}),this.getFilterParams(g({searchByApp:i},f)));case 4:return d=e.sent,p=((0,E.default)(d,"items")||[]).map((function(e){return g({cluster:a,namespace:u},m.mapper(e))})).sort((function(e,t){return new Date(t.createTime).getTime()-new Date(e.createTime).getTime()})),this.list.update(g(g({data:c?[].concat((0,l.default)(this.list.data),(0,l.default)(p)):p},f),{},{isLoading:!1})),e.abrupt("return",p);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(r(a(2424)).default),(0,h.default)(c.prototype,"fetchList",[v.action],Object.getOwnPropertyDescriptor(c.prototype,"fetchList"),c.prototype),c);t.default=S},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(28)),u=r(a(41)),o=r(a(42)),c=r(a(37));function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var i=function(e){(0,u.default)(a,e);var t=s(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return(e=t.call.apply(t,[this].concat(l))).getResourceUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat(e.apiVersion).concat(e.getPath(t),"/").concat(e.module)},e}return(0,l.default)(a,[{key:"apiVersion",get:function(){return"apis/springcloud.kubesphere.io/v1alpha1"}}]),a}(r(a(49)).default);t.default=i},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(26)),c=n(r(68)),s=r(17),i=n(r(191)),f=n(r(798)),d=n(r(438)),p=n(r(2426)),m=n(r(2531));function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E={"custom.monitoring.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.module,c=e.success,s=(0,u.default)(e,["store","cluster","namespace","module","success"]),p=d.default[l]({namespace:n}),h=f.default.open(v({onOk:function(e){e&&("grafana"===e.type?(delete e.type,a.createGrafana(e,{cluster:r,namespace:n||(0,o.default)(e,"metadata.namespace")}).then((function(){f.default.close(h),i.default.success({content:t("CREATE_SUCCESSFUL")}),c&&c()}))):a.create(e,{cluster:r,namespace:n||(0,o.default)(e,"metadata.namespace")}).then((function(){f.default.close(h),i.default.success({content:t("CREATE_SUCCESSFUL")}),c&&c()})))},module:l,cluster:r,namespace:n,modal:m.default,formTemplate:p,store:a},s))}},"custom.monitoring.edit":{on:function(e){var a=e.store,r=e.detail,n=e.cluster,l=e.namespace,o=e.success,d=(0,u.default)(e,["store","detail","cluster","namespace","success"]);f.default.open(v({onOk:function(e){(0,c.default)(e,"metadata.resourceVersion",r.resourceVersion),a.update(r,e).then((function(){i.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o()}))},store:a,cluster:n,namespace:l,data:(0,s.toJS)(r._originData),modal:p.default},d))}}};a.default=E},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(32),a(29),a(14),a(4),a(21),a(18),a(43),a(11);var n=r(a(38));a(35);var l=r(a(39)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=r(a(1412)),p=r(a(1422));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(a,e);var t=m(a);function a(e){var r;(0,u.default)(this,a),(r=t.call(this,e)).handleOk=(0,l.default)(n.default.mark((function e(){var t;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.store.toJS(),e.next=3,r.props.onOk(t);case 3:r.store.switchEditingMode(!1);case 4:case"end":return e.stop()}}),e)})));var o=e.data,c=o.metadata,s=void 0===c?{}:c,i=o.spec,f=void 0===i?{}:i,d=f.title,m=f.description,h=f.refresh,v=f.panels,E=f.datasource,y=f.templatings,g=f.time,b=s.namespace,S=s.name;return r.store=new p.default({title:d,cluster:e.cluster,namespace:b,description:m,refresh:h,isEditing:!1,panels:v,datasource:E,templatings:y,time:g,name:S,formTemplate:e.data}),r}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.cluster,a=e.readOnly,r=e.isSubmitting,n=e.onCancel;return f.default.createElement(d.default,{store:this.store,cluster:t,readOnly:a,isSubmitting:r,onCancel:n,onOk:this.handleOk})}}]),a}(f.default.Component);t.default=h},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(6),a(70),a(138),a(8),a(9),a(73),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(3),a(6),a(70),a(27),a(138),a(8),a(9),a(4),a(21),a(73),a(7);var n=r(a(38));a(35);var l,u,o=r(a(39)),c=r(a(62)),s=r(a(25)),i=r(a(28)),f=r(a(45)),d=(r(a(63)),a(17)),p=r(a(26)),m=(l=function(){function e(){(0,s.default)(this,e),this.apiVersion="kapis/monitoring.kubesphere.io/v1beta1",(0,c.default)(this,"labelsets",u,this)}var t;return(0,i.default)(e,[{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cluster,a=e.namespace,r="";return t&&(r+="/clusters/".concat(t)),a&&(r+="/namespaces/".concat(a)),r}},{key:"fetchLabelSets",value:(t=(0,o.default)(n.default.mark((function e(){var t,a,r,l,u,o=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},a=Object.assign({},t),e.next=3,request.get("".concat(this.apiVersion).concat(this.getPath({}),"/targets/labelsets"),a);case 3:r=e.sent,l=(0,p.default)(r,"data")||[],u={},l.forEach((function(e){Object.keys(e).forEach((function(t){u[t]=u[t]||[],u[t].includes(e[t])||u[t].push(e[t])}))})),this.labelsets=u;case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),u=(0,f.default)(l.prototype,"labelsets",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),(0,f.default)(l.prototype,"fetchLabelSets",[d.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchLabelSets"),l.prototype),l);t.default=m},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(243),p=n(r(1413));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=(0,d.inject)("monitoringStore")(l=(0,d.observer)(l=function(e){(0,c.default)(r,e);var a=m(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleEditClick=function(){e.props.monitoringStore.changeModeToEditing()},e}return(0,o.default)(r,[{key:"render",value:function(){return this.props.monitoringStore.isEditing?f.default.createElement(p.default,{type:"danger",icon:"pen",iconType:"light",onClick:this.props.onSaveClick,text:t("OK")},t("SAVE_TEMPLATE")):f.default.createElement(p.default,{type:"control",icon:"pen",iconType:"light",onClick:this.handleEditClick},t("EDIT_TEMPLATE"))}}]),r}(f.default.Component))||l)||l;a.default=h},function(e,t,a){e.exports={wrapper:"_3IYKAltq5See8I2g5kho1j",danger:"_3RaEr3lipfWerxmg8Kd3PZ"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n,l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(243),d=r(a(2431));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=(0,f.inject)("monitoringStore","modalStore")(n=(0,f.observer)(n=function(e){(0,o.default)(a,e);var t=p(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).handleChange=function(t){e.props.monitoringStore.changeTitle(t.target.value)},e}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props.monitoringStore,t=e.title,a=e.isEditing,r=this.props.modalStore.theme;return i.default.createElement(d.default,{theme:r,title:t,isEditing:a,onChange:this.handleChange})}}]),a}(i.default.Component))||n)||n;t.default=m},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.title,r=e.isEditing,n=e.onChange,i=e.theme;return u.default.createElement("div",{className:(0,c.default)(s.default.wrapper,(0,l.default)({},s.default.dark,"dark"===i))},r?u.default.createElement(o.Input,{onChange:n,value:a,placeholder:t("DASHBOARD_TITILE")}):u.default.createElement("span",{className:(0,c.default)(s.default.title,(0,l.default)({},s.default.dark,"dark"===i))},a))};var l=n(r(31)),u=n(r(0)),o=r(189),c=n(r(5)),s=n(r(2432))},function(e,t,a){e.exports={wrapper:"_3S-ZzwCINqG44Ke4mWbohz",title:"_1kW70ZLZ6se_m6RgePIVMz",dark:"_2KhkpRw5HC_2c9kTOeIogn"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(243),p=r(466),m=r(189),h=n(r(2434)),v=r(1414);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=(0,d.inject)("monitoringStore")(l=(0,d.observer)(l=function(e){(0,c.default)(r,e);var a=E(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).handleChange=function(t){e.props.monitoringStore.changeRefreshInterval(t)},e.options=v.refreshInterval.map((function(e){return{label:e?"".concat(t("INTERVAL")," ").concat((0,p.translateTimeAlias)(e)):t("NO_REFRESHING"),value:e}})),e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props.monitoringStore.refresh;return f.default.createElement(h.default,{prefixIcon:f.default.createElement(m.Icon,{name:"refresh",type:"light"}),onChange:this.handleChange,options:this.options,value:e})}}]),r}(f.default.Component))||l)||l;a.default=y},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return l.default.createElement(u.Select,(0,n.default)({className:o.default.wrapper},e))};var n=r(a(317)),l=r(a(0)),u=a(189),o=r(a(2435))},function(e,t,a){e.exports={wrapper:"_3Bc9dCYAA0wO9AGEpIOcSG"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(30),r(11),r(71),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37));r(32),r(3),r(20),r(442),r(2437),r(29),r(4),r(18),r(43),r(30),r(11),r(71);var i,f=n(r(0)),d=r(243),p=n(r(245)),m=r(466),h=n(r(2440)),v=r(1414);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){return new Date(e).toISOString()},g=(0,d.inject)("monitoringStore")(i=(0,d.observer)(i=function(e){(0,o.default)(r,e);var a=E(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).handleQuickSelect=function(t){e.props.monitoringStore.changeTimeRange(t)},e.handeCustomSelect=function(t){var a=t.startTime,r=t.endTime;e.props.monitoringStore.changeTimeRange({from:y(a),to:y(r)})},e.options=v.recentTimeRange.map((function(e){return{label:"".concat(t("LAST")," ").concat((0,m.translateTimeAlias)(e)),value:{from:"now-".concat(e),to:"now"}}})),e.format=function(){var a=e.props.monitoringStore.time,r=a.to,n=a.from;return"now"===r?"".concat(t("LAST")," ").concat((0,m.translateTimeAlias)(n.replace("now-",""))):"".concat((0,p.default)(n).format("YYYY-MM-DD HH:mm:ss")," ~ ").concat((0,p.default)(r).format("YYYY-MM-DD HH:mm:ss"))},e}return(0,u.default)(r,[{key:"generateTimeRange",value:function(){var e=this.props.monitoringStore.time,t=e.from,a=e.to;return"now"===a?{startTime:Date.now()-(0,m.getMsFromTimeAlias)(t.replace("now-","")),endTime:Date.now()}:{startTime:new Date(t).valueOf(),endTime:new Date(a).valueOf()}}},{key:"render",value:function(){var e=this.props.monitoringStore.time,t=e.from,a=e.to;return f.default.createElement(h.default,{key:t+a,recentOpts:this.options,timeRange:this.generateTimeRange(),onRecentSelect:this.handleQuickSelect,onCustomSubmit:this.handeCustomSelect,format:this.format})}}]),r}(f.default.Component))||i)||i;a.default=g},,,,function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(317)),o=l(r(31)),c=l(r(97)),s=l(r(25)),i=l(r(28)),f=l(r(41)),d=l(r(42)),p=l(r(37));r(32),r(3),r(20),r(442),r(29),r(4),r(18),r(43),r(11);var m=l(r(26)),h=l(r(67)),v=l(r(1)),E=n(r(0)),y=l(r(5)),g=r(189),b=l(r(245)),S=l(r(191)),_=l(r(2441));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var C=function(e){(0,f.default)(r,e);var a=O(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).state={showDropdown:!1},e.toggleDropdown=function(){e.setState({showDropdown:!e.state.showDropdown})},e.hideDropdown=function(){e.setState({showDropdown:!1})},e.handleRecentClick=function(t){var a=t.currentTarget.dataset.index,r=e.props,n=r.recentOpts;(0,r.onRecentSelect)((0,m.default)(n,"[".concat(a,"].value")))},e.handleSubmit=function(a){var r=a.startTime,n=a.endTime,l=a.interval,u=(0,c.default)(r,1)[0],o=(0,c.default)(n,1)[0];u>o?S.default.error({content:t("TIMERANGE_SELECTOR_MSG")}):e.props.onCustomSubmit({startTime:u,endTime:o,interval:l})},e}return(0,i.default)(r,[{key:"render",value:function(){var e=this.state.showDropdown,t=this.props,a=t.format,r=t.timeRange,n=a(t.recent||{},r);return E.default.createElement("div",{className:(0,y.default)(_.default.wrapper,(0,o.default)({},_.default.active,e))},E.default.createElement("div",{className:(0,y.default)(_.default.mask,(0,o.default)({},_.default.active,e)),onClick:this.hideDropdown}),E.default.createElement("div",{className:_.default.content,onClick:this.toggleDropdown},E.default.createElement(g.Icon,{name:"calendar",type:"light"}),E.default.createElement("span",null,n),E.default.createElement(g.Icon,{name:"chevron-down",type:"light"})),this.renderDropDown())}},{key:"renderDropDown",value:function(){return E.default.createElement("div",{className:_.default.dropdown},this.renderRecentOpts(),this.renderCustomOpts())}},{key:"renderRecentOpts",value:function(){var e=this,a=this.props.recentOpts;return E.default.createElement(E.default.Fragment,null,E.default.createElement("div",{className:_.default.title},t("SELECT_TIME_RANGE")),E.default.createElement("div",{className:_.default.recentWrapper},a.map((function(t,a){var r=t.label;return E.default.createElement("span",{onClick:e.handleRecentClick,"data-index":a,key:a},r)}))))}},{key:"renderCustomOpts",value:function(){var e=this.props,a=e.timeRange,r=e.interval,n=e.intervalOpts,l=a.startTime,o=a.endTime,c={enableSeconds:!0,enableTime:!0,dateFormat:"Y-m-d H:i:S"};return E.default.createElement(E.default.Fragment,null,E.default.createElement("div",{className:_.default.title},t("CUSTOM_TIME_RANGE")),E.default.createElement(g.Form,{data:{interval:r,startTime:[l],endTime:[o]},onSubmit:this.handleSubmit},E.default.createElement(g.Form.Item,{label:t("START_TIME")},E.default.createElement(g.DatePicker,(0,u.default)({name:"startTime"},c))),E.default.createElement(g.Form.Item,{label:t("END_TIME")},E.default.createElement(g.DatePicker,(0,u.default)({name:"endTime"},c))),E.default.createElement("div",{className:_.default.footer},(0,h.default)(n)||E.default.createElement(g.Form.Item,{label:t("SAMPLING_INTERVAL")},E.default.createElement(g.Select,{name:"interval",className:_.default.select,options:n})),E.default.createElement("div",null,E.default.createElement(g.Button,{htmlType:"submit"},t("OK"))))))}}]),r}(E.Component);C.propTypes={recent:v.default.object,timeRange:v.default.object,format:v.default.func,recentOpts:v.default.array,interval:v.default.string,intervalOpts:v.default.array,onRecentSelect:v.default.func,onCustomSubmit:v.default.func},C.defaultProps={recent:null,timeRange:{startTime:Date.now(),endTime:Date.now()},format:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.count,r=e.unit,n=arguments.length>1?arguments[1]:void 0,l=n.startTime,u=void 0===l?0:l,o=n.endTime,c=void 0===o?0:o;return a?"".concat(t("LAST")," ").concat(a," ").concat(t(r)):"".concat((0,b.default)(u).format("YYYY/MM/DD HH:mm:ss")," ~ ").concat((0,b.default)(c).format("YYYY/MM/DD HH:mm:ss"))},recentOpts:[{label:"Last 5 Minutes",value:{count:5,unit:"Minutes"}}],intervalOpts:[],onRecentSelect:function(){},onCustomSummit:function(){}};var T=C;a.default=T},function(e,t,a){e.exports={wrapper:"_2kNQZvZCCOrdYLr3lW_M0M",active:"_3ze5VvZgAQIFkqqU43TECt",dropdown:"_38qK6AG6_ltW34wzqG2QjC",mask:"_1e1_OUeku7JT9XcEh-uO-Q",content:"zGUNaQOOt-GtiMetfKDgX",title:"_3YE7OaQAST3rEZTGrNXeD2",recentWrapper:"_2FjFhDG37PJi2iTV2HWjv0",footer:"_1_M2ap0yCRe5IW3k3h55YP"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(6),a(20),a(8),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(6),a(20),a(29),a(8),a(4),a(18),a(43),a(11),a(7);var n,l,u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(45)),d=r(a(0)),p=a(243),m=a(17),h=r(a(2443));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=(0,p.inject)("monitoringStore","modalStore")(n=(0,p.observer)((l=function(e){(0,c.default)(a,e);var t=v(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).handleDelete=function(t){e.monitors[t].stopMonitoring(),e.textMonitorsRow.deleteTextMonitorByIndex(t)},e.handleEdit=function(t){var a=e.textMonitorsRow.monitors[t];e.props.modalStore.selectMonitor(a)},e.handleAdd=function(){var t=e.monitoringStore.generateNewTextMonitor();e.modalStore.selectMonitor(t)},e.handleSort=function(t){var a=t.map((function(e){return e.monitor}));e.textMonitorsRow.updateMonitors(a)},e}return(0,o.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.monitors.forEach((function(t){return t.monitoring(e.monitoringStore)}))}},{key:"componentWillUnmount",value:function(){this.monitors.forEach((function(e){return e.stopMonitoring()}))}},{key:"componentDidUpdate",value:function(){var e=this;this.monitors.forEach((function(t){return t.monitoring(e.monitoringStore)}))}},{key:"render",value:function(){var e=this.props.monitoringStore.isEditing,t=this.textMonitorData,a=this.monitors.map((function(e){return{monitor:e}}));return d.default.createElement(h.default,{isEditing:e,monitors:a,textPanels:t,onSort:this.handleSort,onDelete:this.handleDelete,onEdit:this.handleEdit,onAdd:this.handleAdd})}},{key:"monitoringStore",get:function(){return this.props.monitoringStore}},{key:"modalStore",get:function(){return this.props.modalStore}},{key:"textMonitorsRow",get:function(){return this.monitoringStore.textMonitors}},{key:"monitors",get:function(){return this.textMonitorsRow.monitors}},{key:"textMonitorData",get:function(){return this.monitors.map((function(e){var t=e.config||{};return{title:t.title,id:t.id,value:e.stat,errorMessage:e.errorMessage}}))}}]),a}(d.default.Component),(0,f.default)(l.prototype,"monitoringStore",[m.computed],Object.getOwnPropertyDescriptor(l.prototype,"monitoringStore"),l.prototype),(0,f.default)(l.prototype,"modalStore",[m.computed],Object.getOwnPropertyDescriptor(l.prototype,"modalStore"),l.prototype),(0,f.default)(l.prototype,"textMonitorsRow",[m.computed],Object.getOwnPropertyDescriptor(l.prototype,"textMonitorsRow"),l.prototype),(0,f.default)(l.prototype,"monitors",[m.computed],Object.getOwnPropertyDescriptor(l.prototype,"monitors"),l.prototype),(0,f.default)(l.prototype,"textMonitorData",[m.computed],Object.getOwnPropertyDescriptor(l.prototype,"textMonitorData"),l.prototype),n=l))||n)||n;t.default=E},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.textPanels,a=e.isEditing,r=e.onAdd,f=e.onDelete,d=e.onEdit,p=e.onSort,m=e.monitors;return l.default.createElement("div",null,l.default.createElement(u.ReactSortable,{list:m,setList:p,className:i.default.wrapper,disabled:!a,key:a,animation:200},t.map((function(e,t){var r=e.title,u=e.isLoading,p=e.value,m=e.id,h=e.errorMessage;return l.default.createElement("div",{key:m,className:(0,c.default)((0,n.default)({},i.default.editting,a))},l.default.createElement(s.default,{errorMessage:h},l.default.createElement("div",{className:i.default.innner},a&&l.default.createElement("div",{className:i.default.tools},l.default.createElement(o.Icon,{name:"pen",size:20,type:"light",clickable:!0,onClick:function(){return d(t)}}),l.default.createElement(o.Icon,{name:"trash",size:20,type:"light",clickable:!0,onClick:function(){return f(t)}})),l.default.createElement("div",{className:i.default.content},l.default.createElement("h6",null,p),l.default.createElement("p",null,r),u&&l.default.createElement("span",{className:i.default.loadingTip},l.default.createElement(o.Loading,{size:10}))))))}))),a&&l.default.createElement("div",{className:i.default.wrapper},l.default.createElement("div",{onClick:r,className:i.default.addButton},l.default.createElement(o.Icon,{name:"add",size:20,type:"light"}))))};var n=r(a(31));a(20);var l=r(a(0)),u=a(1415),o=a(189),c=r(a(5)),s=r(a(1059)),i=r(a(2446))},,function(e,t,a){e.exports={wrapper:"_30EfsRi0WbMvAGkUtPp_pX",error:"bvYl6q_2buGchG0_oOgDB"}},function(e,t,a){e.exports={wrapper:"_1JNcscoEqUrPOfgH9bogzK",content:"_1rxqdHBClXet0rKccVsHtF",loadingTip:"_1Sbq1lYD-XsgcJkNcfkTMx",innner:"ZiUxG2dpZ98DolM28G884",editting:"_1KqodXGORr8QmNaNsSwc6n",tools:"_3V99brls9xcBq15s0iRdil",addButton:"_18he9_SXyr20t3iXb5JdBC"}},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(27),r(29),r(8),r(4),r(18),r(43),r(11);var u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(45)),m=l(r(0)),h=r(243),v=r(17),E=n(r(2448)),y=n(r(2450)),g=n(r(2463)),b=n(r(2474));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var _={singlestat:y.default,graph:g.default,table:b.default},O=(0,h.inject)("modalStore","monitoringStore")(u=(0,h.observer)((o=function(e){(0,i.default)(r,e);var a=S(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).temporaryMonitor=e.getTemporaryMonitor(),e.handleCancel=function(){e.props.modalStore.unSelectMonitor()},e.handleSubmit=function(){e.isNewMonitor?e.monitor.belongTo.push(e.temporaryMonitor):e.monitor.config=e.temporaryMonitor.config,e.props.modalStore.unSelectMonitor()},e}return(0,s.default)(r,[{key:"getTemporaryMonitor",value:function(){return this.isNewMonitor?this.monitor:this.monitor.clone()}},{key:"componentDidMount",value:function(){this.temporaryMonitor.monitoring(this.props.monitoringStore)}},{key:"componentWillUnmount",value:function(){this.temporaryMonitor.stopMonitoring()}},{key:"render",value:function(){var e=_[this.monitor.type];return m.default.createElement(E.default,{formData:this.temporaryMonitor.config,onSubmit:this.handleSubmit,onCancel:this.handleCancel},e?m.default.createElement(e,{monitor:this.temporaryMonitor}):t("MONITOR_TYPE_NO_SUPPORT"))}},{key:"monitor",get:function(){return this.props.modalStore.selectedMonitor}},{key:"isNewMonitor",get:function(){var e=this.monitor;return!e.belongTo.has(e)}}]),r}(m.Component),(0,p.default)(o.prototype,"monitor",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"monitor"),o.prototype),(0,p.default)(o.prototype,"isNewMonitor",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"isNewMonitor"),o.prototype),u=o))||u)||u;a.default=O},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.formData,a=e.children,r=e.onCancel,o=e.onSubmit;return n.default.createElement(l.Form,{className:u.default.wrapper,data:t,onSubmit:o},n.default.createElement("div",{className:u.default.form},a),n.default.createElement("div",{className:u.default.formFooter},n.default.createElement(l.Button,{type:"control",icon:"close",iconType:"light",onClick:r}),n.default.createElement(l.Button,{type:"control",icon:"check",iconType:"light",htmlType:"submit"})))};var n=r(a(0)),l=a(189),u=r(a(2449))},function(e,t,a){e.exports={wrapper:"_3ZeYUgWPbewvTTUqMUOecy",form:"_7inMxqFIqjVzbHwr-qNm9",formFooter:"_3SNcsZ0T9tkGjtowg76Bzz"}},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(20),r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(8),r(4),r(18),r(43),r(11);var u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(45)),m=l(r(0)),h=r(243),v=r(17),E=n(r(26)),y=n(r(1166)),g=r(1167),b=r(2456),S=n(r(1003)),_=n(r(2460)),O=n(r(1059));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var T=(0,h.inject)("monitoringStore","labelStore")(u=(0,h.observer)((o=function(e){(0,i.default)(r,e);var a=C(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleLabelSearch=function(t){var a=e.props.monitoringStore,r=a.cluster,n=a.namespace,l=e.props.monitoringStore.getTimeRange(),u=l.from,o=l.to;e.props.labelStore.fetchLabelSets({cluster:r,namespace:n,metric:t,start:Math.floor(u.valueOf()/1e3),end:Math.floor(o.valueOf()/1e3)})},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.props.monitoringStore.fetchMetadata()}},{key:"render",value:function(){var e=this.stat,a=(0,E.default)(this.monitor,"config.title",""),r=(0,v.toJS)(this.props.labelStore.labelsets);return m.default.createElement(y.default,{preview:m.default.createElement(O.default,{errorMessage:this.monitor.errorMessage},m.default.createElement(b.SingleStatGraph,{singleState:e,title:a})),sidebar:m.default.createElement(g.GraphTextInput,{type:"singlestat"}),main:m.default.createElement(S.default,{label:t("DATA")},m.default.createElement(_.default,{supportMetrics:this.supportMetrics,labelsets:r,onLabelSearch:this.handleLabelSearch}))})}},{key:"monitor",get:function(){return this.props.monitor}},{key:"supportMetrics",get:function(){return this.props.monitoringStore.targetsMetadata.map((function(e){return{value:e.metric,desc:e.help,type:e.type}}))}},{key:"stat",get:function(){return this.monitor.stat}}]),r}(m.Component),(0,p.default)(o.prototype,"monitor",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"monitor"),o.prototype),(0,p.default)(o.prototype,"supportMetrics",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"supportMetrics"),o.prototype),(0,p.default)(o.prototype,"stat",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"stat"),o.prototype),u=o))||u)||u;a.default=T},function(e,t,a){e.exports={wrapper:"_3Stre0zYy7b8sCvF-xGly_",preview:"_1GfNd1Y_MUbgYSx9yzgB0h",form:"_3EOZI4PcAQPnwR-RVaCUSg",sidebar:"_2-dZfxhdtX-1OfJmQ5eWnQ",resource:"_2YOLD4b02Mh-Oj4kRCDrcJ"}},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.type,r={singlestat:{i18n:t("SINGLE_STATE_CHART"),icon:"text"},line:{i18n:t("LINE_CHART"),icon:"linechart"},bar:{i18n:t("BAR_CHART"),icon:"barchart"},table:{i18n:t("TABLE"),icon:"table-chart"}},n=r[a].icon,c=r[a].i18n;return l.default.createElement("div",{className:o.default.wrapper},l.default.createElement("header",null,t("CHART_TYPES")),l.default.createElement("div",null,l.default.createElement(u.Icon,{name:n,type:"light",size:40}),l.default.createElement("h3",null,c)))};var l=n(r(0)),u=r(189),o=n(r(2453))},function(e,t,a){e.exports={wrapper:"_2145NKyaXROReR0eN6-PBI"}},function(e,t,a){"use strict";a(16);var r=a(19);a(66),a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.options,a=e.value,r=e.onChange;return l.default.createElement("div",{className:s.default.wrapper},t.map((function(e,t){return l.default.createElement("div",{className:(0,u.default)((0,n.default)({},s.default.select,(0,o.default)(e.value.join(","),a.join(",")))),key:(0,c.default)(e.value)?e.value.join(","):t,onClick:function(){r(e.value)}},l.default.createElement("h3",null,e.label),l.default.createElement("div",{className:s.default.colors},e.value.map((function(e){return l.default.createElement("div",{key:e,style:{backgroundColor:e}})}))))})))};var n=r(a(31));a(66),a(20);var l=r(a(0)),u=r(a(5)),o=r(a(811)),c=r(a(64)),s=r(a(2455))},function(e,t,a){e.exports={wrapper:"_2li-l2mP2fMG1QZq-ZLncF",select:"_20S0JG5Gyd1kQm4yX006oO",colors:"_3DefZS0H3j5fxqBHp5Ejhd"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"SingleStatGraph",{enumerable:!0,get:function(){return n.default}});var n=r(a(2457))},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.singleState,a=e.title;return n.default.createElement("div",{className:l.default.wrapper},n.default.createElement("h3",null,n.default.createElement("span",null,t)),n.default.createElement("p",null,a))};var n=r(a(0)),l=r(a(2458))},function(e,t,a){e.exports={wrapper:"_3t0RsORTnxwuLWyQZfTZC9"}},function(e,t,a){e.exports={wrapper:"_3H8zHTGkN2UxY70Ttk_aKT"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(317)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37));r(32),r(20),r(29),r(9),r(4),r(18),r(43),r(11);var d=n(r(0)),p=r(189),m=l(r(805)),h=r(803),v=l(r(1101)),E=l(r(962)),y=l(r(1004)),g=l(r(2462));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=Object.keys(h.unitTransformMap).map((function(e){return{label:e,value:e}})),_=function(e){(0,s.default)(r,e);var a=b(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"render",value:function(){return d.default.createElement("div",{className:g.default.wrapper},d.default.createElement("div",{className:g.default.config},d.default.createElement(p.Form.Item,{rules:[{required:!0,message:t("NAME_EMPTY_DESC")}]},d.default.createElement(E.default,{name:"title"},(function(e){var a=e.onChange,r=e.value;return d.default.createElement(y.default,{label:t("GRAPH_NAME"),tips:""},d.default.createElement(p.Input,{className:g.default.input,value:r,onChange:a}))}))),d.default.createElement(p.Form.Item,null,d.default.createElement(E.default,{name:"format",defaultValue:S[0]},(function(e){var a=e.onChange,r=e.value;return d.default.createElement(y.default,{label:t("UNIT"),tips:""},d.default.createElement(p.Select,{options:S,value:r,onChange:a}))}))),d.default.createElement(p.Form.Item,null,d.default.createElement(E.default,{name:"decimals",defaultValue:0},(function(e){var a=e.onChange,r=e.value;return d.default.createElement(y.default,{label:t("DECIMALS"),tips:""},d.default.createElement(m.default,{value:r,max:5,min:0,onChange:a}))})))),d.default.createElement("div",{className:g.default.metric},d.default.createElement(p.Form.Item,null,d.default.createElement(v.default,(0,u.default)({name:"targets[0].expr"},this.props)))))}}]),r}(d.Component);a.default=_},function(e,t,a){e.exports={wrapper:"_2C1fCSF8KpDwIEut_2MgtV",label:"QkppNQvAINnnNmxn5RPP6",content:"_39Ri6GN7ykbXXIM_Ff6zud"}},function(e,t,a){e.exports={wrapper:"Ak6-eMDkfF3C5TJyQphR8",config:"_2F_uvfrHJwigmWBLGegJ7I",metric:"_35j6cKLTeLYz6_IGhHcdd4",input:"ondUZb0hG43EmAsEFaDEn"}},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(12),r(109),r(3),r(20),r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(20),r(29),r(8),r(4),r(18),r(43),r(11);var u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(45)),m=l(r(0)),h=r(243),v=r(17),E=r(189),y=n(r(827)),g=r(61),b=n(r(1166)),S=r(1167),_=n(r(962)),O=n(r(1416)),C=n(r(2468)),T=n(r(1059)),R=n(r(1003)),D=n(r(2470));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var N=(0,h.inject)("monitoringStore","labelStore")(u=(0,h.observer)((o=function(e){(0,i.default)(r,e);var a=k(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleLabelSearch=function(t){var a=e.props.monitoringStore,r=a.cluster,n=a.namespace,l=e.props.monitoringStore.getTimeRange(),u=l.from,o=l.to;e.props.labelStore.fetchLabelSets({cluster:r,namespace:n,metric:t,start:Math.floor(u.valueOf()/1e3),end:Math.floor(o.valueOf()/1e3)})},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.props.monitoringStore.fetchMetadata()}},{key:"render",value:function(){var e=this.monitor.config,a=e.title,r=e.lines,n=e.bars,l=e.stack,u=e.description,o=this.monitor.errorMessage,c=this.monitor.legends,s=(0,v.toJS)(this.props.labelStore.labelsets);return m.default.createElement(b.default,{preview:m.default.createElement(T.default,{errorMessage:o},m.default.createElement(C.default,{title:a,description:u},m.default.createElement(O.default,{line:r,bar:n,stacked:l,timeRange:this.timeRange,valueFormatter:this.monitor.valueFormatter,legends:c,data:this.monitor.graphData}))),sidebar:m.default.createElement(m.default.Fragment,null,m.default.createElement(S.GraphTextInput,{type:this.monitor.config.lines?"line":"bar"}),m.default.createElement(R.default,{className:"margin-t12",label:t("GRAPH_TYPES")},m.default.createElement(E.Form.Item,null,m.default.createElement(_.default,{name:"stack",debounce:100},(function(e){var a=e.onChange,r=e.value;return m.default.createElement(y.default,{defaultValue:!1,value:r,onChange:a,options:[{value:!0,label:t("STACKED_GRAPH_TYPE"),icon:"barchart",description:t("STACKED_GRAPH_TYPE_DESC")},{value:!1,label:t("SINGLE_GRAPH_TYPE_NAME"),icon:"barchart",description:t("SINGLE_GRAPH_TYPE")}]})})))),m.default.createElement(R.default,{label:t("GRAPH_COLORS")},m.default.createElement(E.Form.Item,null,m.default.createElement(_.default,{name:"colors",defaultValue:0,debounce:100},(function(e){var a=e.onChange,r=e.value;return m.default.createElement(S.ThemeSelector,{onChange:a,value:r,options:g.MONITOR_GRAPH_COLORS.map((function(e){return{label:t(e.nameI18nKey),value:e.colors}}))})}))))),main:m.default.createElement(D.default,{supportMetrics:this.supportMetrics,labelsets:s,onLabelSearch:this.handleLabelSearch})})}},{key:"monitor",get:function(){return this.props.monitor}},{key:"supportMetrics",get:function(){return this.props.monitoringStore.targetsMetadata.map((function(e){return{value:e.metric,desc:e.help,type:e.type}}))}},{key:"timeRange",get:function(){return this.monitor.timeRange}}]),r}(m.Component),(0,p.default)(o.prototype,"monitor",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"monitor"),o.prototype),(0,p.default)(o.prototype,"supportMetrics",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"supportMetrics"),o.prototype),u=o))||u)||u;a.default=N},,,,function(e,t,a){e.exports={wrapper:"O3kTaWXsEhAjMYeAvOzL1"}},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.title,a=e.description,r=e.children;return n.default.createElement("div",{className:l.default.wrapper},n.default.createElement("div",null,n.default.createElement("h3",null,t),n.default.createElement("p",null,a)),r)},a(12),a(109);var n=r(a(0)),l=r(a(2469))},function(e,t,a){e.exports={wrapper:"NdXgZ7ysaYFLK9YlXlK3-"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37));r(32),r(20),r(29),r(9),r(4),r(18),r(43),r(11);var f=n(r(0)),d=l(r(26)),p=r(189),m=l(r(805)),h=r(803),v=l(r(1418)),E=l(r(1419)),y=l(r(1003)),g=l(r(1420)),b=l(r(962)),S=l(r(1004)),_=l(r(2473));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var C=Object.keys(h.unitTransformMap).map((function(e){return{label:e,value:e}})),T=function(e){(0,c.default)(r,e);var a=O(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.supportMetrics,r=e.labelsets,n=e.onLabelSearch;return f.default.createElement("div",{className:_.default.wrapper},f.default.createElement(y.default,{label:t("BASIC_INFORMATION")},f.default.createElement(p.Form.Item,null,f.default.createElement(p.Columns,null,f.default.createElement(p.Column,null,f.default.createElement(p.Form.Item,null,f.default.createElement(b.default,{name:"title"},(function(e){var a=e.onChange,r=e.value;return f.default.createElement(S.default,{label:t("GRAPH_NAME")},f.default.createElement(p.Input,{value:r,onChange:a}))})))),f.default.createElement(p.Column,null,f.default.createElement(p.Form.Item,null,f.default.createElement(b.default,{name:"description"},(function(e){var a=e.onChange,r=e.value;return f.default.createElement(S.default,{label:t("DESCRIPTION")},f.default.createElement(p.Input,{value:r,onChange:a}))}))))))),f.default.createElement(y.default,{label:t("DATA")},f.default.createElement(p.Form.Item,null,f.default.createElement(v.default,{name:"targets",header:function(e){var a=e.add,r=e.value;return f.default.createElement(g.default,{right:f.default.createElement(p.Button,{type:"control",onClick:function(){return a({step:(0,d.default)(r,"[0].step",""),legendFormat:"",expr:"",refId:Math.max.apply(null,r.map((function(e){return e.refId})))+1})}},t("ADD"))})}},(function(e){var t=e.formItemName,l=e.onDelete,u=e.onUpClick,o=e.onDownClick,c=e.index;return f.default.createElement(E.default,{key:c,onDelete:l,onUpClick:u,onDownClick:o,prefix:t,labelsets:r,onLabelSearch:n,supportMetrics:a})})))),f.default.createElement(y.default,{label:t("Y_AXIS")},f.default.createElement(p.Columns,null,f.default.createElement(p.Column,null,f.default.createElement(p.Form.Item,null,f.default.createElement(b.default,{name:"yaxes[0].format",debounce:100},(function(e){var a=e.onChange,r=e.value;return f.default.createElement(S.default,{label:t("UNIT"),tips:""},f.default.createElement(p.Select,{defaultValue:"none",options:C,value:r,onChange:a}))})))),f.default.createElement(p.Column,null,f.default.createElement(p.Form.Item,null,f.default.createElement(b.default,{name:"yaxes[0].decimals",debounce:100},(function(e){var a=e.onChange,r=e.value;return f.default.createElement(S.default,{label:t("DECIMALS"),tips:""},f.default.createElement(m.default,{defaultValue:0,value:r,max:5,min:0,onChange:a}))})))))))}}]),r}(f.Component);a.default=T},function(e,t,a){e.exports={wrapper:"_1yTATo3lD_7rwY6lDudrCg",sort:"_1EFKSiYd2WrRafk0f3869_",form:"_3zEEtuQ4RATqr1QWLM324p",firstLine:"_3pMxYSBlRPq-WUsskbA7Tq",name:"_3aiu8eoQvrvOlWJ1SOMEHc",interval:"sCj97pEm23Tzvk_osJXDd",exprInput:"_28BUdWgdtRiDcK_TmmW9Cn"}},function(e,t,a){e.exports={wrapper:"_14rVNDNOZeNfMTOdh6yKjR"}},function(e,t,a){},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(8),r(4),r(18),r(43),r(11);var u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(45)),m=l(r(0)),h=r(243),v=r(17),E=r(189),y=n(r(805)),g=n(r(1418)),b=n(r(1166)),S=r(1167),_=n(r(1003)),O=n(r(1419)),C=n(r(2475)),T=n(r(1420)),R=n(r(962)),D=n(r(1004));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var N=(0,h.inject)("monitoringStore")(u=(0,h.observer)((o=function(e){(0,i.default)(r,e);var a=k(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"render",value:function(){return m.default.createElement(b.default,{preview:m.default.createElement("div",null),sidebar:m.default.createElement(S.GraphTextInput,{type:"table"}),main:m.default.createElement(m.default.Fragment,null,m.default.createElement(_.default,{label:t("DATA")},m.default.createElement(E.Form.Item,null,m.default.createElement(g.default,{name:"targets",header:function(e){var a=e.onAdd;return m.default.createElement(T.default,{right:m.default.createElement(E.Button,{type:"control",onClick:a},t("ADD"))})}},(function(e){var t=e.formItemName,a=e.onDelete,r=e.onUpClick,n=e.onDownClick;return m.default.createElement(O.default,{onDelete:a,onUpClick:r,onDownClick:n,prefix:t})})))),m.default.createElement(_.default,{label:t("TABLE_SETTINGS")},m.default.createElement(E.Form.Item,null,m.default.createElement(g.default,{name:"styles",header:function(e){var a=e.onAdd;return m.default.createElement(T.default,{left:m.default.createElement(E.Form.Item,null,m.default.createElement(R.default,{name:"expr"},(function(e){var a=e.onChange,r=e.value;return m.default.createElement("div",null,m.default.createElement(D.default,{label:t("PER_PAGE_LINES"),tips:""},m.default.createElement(y.default,{value:r,onChange:a,defaultValue:100})))}))),right:m.default.createElement(E.Button,{type:"control",onClick:a},t("ADD"))})}},(function(e){var t=e.formItemName,a=e.onDelete,r=e.onUpClick,n=e.onDownClick;return m.default.createElement(C.default,{onDelete:a,onUpClick:r,onDownClick:n,prefix:t})})))))})}},{key:"monitor",get:function(){return this.props.monitor}}]),r}(m.Component),(0,p.default)(o.prototype,"monitor",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"monitor"),o.prototype),u=o))||u)||u;a.default=N},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(320),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.prefix,r=e.onUpClick,n=e.onDownClick,l=e.onDelete;return u.default.createElement("div",{className:f.default.wrapper},u.default.createElement("div",{className:f.default.sort},u.default.createElement(o.Icon,{name:"sort-ascending",onClick:r}),u.default.createElement(o.Icon,{name:"sort-descending",onClick:n})),u.default.createElement("div",{className:f.default.form},u.default.createElement("div",{className:f.default.firstLine},u.default.createElement("div",null,u.default.createElement(o.Form.Item,{className:f.default.name},u.default.createElement(c.default,{name:"".concat(a,".alias")},(function(e){var a=e.onChange,r=e.value;return u.default.createElement("div",null,u.default.createElement(s.default,{label:t("COLUMN_NAME"),tips:""},u.default.createElement(o.Input,{className:f.default.input,value:r,onChange:a})))}))),u.default.createElement(o.Form.Item,{className:f.default.interval},u.default.createElement(c.default,{name:"".concat(a,".pattern")},(function(e){var a=e.onChange,r=e.value;return u.default.createElement("div",null,u.default.createElement(s.default,{label:t("FIELD_NAME"),tips:""},u.default.createElement(o.Input,{className:f.default.input,value:r,onChange:a})))})))),u.default.createElement(o.Icon,{name:"trash",onClick:l})),u.default.createElement("div",{className:f.default.exprInput},u.default.createElement(o.Form.Item,null,u.default.createElement(c.default,{name:"".concat(a)},(function(e){var a=e.onChange,r=e.value;return u.default.createElement(s.default,{label:t("DISPLAY_FORMAT"),tips:""},u.default.createElement(i.default,{value:r,onChange:function(e){return a(p(p({},r),e))}}))}))))))};var l=n(r(31));r(12),r(10),r(6),r(27),r(320),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var u=n(r(0)),o=r(189),c=n(r(962)),s=n(r(1004)),i=n(r(2476)),f=n(r(2494));function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(198)),d=r(189),p=r(17),m=n(r(2477)),h=n(r(2493));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=function(e){(0,o.default)(r,e);var a=v(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).state={shouldInputModalShow:!1},e.handleCustomClick=function(){e.setState({shouldInputModalShow:!0})},e.handleCustomColseClick=function(){e.setState({shouldInputModalShow:!1})},e.handleModalSubmit=function(t){e.setState({shouldInputModalShow:!1}),e.props.onChange(t)},e}return(0,u.default)(r,[{key:"render",value:function(){var e=this.state.shouldInputModalShow,a=this.props.value;return i.default.createElement("div",null,i.default.createElement("div",{className:h.default.wrapper},i.default.createElement("div",null,this.renderItems()),i.default.createElement("div",{onClick:this.handleCustomClick},i.default.createElement("span",{className:h.default.button},i.default.createElement(d.Icon,{name:"pen"}),t("DISPLAY_FORMAT")))),i.default.createElement(m.default,{data:(0,p.toJS)(a),visible:e,onCancel:this.handleCustomColseClick,onOk:this.handleModalSubmit}))}},{key:"renderItems",value:function(){var e=this.props.value;return[{key:"type",label:t("TYPE")},{key:"unit",label:t("UNIT"),visible:function(e,t){return"number"===t.type}},{key:"dateFormat",label:t("TIME_FORMAT"),visible:function(e,t){return"date"===t.type}},{key:"decimals",label:t("DECIMALS"),visible:function(e,t){return"number"===t.type}},{key:"colorMode",label:function(e){return"t('THRESHOLD_FILL') (".concat(e,")")},visible:function(e,t){return"number"===t.type&&"disabled"!==e},value:function(e,t){return i.default.createElement(i.default.Fragment,null,i.default.createElement("span",{className:h.default.colorCycle,style:{backgroundColor:t.colors[0]}}),i.default.createElement("span",null,"<"),i.default.createElement("span",null,t.thresholds[0]),i.default.createElement("span",null,"<"),i.default.createElement("span",{className:h.default.colorCycle,style:{backgroundColor:t.colors[1]}}),i.default.createElement("span",null,"<"),i.default.createElement("span",null,t.thresholds[1]),i.default.createElement("span",null,"<"),i.default.createElement("span",{className:h.default.colorCycle,style:{backgroundColor:t.colors[2]}}))}}].map((function(t){if((0,f.default)(t.visible)&&!t.visible(e[t.key],e))return!1;var a=(0,f.default)(t.value)?t.value(e[t.key],e):e[t.key];if(!a)return!1;var r=(0,f.default)(t.label)?t.label(e[t.key],e):t.label;return i.default.createElement("span",{key:t.key,className:h.default.item},r,": ",a)}))}}]),r}(i.default.Component);a.default=E},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(244)),d=n(r(798)),p=r(189),m=n(r(805)),h=n(r(2478)),v=n(r(2492));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).form=i.default.createRef(),t.handleTypeChange=function(e){t.setState({type:e})},t.onOk=function(){var e,a=t.props.data.type;"date"===a?e=(0,f.default)(t.props.data,["type","dateFormat"]):"number"===a?e=(0,f.default)(t.props.data,["type","decimals","unit","colorMode","thresholds","colors"]):"string"===a&&(e=(0,f.default)(t.props.data,["type"])),t.form.current.validator((function(){return t.props.onOk(e)}))},t.state={type:e.data.type},t}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.data,r=e.visible,n=e.onCancel,l=this.state.type;return i.default.createElement(d.default,{width:960,title:t("CUSTOM_DISPLAY_STYLE"),description:t("CUSTOM_DISPLAY_MODAL_DESC"),icon:"table-chart",visible:r,okText:t("OK"),onCancel:n,onOk:this.onOk},i.default.createElement(p.Form,{data:a,ref:this.form},i.default.createElement(p.Columns,null,i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("DATA_TYPE")},i.default.createElement(p.Select,{name:"type",onChange:this.handleTypeChange,options:[{label:"string",value:"string"},{label:"date",value:"date"},{label:"number",value:"number"}]}))),i.default.createElement(p.Column,null)),"number"===l&&i.default.createElement("div",null,i.default.createElement(p.Columns,null,i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("UNIT")},i.default.createElement(p.Select,{defaultValue:"null",name:"unit",options:[{label:"Bytes",value:"Bytes"},{label:"null",value:"null"}]}))),i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{rules:[{required:!0}],label:t("DECIMALS")},i.default.createElement(m.default,{defaultValue:0,name:"decimals"})))),i.default.createElement(p.Columns,null,i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("THRESHOLD_FILL"),desc:t("THRESHOLD_FILL_DESC")},i.default.createElement(p.Select,{name:"colorMode",defaultValue:"disabled",options:[{label:"cell",value:"cell"},{label:"disabled",value:"disabled"},{label:"value",value:"value"}]}))),i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("HIGHT_RULES")},i.default.createElement("div",{className:v.default.tableColorStyle},i.default.createElement(p.Form.Item,{className:v.default.thresholds},i.default.createElement(h.default,{name:"colors[0]",defaultValue:"#fff"})),i.default.createElement("span",null," < "),i.default.createElement(p.Form.Item,{className:v.default.thresholds,rules:[{required:!0}]},i.default.createElement(m.default,{name:"thresholds[0]",defaultValue:0})),i.default.createElement("span",null," < "),i.default.createElement(p.Form.Item,{className:v.default.thresholds},i.default.createElement(h.default,{defaultValue:"#fff",name:"colors[1]"})),i.default.createElement("span",null," < "),i.default.createElement(p.Form.Item,{className:v.default.thresholds,rules:[{required:!0}]},i.default.createElement(m.default,{name:"thresholds[1]",defaultValue:0})),i.default.createElement("span",null," < "),i.default.createElement(p.Form.Item,{className:v.default.thresholds},i.default.createElement(h.default,{name:"colors[2]",defaultValue:"#fff"}))))))),"date"===l&&i.default.createElement("div",null,i.default.createElement(p.Columns,null,i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("TIME_FORMAT"),rules:[{required:!0}]},i.default.createElement(p.Select,{name:"dateFormat",defaultValue:"YYYY/MM/DD HH:mm:ss",options:[{label:"YYYY/MM/DD HH:mm:ss",value:"YYYY/MM/DD HH:mm:ss"}]})))))))}}]),r}(i.default.Component);a.default=y},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(28)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(0)),i=a(4564),f=r(a(5)),d=r(a(2491));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var m=function(e){(0,u.default)(a,e);var t=p(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return(e=t.call.apply(t,[this].concat(l))).state={shouldMenuShow:!1},e.startSelect=function(){e.setState({shouldMenuShow:!0})},e.changeComplete=function(t){var a=t.hex;e.setState({shouldMenuShow:!1}),e.props.onChange(a)},e}return(0,l.default)(a,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.className,r=this.state.shouldMenuShow;return s.default.createElement("div",{className:(0,f.default)(d.default.wrapper,a)},s.default.createElement("div",{style:{backgroundColor:t},onClick:this.startSelect}),r?s.default.createElement("div",{className:d.default.menu},s.default.createElement(i.SwatchesPicker,{onChangeComplete:this.changeComplete})):null)}}]),a}(s.default.Component);t.default=m},,,,,,,,,,,,,function(e,t,a){e.exports={wrapper:"_2DqLE96MTxZgrmRaNYl3JI",menu:"_2YfBS7zYBSFVfBIOJT917U"}},function(e,t,a){e.exports={tableColorStyle:"_1_27Q09X6bn874q3jLw2v_",thresholds:"_1RovZFa3S9pOGx6bbUQPeW"}},function(e,t,a){e.exports={wrapper:"o_P3iP3_ZCsYtILH2QSyr",button:"_8-O7IVONGvYHZOfpcUOd",item:"_1GpHd2FMkgEHInMuv06qmH",colorCycle:"_1RNy3XODfgSAL5n6eOXavO"}},function(e,t,a){e.exports={wrapper:"_3h-NIuRqRE3h9GtNycKl4C",sort:"_3zsgf0KB-tg69gdZzW1-R2",form:"_2jSW_hDrQmQKxkNpIAG6sD",firstLine:"FrymriZwgftO8vlt-WmRq",name:"_1QnATmUkirtXgCWVQyKWSi",interval:"_3YNbiGLQms1_SoiSyMlZUp",exprInput:"_2mO4Qynrm8iiNk_zzxR4N_"}},function(e,t,a){"use strict";a(16);var r=a(19),n=a(162);a(3),a(6),a(20),a(87),a(14),a(8),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(6),a(20),a(87),a(29),a(14),a(8),a(4),a(18),a(43),a(11),a(7);var l,u,o=r(a(58)),c=r(a(25)),s=r(a(28)),i=r(a(41)),f=r(a(42)),d=r(a(37)),p=r(a(45)),m=n(a(0)),h=a(243),v=a(17),E=r(a(67)),y=r(a(2496)),g=r(a(2502)),b=r(a(2513)),S=r(a(2515));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=(0,h.inject)("monitoringStore")(l=(0,h.observer)((u=function(e){(0,i.default)(a,e);var t=_(a);function a(){return(0,c.default)(this,a),t.apply(this,arguments)}return(0,s.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.allMonitors.forEach((function(t){return t.monitoring(e.monitoringStore)}))}},{key:"componentWillUnmount",value:function(){this.allMonitors.forEach((function(e){e.stopMonitoring(),e.clearMonitorMetrics()}))}},{key:"render",value:function(){var e=this.props.monitoringStore.isEditing;return m.default.createElement(b.default,{graphList:m.default.createElement(y.default,{rows:[this.monitoringStore.unNameGraphRow].concat((0,o.default)(this.graphMonitorRows)),monitos:this.allMonitors}),graphRowList:e?m.default.createElement(g.default,null):this.renderGraphRows()})}},{key:"monitorStatFactory",value:function(e){return{id:e.config.id,title:e.config.title,metrics:(0,E.default)(e.stats)?[]:e.stats.map((function(e){return{title:e.name,id:e.id,color:e.color,value:e.stat}}))}}},{key:"renderGraphRows",value:function(){var e=this,t=[{id:0,hideTitle:!0,panels:this.unNameGraphRowMonitors.map(this.monitorStatFactory,this)}],a=this.graphMonitorRows.map((function(t){return{title:t.config.title,id:t.config.id,panels:t.monitors.map(e.monitorStatFactory,e)}}));return m.default.createElement(m.default.Fragment,null,m.default.createElement(S.default,{rows:t}),m.default.createElement(S.default,{rows:a}))}},{key:"monitoringStore",get:function(){return this.props.monitoringStore}},{key:"graphMonitorRows",get:function(){return this.monitoringStore.graphMonitorRows}},{key:"unNameGraphRowMonitors",get:function(){return this.monitoringStore.unNameGraphRow.monitors}},{key:"monitorsInRows",get:function(){return this.graphMonitorRows.reduce((function(e,t){return[].concat((0,o.default)(e),(0,o.default)(t.monitors))}),[])}},{key:"allMonitors",get:function(){return[].concat((0,o.default)(this.unNameGraphRowMonitors),(0,o.default)(this.monitorsInRows))}}]),a}(m.Component),(0,p.default)(u.prototype,"monitoringStore",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"monitoringStore"),u.prototype),(0,p.default)(u.prototype,"graphMonitorRows",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"graphMonitorRows"),u.prototype),(0,p.default)(u.prototype,"unNameGraphRowMonitors",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"unNameGraphRowMonitors"),u.prototype),(0,p.default)(u.prototype,"monitorsInRows",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"monitorsInRows"),u.prototype),(0,p.default)(u.prototype,"allMonitors",[v.computed],Object.getOwnPropertyDescriptor(u.prototype,"allMonitors"),u.prototype),l=u))||l)||l;t.default=O},function(e,t,a){"use strict";a(16);var r=a(19),n=a(162);a(12),a(109),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(32),a(20),a(29),a(4),a(18),a(43),a(11);var l,u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=n(a(0)),d=a(243),p=r(a(2497)),m=r(a(1059)),h=r(a(2500));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E={graph:p.default,table:function(){}},y=(0,d.observer)(l=function(e){(0,c.default)(a,e);var t=v(a);function a(){return(0,u.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){return f.default.createElement("div",null,this.props.rows.map((function(e){return f.default.createElement(f.default.Fragment,{key:e.config.id},e.monitors.map((function(e){var t=e.config||{},a=t.id,r=t.title,n=t.description,l=t.type,u=E[l],o=Object.prototype.toString.call(u);return f.default.createElement(m.default,{key:a,errorMessage:e.errorMessage},f.default.createElement(h.default,{title:r,description:n},"[object Function]"!==o&&u?f.default.createElement(u,{monitor:e}):null))})))})))}}]),a}(f.Component))||l;t.default=y},function(e,t,a){"use strict";a(16);var r=a(19);a(66),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(66),a(20),a(29),a(4),a(18),a(43),a(11);var n,l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(243),d=r(a(2498));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=(0,f.inject)("monitoringStore")(n=(0,f.observer)(n=function(e){(0,o.default)(a,e);var t=p(a);function a(){return(0,l.default)(this,a),t.apply(this,arguments)}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props.monitoringStore.getTimeRange(),t=e.from,a=e.to,r={start:t.valueOf(),end:a.valueOf()},n=this.props.monitor,l=n.config,u=n.valueFormatter,o=n.graphData,c=n.legends,s=l.title,f=l.lines,p=l.bars,m=l.stack;return i.default.createElement(d.default,{key:c.map((function(e){return e.ID})).join(","),title:s,line:f,bar:p,stacked:m,timeRange:r,valueFormatter:u,legends:c,data:o})}}]),a}(i.default.Component))||n)||n;t.default=m},function(e,t,a){"use strict";var r=a(19);a(12),a(3),a(10),a(6),a(20),a(87),a(14),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(20),a(27),a(87),a(29),a(14),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var n=r(a(317)),l=r(a(50)),u=r(a(31)),o=r(a(25)),c=r(a(28)),s=r(a(41)),i=r(a(42)),f=r(a(37)),d=r(a(0)),p=r(a(5)),m=r(a(1416)),h=r(a(2499));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=function(e){(0,s.default)(a,e);var t=y(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={legendsVisibleStates:e.props.legends.reduce((function(e,t){return E(E({},e),{},(0,u.default)({},t.ID,!0))}),{})},e.handleClick=function(t){var a=t.currentTarget.dataset.id,r=e.state.legendsVisibleStates;e.setState({legendsVisibleStates:E(E({},r),{},(0,u.default)({},a,!r[a]))})},e}return(0,c.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.legends,r=(0,l.default)(t,["legends"]),o=this.state.legendsVisibleStates;return d.default.createElement("div",{className:h.default.wrapper},d.default.createElement(m.default,(0,n.default)({},r,{legends:a.filter((function(e){return o[e.ID]}))})),d.default.createElement("div",null,a.map((function(t){return d.default.createElement("span",{className:(0,p.default)(h.default.legend,(0,u.default)({},h.default.hidden,!o[t.ID])),key:t.ID,"data-id":t.ID,onClick:e.handleClick},d.default.createElement("small",{className:h.default.radios,style:{backgroundColor:t.color}}),d.default.createElement("span",null,t.name))}))))}}]),a}(d.default.Component);t.default=g},function(e,t,a){e.exports={legend:"hYVeXXLX5hUg_Skp5KFDx",hidden:"_3UdJhoiUMp6i5NgSYGomIF"}},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.title,a=e.description,r=e.children;return n.default.createElement("div",{className:u.default.wrapper},n.default.createElement("header",null,n.default.createElement("h3",null,t,a&&n.default.createElement(l.Tooltip,{content:a},n.default.createElement(l.Icon,{name:"question"})))),r)},a(12),a(109);var n=r(a(0)),l=a(189),u=r(a(2501))},function(e,t,a){e.exports={wrapper:"_1u2Q6u2ZLAcL6JzPYrETFD",maximize:"_2f_K6nodyfyufD4be_iRn_"}},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(66),r(20),r(194),r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(66),r(20),r(194),r(29),r(8),r(4),r(18),r(43),r(11);var u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(45)),m=l(r(0)),h=r(243),v=r(17),E=r(1415),y=n(r(2503)),g=n(r(2505)),b=n(r(2507)),S=n(r(2509)),_=n(r(2511));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var C=(0,h.inject)("monitoringStore","modalStore")(u=(0,h.observer)((o=function(e){(0,i.default)(r,e);var a=O(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).addRow=function(){e.props.monitoringStore.addNewRow()},e.showMonitorModal=function(){e.props.modalStore.showNewMonitorModal()},e.onNewMonitorModalCancel=function(){e.props.modalStore.hideNewMonitorModal()},e.onConfirmNewGraphType=function(t){var a;"line"===t||"bar"===t?a=e.props.monitoringStore.generatGraphMonitor({lines:"line"===t,bars:"bar"===t}):"table"===t&&(a=e.props.monitoringStore.generatTableMonitor()),e.props.modalStore.hideNewMonitorModal(),e.modalStore.selectMonitor(a)},e}return(0,s.default)(r,[{key:"handleRowTitleChange",value:function(e){return function(t){e.config.title=t}}},{key:"handleRowPanelsSort",value:function(e){return function(t){var a=e.monitors.map((function(e){return e.id})).join(",");t.map((function(e){return e.monitor.id})).join(",")!==a&&(e.monitors=t.map((function(t){var a=t.monitor;return a.belong(e),a})))}}},{key:"handleRowDesc",value:function(e){var t=this;return function(){var a=t.props.monitoringStore.graphMonitorRows,r=a.length,n=a[e];a[e]=a[(e+1)%r],a[(e+1)%r]=n}}},{key:"handleRowAsc",value:function(e){var t=this;return function(){var a=t.props.monitoringStore.graphMonitorRows,r=a.length,n=a[e];a[e]=a[(e+r-1)%r],a[(e+r-1)%r]=n}}},{key:"handleRowDelete",value:function(e){var t=this;return function(){t.props.monitoringStore.graphMonitorRows.splice(e,1)}}},{key:"handleMonitorDelete",value:function(e,t){return function(){e.deleteTextMonitorByIndex(t)}}},{key:"handleMonitorSelect",value:function(e){var t=this;return function(){t.props.modalStore.selectMonitor(e)}}},{key:"render",value:function(){var e=this,a=this.props.monitoringStore.unNameGraphRow,r=this.props.monitoringStore.graphMonitorRows;return m.default.createElement(b.default,{top:m.default.createElement("div",null,m.default.createElement(E.ReactSortable,{handle:".".concat("j-sort"),list:a.monitors.map((function(e){return{monitor:e}})),setList:this.handleRowPanelsSort(a),animation:200,group:"group"},a.monitors.map((function(t,r){return m.default.createElement(g.default,{key:t.id,title:t.config.title,sortHandlerClassName:"j-sort",onEditClick:e.handleMonitorSelect(t),onDeleteClick:e.handleMonitorDelete(a,r)})}))),r.map((function(t,a){return m.default.createElement("div",{key:t.config.id},m.default.createElement(y.default,{key:t.config.id,onChange:e.handleRowTitleChange(t),title:t.config.title,onDescClick:e.handleRowDesc(a),onAscClick:e.handleRowAsc(a),onDeleteClick:e.handleRowDelete(a)}),m.default.createElement(E.ReactSortable,{key:"sortTable".concat(t.config.id),handle:".".concat("j-sort"),list:t.monitors.map((function(e){return{monitor:e}})),setList:e.handleRowPanelsSort(t),animation:200,group:"group"},t.monitors.map((function(a,r){return m.default.createElement(g.default,{key:a.config.id,title:a.config.title,sortHandlerClassName:"j-sort",onEditClick:e.handleMonitorSelect(a),onDeleteClick:e.handleMonitorDelete(t,r)})}))))}))),bottom:m.default.createElement("div",null,m.default.createElement(S.default,{title:t("ADD_MONITOR_ITEM"),onClick:this.showMonitorModal}),m.default.createElement(S.default,{title:t("ADD_MONITOR_ROW"),onClick:this.addRow}),m.default.createElement(_.default,{visible:this.modalStore.shouldNewMonitorModalShow,onCancel:this.onNewMonitorModalCancel,onOk:this.onConfirmNewGraphType}))})}},{key:"modalStore",get:function(){return this.props.modalStore}},{key:"monitoringStore",get:function(){return this.props.monitoringStore}}]),r}(m.Component),(0,p.default)(o.prototype,"modalStore",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"modalStore"),o.prototype),(0,p.default)(o.prototype,"monitoringStore",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"monitoringStore"),o.prototype),u=o))||u)||u;a.default=C},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(28)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(0)),i=a(189),f=r(a(2504));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var p=function(e){(0,u.default)(a,e);var t=d(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return(e=t.call.apply(t,[this].concat(l))).state={editing:!1},e.handleEditClick=function(){e.setState({editing:!0},(function(){e.inputRef.current.focus()}))},e.inputRef=s.default.createRef(),e.onChange=function(t){(0,e.props.onChange)(t.target.value)},e.onBlur=function(){e.setState({editing:!1})},e.onKeyUp=function(t){13===t.keyCode&&e.setState({editing:!1})},e}return(0,l.default)(a,[{key:"render",value:function(){var e=this.state.editing,t=this.props,a=t.title,r=t.onDescClick,n=t.onAscClick,l=t.onDeleteClick;return s.default.createElement("div",{className:f.default.wrapper},s.default.createElement("h3",null,e?s.default.createElement("input",{ref:this.inputRef,type:"text",value:a,onBlur:this.onBlur,onChange:this.onChange,onKeyUp:this.onKeyUp}):a),s.default.createElement("span",{className:f.default.tools},s.default.createElement(i.Icon,{name:"pen",onClick:this.handleEditClick}),s.default.createElement(i.Icon,{name:"trash",onClick:l}),s.default.createElement(i.Icon,{name:"sort-descending",onClick:r}),s.default.createElement(i.Icon,{name:"sort-ascending",onClick:n})))}}]),a}(s.default.Component);t.default=p},function(e,t,a){e.exports={wrapper:"_1Q5L6xVUY_dZiZE9P7abIn",tools:"_2AX8cBDeGzuZCuS9zSbLUA"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.title,a=e.sortHandlerClassName,r=e.onEditClick,o=e.onDeleteClick;return n.default.createElement("div",{className:u.default.wrapper},n.default.createElement("h3",null,t),n.default.createElement("div",{className:u.default.tools},n.default.createElement(l.Icon,{name:"pen",className:u.default.edit,onClick:r}),n.default.createElement(l.Icon,{name:"trash",className:u.default.edit,onClick:o}),n.default.createElement(l.Icon,{name:"drag-handle",className:a})))};var n=r(a(0)),l=a(189),u=r(a(2506))},function(e,t,a){e.exports={wrapper:"_1YVAyThxPFHSQQzYDWZZba",tools:"_1K8ripXpvIFhR8VfrzmiBH",edit:"FP5B56V7_lFfN94zeARrg"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.top,a=e.bottom;return n.default.createElement("div",{className:l.default.wrapper},n.default.createElement("div",null,t),n.default.createElement("div",null,a))};var n=r(a(0)),l=r(a(2508))},function(e,t,a){e.exports={wrapper:"_3_UUuXKfEGWvjq98lJJLFJ"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.title,a=e.onClick;return n.default.createElement("div",{className:u.default.wrapper,onClick:a},n.default.createElement(l.Icon,{name:"add"}),n.default.createElement("span",null,t))};var n=r(a(0)),l=a(189),u=r(a(2510))},function(e,t,a){e.exports={wrapper:"_2dxZyYmy9dDDX9jI0csU0h"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(12),r(109),r(3),r(20),r(14),r(99),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(20),r(29),r(14),r(99),r(4),r(18),r(43),r(11);var u=l(r(31)),o=l(r(97)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(5)),h=l(r(798)),v=r(189),E=l(r(1003)),y=l(r(2512));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=function(e){(0,i.default)(r,e);var a=g(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).state={type:"line"},e.typeConfig={line:{icon:"linechart",name:t("LINE_CHART"),desc:[{title:t("APPLICABLE_SCENE"),description:t("LINE_CHART_DESC")},{title:t("BASE_LINE_CHART"),description:t("BASE_LINE_CHART_DESC")},{title:t("STACK_LINE_CHART"),description:t("STACK_LINE_CHART_DESC")}]},bar:{icon:"barchart",name:t("BAR_CHART"),desc:[{title:t("APPLICABLE_SCENE"),description:t("BAR_CHART_DESC")},{title:t("BASE_BAR_CHART"),description:t("BASE_BAR_CHART_DESC")},{title:t("STACK_BAR_CHART"),description:t("STACK_BAR_CHART_DESC")}]}},e.handleClick=function(t){e.setState({type:t.currentTarget.dataset.type})},e.onOk=function(){e.props.onOk(e.state.type)},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.visible,n=a.onCancel,l=this.state.type,c=this.typeConfig[l];return p.default.createElement(h.default,{width:960,imageIcon:"/extensions-static/ks-console-embed/dist/v3dist/assets/coin.svg",title:t("SELECT_CHART_TYPE"),description:t("SELECT_CHART_TYPE_MODAL_DESC"),visible:r,onCancel:n,onOk:this.onOk},p.default.createElement("div",{className:y.default.wrapper},p.default.createElement(E.default,{label:t("CHART_TYPES")},Object.entries(this.typeConfig).map((function(t){var a=(0,o.default)(t,2),r=a[0],n=a[1];return p.default.createElement("div",{key:r,"data-type":r,onClick:e.handleClick,className:y.default.typeOpts},p.default.createElement("div",{className:(0,m.default)(y.default.typeOpt,(0,u.default)({},y.default.select,r===l))},p.default.createElement(v.Icon,{className:y.default.icon,name:n.icon,size:40,type:r===l?"light":"dark"}),p.default.createElement("h4",null,n.name)))}))),c.desc.map((function(e){return p.default.createElement("div",{key:e.title},p.default.createElement("h3",null,e.title),p.default.createElement("p",null,e.description))})),p.default.createElement(E.default,{label:t("DISPLAY_POSITION")},p.default.createElement("div",{className:y.default.position},p.default.createElement("div",{className:y.default.navs},p.default.createElement("div",null),p.default.createElement("div",null)),p.default.createElement("div",{className:y.default.placeholderWrapper},p.default.createElement("div",{className:y.default.placeholder},p.default.createElement("div",{className:"text-center"},p.default.createElement(v.Icon,{name:c.icon,size:40}),p.default.createElement("div",{className:"margin-t12"},t("EMPTY_CHART_PLACEHOLDER")))))))))}}]),r}(p.Component);a.default=b},function(e,t,a){e.exports={wrapper:"_3Gsl08n1YLlMoZKB-ZIDyt",typeOpts:"DI7hisvpRHRQ4BOLCrfHJ",typeOpt:"_2_0SO5zI5pSrohp43NuaNF",select:"_2ydBGOddL92AnuxLWamTH7",position:"_1EKwsFmFowHAHtJ7TY95ZU",navs:"qqJ5lFZU8VjK1Sxl4oDZu",placeholderWrapper:"_1N3lMb4bCQ9diP9zwD3xpY",placeholder:"_11m9sjSshUu7Y2-c_9QF5D"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.graphList,a=e.graphRowList;return n.default.createElement("div",{className:l.default.wrapper},n.default.createElement("div",{className:l.default.graphs},t),n.default.createElement("div",{className:l.default.row},a))};var n=r(a(0)),l=r(a(2514))},function(e,t,a){e.exports={wrapper:"_2f81WjhyuGPKeTo_qAX3rO",graphs:"_Jreo1l7RXs_lL5KI3y-i",row:"_28aqToPqGsHD4usWoSm-Sq",hidden:"_1muGurgPkX7BU0SJUUGgkk"}},function(e,t,a){"use strict";a(16);var r=a(19);a(20),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.rows.map((function(e){return n.default.createElement("div",{key:e.id},e.hideTitle||n.default.createElement("h3",{className:u.default.rowTitle},e.title),e.panels.map((function(e){return n.default.createElement(l.default,{key:e.id,title:e.title,metrics:e.metrics})})))}))},a(20);var n=r(a(0)),l=r(a(2516)),u=r(a(2518))},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(20),a(99),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(99),a(4),a(18),a(43),a(11);var n=r(a(97)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=r(a(76)),d=a(189),p=r(a(2517));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(a,e);var t=m(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).state={collapse:!0},e.handleTitleClick=function(){e.setState((function(e){return{collapse:!e.collapse}}))},e}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.metrics,r=this.state.collapse;return i.default.createElement("div",{className:p.default.wrapper},i.default.createElement("h3",{onClick:this.handleTitleClick},i.default.createElement("span",null,t),i.default.createElement("small",null,i.default.createElement(d.Icon,{name:r?"chevron-right":"chevron-down"}))),!r&&i.default.createElement("div",{className:p.default.legendsContainer},a.map((function(e,t){return i.default.createElement("div",{className:p.default.legends,key:t},i.default.createElement("p",null,i.default.createElement("small",{style:{backgroundColor:e.color}}),i.default.createElement("span",{title:e.title},e.title)),i.default.createElement("div",{className:p.default.subMetrics},(0,f.default)(e.value)&&Object.entries(e.value).map((function(e){var t=(0,n.default)(e,2),a=t[0],r=t[1];return i.default.createElement("div",{key:a},i.default.createElement("span",null,a),i.default.createElement("span",null,r))}))))}))))}}]),a}(i.default.Component);t.default=h},function(e,t,a){e.exports={wrapper:"rjDeaoFJ6N8WsWZ0bilph",legendsContainer:"_1Qvu2gaT9loLM60nS8Q06W",legends:"_2n9SFFnS_yXTWI_QrGamFb",subMetrics:"_2Q1jEzz9hTB_6cseHgUbTs"}},function(e,t,a){e.exports={rowTitle:"_20_7N3uyaR-QiWjc9NRg3z"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(0)),l=a(243),u=r(a(1413));var o=(0,l.inject)("modalStore")((function(e){var t=e.modalStore;return n.default.createElement(u.default,{type:"control",icon:"theme",onClick:function(){t.changeTheme()}})}));t.default=o},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(442),r(29),r(4),r(18),r(43),r(11),r(110);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(245));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var p=function(e){(0,o.default)(r,e);var a=d(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).state={time:Date.now()},e}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.updateTime()}},{key:"updateTime",value:function(){var e=this;this.timer=setTimeout((function(){e.setState({time:Date.now()}),e.updateTime()}),1e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"render",value:function(){return i.default.createElement(i.default.Fragment,null,t("TIME"),": ",(0,f.default)(this.state.time).format("YYYY-MM-DD HH:mm:ss"))}}]),r}(i.default.Component);a.default=p},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.theme,a=e.className,r=(0,l.default)(e,["theme","className"]),i="light"===t?s.default.light:s.default.dark;return u.default.createElement(c.default,(0,n.default)({className:(0,o.default)(a,i)},r))};var n=r(a(317)),l=r(a(50)),u=r(a(0)),o=r(a(5)),c=r(a(2522)),s=r(a(2524))},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.title,a=e.description,r=e.onCancel,s=e.children,i=e.operations,f=e.className;return n.default.createElement(u.default,{fullScreen:!0,hideFooter:!0,visible:!0,title:t,description:a,icon:"monitor",className:(0,o.default)(c.default.wrapper,f),headerClassName:c.default.header,bodyClassName:c.default.body,closable:!1,operations:n.default.createElement("div",{className:c.default.operations},i,n.default.createElement(l.Button,{icon:"close",iconType:"light",type:"control",onClick:r,className:c.default.close}))},s)},a(12),a(109);var n=r(a(0)),l=a(189),u=r(a(798)),o=r(a(5)),c=r(a(2523))},function(e,t,a){e.exports={wrapper:"_1v3w1K8GocJSNhGw0Otqvw",operations:"_2AtGIYhklmm48zCtgKZtnI",body:"_2_tbF0yNMg946Wj9MNdEpW",header:"_1Jj1diU-3q7-CIxwUuTEsN",close:"iOtAIVcFhv-JY_191Zjgq"}},function(e,t,a){e.exports={dark:"_2Y2inQV9uyIxXH3la3UO2x",light:"SrA97pSKRoGNYKHsT1wtU"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.sidebar,a=e.content;return n.default.createElement("div",{className:l.default.wrapper},n.default.createElement("div",{className:l.default.sidebar},t),n.default.createElement("div",{className:l.default.content},a))};var n=r(a(0)),l=r(a(2526))},function(e,t,a){e.exports={wrapper:"_2VQ65xJOwT9qSI7B5BWRaN",sidebar:"_88ehNHIYZa4OJYE96LJg2",content:"_1mU4S3qQTlDWk5sHLHl-0G"}},function(e,t,a){"use strict";a(16);var r=a(19);a(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(8);var n,l,u,o,c=r(a(62)),s=r(a(25)),i=r(a(28)),f=r(a(45)),d=(r(a(63)),a(17)),p=(n=function(){function e(){(0,s.default)(this,e),(0,c.default)(this,"theme",l,this),(0,c.default)(this,"selectedMonitor",u,this),(0,c.default)(this,"shouldNewMonitorModalShow",o,this)}return(0,i.default)(e,[{key:"selectMonitor",value:function(e){this.selectedMonitor=e}},{key:"unSelectMonitor",value:function(){this.selectedMonitor=null}},{key:"changeTheme",value:function(){this.theme="light"===this.theme?"dark":"light"}},{key:"showNewMonitorModal",value:function(){this.shouldNewMonitorModalShow=!0}},{key:"hideNewMonitorModal",value:function(){this.shouldNewMonitorModalShow=!1}}]),e}(),l=(0,f.default)(n.prototype,"theme",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"dark"}}),u=(0,f.default)(n.prototype,"selectedMonitor",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o=(0,f.default)(n.prototype,"shouldNewMonitorModalShow",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),(0,f.default)(n.prototype,"selectMonitor",[d.action],Object.getOwnPropertyDescriptor(n.prototype,"selectMonitor"),n.prototype),(0,f.default)(n.prototype,"unSelectMonitor",[d.action],Object.getOwnPropertyDescriptor(n.prototype,"unSelectMonitor"),n.prototype),(0,f.default)(n.prototype,"changeTheme",[d.action],Object.getOwnPropertyDescriptor(n.prototype,"changeTheme"),n.prototype),(0,f.default)(n.prototype,"showNewMonitorModal",[d.action],Object.getOwnPropertyDescriptor(n.prototype,"showNewMonitorModal"),n.prototype),(0,f.default)(n.prototype,"hideNewMonitorModal",[d.action],Object.getOwnPropertyDescriptor(n.prototype,"hideNewMonitorModal"),n.prototype),n);t.default=p},function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(24),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(20),a(29),a(24),a(8),a(4),a(18),a(43),a(11);var n,l=r(a(97)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(45)),d=r(a(26)),p=a(17),m=a(803),h=r(a(1171));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E={avg:m.avgs,last:function(e){return e[e.length-1]},first:function(e){return e[0]}},y=(n=function(e){(0,c.default)(a,e);var t=v(a);function a(){return(0,u.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"stat",get:function(){var e=this.config,t=e.valueName,a=e.decimals,r=void 0===a?0:a,n=e.format,u=this.metrics,o=this.metrics.length;if(o>1)return"Only queries that return single series/table is supported";if(0===o)return"No Data";var c=(0,d.default)(u,"0.values",[]).map((function(e){var t=(0,l.default)(e,2)[1];return Number(t)})),s=(E[t]||m.avgs)(c)||0;return(m.unitTransformMap[n]||m.unitTransformMap.none)(s,r)}}]),a}(h.default),(0,f.default)(n.prototype,"stat",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"stat"),n.prototype),n);t.default=y},function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(36),a(20),a(87),a(14),a(24),a(99),a(8),a(13),a(9),a(4),a(18),a(11),a(7),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(10),a(6),a(36),a(20),a(27),a(87),a(29),a(14),a(24),a(33),a(16),a(99),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7),a(40);var n,l=r(a(31)),u=r(a(97)),o=r(a(25)),c=r(a(28)),s=r(a(41)),i=r(a(42)),f=r(a(37)),d=r(a(45)),p=a(17),m=a(803),h=r(a(26)),v=r(a(1171));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g={avg:m.avgs,last:function(e){return e[e.length-1]},first:function(e){return e[0]},max:function(e){return Math.max.apply(null,e)},min:function(e){return Math.min.apply(null,e)}},b=(n=function(e){(0,s.default)(a,e);var t=y(a);function a(){return(0,o.default)(this,a),t.apply(this,arguments)}return(0,c.default)(a,[{key:"graphData",get:function(){var e=this.metrics.reduce((function(e,t){var a=t.values,r=t.id;return a.forEach((function(t){var a=(0,u.default)(t,2),n=a[0],l=a[1],o=1e3*n,c=e[o]||{};c[r]=Number(l),e[o]=c})),e}),{});return Object.entries(e).map((function(e){var t=(0,u.default)(e,2),a=t[0],r=t[1];return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({time:Number(a)},r)}))}},{key:"legends",get:function(){var e=this.config.colors,t=void 0===e?[]:e;return this.formattedMetrics.map((function(e,a){var r=e.id;return{name:e.name,ID:r,color:t[a%t.length]}}))}},{key:"valueFormatter",get:function(){var e=(0,h.default)(this.config,"yaxes[0].format","none"),t=(0,h.default)(this.config,"yaxes[0].decimals",2),a=m.unitTransformMap[e]||function(){};return function(e){return a(e,t)}}},{key:"stats",get:function(){var e=this;return this.formattedMetrics.map((function(t,a){var r=(t.values||[]).map((function(e){var t=(0,u.default)(e,2)[1];return Number(t)})),n=e.config.colors,l=void 0===n?[]:n;return{id:t.id,name:t.name,color:l[a%l.length],stat:{max:e.valueFormatter(g.max(r)),min:e.valueFormatter(g.min(r)),avg:e.valueFormatter(g.avg(r)),last:e.valueFormatter(g.last(r))}}}))}}]),a}(v.default),(0,d.default)(n.prototype,"graphData",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"graphData"),n.prototype),(0,d.default)(n.prototype,"legends",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"legends"),n.prototype),(0,d.default)(n.prototype,"valueFormatter",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"valueFormatter"),n.prototype),(0,d.default)(n.prototype,"stats",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"stats"),n.prototype),n);t.default=b},function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(194),a(8),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(20),a(27),a(194),a(8);var n,l,u,o=r(a(62)),c=r(a(25)),s=r(a(28)),i=r(a(45)),f=(r(a(63)),a(17)),d=r(a(258)),p=(n=function(){function e(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=a.config,n=void 0===r?{}:r,s=a.monitors,i=void 0===s?[]:s;(0,c.default)(this,e),(0,o.default)(this,"monitors",l,this),(0,o.default)(this,"config",u,this),this.config=n,this.monitors=i.map((function(e){return e.belong(t)}))}return(0,s.default)(e,[{key:"push",value:function(e){return e.belong(this),this.monitors.push(e),this}},{key:"has",value:function(e){return(0,d.default)(this.monitors,e)}},{key:"updateMonitors",value:function(e){this.monitors=e}},{key:"deleteTextMonitorByIndex",value:function(e){this.monitors.splice(e,1)}}]),e}(),l=(0,i.default)(n.prototype,"monitors",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u=(0,i.default)(n.prototype,"config",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),(0,i.default)(n.prototype,"updateMonitors",[f.action],Object.getOwnPropertyDescriptor(n.prototype,"updateMonitors"),n.prototype),(0,i.default)(n.prototype,"deleteTextMonitorByIndex",[f.action],Object.getOwnPropertyDescriptor(n.prototype,"deleteTextMonitorByIndex"),n.prototype),n);t.default=p},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(26)),h=n(r(68)),v=n(r(1412)),E=n(r(2532)),y=n(r(1422)),g=n(r(819)),b=n(r(2537)),S=n(r(1424));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var T=function(e){(0,i.default)(r,e);var a=C(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={finishBasis:!1},e.handleOk=function(){var t=(0,o.default)(u.default.mark((function t(a){var r;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r="Grafana"===e.state.type?a:e.store.toJS(),e.props.onOk(r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleBasicConfirm=function(t){var a=e.props,r=a.cluster,n=a.namespace,l=(0,m.default)(S.default,"".concat(t.spec.title,".settings"),{});(0,h.default)(t,"spec",l,{}),e.store=new y.default(O({cluster:r,namespace:n,formTemplate:t,name:(0,m.default)(t,"metadata.name"),description:(0,m.default)(t,'metadata.annotations["kubesphere.io/description"]'),isEditing:!0},t.spec)),e.setState({finishBasis:!0,type:t.spec.title,formData:t})},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.state,a=e.finishBasis,r=e.type,n=e.formData,l=this.props,u=l.cluster,o=l.namespace,c=l.formTemplate,s=l.isSubmitting,i=l.onCancel,f=l.store,d=f.module;return a?"Grafana"===r?p.default.createElement(E.default,{formTemplate:n,onCancel:i,onOk:this.handleOk}):p.default.createElement(v.default,{store:this.store,cluster:u,onOk:this.handleOk,onCancel:i,isSubmitting:s}):p.default.createElement(g.default,{visible:!0,module:d,name:"CUSTOM_MONITORING_DASHBOARD",cluster:u,namespace:o,formTemplate:c,steps:b.default,store:f,onOk:this.handleBasicConfirm,onCancel:i,okBtnText:t("NEXT")})}}]),r}(p.default.Component);a.default=T},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u,o,c,s,i=n(r(31)),f=n(r(62)),d=n(r(25)),p=n(r(28)),m=n(r(74)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=n(r(45)),g=(n(r(63)),n(r(0))),b=r(243),S=n(r(26)),_=n(r(798)),O=r(189),C=r(17),T=r(61),R=n(r(2533)),D=n(r(2534));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var P=(0,b.observer)((u=function(e){(0,h.default)(r,e);var a=I(r);function r(){var e;(0,d.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return e=a.call.apply(a,[this].concat(l)),(0,f.default)(e,"type",o,(0,m.default)(e)),e.formRef=g.default.createRef(),(0,f.default)(e,"formData",c,(0,m.default)(e)),(0,f.default)(e,"handleTypeChange",s,(0,m.default)(e)),e.handleSave=function(){var t=e.formRef.current;t&&t.validate((function(){var t=e.props,a=t.onOk,r=t.formTemplate,n=e.formData,l=(0,S.default)(r,"metadata.name"),u=(0,S.default)(r,'metadata.annotations["kubesphere.io/description"]');a(N(N({},n),{},{type:"grafana",name:l,description:u,grafanaDashboardName:l}))}))},e.renderUpload=function(){return"json"===e.type?g.default.createElement(O.Form.Item,{label:t("SUPPORT_JSON_FILE"),rules:[{required:!0,message:t("UPLOAD_FILE_TIP")}]},g.default.createElement(D.default,{name:"grafanaDashboardContent"})):null},e.renderUrl=function(){return"json"===e.type?null:g.default.createElement(O.Form.Item,{label:t("UPLOAD_GRAFANA_URL"),rules:[{required:!0,message:t("ENTER_GRAFANA_URL")},{pattern:T.PATTERN_URL,message:t("INVALID_URL_DESC")}]},g.default.createElement(O.Input,{name:"grafanaDashboardUrl",autoFocus:!0,maxLength:63}))},e}return(0,p.default)(r,[{key:"render",value:function(){var e=this.props.onCancel;return g.default.createElement(_.default,{visible:!0,width:600,onCancel:e,title:t("UPLOAD_GRAFANA_DASHBOARD"),onOk:this.handleSave},g.default.createElement("div",{className:R.default.container},g.default.createElement(O.Form,{data:this.formData,ref:this.formRef},g.default.createElement(O.RadioGroup,{mode:"button",value:this.type,onChange:this.handleTypeChange,size:"small"},g.default.createElement(O.RadioButton,{value:"json"},t("UPLOAD_FROM_LOCAL_STORAGE")),g.default.createElement(O.RadioButton,{value:"url"},t("UPLOAD_FROM_URL"))),this.renderUpload(),this.renderUrl())))}}]),r}(g.default.Component),o=(0,y.default)(u.prototype,"type",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"json"}}),c=(0,y.default)(u.prototype,"formData",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),s=(0,y.default)(u.prototype,"handleTypeChange",[C.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.type=t,e.formData={}}}}),l=u))||l;a.default=P},function(e,t,a){e.exports={container:"_1N2aKN3q6b7ysIzqzzy8I8"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(917),r(20),r(51),r(14),r(8),r(13),r(9),r(4),r(21),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(917),r(20),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(189),v=n(r(897)),E=n(r(191)),y=n(r(462)),g=n(r(5)),b=r(56),S=r(2535),_=n(r(2536));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var R=function(e){(0,f.default)(r,e);var a=T(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).setFileStatus=function(e,t){n.setState((function(a){return{files:C(C({},a.files),{},(0,c.default)({},e,C(C({},a.files[e]),t)))}}))},n.beforeUploadHandler=function(){var e=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object.keys(n.state.files).length>0)){e.next=4;break}return E.default.error(t("FILE_UPLOAD_ERROR")),e.abrupt("return",Promise.reject(t("FILE_UPLOAD_ERROR")));case 4:if("json"===a.name.slice(a.name.lastIndexOf(".")+1)){e.next=8;break}return E.default.error(t("WRONG_FILE_EXTENSION_NAME",{type:"JSON"})),e.abrupt("return",Promise.reject(t("WRONG_FILE_EXTENSION_NAME",{type:"JSON"})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.startHandler=function(e){n.setFileStatus(e.uid,{size:e.size,name:e.name,showProgress:!0,showFile:!1,percentage:0,status:"active"})},n.progressHandler=function(e,t){var a=(0,y.default)(e.percent)?Math.round(e.percent):0;n.setFileStatus(t.uid,{size:t.size,percentage:100===a?99:a,status:"active"})},n.successHandler=function(e,a){var r={name:a.name,size:a.size,showProgress:!1,showFile:!0,percentage:100,status:"active"};n.setFileStatus(a.uid,r);var l=new FileReader;l.readAsText(a,"utf8"),l.addEventListener("load",(function(){var e=l.result;n.props.onChange&&n.props.onChange(e)})),E.default.success({content:t("UPLOAD_SUCCESSFUL")})},n.errorHandler=function(e,a,r){n.setFileStatus(r.uid,{size:r.size,showProgress:!0,showFile:!1,status:"exception"}),E.default.error({content:t("UPLOAD_FAILED_MESSAGE")})},n.handleReUpload=function(){Object.keys(n.state.files).forEach((function(e){n.uploader.abort(e)})),n.setState({files:{}}),n.props.onChange(""),n.uploader.onClick()},n.renderProgress=function(e){var a=n.state.files[e];return m.default.createElement("div",{className:_.default.uploadingContent,key:e},m.default.createElement("p",{className:_.default.fileInfo},m.default.createElement("span",{className:_.default.fileName},a.name),m.default.createElement("span",{className:_.default.uploadText},t("UPLOAD_PERCENT",{percent:a.percentage})),m.default.createElement("span",{className:_.default.uploadText},t("FILE_SIZE",{size:(0,b.formatSize)(a.size)}))),m.default.createElement(h.Progress,{status:"primary",className:_.default.progress,percent:a.percentage,strokeWidth:8,key:e,showInfo:!1}))},n.renderFileItem=function(e){var a=n.state.files[e];return m.default.createElement("div",{className:_.default.uploadingContent,key:e},m.default.createElement("p",{className:_.default.fileInfo},m.default.createElement("span",{className:_.default.fileName},a.name),m.default.createElement("span",{className:_.default.uploadText},t("UPLOAD_FULLY")),m.default.createElement("span",{className:_.default.uploadText},t("FILE_SIZE",{size:(0,b.formatSize)(a.size)}))),m.default.createElement(h.Progress,{status:"primary",className:_.default.progress,percent:100,strokeWidth:8,showInfo:!1}))},n.uploaderProps={name:"grafanaDashboard",method:"post",action:n.getUploadUrl,multiple:!1,type:"json",beforeUpload:n.beforeUploadHandler,onStart:n.startHandler,onSuccess:n.successHandler,onProgress:n.progressHandler,onError:n.errorHandler},n.state={files:{}},n}return(0,i.default)(r,[{key:"render",value:function(){var e=this,a=this.state.files,r=Object.keys(a).length;return m.default.createElement("div",null,m.default.createElement("div",{className:_.default.container},m.default.createElement(v.default,(0,l.default)({},this.uploaderProps,{ref:function(t){e.uploader=t}}),m.default.createElement("div",{className:(0,g.default)(_.default.selectContainer,{})},m.default.createElement(h.Icon,{className:_.default.icon,size:40,name:"upload"}),m.default.createElement("p",{className:_.default.title},t("UPLOAD_FROM_LOCAL_TITLE")),m.default.createElement("p",{className:_.default.desc},t("SUPPORT_JSON_FILE"))))),m.default.createElement("div",{className:(0,g.default)(_.default.uploadContainer,(0,c.default)({},_.default.none,!r))},m.default.createElement("span",{className:_.default.icon},m.default.createElement(S.ReactComponent,null)),Object.keys(a).map((function(t){return a[t]?a[t].showProgress?e.renderProgress(t):a[t].showFile?e.renderFileItem(t):null:null})),m.default.createElement(h.Icon,{changeable:!0,name:"trash",onClick:this.handleReUpload,className:_.default.uploadIcon})))}},{key:"getUploadUrl",get:function(){return"/grafana/file"}}]),r}(m.default.Component);a.default=R},function(e,t,a){"use strict";a.r(t),a.d(t,"ReactComponent",(function(){return i}));var r=a(317),n=a.n(r),l=a(0),u=a.n(l),o=u.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.29 18.517h2.646v1.323c0 .73.592 1.323 1.323 1.323H19.84c.73 0 1.323-.592 1.323-1.323V7.936h-3.968c-.73 0-1.323-.592-1.323-1.323V2.645H9.259c-.73 0-1.323.593-1.323 1.323v6.613H5.291V2.645A2.645 2.645 0 017.936 0h10.26l5.612 5.612v15.55a2.645 2.645 0 01-2.645 2.646H7.936a2.645 2.645 0 01-2.645-2.645v-2.646z",fill:"#324558"}),c=u.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 10.582a1 1 0 00-1 1v5.936a1 1 0 001 1h18a1 1 0 001-1V11.58a1 1 0 00-1-1H1zm7.648 6.41c-.372.28-.874.42-1.504.42-.437 0-.836-.08-1.195-.24-.36-.16-.634-.38-.822-.659a1.686 1.686 0 01-.284-.969H6.02c0 .628.375.942 1.125.942.279 0 .496-.057.652-.17a.553.553 0 00.235-.475c0-.221-.078-.391-.235-.51-.156-.118-.437-.243-.843-.374a5.981 5.981 0 01-.965-.39c-.646-.348-.969-.818-.969-1.41 0-.307.087-.58.26-.822.173-.24.422-.429.746-.564a2.808 2.808 0 011.092-.203c.406 0 .768.073 1.086.22.317.148.564.355.74.624.176.268.264.572.264.914H8.035c0-.26-.082-.463-.246-.608-.164-.144-.395-.216-.692-.216-.286 0-.509.06-.668.181a.573.573 0 00-.238.479c0 .184.093.34.28.464.186.126.46.243.822.352.666.2 1.152.45 1.457.746.304.297.457.667.457 1.11 0 .492-.187.878-.559 1.158zm-5.088.193a2.118 2.118 0 01-.989.227c-.601 0-1.07-.153-1.406-.46-.336-.305-.504-.738-.504-1.298h1.18c0 .278.059.484.176.617.117.133.302.2.554.2a.672.672 0 00.536-.231c.132-.154.199-.373.199-.656v-3.938h1.172v3.938c0 .361-.08.681-.24.959-.16.277-.387.491-.678.642zm8.297.227c.477 0 .9-.115 1.268-.344.368-.23.652-.555.85-.977.197-.422.296-.912.296-1.472v-.254c0-.558-.1-1.05-.302-1.475a2.254 2.254 0 00-.856-.98 2.353 2.353 0 00-1.263-.342c-.474 0-.896.114-1.264.342a2.254 2.254 0 00-.856.98c-.201.426-.302.919-.302 1.479v.28c.002.548.105 1.032.308 1.452.203.42.49.744.86.97.37.227.79.34 1.261.34zm-.921-1.442c.213.32.52.48.921.48.394 0 .696-.154.907-.462.21-.309.317-.759.32-1.35v-.277c0-.597-.107-1.05-.32-1.36-.214-.31-.519-.464-.914-.464-.394 0-.697.153-.91.459-.214.306-.322.754-.325 1.345v.278c0 .58.107 1.03.32 1.351zm4.959 1.364V13.59l2.281 3.743h1.172v-5.688H18.18v3.75l-2.285-3.75h-1.172v5.688h1.172z",fill:"#B6C2CD"}),s=u.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.572 17.412c.367 0 .696-.076.988-.227.291-.151.517-.365.678-.642.16-.278.24-.598.24-.96v-3.937H3.306v3.938c0 .283-.067.502-.2.656a.671.671 0 01-.534.23c-.253 0-.438-.066-.555-.199-.117-.133-.176-.339-.176-.617H.661c0 .56.168.993.504 1.299.336.306.805.459 1.407.459zm4.572 0c.63 0 1.132-.14 1.504-.42.372-.28.559-.666.559-1.159 0-.442-.153-.812-.457-1.109-.305-.297-.79-.546-1.457-.746-.362-.11-.636-.226-.823-.351-.186-.126-.279-.28-.279-.465 0-.198.08-.358.238-.479.16-.121.382-.181.668-.181.297 0 .528.072.692.216.164.145.246.347.246.608h1.172a1.63 1.63 0 00-.264-.914 1.729 1.729 0 00-.74-.623 2.555 2.555 0 00-1.086-.221c-.404 0-.768.068-1.092.203a1.695 1.695 0 00-.746.564c-.173.241-.26.515-.26.823 0 .59.323 1.06.969 1.41.237.127.559.257.965.389.406.131.687.256.844.374.156.119.234.289.234.51a.553.553 0 01-.234.475c-.157.113-.374.17-.653.17-.75 0-1.125-.314-1.125-.942H4.843c0 .368.095.69.284.97.188.278.463.497.822.657.36.16.758.24 1.195.24zm4.713 0c.477 0 .9-.115 1.268-.344.368-.23.652-.555.85-.977.198-.422.296-.913.296-1.472v-.254c0-.558-.1-1.05-.302-1.475a2.254 2.254 0 00-.856-.98 2.353 2.353 0 00-1.263-.342c-.474 0-.896.114-1.264.342a2.254 2.254 0 00-.855.98c-.202.426-.303.919-.303 1.479v.28c.002.548.105 1.032.308 1.452.204.42.49.744.86.97.37.227.79.34 1.261.34zm0-.961c-.4 0-.708-.16-.921-.48-.214-.321-.32-.772-.32-1.352v-.278c.002-.59.11-1.04.324-1.345.213-.306.516-.46.91-.46.396 0 .7.156.914.466.213.31.32.762.32 1.359v.277c-.003.591-.11 1.041-.32 1.35-.211.308-.513.463-.906.463zm4.038.883V13.59l2.281 3.743h1.172v-5.688H18.18v3.75l-2.285-3.75h-1.172v5.688h1.172z",fill:"#324558"}),i=function(e){return u.a.createElement("svg",n()({viewBox:"0 0 24 24",fill:"none",width:"1em",height:"1em"},e),o,c,s)};t.default="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01LjI5MDY1IDE4LjUxNzRINy45MzU5OVYxOS44NDAxQzcuOTM1OTkgMjAuNTcwNiA4LjUyODE3IDIxLjE2MjcgOS4yNTg2NiAyMS4xNjI3SDE5Ljg0QzIwLjU3MDUgMjEuMTYyNyAyMS4xNjI3IDIwLjU3MDYgMjEuMTYyNyAxOS44NDAxVjcuOTM2MDNIMTcuMTk0N0MxNi40NjQyIDcuOTM2MDMgMTUuODcyIDcuMzQzODUgMTUuODcyIDYuNjEzMzVWMi42NDUzNEg5LjI1ODY2QzguNTI4MTcgMi42NDUzNCA3LjkzNTk5IDMuMjM3NTIgNy45MzU5OSAzLjk2ODAxVjEwLjU4MTRINS4yOTA2NVYyLjY0NTM0QzUuMjkwNjUgMS4xODQzNiA2LjQ3NTAxIDAgNy45MzU5OSAwSDE4LjE5NjRMMjMuODA4IDUuNjExNjJWMjEuMTYyN0MyMy44MDggMjIuNjIzNyAyMi42MjM3IDIzLjgwODEgMjEuMTYyNyAyMy44MDgxSDcuOTM1OTlDNi40NzUwMSAyMy44MDgxIDUuMjkwNjUgMjIuNjIzNyA1LjI5MDY1IDIxLjE2MjdWMTguNTE3NFoiIGZpbGw9IiMzMjQ1NTgiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xIDEwLjU4MTVDMC40NDc3MTUgMTAuNTgxNSAwIDExLjAyOTMgMCAxMS41ODE1VjE3LjUxNzZDMCAxOC4wNjk5IDAuNDQ3NzE1IDE4LjUxNzYgMSAxOC41MTc2SDE5QzE5LjU1MjMgMTguNTE3NiAyMCAxOC4wNjk4IDIwIDE3LjUxNzZWMTEuNTgxNUMyMCAxMS4wMjkzIDE5LjU1MjMgMTAuNTgxNSAxOSAxMC41ODE1SDFaTTguNjQ4MDUgMTYuOTkxN0M4LjI3NTY2IDE3LjI3MTcgNy43NzQzNiAxNy40MTE2IDcuMTQ0MTUgMTcuNDExNkM2LjcwNjY1IDE3LjQxMTYgNi4zMDgyMSAxNy4zMzE1IDUuOTQ4ODMgMTcuMTcxNEM1LjU4OTQ2IDE3LjAxMTIgNS4zMTUzNyAxNi43OTE4IDUuMTI2NTcgMTYuNTEzMkM0LjkzNzc3IDE2LjIzNDUgNC44NDMzNyAxNS45MTE2IDQuODQzMzcgMTUuNTQ0NEg2LjAxOTE1QzYuMDE5MTUgMTYuMTcyIDYuMzk0MTUgMTYuNDg1OCA3LjE0NDE1IDE2LjQ4NThDNy40MjI3OSAxNi40ODU4IDcuNjQwMjQgMTYuNDI5MiA3Ljc5NjQ5IDE2LjMxNTlDNy45NTI3NCAxNi4yMDI2IDguMDMwODcgMTYuMDQ0NCA4LjAzMDg3IDE1Ljg0MTNDOC4wMzA4NyAxNS42MiA3Ljk1Mjc0IDE1LjQ1IDcuNzk2NDkgMTUuMzMxNUM3LjY0MDI0IDE1LjIxMzEgNy4zNTg5OSAxNS4wODgxIDYuOTUyNzQgMTQuOTU2NUM2LjU0NjQ5IDE0LjgyNSA2LjIyNDg4IDE0LjY5NTUgNS45ODc5IDE0LjU2NzlDNS4zNDIwNiAxNC4yMTg5IDUuMDE5MTUgMTMuNzQ4OSA1LjAxOTE1IDEzLjE1NzdDNS4wMTkxNSAxMi44NTA0IDUuMTA1NzQgMTIuNTc2MyA1LjI3ODkxIDEyLjMzNTVDNS40NTIwOSAxMi4wOTQ2IDUuNzAwNzkgMTEuOTA2NCA2LjAyNTAxIDExLjc3MUM2LjM0OTIzIDExLjYzNTYgNi43MTMxNiAxMS41Njc5IDcuMTE2OCAxMS41Njc5QzcuNTIzMDUgMTEuNTY3OSA3Ljg4NTAzIDExLjY0MTQgOC4yMDI3NCAxMS43ODg2QzguNTIwNDUgMTEuOTM1NyA4Ljc2NzE5IDEyLjE0MzQgOC45NDI5NyAxMi40MTE2QzkuMTE4NzYgMTIuNjc5OSA5LjIwNjY1IDEyLjk4NDUgOS4yMDY2NSAxMy4zMjU3SDguMDM0NzdDOC4wMzQ3NyAxMy4wNjUzIDcuOTUyNzQgMTIuODYyOCA3Ljc4ODY4IDEyLjcxODNDNy42MjQ2MiAxMi41NzM3IDcuMzk0MTUgMTIuNTAxNSA3LjA5NzI3IDEyLjUwMTVDNi44MTA4MSAxMi41MDE1IDYuNTg4MTYgMTIuNTYyIDYuNDI5MyAxMi42ODMxQzYuMjcwNDUgMTIuODA0MiA2LjE5MTAyIDEyLjk2MzcgNi4xOTEwMiAxMy4xNjE2QzYuMTkxMDIgMTMuMzQ2NSA2LjI4NDEyIDEzLjUwMTUgNi40NzAzMiAxMy42MjY1QzYuNjU2NTIgMTMuNzUxNSA2LjkzMDYxIDEzLjg2ODcgNy4yOTI1OCAxMy45NzhDNy45NTkyNSAxNC4xNzg2IDguNDQ0OTMgMTQuNDI3MyA4Ljc0OTYyIDE0LjcyNDFDOS4wNTQzIDE1LjAyMSA5LjIwNjY1IDE1LjM5MDggOS4yMDY2NSAxNS44MzM1QzkuMjA2NjUgMTYuMzI1NyA5LjAyMDQ1IDE2LjcxMTggOC42NDgwNSAxNi45OTE3Wk0zLjU1OTc3IDE3LjE4NTFDMy4yNjgxMSAxNy4zMzYxIDIuOTM4NjggMTcuNDExNiAyLjU3MTQ5IDE3LjQxMTZDMS45Njk5MyAxNy40MTE2IDEuNTAxMTggMTcuMjU4NiAxLjE2NTI0IDE2Ljk1MjZDMC44MjkzMDQgMTYuNjQ2NyAwLjY2MTMzNSAxNi4yMTM3IDAuNjYxMzM1IDE1LjY1MzhIMS44NDEwMkMxLjg0MTAyIDE1LjkzMjUgMS44OTk2MiAxNi4xMzgyIDIuMDE2OCAxNi4yNzFDMi4xMzM5OSAxNi40MDM4IDIuMzE4ODkgMTYuNDcwMiAyLjU3MTQ5IDE2LjQ3MDJDMi43OTU0NSAxNi40NzAyIDIuOTczODQgMTYuMzkzNCAzLjEwNjY1IDE2LjIzOThDMy4yMzk0NiAxNi4wODYxIDMuMzA1ODcgMTUuODY3NCAzLjMwNTg3IDE1LjU4MzVWMTEuNjQ2SDQuNDc3NzRWMTUuNTgzNUM0LjQ3Nzc0IDE1Ljk0NTUgNC4zOTc2NiAxNi4yNjUxIDQuMjM3NTEgMTYuNTQyNUM0LjA3NzM1IDE2LjgxOTggMy44NTE0NCAxNy4wMzQgMy41NTk3NyAxNy4xODUxWk0xMS44NTc0IDE3LjQxMTZDMTIuMzM0IDE3LjQxMTYgMTIuNzU2NSAxNy4yOTcgMTMuMTI1IDE3LjA2NzlDMTMuNDkzNSAxNi44Mzg3IDEzLjc3NjcgMTYuNTEzMiAxMy45NzQ2IDE2LjA5MTNDMTQuMTcyNSAxNS42Njk0IDE0LjI3MTUgMTUuMTc4NiAxNC4yNzE1IDE0LjYxODdWMTQuMzY0OEMxNC4yNzE1IDEzLjgwNzUgMTQuMTcwNiAxMy4zMTU5IDEzLjk2ODggMTIuODkwMUMxMy43NjY5IDEyLjQ2NDQgMTMuNDgxOCAxMi4xMzc1IDEzLjExMzMgMTEuOTA5N0MxMi43NDQ4IDExLjY4MTggMTIuMzIzNiAxMS41Njc5IDExLjg0OTYgMTEuNTY3OUMxMS4zNzU3IDExLjU2NzkgMTAuOTU0NCAxMS42ODE4IDEwLjU4NTkgMTEuOTA5N0MxMC4yMTc1IDEyLjEzNzUgOS45MzIzIDEyLjQ2NDQgOS43MzA0OCAxMi44OTAxQzkuNTI4NjUgMTMuMzE1OSA5LjQyNzc0IDEzLjgwODggOS40Mjc3NCAxNC4zNjg3VjE0LjY0OTlDOS40MzAzNSAxNS4xOTY4IDkuNTMzMjEgMTUuNjgwNSA5LjczNjM0IDE2LjEwMTFDOS45Mzk0NiAxNi41MjE3IDEwLjIyNTkgMTYuODQ1MiAxMC41OTU3IDE3LjA3MThDMTAuOTY1NSAxNy4yOTgzIDExLjM4NjEgMTcuNDExNiAxMS44NTc0IDE3LjQxMTZaTTEwLjkzNTYgMTUuOTcwMkMxMS4xNDkxIDE2LjI5MDUgMTEuNDU2NCAxNi40NTA3IDExLjg1NzQgMTYuNDUwN0MxMi4yNTA3IDE2LjQ1MDcgMTIuNTUyNyAxNi4yOTY0IDEyLjc2MzcgMTUuOTg3OEMxMi45NzQ2IDE1LjY3OTIgMTMuMDgxNCAxNS4yMjkzIDEzLjA4NCAxNC42MzgyVjE0LjM2MDhDMTMuMDg0IDEzLjc2NDUgMTIuOTc3MiAxMy4zMTE0IDEyLjc2MzcgMTMuMDAxNUMxMi41NTAxIDEyLjY5MTYgMTIuMjQ1NCAxMi41MzY2IDExLjg0OTYgMTIuNTM2NkMxMS40NTY0IDEyLjUzNjYgMTEuMTUzIDEyLjY4OTYgMTAuOTM5NSAxMi45OTU2QzEwLjcyNTkgMTMuMzAxNiAxMC42MTc4IDEzLjc1MDIgMTAuNjE1MiAxNC4zNDEzVjE0LjYxODdDMTAuNjE1MiAxNS4xOTk0IDEwLjcyMiAxNS42NDk5IDEwLjkzNTYgMTUuOTcwMlpNMTUuODk0OSAxNy4zMzM1VjEzLjU5MTNMMTguMTc2MiAxNy4zMzM1SDE5LjM0ODFWMTEuNjQ2SDE4LjE4MDFWMTUuMzk2TDE1Ljg5NDkgMTEuNjQ2SDE0LjcyMzFWMTcuMzMzNUgxNS44OTQ5WiIgZmlsbD0iI0I2QzJDRCIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIuNTcxNTMgMTcuNDExNkMyLjkzODcyIDE3LjQxMTYgMy4yNjgxNSAxNy4zMzYxIDMuNTU5ODEgMTcuMTg1MUMzLjg1MTQ4IDE3LjAzNCA0LjA3NzM5IDE2LjgxOTggNC4yMzc1NSAxNi41NDI1QzQuMzk3NyAxNi4yNjUxIDQuNDc3NzggMTUuOTQ1NSA0LjQ3Nzc4IDE1LjU4MzVWMTEuNjQ2SDMuMzA1OTFWMTUuNTgzNUMzLjMwNTkxIDE1Ljg2NzQgMy4yMzk1IDE2LjA4NjEgMy4xMDY2OSAxNi4yMzk3QzIuOTczODggMTYuMzkzNCAyLjc5NTQ5IDE2LjQ3MDIgMi41NzE1MyAxNi40NzAyQzIuMzE4OTMgMTYuNDcwMiAyLjEzNDAzIDE2LjQwMzggMi4wMTY4NSAxNi4yNzFDMS44OTk2NiAxNi4xMzgyIDEuODQxMDYgMTUuOTMyNSAxLjg0MTA2IDE1LjY1MzhIMC42NjEzNzdDMC42NjEzNzcgMTYuMjEzNyAwLjgyOTM0NiAxNi42NDY2IDEuMTY1MjggMTYuOTUyNkMxLjUwMTIyIDE3LjI1ODYgMS45Njk5NyAxNy40MTE2IDIuNTcxNTMgMTcuNDExNlpNNy4xNDQxOSAxNy40MTE2QzcuNzc0NCAxNy40MTE2IDguMjc1NyAxNy4yNzE2IDguNjQ4MDkgMTYuOTkxN0M5LjAyMDQ5IDE2LjcxMTggOS4yMDY2OSAxNi4zMjU3IDkuMjA2NjkgMTUuODMzNUM5LjIwNjY5IDE1LjM5MDggOS4wNTQzNCAxNS4wMjEgOC43NDk2NiAxNC43MjQxQzguNDQ0OTcgMTQuNDI3MiA3Ljk1OTI5IDE0LjE3ODUgNy4yOTI2MyAxMy45NzhDNi45MzA2NSAxMy44Njg3IDYuNjU2NTYgMTMuNzUxNSA2LjQ3MDM2IDEzLjYyNjVDNi4yODQxNiAxMy41MDE1IDYuMTkxMDYgMTMuMzQ2NSA2LjE5MTA2IDEzLjE2MTZDNi4xOTEwNiAxMi45NjM3IDYuMjcwNDkgMTIuODA0MiA2LjQyOTM1IDEyLjY4MzFDNi41ODgyIDEyLjU2MiA2LjgxMDg2IDEyLjUwMTUgNy4wOTczMSAxMi41MDE1QzcuMzk0MTkgMTIuNTAxNSA3LjYyNDY2IDEyLjU3MzcgNy43ODg3MiAxMi43MTgzQzcuOTUyNzggMTIuODYyOCA4LjAzNDgxIDEzLjA2NTMgOC4wMzQ4MSAxMy4zMjU3SDkuMjA2NjlDOS4yMDY2OSAxMi45ODQ1IDkuMTE4OCAxMi42Nzk5IDguOTQzMDIgMTIuNDExNkM4Ljc2NzI0IDEyLjE0MzQgOC41MjA0OSAxMS45MzU3IDguMjAyNzggMTEuNzg4NkM3Ljg4NTA3IDExLjY0MTQgNy41MjMxIDExLjU2NzkgNy4xMTY4NSAxMS41Njc5QzYuNzEzMiAxMS41Njc5IDYuMzQ5MjcgMTEuNjM1NiA2LjAyNTA1IDExLjc3MUM1LjcwMDgzIDExLjkwNjQgNS40NTIxMyAxMi4wOTQ2IDUuMjc4OTUgMTIuMzM1NEM1LjEwNTc4IDEyLjU3NjMgNS4wMTkxOSAxMi44NTA0IDUuMDE5MTkgMTMuMTU3N0M1LjAxOTE5IDEzLjc0ODkgNS4zNDIxMSAxNC4yMTg5IDUuOTg3OTQgMTQuNTY3OUM2LjIyNDkyIDE0LjY5NTUgNi41NDY1MyAxNC44MjUgNi45NTI3OCAxNC45NTY1QzcuMzU5MDMgMTUuMDg4MSA3LjY0MDI4IDE1LjIxMzEgNy43OTY1MyAxNS4zMzE1QzcuOTUyNzggMTUuNDUgOC4wMzA5MSAxNS42MiA4LjAzMDkxIDE1Ljg0MTNDOC4wMzA5MSAxNi4wNDQ0IDcuOTUyNzggMTYuMjAyNiA3Ljc5NjUzIDE2LjMxNTlDNy42NDAyOCAxNi40MjkyIDcuNDIyODMgMTYuNDg1OCA3LjE0NDE5IDE2LjQ4NThDNi4zOTQxOSAxNi40ODU4IDYuMDE5MTkgMTYuMTcyIDYuMDE5MTkgMTUuNTQ0NEg0Ljg0MzQxQzQuODQzNDEgMTUuOTExNiA0LjkzNzgxIDE2LjIzNDUgNS4xMjY2MSAxNi41MTMyQzUuMzE1NDEgMTYuNzkxOCA1LjU4OTUgMTcuMDExMiA1Ljk0ODg4IDE3LjE3MTRDNi4zMDgyNSAxNy4zMzE1IDYuNzA2NjkgMTcuNDExNiA3LjE0NDE5IDE3LjQxMTZaTTExLjg1NzUgMTcuNDExNkMxMi4zMzQgMTcuNDExNiAxMi43NTY2IDE3LjI5NyAxMy4xMjUgMTcuMDY3OUMxMy40OTM1IDE2LjgzODcgMTMuNzc2NyAxNi41MTMyIDEzLjk3NDcgMTYuMDkxM0MxNC4xNzI2IDE1LjY2OTQgMTQuMjcxNSAxNS4xNzg1IDE0LjI3MTUgMTQuNjE4N1YxNC4zNjQ3QzE0LjI3MTUgMTMuODA3NSAxNC4xNzA2IDEzLjMxNTkgMTMuOTY4OCAxMi44OTAxQzEzLjc2NyAxMi40NjQ0IDEzLjQ4MTggMTIuMTM3NSAxMy4xMTMzIDExLjkwOTdDMTIuNzQ0OCAxMS42ODE4IDEyLjMyMzYgMTEuNTY3OSAxMS44NDk3IDExLjU2NzlDMTEuMzc1NyAxMS41Njc5IDEwLjk1NDUgMTEuNjgxOCAxMC41ODYgMTEuOTA5N0MxMC4yMTc1IDEyLjEzNzUgOS45MzIzNCAxMi40NjQ0IDkuNzMwNTIgMTIuODkwMUM5LjUyODY5IDEzLjMxNTkgOS40Mjc3OCAxMy44MDg4IDkuNDI3NzggMTQuMzY4N1YxNC42NDk5QzkuNDMwMzkgMTUuMTk2OCA5LjUzMzI1IDE1LjY4MDUgOS43MzYzOCAxNi4xMDExQzkuOTM5NSAxNi41MjE2IDEwLjIyNiAxNi44NDUyIDEwLjU5NTggMTcuMDcxOEMxMC45NjU1IDE3LjI5ODMgMTEuMzg2MSAxNy40MTE2IDExLjg1NzUgMTcuNDExNlpNMTEuODU3NSAxNi40NTA3QzExLjQ1NjQgMTYuNDUwNyAxMS4xNDkxIDE2LjI5MDUgMTAuOTM1NiAxNS45NzAyQzEwLjcyMjEgMTUuNjQ5OSAxMC42MTUzIDE1LjE5OTQgMTAuNjE1MyAxNC42MTg3VjE0LjM0MTNDMTAuNjE3OSAxMy43NTAyIDEwLjcyNiAxMy4zMDE2IDEwLjkzOTUgMTIuOTk1NkMxMS4xNTMgMTIuNjg5NiAxMS40NTY0IDEyLjUzNjYgMTEuODQ5NyAxMi41MzY2QzEyLjI0NTUgMTIuNTM2NiAxMi41NTAyIDEyLjY5MTYgMTIuNzYzNyAxMy4wMDE1QzEyLjk3NzMgMTMuMzExNCAxMy4wODQgMTMuNzY0NSAxMy4wODQgMTQuMzYwOFYxNC42MzgyQzEzLjA4MTQgMTUuMjI5MyAxMi45NzQ3IDE1LjY3OTIgMTIuNzYzNyAxNS45ODc4QzEyLjU1MjggMTYuMjk2NCAxMi4yNTA3IDE2LjQ1MDcgMTEuODU3NSAxNi40NTA3Wk0xNS44OTUgMTcuMzMzNVYxMy41OTEzTDE4LjE3NjIgMTcuMzMzNUgxOS4zNDgxVjExLjY0NkgxOC4xODAxVjE1LjM5NkwxNS44OTUgMTEuNjQ2SDE0LjcyMzFWMTcuMzMzNUgxNS44OTVaIiBmaWxsPSIjMzI0NTU4Ii8+Cjwvc3ZnPgo="},function(e,t,a){e.exports={container:"v7G9tmJJiZiPTjYulk-uk",selectContainer:"_2JbUzk0qVPxow2dv37yVtn",icon:"_3dvVq4Wja1r855of5vz4Vz",title:"_2iY4A3tvAD8fqWCX7YbXzW",desc:"_2Qz6RDrQb0PqcjJChLpZ51",uploadContainer:"_2FoLzMRXXZB1NAvaVl4r1y",uploadingContent:"M6eVRzcbprHTXlq43-qL",fileInfo:"_93kbv_HMX_E4Nb61U_YCJ",fileName:"_3Z0oHIHL6-rqZ80URIlaWt",uploadText:"_2ToMbKmVtBJZXrzMUJsa0A",progress:"_2kNei8kEcBntfnpeptiCS",uploadIcon:"_1QevqqsDTqOPEx8RnmcIon",none:"_3Th3hjQg4wakFUvbxe0l0F"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=[{title:"BASIC_INFORMATION",icon:"dashboard",component:r(a(2538)).default,required:!0}];t.default=n},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(20),r(14),r(99),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(20),r(29),r(14),r(99),r(9),r(4),r(18),r(43),r(11);var l,u=n(r(97)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=r(243),m=n(r(26)),h=n(r(68)),v=n(r(67)),E=n(r(119)),y=r(189),g=n(r(1423)),b=r(61),S=n(r(1424)),_=n(r(2540));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var C=(0,p.observer)(l=function(e){(0,s.default)(r,e);var a=O(r);function r(e){var n;if((0,o.default)(this,r),(n=a.call(this,e)).templateSettingsOpts=Object.entries(n.templateSettings).map((function(e){var a=(0,u.default)(e,2),r=a[0],n=a[1];return{value:r,image:n.logo,label:"Custom"===n.name?t("CUSTOM"):n.name,description:n.description}})),n.nameValidator=function(e,a,r){if(!a)return r();n.props.store.checkName({name:a,namespace:n.props.namespace,cluster:n.props.cluster}).then((function(a){if(a.exist)return r({message:t("NAME_EXIST_DESC"),field:e.field});r()}))},n.handleTemplateChange=function(e){(0,h.default)(n.formTemplate,"spec",(0,m.default)(n.templateSettings,"".concat(e,".settings"),{})),n.forceUpdate()},(0,v.default)(n.formTemplate.spec)){var l=Object.keys(n.templateSettings)[0],c=(0,E.default)(n.templateSettings[l].settings);(0,h.default)(n.formTemplate,"spec",c)}return n}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props.formRef;return d.default.createElement(y.Form,{data:this.formTemplate,ref:e},d.default.createElement(y.Columns,null,d.default.createElement(y.Column,null,d.default.createElement(y.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:b.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.nameValidator}]},d.default.createElement(y.Input,{name:"metadata.name",autoFocus:!0,maxLength:63}))),d.default.createElement(y.Column,null,d.default.createElement(y.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},d.default.createElement(y.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))),d.default.createElement(y.Form.Item,{label:d.default.createElement("div",{className:_.default.templateLabel},d.default.createElement("h3",null,t("TEMPLATE")),d.default.createElement("p",null,t("CUSTOM_MONITORING_TEMPLATE_DESC")))},d.default.createElement(g.default,{name:"spec.title",className:_.default.templateList,options:this.templateSettingsOpts,onChange:this.handleTemplateChange})))}},{key:"templateSettings",get:function(){return(0,E.default)(S.default)}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,m.default)(t,b.MODULE_KIND_MAP[a],t)}}]),r}(d.default.Component))||l;a.default=C},function(e,t,a){e.exports={container:"_9NWeMBAss3j4dAfPXgl7q",selected:"_23vK4ncmS9GHYl5k5YaN4J"}},function(e,t,a){e.exports={templateList:"KSUx0GMOtSywAxVTF3PGQ",templateLabel:"F1e1CyJJ9gzhTQLwN8RyP"}},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(213),r(10),r(6),r(202),r(36),r(51),r(14),r(8),r(13),r(9),r(4),r(11),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(213),r(250),r(32),r(10),r(6),r(202),r(121),r(36),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(30),r(195),r(11),r(46),r(7),r(40);var l=n(r(31)),u=n(r(50)),o=n(r(191)),c=n(r(798)),s=n(r(819)),i=n(r(2542)),f=n(r(2575)),d=n(r(26)),p=n(r(68)),m=n(r(438));function h(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return u=e.done,e},e:function(e){o=!0,l=e},f:function(){try{u||null==a.return||a.return()}finally{if(o)throw l}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={"customScaling.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.module,i=(e.isFederated,e.success),d=(0,u.default)(e,["store","cluster","namespace","module","isFederated","success"]),p=m.default[l]({namespace:n}),h=c.default.open(y({onOk:function(e){if(!e)return!1;a.create(S(e),{cluster:r,namespace:n}).then((function(){c.default.close(h),o.default.success({content:t("CREATE_SUCCESSFUL")}),i&&i()}))},module:l,cluster:r,namespace:n,formTemplate:p,steps:f.default,modal:s.default,store:a},d))}},"customScaling.edit.setting":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.module,s=e.detail,f=(e.isFederated,e.success),d=(0,u.default)(e,["store","cluster","namespace","module","detail","isFederated","success"]),p=c.default.open(y({onOk:function(e){if(!e)return!1;a.update(s,S(e)).then((function(){c.default.close(p),o.default.success({content:t("UPDATE_SUCCESSFUL")}),f&&f()}))},module:l,cluster:r,namespace:n,detail:s,modal:i.default,store:a},d))}}};a.default=g;var b=["spec.minReplicaCount","spec.maxReplicaCount","spec.pollingInterval","spec.cooldownPeriod"],S=function(e){var t,a=h(b);try{for(a.s();!(t=a.n()).done;){var r=t.value;""===(0,d.default)(e,r)&&(0,p.default)(e,r,void 0)}}catch(e){a.e(e)}finally{a.f()}return e}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(50)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(798)),v=n(r(840)),E=n(r(1425)),y=n(r(831)),g=n(r(67)),b=r(17),S=r(243),_=n(r(1)),O=n(r(0)),C=n(r(2574));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var R=(0,S.observer)((o=u=function(e){(0,d.default)(r,e);var a=T(r);function r(e){var t;return(0,i.default)(this,r),(t=a.call(this,e)).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleOk=function(){t.formRef&&t.formRef,t.formRef.current&&t.formRef.current.validate((function(){var e=t.formRef.current.getData();t.props.onOk(e)}))},t.handleSubFormSave=function(){var e=t.state.subRoute;e&&e.onSave&&e.onSave((function(){t.setState({subRoute:{}})}))},t.handleSubFormCancel=function(){var e=t.state.subRoute;e&&e.onCancel&&(e.onCancel(),t.setState({subRoute:{}}))},t.state={formData:(0,y.default)((0,b.toJS)(e.detail._originData||e.detail)),subRoute:{}},t.formRef=O.default.createRef(),t}return(0,f.default)(r,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}},{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,y.default)((0,b.toJS)(this.props.detail._originData||this.props.detail))})}},{key:"renderSaveBar",value:function(){var e=this.state.subRoute;return(0,g.default)(e)?null:O.default.createElement(v.default,{className:C.default.confirm,onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=(0,s.default)(e,["visible","onCancel","isSubmitting"]);return O.default.createElement(h.default,{title:t("EDIT_CUSTOM_SCALING"),icon:"pen",visible:a,width:960,onOk:this.handleOk,onCancel:r,isSubmitting:n},O.default.createElement(E.default,(0,c.default)({},l,{formTemplate:this.state.formData,formRef:this.formRef})),this.renderSaveBar())}}]),r}(O.default.Component),u.propTypes={detail:_.default.object,onOk:_.default.func,onCancel:_.default.func,isSubmitting:_.default.bool},u.defaultProps={detail:{},isSubmitting:!1,onOk:function(){},onCancel:function(){}},u.childContextTypes={registerSubRoute:_.default.func,resetSubRoute:_.default.func},l=o))||l;a.default=R},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(70),r(20),r(14),r(9),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(317));r(3),r(10),r(70),r(20),r(14),r(9),r(4),r(73);var u=n(r(64)),o=n(r(0)),c=r(189),s=r(61),i=n(r(2544)),f=function(e){var a=e.name,r=e.value;return o.default.createElement("div",{className:i.default.accessMode},o.default.createElement("p",{className:"name"},"".concat(a,"(").concat(r,")")),o.default.createElement("p",{className:"desc"},t("ACCESS_MODE_".concat(r))))},d=function(e){if(e.loading)return null;var t=Object.keys(s.ACCESS_MODES).map((function(e){return{label:o.default.createElement(f,{name:e,value:s.ACCESS_MODES[e]}),value:e}}));return(0,u.default)(e.supportedAccessModes)&&(t=t.filter((function(t){return e.supportedAccessModes.includes(t.value)}))),o.default.createElement("div",{className:i.default.accessModeWrapper},o.default.createElement(c.RadioGroup,(0,l.default)({options:t},e)))};a.default=d},function(e,t,a){e.exports={accessModeWrapper:"t3ac6iAwz0VNleKctOM3q",accessMode:"_2ntH9Ni8zzlXvi9v2KCUYd"}},,,function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(5)),p=r(189),m=n(r(191)),h=n(r(897)),v=n(r(2548));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(e){var n;return(0,l.default)(this,r),(n=a.call(this,e)).uploaderProps={name:"file",action:"/images/upload",accept:"image/*",beforeUpload:function(e){return!(e.size>2097152)||(m.default.error(t("FILE_OVERSIZED_TIP")),!1)},onSuccess:function(t){t&&e.onChange(t.path)}},n}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.value,r=e.placeholder,n=e.defaultLogo;return i.default.createElement(p.Columns,{className:(0,d.default)("is-variable is-2",t)},i.default.createElement(p.Column,{className:"is-narrow"},i.default.createElement("img",{className:(0,d.default)(v.default.image,"upload-preview"),src:a||n})),i.default.createElement(p.Column,null,i.default.createElement(h.default,this.uploaderProps,i.default.createElement("div",{className:v.default.upload},i.default.createElement(p.Icon,{size:32,name:"upload"}),i.default.createElement("p",null,r)))))}}]),r}(i.default.Component);a.default=y,y.propTypes={className:f.default.string,defaultLogo:f.default.string,placeholder:f.default.string,value:f.default.string,onChange:f.default.func},y.defaultProps={className:"",value:"",onChange:function(){}}},function(e,t,a){e.exports={image:"_167OKUS_EKBqwDQxcIx-4e",upload:"_2t1CYrv42g1fxOKAN8Cxrv"}},function(e,t,a){e.exports={wrapper:"_4ZwD-XBeeb89uHJUpnc9X",trigger:"_39IOrUHzeoispGPqyhIGmq",content:"_1ddoFZzzUSM-yo3jVhK8Dv",rules:"_3J0m5Rox1YBbKgpQhXuhAt",barWrapper:"_3cTk_xH00ce2_lz197ulvB",bar:"pMEaabr1XWMm3r_fW2afr",tip:"yLbagG9qc0xvXpKUX3Ltx",icon:"_1CXCvE_9U9AkVY2j9zINU2",selected:"_2_Gwnizz4eeI_iF5yIUwav"}},,function(e,t,a){},function(e,t,a){e.exports={container:"_2VDZ-7eQWd8zMV87f6SbU-",select:"_1njJEaKU6jyyl9YDFHgWWW"}},function(e,t,a){e.exports={option:"_1Iz4ohvzuXgnhL83dbwRxn"}},function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(3),a(10),a(6),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(6),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var l=n(a(31)),u=n(a(50)),o=n(a(25)),c=n(a(28)),s=n(a(41)),i=n(a(42)),f=n(a(37)),d=r(a(0)),p=n(a(163)),m=n(a(465));function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var y=function(e){(0,s.default)(a,e);var t=E(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).handleChange=function(t){var a=e.props,r=a.unit;(0,a.onChange)((0,p.default)(t)?t:"".concat(t).concat(r))},e}return(0,c.default)(a,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.unit,r=e.children,n=(0,u.default)(e,["value","unit","children"]),l=t;return a&&(l=(0,m.default)(t,a)),d.default.cloneElement(r,v(v(v({},n),r.props),{},{value:l,onChange:this.handleChange}))}}]),a}(d.Component);t.default=y},function(e,t,a){e.exports={inputWrapper:"_9tSBTbiePy2HKcTrVKv1d",selectWrapper:"_2WoPj84oQch2LesDZL9hoL",selectInput:"_1Vpn9fp-v5Ks0tMIo4e--V",select:"_2Xe7OxIhr1KlHOE-l0UteR",title:"_1jsBAQLryz5UYT5ExZqDCp"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),r(817),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(30),r(195),r(11),r(817);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=l(r(1)),p=l(r(458)),m=l(r(2557)),h=l(r(191)),v=r(61),E=l(r(1429));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=function(e){(0,c.default)(r,e);var a=y(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).state={value:""},e.focus=function(){e.inputBox.focus()},e.handleChange=function(t){var a=t.target.value,r=e.props.onChange;e.setState({value:a}),r(t,a)},e.handlePressEnter=function(a){a.stopPropagation();var r=e.props,n=r.onAdd,l=r.onDelete,u=e.state.value;if("Enter"===a.key){if(""!==u.trim()){if(!v.PATTERN_TAG.test(u)||u.length>63)return void h.default.error({content:t("PATTERN_TAG_VALUE_INVALID_TIP")});e.setState({value:""},(function(){n(u)}))}}else"Backspace"===a.key&&l()},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this,t=this.state.value,a=this.props,r=a.style,n=a.placeholder;return f.default.createElement("div",{style:r,className:E.default.autosuggest,ref:function(t){e.autosuggest=t}},f.default.createElement(m.default,{className:E.default.autosuggestInput,type:"text",onKeyDown:this.handlePressEnter,onChange:this.handleChange,placeholder:n,ref:function(t){e.inputBox=t},value:t}))}}]),r}(f.Component);g.propTypes={onChange:d.default.func,onDelete:d.default.func,prefixCls:d.default.string,className:d.default.string,style:d.default.string,placeholder:d.default.string},g.defaultProps={prefixCls:"autosuggest",onAdd:p.default,onDelete:p.default,onChange:p.default};var b=g;a.default=b},,function(e,t,a){e.exports={extraBox:"_1XMQaAa8OBSWxpBisNQs07",IconBox:"_2IfBBHb39w_3FGYztJhAaA","input-padding-right-30":"_1Qlf_8Cc_90DXEXYz5Vg_y"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"UnitInput",{enumerable:!0,get:function(){return u.default}}),t.TimeUnitInput=void 0;var n=a(56),l=a(466),u=r(a(2560)),o=(0,n.withProps)(u.default,{units:l.timeUnit});t.TimeUnitInput=o},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(44),r(6),r(70),r(20),r(24),r(8),r(13),r(9),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(44),r(6),r(70),r(20),r(27),r(24),r(33),r(16),r(8),r(13),r(9),r(4),r(73),r(7);var u=l(r(317)),o=l(r(97)),c=l(r(31)),s=l(r(50)),i=r(189),f=l(r(805)),d=l(r(1)),p=n(r(0)),m=r(56),h=l(r(2561));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=function(e){return null==e||""===e},g=function(e){var a,r=e.defaultValue,n=e.units,l=e.onChange,c=void 0===l?function(){}:l,d=e.picks,v=(0,s.default)(e,["defaultValue","units","onChange","picks"]),g=e.value,b=void 0===g?r:g,S=p.useMemo((function(){var e=null!=n?n:[];return d&&(e=n.filter((function(e){return d.includes(e.key)}))),e.map((function(e){return E(E({},e),{},{label:t(e.label)})}))}),[n,d]),_=p.useState((0,m.getUnitValue)(b,S)),O=(0,o.default)(_,2),C=O[0],T=O[1],R=p.useState(y(b)?b:b/(null!==(a=null==C?void 0:C.value)&&void 0!==a?a:1)),D=(0,o.default)(R,2),k=D[0],N=D[1];p.useEffect((function(){var e;if(b!==k){var t=null!=C?C:(0,m.getUnitValue)(b,S);T(t),N(y(b)?b:b/(null!==(e=null==t?void 0:t.value)&&void 0!==e?e:1))}}),[b]);return p.createElement("div",{className:h.default.wrapper},p.createElement(f.default,(0,u.default)({integer:!0},v,{value:k,onChange:function(e){isNaN(Number(e))||(N(e),C&&c(e*(null==C?void 0:C.value)))}})),p.createElement(i.Select,{options:S,defaultValue:null==C?void 0:C.value,value:null==C?void 0:C.value,onChange:function(e){var t,a=S.find((function(t){return t.value===e}));(T(a),y(k))||c(k*(null!==(t=null==a?void 0:a.value)&&void 0!==t?t:1))}}))};g.propTypes={value:d.default.number,defaultValue:d.default.number,onChange:d.default.func,units:d.default.array,picks:d.default.array};var b=g;a.default=b},function(e,t,a){e.exports={wrapper:"_2GpR3mYI5T7vK8sSGzjc_7"}},function(e,t,a){e.exports={checkableText:"_1378_TRL04zqUXeEdYsZn6",triggerWrapper:"_3xQnYdf3Q4wcKIOP9stZam",title:"_3BU5g_iU-O8KOi_T9yQh8I",desc:"_2UB_Yg9e0vkZC2Jg9xbtM"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(192),r(36),r(20),r(4),r(190),r(18),r(11),r(328),r(46),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(36),r(20),r(29),r(4),r(190),r(18),r(43),r(11),r(328),r(46),r(469),r(470),r(471),r(472),r(473),r(474),r(475),r(40);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(824)),d=n(r(805)),p=n(r(67)),m=n(r(0)),h=n(r(2564)),v=n(r(2565));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).policiesValidator=function(a,r,n){if(r.length>0){if(new Set(r.map((function(e){return e.type}))).size!==r.length)return void n(t("POLICY_TYPE_DUPLICATED"));r.every((function(t){return e.checkItemValid(t)}))||n(t("EMPTY_POLICY_MESSAGE"))}n()},e.checkItemValid=function(e){return!(0,p.default)(e)&&Object.values(e).every((function(e){return void 0!==e&&""!==e}))},e}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.prefix,r="scaleUp"===e.type?"EXPANSION_STRATEGY":"SCALING_STRATEGY";return m.default.createElement("div",{className:h.default.wrapper},m.default.createElement("div",{className:h.default.title},t(r)),m.default.createElement("div",{className:h.default.contentWrapper},m.default.createElement(i.Columns,null,m.default.createElement(i.Column,null,m.default.createElement(i.Form.Item,{label:t("POLICY_PREFERENCE"),desc:t("POLICY_PREFERENCE_DESC")},m.default.createElement(i.Select,{name:"".concat(a,".selectPolicy"),options:[{label:t("TENDS_TO_SCALE_SIGNIFICANTLY"),value:"Max"},{label:t("TENDS_TO_EXPAND_SLIGHTLY"),value:"Min"},{label:t("SCALE_DISABLE"),value:"Disabled"}],defaultValue:"Max"}))),m.default.createElement(i.Column,null,m.default.createElement(i.Form.Item,{label:t("STABILIZATION_WINDOW_SECONDS"),desc:t("STABILIZATION_WINDOW_SECONDS_DESC")},m.default.createElement(d.default,{name:"".concat(a,".stabilizationWindowSeconds"),integer:!0,min:0})))),m.default.createElement("div",{className:h.default.polices},m.default.createElement(i.Form.Group,null,m.default.createElement(i.Form.Item,{rules:[{validator:this.policiesValidator,checkOnSubmit:!0}]},m.default.createElement(f.default,{name:"".concat(a,".policies"),itemType:"object",addText:t("ADD"),checkItemValid:this.checkItemValid},m.default.createElement(v.default,null)))))))}}]),r}(m.default.Component);a.default=y},function(e,t,a){e.exports={wrapper:"jFCoYhpnGhYRcS1QvI2uD",title:"_1gW9vDU9n16HaSVvFzrJvF",contentWrapper:"_1Q43wihGB-cA4A_oU381-F",polices:"_11tysHczkx95E3l_OS1yA9"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=r(189),d=n(r(995)),p=n(r(805)),m=n(r(808)),h=n(r(0)),v=n(r(2566));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=[{label:t("PODS"),value:"Pods"},{label:t("PERCENT"),value:"Percent"}],g=function(e){(0,c.default)(r,e);var a=E(r);function r(e){var t;return(0,u.default)(this,r),(t=a.call(this,e)).triggerChange=(0,m.default)((function(){var e=t.state,a=e.type,r=e.value,n=e.periodSeconds;t.props.onChange({type:a,value:r,periodSeconds:n})}),300),t.handleChange=function(e,a){t.setState((0,l.default)({},a,e),(function(){return t.triggerChange()}))},t.state=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,a=e.value,r=e.periodSeconds;return{type:t,value:a,periodSeconds:r}}(e.value),t}return(0,o.default)(r,[{key:"componentDidMount",value:function(){this.triggerChange()}},{key:"render",value:function(){var e=this,a=this.state,r=a.value,n=a.type,l=a.periodSeconds;return h.default.createElement("div",{className:v.default.wrapper},h.default.createElement(d.default,{prefix:t("POLICY_TYPE")},h.default.createElement(f.Select,{name:"type",value:n,options:y,onChange:function(t){return e.handleChange(t,"type")}})),h.default.createElement(d.default,{prefix:t("EXPANSION_VALUE")},h.default.createElement(p.default,{name:"value",value:r,min:0,integer:!0,onChange:function(t){return e.handleChange(t,"value")}})),h.default.createElement(d.default,{prefix:t("ACTIVATION_TIME")},h.default.createElement(p.default,{name:"periodSeconds",integer:!0,min:0,value:l,onChange:function(t){return e.handleChange(t,"periodSeconds")}})))}}]),r}(h.default.Component);a.default=g,g.defaultProps={value:{},onChange:function(){}}},function(e,t,a){e.exports={wrapper:"M54xui62otMloHUrIMpt_",tip:"_3aRuzDuGBQbBlvi2Gucjkc"}},function(e,a,r){"use strict";r(16);var n=r(19);r(70),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(70),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(827)),v=r(243),E=r(189),y=r(848),g=r(61),b=n(r(2568)),S=n(r(2569)),_=n(r(2570)),O=n(r(1175));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var T=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=C(r);function r(e){var t;(0,c.default)(this,r),(t=a.call(this,e)).handleGoBack=function(){var e=t.context.resetSubRoute;e&&e(),t.props.onCancel()},t.handleSubmit=function(e){var a=t.props.onSave,r=t.formRef.current;r&&r.validate((function(){var t=r.getData();a(t),e&&e()}))},t.renderTrigger=function(){var e;switch(t.state.triggerType){case"cron":e=p.default.createElement(b.default,null);break;case"prometheus":e=p.default.createElement(S.default,null);break;default:e=p.default.createElement(_.default,null)}return e},t.handleChange=function(e){t.setState({triggerType:e,formData:{}})},t.formRef=p.default.createRef();var n=["cron","prometheus"].includes(e.trigger.type);return t.state={formData:e.trigger,triggerType:e.trigger.type?n?e.trigger.type:"custom":"cron"},t}return(0,s.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.onCancel,t=this.context.registerSubRoute;t&&t(this.handleSubmit,e)}},{key:"render",value:function(){var e=this.state,a=e.formData,r=e.triggerType;return p.default.createElement("div",{className:O.default.wrapper},p.default.createElement("div",{className:"h6"},p.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},p.default.createElement(y.ReactComponent,null)),t("ADD_TRIGGER")),p.default.createElement("div",{className:O.default.contentWrapper},p.default.createElement("div",{className:O.default.card},p.default.createElement(E.Form,{data:a,ref:this.formRef},p.default.createElement("div",null,t("TRIGGER_TYPE")),p.default.createElement(E.Form.Item,null,p.default.createElement(h.default,{value:r,options:g.CREATE_TRIGGER_TYPE_OPTIONS,onChange:this.handleChange})),p.default.createElement("div",{className:"form-group"},this.renderTrigger())))))}}]),r}(p.default.Component),u.defaultProps={onSave:function(){},onCancel:function(){}},u.contextTypes={registerSubRoute:m.default.func,resetSubRoute:m.default.func},l=o))||l;a.default=T},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=r(486),p=n(r(1175));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).validateCron=function(e,a,r){if(!a)return r();try{(0,d.parseExpression)(a)}catch(e){return r(t("CRON_EXPRESSION_ERROR_DESC"))}r()},e}return(0,u.default)(r,[{key:"render",value:function(){return i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:p.default.hidden},i.default.createElement(f.Form.Item,null,i.default.createElement(f.Input,{name:"type",defaultValue:"cron",disabled:!0}))),i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("TIME_ZONE"),desc:t("CRON_TIME_ZONE_DESC")},i.default.createElement(f.Input,{name:"metadata.timezone",defaultValue:"Asia/Shanghai"}))),i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("REPLICAS_DESIRED"),desc:t("REPLICAS_DESIRED_CRON_TRIGGER_DESC")},i.default.createElement(f.Input,{name:"metadata.desiredReplicas"})))),i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("CRON_START"),desc:t("CRON_START_DESC"),rules:[{validator:this.validateCron}]},i.default.createElement(f.Input,{name:"metadata.start"}))),i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("CRON_END"),desc:t("CRON_END_DESC"),rules:[{validator:this.validateCron}]},i.default.createElement(f.Input,{name:"metadata.end"})))))}}]),r}(i.default.Component);a.default=h},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(9),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(829)),d=n(r(0)),p=n(r(1175));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).validateTogglerAuthor=function(e,a,r){if(a){var n=Object.keys(a);n.length&&"name"!==n[0]?r(t("TRIGGER_AUTHENTICATION_KEY_EQ_NAME")):r()}else r()},e}return(0,u.default)(r,[{key:"render",value:function(){return d.default.createElement(d.default.Fragment,null,d.default.createElement("div",{className:p.default.hidden},d.default.createElement(i.Form.Item,null,d.default.createElement(i.Input,{name:"type",defaultValue:"prometheus",disabled:!0}))),d.default.createElement(i.Columns,null,d.default.createElement(i.Column,null,d.default.createElement(i.Form.Item,{label:t("ADDRESS"),desc:t("PROMETHUS_ADDRESS")},d.default.createElement(i.Input,{name:"metadata.serverAddress"}))),d.default.createElement(i.Column,null,d.default.createElement(i.Form.Item,{label:t("INDICATOR_NAME"),desc:t("INDICATOR_NAME_PROMETHUS_DESC")},d.default.createElement(i.Input,{name:"metadata.metricName"})))),d.default.createElement(i.Columns,null,d.default.createElement(i.Column,null,d.default.createElement(i.Form.Item,{label:t("THRESHOLD"),desc:t("THRESHOLD_PROMETHUS_DESC")},d.default.createElement(i.Input,{name:"metadata.threshold"}))),d.default.createElement(i.Column,null,d.default.createElement(i.Form.Item,{label:t("EXPRESSION"),desc:t("EXPRESSION_PROMETHUS_DESC")},d.default.createElement(i.Input,{name:"metadata.query"})))),d.default.createElement(i.Form.Item,{label:t("TOGGLER_AUTHOR"),rules:[{validator:this.validateTogglerAuthor}]},d.default.createElement(f.default,{name:"authenticationRef",addText:t("ADD"),maxLen:1})))}}]),r}(d.default.Component);a.default=h},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(192),r(1038),r(1039),r(99),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(1038),r(1039),r(29),r(99),r(9),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(829)),d=n(r(0));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(r,e);var a=p(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).validateToggler=function(e,a,r){if(a){var n=Object.entries(a).flat();!n.length||n.every(Boolean)?r():r(t("LABEL_KEY_VALUE_CANNOT_BE_EMPTY"))}else r()},e.validateTogglerAuthor=function(e,a,r){if(a){var n=Object.keys(a);n.length&&"name"!==n[0]?r(t("TRIGGER_AUTHENTICATION_KEY_EQ_NAME")):r()}else r()},e}return(0,u.default)(r,[{key:"render",value:function(){return d.default.createElement(d.default.Fragment,null,d.default.createElement(i.Columns,null,d.default.createElement(i.Column,null,d.default.createElement(i.Form.Item,{label:t("TYPE"),rules:[{required:!0,message:t("EMPTY_TYPE_TRIGGER")}]},d.default.createElement(i.Input,{name:"type"}))),d.default.createElement(i.Column,null)),d.default.createElement(i.Form.Item,{label:t("TOGGLER_PARAMS"),rules:[{validator:this.validateToggler}]},d.default.createElement(f.default,{name:"metadata",addText:t("ADD")})),d.default.createElement(i.Form.Item,{label:t("TOGGLER_AUTHOR"),rules:[{validator:this.validateTogglerAuthor}]},d.default.createElement(f.default,{name:"authenticationRef",addText:t("ADD"),maxLen:1,rules:[{validator:this.validateTogglerAuthor}]})))}}]),r}(d.default.Component);a.default=m},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(194),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(194),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(67)),p=n(r(828)),m=n(r(2572)),h=n(r(2573));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=function(e){(0,o.default)(r,e);var a=v(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).handleAddTrigger=function(){e.props.onShowTrigger()},e.handleEdit=function(t,a){e.props.onShowEdit(t,a)},e.handleDelete=function(t){var a=e.props,r=a.value,n=a.onChange;r.splice(t,1),n(r)},e}return(0,u.default)(r,[{key:"renderAddTrigger",value:function(){return i.default.createElement(p.default.Add,{onClick:this.handleAddTrigger,title:t("ADD_TRIGGER"),description:t("ADD_TRIGGER_DESC")})}},{key:"render",value:function(){var e=this,t=this.props.value;return i.default.createElement("div",{className:h.default.wrapper},i.default.createElement("div",{className:h.default.content},!(0,d.default)(t)&&i.default.createElement("ul",{className:h.default.list},t.map((function(t,a){return i.default.createElement(m.default,{trigger:t,key:a,index:a,onEdit:e.handleEdit,onDelete:e.handleDelete})}))),this.renderAddTrigger()))}}]),r}(i.default.Component);a.default=E,E.defaultProps={prefix:"",onChange:function(){},onShowTrigger:function(){},onShowEdit:function(){}},E.contextTypes={formData:f.default.object}},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),a(44),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(317));a(12),a(109),a(44),a(4);var l=r(a(0)),u=r(a(1)),o=r(a(479)),c=r(a(828)),s=a(61),i=function(e){var t=e.trigger,a=e.onDelete,r=e.onEdit,u=e.index,i={};a&&(i.onDelete=function(){return a(u)}),r&&(i.onEdit=function(){return r(t,u)});var f=s.CREATE_TRIGGER_TYPE_OPTIONS.find((function(e){return e.value===t.type}))||s.CREATE_TRIGGER_TYPE_OPTIONS[2];return l.default.createElement(c.default.Item,(0,n.default)({icon:f.icon,title:(0,o.default)(t.type),description:f.description},i))};i.propTypes={container:u.default.object};var f=i;t.default=f},function(e,t,a){e.exports={wrapper:"_2RvL6Llw-aFnLKDdPhjxN7",list:"FdV3QCuZltFyjiiHymA5L"}},function(e,t,a){e.exports={confirm:"_3GatSk-ySQ9VFV36akCHyQ"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(2576)),l=r(a(1425)),u=[{title:"BASIC_INFORMATION",icon:"cdn",component:n.default,required:!0},{title:"SCALING_SETTINGS",icon:"stretch",component:l.default,required:!0}];t.default=u},function(e,a,r){"use strict";r(16);var n=r(19);r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(26)),d=n(r(68)),p=n(r(0)),m=r(61),h=n(r(2577)),v=n(r(2581));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).onShowAdd=function(){t.setState({visible:!0,workloadData:{}})},t.onShowEdit=function(e){t.setState({visible:!0,workloadData:e})},t.resetState=function(){t.setState({visible:!1,workloadData:{}})},t.onSave=function(e){(0,d.default)(t.props.formTemplate,"spec.scaleTargetRef.name",e.name),(0,d.default)(t.props.formTemplate,"spec.scaleTargetRef.apiVersion","apps/v1"),(0,d.default)(t.props.formTemplate,"metadata.name",e.name),t.setState({visible:!1,workloadData:{}})},t.selectContainer=function(e){(0,d.default)(t.props.formTemplate,"spec.scaleTargetRef.envSourceContainerName",e)},t.state={visible:!1,workloadData:{}},t}return(0,u.default)(r,[{key:"renderWorkloadTableForm",value:function(){var e=this.props,t=e.formTemplate,a=e.cluster,r=e.namespace;return p.default.createElement(v.default,{formTemplate:t,cluster:a,namespace:r,onSave:this.onSave,onCancel:this.resetState})}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=e.maxNameLength,l=void 0===n?253:n,u=e.cluster,o=e.namespace;if(this.state.visible)return this.renderWorkloadTableForm();var c=253===l?t("LONG_NAME_DESC"):t("NAME_DESC");return p.default.createElement(i.Form,{ref:a,data:r},p.default.createElement(i.Columns,null,p.default.createElement(i.Column,null,p.default.createElement(i.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:m.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:c})}]},p.default.createElement(i.Input,{name:"metadata.name",maxLength:l,disabled:!0}))),p.default.createElement(i.Column,null,p.default.createElement(i.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:m.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},p.default.createElement(i.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),p.default.createElement(i.Columns,null,p.default.createElement(i.Column,null,p.default.createElement(i.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},p.default.createElement(i.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))),p.default.createElement(i.Form.Item,{label:t("SCALING_OBJECT"),rules:[{required:!0,message:t("EMPTY_SCALING_OBJECT_MESSAGE")}]},p.default.createElement(h.default,{name:"spec.scaleTargetRef.name",scaleTargetRef:(0,f.default)(this.props.formTemplate,"spec.scaleTargetRef"),onShowAdd:this.onShowAdd,onShowEdit:this.onShowEdit,onCancel:this.resetState,cluster:u,selectContainer:this.selectContainer,namespace:o})))}},{key:"cluster",get:function(){return this.props.cluster}},{key:"namespace",get:function(){return(0,f.default)(this.props.formTemplate,"metadata.namespace")}}]),r}(p.default.Component);a.default=y},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(38)),u=n(r(31)),o=n(r(58));r(35);var c=n(r(39)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=r(189),h=n(r(828)),v=n(r(827)),E=n(r(0)),y=n(r(319)),g=n(r(2578)),b=n(r(1431));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var C=function(e){(0,f.default)(r,e);var a=O(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,u=new Array(n),i=0;i<n;i++)u[i]=arguments[i];return(e=a.call.apply(a,[this].concat(u))).state={detail:{}},e.onShowAdd=function(){e.props.onShowAdd()},e.handleEdit=function(t){e.props.onShowEdit(t)},e.handleDelete=function(){(0,e.props.onChange)(void 0)},e.getWorkloadDetail=(0,c.default)(l.default.mark((function a(){var r,n,u,c,s,i,f,d,p,m,h,v,E;return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.props,u=n.scaleTargetRef,c=n.namespace,s=n.cluster,(i=u).name&&i.kind){a.next=4;break}return a.abrupt("return");case 4:return f=i.kind.toLowerCase(),d="".concat(f,"s"),p=new y.default(d),a.next=9,p.fetchDetail({namespace:c,cluster:s,name:i.name});case 9:m=a.sent,h=null!==(r=null==m?void 0:m.initContainers)&&void 0!==r?r:[],v=[].concat((0,o.default)(m.containers),(0,o.default)(h)),E=v.map((function(e){return{icon:"docker",value:e.name,label:e.name,description:t("ENV_CONTAINER")}})),e.selectContainer(v[0].name),e.setState({detail:_(_({},m),{},{module:d}),containerOptions:E,container:v[0].name});case 15:case"end":return a.stop()}}),a)}))),e.selectContainer=function(t){e.props.selectContainer(t)},e.renderContainerSelector=function(){return E.default.createElement(v.default,{value:e.state.container,options:e.state.containerOptions,onChange:e.selectContainer})},e}return(0,i.default)(r,[{key:"renderAddComponent",value:function(){return E.default.createElement(h.default.Add,{onClick:this.onShowAdd,title:t("ADD_WORKLOAD"),description:t("ADD_WORKLOAD_DESC")})}},{key:"componentDidMount",value:function(){this.getWorkloadDetail()}},{key:"render",value:function(){var e=this.props.value,a=this.state.detail;return E.default.createElement("div",{className:b.default.wrapper},e?E.default.createElement("div",null,E.default.createElement(g.default,{detail:a,onEdit:null,onDelete:null,action:E.default.createElement(m.Button,{className:b.default.action,onClick:this.handleEdit},t("RESELECT"))}),this.renderContainerSelector()):this.renderAddComponent())}}]),r}(E.default.Component);a.default=C,C.defaultProps={onChange:function(){},onShowAdd:function(){},onShowEdit:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(800)),d=n(r(26)),p=n(r(67)),m=n(r(833)),h=n(r(901)),v=n(r(1)),E=n(r(0)),y=r(56),g=r(61),b=r(439),S=n(r(1431));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var O=function(e){(0,o.default)(r,e);var a=_(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"getDescription",value:function(e){var a=(0,b.getWorkloadStatus)(e,e.module),r=a.status,n=a.reason;if(n)return E.default.createElement(m.default,{status:r,reason:t(n),data:e});var l=e.updateTime,u=e.createTime;return l?t("UPDATED_AGO",{diff:(0,y.getLocalTime)(l).fromNow()}):t("CREATED_AGO",{diff:(0,y.getLocalTime)(u).fromNow()})}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.onDelete,n=e.onEdit,l=e.action;if((0,p.default)(a))return null;var u=(0,d.default)(a,'annotations["deployment.kubernetes.io/revision"]');return E.default.createElement("div",{className:S.default.card},E.default.createElement(f.default,{icon:g.ICON_TYPES[a.module],title:(0,y.getDisplayName)(a),description:this.getDescription(a)}),E.default.createElement(f.default,{title:E.default.createElement(h.default,{data:a,module:a.module}),description:t("STATUS")}),E.default.createElement(f.default,{title:u?"#".concat(u):"-",description:t("REVISION_RECORD")}),E.default.createElement("div",{className:"buttons"},r&&E.default.createElement(i.Button,{type:"flat",icon:"trash",onClick:r}),n&&E.default.createElement(i.Button,{type:"flat",icon:"pen",onClick:n}),l))}}]),r}(E.default.Component);a.default=O,O.propTypes={className:v.default.string,detail:v.default.object},O.defaultProps={detail:{},onDelete:function(){},onEdit:function(){}}},,,function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u,o,c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=r(189),h=r(848),v=n(r(68)),E=r(17),y=r(243),g=n(r(1)),b=n(r(0)),S=n(r(319)),_=n(r(1176)),O=n(r(2582));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var R={deployments:"Deployment",statefulsets:"StatefulSet"},D=(0,y.observer)((o=u=function(e){(0,f.default)(r,e);var a=T(r);function r(e){var t;return(0,s.default)(this,r),(t=a.call(this,e)).handleGoBack=function(){var e=t.context.resetSubRoute;e&&e(),t.props.onCancel()},t.handleSubmit=function(e){(0,t.props.onSave)(t.state.workloadData),e&&e()},t.handleTypeChange=function(e){var a=t.props.formTemplate;(0,v.default)(a,"spec.scaleTargetRef.kind",R[e]),t.store=new S.default(e),t.setState({type:e,workloadData:void 0})},t.fetchList=function(e){var a=t.props,r=a.namespace,n=a.cluster;t.store.fetchList(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({cluster:n,namespace:r,labelSelector:"!autoscaling.kubeshpere.io/name",annotation:"!kubesphere.io/relatedHPA"},e))},t.handleSelectWorkload=function(e){t.setState({workloadData:e})},t.state={type:"deployments",workloadData:void 0},t.store=new S.default("deployments"),t}return(0,i.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.onCancel,t=this.context.registerSubRoute;t&&t(this.handleSubmit,e);var a=this.props.formTemplate;(0,v.default)(a,"spec.scaleTargetRef.kind",R.deployments)}},{key:"render",value:function(){var e=this.state,a=e.type,r=e.workloadData;return b.default.createElement("div",{className:_.default.wrapper},b.default.createElement("div",{className:"h6"},b.default.createElement("a",{className:"icon",onClick:this.handleGoBack},b.default.createElement(h.ReactComponent,null)),t("ADD_WORKLOAD")),b.default.createElement("div",{className:_.default.content},b.default.createElement(m.RadioGroup,{mode:"button",buttonWidth:155,value:a,onChange:this.handleTypeChange},b.default.createElement(m.RadioButton,{value:"deployments"},t("DEPLOYMENT_PL")),b.default.createElement(m.RadioButton,{value:"statefulsets"},t("STATEFULSET_PL"))),b.default.createElement("div",{className:_.default.tableWrapper},b.default.createElement(O.default,{key:a,fetchList:this.fetchList,list:(0,E.toJS)(this.store.list),module:a,checkedValue:r,handleSelectWorkload:this.handleSelectWorkload}))))}}]),r}(b.default.Component),u.contextTypes={registerSubRoute:g.default.func,resetSubRoute:g.default.func},l=o))||l;a.default=D},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(197),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(197),r(7);var l,u=n(r(31)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(889)),m=r(189),h=r(243),v=n(r(2583)),E=n(r(1176));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=(0,h.observer)(l=function(e){(0,s.default)(r,e);var a=b(r);function r(){var e;(0,o.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).handleSearch=function(t){e.props.fetchList({name:t},!0)},e.handleRefresh=function(){var t=e.props.page;e.props.fetchList({limit:10,page:t})},e.clearFilter=function(){e.handleSearch()},e.renderEmpty=function(){return d.default.createElement("div",{className:E.default.emptyText},d.default.createElement("span",{className:E.default.emptyTipIcon},d.default.createElement(m.Icon,{name:"exclamation",size:48})),d.default.createElement("div",null,t("NO_MATCHING_RESULT_FOUND")),d.default.createElement("p",null,t("YOU_CAN_TRY_TO"),d.default.createElement("span",{className:E.default.action,onClick:e.handleRefresh,"data-test":"table-empty-refresh"},t("REFRESH_DATA")),t("OR"),d.default.createElement("span",{className:E.default.action,onClick:e.clearFilter,"data-test":"table-empty-clear-filter"},t("CLEAR_SEARCH_CONDITIONS"))))},e}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.props.list.total<1&&this.props.fetchList()}},{key:"render",value:function(){var e=this.props,a=e.list,r=e.fetchList,n=e.handleSelectWorkload,l=e.checkedValue,u=e.module,o=a.data,c=a.total,s=a.page,i=a.isLoading;return d.default.createElement("div",null,d.default.createElement(m.InputSearch,{className:E.default.search,value:a.filters.name,onSearch:this.handleSearch,placeholder:t("SEARCH_BY_NAME")}),d.default.createElement("div",{className:E.default.cardList},c<1?this.renderEmpty():d.default.createElement(p.default,{data:o,total:c,page:s,loading:i,onFetch:r},o.map((function(e,t){return d.default.createElement(v.default,{detail:g(g({},e),{},{module:u}),key:t,onClick:function(){return n(e)},isChecked:l&&l.name===e.name})})))))}}]),r}(d.default.Component))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(70),r(9),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(70),r(29),r(9),r(4),r(18),r(43),r(11),r(73);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(800)),d=n(r(26)),p=n(r(833)),m=n(r(901)),h=n(r(1)),v=n(r(0)),E=r(56),y=r(61),g=r(439),b=n(r(1176));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var _=function(e){(0,o.default)(r,e);var a=S(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"getDescription",value:function(e){var a=(0,g.getWorkloadStatus)(e,e.module),r=a.status,n=a.reason;if(n)return v.default.createElement(p.default,{status:r,reason:t(n),data:e});var l=e.updateTime,u=e.createTime;return l?t("UPDATED_AGO",{diff:(0,E.getLocalTime)(l).fromNow()}):t("CREATED_AGO",{diff:(0,E.getLocalTime)(u).fromNow()})}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.onClick,n=e.isChecked;if(!a)return null;var l=(0,d.default)(a,'annotations["deployment.kubernetes.io/revision"]'),u=a.labels,o=Object.keys(u).includes("autoscaling.kubeshpere.io/name"),c=!!(0,d.default)(a,"annotations['kubesphere.io/relatedHPA']");return v.default.createElement("div",{className:b.default.card,onClick:function(){r&&r()}},v.default.createElement(i.Radio,{checked:n,disabled:o||c},v.default.createElement(f.default,{icon:y.ICON_TYPES[a.module],title:(0,E.getDisplayName)(a),description:this.getDescription(a)}),v.default.createElement(f.default,{title:v.default.createElement(m.default,{data:a,module:a.module}),description:t("STATUS")}),"deployments"===a.module?v.default.createElement(f.default,{title:l?"#".concat(l):"-",description:t("REVISION_RECORD")}):null))}}]),r}(v.default.Component);a.default=_,_.propTypes={className:h.default.string,detail:h.default.object},_.defaultProps={detail:{},onDelete:function(){},onEdit:function(){}}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(4),r(21),r(200),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(200),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(798)),i=n(r(191)),f=n(r(1058));function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m={"devops.credential.create":{on:function(e){var a,r=e.store,n=e.success,o=e.cluster,d=e.workspace,m=e.devops,h=e.formTemplate,v=(0,c.default)(e,["store","success","cluster","workspace","devops","formTemplate"]),E=s.default.open(p({onOk:(a=(0,u.default)(l.default.mark((function e(a,u){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.handleCreate(a,{devops:m,cluster:o}).finally((function(){u&&u()}));case 2:s.default.close(E),i.default.success({content:t("CREATE_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)}),store:r,cluster:o,workspace:d,devops:m,formTemplate:h,modal:f.default},v))}},"devops.credential.edit":{on:function(e){var a,r=e.store,n=e.success,o=e.cluster,d=e.workspace,m=e.devops,h=e.formTemplate,v=(0,c.default)(e,["store","success","cluster","workspace","devops","formTemplate"]),E=s.default.open(p({onOk:(a=(0,u.default)(l.default.mark((function e(a,u){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.updateCredential(a,{devops:m,cluster:o}).finally((function(){u&&u()}));case 2:s.default.close(E),i.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)}),store:r,cluster:o,workspace:d,devops:m,formTemplate:h,modal:f.default},v))}}};a.default=m},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(14),r(327),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(58));r(12),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(27),r(14),r(327),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40);var i=n(r(119)),f=n(r(26)),d=n(r(68)),p=n(r(191)),m=n(r(798)),h=n(r(2586)),v=n(r(2588)),E=n(r(2589)),y=n(r(822));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S=function(e){if(e.length>0){var t=new Map,a=[];return e.forEach((function(a){var r=a.name;if(r){var n=e.filter((function(e){return e.name===r}));t.set(r,n)}})),t.has("*")?a=(0,s.default)(t.get("*")):(t.forEach((function(e){var t=e.length&&e.filter((function(e){return"*"===e.namespace}));t.length>0?a.push(t[0]):a=a.concat(e)})),a)}return e},_={"devops.create":{on:function(e){var a=e.store,r=e.workspace,n=e.success,l=(0,c.default)(e,["store","workspace","success"]),u=m.default.open(b({onOk:function(e){var l=(0,f.default)(e,"spec.placement.cluster");a.create(e,{cluster:l,workspace:r}).then((function(){m.default.close(u),p.default.success({content:t("CREATE_SUCCESSFUL")}),n&&n(l)}))},formTemplate:{},modal:h.default,store:a,workspace:r,hideCluster:!globals.app.isMultiCluster},l))}},"devops.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=m.default.open(b({onOk:function(e){a.update(r,e).then((function(){m.default.close(u),p.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},modal:v.default,detail:r,store:a},l))}},"devops.edit.allowlist":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,s=(0,c.default)(e,["store","detail","success"]),h=m.default.open(b({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,c,s,v,E;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,i.default)(a),c=(0,f.default)(u,"spec.argo.sourceRepos",[]),s=(0,f.default)(u,"spec.argo.destinations",[]),(v=c.filter((function(e){return"*"===e}))).length>0&&(0,d.default)(u,"spec.argo.sourceRepos",v),E=S(s),(0,d.default)(u,"spec.argo.destinations",E),e.next=9,r.editAllowlist(n,u);case 9:m.default.close(h),p.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o();case 12:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:E.default,store:r},s))}},"devops.batch.delete":{on:function(e){var a,r=e.store,n=e.success,o=e.rowKey,s=(0,c.default)(e,["store","success","rowKey"]),i=r.list,f=i.data,d=i.selectedRowKeys,h=f.filter((function(e){return d.includes(e[o])})).map((function(e){return e.name})),v=m.default.open(b({onOk:(a=(0,u.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],f.forEach((function(e){d.includes(e[o])&&a.push(r.delete(e))})),e.next=4,Promise.all(a);case 4:m.default.close(v),p.default.success({content:t("DELETED_SUCCESSFULLY")}),r.setSelectRowKeys([]),n&&n();case 8:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),title:1===h.length?t("DELETE_DEVOPS_PROJECT"):t("DELETE_MULTIPLE_DEVOPS_PROJECTS"),desc:1===h.length?t.html("DELETE_DEVOPS_PROJECT_TIP",{resource:h.join(", ")}):t.html("DELETE_DEVOPS_PROJECT_TIP_PL",{resource:h.join(", ")}),resource:h.join(", "),modal:y.default,store:r},s))}}};a.default=_},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(20),r(14),r(99),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u,o,c=n(r(97)),s=n(r(31)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=r(189),v=n(r(798)),E=n(r(846)),y=n(r(26)),g=n(r(67)),b=n(r(914)),S=r(243),_=n(r(1)),O=n(r(0)),C=n(r(443)),T=r(61),R=r(873),D=n(r(536)),k=n(r(2587));function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var A=(0,S.observer)((o=u=function(e){(0,d.default)(r,e);var a=P(r);function r(e){var n;return(0,i.default)(this,r),(n=a.call(this,e)).valueRenderer=function(e){return O.default.createElement(E.default,{cluster:e.cluster,size:"small",noStatus:!0})},n.optionRenderer=function(e){return O.default.createElement(O.default.Fragment,null,O.default.createElement(E.default,{cluster:e.cluster,size:"small",theme:"light",noStatus:!0}),e.disabled&&O.default.createElement("div",{className:k.default.toolmessage},O.default.createElement("span",null,e.cluster.isReady?t("NO_DEVOPS_INSTALL"):t("UNREADY"))))},n.nameValidator=function(e,a,r){if(!a)return r();var l=n.props,u=l.formTemplate,o=l.workspace,c=(0,y.default)(u,"spec.placement.cluster");n.store.checkDevopsName({cluster:c,workspace:o,name:a},(0,R.compareVersion)(n.ksVersion,"3.4.0")<0).then((function(a){if(a.exist)return r({message:t("NAME_EXIST_DESC"),field:e.field});r()}))},n.handleClusterChange=function(){if(n.nameRef&&n.nameRef.current){var e="metadata.generateName";n.formRef&&n.formRef.current&&!(0,g.default)(n.formRef.current.state.errors)&&n.formRef.current.resetValidateResults(e),n.nameRef.current.validate((0,s.default)({},e,(0,y.default)(n.props.formTemplate,e)))}},n.store=e.store,n.workspaceStore=new C.default,n.nameRef=O.default.createRef(),n.formRef=O.default.createRef(),n.state={clusters:{}},n}return(0,f.default)(r,[{key:"componentDidMount",value:function(){this.props.hideCluster||this.fetchClusters()}},{key:"fetchClusters",value:function(e){var t=this;D.default.get("/apis/kubesphere.io/v1alpha1/extensions/devops").then((function(e){var a={},r=(0,y.default)(e,"status.clusterSchedulingStatuses",{});Object.entries(r).forEach((function(e){var t=(0,c.default)(e,2),r=t[0],n=t[1];a[r]="Installed"===(null==n?void 0:n.state)})),t.setState({clusters:a})})),this.workspaceStore.fetchClusters(I(I({},e),{},{workspace:this.props.workspace}))}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.formTemplate,n=e.hideCluster,l=e.onOk,u=e.onCancel;return O.default.createElement(v.default.Form,{width:960,bodyClassName:k.default.body,data:r,onCancel:u,onOk:l,visible:a,closable:!1,hideHeader:!0,formRef:this.formRef},O.default.createElement("div",{className:k.default.header},O.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/project-create.svg",alt:""}),O.default.createElement("div",{className:k.default.title},O.default.createElement("div",null,t("CREATE_DEVOPS_PROJECT")),O.default.createElement("p",null,t("DEVOPS_PROJECT_CREATE_DESC")))),O.default.createElement("div",{className:k.default.content},O.default.createElement(h.Columns,null,O.default.createElement(h.Column,null,O.default.createElement(h.Form.Item,{label:t("NAME"),desc:t("SERVICE_NAME_DESC"),ref:this.nameRef,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:T.PATTERN_SERVICE_NAME,message:t("INVALID_NAME_DESC",{message:t("SERVICE_NAME_DESC")})},{validator:this.nameValidator}]},O.default.createElement(h.Input,{name:"metadata.generateName",autoFocus:!0,maxLength:63}))),O.default.createElement(h.Column,null,O.default.createElement(h.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:T.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},O.default.createElement(h.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),O.default.createElement(h.Columns,null,!n&&O.default.createElement(h.Column,null,O.default.createElement(h.Form.Item,{label:t("CLUSTER_SETTINGS"),rules:[{required:!0,message:t("CLUSTER_EMPTY_DESC")}]},O.default.createElement(h.Select,{name:"spec.placement.cluster",className:k.default.cluster,options:this.clusters,valueRenderer:this.valueRenderer,optionRenderer:this.optionRenderer,defaultValue:this.defaultCluster,onChange:this.handleClusterChange,showTip:!0}))),O.default.createElement(h.Column,null,O.default.createElement(h.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},O.default.createElement(h.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256}))))))}},{key:"networkOptions",get:function(){return[{label:t("OFF"),value:""},{label:t("ON"),value:"enabled"}]}},{key:"clusters",get:function(){var e=this.state.clusters;return this.workspaceStore.clusters.data.map((function(t){return{label:t.name,value:t.name,cluster:t,disabled:!t.isReady||!e[t.name]}}))}},{key:"defaultCluster",get:function(){var e=this.props.cluster,t=this.clusters.filter((function(e){return!e.disabled})).map((function(e){return e.value}));return t.find((function(t){return t===e}))||t[0]}},{key:"ksVersion",get:function(){var e=this.props.formTemplate,t=(0,y.default)(e,"spec.placement.cluster"),a=globals.app.isMultiCluster?(0,y.default)(globals,"clusterConfig.".concat(t,".ksVersion"),(0,y.default)(this.workspaceStore.clusters.data.find((function(e){return e.name===t})),"configz.ksVersion")):(0,y.default)(globals,"ksConfig.ksVersion");return(0,b.default)(a,"v")}}]),r}(O.default.Component),u.propTypes={formTemplate:_.default.object,visible:_.default.bool,isSubmitting:_.default.bool,onOk:_.default.func,onCancel:_.default.func},u.defaultProps={formTemplate:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=A},function(e,t,a){e.exports={body:"_3ZKoSqYFw5BRXmnCMUCyhC",header:"_3W-QAW13W4dowCBvjkJ7-y",title:"_22NqdZtvVEOVr9kv6bDsWN",toolmessage:"_370UWtm3Xf9odgtqYFtvAL",content:"Uz1mMt6FKA96vAT7roymt",cluster:"_2w41wf42xuXfsCbwGPlYQf",itemOption:"ZAVdNzefGlD04KWsBC5i_",itemValue:"_2ZXSuKSm_TuXXuyXCcojy-",group:"_3mcpkjmNOwaJzL-_WcWPpG"}},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=r(189),m=n(r(798)),h=n(r(26)),v=r(17),E=r(243),y=n(r(1)),g=n(r(0)),b=n(r(323)),S=r(61);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=(0,E.observer)((o=u=function(e){(0,i.default)(r,e);var a=_(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(e){(0,t.props.onOk)(e)},t.form=g.default.createRef(),t.store=new b.default,e.detail.workspace&&t.store.fetchList({limit:1/0,workspace:e.detail.workspace}),t}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){var t=(0,h.default)(this.props,"detail.workspace");t&&t!==(0,h.default)(e,"detail.workspace")&&this.store.fetchMembers({limit:1/0,workspace:t})}},{key:"getMembersOptions",value:function(){return(0,v.toJS)(this.store.list).data.map((function(e){return{label:e.username,value:e.username}}))}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.visible,n=e.onCancel,l=e.isSubmitting;return g.default.createElement(m.default.Form,{width:691,title:t("EDIT_INFORMATION"),icon:"pen",data:a,onOk:this.handleOk,onCancel:n,isSubmitting:l,visible:r},g.default.createElement(p.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:S.PATTERN_NAME,message:t("PATTERN_NAME_INVALID_TIP")}]},g.default.createElement(p.Input,{name:"name",disabled:!0})),g.default.createElement(p.Form.Item,{label:t("CREATOR"),desc:t("DEVOPS_ADMIN_DESC")},g.default.createElement(p.Select,{name:"creator",options:this.getMembersOptions(),disabled:!0})),g.default.createElement(p.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:S.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},g.default.createElement(p.Input,{name:"aliasName",maxLength:63})),g.default.createElement(p.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},g.default.createElement(p.TextArea,{maxLength:256,name:"description"})))}}]),r}(g.default.Component),u.propTypes={detail:y.default.object,visible:y.default.bool,onOk:y.default.func,onCancel:y.default.func,isSubmitting:y.default.bool},u.defaultProps={visible:!1,isSubmitting:!1,detail:{},onOk:function(){},onCancel:function(){}},l=o))||l;a.default=O},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(58)),o=n(r(38));r(35);var c=n(r(39)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(824)),v=n(r(1)),E=r(189),y=n(r(798)),g=n(r(854)),b=n(r(26)),S=n(r(163)),_=n(r(330)),O=n(r(1432)),C=r(17),T=n(r(2590)),R=n(r(2591));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var I=function(e){(0,f.default)(r,e);var a=N(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(e=a.call.apply(a,[this].concat(l))).state={formTemplate:{},options:[],clusters:[],isLoading:!1},e.store=new _.default,e.cdStore=new O.default,e.formRef=m.default.createRef(),e.init=(0,c.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({isLoading:!0}),t.next=3,e.initFormTemplate();case 3:return t.next=5,e.fetchClusters();case 5:e.setState({isLoading:!1});case 6:case"end":return t.stop()}}),t)}))),e.fetchClusters=(0,c.default)(o.default.mark((function a(){var r,n;return o.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.cdStore.getClustersList();case 2:r=e.cdStore.clustersList.map((function(e){return{label:e.label,value:e.name,server:e.server}})),n={label:t("ALL"),value:"*",server:"*"},e.setState({clusters:[n].concat((0,u.default)(r))});case 5:case"end":return a.stop()}}),a)}))),e.initFormTemplate=function(){e.store.fetchDetail(k({},e.props)).then((function(){var t=(0,b.default)((0,C.toJS)(e.store.detail),"_originData.spec.argo",{});e.setState({formTemplate:{spec:{argo:t}}})}))},e.checkItemValid=function(e){return""!==e},e.sourceReposValidator=function(e,a,r){if(!a)return r();if(a.length>0){var n=[];a.forEach((function(e){return n.includes(e)?r({message:t("CODE_REPOSITORY_EXIST_DESC")}):e?void n.push(e):r({message:t("REPO_EMPTY_DESC")})}))}r()},e.destinationsValidator=function(e,a,r){if(!a)return r();if(a.length>0){var n=[];a.forEach((function(e){var a=n.find((function(t){return t.namespace===e.namespace&&t.cluster===e.name}));return(0,S.default)(a)?e.name&&!e.namespace?r({message:t("PROJECT_NOT_SELECT_DESC")}):void n.push({namespace:e.namespace,cluster:e.name}):r({message:t("DEPLOYMENT_LOCATION_EXIST_DESC")})}))}r()},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.init()}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.onOk,l=e.devops,u=e.cluster;return m.default.createElement(y.default.Form,{width:960,title:t("EDIT_ALLOWLIST"),data:this.state.formTemplate,onCancel:r,onOk:n,visible:a,formRef:this.formRef},this.state.isLoading?m.default.createElement(E.Loading,{spinning:this.state.isLoading},m.default.createElement(g.default,{desc:"NO_DATA"})):m.default.createElement(m.default.Fragment,null,m.default.createElement(E.Form.Item,{label:t("CODE_REPO_PL"),rules:[{validator:this.sourceReposValidator}]},m.default.createElement(h.default,{name:"spec.argo.sourceRepos",addText:t("ADD"),itemType:"string",checkItemValid:this.checkItemValid},m.default.createElement(R.default,{devops:l,cluster:u}))),m.default.createElement(E.Form.Item,{label:t("DEPLOYMENT_LOCATION_PL"),rules:[{validator:this.destinationsValidator}]},m.default.createElement(h.default,{name:"spec.argo.destinations",itemType:"object",addText:t("ADD")},m.default.createElement(T.default,{clusters:this.state.clusters,formtemplate:this.state.formTemplate})))))}}]),r}(m.default.Component);a.default=I,I.propTypes={formTemplate:v.default.object,visible:v.default.bool,isSubmitting:v.default.bool,onOk:v.default.func,onCancel:v.default.func},I.defaultProps={formTemplate:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(58)),u=n(r(38)),o=n(r(31));r(35);var c,s,i,f,d=n(r(39)),p=n(r(62)),m=n(r(25)),h=n(r(28)),v=n(r(74)),E=n(r(41)),y=n(r(42)),g=n(r(37)),b=n(r(45)),S=(n(r(63)),r(189)),_=n(r(841)),O=n(r(26)),C=n(r(67)),T=n(r(244)),R=n(r(68)),D=r(17),k=r(243),N=n(r(0)),I=n(r(441)),P=r(56),A=n(r(1433));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,g.default)(e);if(t){var n=(0,g.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,y.default)(this,a)}}var x={label:t("ALL"),value:"*",icon:"allowlist"},j=(0,k.observer)((s=function(e){(0,E.default)(n,e);var a,r=M(n);function n(){var e;(0,m.default)(this,n);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(e=r.call.apply(r,[this].concat(l))).projectStore=new I.default,e.state={formData:{}},(0,p.default)(e,"cluster",i,(0,v.default)(e)),e.fetchNamespaces=(0,d.default)(u.default.mark((function t(){var a,r,n=arguments;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.length>0&&void 0!==n[0]?n[0]:{},"*"!==(r=(0,P.inCluster2Default)(e.cluster))){t.next=6;break}e.projectStore.list.update({data:[],isLoading:!1}),t.next=9;break;case 6:if(!r||"*"===r){t.next=9;break}return t.next=9,e.projectStore.fetchList(L(L({cluster:r},a),{},{type:"user"}));case 9:case"end":return t.stop()}}),t)}))),e.projectOptionRenderer=function(e){return N.default.createElement("span",{className:A.default.option},e.isFedManaged?N.default.createElement("img",{className:A.default.indicator,src:"/extensions-static/ks-console-embed/dist/v3dist/assets/cluster.svg"}):N.default.createElement(S.Icon,{name:"project"}),e.label,e.isFedManaged&&N.default.createElement(S.Tooltip,{content:t("MULTI_CLUSTER_PROJECT_NOT_FOR_CD")},N.default.createElement(S.Icon,{className:A.default.tip,name:"question"})))},(0,p.default)(e,"handleClusterChange",f,(0,v.default)(e)),e.handleChange=function(t){e.props.onChange(L({},t))},e.checkDestinationsValid=function(e){return!(0,C.default)(e)&&e.name&&e.namespace&&e.server},e}return(0,h.default)(n,[{key:"componentDidMount",value:function(){this.init()}},{key:"init",value:(a=(0,d.default)(u.default.mark((function e(){var t,a,r,n,l,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.destinations[this.props.index]||{},a=t.name,r=t.namespace,!a){e.next=10;break}return l=this.clusters.find((function(e){return e.value===a}))||{},this.cluster=l.value,(0,R.default)(this.state.formData,"name",(0,O.default)(this.clusters,l.value)),(0,R.default)(this.state.formData,"server",(0,O.default)(this.clusters,l.server)),e.next=8,this.fetchNamespaces();case 8:o=this.namespaces.find((function(e){return e.value===r})),(0,R.default)(this.state.formData,"namespace",null!==(n=null==o?void 0:o.value)&&void 0!==n?n:"");case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e,a=this.props.value;return N.default.createElement(_.default,{value:a,onChange:this.handleChange},N.default.createElement(S.Select,{name:"name",key:null===(e=this.props.value)||void 0===e?void 0:e.name,placeholder:t("CLUSTER"),options:this.clusters,onChange:this.handleClusterChange,prefixIcon:N.default.createElement(S.Icon,{name:"cluster",size:16}),showTip:!0}),N.default.createElement(S.Select,{name:"namespace",placeholder:t("PROJECT"),options:this.namespaces,pagination:(0,T.default)(this.projectStore.list,["page","limit","total"]),isLoading:this.projectStore.list.isLoading,onFetch:this.fetchNamespaces,valueRenderer:this.projectOptionRenderer,optionRenderer:this.projectOptionRenderer,searchable:!0}))}},{key:"clusters",get:function(){return this.props.clusters.map((function(e){return L(L({},e),{},{label:N.default.createElement("span",null,(0,P.showNameAndAlias)(e.label,"cluster"))})}))}},{key:"destinations",get:function(){return(0,O.default)(this.props.formtemplate,"spec.argo.destinations",[])}},{key:"namespaces",get:function(){var e=this.projectStore.list.data.filter((function(e){return"Terminating"!==e.status})).map((function(e){return{label:(0,P.showNameAndAlias)(e),value:e.name,disabled:e.isFedManaged,isFedManaged:e.isFedManaged}}));return this.cluster?[x].concat((0,l.default)(e)):e}}]),n}(N.default.Component),i=(0,b.default)(s.prototype,"cluster",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),(0,b.default)(s.prototype,"clusters",[D.computed],Object.getOwnPropertyDescriptor(s.prototype,"clusters"),s.prototype),f=(0,b.default)(s.prototype,"handleClusterChange",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,d.default)(u.default.mark((function t(a){var r,n;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.cluster=a,t.next=3,e.fetchNamespaces();case 3:r=e.clusters.find((function(e){return e.value===a})).server,n=e.namespaces[0].value,e.props.onChange({name:a,server:r,namespace:n});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),c=s))||c;a.default=j},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(38)),u=n(r(58)),o=n(r(31));r(35);var c=n(r(39)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=r(189),h=n(r(244)),v=n(r(0)),E=n(r(1054)),y=n(r(1433));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=function(e){(0,f.default)(r,e);var a=S(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=a.call.apply(a,[this].concat(o))).codeStore=new E.default,e.state={options:[]},e.getRepoList=function(){var a=(0,c.default)(l.default.mark((function a(r){var n,o,c,s,i;return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.props,o=n.devops,c=n.cluster,a.next=3,e.codeStore.fetchList(b({devops:o,cluster:c},r));case 3:s=e.codeStore.list.data.map((function(e){return{label:e.name,value:e.repoURL,icon:"bitbucket_server"===e.provider?"bitbucket":e.provider}})),i={label:t("ALL"),value:"*",icon:"allowlist"},e.setState({options:[i].concat((0,u.default)(s))});case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.repoOptionRenderer=function(e){return function(t){return v.default.createElement("span",{className:y.default.option},!!e.icon&&v.default.createElement(m.Icon,{name:e.icon,type:"value"===t?"dark":"light"}),e.label,"*"===e.value?"":" (".concat(e.value,")"))}},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.getRepoList()}},{key:"render",value:function(){var e=this,t=this.props,a=t.value,r=t.index;return v.default.createElement(m.Select,{value:a,key:r,style:{maxWidth:"100%"},placeholder:" ",options:this.state.options,pagination:(0,h.default)(this.codeStore.list,["page","limit","total"]),isLoading:this.codeStore.list.isLoading,onFetch:this.getRepoList,valueRenderer:function(t){return e.repoOptionRenderer(t)("value")},optionRenderer:function(t){return e.repoOptionRenderer(t)("option")},clearable:!0,searchable:!0,onChange:this.props.onChange})}}]),r}(v.default.Component);a.default=_},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(191)),u=n(r(798)),o=n(r(822)),c={"edgeNode.unbound.nodeGroup":{on:function(e){var a=e.resource,r=e.params,n=e.store,c=e.success,s=u.default.open({onOk:function(){n.removeNodeGroupEdgeNode(r).then((function(){l.default.success({content:t("UNBOUND_NODE_GROUP_SUCCESSFULLY")}),u.default.close(s),c&&c()}))},store:n,modal:o.default,resource:a,title:t("UNBOUND_NODE_GROUP"),desc:t.html("UNBOUND_EDGE_NODE_GROUP_TIP",{resource:a,nodegroup:r.nodegroup})})}}};a.default=c},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(70),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(70),r(36),r(66),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(798)),f=n(r(822)),d=n(r(1177)),p=n(r(2594)),m=n(r(2596)),h=n(r(119)),v=n(r(26)),E=n(r(67)),y=n(r(68)),g=n(r(850)),b=n(r(196)),S=r(17),_=n(r(450)),O=n(r(441)),C=r(56),T=n(r(2614)),R=n(r(438)),D=n(r(2615));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var I={"federated.baseinfo.edit":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,f=e.projectStore,p=(0,c.default)(e,["store","detail","success","projectStore"]),m=i.default.open(N({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=a,c={metadata:(0,h.default)((0,v.default)(a,"metadata"))},(0,y.default)(a,'spec.template.metadata.annotations["kubesphere.io/alias-name"]',(0,v.default)(a,'metadata.annotations["kubesphere.io/alias-name"]')),(0,C.updateFederatedAnnotations)(a),e.next=6,f.patch({workspace:n.workspace,name:n.name},c);case 6:r.patch(n,u).then((function(){i.default.close(m),s.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o()}));case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),detail:n,modal:d.default,store:r},p))}},"federated.project.create":{on:function(e){var a,r=e.store,n=e.success,o=e.cluster,f=e.workspace,d=e.clusters,m=(0,c.default)(e,["store","success","cluster","workspace","clusters"]),E=i.default.open(N({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,y.default)(a,'metadata.annotations["kubesphere.io/creator"]',globals.user.username),(0,y.default)(a,'metadata.labels["kubesphere.io/workspace"]',f),u=(0,g.default)((0,v.default)(a,"spec.placement.clusters",[]).filter((function(e){return e.name})),"name"),o=new _.default(r),(0,y.default)(a,"spec.placement.clusters",u),c=(0,h.default)(a),(0,y.default)(c,'metadata.labels["kubesphere.io/kubefed-host-namespace"]',"true"),(0,y.default)(c,'metadata.labels["kubefed.io/managed"]',"false"),(0,b.default)(c,"spec.placement"),e.next=11,r.create(c,{workspace:f});case 11:return e.next=13,o.create(T.default.namespaces(a),{namespace:(0,v.default)(a,"metadata.name")});case 13:i.default.close(E),s.default.success({content:t("CREATE_SUCCESSFUL")}),n&&n();case 16:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),cluster:o,workspace:f,clusters:d,formTemplate:R.default.project(),modal:p.default,store:r},m))}},"federated.project.delete":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=new O.default,o=i.default.open(N({onOk:function(){u.delete({name:r.name}).then((function(){i.default.close(o),s.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n()}))},store:a,modal:f.default,resource:r.name,type:"MULTI_CLUSTER_PROJECT",isLoading:u.isLoading},l))}},"federated.project.delete.batch":{on:function(e){var a,r=e.store,n=e.success,o=e.rowKey,d=(0,c.default)(e,["store","success","rowKey"]),p=new O.default,m=r.list,h=m.data,v=m.selectedRowKeys,E=h.filter((function(e){return v.includes(e[o])})).map((function(e){return e.name})),y=i.default.open(N({onOk:(a=(0,u.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],h.forEach((function(e){E.includes(e.name)&&a.push(p.delete({name:e.name}))})),e.next=4,Promise.all(a);case 4:i.default.close(y),s.default.success({content:t("DELETED_SUCCESSFULLY")}),r.setSelectRowKeys([]),n&&n();case 8:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),resource:E.join(", "),modal:f.default,store:r,isLoading:p.isLoading},d))}},"federated.workload.template.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=e.module,u=e.supportGpuSelect,o=void 0!==u&&u,f=(0,c.default)(e,["store","detail","success","module","supportGpuSelect"]),d=i.default.open(N({onOk:function(e){var l=(0,v.default)(e,"spec.overrides",[]);(0,C.multiCluster_overrides_Dot)(l);var u=(0,v.default)(e,"spec.template.spec.customMode",{});(0,E.default)(u)||delete e.spec.template.spec.customMode,a.update(r,e).then((function(){s.default.success({content:t("UPDATE_SUCCESSFUL")}),i.default.close(d),n&&n()}))},store:a,module:l||a.module,detail:(0,S.toJS)(r._originData),modal:m.default,type:r.type,workloadStore:a,isEdit:!0,supportGpuSelect:o,hideVolumeSetting:"statefulsets"===a.module},f))}},"federated.project.add.cluster":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=i.default.open(N({onOk:function(e){a.patch(r,e).then((function(){s.default.success({content:t("UPDATE_SUCCESSFUL")}),i.default.close(u),n&&n()}))},store:a,formTemplate:(0,S.toJS)(r._originData),modal:D.default},l))}}};a.default=I},function(e,a,r){"use strict";r(16);var n=r(19);r(199),r(36),r(20),r(14),r(8),r(4),r(21),r(18),r(11),r(46),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(199),r(36),r(20),r(29),r(14),r(8),r(4),r(21),r(18),r(43),r(11),r(46),r(40);var l=n(r(31)),u=n(r(38)),o=n(r(58));r(35);var c,s,i,f,d=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=n(r(45)),g=r(189),b=n(r(798)),S=n(r(846)),_=n(r(824)),O=n(r(841)),C=n(r(26)),T=n(r(67)),R=n(r(68)),D=n(r(850)),k=r(17),N=r(243),I=n(r(1)),P=n(r(0)),A=r(61),w=n(r(2595));function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var M=(0,N.observer)((f=i=function(e){(0,h.default)(r,e);var a=L(r);function r(e){var n;return(0,p.default)(this,r),(n=a.call(this,e)).nameValidator=function(){var e=(0,d.default)(u.default.mark((function e(a,r,l){var c,s,i;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",l());case 2:return e.next=4,n.store.checkName({name:r});case 4:if(!e.sent.exist){e.next=7;break}return e.abrupt("return",l({message:t("PROJECT_NAME_EXISTS_IN_HOST"),field:a.field}));case 7:return c=(0,C.default)(n.props.formTemplate,"spec.placement.clusters",[]),e.next=10,Promise.all((0,o.default)(c.map((function(e){return n.store.checkName({name:r,cluster:e.name})}))));case 10:if(s=e.sent,!((i=s.findIndex((function(e){return e.exist})))>-1&&c[i])){e.next=14;break}return e.abrupt("return",l({message:t("PROJECT_NAME_EXISTS_IN_CLUSTER",{cluster:c[i].name}),field:a.field}));case 14:l();case 15:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),n.valueRenderer=function(e){return P.default.createElement(S.default,{cluster:e.cluster,size:"small",noStatus:!0})},n.optionRenderer=function(e){return P.default.createElement(S.default,{cluster:e.cluster,size:"small",theme:"light",noStatus:!0})},n.handleClusterChange=function(e){if((0,R.default)(n.props.formTemplate,"spec.placement.clusters",(0,D.default)(e,"name")),n.nameRef&&n.nameRef.current){var t="metadata.name";n.formRef&&n.formRef.current&&!(0,T.default)(n.formRef.current.state.errors)&&n.formRef.current.resetValidateResults(t),n.nameRef.current.validate((0,l.default)({},t,(0,C.default)(n.props.formTemplate,t)))}},n.store=e.store,n.formRef=P.default.createRef(),n.nameRef=P.default.createRef(),n}return(0,m.default)(r,[{key:"renderClusters",value:function(){return P.default.createElement(g.Form.Group,{label:t("CLUSTER_PL"),desc:t("PROJECT_CLUSTER_SETTINGS_DESC")},P.default.createElement(g.Form.Item,{rules:[{required:!0,message:t("CLUSTER_EMPTY_DESC")}]},P.default.createElement(_.default,{name:"spec.placement.clusters",addText:t("ADD_CLUSTER"),itemType:"object",onChange:this.handleClusterChange},P.default.createElement(O.default,null,P.default.createElement(g.Select,{name:"name",placeholder:" ",className:w.default.cluster,options:this.clusters,valueRenderer:this.valueRenderer,optionRenderer:this.optionRenderer,showTip:!0})))))}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.formTemplate,n=e.onOk,l=e.onCancel,u=e.isSubmitting;return P.default.createElement(b.default.Form,{width:960,formRef:this.formRef,bodyClassName:w.default.body,data:r,onCancel:l,onOk:n,visible:a,closable:!1,isSubmitting:u,hideHeader:!0},P.default.createElement("div",{className:w.default.header},P.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/project-create.svg",alt:""}),P.default.createElement("div",{className:w.default.title},P.default.createElement("div",null,t("CREATE_MULTI_CLUSTER_PROJECT")),P.default.createElement("p",null,t("CREATE_MULTI_CLUSTER_PROJECT_DESC")))),P.default.createElement("div",{className:w.default.content},P.default.createElement(g.Columns,null,P.default.createElement(g.Column,null,P.default.createElement(g.Form.Item,{label:t("NAME"),desc:t("SERVICE_NAME_DESC"),ref:this.nameRef,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:A.PATTERN_SERVICE_NAME,message:t("INVALID_NAME_DESC",{message:t("SERVICE_NAME_DESC")})},{validator:this.nameValidator}]},P.default.createElement(g.Input,{name:"metadata.name",autoFocus:!0,maxLength:63}))),P.default.createElement(g.Column,null,P.default.createElement(g.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:A.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},P.default.createElement(g.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),P.default.createElement(g.Columns,null,P.default.createElement(g.Column,null,P.default.createElement(g.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},P.default.createElement(g.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256}))),P.default.createElement(g.Column,null)),this.renderClusters()))}},{key:"networkOptions",get:function(){return[{label:t("OFF"),value:""},{label:t("ON"),value:"enabled"}]}},{key:"clusters",get:function(){return this.props.clusters.map((function(e){return{label:e.name,value:e.name,cluster:e,disabled:!e.isReady}}))}}]),r}(P.default.Component),i.propTypes={formTemplate:I.default.object,visible:I.default.bool,isSubmitting:I.default.bool,clusters:I.default.array,onOk:I.default.func,onCancel:I.default.func},i.defaultProps={formTemplate:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},s=f,(0,y.default)(s.prototype,"clusters",[k.computed],Object.getOwnPropertyDescriptor(s.prototype,"clusters"),s.prototype),c=s))||c;a.default=M},function(e,t,a){e.exports={body:"_2YFT-UtUl19RnIcDCBLrSX",header:"_2cYVq3DxoJtlCWF7n20jG",title:"_3JeOv7o2Iknp2JVawu8F0D",content:"_3FxY_7mBEqpROSZi3lNiqU",cluster:"ZBb_XLUwlhmbTirefNnWq",toolmessage:"_2Zd1xHbMCz9tv6jdf1MAn2"}},function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(50)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=r(a(1)),p=r(a(1008)),m=r(a(2600));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(a,e);var t=h(a);function a(){return(0,u.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.module,a=(0,l.default)(e,["module"]);return f.default.createElement(p.default,(0,n.default)({title:"EDIT_SETTINGS",icon:"storage",module:t,forms:this.forms},a))}},{key:"forms",get:function(){return m.default[this.props.module]}}]),a}(f.default.Component);t.default=v,v.propTypes={module:d.default.string},v.defaultProps={module:"deployments"}},,,,function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1435)),l=r(a(1436)),u=r(a(1437)),o=r(a(1438)),c=r(a(2601)),s=r(a(2609)),i=r(a(1439)),f={deployments:[{icon:"dashboard",name:"updateStrategy",title:"UPDATE_STRATEGY",component:u.default},{icon:"container",name:"podTemplate",title:"CONTAINER_PL",component:l.default},{icon:"storage",name:"volumeSettings",title:"STORAGE",component:o.default},{icon:"group",name:"deploymentMode",title:"POD_SCHEDULING_RULES",component:n.default},{icon:"forbid-right-duotone",name:"podMode",title:"POD_GRACE_PERIOD",component:i.default},{title:"CLUSTER_DIFF",icon:"blue-green-deployment",name:"Diff Settings",component:c.default}],statefulsets:[{icon:"dashboard",name:"updateStrategy",title:"UPDATE_STRATEGY",component:u.default},{icon:"container",name:"podTemplate",title:"CONTAINER_PL",component:l.default},{icon:"forbid-right-duotone",name:"podMode",title:"POD_GRACE_PERIOD",component:i.default},{icon:"storage",name:"volumeSettings",title:"STORAGE",component:o.default},{title:"CLUSTER_DIFF",icon:"blue-green-deployment",name:"Diff Settings",component:c.default}],service:[{icon:"network-router",name:"editService",title:"SERVICE_SETTINGS",component:s.default},{title:"CLUSTER_DIFF",icon:"blue-green-deployment",name:"Diff Settings",component:c.default}]};t.default=f},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(6),r(70),r(20),r(14),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(6),r(70),r(20),r(27),r(29),r(14),r(4),r(18),r(43),r(11),r(73),r(7);var l=n(r(317)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=n(r(67)),m=n(r(326)),h=n(r(68)),v=r(61),E=r(189),y=n(r(1131)),g=n(r(1329)),b=n(r(1332)),S=n(r(1335)),_=n(r(1337)),O=n(r(1338)),C=n(r(2602)),T=n(r(2604)),R=n(r(1129)),D=n(r(2606));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var N=function(e){(0,c.default)(r,e);var a=k(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleLocal=function(t){e.formTemplate.spec.overrides.map((function(e){return t.includes(e.clusterName)||(0,p.default)(e.clusterOverrides)||(e.clusterOverrides=[]),e}));var a=[];t.forEach((function(e){a.push({name:e})})),(0,h.default)(e.formTemplate,"spec.placement.clusters",a)},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.formRef,n=a.projectDetail,u=a.withService,o=a.formProps,c=a.module,s=a.isEdit,i=a.workspace,p=(0,m.default)(n.clusters,"name");return f.default.createElement("div",null,f.default.createElement(E.Form,(0,l.default)({data:this.formTemplate,ref:r},o),f.default.createElement(E.Form.Group,{label:t("CLUSTER")},f.default.createElement(E.Form.Item,null,f.default.createElement(R.default,{name:"clusters",options:this.clustersOption,defaultValue:this.defaultClusters,onChange:this.handleLocal}))),"service"===c&&s?null:f.default.createElement(E.Form.Group,{label:t("CONTAINER_IMAGE"),desc:t("CLUSTER_DIFF_CONTAINER_SETTINGS_DESC"),checkable:!0},f.default.createElement(y.default,{clusters:this.clusters,clustersDetail:p,namespace:this.namespace},(function(t){return f.default.createElement(g.default,(0,l.default)({formTemplate:e.formTemplate},t,o),(function(e){return f.default.createElement(D.default,(0,l.default)({isEdit:s},e,{workspace:i}))}))}))),this.showVolumeTemplate&&f.default.createElement(E.Form.Group,{label:t("VOLUME_TEMPLATE_SETTINGS"),desc:t("CLUSTER_VOLUME_DIFF_DESC"),checkable:!0},f.default.createElement(y.default,{clusters:this.clusters,clustersDetail:p,namespace:this.namespace},(function(t){return f.default.createElement(_.default,(0,l.default)({formTemplate:e.formTemplate},t),(function(e){return f.default.createElement(O.default,e)}))}))),f.default.createElement(E.Form.Group,{label:t("PORT_SETTINGS"),desc:t("CLUSTER_DIFF_PORT_SETTINGS_DESC"),checkable:!0},f.default.createElement(y.default,{clusters:this.clusters,clustersDetail:p,namespace:this.namespace},"service"===c&&s?function(t){return f.default.createElement(C.default,(0,l.default)({formTemplate:e.formTemplate,withService:u},t,o),(function(e){return f.default.createElement(T.default,e)}))}:function(t){return f.default.createElement(g.default,(0,l.default)({formTemplate:e.formTemplate,withService:u,serviceTemplate:(0,d.default)(e.props.formTemplate,"Service")},t,o),(function(e){return f.default.createElement(b.default,e)}))})),"service"===c&&s?null:f.default.createElement(E.Form.Group,{label:t("ENVIRONMENT_VARIABLE_PL"),desc:t("CLUSTER_DIFF_ENVIRONMENT_VARIABLES_DESC"),checkable:!0},f.default.createElement(y.default,{clusters:this.clusters,clustersDetail:p,namespace:this.namespace},(function(t){return f.default.createElement(g.default,(0,l.default)({formTemplate:e.formTemplate},t,o),(function(e){return f.default.createElement(S.default,e)}))})))))}},{key:"namespace",get:function(){return(0,d.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,v.MODULE_KIND_MAP[a],t)}},{key:"clusters",get:function(){return(0,d.default)(this.formTemplate,"spec.placement.clusters",[])}},{key:"clustersOption",get:function(){var e=this.props.projectDetail.clusters,t=[];return e.forEach((function(e){t.push({name:e.name,value:e.name,provider:e.provider})})),t}},{key:"showVolumeTemplate",get:function(){return"statefulsets"===this.props.module&&(0,d.default)(this.formTemplate,"spec.template.spec.volumeClaimTemplates")}},{key:"defaultClusters",get:function(){return(0,d.default)(this.formTemplate,"spec.placement.clusters",[]).map((function(e){return e.name}))}}]),r}(f.default.Component);a.default=N},function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(3),a(10),a(44),a(6),a(20),a(14),a(8),a(13),a(9),a(4),a(18),a(11),a(79),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(3),a(10),a(44),a(6),a(20),a(27),a(29),a(14),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(79),a(7);var l=n(a(31)),u=n(a(58)),o=n(a(25)),c=n(a(28)),s=n(a(41)),i=n(a(42)),f=n(a(37)),d=n(a(26)),p=n(a(68)),m=n(a(67)),h=n(a(850)),v=n(a(64)),E=r(a(0)),y=n(a(5)),g=n(a(2603));function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var O=function(e){(0,s.default)(a,e);var t=_(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={editContainer:""},e.showEdit=function(t){var a=e.props,r=a.onSelect,n=a.cluster;e.setState({editContainer:t.clusterName},(function(){r(n)}))},e.handleEdit=function(t){var a=t.data,r=e.props,n=r.cluster,l=r.formTemplate,o=r.onChange,c=[];a.ports.forEach((function(e){e.servicePort&&c.push({name:e.name,protocol:e.protocol,port:e.servicePort,targetPort:e.containerPort})}));var s=[{path:"/spec/ports",value:c}],i=(0,d.default)(l,"spec.overrides",[]),f=i.find((function(e){return e.clusterName===n}));f?f.clusterOverrides=(0,h.default)([].concat(s,(0,u.default)(f.clusterOverrides||[])),"path"):i.push({clusterName:n,clusterOverrides:s}),(0,p.default)(l,"spec.overrides",i),e.setState({editContainer:""}),o()},e.renderContainer=function(t){var a=e.props,r=a.children,n=a.selected,u=e.state.editContainer;return E.default.createElement("div",{key:t.name,className:(0,y.default)(g.default.wrapper,(0,l.default)({},g.default.selected,n))},r(S(S({},e.props),{},{containerType:"worker",formData:t,isEdit:u===t.clusterName,showEdit:e.showEdit,onEdit:e.handleEdit})))},e}return(0,c.default)(a,[{key:"getContainer",value:function(e){var t=this.props,a=t.cluster,r=t.formTemplate,n=(0,d.default)(r,"spec.overrides",[]).find((function(e){return e.clusterName===a}))||{},l={path:"/spec/ports",value:e};n&&!(0,m.default)(n.clusterOverrides)&&n.clusterOverrides.forEach((function(e){if(e&&e.path.startsWith("/spec/ports")){var t=e.value;!(0,m.default)(t)&&(0,v.default)(t)||(t=(0,d.default)(r,"spec.template.spec.ports")),(0,p.default)(l,"value",t)}}));var u=l.value.map((function(e){return{name:e.name,protocol:e.protocol,servicePort:e.port,containerPort:e.targetPort}}));return{clusterName:a,ports:u}}},{key:"render",value:function(){var e=this.props.formTemplate,t=(0,d.default)(e,"spec.template.spec.ports",[]),a=this.getContainer(t);return E.default.createElement(E.default.Fragment,null,this.renderContainer(a,"worker"))}}]),a}(E.Component);t.default=O},function(e,t,a){e.exports={wrapper:"_10qAPtNu0wFuyojJ9ol8zs",selected:"gG0AbN0FtgLTYXYx6Uk00"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(244)),m=l(r(957)),h=l(r(994)),v=l(r(2605));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var y=function(e){(0,s.default)(r,e);var a=E(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleSubmit=function(t){var a=e.props,r=a.index,n=a.containerType;(0,a.onEdit)({index:r,containerType:n,data:(0,p.default)(t,["ports"])})},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formData,r=e.containerType,n=e.withService,l="init"!==r&&n,o=d.default.createElement(d.default.Fragment,null,a.ports&&a.ports.map((function(e,a){return d.default.createElement("div",{key:a,className:v.default.port},d.default.createElement("span",null,"".concat(t("PROTOCOL"),": ").concat(e.protocol)),d.default.createElement("span",null,"".concat(t("NAME"),": ").concat(e.name)),d.default.createElement("span",null,"".concat(t("CONTAINER_PORT"),": ").concat(e.containerPort)),l&&d.default.createElement("span",null,"".concat(t("SERVICE_PORT"),": ").concat(e.servicePort)))})));return d.default.createElement(m.default,(0,u.default)({},this.props,{title:o,onOk:this.handleSubmit}),d.default.createElement(h.default,{withService:"init"!==r&&n}))}}]),r}(d.Component);a.default=y},function(e,t,a){e.exports={port:"_1BuMHNg2pwGj5c5dHEdMpg"}},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(6),r(36),r(8),r(13),r(9),r(4),r(21),r(18),r(11),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(36),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(46),r(7),r(40);var u,o,c,s=n(r(317)),i=n(r(31)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=l(r(0)),E=n(r(26)),y=n(r(140)),g=n(r(993)),b=n(r(163)),S=n(r(1)),_=r(243),O=r(17),C=n(r(874)),T=n(r(888)),R=r(56),D=r(249),k=n(r(957)),N=n(r(447)),I=n(r(2607));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var L=(0,_.observer)((c=o=function(e){(0,p.default)(r,e);var a=w(r);function r(e){var t;return(0,f.default)(this,r),(t=a.call(this,e)).handleSubmit=function(e){var a=t.props,r=a.index,n=a.containerType;(0,a.onEdit)({index:r,containerType:n,data:(0,y.default)(e,"type")})},t.quotaStore=new C.default,t.workspaceQuotaStore=new T.default,t.imageRegistryStore=new N.default,t.state={availableQuota:{},imageRegistries:[],imageDetail:{}},t}return(0,d.default)(r,[{key:"getChildContext",value:function(){var e=this;return{imageDetail:this.state.imageDetail,setImageDetail:function(t){e.setState({imageDetail:t})}}}},{key:"componentDidMount",value:function(){this.fetchQuota(),this.fetchImageSecret()}},{key:"fetchImageSecret",value:function(){var e=this,t=this.props,a=t.cluster,r=t.namespace;this.imageRegistryStore.fetchListByK8s({cluster:a,namespace:r,fieldSelector:"type=kubernetes.io/dockerconfigjson"}).then((function(t){e.setState({imageRegistries:t})}))}},{key:"fetchQuota",value:function(){var e=this,t=this.props,a=t.cluster,r=t.workspace,n=t.namespace;r&&n&&Promise.all([this.quotaStore.fetch({cluster:a,namespace:n}),this.workspaceQuotaStore.fetchDetail({name:r,workspace:r,cluster:a})]).then((function(){var t=(0,O.toJS)(e.quotaStore.data.hard),a=(0,D.getLeftQuota)((0,E.default)(e.workspaceQuotaStore.detail,"status.total"),e.quotaStore.data),r=a.namespace,n=a.workspace;e.setState({availableQuota:{workspace:n,namespace:A(A({},r),(0,y.default)(t,R.resourceLimitKey))}})}))}},{key:"render",value:function(){var e=this.props,a=e.cluster,r=e.namespace,n=e.formData,l=e.containerType,u=e.isEdit,o=(0,E.default)(n,"resources"),c=this.state.imageRegistries;return v.default.createElement(k.default,(0,s.default)({},this.props,{title:v.default.createElement("span",null,"".concat(t("IMAGE"),": ").concat(n.image)),onOk:this.handleSubmit}),v.default.createElement(I.default,{data:n,cluster:a,namespace:r,limitRanges:o,defaultContainerType:l,workspaceQuota:this.workspaceQuota,isEdit:u,imageRegistries:c}))}},{key:"workspaceQuota",get:function(){var e=(0,E.default)(this.state.availableQuota,"namespace",{}),t=(0,E.default)(this.state.availableQuota,"workspace",{});return(0,g.default)(e,t,(function(e,t){if(e||t)return(0,b.default)(e)?t:e<t?e:t}))}}]),r}(v.Component),o.childContextTypes={imageDetail:S.default.object,setImageDetail:S.default.func},u=c))||u;a.default=L},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(56),d=r(61),p=r(189),m=n(r(67)),h=n(r(26)),v=n(r(843)),E=n(r(899)),y=n(r(1132)),g=n(r(2608));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var S=function(e){(0,o.default)(r,e);var a=b(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"getGpuLimit",value:function(){return(0,f.gpuLimitsArr)(this.workspaceQuota)}},{key:"renderAdvancedSettings",value:function(){var e=this.props,a=e.defaultContainerType,r=e.onContainerTypeChange,n=e.isEdit,l=this.defaultResourceLimit;return i.default.createElement(E.default,{defaultShow:!0},i.default.createElement(i.default.Fragment,null,i.default.createElement(p.Columns,{className:g.default.columns},i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("CONTAINER_NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:d.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("NAME_DESC")})}]},i.default.createElement(p.Input,{name:"name",defaultValue:"container-".concat((0,f.generateId)()),maxLength:63}))),i.default.createElement(p.Column,null,i.default.createElement(p.Form.Item,{label:t("CONTAINER_TYPE")},i.default.createElement(p.Select,{name:"type",defaultValue:a,options:this.containerTypes,onChange:r,valueRenderer:this.valueRenderer})))),i.default.createElement(p.Alert,{className:"margin-b12",type:"info",message:t("CONTAINER_RESOURCE_LIMIT_TIP")}),i.default.createElement(p.Form.Item,{rules:[{validator:this.limitValidator,checkOnSubmit:!0}]},i.default.createElement(v.default,{name:"resources",defaultValue:l,onError:this.handleError,isEdit:n,supportGpuSelect:!0,workspaceLimitProps:this.workspaceLimitProps}))))}},{key:"defaultResourceLimit",get:function(){var e=this.props.limitRanges,t=void 0===e?{}:e;if(t.limits||t.requests)return{requests:t.requests||{},limits:t.limits||{}}}},{key:"workspaceLimitProps",get:function(){var e=this.props.workspaceQuota;return(0,m.default)(e)?{}:{limits:{cpu:(0,h.default)(e,"limits.cpu"),memory:(0,h.default)(e,"limits.memory")},requests:{cpu:(0,h.default)(e,"requests.cpu"),memory:(0,h.default)(e,"requests.memory")},gpuLimit:this.getGpuLimit()}}}]),r}(y.default);a.default=S},function(e,t,a){e.exports={message:"_2tYIfpBit4wZxAd9FJxE6y",imageSearch:"WP6XS0i1_qs6HdOBtnh2d",columns:"_3ZMZ7kB3ERXUvc6BlRfr7D",type:"_1z31teCRLbXGZmM73L340N"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(1153)),m=r(61),h=n(r(2610)),v=n(r(2613));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).handleOk=function(){var t=e.props,a=t.onSave,r=t.store,n=t.detail,l=e.context.resetSubRoute,u=e.formRef.current,o=r.list,c=(0,d.toJS)(o.selectedRowKeys).filter((function(e){return e!==n.uid}));u&&u.validate((function(){a(u.getData()),o.setSelectRowKeys(c)})),l&&l()},e.handleCancel=function(){(0,e.props.onCancel)()},e}return(0,u.default)(r,[{key:"renderServiceSettings",value:function(){var e=this.props,t=e.cluster,a=e.formRef,r=e.isFederated,n=e.formProps,l=e.formTemplate,u=e.type;return i.default.createElement(h.default,{formRef:a,formTemplate:l,cluster:t,isFederated:r,formProps:n,type:m.SERVICE_TYPES_VALUE[u]})}},{key:"renderExternalName",value:function(){var e=this.props,t=e.formRef,a=e.formTemplate;return i.default.createElement(p.default,{formRef:t,formTemplate:a})}},{key:"renderEmpty",value:function(){return i.default.createElement("p",{className:v.default.empty},t("UNKNOWN_SERVICE_TYPE"))}},{key:"renderForm",value:function(){var e=null;switch(this.props.type){case m.SERVICE_TYPES.VirtualIP:case m.SERVICE_TYPES.Headless:e=this.renderServiceSettings();break;case m.SERVICE_TYPES.ExternalName:e=this.renderExternalName();break;default:e=this.renderEmpty()}return e}},{key:"render",value:function(){return i.default.createElement("div",null,this.renderForm())}}]),r}(i.default.Component);a.default=y,y.propTypes={type:f.default.string,formTemplate:f.default.object,onSave:f.default.func,onCancel:f.default.func},y.defaultProps={type:"",formTemplate:{},onSave:function(){},onCancel:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(827));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(r,e);var a=p(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"renderTypeSelect",value:function(){return i.default.createElement(f.Form.Item,{label:t("INTERNAL_ACCESS_MODE")},i.default.createElement(d.default,{className:"margin-b12",value:this.state.serviceType,onChange:this.handleTypeChange,options:this.types,disabled:!0}))}}]),r}(n(r(2611)).default);a.default=m},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(6),r(70),r(14),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(6),r(70),r(27),r(29),r(14),r(4),r(18),r(43),r(30),r(195),r(11),r(7);var l=n(r(317)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(26)),d=n(r(68)),p=n(r(196)),m=n(r(67)),h=n(r(0)),v=r(189),E=n(r(827)),y=n(r(824)),g=n(r(1155)),b=r(56),S=r(61),_=n(r(1373)),O=n(r(2612));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var T=function(e){(0,c.default)(r,e);var a=C(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).state={serviceType:"virtualIP"},e.handleTypeChange=function(t){e.setState({serviceType:t},(function(){"virtualIP"===t?(0,p.default)(e.formTemplate,"spec.clusterIP"):(0,d.default)(e.formTemplate,"spec.clusterIP","None")}))},e.handleLabelsChange=function(t){var a=e.props.formTemplate;(0,d.default)(a,"metadata.labels",t),(0,d.default)(a,'metadata.annotations["kubesphere.io/workloadName"]',"".concat(t.app,"-").concat(t.version))},e.portsValidator=function(e,a,r){if(!a)return r();if(a.length>0){var n=[];a.forEach((function(e){return e.name&&e.port?n.includes(e.name)?r({message:t("PORT_INPUT_DESC")}):e.name&&(e.name.length>63||!S.PATTERN_PORT_NAME.test(e.name))?r({message:t("PORT_NAME_DESC")}):void n.push(e.name):r({message:t("INVALID_PORT")})}))}r()},e.labelsValidator=function(e,a,r){return a?(0,m.default)(a)?r({message:t("ENTER_SELECTOR_TIP")}):(0,b.isValidLabel)(a)?r():r({message:t("LABEL_FORMAT_DESC")}):r()},e}return(0,o.default)(r,[{key:"renderTypeSelect",value:function(){return h.default.createElement(v.Form.Item,{label:t("INTERNAL_ACCESS_MODE")},h.default.createElement(E.default,{className:"margin-b12",value:this.state.serviceType,onChange:this.handleTypeChange,options:this.types}))}},{key:"renderLabelSelector",value:function(){var e=this.props.isFederated;return h.default.createElement(v.Form.Item,{label:t("WORKLOAD_SELECTOR"),rules:[{required:!0,message:t("ENTER_SELECTOR_TIP")},{validator:this.labelsValidator}]},h.default.createElement(_.default,{name:e?"spec.template.spec.selector":"spec.selector",cluster:this.props.cluster,namespace:this.namespace,addText:t("ADD"),isFederated:e,onChange:this.handleLabelsChange}))}},{key:"renderPorts",value:function(){var e=this.props.isFederated;return h.default.createElement(v.Form.Group,{label:t("PORT_PL"),desc:t("SERVICE_PORTS_DESC")},h.default.createElement(v.Form.Item,{rules:[{required:!0,message:t("PORT_EMPTY")},{validator:this.portsValidator,checkOnSubmit:!0}]},h.default.createElement(y.default,{name:e?"spec.template.spec.ports":"spec.ports",itemType:"object",addText:t("ADD_PORT")},h.default.createElement(g.default,null))))}},{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formProps;return h.default.createElement("div",{className:O.default.wrapper},h.default.createElement(v.Form,(0,l.default)({data:this.formTemplate,ref:t},a),this.renderTypeSelect(),this.renderLabelSelector(),this.renderPorts()))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,f.default)(t,S.MODULE_KIND_MAP[a],t)}},{key:"namespace",get:function(){return(0,f.default)(this.formTemplate,"metadata.namespace")}},{key:"types",get:function(){return[{icon:"cluster",label:t("VIRTUAL_IP_TITLE"),description:t("VIRTUAL_IP_DESC"),value:"virtualIP"},{icon:"blockchain",label:t("INTERNAL_DOMAIN_NAME"),description:t("INTERNAL_DOMAIN_NAME_DESC"),value:"headlessSelector"}]}}]),r}(h.default.Component);a.default=T},function(e,t,a){e.exports={wrapper:"_1d8R2wC-iPUk0mJ0gGdi9g",contentWrapper:"_3YpkzmM-waCXVs2m6v7Jd1",card:"_2TCiSZqKH5Kv9Jot5mNmTY",tabs:"_3CrPTt4KFbhRsB2wWRMg88",label:"_2GCaqlVoPz2mC7DU580ae2"}},function(e,t,a){e.exports={empty:"_3g5fKDY3mes3tmmqImZr6D"}},function(e,t,a){"use strict";a(16);var r=a(19);a(20),a(14),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(20),a(14);var n=r(a(119)),l=r(a(26)),u=r(a(196)),o={namespaces:function(e){var t=(0,l.default)(e,"metadata.name"),a=(0,l.default)(e,"metadata.annotations"),r=(0,l.default)(e,"spec.placement"),o=(0,l.default)(e,"spec.placement.clusters",[]),c=(0,l.default)(e,'metadata.labels["kubesphere.io/workspace"]'),s=(0,n.default)(e);(0,u.default)(s,"apiVersion"),(0,u.default)(s,"kind"),(0,u.default)(s,"metadata.name"),(0,u.default)(s,"spec");var i=o.map((function(e){return{clusterName:e.name,clusterOverrides:[{path:"/metadata/annotations",value:a}]}}));return{apiVersion:"types.kubefed.io/v1beta1",kind:"FederatedNamespace",metadata:{name:t,namespace:t,labels:{"kubesphere.io/workspace":c},annotations:a},spec:{placement:r,template:s,overrides:i}}}};t.default=o},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(192),r(20),r(98),r(14),r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(20),r(98),r(29),r(14),r(8),r(4),r(18),r(43),r(11);var l,u=n(r(58)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(45)),p=n(r(0)),m=r(189),h=n(r(824)),v=n(r(841)),E=r(17),y=n(r(798)),g=n(r(68)),b=n(r(850)),S=n(r(26)),_=n(r(846)),O=n(r(2616));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var T=(l=function(e){(0,s.default)(r,e);var a=C(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).clustersList=(0,S.default)(e.props.formTemplate,"spec.placement.clusters",[]),e.formTemplate={},e.handleClusterChange=function(t){(0,g.default)(e.formTemplate,"clusters",(0,b.default)(t,"name"))},e.valueRenderer=function(e){return p.default.createElement(_.default,{cluster:e.cluster,size:"small",noStatus:!0})},e.optionRenderer=function(e){return p.default.createElement(_.default,{cluster:e.cluster,size:"small",theme:"light",noStatus:!0})},e.handleOk=function(t){var a=e.props,r=a.onOk,n=a.formTemplate,l=(0,b.default)([].concat((0,u.default)(e.clustersList),(0,u.default)(t.clusters)),"name"),o=(0,S.default)(n,"metadata.annotations"),c=l.map((function(e){return{clusterName:e.name,clusterOverrides:[{path:"/metadata/annotations",value:o}]}}));(0,g.default)(n,"spec.placement.clusters",l),(0,g.default)(n,"spec.overrides",c),r(n)},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel;return p.default.createElement(y.default.Form,{data:this.formTemplate,width:691,title:t("ADD_CLUSTER"),icon:"enterprise",onOk:this.handleOk,onCancel:n,visible:a,isSubmitting:r},p.default.createElement("div",{className:O.default.fedProClusterContainer},p.default.createElement(m.Form.Group,null,p.default.createElement(m.Form.Item,{rules:[{required:!0,message:t("CLUSTER_EMPTY_DESC")}],desc:this.enableAddCluster?t("FEDPROJECT_CANNOT_ADD_CLUSTER"):null},p.default.createElement(h.default,{name:"clusters",addText:t("ADD_CLUSTER"),itemType:"object",onChange:this.handleClusterChange},p.default.createElement(v.default,null,p.default.createElement(m.Select,{name:"name",placeholder:" ",options:this.clusters,valueRenderer:this.valueRenderer,optionRenderer:this.optionRenderer,showTip:!0})))))))}},{key:"clusters",get:function(){var e=this;return this.props.clusters.map((function(t){var a=e.clustersList.some((function(e){return e.name===t.name}));return{label:t.name,value:t.name,cluster:t,disabled:!t.isReady||a}}))}},{key:"enableAddCluster",get:function(){return this.clusters.every((function(e){return e.disabled}))}}]),r}(p.default.Component),(0,d.default)(l.prototype,"clusters",[E.computed],Object.getOwnPropertyDescriptor(l.prototype,"clusters"),l.prototype),(0,d.default)(l.prototype,"enableAddCluster",[E.computed],Object.getOwnPropertyDescriptor(l.prototype,"enableAddCluster"),l.prototype),l);a.default=T},function(e,t,a){e.exports={fedProClusterContainer:"_2iCHyPdPf0H_KTrM8xWFQL"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(70),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(30),r(73),r(46),r(139),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(44),r(6),r(70),r(36),r(66),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(798)),f=n(r(68)),d=n(r(26)),p=n(r(2618)),m=n(r(822)),h=n(r(438)),v=n(r(2622)),E=n(r(912));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b={"gateways.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.name,u=e.workspace,o=e.success,m=(0,c.default)(e,["store","cluster","namespace","name","workspace","success"]),v=h.default.gateways();(0,f.default)(v,"metadata",{namespace:n,name:l});var E=i.default.open(g({onOk:function(e){if((0,d.default)(e,"metadata")){(0,f.default)(e,"metadata",g(g({},e.metadata),{},{creator:globals.user.username,createTime:new Date}));var l=(0,d.default)(e,"metadata.labels",{});"kubesphere-system"===n&&((0,f.default)(e,"spec.values.controller.scope",{enabled:!1,namespace:"",namespaceSelector:""}),(0,f.default)(e,"metadata.labels",g(g({},l),{},{"kubesphere.io/gateway-type":"cluster"}))),!n&&u&&((0,f.default)(e,"spec.values.controller.scope",{enabled:!1,namespace:"",namespaceSelector:"kubesphere.io/workspace=".concat(u)}),(0,f.default)(e,"metadata.labels",g(g({},l),{},{"kubesphere.io/gateway-type":"workspace","kubesphere.io/workspace":u}))),n&&u&&((0,f.default)(e,"spec.values.controller.scope",{enabled:!0,namespace:n,namespaceSelector:""}),(0,f.default)(e,"metadata.labels",g(g({},l),{},{"kubesphere.io/gateway-type":"project","kubesphere.io/workspace":u})));var c=!1;c=!!(0,d.default)(globals,"ksConfig.enabledExtensionModulesStatus.".concat("whizard-monitoring",".clusterSchedulingStatuses.").concat(r),!1),(0,f.default)(e,"spec.values.controller.metrics.enabled",c),(0,f.default)(e,"spec.values.controller.metrics.serviceMonitor.enabled",c),a.addGateway({cluster:r,namespace:n,workspace:u},e).then((function(){i.default.close(E),s.default.success({content:t("CREATE_SUCCESSFUL")}),o&&o()}))}else s.default.error({content:t("INVALID_YAML_FILE_FORMAT")})},modal:p.default,isEdit:!1,cluster:r,namespace:n,workspace:u,name:l,store:a,detail:v},m))}},"gateways.edit":{on:function(e){return(0,u.default)(l.default.mark((function a(){var r,n,o,d,m,h,v,y,b,S,_,O,C,T;return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.store,n=e.detail,o=e.cluster,d=e.namespace,m=e.workspace,h=e.success,v=e.name,y=e.type,b=(0,c.default)(e,["store","detail","cluster","namespace","workspace","success","name","type"]),S=new E.default,_={cluster:o,namespace:d,workspace:m,type:y},a.next=5,S.getGateway(g({},_));case 5:O=a.sent,C=O.resourceVersion,T=i.default.open(g({onOk:function(){var e=(0,u.default)(l.default.mark((function e(a){var n;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getGateway(g({},_));case 2:(n=e.sent).resourceVersion===C?((0,f.default)(a,"metadata.resourceVersion",n.resourceVersion),r.editGateway({cluster:o,namespace:d,workspace:m,name:v},a).then((function(){i.default.close(T),s.default.success({content:t("UPDATE_SUCCESSFUL")}),h&&h()}))):(C=n.resourceVersion,s.default.info({content:t("GATEWAY_UPDATING_TIP")}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),modal:p.default,isEdit:!0,detail:n,cluster:o,namespace:d,workspace:m,store:r},b));case 8:case"end":return a.stop()}}),a)})))()}},"gateways.delete":{on:function(e){var a=e.store,r=e.resource,n=(e.detail,e.cluster),l=e.namespace,u=e.workspace,o=e.success,f=e.name,d=(0,c.default)(e,["store","resource","detail","cluster","namespace","workspace","success","name"]),p=r?t.html("DELETE_RESOURCE_TYPE_DESC_GW",{resource:r,type:t("GATEWAY_LOW")}):t("DISABLE_GATEWAY_TIP"),h=i.default.open(g({onOk:function(){a.delete({name:f,cluster:n,namespace:l,workspace:u}).then((function(){i.default.close(h),s.default.success({content:t("DISABLE_SUCCESSFUL")}),o&&o()}))},store:a,modal:m.default,title:t("DISABLE_GATEWAY"),desc:p,type:"GATEWAY",resource:r,cluster:n,namespace:l,workspace:u},d))}},"gateways.update":{on:function(e){return(0,u.default)(l.default.mark((function a(){var r,n,o,p,m,h,y,b,S,_,O,C,T,R,D;return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.store,n=e.detail,o=e.cluster,p=e.namespace,m=e.workspace,h=e.type,y=e.updateToLatest,b=e.success,S=(0,c.default)(e,["store","detail","cluster","namespace","workspace","type","updateToLatest","success"]),_=new E.default,O={cluster:o,namespace:p,workspace:m},a.next=5,_.getGateway(g({},O));case 5:C=a.sent,T=C.resourceVersion,R=n,D=i.default.open(g({onOk:function(){var e=(0,u.default)(l.default.mark((function e(){var a,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=6;break}return e.next=3,_.getGateway(g({},O));case 3:return(a=e.sent).resourceVersion===T?((0,f.default)(R,"metadata.resourceVersion",a.resourceVersion),u=(0,d.default)(R,"metadata.labels",{}),"cluster"===h&&(0,f.default)(R,"metadata.labels",g(g({},u),{},{"kubesphere.io/gateway-type":"cluster"})),"project"===h&&(0,f.default)(R,"metadata.labels",g(g({},u),{},{"kubesphere.io/gateway-type":"project","kubesphere.io/workspace":m})),r.editGateway({cluster:o,namespace:p,workspace:m},R).then((function(){i.default.close(D),s.default.success({content:t("UPDATE_SUCCESSFUL")}),b&&b()}))):(T=a.resourceVersion,s.default.info({content:t("GATEWAY_UPDATING_TIP")})),e.abrupt("return");case 6:r.updateGateway({cluster:o,namespace:p,workspace:m,gatewayName:n.metadata.name},n).then((function(){i.default.close(D),s.default.success({content:t("UPDATE_SUCCESSFUL")}),b&&b()}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),modal:v.default,detail:n,store:r,cluster:o,workspace:m,namespace:p},S));case 9:case"end":return a.stop()}}),a)})))()}},"gateways.batch.delete":{on:function(e){var a,r=e.store,n=e.success,o=e.rowKey,f=e.type,d=e.workspace,p=(0,c.default)(e,["store","success","rowKey","type","workspace"]),h=r.list,v=h.data,E=h.selectedRowKeys,y=v.filter((function(e){return E.includes(e[o])})).map((function(e){return{name:e.name,namespace:e.namespace}})),b=y.map((function(e){return e.name})),S=i.default.open(g({onOk:(a=(0,u.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],v.forEach((function(e){if(y.find((function(t){return t.name===e.name&&t.namespace===e.namespace}))){var t=e.name.split("kubesphere-router-")[1],n="kubesphere-system"===t?"":t,l=e.cluster;a.push(r.delete({name:e.name,cluster:l,namespace:n,workspace:d}))}})),e.next=4,Promise.all(a);case 4:i.default.close(S),s.default.success({content:t("DELETED_SUCCESSFULLY")}),r.setSelectRowKeys([]),n&&n();case 8:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),resource:b.join(", "),modal:m.default,title:1===b.length?t("DISABLE_GATEWAY"):t("DISABLE_MULTIPLE_GATEWAYS"),store:r,type:f||"GATEWAY"},p))}}};a.default=b},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(87),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(121),r(27),r(87),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(58)),u=n(r(31)),o=n(r(38));r(35);var c,s,i,f,d,p,m,h=n(r(39)),v=n(r(62)),E=n(r(25)),y=n(r(28)),g=n(r(74)),b=n(r(41)),S=n(r(42)),_=n(r(37)),O=n(r(45)),C=(n(r(63)),n(r(26))),T=n(r(68)),R=n(r(67)),D=n(r(201)),k=n(r(0)),N=n(r(1)),I=r(189),P=n(r(861)),A=n(r(798)),w=n(r(858)),L=n(r(829)),M=n(r(956)),x=r(61),j=r(17),U=r(243),F=n(r(2619)),V=r(1152),G=n(r(2621));function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,_.default)(e);if(t){var n=(0,_.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,S.default)(this,a)}}var H=(0,U.observer)((m=p=function(e){(0,b.default)(n,e);var a,r=Y(n);function n(e){var a;return(0,E.default)(this,n),a=r.call(this,e),(0,v.default)(a,"template",i,(0,g.default)(a)),(0,v.default)(a,"store",f,(0,g.default)(a)),(0,v.default)(a,"options",d,(0,g.default)(a)),a.getNginxVersion=(0,h.default)(o.default.mark((function e(){var t,r,n,l,u,c,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,r=t.cluster,n=t.isEdit,e.next=3,a.store.getGatewayAppVersions({cluster:r});case 3:for(c in l=e.sent,u=[],l)u.push({label:c,value:c});if(s="",!n){e.next=11;break}s=(0,C.default)(a.template,"spec.appVersion",""),e.next=15;break;case 11:if(s=(0,C.default)(u,"[0].value",""),(0,R.default)(s)){e.next=15;break}return e.next=15,a.fetchHelmChart(s);case 15:a.setState({versionOption:u,version:s});case 16:case"end":return e.stop()}}),e)}))),a.fetchHelmChart=function(){var e=(0,h.default)(o.default.mark((function e(t){var r,n,l,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props,n=r.cluster,l=r.name,e.next=3,a.store.getHelmChart({appversion:t,cluster:n});case 3:u=e.sent,(0,T.default)(u,"controller.ingressClassResource.name",l),(0,T.default)(u,"controller.electionID",l),(0,T.default)(a.template,"spec.values",u),(0,T.default)(a.template,"spec.appVersion",t),a.initAnnotations();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getData=function(){return a.editor.current.getData()},a.nameValidator=function(e,r,n){if(!r)return n();a.props.store.checkName({name:r}).then((function(a){if(a.exist)return n({message:t("NAME_EXIST_DESC"),field:e.field});n()}))},a.getTypeOptions=function(){return[{label:"NodePort",value:"NodePort"},{label:"LoadBalancer",value:"LoadBalancer"}]},a.initAnnotations=function(){var e=(0,C.default)(a.template,"spec.values.controller.service.annotations"),t=(0,C.default)(a.template,"spec.values.controller.service.type"),r=(0,C.default)(a.template,"spec.values.controller.service['kubesphere.io/loadbalancer-provider']");(0,R.default)(e)&&"LoadBalancer"===t&&"QingCloud Kubernetes Engine"===r&&(0,T.default)(a.template,"spec.values.controller.service.annotations",globals.config.loadBalancerDefaultAnnotations),r&&(a.options=Object.keys(V.CLUSTER_PROVIDERS_ANNOTATIONS[r]));var n=(0,C.default)(a.template,"spec.values.controller.config",{});(0,D.default)(n,"worker-processes")||(0,T.default)(a.template,"spec.values.controller.config",z(z({},n),{},{"worker-processes":"4"})),a.forceUpdate()},a.handleOk=function(){var e=a.props.onOk,t=a.state,r=t.isChecked;if(t.isCodeMode)return a.template=a.parseFormFromCode(a.getData()),void e(a.template);(0,T.default)(a.template,"spec.values.controller.integrateKubeSphere.tracing",!!r),a.form.current.validate((function(){e(a.template)}))},a.parseFormFromCode=function(e){return Array.isArray(e)?e.reduce((function(e,t){return z(z({},e),t)}),{}):e},a.handleTypeChange=function(e){var t=(0,C.default)(a.template,"spec.values.controller.service.annotations",{});"LoadBalancer"===e?((0,T.default)(a.template,"spec.values.controller.service.annotations",(0,R.default)(t)?globals.config.loadBalancerDefaultAnnotations:t),(0,T.default)(a.template,"spec.values.controller.service['kubesphere.io/loadbalancer-provider']","QingCloud Kubernetes Engine"),(0,T.default)(a.template,"spec.values.controller.publishService.enabled",!0)):((0,T.default)(a.template,"spec.values.controller.service.annotations",{}),(0,T.default)(a.template,"spec.values.controller.publishService.enabled",!1),(0,T.default)(a.template,"spec.values.controller.service['kubesphere.io/loadbalancer-provider']","")),a.setState({type:e})},a.providerOptionRenderer=function(e){return k.default.createElement(k.default.Fragment,null,k.default.createElement(I.Icon,{className:"margin-r8",name:e.icon,type:"light",size:20}),e.label)},a.handleAnnotations=function(e){a.options=Object.keys(V.CLUSTER_PROVIDERS_ANNOTATIONS[e]),"QingCloud Kubernetes Engine"===e?a.setAnnotations(globals.config.loadBalancerDefaultAnnotations):a.setAnnotations({})},a.setAnnotations=function(e){(0,T.default)(a.template,"spec.service.annotations",e),a.forceUpdate()},a.renderLoadBalancerSupport=function(){var e=[].concat((0,l.default)(x.CLUSTER_PROVIDERS),[{label:"OpenELB",value:"OpenELB",icon:"kubernetes"}]);return k.default.createElement("div",{className:G.default.loadBalancer},k.default.createElement(I.Form.Item,{label:t("LOAD_BALANCER_PROVIDER")},k.default.createElement(I.Select,{options:e,placeholder:" ",optionRenderer:a.providerOptionRenderer,onChange:a.handleAnnotations,name:"spec.values.controller.service['kubesphere.io/loadbalancer-provider']"})))},a.handleToggleChange=function(e){a.setState({isChecked:e})},a.handleVersionChange=function(e){a.setState({version:e}),a.fetchHelmChart(e)},a.handleModeChange=function(){var e=a.state.isCodeMode;e&&(a.template=a.parseFormFromCode(a.getData())),a.setState({isCodeMode:!e})},a.handleIngressClassNameChange=function(e){(0,T.default)(a.template,"spec.values.controller.electionID",e),(0,T.default)(a.template,"metadata.name",e)},a.renderTitle=function(){return k.default.createElement("div",{className:G.default.modalTitle},k.default.createElement(I.Icon,{name:"loadbalancer",size:32}),k.default.createElement("div",{className:G.default.modalTitleContent},k.default.createElement("div",null,t("ENABLE_GATEWAY")),k.default.createElement("p",null," ",t("ENABLE_GATEWAY_DESC"))))},a.operations=function(){return k.default.createElement(w.default,{className:G.default.switch,text:t("EDIT_YAML"),onChange:a.handleModeChange,checked:a.state.isCodeMode})},a.handleConfigError=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a.setState({configError:e})},a.form=k.default.createRef(),a.editor=k.default.createRef(),a.state={isChecked:JSON.parse((0,C.default)(a.template,"spec.values.controller.integrateKubeSphere.tracing",!1)),configError:"",isCodeMode:!1,versionOption:[],version:""},a}return(0,y.default)(n,[{key:"componentDidMount",value:(a=(0,h.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getNginxVersion();case 2:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderYamlEdit",value:function(){return k.default.createElement("div",{className:G.default.codeWrapper},k.default.createElement(P.default,{ref:this.editor,value:this.template}))}},{key:"renderForm",value:function(){var e=this.props,a=e.cluster,r=e.isEdit,n=this.state,l=n.isChecked,u=n.versionOption,o=n.version;return k.default.createElement("div",{className:G.default.wrapper},k.default.createElement(I.Form,{ref:this.form,data:this.template},k.default.createElement(I.Form.Item,{label:t("NGINX_INGRESS_VERSION")},k.default.createElement(I.Select,{options:u,disabled:r,value:o,onChange:this.handleVersionChange})),k.default.createElement(I.Form.Item,{label:"IngressClassName",desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:x.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.nameValidator}]},k.default.createElement(I.Input,{name:"spec.values.controller.ingressClassResource.name",maxLength:63,onChange:this.handleIngressClassNameChange})),k.default.createElement(I.Form.Item,null,k.default.createElement(F.default,{name:"spec.values.controller.replicaCount",template:this.template,replicas:(0,C.default)(this.template,"spec.values.controller.replicaCount")})),k.default.createElement(I.Form.Item,{label:t("ACCESS_MODE"),className:G.default.types},k.default.createElement(I.RadioGroup,{name:"spec.values.controller.service.type",mode:"button",buttonWidth:155,onChange:this.handleTypeChange,size:"small"},k.default.createElement(I.RadioButton,{value:"NodePort"},"NodePort"),k.default.createElement(I.RadioButton,{value:"LoadBalancer"},"LoadBalancer"))),k.default.createElement("div",{className:G.default.content},globals.app.hasClusterModule(a,"servicemesh")&&k.default.createElement("div",{className:G.default.wrapperContent},k.default.createElement("div",{className:G.default.toggle},k.default.createElement(I.Toggle,{checked:l,onChange:this.handleToggleChange}),t("TRACING")),k.default.createElement("div",{className:G.default.toggleTip},t.html("GATEWAY_TRACING_TIP"))),"LoadBalancer"===(0,C.default)(this.template,"spec.values.controller.service.type")&&k.default.createElement(k.default.Fragment,null,this.renderLoadBalancerSupport(),k.default.createElement("div",{className:G.default.wrapperContent},k.default.createElement(I.Form.Item,{label:t("ANNOTATION_PL")},k.default.createElement(M.default,{controlled:!0,options:(0,j.toJS)(this.options),className:G.default.objectBg,name:"spec.values.controller.service.annotations",addText:t("ADD")})))),k.default.createElement("div",{className:G.default.wrapperContent},k.default.createElement(I.Form.Item,{label:t("CONFIGURATION_OPTIONS")},k.default.createElement(L.default,{className:G.default.objectBg,name:"spec.values.controller.config",addText:t("ADD"),controlled:!0,onError:this.handleConfigError}))))))}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=this.state,u=l.configError,o=l.isCodeMode;return k.default.createElement(A.default,{width:960,title:this.renderTitle(),onCancel:r,visible:a,bodyClassName:G.default.modalBody,headerClassName:G.default.modalHead,closable:!1,operations:this.operations(),hideFooter:!0},k.default.createElement("div",{className:G.default.body},o?this.renderYamlEdit():this.renderForm()),k.default.createElement("div",{className:G.default.footer},k.default.createElement(I.Button,{onClick:r,loading:n,disabled:n},t("CANCEL")),k.default.createElement(I.Button,{type:"control",onClick:this.handleOk,loading:n,disabled:n||""!==u},t("OK"))))}}]),n}(k.default.Component),p.propTypes={template:N.default.object,visible:N.default.bool,onOk:N.default.func,onCancel:N.default.func,isSubmitting:N.default.bool},p.defaultProps={template:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},s=m,i=(0,O.default)(s.prototype,"template",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.props.detail||{}}}),f=(0,O.default)(s.prototype,"store",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.props.store}}),d=(0,O.default)(s.prototype,"options",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),c=s))||c;a.default=H},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(14),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(28)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(0)),i=r(a(68)),f=r(a(808)),d=a(189),p=a(243),m=r(a(1144)),h=r(a(2620));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var E=function(e){(0,u.default)(a,e);var t=v(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return(e=t.call.apply(t,[this].concat(l))).triggerChange=(0,f.default)((function(){var t=e.props,a=t.template,r=t.onChange,n=t.name,l=e.state.replicas;(0,i.default)(a,n,l),r&&r(l)}),200),e}return(0,l.default)(a,[{key:"render",value:function(){return s.default.createElement("div",{className:h.default.wrapper},s.default.createElement(d.Columns,{className:"is-vcentered is-2"},s.default.createElement(d.Column,{className:"is-narrow"},this.renderReplicas())))}}]),a}(m.default),y=(0,p.observer)(E);t.default=y},function(e,t,a){e.exports={wrapper:"_2K5X8Z4X93OFAXjvIhp13q"}},function(e,t,a){e.exports={modalBody:"_1W8ICRFudzizrwjjlAcLB5",body:"_2ynZ9Qv5UBx4fdFF94iS8l",title:"_1KSWFSm2_S45PYbuv-ylkc",wrapper:"_3Xw8W1pcplCVMxZGuPXD1h",types:"_3hcGivEGhw7kKkrWaSIwbh",content:"_3kJmDSOTlGJNzVC74giSdM",wrapperContent:"_31NltraBC15DWZFVQw0FII",toggle:"_30PuUvVRi3WL3hUQMzYBKi",toggleTip:"_2Tpg7-yEO4iYJmla3rrTQH",modalHead:"_1MQmwepBQ4o4vIt7Sofj",modalTitle:"_3_hCNks3aVEgLmZjWCu90Y",modalTitleContent:"_1b_AX358BmOPnGnyYH8thr",footer:"_2ypYyRW9Ofzx9BYHt_EBbh",objectBg:"gz6zaUnJJSaQ6LBjd6P4M",loadBalancer:"_2URqPcgtq6_w6kQXfaGwvz",lbB:"GyNUXQU2RPwnkNxkeubav",codeWrapper:"_3L7MgSyS45uIcDYqagV3d0"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(798)),v=r(189),E=r(243),y=n(r(2623));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,E.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleOk=function(){var t=e.props;(0,t.onOk)(t.detail)},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(h.default,{width:600,onCancel:r,visible:a,closable:!1,onOk:this.handleOk,footerClassName:y.default.footer,bodyClassName:y.default.modalBody,hideHeader:!0},p.default.createElement("div",{className:y.default.body},p.default.createElement("div",{className:y.default.title},p.default.createElement(v.Icon,{name:"information",type:"light",size:20}),p.default.createElement("strong",null,t("UPDATED_GATEWAY_TITLE"))),p.default.createElement("div",{className:y.default.content},t("UPDATE_GATEWAY_DESC"))))}}]),r}(p.default.Component),u.propTypes={detail:m.default.object,visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool},u.defaultProps={detail:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,t,a){e.exports={modalBody:"_2J_VWsfuSeyfjEPyWoXEnM",title:"ky2jKIotIQKZRDn6osazT",content:"_3LmHELJYHg20z0wgQYhqPr",footer:"_1PAbTr7xLaBxt4wQGLbfF9"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(191)),f=n(r(798)),d=n(r(822));function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var m={"group.user.remove":{on:function(e){var a,r=e.store,n=e.detail,m=e.workspace,h=e.success,v=(0,c.default)(e,["store","detail","workspace","success"]),E=f.default.open(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({onOk:(a=(0,u.default)(l.default.mark((function e(){var a,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getGroupBinding({user:n.name,group:n.group},{workspace:m});case 2:a=e.sent,u=(0,s.default)(a.items[0],"metadata.name"),r.deleteGroupBinding(u,{workspace:m}).then((function(){f.default.close(E),i.default.success({content:t("DELETED_SUCCESSFULLY")}),h&&h()}));case 5:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),modal:d.default,title:t("REMOVE_MEMBER"),desc:t.html("REMOVE_MEMBER_TIP",{resource:n.name}),resource:n.name,store:r},v))}}};a.default=m},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(31)),u=n(r(50));r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var o=r(17),c=n(r(191)),s=n(r(798)),i=n(r(819)),f=n(r(2626)),d=n(r(438)),p=n(r(864)),m=n(r(2628)),h=n(r(26)),v=n(r(67)),E=n(r(64)),y=n(r(68));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S=function(e,t){var a=(0,h.default)(e,"spec.config.environment");return(0,E.default)(a)&&(a=a.filter((function(e){return t(e)}))),a},_={"imagebuilder.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.module,o=e.success,f=(0,u.default)(e,["store","cluster","namespace","module","success"]),h=d.default[l]({namespace:n}),E=s.default.open(b({onOk:function(e){if(e){var u=S(e,(function(e){return!(0,v.default)(e)}));(0,y.default)(e,"spec.config.environment",u),a.create(e,{cluster:r,namespace:n}).then((function(){s.default.close(E),c.default.success({content:t("CREATE_SUCCESSFUL")}),o&&o(),p.default.delete("".concat(l,"_create_form"))}))}},module:l,cluster:r,namespace:n,name:"IMAGE_BUILDER",formTemplate:h,steps:m.default,modal:i.default,noCodeEdit:!0,store:a},f))}},"imagebuilder.rerun":{on:function(e){var t=e.store,a=e.detail,r=e.success,n=(0,u.default)(e,["store","detail","success"]),l=s.default.open(b({onOk:function(e){var n=S(e,(function(e){return!(0,v.default)(e)}));(0,y.default)(e,"spec.config.environment",n),t.updateBuilder(e,a).then((function(){s.default.close(l),r&&r()}))},detail:(0,o.toJS)(a._originData),modal:f.default,cluster:a.cluster,namespace:a.namespace,store:t},n))}}};a.default=_},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(26)),p=n(r(68)),m=r(189),h=n(r(798)),v=n(r(1052)),E=n(r(1156)),y=n(r(2627));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var b=function(e){(0,o.default)(r,e);var a=g(r);function r(e){var n;return(0,l.default)(this,r),(n=a.call(this,e)).handleOk=function(){var e=n.props,t=e.onOk,a=e.detail;a&&((0,d.default)(a,"metadata.annotations['devops.kubesphere.io/donotautoscale']")&&(0,p.default)(a,"metadata.annotations['devops.kubesphere.io/donotautoscale']","true"),n.content.current.validate((function(){t(a)})))},n.renderEnableUpdate=function(){var e=n.props.detail;return(0,d.default)(e,"metadata.annotations.serviceName")?i.default.createElement("div",{className:y.default.checkboxCard},i.default.createElement("label",null,i.default.createElement(m.Form.Item,null,i.default.createElement(m.Checkbox,{name:"isUpdateWorkload",defaultValue:!0},i.default.createElement("span",{name:!0,className:y.default.title},t("S2I_UPDATE_WORKLOAD"))))),i.default.createElement("p",{className:y.default.desc},t("S2I_UPDATA_WORKLOAD_DESC"))):null},n.form=i.default.createRef(),n.content=i.default.createRef(),n}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=e.cluster,u=e.detail,o=e.namespace,c=(0,d.default)(u,"spec.config.isBinaryURL");return i.default.createElement(h.default.Form,{formRef:this.form,width:691,title:t("RUN"),icon:"cdn",onOk:this.handleOk,okText:t("RUN"),onCancel:n,visible:a,data:u,isSubmitting:r},c?i.default.createElement(E.default,{formTemplate:u,formRef:this.content,cluster:l,namespace:o,mode:"edit"}):i.default.createElement(v.default,{formTemplate:u,formRef:this.content,cluster:l,namespace:o,mode:"edit"}),this.renderEnableUpdate())}}]),r}(i.default.Component);a.default=b,b.propTypes={visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},b.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,t,a){e.exports={checkboxCard:"_3Y2tyGl5PEtOaHysruKVvi",title:"_3ATnnLF4a1obzO82eJmNLf",desc:"rnfyY8DMRnQvhUfZgd3IA"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(2629)),l=r(a(1052)),u=[{title:"BUILD_MODE",component:n.default},{title:"BUILD_SETTINGS",component:l.default,required:!0}];t.default=u},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(4),r(21),r(18),r(43),r(11);var l=n(r(31)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(26)),h=n(r(68)),v=n(r(196)),E=n(r(1)),y=n(r(5)),g=r(189),b=n(r(459)),S=r(902),_=n(r(1052)),O=n(r(1156)),C=n(r(2630));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var R=function(e){(0,i.default)(r,e);var a=T(r);function r(e){var n;return(0,c.default)(this,r),(n=a.call(this,e)).fetchData=(0,o.default)(u.default.mark((function e(){var t,a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.cluster,e.next=3,n.store.getS2iSupportLanguage({cluster:t});case 3:a=e.sent,n.setState(a);case 5:case"end":return e.stop()}}),e)}))),n.handleLanguageSelect=function(e,t){return function(){var a=n.props.steps;"b2i"===t&&((0,h.default)(a,"[1].component",O.default),(0,h.default)(n.props.formTemplate,'metadata.labels["s2i-type.kubesphere.io"]',"b2i"),(0,h.default)(n.props.formTemplate,"spec.config.isBinaryURL",!0)),"s2i"===t&&((0,h.default)(a,"[1].component",_.default),(0,h.default)(n.props.formTemplate,'metadata.labels["s2i-type.kubesphere.io"]',"s2i"),(0,v.default)(n.props.formTemplate,"spec.config.isBinaryURL")),n.context.setSteps(a),(0,h.default)(n.props.formTemplate,"metadata.annotations.languageType",e),(0,v.default)(n.props.formTemplate,"spec.config.builderImage"),n.forceUpdate()}},n.renderSupportTip=function(){if("containerd"===globals.runtime.toLowerCase())return p.default.createElement(g.Alert,{className:C.default.margin_b_10,type:"warning",message:t("CONTAINERD_RUNTIME_NOT_SUPPORTED")})},n.store=new b.default,n.state={s2i:[],b2i:[]},n}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this,a=this.props,r=a.formTemplate,n=a.formRef,u=(0,m.default)(this.props.formTemplate,"metadata.annotations.languageType"),o=(0,m.default)(this.props.formTemplate,'metadata.labels["s2i-type.kubesphere.io"]',"s2i");return p.default.createElement(g.Form,{ref:n,data:r},this.renderSupportTip(),p.default.createElement("div",{className:C.default.header},p.default.createElement("p",null,t("IMAGE_FROM_S2I")),p.default.createElement("p",null,t("S2I_DESC"))),p.default.createElement("ul",{className:C.default.content},this.state.s2i.map((function(a){return p.default.createElement("li",{key:a,className:(0,y.default)(C.default.item,(0,l.default)({},C.default.item_select,u===a&&"s2i"===o)),onClick:e.handleLanguageSelect(a,"s2i")},p.default.createElement(g.Icon,{name:(0,S.getLanguageIcon)(a,"radio"),size:48}),p.default.createElement("p",null,t(a.toUpperCase())))}))),p.default.createElement("div",{className:C.default.header},p.default.createElement("p",null,t("IMAGE_FROM_B2I")),p.default.createElement("p",null,t("B2I_DESC"))),p.default.createElement("ul",{className:C.default.content},this.state.b2i.map((function(a){return p.default.createElement("li",{key:a,className:(0,y.default)(C.default.item,(0,l.default)({},C.default.item_select,u===a&&"b2i"===o)),onClick:e.handleLanguageSelect(a,"b2i")},p.default.createElement(g.Icon,{name:(0,S.getLanguageIcon)(a,"radio"),size:48}),p.default.createElement("p",null,t(a.toUpperCase())))}))),p.default.createElement(g.Form.Item,{rules:[{required:!0,message:t("EMPTY_IMAGE_TYPE_DESC")}]},p.default.createElement(g.Input,{style:{display:"none"},readOnly:!0,name:"metadata.annotations.languageType"})))}}]),r}(p.default.Component);a.default=R,R.contextTypes={setSteps:E.default.func}},function(e,t,a){e.exports={header:"UF0cy-s-F7_E3xD9T-iiO",content:"_3nX5vmb5CHWXRRdJAshIoI",item_select:"_1-Jk3y0NUhvd28iE52bNEk",margin_b_10:"_3kVPnlIFTOJFynDcNQlbJX"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(191)),c=n(r(798)),s=n(r(2632));function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var f={"license.update":{on:function(e){var a=e.store,r=e.success,n=(0,u.default)(e,["store","success"]),f=c.default.open(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({onOk:function(e){a.updateLicense(e).then((function(){c.default.close(f),o.default.success({content:"".concat(t("UPDATE_SUCCESSFUL"))}),localStorage.removeItem("hideLicenseTip"),r&&r()}))},modal:s.default,store:a},n))}}};a.default=f},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(70),r(4),r(18),r(30),r(11),r(71),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(29),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(71);var l=n(r(317)),u=n(r(31)),o=n(r(50)),c=n(r(38));r(35);var s,i,f,d=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=n(r(0)),g=n(r(1)),b=r(243),S=r(189),_=n(r(798)),O=r(324),C=n(r(5)),T=r(56),R=n(r(2633));function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var k=["Format error","Invalid signature","Invalid type","Empty license"],N=(0,b.observer)((f=i=function(e){(0,h.default)(r,e);var a=D(r);function r(){var e;(0,p.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).state={value:"",error:!1},e.handleSubmit=(0,d.default)(c.default.mark((function t(){var a,r,n,l,u;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.value,t.next=3,e.handleInvalid(a);case 3:r=t.sent,n=r.error,l=r.errorMessage,e.setState({error:n,errorMessage:l}),n||(u=JSON.parse((0,O.safeAtob)(a)),e.props.onOk(u),e.setState({error:!1,errorMessage:""}));case 8:case"end":return t.stop()}}),t)}))),e.handleValue=function(t){e.setState({value:t,error:!1})},e.handleInvalid=function(){var t=(0,d.default)(c.default.mark((function t(a){var r,n,l,u;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.props.store,n=JSON.parse((0,O.safeAtob)(a)),t.next=5,r.invalidLicense(n);case 5:if(l=t.sent,u=l.status.violation.type,!k.includes(u)){t.next=9;break}return t.abrupt("return",{error:!0,errorMessage:u.replace(/\s/g,"_")});case 9:return t.abrupt("return",{error:!1,errorMessage:""});case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",{error:!0,errorMessage:"INVALID_ACTIVATION_CODE_DESC"});case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}(),e.renderTipMessage=function(){var a=globals.licenseInfo||{},r=a.isUnAuthorized,n=void 0!==r&&r,l=a.isOverLimit,u=void 0!==l&&l,o=a.isExpired,c=void 0!==o&&o;return n?t("".concat(e.isAdmin?"ADMIN_":"","AUTHORIZED_INVALID_LICENSE_DESC")):u?t("".concat(e.isAdmin?"ADMIN_":"","OVER_RESOURCE_LICENSE_LIMIT")):c?t("".concat(e.isAdmin?"ADMIN_":"","EXPIRED_INVALID_LICENSE_DESC")):t("".concat(e.isAdmin?"ADMIN_":"","AUTHORIZED_INVALID_LICENSE_DESC"))},e.renderHeader=function(){return y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:R.default.customHeader},y.default.createElement(S.Icon,{name:"close",type:"light",className:R.default.closeIcon}),y.default.createElement("b",null,t("INVALID_LICENSE")),y.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/logo.svg"})),y.default.createElement(S.Alert,{type:"error",message:e.renderTipMessage()}))},e}return(0,m.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.title,c=e.isOverLimit,s=void 0!==c&&c,i=(0,o.default)(e,["visible","onCancel","title","isOverLimit"]);return y.default.createElement(_.default,(0,l.default)({},i,{width:600,title:t(n),visible:a,onCancel:r,onOk:this.isAdmin?this.handleSubmit:null,cancelText:this.isAdmin?t("CANCEL"):t("CLOSE"),icon:"pen"}),y.default.createElement("div",{className:R.default.body},s&&this.renderHeader(),this.isAdmin?y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:R.default.title},t("ACTIVATION_CODE")),y.default.createElement(S.TextArea,{className:(0,C.default)("max-width-full",(0,u.default)({},R.default.TextError,this.state.error)),rows:"3",onChange:this.handleValue}),this.state.error&&y.default.createElement("div",{className:R.default.error},t(this.state.errorMessage))):null))}},{key:"isAdmin",get:function(){return globals.app.isPlatformAdmin}},{key:"kscLink",get:function(){return(0,T.getConfigSupportLink)("ksc")}}]),r}(y.default.Component),i.propTypes={visible:g.default.bool,onOk:g.default.func,onCancel:g.default.func},i.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},s=f))||s;a.default=N},function(e,t,a){e.exports={body:"_3cuJyw4UcmokF5NgeYKAVE",TextError:"_2Y_gRDChK2WgeacdCzVavx",error:"_1ucO7UX7j5IvXn1nL2sEFy",title:"_2-EuDVRUdylWBXPFsPZJ3c",customHeader:"z-xciYo3gRYHskGtULxfJ",closeIcon:"_1McViypeDlXnTfuHVd2QIq",info:"_2OCA78vqWU8QkLBitXiM8q"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(917),r(14),r(8),r(13),r(9),r(30),r(71),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(917),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(30),r(71),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(0)),i=n(r(119)),f=n(r(26)),d=n(r(1100)),p=n(r(191)),m=n(r(798)),h=r(324),v=r(463),E=n(r(2635)),y=n(r(2637)),g=n(r(2639)),b=n(r(2642));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O={"log.collection.active.switch":{on:function(e){var a,r=e.store,n=e.success,o=(0,c.default)(e,["store","success"]),i=m.default.open(_({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=a.enabled,e.next=3,r.patch(r.detail,{metadata:{labels:{"logging.whizard.io/enable":u?"true":"false"}}});case 3:m.default.close(i),n&&n(),p.default.success({content:t("UPDATE_SUCCESSFUL")});case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:m.default.Form,store:r,width:497,icon:"timed-task",title:t("CHANGE_STATUS"),children:s.default.createElement(E.default,null)},o))}},"log.collection.edit":{on:function(e){var a,r,n=e.store,E=e.success,S=e.component,O=(0,c.default)(e,["store","success","component"]),C={elasticsearch:y.default,kafka:g.default,opensearch:b.default},T=(null==n||null===(a=n.detail)||void 0===a||null===(r=a.name)||void 0===r?void 0:r.split("-").pop())||"",R="".concat(T,"_").concat(S).replace("-","_"),D=(0,f.default)((0,v.getValueObj)((0,h.safeAtob)((0,f.default)(n.detail._originData,'data["sink.yaml"]',{}))),"sinks.".concat(R),{}),k=C[T]||null,N=(0,i.default)(D),I=(0,i.default)(D);if(I.logstashPrefix=(0,f.default)(N,"bulk.index","-").replace("{{ .cluster }}-","").replace("-%Y.%m.%d",""),"opensearch"===T||"elasticsearch"===T){var P=(0,f.default)(N,"endpoints[0]",""),A=P.lastIndexOf(":");I.host=P.substring(0,A),I.port=P.substring(A+1)}var w,L=m.default.open(_({onOk:(w=(0,u.default)(l.default.mark((function e(a){var r,u,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,i.default)(a),"opensearch"!==T&&"elasticsearch"!==T||(r.endpoints||(r.endpoints=[]),r.bulk||(r.bulk={index:""}),r.endpoints[0]=(0,d.default)(a.host,"http")?"".concat(a.host,":").concat(a.port):"http://".concat(a.host,":").concat(a.port),r.bulk.index="{{ .cluster }}-".concat(a.logstashPrefix,"-%Y.%m.%d"),delete r.host,delete r.port,delete r.logstashPrefix),u=(0,v.objectToYaml)({data:{sinks:(0,o.default)({},R,r)}}),(c=n.detail._originData).data["sink.yaml"]=(0,h.safeBtoa)(u),e.next=7,n.patch(n.detail,c);case 7:m.default.close(L),E&&E(),p.default.success({content:t("UPDATE_SUCCESSFUL")});case 10:case"end":return e.stop()}}),e)}))),function(e){return w.apply(this,arguments)}),modal:m.default.Form,data:I,width:691,icon:"timed-task",title:t("EDIT_LOG_RECEIVER"),children:s.default.createElement(k,null),store:n},O))}}};a.default=O},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=r(189),p=l(r(2636));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(r,e);var a=m(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).statusLabel=[{label:t("ENABLE"),value:1},{label:t("DISABLE"),value:0}],e}return(0,o.default)(r,[{key:"render",value:function(){return f.default.createElement("div",null,f.default.createElement("p",{className:p.default.tip},t("LOG_COLLECTION_ENABLE_TIPS")),f.default.createElement(d.Form.Item,null,f.default.createElement(d.Select,{name:"enabled",options:this.statusLabel,placeholder:t("SELECT_STATUS_TIP")})))}}]),r}(f.Component);a.default=h},function(e,t,a){e.exports={tip:"_1uuSdxXW-f_ib1niUKsZY7"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(1061)),p=n(r(2638));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){return i.default.createElement("div",{className:p.default.fromGroup},i.default.createElement(f.Form.Item,{label:t("SERVICE_ADDRESS"),desc:t("LOG_COLLECTION_ES_URL_TIPS")},i.default.createElement(d.default,{hostName:"host",portName:"port",exampleValue:"http://192.168.1.10"})),i.default.createElement(f.Form.Item,{label:t("INDEX_PREFIX"),desc:t("LOG_COLLECTION_ES_INDEX_TIPS"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},i.default.createElement(f.Input,{name:"logstashPrefix",defaultValue:this.props.component})))}}]),r}(i.default.Component);a.default=h},function(e,t,a){e.exports={path:"_1oepYFEVrzpZB73WDy0tg5",columns:"Hlk5VrflNofZAw8yS8P82",desc:"_1oWYev9AYgyj6hmC-6fEdQ"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(192),r(4),r(18),r(30),r(11),r(69),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(29),r(4),r(18),r(43),r(30),r(11),r(69);var l=n(r(97)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(189),p=n(r(2640));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(r,e);var a=m(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).addressValidator=function(e,a,r){return a.split(",").every((function(e){var t=e.match(/(.*):(.*)$/)||[],a=(0,l.default)(t,3),r=a[1],n=void 0===r?"":r,u=a[2];return n&&(void 0===u?"":u)}))?r():r({message:t("INVALID_SERVICE_ADDRESS")})},e}return(0,o.default)(r,[{key:"render",value:function(){return f.default.createElement("div",null,f.default.createElement(d.Form.Item,{label:t("TOPIC")},f.default.createElement(d.Input,{name:"topic",autoComplete:"nope",defaultValue:"{{ .cluster }}-".concat(this.props.component,"-{{ .kubernetes.namespace_name }}")})),f.default.createElement(d.Form.Item,{label:t("SERVICE_ADDRESS"),rules:[{required:!0,message:t("ENTER_SERVICE_ADDRESS")},{validator:this.addressValidator}]},f.default.createElement(p.default,{name:"bootstrap_servers"})))}}]),r}(f.default.Component);a.default=h},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(66),r(20),r(4),r(18),r(30),r(11),r(69),r(71),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(66),r(20),r(29),r(4),r(18),r(43),r(30),r(11),r(69),r(71);var l=n(r(97)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=n(r(841)),m=n(r(824)),h=n(r(805)),v=r(189),E=n(r(2641));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=function(e){(0,c.default)(r,e);var a=y(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).onChange=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.map((function(e){var t=e.host,a=void 0===t?"":t,r=e.port,n=void 0===r?"":r;return"".concat(a.replace(/,/g,""),":").concat(n)})).join(",");e.props.onChange(a)},e}return(0,o.default)(r,[{key:"render",value:function(){var e=(0,d.default)(this.props,"value","").split(",").map((function(e){var t=e.match(/(.*):(.*)$/)||[],a=(0,l.default)(t,3),r=a[1],n=void 0===r?"":r,u=a[2];return{port:void 0===u?"":u,host:n}}));return f.default.createElement(m.default,{addText:t("ADD_SERVICE_ADDRESS"),itemType:"object",value:e,onChange:this.onChange},f.default.createElement(p.default,{className:E.default.address},f.default.createElement(v.Input,{name:"host",className:E.default.host,placeholder:t("EXAMPLE_VALUE",{value:"192.168.1.10"})}),f.default.createElement(h.default,{className:E.default.port,name:"port",min:0,max:65535,placeholder:t("EXAMPLE_VALUE",{value:9200}),integer:!0})))}}]),r}(f.default.Component);a.default=g},function(e,t,a){e.exports={address:"_2Y-pkqthIJRIsP4ExOInjH",host:"h1zpisJbm-ZoDbaSXptJj",port:"_2UTT5V7_N5_xNrvXpJIG5b"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(1061)),p=n(r(2643));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){return i.default.createElement("div",{className:p.default.fromGroup},i.default.createElement(f.Form.Item,{label:t("SERVICE_ADDRESS"),desc:t("LOG_COLLECTION_OS_URL_TIPS")},i.default.createElement(d.default,{hostName:"host",portName:"port",exampleValue:"http://192.168.1.10"})),i.default.createElement(f.Form.Item,{label:t("USERNAME"),desc:t("LOG_COLLECTION_OS_USER_TIPS")},i.default.createElement(f.Input,{name:"auth.user",defaultValue:"admin"})),i.default.createElement(f.Form.Item,{label:t("PASSWORD"),desc:t("LOG_COLLECTION_OS_PASSWORD_TIPS")},i.default.createElement(f.Input,{name:"auth.password",defaultValue:"admin"})),i.default.createElement(f.Form.Item,{label:t("INDEX_PREFIX"),desc:t("LOG_COLLECTION_ES_INDEX_TIPS"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},i.default.createElement(f.Input,{name:"logstashPrefix",defaultValue:this.props.component})))}}]),r}(i.default.Component);a.default=h},function(e,t,a){e.exports={path:"_1MJQsfqeDDP96NX-4TVyLe",columns:"_2dymll3HxLR4qGfdodyzRb",desc:"_1q83WoQ9jB2uwX0GBmVgmT"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(66),r(14),r(8),r(13),r(9),r(30),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(66),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=r(17),c=n(r(191)),s=n(r(798)),i=n(r(2645)),f=n(r(2647)),d=n(r(822));function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h={"member.invite":{on:function(e){var a=e.store,r=e.cluster,n=e.workspace,l=e.namespace,o=e.success,f=e.devops,d=(0,u.default)(e,["store","cluster","workspace","namespace","success","devops"]),p=s.default.open(m({onOk:function(e){a.create(e,{cluster:r,workspace:n,namespace:null!=l?l:f}).then((function(){s.default.close(p),c.default.success({content:t("INVITED_SUCCESSFULLY")}),o&&o()}))},modal:i.default,store:a,cluster:r,workspace:n,namespace:l,devops:f},d))}},"member.edit":{on:function(e){var a=e.store,r=e.module,n=e.detail,l=e.cluster,o=e.workspace,i=e.namespace,d=e.success,p=e.devops,h=(0,u.default)(e,["store","module","detail","cluster","workspace","namespace","success","devops"]),v=s.default.open(m({onOk:function(e){a.update(m(m(m({},n),l),{},{workspace:o,namespace:null!=i?i:p}),{username:n.name,roleRef:e}).then((function(){s.default.close(v),c.default.success({content:t("UPDATE_SUCCESSFUL")}),d&&d()}))},modal:f.default,store:a,module:r},h))}},"member.remove":{on:function(e){var a=e.store,r=e.detail,n=e.cluster,l=e.workspace,o=e.namespace,i=e.success,f=e.devops,p=(0,u.default)(e,["store","detail","cluster","workspace","namespace","success","devops"]),h=s.default.open(m({onOk:function(){a.delete(m(m({},r),{},{cluster:n,workspace:l,namespace:null!=o?o:f})).then((function(){s.default.close(h),c.default.success({content:t("DELETED_SUCCESSFULLY")}),i&&i()}))},modal:d.default,title:t("REMOVE_MEMBER"),desc:t.html("REMOVE_MEMBER_TIP",{resource:r.name}),resource:r.name,store:a},p))}},"member.remove.batch":{on:function(e){var a=e.store,r=e.cluster,n=e.workspace,l=e.namespace,i=e.success,f=e.devops,p=(0,u.default)(e,["store","cluster","workspace","namespace","success","devops"]),h=(0,o.toJS)(a.list.selectedRowKeys),v=h.join(", "),E=s.default.open(m({onOk:function(){a.batchDelete({rowKeys:h,cluster:r,workspace:n,namespace:l,devops:f}).then((function(){s.default.close(E),c.default.success({content:t("DELETED_SUCCESSFULLY")}),i&&i()}))},modal:d.default,title:1===v.split(", ").length?t("REMOVE_MEMBER"):t("REMOVE_MULTIPLE_MEMBERS"),desc:1===v.split(", ").length?t.html("REMOVE_MEMBER_TIP",{resource:v}):t.html("REMOVE_MULTIPLE_MEMBERS_TIP",{resource:v}),resource:v,store:a},p))}}};a.default=h},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(73),r(7);var l,u,o,c=n(r(58)),s=n(r(31)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=n(r(1)),E=r(17),y=r(243),g=r(189),b=n(r(798)),S=n(r(889)),_=n(r(323)),O=n(r(2646)),C=n(r(1440));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var k=(0,y.observer)((o=u=function(e){(0,d.default)(r,e);var a=D(r);function r(e){var t;return(0,i.default)(this,r),(t=a.call(this,e)).fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.props,r=a.workspace,n=a.namespace,l=a.devops;t.userStore.fetchList(R({name:t.state.name,workspace:n||l?r:void 0},e))},t.handleSearch=function(e){t.setState({name:e},t.fetchData)},t.handleSelect=function(e,a){t.setState((function(t){var r=t.members,n=t.newMembers;return{members:[].concat((0,c.default)(r),[e]),newMembers:[].concat((0,c.default)(n),[{username:e,roleRef:a}])}}))},t.handleSubmit=function(){t.props.onOk(t.state.newMembers)},t.userStore=new _.default,t.memberStore=new _.default,t.state={members:[],newMembers:[]},t}return(0,f.default)(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.cluster,r=t.workspace,n=t.namespace,l=t.devops;this.memberStore.fetchList({limit:-1,cluster:a,workspace:r,namespace:null!=n?n:l}).then((function(){e.setState({members:e.memberStore.list.data.map((function(e){return e.name}))})}))}},{key:"render",value:function(){var e=this,a=this.props,r=a.visible,n=a.onCancel,l=a.roles,u=a.title,o=a.desc,c=a.searchPlaceholder,s=this.state.members,i=(0,E.toJS)(this.userStore.list),f=i.data,d=void 0===f?[]:f,p=i.total,m=i.page,v=i.isLoading;return h.default.createElement(b.default,{width:691,icon:"pen",onCancel:n,onOk:this.handleSubmit,visible:r,bodyClassName:C.default.modalBody,hideHeader:!0},h.default.createElement("div",{className:C.default.body},h.default.createElement("div",{className:C.default.title},h.default.createElement("div",{className:"h4"},u||t("INVITE_MEMBER")),h.default.createElement("p",null,o||t("INVITE_MEMBER_DESC"))),h.default.createElement("div",{className:C.default.content},h.default.createElement(g.InputSearch,{placeholder:c||t("INVITE_MEMBER_SEARCH_PLACEHOLDER"),onSearch:this.handleSearch}),h.default.createElement("div",{className:C.default.results},h.default.createElement(S.default,{data:d,total:p,page:m,loading:v,onFetch:this.fetchData},d.map((function(t){return h.default.createElement(O.default,{key:t.name,user:t,roles:l,selected:s.includes(t.name),onSelect:e.handleSelect})})))))))}}]),r}(h.default.Component),u.propTypes={roles:v.default.array,visible:v.default.bool,workspace:v.default.string,namespace:v.default.string,cluster:v.default.string,title:v.default.string,desc:v.default.string,searchPlaceholder:v.default.string,onOk:v.default.func,onCancel:v.default.func},u.defaultProps={roles:[],visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=k},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(26)),f=n(r(0)),d=n(r(1)),p=r(189),m=n(r(802)),h=r(56),v=n(r(1440));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).handleMoreMenuClick=function(t,a){var r=e.props;(0,r.onSelect)(r.user.username,a)},e}return(0,u.default)(r,[{key:"getDesc",value:function(e){var a=(0,i.default)(e,"description");return t(a)}},{key:"renderMoreMenu",value:function(){var e=this,a=this.props.roles;return f.default.createElement("div",{className:v.default.menu},f.default.createElement("p",null,t("ASSIGN_ROLE")),f.default.createElement(p.Menu,{onClick:this.handleMoreMenuClick},a.map((function(t){return f.default.createElement(p.Menu.MenuItem,{key:t.name},f.default.createElement(m.default,{className:v.default.avatar,icon:"role",iconSize:40,title:t.aliasName?"".concat(t.aliasName,"（").concat(t.name,"）"):t.name,desc:e.getDesc(t),noLink:!0}))}))))}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.onSelect,r=e.selected;return f.default.createElement("div",{className:v.default.item,"data-user":t.username},f.default.createElement("p",null,f.default.createElement("strong",null,(0,h.getDisplayNameNew)(t))),f.default.createElement("p",null,t.email),!r&&f.default.createElement(p.Dropdown,{content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},f.default.createElement(p.Button,{type:"control",icon:"add",iconType:"light",onClick:a})),r&&f.default.createElement(p.Button,{type:"flat",icon:"check",disabled:!0}))}}]),r}(f.default.Component);a.default=y,y.propTypes={user:d.default.object,roles:d.default.array,selected:d.default.bool,onSelect:d.default.func}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(26)),m=n(r(0)),h=n(r(1)),v=r(243),E=r(189),y=n(r(798)),g=n(r(2648));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=b(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).handleOk=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.props.onOk,r=t.role;a(r)},e.getRoleOptions=function(){return e.props.roles.map((function(e){var a=(0,p.default)(e,"description");return{label:e.aliasName?"".concat(e.aliasName,"（").concat(e.name,"）"):e.name,value:e.name,desc:t(a)}}))},e.optionRenderer=function(e){return m.default.createElement("div",{className:g.default.option},m.default.createElement("div",null,e.label),m.default.createElement("p",null,e.desc))},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=e.role;return m.default.createElement(y.default.Form,{width:691,title:t("CHANGE_ROLE"),icon:"role",onOk:this.handleOk,onCancel:r,visible:a,isSubmitting:n},m.default.createElement(E.Form.Item,{label:t("ROLE"),rules:[{required:!0,message:t("SELECT_ROLE_TIP")}]},m.default.createElement(E.Select,{name:"role",optionRenderer:this.optionRenderer,options:this.getRoleOptions(),defaultValue:l})))}}]),r}(m.default.Component),u.propTypes={role:h.default.string,roles:h.default.array,visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func,isSubmitting:h.default.bool},u.defaultProps={role:"",roles:[],visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=S},function(e,t,a){e.exports={option:"_2hbd_NLQpyyfSepVMs0f2Z"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=r(17),c=n(r(26)),s=n(r(140)),i=n(r(68)),f=n(r(191)),d=n(r(798)),p=n(r(819)),m=n(r(2650)),h=r(61),v=n(r(438)),E=n(r(864)),y=n(r(1178));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S={"microservice.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,o=e.module,m=e.success,g=e.isFederated,S=e.supportGpuSelect,_=void 0!==S&&S,O=(0,u.default)(e,["store","cluster","namespace","module","success","isFederated","supportGpuSelect"]),C=h.MODULE_KIND_MAP[o],T=(0,l.default)({},C,v.default[o]({namespace:n})),R=d.default.open(b({onOk:function(e){var l=(e=(0,s.default)(e,(0,h.OMIT_TOTAL_REPLICAS)(C)))[C];if(l){var u=(0,c.default)(l,"metadata.name");(0,i.default)(l,'metadata.labels["springcloud.kubesphere.io/app"]',u),(0,i.default)(l,'spec.template.metadata.labels["springcloud.kubesphere.io/app"]',u),a.create(l,{cluster:r,namespace:n}).then((function(){d.default.close(R),f.default.success({content:t("CREATE_SUCCESSFUL")}),m&&m(),E.default.delete("".concat(o,"_create_form"))}))}},steps:y.default,module:o,cluster:r,namespace:n,name:C,isFederated:g,formTemplate:T,modal:p.default,store:a,supportGpuSelect:_,maxNameLength:63},O))}},"microservice.instance.weight.edit":{on:function(e){var a=e.store,r=e.namespace,n=(e.module,e.cluster),l=e.detail,c=e.success,s=(0,u.default)(e,["store","namespace","module","cluster","detail","success"]),i=d.default.open(b({modal:m.default,onOk:function(e){a.update(l,e).then((function(){d.default.close(i),f.default.success({content:t("MODIFY_SUCCESSFUL")}),c&&c(e)}))},detail:(0,o.toJS)(l._originData),store:a,namespace:r,cluster:n},s))}}};a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(831)),m=r(189),h=n(r(798)),v=n(r(805));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).state={formData:(0,p.default)((0,d.toJS)(e.detail._originData||e.detail))},t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,p.default)((0,d.toJS)(this.props.detail._originData||this.props.detail))})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=e.onOk,u=this.state.formData;return i.default.createElement(h.default.Form,{formRef:this.form,data:u,width:691,title:t("EDIT_WEIGHT"),icon:"pen",onOk:l,onCancel:n,visible:a,isSubmitting:r},i.default.createElement(m.Form.Item,{label:t("WEIGHT"),desc:t("INSTANCE_WEIGHT_DESC")},i.default.createElement(v.default,{name:"spec.weight",integer:!0,min:0})))}}]),r}(i.default.Component);a.default=y,y.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},y.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(10),r(6),r(20),r(27),r(141),r(29),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u=n(r(317)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=r(189),m=n(r(802)),h=n(r(800)),v=r(804),E=n(r(913)),y=n(r(26)),g=n(r(68)),b=n(r(884)),S=n(r(67)),_=n(r(0)),O=r(243),C=n(r(1442)),T=r(56),R=r(61),D=r(439),k=r(17),N=n(r(2653));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var w=(0,O.observer)(l=(0,v.trigger)(l=function(e){(0,i.default)(r,e);var a=A(r);function r(e){var n;(0,c.default)(this,r),(n=a.call(this,e)).getIPPools=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.keyword&&(e.name=e.keyword,delete e.keyword),n.store.fetchList(P({limit:-1,cluster:n.props.cluster,namespace:n.props.namespace,status:"enabled"},e))},n.getColumns=function(){return[{title:t("NAME"),dataIndex:"name",search:!0,key:"name",render:function(e,t){return _.default.createElement(m.default,{icon:R.ICON_TYPES.ippools,iconSize:40,title:(0,T.getDisplayName)(t),desc:t.description||"-"})}},{title:t("NETWORK_SEGMENT"),isHideable:!0,dataIndex:"cidr"},{title:n.isCalico?t("USED_IP_ADDRESSES"):_.default.createElement("span",{className:"flexbox items-center"},_.default.createElement("span",{className:"margin-r4"},t("USED_IP_ADDRESSES")),_.default.createElement(p.Tooltip,{content:t("IPPOOL_USED_TIP")},_.default.createElement(p.Icon,{name:"question",size:16}))),dataIndex:"status1",isHideable:!0,render:function(e,a){var r=a.status,n=(0,y.default)(r,"capacity",0),l=(0,y.default)(r,"unallocated",0);return _.default.createElement(h.default,{title:n-l,description:t("TOTAL_VALUE",{value:n})})}},{title:t("IPPOOL_BLOCK_SIZE"),dataIndex:"blockSize",isHideable:!0,render:function(e){return null!=e?e:"-"}},n.props.isOutdated?null:{title:t("IPPOOL_OVERLAY_MODE"),dataIndex:"overlay",isHideable:!0,render:function(e,t){var a=t.ipipMode,r=t.vxlanMode,n=(0,D.getOverlayStatus)({ipipMode:a,vxlanMode:r});return _.default.createElement("div",null,_.default.createElement("span",{className:"font-bold"},n.type),n.value&&_.default.createElement("span",{style:{marginLeft:"4px"}},"(",n.value,")"))}}]},n.changeIPPools=function(e){var t,a,r=n.props,l=r.name,u=r.formTemplate,o=r.data;null===(t=n.props)||void 0===t||null===(a=t.formProps)||void 0===a||a.onChange(l,JSON.stringify(e)),o&&(0,g.default)(n.props.data,l,JSON.stringify(e)),u&&(0,g.default)(n.props.formTemplate,l,JSON.stringify(e))},n.showCreate=function(){var e,t,a,r=n.props.cluster;return n.trigger("network.ippool.add",{module:"ippools",cluster:r,trigger:n.trigger,isOutdated:n.props.isOutdated,hideWorkspace:n.columnConfig.hideWorkspace,isCalico:n.isCalico,allList:(0,k.toJS)(null!==(e=null===(t=n.store)||void 0===t||null===(a=t.list)||void 0===a?void 0:a.data)&&void 0!==e?e:[]),success:n.getIPPools})},n.onSelectRowKeys=function(e){n.setState({selectedRowKeys:e},(function(){n.changeIPPools(e)}))},n.showEmpty=function(){var e=n.store.list,t=e.isLoading,a=e.filters,r=e.total;return!t&&(0,S.default)(a)&&0===r},n.deleteItem=function(e){var t=n.state.selectedRowKeys;(0,b.default)(t,(function(t){return t===e})),n.setState({selectedRowKeys:t},(function(){n.changeIPPools(t)}))},n.renderItems=function(e){return e.map((function(e){return _.default.createElement("span",{className:N.default.item},e,_.default.createElement(p.Icon,{name:"close",size:14,clickable:!0,onClick:function(){n.deleteItem(e)}}))}))},n.rootStore=e.rootStore,n.ippoolStore=new C.default,n.store=new(n.ippoolStore.getStoreByCluster(e.cluster));var l=(0,y.default)(e.data,e.name,"");return n.state={selectedRowKeys:l&&JSON.parse(l)||[]},n}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.store.fetchList({limit:-1,cluster:this.props.cluster,namespace:this.props.namespace,status:"enabled"})}},{key:"render",value:function(){var e=this.props,a=e.tableProps,r=e.name,n=this.state.selectedRowKeys,l=this.store.list.filters;return _.default.createElement("div",{className:N.default.ippools,name:r},n.length>0?_.default.createElement("div",{className:N.default.showSelects},_.default.createElement("p",null,t("SELECTED_IPPOOLS",{number:n.length})),_.default.createElement("div",{className:N.default.selectWrapper},this.renderItems(n))):"",_.default.createElement(E.default,(0,u.default)({},a,{module:"ippools",name:"POD_IP_POOL",columns:this.getColumns(),cluster:this.props.cluster,onFetch:this.getIPPools,onRefresh:this.getIPPools,onSelectRowKeys:this.onSelectRowKeys,selectedRowKeys:this.state.selectedRowKeys,disabledSelectActions:!0,data:(0,k.toJS)(this.store.list.data),hideFooter:!0,hideCustom:!0,searchType:"name",filters:l,showEmpty:this.showEmpty(),emptyProps:{desc:t("CLUSTER_IPPOOL_EMPTY_DES")}})),_.default.createElement("p",{className:N.default.empty},this.isPlatformAdmin?_.default.createElement(_.default.Fragment,null,t("ADD_IPPOOL_EMPTY_DES_ADMIN"),_.default.createElement("a",{onClick:this.showCreate},t("CREATE_POD_IP_POOL"))):t("ADD_IPPOOL_EMPTY_DES")))}},{key:"isOutdated",get:function(){var e=this.props.cluster;return this.ippoolStore.isOutdated(e)}},{key:"isCalico",get:function(){var e=this.props.cluster;return this.ippoolStore.isCalico(e)}},{key:"columnConfig",get:function(){var e=this.isCalico;return{hideWorkspace:e,hideSerch:e,hideFilter:e}}},{key:"isPlatformAdmin",get:function(){return"platform-admin"===globals.user.globalrole}}]),r}(_.default.Component))||l)||l;a.default=w},,function(e,t,a){e.exports={ippools:"_2kGSbKseUL2YRcov_9muVv",empty:"_24O3McxSSDwKwbFNUTDDCO",showSelects:"_2sv6WMgMdW8V1HSJxSoBYG",selectWrapper:"_1wN86v2HXHvjdxLHBN1OfO",item:"_1OeK_sDkEV3zvvBSay1L4P"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(808)),f=n(r(26)),d=n(r(67)),p=n(r(163)),m=n(r(68)),h=n(r(0)),v=r(189),E=n(r(829)),y=r(56);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var b=function(e){(0,o.default)(r,e);var a=g(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).handleLabelsChange=(0,i.default)((function(t){var a=e.props,r=a.module,n=a.isFederated;(0,y.updateLabels)(e.fedFormTemplate,r,t),n&&(0,m.default)(e.formTemplate,"metadata.labels",t)}),200),e.handleAnnotationsChange=(0,i.default)((function(t){e.props.isFederated&&((0,m.default)(e.formTemplate,"metadata.annotations",t),(0,y.updateFederatedAnnotations)(e.formTemplate))}),200),e.labelsValidator=function(a,r,n){if((0,p.default)(r)||(0,d.default)(r))return n();if(!(0,y.isValidLabel)(r))return n({message:t("LABEL_FORMAT_DESC")});var l=e.props,u=l.namespace,o=l.cluster;e.props.store.checkLabels({labels:r,namespace:u,cluster:o},e.k8sVersion).then((function(r){if(r.exist)return e.props.formGroupRef.current.state.isCheck=!0,n({message:t("DUPLICATE_LABELS"),field:a.field});n()}))},e}return(0,u.default)(r,[{key:"render",value:function(){return h.default.createElement(h.default.Fragment,null,h.default.createElement(v.Form.Item,{label:t("LABEL_PL"),rules:[{validator:this.labelsValidator}]},h.default.createElement(E.default,{name:"metadata.labels",addText:t("ADD"),onChange:this.handleLabelsChange})),h.default.createElement(v.Form.Item,{label:t("ANNOTATION_PL")},h.default.createElement(E.default,{name:"metadata.annotations",addText:t("ADD"),hiddenKeys:globals.config.preservedAnnotations,onChange:this.handleAnnotationsChange})))}},{key:"formTemplate",get:function(){return this.props.formTemplate}},{key:"k8sVersion",get:function(){var e,t;return null===(e=globals.clusterConfig)||void 0===e||null===(t=e[this.props.cluster])||void 0===t?void 0:t.k8sVersion}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,f.default)(this.formTemplate,"spec.template"):this.formTemplate}}]),r}(h.default.Component);a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(189),p=n(r(2656));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(r,e);var a=m(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"render",value:function(){return f.default.createElement(d.Form.Item,null,f.default.createElement(p.default,(0,l.default)({name:"".concat(this.prefix,"spec.nodeSelector"),addText:t("ADD_NODE_SELECTOR"),handleGroupNodeChange:this.handleGroupNodeChange},this.props,{prefix:this.prefix})))}},{key:"prefix",get:function(){return this.props.prefix||"spec.template."}}]),r}(f.default.Component);a.default=h},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(31)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(196)),p=n(r(244)),m=n(r(0)),h=r(189),v=n(r(829)),E=n(r(798)),y=n(r(5)),g=n(r(483)),b=n(r(2657)),S=n(r(2659));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var T=function(e){(0,s.default)(r,e);var a=C(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={visible:!1,type:"node",groupIsLoading:!0,nodeGroups:[]},e.groupStore=new g.default,e.handleNodeSelect=function(t){var a=e.props.onChange;a&&a(t),e.handleCancel()},e.handleCancel=function(){e.setState({visible:!1})},e.getGroupData=function(t){var a=e.props,r=a.cluster,n=a.workspace;e.setState({groupIsLoading:!0}),e.groupStore.fetchList(O({cluster:r,labelSelector:"apps.edgewize.io/workspace-".concat(n)},t)).then((function(){e.setState({nodeGroups:e.groupStore.list.data.map((function(e){var t=e.aliasName?"(".concat(e.aliasName,")"):"";return{label:"".concat(e.name).concat(t),value:e.name}})),groupIsLoading:!1})}))},e.onChange=function(t){e.setState({type:t},(function(){"node"===t?(0,d.default)(e.props.data,'metadata.labels["apps.edgewize.io/nodegroup"]'):((0,d.default)(e.props.data,"".concat(e.prefix,"spec.nodeSelector")),e.getGroupData(),e.props.onChange(null))}))},e}return(0,c.default)(r,[{key:"renderNodeSelectForm",value:function(){var e=this.props,t=e.cluster,a=e.namespace;return m.default.createElement(b.default,{cluster:t,namespace:a,onSelect:this.handleNodeSelect,onCancel:this.handleCancel,visible:this.state.visible})}},{key:"render",value:function(){var e,a=this,r=this.state,n=r.visible,o=r.type,c=this.props.supportNodeGroupSelect&&globals.app.hasClusterModule(this.cluster,"nodegroup"),s=(0,p.default)(null===(e=this.groupStore)||void 0===e?void 0:e.list,["page","limit","total"]);return m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:S.default.wrapper},c&&m.default.createElement(h.RadioGroup,{wrapClassName:"radio-group-button",value:o,onChange:this.onChange},m.default.createElement(h.RadioButton,{value:"node"},t("Assigned_Node_Allocation")),m.default.createElement(h.RadioButton,{value:"nodeGroup"},t("Assigned_By_Node_Group"))),"node"===o?m.default.createElement("div",{className:(0,y.default)((0,u.default)({},S.default.contentWrapper,c))},m.default.createElement("div",{className:S.default.selectnode},m.default.createElement(v.default,(0,l.default)({},this.props,{controlled:!0,defaultValue:{}})),m.default.createElement(h.Button,{className:S.default.node,onClick:function(){a.setState({visible:!0})}},t("SPECIFY_NODE")))):m.default.createElement("div",{className:S.default.contentWrapper},m.default.createElement(h.Form.Item,{label:t("NODE_GROUP"),rules:[{message:t("SELECT_A_NODE_GROUP")}]},m.default.createElement(h.Select,{name:'metadata.labels["apps.edgewize.io/nodegroup"]',options:this.state.nodeGroups,pagination:s,isLoading:this.state.groupIsLoading,onFetch:this.getGroupData,placeholder:" "})))),m.default.createElement(E.default,{visible:n,bodyClassName:S.default.body,width:600,hideHeader:!0,hideFooter:!0},this.renderNodeSelectForm()))}}]),r}(m.default.Component);a.default=T},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(38));r(35);var c,s=n(r(39)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=r(17),E=r(243),y=n(r(26)),g=r(189),b=n(r(889)),S=n(r(454)),_=n(r(1371)),O=r(56),C=n(r(2658)),T=n(r(1444));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var N=(0,E.observer)(c=function(e){(0,d.default)(n,e);var a,r=k(n);function n(e){var a;return(0,i.default)(this,n),(a=r.call(this,e)).handleTypeChange=function(){var e=(0,s.default)(o.default.mark((function e(t){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetchData({type:t});case 2:a.setState({type:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.fetchData=function(){var e=(0,s.default)(o.default.mark((function e(t){var r,n,l,c,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.type,n=(0,u.default)(t,["type"]),l=a.props,c=l.cluster,s=l.namespace,e.next=4,a.store[r].fetchList(D({cluster:c,type:r,namespace:s},n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleSelect=function(e){a.setState({selectItem:e})},a.handleCancel=function(){a.setState({selectItem:{}},(function(){a.props.onCancel()}))},a.handleOK=function(){var e=a.props.onSelect,t=a.state.selectItem;e({"kubernetes.io/hostname":(0,y.default)(t,'labels["kubernetes.io/hostname"]')})},a.renderRadio=function(){var e=a.state.type;return a.edgeDisabled?h.default.createElement(g.RadioGroup,{mode:"button",buttonWidth:120,value:e,onChange:a.handleTypeChange,size:"small"},h.default.createElement(g.RadioButton,{value:"node"},t("CLUSTER_NODE_PL")),h.default.createElement(g.RadioButton,{value:"edgenode"},t("EDGE_NODE_PL"))):null},a.state={type:"node",selectItem:{}},a.nodeStore=new S.default,a.edgeNodeStore=new _.default,a.store={node:a.nodeStore,edgenode:a.edgeNodeStore},a}return(0,f.default)(n,[{key:"componentDidMount",value:(a=(0,s.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData({type:this.state.type});case 2:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this,a=this.state,r=a.type,n=a.selectItem,l=(0,v.toJS)(this.store[r].list),u=l.data,o=l.total,c=l.page,s=l.isLoading;return h.default.createElement("div",{className:T.default.container},h.default.createElement("div",{className:T.default.body},h.default.createElement(g.Alert,{className:"margin-b8",message:t("WORKLOAD_SPECIFY_NODE_DESC"),hideIcon:!0}),this.renderRadio(),h.default.createElement("div",{className:T.default.nodes},h.default.createElement(b.default,{data:u,total:o,page:c,loading:s,onFetch:function(t){return e.fetchData(D({type:r},t))}},u.map((function(t,a){return h.default.createElement(C.default,{key:"".concat(t.uid).concat(a),module:r,detail:t,onClick:e.handleSelect,selected:n.uid===t.uid})}))))),h.default.createElement("div",{className:T.default.footer},h.default.createElement(g.Button,{onClick:this.handleCancel},t("CANCEL")),h.default.createElement(g.Button,{type:"control",onClick:this.handleOK},t("OK"))))}},{key:"edgeDisabled",get:function(){var e=this.props.cluster,t=(0,O.getHostClusterName)();return globals.app.hasKSModule("kubeedge")&&e===t}}]),n}(h.default.PureComponent))||c;a.default=N},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(66),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(66),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(5)),p=r(189),m=r(61),h=n(r(67)),v=r(332),E=n(r(802)),y=n(r(807)),g=n(r(800)),b=n(r(1444));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=function(e){(0,c.default)(r,e);var a=S(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).handleClick=function(){var t=e.props;(0,t.onClick)(t.detail)},e.renderStatus=function(a){var r=(0,v.getNodeStatus)(a),n=a.taints;return f.default.createElement(g.default,{title:f.default.createElement(f.default.Fragment,null,f.default.createElement(y.default,{type:r,name:t("NODE_STATUS_".concat(r.toUpperCase()))}),!(0,h.default)(n)&&"success"===a.importStatus&&f.default.createElement(p.Tooltip,{content:e.renderTaintsTip(n)},f.default.createElement("span",{className:b.default.taints},n.length))),description:t("STATUS")})},e.renderTaintsTip=function(e){return f.default.createElement("div",null,f.default.createElement("div",null,t("TAINTS"),":"),f.default.createElement("div",null,e.map((function(e){var t="".concat(e.key,"=").concat(e.value||"",":").concat(e.effect);return f.default.createElement("div",{key:t},t)}))))},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.detail,r=e.selected;return f.default.createElement("div",{className:(0,d.default)(b.default.item,(0,l.default)({},b.default.selected,r)),onClick:this.handleClick},f.default.createElement(p.Icon,{name:m.ICON_TYPES.nodes,size:20}),f.default.createElement("div",{className:b.default.ring}),f.default.createElement("div",{className:b.default.name},f.default.createElement(E.default,{icon:null,to:null,title:a.name,desc:a.ip})),this.renderStatus(a),f.default.createElement("div",null,f.default.createElement(g.default,{title:f.default.createElement(f.default.Fragment,null,a.role.join(",")),description:t("ROLE")})))}}]),r}(f.default.Component);a.default=_},function(e,t,a){e.exports={wrapper:"_4qArBgVOZGVzW4_C1mQa_",contentWrapper:"tfwFVypdnuobILZnE8mz",show:"_2QN_JwMvBPVk1cCzJZuTne",hide:"_31OFXbb7dMG8Z4GcJT7PB7",alert:"_2J-ZH7uleo6FGwk_vn2a-P",node:"_2_K8zkzSwO3NKwIB5qbvFK",selectnode:"_2RhfLv821EcdIrKTYxgob-",body:"_2erzUoyxi1dmIp0QGaU92y"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=r(17),c=n(r(68)),s=n(r(26)),i=n(r(191)),f=n(r(798)),d=n(r(819)),p=n(r(822)),m=n(r(438)),h=n(r(2661));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={"microservicegateway.create":{on:function(e){var a=e.store,r=e.namespace,n=e.cluster,l=e.success,o=(0,u.default)(e,["store","namespace","cluster","success"]),p=f.default.open(E({onOk:function(e){var u=[];(0,s.default)(e,"spec.deployment.template.spec.containers[0].ports",[]).forEach((function(e){u.push({name:e.name,protocol:e.protocol,port:e.servicePort,targetPort:e.containerPort})})),(0,c.default)(e,"spec.service.ports",u),""===(0,s.default)(e,"spec.service.type","")&&(0,c.default)(e,"spec.service.type","ClusterIP"),a.create(e,{cluster:n,namespace:r}).then((function(){f.default.close(p),i.default.success({content:t("CREATE_SUCCESSFUL")}),l&&l()}))},formTemplate:m.default.microservicegateways({namespace:r}),modal:d.default,steps:h.default,namespace:r,cluster:n,store:a},o))}},"microservicegateway.edit":{on:function(e){var a=e.store,r=e.namespace,n=e.cluster,l=e.detail,p=e.isEdit,m=void 0===p||p,v=e.title,y=void 0===v?t("EDIT_MICROSERVICE_GATEWAY"):v,g=e.okBtnText,b=void 0===g?t("OK"):g,S=e.success,_=(0,u.default)(e,["store","namespace","cluster","detail","isEdit","title","okBtnText","success"]),O=(0,o.toJS)(l._originData);"ClusterIP"===(0,s.default)(O,"spec.service.type","")&&(0,c.default)(O,"spec.service.type","");var C=f.default.open(E({onOk:function(e){var r=[];(0,s.default)(e,"spec.deployment.template.spec.containers[0].ports",[]).forEach((function(e){r.push({name:e.name,protocol:e.protocol,port:e.servicePort,targetPort:e.containerPort})})),(0,c.default)(e,"spec.service.ports",r),""===(0,s.default)(e,"spec.service.type","")&&(0,c.default)(e,"spec.service.type","ClusterIP"),a.update(l,e).then((function(){f.default.close(C),i.default.success({content:t("MODIFY_SUCCESSFUL")}),S&&S()}))},isEdit:m,title:y,okBtnText:b,formTemplate:O,modal:d.default,steps:h.default,namespace:r,cluster:n,store:a},_))}},"microservicegateway.delete":{on:function(e){var a=e.store,r=(e.resource,e.detail),n=e.cluster,l=e.namespace,o=e.success,c=(0,u.default)(e,["store","resource","detail","cluster","namespace","success"]),s=f.default.open(E({onOk:function(){a.delete({cluster:n,namespace:l,name:r.name}).then((function(){f.default.close(s),i.default.success({content:t("DELETED_SUCCESSFULLY")}),o&&o()}))},store:a,modal:p.default,type:"MICROSERVICE_GATEWAY",resource:r.name,cluster:n,namespace:l},c))}}};a.default=y},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(2662)),l=r(a(2665)),u=[{title:"GATEWAY_SETTINGS",component:n.default,required:!0},{title:"ADVANCED_SETTINGS",component:l.default,require:!0}];t.default=u},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(36),r(20),r(51),r(8),r(13),r(9),r(4),r(21),r(18),r(11),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(36),r(20),r(27),r(51),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(46),r(7),r(40);var l=n(r(317)),u=n(r(31)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(26)),m=n(r(68)),h=n(r(67)),v=n(r(163)),E=n(r(1445)),y=r(189),g=n(r(805)),b=n(r(843)),S=n(r(1135)),_=n(r(994)),O=n(r(1139)),C=n(r(1140)),T=n(r(1137)),R=r(61),D=r(249),k=n(r(874)),N=n(r(888)),I=n(r(2664));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var L=["limits.cpu","limits.memory","requests.cpu","requests.memory"],M=function(e){(0,s.default)(r,e);var a=w(r);function r(){var e;(0,o.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).quotaStore=new k.default,e.workspaceQuotaStore=new N.default,e.state={leftQuota:""},e.nameValidator=function(a,r,n){var l=e.props,u=l.namespace,o=l.cluster;return l.isEdit?n():r?void e.props.store.checkName({name:r,namespace:u,cluster:o}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()})):n()},e.handleNameChange=function(t){var a=t.slice(0,63);(0,m.default)(e.formTemplate,"spec.deployment.template.metadata.labels.app",a),(0,m.default)(e.formTemplate,'spec.deployment.template.metadata.labels["springcloud.kubesphere.io/app"]',a),(0,m.default)(e.formTemplate,"spec.deployment.template.spec.containers[0].name",a),(0,m.default)(e.formTemplate,"spec.deployment.selector.matchLabels.app",a),(0,m.default)(e.formTemplate,'spec.deployment.labels["springcloud.kubesphere.io/app"]',a)},e}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.initContainerPorts(),this.fetchQuota()}},{key:"initContainerPorts",value:function(){var e=(0,p.default)(this.formTemplate,"".concat(this.prefix,".ports")),t=(0,p.default)(this.formTemplate,"spec.service.ports");if(!(0,h.default)(e)){var a=e.map((function(e,a){return A(A({},e),{},{servicePort:(0,p.default)(t,"".concat(a,".port"))})}));(0,m.default)(this.formTemplate,"".concat(this.prefix,".ports"),a)}}},{key:"fetchQuota",value:function(){var e=this,t=this.props,a=t.workspace,r=t.cluster,n=t.namespace;Promise.all([this.quotaStore.fetch({cluster:r,namespace:n}),this.workspaceQuotaStore.fetchDetail({workspace:a,name:a,cluster:r})]).then((function(t){var a=(0,D.getLeftQuota)(t[1],(0,p.default)(t[0],"data")).workspace,r=(0,D.getUsedQuota)((0,p.default)(t[0],"data")),n={};L.forEach((function(e){var t=a[e],l=r[e];t&&!(0,v.default)(t)?n[e]=(0,E.default)(t,l):n[e]=void 0})),e.setState({leftQuota:n})}))}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.rootStore,n=e.namespace,u=e.cluster,o=e.isEdit;return d.default.createElement(y.Form,{ref:a,data:this.formTemplate},d.default.createElement(y.Columns,{className:I.default.columns},d.default.createElement(y.Column,null,d.default.createElement(y.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:R.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("NAME_DESC")})},{validator:this.nameValidator}]},d.default.createElement(y.Input,{name:"metadata.name",maxLength:63,autoFocus:!o,disabled:o,onChange:this.handleNameChange})))),d.default.createElement(y.Columns,{className:I.default.columns},d.default.createElement(y.Column,null,d.default.createElement(y.Form.Item,{label:t("IMAGE"),rules:[{required:!0,message:t("GATEWAY_IMAGE_EMPTY_DESC")}]},d.default.createElement(y.Input,{name:"spec.deployment.template.spec.containers[0].image",placeholder:"nginx:latest"}))),d.default.createElement(y.Column,null,d.default.createElement(y.Form.Item,{label:t("REPLICA_COUNT"),rules:[{required:!0,message:t("REPLICA_COUNT_EMPTY_DESC")}]},d.default.createElement(g.default,{name:"spec.deployment.replicas",defaultValue:1,min:1,integer:!0,controls:!0})))),d.default.createElement("div",{className:I.default.wrapper},d.default.createElement(y.Form.Item,null,d.default.createElement(b.default,(0,l.default)({name:"".concat(this.prefix,".resources")},this.resourceLimitProps)))),d.default.createElement(_.default,{prefix:this.prefix,withService:!0}),d.default.createElement(O.default,{prefix:this.prefix}),d.default.createElement(C.default,{prefix:this.prefix}),d.default.createElement(y.Form.Group,{label:t("ENVIRONMENT_VARIABLE_PL"),desc:t("CONTAINER_ENVIRONMENT_DESC"),checkable:!0},d.default.createElement(y.Form.Item,null,d.default.createElement(S.default,{name:"spec.deployment.template.spec.containers[0].env",rootStore:r,namespace:n,cluster:u}))),d.default.createElement(T.default,{prefix:this.prefix}))}},{key:"prefix",get:function(){return"spec.deployment.template.spec.containers[0]"}},{key:"formTemplate",get:function(){return this.props.formTemplate}},{key:"resourceLimitProps",get:function(){var e=this.state.leftQuota;return{defaultValue:{limits:{cpu:(0,p.default)(this.formTemplate,"".concat(this.prefix,'.resources["limits.cpu"]')),memory:(0,p.default)(this.formTemplate,"".concat(this.prefix,'.resources["limits.memory"]'))},requests:{cpu:(0,p.default)(this.formTemplate,"".concat(this.prefix,'.resources["requests.cpu"]')),memory:(0,p.default)(this.formTemplate,"".concat(this.prefix,'.resources["requests.memory"]'))}},workspaceLimitProps:(0,h.default)(e)?{}:{limits:{cpu:(0,p.default)(e,"limits.cpu"),memory:(0,p.default)(e,"limits.memory")},requests:{cpu:(0,p.default)(e,"requests.cpu"),memory:(0,p.default)(e,"requests.memory")}}}}}]),r}(d.default.Component);a.default=M},,function(e,t,a){e.exports={wrapper:"_2aGmg1SqGR_HAxgNvm2zes",columns:"_137ogh4mr41Ac3GAWRpjhP"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(2666));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(r,e);var a=p(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate;return i.default.createElement(f.Form,{data:r,ref:a},i.default.createElement(f.Form.Group,{label:t("EXTERNAL_ACCESS"),desc:t("SERVICE_EXTERNAL_ACCESS_DESC"),checkable:!0},i.default.createElement(d.default,{formTemplate:r})))}}]),r}(i.default.Component);a.default=m},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(26)),d=n(r(68)),p=n(r(196)),m=n(r(0)),h=r(189),v=n(r(829)),E=n(r(2667));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var S=function(e){(0,c.default)(r,e);var a=b(r);function r(e){var t;return(0,u.default)(this,r),(t=a.call(this,e)).handleAccessModeChange=function(e){if("LoadBalancer"===e){var a=(0,f.default)(t.formTemplate,"spec.service.annotations",{});a=g(g({},globals.config.loadBalancerDefaultAnnotations),a),(0,d.default)(t.formTemplate,"spec.service.annotations",a)}else Object.keys(globals.config.loadBalancerDefaultAnnotations).forEach((function(e){(0,p.default)(t.formTemplate,'spec.service.annotations["'.concat(e,'"]'))}));t.setState({mode:e})},t.optionRenderer=function(e){return m.default.createElement("div",{className:E.default.option},m.default.createElement("div",null,e.label),m.default.createElement("p",null,e.desc))},t.state={mode:(0,f.default)(t.formTemplate,"spec.service.type","ClusterIP")},t}return(0,o.default)(r,[{key:"render",value:function(){var e=this.state.mode;return m.default.createElement(m.default.Fragment,null,m.default.createElement(h.Form.Item,{label:t("ACCESS_MODE")},m.default.createElement(h.Select,{name:"spec.service.type",options:this.accessModes,onChange:this.handleAccessModeChange,optionRenderer:this.optionRenderer,placeholder:" "})),"LoadBalancer"===e&&m.default.createElement(h.Form.Item,{label:t("ANNOTATION_PL")},m.default.createElement(v.default,{name:"spec.service.annotations",hiddenKeys:globals.config.preservedAnnotations,addText:t("ADD")})))}},{key:"formTemplate",get:function(){return this.props.formTemplate}},{key:"accessModes",get:function(){return[{label:"NodePort",desc:t("ACCESS_NODEPORT_TIP"),value:"NodePort"},{label:"LoadBalancer",desc:t("ACCESS_LOADBALANCER_TIP"),value:"LoadBalancer"}]}}]),r}(m.default.Component);a.default=S},function(e,t,a){e.exports={wrapper:"_3gjtQxlJDCeZNKs50wvwrF",title:"cL9stDI8z0xGGtsGjFBWA",contentWrapper:"_3TShf0a0NSRmjIn5nojL0H",option:"_3WVSaQ0HCbYvIGbYKY9fkD"}},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(10),r(6),r(36),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(30),r(11),r(46),r(139),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(10),r(6),r(36),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(11),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(1050)),f=n(r(798)),d=n(r(819)),p=n(r(822)),m=n(r(2669)),h=n(r(2675)),v=n(r(2677)),E=n(r(2679)),y=n(r(2680)),g=n(r(2681)),b=n(r(2682)),S=n(r(2683)),_=n(r(2684)),O=n(r(2685)),C=n(r(2688)),T=n(r(119)),R=n(r(26)),D=n(r(67)),k=n(r(68)),N=n(r(438)),I=r(56);function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var w={"network.policies.add":{on:function(e){var a=e.store,r=e.success,n=(0,c.default)(e,["store","success"]),l=n.namespace,u=n.module,o=n.cluster,i=f.default.open(A({modal:b.default,onOk:function(e){(0,D.default)(e)?f.default.close(i):a.create(e,{cluster:o,namespace:l}).then((function(){f.default.close(i),s.default.success({content:t("CREATE_SUCCESSFUL")}),r&&r()}))},formTemplate:N.default[u]({namespace:l}),store:a},n))}},"network.policies.addIpBlock":{on:function(e){var a=e.store,r=e.success,n=(0,c.default)(e,["store","success"]),l=n.namespace,u=n.module,o=n.cluster,d=i.default.open(A({modal:_.default,onOk:function(e){(0,D.default)(e)?f.default.close(d):a.create(e,{cluster:o,namespace:l}).then((function(){f.default.close(d),s.default.success({content:t("CREATE_SUCCESSFUL")}),r&&r()}))},formTemplate:N.default[u]({namespace:l}),store:a},n))}},"network.policies.viewIpBlock":{on:function(e){var a=e.store,r=e.success,n=(0,c.default)(e,["store","success"]),l=n.namespace,u=n.module,o=n.cluster,d=i.default.open(A({modal:O.default,onOk:function(e){(0,D.default)(e)?f.default.close(d):a.create(e,{cluster:o,namespace:l}).then((function(){f.default.close(d),s.default.success({content:t("CREATE_SUCCESSFUL")}),r&&r()}))},formTemplate:N.default[u]({namespace:l}),store:a},n))}},"network.policies.editIpBlock":{on:function(e){var a,r,n,l,u=e.store,o=e.success,d=e.formTemplate,p=(e.onOk,e.onCancel,(0,c.default)(e,["store","success","formTemplate","onOk","onCancel"])),m=p.namespace,h=p.cluster,v=p.name,E=d,y=d.spec.egress?"egress":"ingress",g=(null==d||null===(a=d.spec)||void 0===a?void 0:a.egress)||(null==d||null===(r=d.spec)||void 0===r?void 0:r.ingress)||[],b=(null===(n=g[0])||void 0===n||null===(l=n.ports)||void 0===l?void 0:l.map((function(e){var t={};return e.protocol&&(t.protocol=null==e?void 0:e.protocol),e.port&&(t.port={},t.port.value=e.port.toString()),e.endPort&&(t.endPort={},t.endPort.value=e.endPort.toString()),t})))||[],S=(g[0].to?g[0].to:g[0].from||[]).map((function(e){var t=e.ipBlock.cidr.split("/");return{ip:{value:t[0]},mask:{value:t[1]}}}))||[];E.specType=y,E.portRules=b,E.cidrRules=S;var O=i.default.open(A({modal:_.default,onOk:function(e){(0,D.default)(e)?f.default.close(O):u.update({cluster:h,namespace:m,name:v},e).then((function(){f.default.close(O),s.default.success({content:t("MODIFY_SUCCESSFUL")}),o&&o()}))},formTemplate:E,store:u,edit:!0},p))}},"network.policies.toggle":{on:function(e){var a=e.success,r=(0,c.default)(e,["success"]),n=f.default.open(A({modal:p.default,onOk:function(){f.default.close(n),s.default.success({content:t("DISABLE_SUCCESSFUL")}),a&&a()}},r))}},"network.policies.delete":{on:function(e){var a=e.store,r=e.success,n=(e.onOk,e.onCancel,(0,c.default)(e,["store","success","onOk","onCancel"])),l=n.namespace,u=n.cluster,o=n.ruleName,i=f.default.open(A({modal:p.default,onOk:function(){a.delete({name:o,namespace:l,cluster:u}).then((function(){f.default.close(i),s.default.success({content:t("DELETED_SUCCESSFULLY")}),r&&r()}))},resource:o,store:a},n))}},"network.policies.addByYaml":{on:function(e){var t,a=e.store,r=(e.detail,e.success),n=(0,c.default)(e,["store","detail","success"]),o=n.cluster,s=f.default.open(A({modal:S.default,onOk:(t=(0,u.default)(l.default.mark((function e(t){var n;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,R.default)(t,"metadata.namespace"),e.next=3,a.create(t,{namespace:n,cluster:o});case 3:f.default.close(s),r&&r();case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),store:a},n))}},"network.ippool.add":{on:function(e){var a,r=e.store,n=e.success,o=e.isCalico,i=void 0!==o&&o,p=e.allList,m=(0,c.default)(e,["store","success","isCalico","allList"]),h=m.cluster,v=f.default.open(A({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,i;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=a.list,!(o=(0,I.cidrOverlap)(u,p))){e.next=4;break}return e.abrupt("return",s.default.error({content:t("CIDR_OVERLAP",{cidr0:o[0],cidr1:o[1]})}));case 4:return i=[],u.forEach((function(e){var t=e.workspace,a=(e.key,e.name),n=e.description,l=e.aliasName,u=(0,c.default)(e,["workspace","key","name","description","aliasName"]);delete u.nodeSelectorText,delete u.nodeSelectorLable;var o={apiVersion:"crd.projectcalico.org/v1",kind:"IPPool",metadata:{name:a,annotations:{"kubesphere.io/description":n,"kubesphere.io/alias-name":l}},spec:A({type:"calico"},u)};t&&("__ALL__"===t?(o.metadata.annotations["kubesphere.io/namespace"]="",(0,k.default)(o,'metadata.labels["ippool.network.kubesphere.io/default"]',"")):(0,k.default)(o,'metadata.labels["'.concat("kubesphere.io/namespace",'"]'),t)),i.push(r.create(o,{cluster:h}))})),e.next=8,Promise.all(i);case 8:f.default.close(v),s.default.success({content:t("CREATE_SUCCESSFUL")}),n&&n();case 11:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,title:t("CREATE_POD_IP_POOL"),formTemplate:{},steps:C.default,hideWorkspace:i,modal:d.default,noCodeEdit:!0},m))}},"network.ipool.assignworkspace":{on:function(e){var a,r=e.store,n=e.success,o=e.detail,i=(0,c.default)(e,["store","success","detail"]),d=f.default.open(A({modal:E.default,onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.patch(o,a);case 2:f.default.close(d),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:o},i))}},"network.ipool.assignnamespace":{on:function(e){var a,r=e.store,n=e.success,o=e.detail,i=(0,c.default)(e,["store","success","detail"]),d=f.default.open(A({modal:y.default,onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.patch(o,a);case 2:f.default.close(d),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:o},i))}},"network.ipool.autoAssign":{on:function(e){var a,r=e.store,n=e.success,o=e.detail,i=(0,c.default)(e,["store","success","detail"]),d=f.default.open(A({modal:g.default,onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.patch(o,a);case 2:f.default.close(d),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:o},i))}},"network.ipool.edit":{on:function(e){var t,a=e.store,r=e.success,n=e.detail,o=(0,c.default)(e,["store","success","detail"]),s=(0,T.default)(n),i=f.default.open(A(A({onOk:(t=(0,u.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.default.close(i),r&&r(t);case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),store:a,formTemplate:s},o),{},{modal:m.default}))}},"network.ipool.editoverlay":{on:function(e){var a,r=e.store,n=e.success,o=e.detail,i=(0,c.default)(e,["store","success","detail"]),d=f.default.open(A({modal:v.default,onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.patch(o,a);case 2:f.default.close(d),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:o},i))}},"network.ipool.disable":{on:function(e){var a,r=e.store,n=e.success,o=e.detail,i=e.cluster,d=(0,c.default)(e,["store","success","detail","cluster"]),p=f.default.open(A({modal:h.default,onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=a.old,!(c=a.new)){e.next=4;break}return e.next=4,r.migrate(i,u,c);case 4:return e.next=6,r.patch(o,{spec:{disabled:!0}});case 6:f.default.close(p),s.default.success({content:t("DISABLE_SUCCESSFUL")}),n&&n();case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),cluster:i,store:r,detail:o},d))}},"network.ipool.removeNamespace":{on:function(e){var a=e.store,r=e.success,n=(e.workspace,e.data),l=(0,c.default)(e,["store","success","workspace","data"]),u=l.namespace,o=l.cluster,i=f.default.open(A({modal:p.default,onOk:function(){a.patchNamespace({namespace:u,cluster:o},n).then((function(){f.default.close(i),s.default.success({content:t("DELETED_SUCCESSFULLY")}),r&&r()}))},store:a},l))}},"network.ipool.removeNamespaceAll":{on:function(e){var a,r=e.store,n=e.success,o=(e.workspace,e.data,(0,c.default)(e,["store","success","workspace","data"])),i=o.namespaceList,d=o.getData,m=o.cluster,h=f.default.open(A({modal:p.default,onOk:(a=(0,u.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],i.forEach((function(e){a.push(r.patchNamespace({namespace:e.name,cluster:m},d(e)))})),e.next=4,Promise.all(a);case 4:f.default.close(h),s.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n();case 7:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),store:r},o))}}};a.default=w},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(317)),o=l(r(50)),c=n(r(0)),s=r(865),i=l(r(1447)),f=function(e){var a=e.title,r=e.visible,n=e.onOk,l=e.onCancel,f=(0,o.default)(e,["title","visible","onOk","onCancel"]),d=c.useRef();return c.createElement(s.Modal,{width:960,visible:r,title:null!=a?a:t("EDIT_POD_IP_POOL"),onOk:function(){d.current&&d.current.validate((function(){n(d.current.getData())}))},onCancel:l,okText:t("EDIT")},c.createElement(i.default,(0,u.default)({},f,{formRef:d})))};a.default=f},,function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(20),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=b,r(12),r(10),r(6),r(20),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var u=l(r(31)),o=l(r(97)),c=r(189),s=l(r(5)),i=l(r(800)),f=l(r(119)),d=l(r(811)),p=l(r(1)),m=n(r(0)),h=l(r(106)),v=r(439),E=l(r(2672));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var a=e.value,r=e.onChange,n=m.useRef(),l=m.useState(Object.keys(a).length?a:{ipipMode:"Never",vxlanMode:"Never"}),u=(0,o.default)(l,2),p=u[0],y=u[1],b=(0,v.getOverlayStatus)(p),S=m.useState(!1),_=(0,o.default)(S,2),O=_[0],C=_[1],T=m.useRef(),R=m.useRef();m.useEffect((function(){(0,d.default)(p,a)||y(a)}),[a]);var D,k,N=function(){C(!O),y(a)},I=["Never","Always","CrossSubnet"].map((function(e){return{label:e,value:e}})),P=function(e){y(g(g({},p),{},{ipipMode:e,vxlanMode:"Never"===e?p.vxlanMode:"Never"}))},A=function(e){y(g(g({},p),{},{vxlanMode:e,ipipMode:"Never"===e?p.ipipMode:"Never"}))},w=function(){R.current&&R.current.validate((function(){r(p),C(!1)}))};return m.createElement("div",{ref:T,className:E.default.wrapper},m.createElement("div",{ref:T,className:(0,s.default)(E.default.value,E.default.card),onClick:N},m.createElement(i.default,{icon:"intranet-routers-duotone",title:null!==(D=b.type)&&void 0!==D?D:"-",description:t("IPPOOL_OVERLAY_MODE")}),b.value?m.createElement(i.default,{title:null!==(k=null==b?void 0:b.value)&&void 0!==k?k:"-",description:t("CONFIGURATION_MODE")}):m.createElement("span",null),m.createElement(c.Icon,{name:O?"chevron-up":"chevron-down",size:20})),O?h.default.createPortal(m.createElement("div",{ref:n,className:(0,s.default)(E.default.card,E.default.form)},m.createElement(c.Form,{ref:R,data:(0,f.default)(p)},m.createElement(c.Columns,null,m.createElement(c.Column,null,m.createElement(c.Form.Item,{label:t("IPIP_MODE"),rules:[{required:!0,message:t("IPIP_MODE_REQUIRED")}],desc:t("IPIP_MODE_DESC")},m.createElement(c.Select,{name:"ipipMode",options:I,onChange:P}))),m.createElement(c.Column,null,m.createElement(c.Form.Item,{label:t("VXLAN_MODE"),rules:[{required:!0,message:t("VXLAN_MODE_REQUIRED")}],desc:t("VXLAN_MODE_DESC")},m.createElement(c.Select,{name:"vxlanMode",options:I,onChange:A})))),m.createElement("div",{className:E.default.footer},m.createElement("div",{className:E.default.button,onClick:N},m.createElement(c.Icon,{name:"close",type:"light",size:16})),m.createElement("div",{className:E.default.button,onClick:w},m.createElement(c.Icon,{name:"check",type:"light",sizse:16}))))),T.current):null)}b.propTypes={value:p.default.object,onChange:p.default.func}},function(e,t,a){e.exports={wrapper:"_3k1EaXx8ZQXIX6sSacey4a",card:"_1dYTJ5SrSX7NRLmu6L6LYb",value:"_2vy4dOZcERxaaYuFIbWxwU",form:"_3rsGiv4J9BvSqXYeHNz3r4",footer:"_11z0-XOErj1iN_Zq31ARs4",button:"_3BpgBQlrs5BIHZJEw-hn3i"}},function(e,a,r){"use strict";r(16);var n=r(19);r(70),r(36),r(20),r(4),r(18),r(11),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(70),r(36),r(20),r(29),r(4),r(18),r(43),r(11),r(40);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(1174)),p=r(878),m=n(r(2674));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleNameChange=function(e,a){t.setState({keyName:a})},t.handleKeyChange=function(e){t.setState({key:e,values:[]},(function(){return t.handleChange()}))},t.handleOperatorChange=function(e){var a=t.state.values;["Exists","DoesNotExist"].includes(e)&&(a=void 0),"Match"===e&&(a=""),t.setState({operator:e,values:a},(function(){return t.handleChange()}))},t.handleValueChange=function(e){t.setState({values:e},(function(){return t.handleChange()}))},t.handleChange=function(){var e=t.state,a=e.key,r=e.operator,n=e.values,l=["Exists","DoesNotExist"].includes(r)?void 0:n||[],u={key:a,operator:r};l&&(u.values=l),"Match"===r&&(u.regexValue=n,delete u.values),t.props.onChange(u)},t.state=t.getInitialData(),t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){if(e.value!==this.props.value){var t=this.props.value||{},a=t.key,r=void 0===a?"":a,n=t.operator,l=void 0===n?"":n,u=t.values,o=void 0===u?[]:u,c=t.regexValue;this.setState({values:c||o,key:r,operator:l})}}},{key:"getInitialData",value:function(){var e=this.props.value||{};return{key:e.key,operator:e.operator,values:e.values}}},{key:"renderValues",value:function(){var e=this,a=this.state,r=a.operator,n=a.values;return"Exists"===r||"DoesNotExist"===r?null:"Match"===r?i.default.createElement("div",null,i.default.createElement(f.Input,{name:"regexValue",value:n,onChange:function(t,a){return e.handleValueChange(a)},placeholder:t("VALUES")})):i.default.createElement(d.default,{name:"values",placeholder:t("VALUES"),value:n,onChange:this.handleValueChange})}},{key:"render",value:function(){var e=this,a=this.state,r=a.key,n=a.operator;return i.default.createElement("div",{className:m.default.selectWrapper},i.default.createElement(f.Input,{name:"key",value:r,placeholder:t("KEY"),className:m.default.input,onChange:function(t,a){return e.handleKeyChange(a)}}),i.default.createElement(f.Select,{name:"operator",value:n,options:this.operators,onChange:this.handleOperatorChange,placeholder:t("CONDITION_OPERATOR")}),this.renderValues())}},{key:"operators",get:function(){return[{label:t("CONTAIN"),value:"In"},{label:t("NOT_CONTAIN"),value:"NotIn"},{label:t("EXIST"),value:"Exists"},{label:t("NOT_EXIST"),value:"DoesNotExist"}]}},{key:"severities",get:function(){return p.SEVERITY_LEVEL.map((function(e){return{label:t(e.label),value:e.value,level:e}}))}}]),r}(i.default.Component);a.default=v},function(e,t,a){e.exports={selectWrapper:"_1qxoMwjpMfT2ECkbDPgEyC",optionsContainer:"_2En2n1YkjikJFAxAmRnf4P",optionsList:"_3Tr3o2NsuAeAwYPy3AiFEZ",customSelect:"_1jj4-hS6FWN5Px1g6kx40o",iconWrapper:"XuNHzRkWa4luHSuhHl3vQ"}},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=O,r(12),r(109),r(3),r(10),r(6),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(317)),u=n(r(31)),o=n(r(97)),c=n(r(50)),s=r(189),i=n(r(798)),f=n(r(800)),d=n(r(1352)),p=n(r(26)),m=n(r(1)),h=n(r(0)),v=n(r(1001)),E=r(56),y=r(61),g=r(439),b=n(r(2676));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e){var a=e.detail,r=e.onCancel,n=e.cluster,u=e.store,m=(e.data,e.onOk),S=(0,c.default)(e,["store","data","onOk"]),O=h.default.useRef(),C=h.default.useState([]),T=(0,o.default)(C,2),R=T[0],D=T[1],k=h.default.useState(!1),N=(0,o.default)(k,2),I=N[0],P=N[1],A=h.default.useState(""),w=(0,o.default)(A,2),L=w[0],M=w[1],x=h.default.useRef(new v.default("ippools")),j=(0,p.default)(a,"status.capacity",0),U=(0,p.default)(a,"status.unallocated",0),F=(0,g.getOverlayStatus)(a);h.default.useEffect((function(){x.current.fetchMigrateIpPool({limit:-1,cluster:n,name:a.name}).then((function(e){D(e.map((function(e){return _(_({},e),{},{label:e.name,value:e.name})})))}))}),[a,E.getDisplayName]);var V=h.default.useMemo((function(){return Boolean(R.length)&&a.status.tunnel!==a.status.allocations}),[a,R]);return h.default.createElement(i.default,(0,l.default)({className:b.default.modal,hideHeader:!0,okText:t("OK"),onOk:function(){O.current?O.current.validate((function(){m({old:a.name,new:I?L:""})})):m({old:a.name,new:I?L:""})},onCancel:r,hideFooter:!1},S),h.default.createElement("div",null,h.default.createElement("div",{className:b.default.header},h.default.createElement("div",{className:b.default.title},h.default.createElement(s.Icon,{name:"error",size:20,type:"light",color:{secondary:"#ca2621"},className:"margin-r4"}),t("DISABLE_POD_IP_POOL")),h.default.createElement("span",{className:b.default.close,onClick:r},h.default.createElement(s.Icon,{name:"close",type:"light",size:20}))),h.default.createElement(s.Alert,{type:"warning",message:t("DISABLE_POD_IP_POOL_DESC"),className:"margin-b20"}),h.default.createElement("div",{className:b.default.card},h.default.createElement("div",{className:b.default.row},h.default.createElement(f.default,{title:(0,E.getDisplayName)(a),icon:y.ICON_TYPES[u.module],description:a.description||"-"}),h.default.createElement(f.default,{title:"".concat(j-U," / ").concat(j),description:t("USED_IP_ADDRESSES")}),h.default.createElement(f.default,{title:a.cidr,description:t("NETWORK_SEGMENT")}),h.default.createElement(f.default,{title:h.default.createElement("div",null,h.default.createElement("span",{className:"font-bold"},F.type),F.value&&h.default.createElement("span",{style:{marginLeft:"4px"}},"(",F.value,")")),description:t("IPPOOL_OVERLAY_MODE")}))),V&&h.default.createElement("div",{className:b.default.card},h.default.createElement(f.default,{className:"margin-b12",title:h.default.createElement("div",null,h.default.createElement(s.Checkbox,{className:"margin-r12",onChange:P,disabled:!R.length}),h.default.createElement("span",null,t("MIGRATE_POD_IP_POOL"))),description:h.default.createElement("span",{style:{marginLeft:28}},t("MIGRATE_POD_IP_POOL_DESC"))}),h.default.createElement(s.Form,{ref:O,data:{migrateIPPool:L}},I&&h.default.createElement("div",{className:b.default.container},h.default.createElement(s.Form.Item,{rules:[{required:!0,message:t("SELECT_POD_IP_POOL_DESC")}]},h.default.createElement(d.default,{name:"migrateIPPool",list:R,icon:"eip-group",value:L,onChange:M,hideColumns:["blockSize"]})))))))}O.propTypes={data:m.default.object,store:m.default.object,visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool,width:m.default.number},O.defaultProps={width:960}},function(e,t,a){e.exports={modal:"_32N1KA5lqz7Rhf6nPU_SmZ",header:"_4hqu6e02Ta7A-LqN1Yyd",title:"_3h5TnZmoUNq22890_EptHa",close:"_2VlHBgXP9K7HFVBhc1O0c2",card:"_5lACFwDW77C_ssV-M-3Jg",checkboxContainer:"_1vwW1jjBUCJY4itLFIiQvz",row:"_304cXBwAclHJqwD-zjE1lF",container:"_3SUCvKYYzGhhuhDyj9tJxL",option:"_36NfxJ2xc-ZSmIuzcBtjjW"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(20),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(317)),o=l(r(31)),c=l(r(97)),s=l(r(50));r(12),r(10),r(6),r(20),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var i=r(189),f=l(r(798)),d=l(r(811)),p=l(r(140)),m=l(r(244)),h=n(r(0)),v=l(r(2678));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g=["Never","Always","CrossSubnet"].map((function(e){return{label:e,value:e}})),b=function(e){var a=e.detail,r=e.onOk,n=(0,s.default)(e,["detail","onOk"]),l=h.useState((0,m.default)(a,["ipipMode","vxlanMode"])),o=(0,c.default)(l,2),E=o[0],b=o[1],S=h.useRef();h.useEffect((function(){(0,d.default)((0,m.default)(a,["ipipMode","vxlanMode"]),E)||b((0,m.default)(a,["ipipMode","vxlanMode"]))}),[a]);return h.createElement(f.default,(0,u.default)({icon:"pen",width:960,title:t("EDIT_OVERLAY_MODE")},n,{onOk:function(){S.current&&S.current.validate((function(){r(y(y({},a._originData),{},{spec:y(y({},(0,p.default)(a.spec,["ipipMode","vxlanMode"])),E)}))}))}}),h.createElement("div",{className:v.default.wrapper},h.createElement(i.Form,{ref:S,data:E},h.createElement(i.Columns,null,h.createElement(i.Column,null,h.createElement(i.Form.Item,{label:t("IPIP_MODE"),rules:[{required:!0,message:t("IPIP_MODE_REQUIRED")}],desc:t("IPIP_MODE_DESC")},h.createElement(i.Select,{name:"ipipMode",options:g,onChange:function(e){b(y(y({},E),{},{ipipMode:e,vxlanMode:"Never"===e?E.vxlanMode:"Never"}))}}))),h.createElement(i.Column,null,h.createElement(i.Form.Item,{label:t("VXLAN_MODE"),rules:[{required:!0,message:t("VXLAN_MODE_REQUIRED")}],desc:t("VXLAN_MODE_DESC")},h.createElement(i.Select,{name:"vxlanMode",options:g,onChange:function(e){b(y(y({},E),{},{vxlanMode:e,ipipMode:"Never"===e?E.ipipMode:"Never"}))}})))))))};a.default=b},function(e,t,a){e.exports={wrapper:"wA2KCcHnG5yzk7iMmYDMS"}},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var u=n(r(317)),o=n(r(58)),c=n(r(38));r(35);var s,i,f,d=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=r(189),g=n(r(798)),b=n(r(119)),S=n(r(26)),_=n(r(244)),O=n(r(68)),C=r(17),T=r(243),R=n(r(1)),D=l(r(0)),k=n(r(443)),N=r(56);function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var P="",A=(0,T.observer)((f=i=function(e){(0,h.default)(r,e);var a=I(r);function r(e){var n;return(0,p.default)(this,r),(n=a.call(this,e)).fetchWorkspaces=function(){var e=(0,d.default)(c.default.mark((function e(t){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.workspaceStore.fetchList(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.workspaceValidator=function(e,a,r){if(!a)return r();var l=n.props.detail,u=(0,S.default)(l,"status.allocations",0)>0;if((0,S.default)(l,"status.tunnel")===(0,S.default)(l,"status.allocations"))return r();var o=l.workspace;return u&&o&&a!==o?r({message:t("IPPOOL_ASSIGN_WORKSPACE_CHANGE_WARNING"),field:e.field}):u&&a!==P?r({message:t("IPPOOL_ASSIGN_WORKSPACE_ALLOCATED_WARNING"),field:e.field}):void r()},n.handleSubmit=function(e){var t=n.props.onOk,a={},r=(0,S.default)(e,"metadata.labels['kubesphere.io/workspace']");r===P?((0,O.default)(a,"metadata.labels['kubesphere.io/workspace']",null),(0,O.default)(a,"metadata.labels['ippool.network.kubesphere.io/default']","")):((0,O.default)(a,"metadata.labels['kubesphere.io/workspace']",r||null),(0,O.default)(a,"metadata.labels['ippool.network.kubesphere.io/default']",null)),t(a)},n.formTemplate=(0,b.default)((0,C.toJS)(e.detail._originData)),n.workspaceStore=new k.default,n}return(0,m.default)(r,[{key:"componentDidMount",value:function(){this.props.detail.isDefault&&(0,O.default)(this.formTemplate,"metadata.labels['kubesphere.io/workspace']",P),this.workspaceStore.fetchList({cluster:this.props.cluster})}},{key:"getWorkspaces",value:function(){return[{label:t("ALL"),value:P}].concat((0,o.default)(this.workspaceStore.list.data.map((function(e){return{label:(0,N.showNameAndAlias)(e.name,"workspace"),value:e.name}}))))}},{key:"render",value:function(){var e=this.props.detail,a=(0,S.default)(e,"status.allocations",0)>0,r=e.workspace;return D.default.createElement(g.default.Form,(0,u.default)({title:t("ASSIGN_WORKSPACE"),icon:"enterprise",width:691,data:this.formTemplate},this.props,{onOk:this.handleSubmit}),a&&r?D.default.createElement(y.Alert,{className:"margin-b12",type:"warning",message:t("IPPOOL_ASSIGN_WORKSPACE_ALLOCATED_WARNING")}):D.default.createElement(y.Alert,{className:"margin-b12",type:"info",message:t("IPPOOL_ASSIGN_WORKSPACE_DESC")}),D.default.createElement(y.Form.Item,{label:t("WORKSPACE"),desc:t("SELECT_WORKSPACE_DESC"),rules:[{validator:this.workspaceValidator}]},D.default.createElement(y.Select,{name:"metadata.labels['kubesphere.io/workspace']",options:this.getWorkspaces(),pagination:(0,_.default)(this.workspaceStore.list,["page","total","limit"]),isLoading:this.workspaceStore.list.isLoading,onFetch:this.fetchWorkspaces,searchable:!0,clearable:!0,placeholder:" "})))}}]),r}(D.Component),i.propTypes={detail:R.default.object,visible:R.default.bool,onOk:R.default.func,onCancel:R.default.func},i.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){}},s=f))||s;a.default=A},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var u=n(r(317)),o=n(r(58)),c=n(r(31)),s=n(r(38));r(35);var i,f,d,p=n(r(39)),m=n(r(25)),h=n(r(28)),v=n(r(41)),E=n(r(42)),y=n(r(37)),g=r(189),b=n(r(798)),S=n(r(119)),_=n(r(26)),O=n(r(244)),C=n(r(68)),T=r(17),R=r(243),D=n(r(1)),k=l(r(0)),N=n(r(441)),I=r(56);function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,y.default)(e);if(t){var n=(0,y.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,E.default)(this,a)}}var w="",L=(0,R.observer)((d=f=function(e){(0,v.default)(r,e);var a=A(r);function r(e){var n;return(0,m.default)(this,r),(n=a.call(this,e)).fetchProjects=function(){var e=(0,p.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.projectStore.fetchList(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.projectValidator=function(e,a,r){if(!a)return r();var l=n.props.detail,u=(0,_.default)(l,"status.allocations",0)>0;if((0,_.default)(l,"status.tunnel")===(0,_.default)(l,"status.allocations"))return r();var o=l.namespace;return u&&o&&a!==o?r({message:t("IPPOOL_ASSIGN_PROJECT_CHANGE_WARNING"),field:e.field}):u&&a!==w?r({message:t("IPPOOL_ASSIGN_PROJECT_ALLOCATED_WARNING"),field:e.field}):void r()},n.handleSubmit=function(e){var t=n.props.onOk,a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e),r=(0,_.default)(e,"metadata.labels['kubesphere.io/namespace']");r===w?((0,C.default)(a,"metadata.labels['kubesphere.io/namespace']",null),(0,C.default)(a,"metadata.labels['ippool.network.kubesphere.io/default']","")):((0,C.default)(a,"metadata.labels['kubesphere.io/namespace']",r||null),(0,C.default)(a,"metadata.labels['ippool.network.kubesphere.io/default']",null)),t(a)},n.formTemplate=(0,S.default)((0,T.toJS)(e.detail._originData)),n.projectStore=new N.default,n}return(0,h.default)(r,[{key:"componentDidMount",value:function(){this.props.detail.isDefault&&(0,C.default)(this.formTemplate,"metadata.labels['kubesphere.io/namespace']",w),this.projectStore.fetchList({cluster:this.props.cluster})}},{key:"getProjects",value:function(){return[{label:t("ALL"),value:w}].concat((0,o.default)(this.projectStore.list.data.map((function(e){return{label:(0,I.showNameAndAlias)(e,"name"),value:e.name}}))))}},{key:"render",value:function(){var e=this.props.detail,a=(0,_.default)(e,"status.allocations",0)>0,r=e.namespace;return k.default.createElement(b.default.Form,(0,u.default)({title:t("ASSIGN_PROJECT"),icon:"enterprise",width:691,data:this.formTemplate},this.props,{onOk:this.handleSubmit}),a&&r?k.default.createElement(g.Alert,{className:"margin-b12",type:"warning",message:t("IPPOOL_ASSIGN_PROJECT_ALLOCATED_WARNING")}):k.default.createElement(g.Alert,{className:"margin-b12",type:"info",message:t("IPPOOL_ASSIGN_PROJECT_DESC")}),k.default.createElement(g.Form.Item,{label:t("PROJECT"),desc:t("SELECT_PROJECT_DESC"),rules:[{validator:this.projectValidator}]},k.default.createElement(g.Select,{name:"metadata.labels['kubesphere.io/namespace']",options:this.getProjects(),pagination:(0,O.default)(this.projectStore.list,["page","total","limit"]),isLoading:this.projectStore.list.isLoading,onFetch:this.fetchProjects,searchable:!0,clearable:!0,placeholder:" "})))}}]),r}(k.Component),f.propTypes={detail:D.default.object,visible:D.default.bool,onOk:D.default.func,onCancel:D.default.func},f.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){}},i=d))||i;a.default=L},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var u,o,c,s=n(r(317)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=r(189),v=n(r(798)),E=n(r(119)),y=n(r(26)),g=n(r(68)),b=r(17),S=r(243),_=n(r(1)),O=l(r(0));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var T=(0,S.observer)((c=o=function(e){(0,d.default)(r,e);var a=C(r);function r(e){var t;return(0,i.default)(this,r),(t=a.call(this,e)).handleSubmit=function(e){var a=t.props.onOk,r=t.formTemplate,n=e.nodeSelector;(0,g.default)(r,"spec.nodeSelector",n),a(r)},t.formTemplate=(0,E.default)((0,b.toJS)(e.detail._originData)),t.state={nodeSelector:(0,y.default)(e.detail,"nodeSelector","all()")},t}return(0,f.default)(r,[{key:"getOptions",value:function(){return[{label:t("YES"),value:"all()"},{label:t("NO"),value:"!all()"}]}},{key:"render",value:function(){return O.default.createElement(v.default.Form,(0,s.default)({title:t("IPPOOL_AUTO_ASSIGN"),width:691,data:this.state},this.props,{onOk:this.handleSubmit}),O.default.createElement(h.Form.Item,{label:t("IPPOOL_IS_AUTO_ASSIGN")},O.default.createElement(h.Select,{name:"nodeSelector",options:this.getOptions(),clearable:!0,placeholder:" "})))}}]),r}(O.Component),o.propTypes={detail:_.default.object,visible:_.default.bool,onOk:_.default.func,onCancel:_.default.func},o.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){}},u=c))||u;a.default=T},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(138),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u,o,c,s,i,f,d=n(r(317)),p=n(r(31)),m=n(r(62)),h=n(r(25)),v=n(r(28)),E=n(r(74)),y=n(r(41)),g=n(r(42)),b=n(r(37)),S=n(r(45)),_=(n(r(63)),r(189)),O=n(r(5)),C=n(r(798)),T=n(r(801)),R=n(r(68)),D=r(17),k=r(243),N=n(r(0)),I=n(r(325)),P=r(56),A=r(1060),w=n(r(1449));function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,b.default)(e);if(t){var n=(0,b.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,g.default)(this,a)}}var j=(0,k.inject)("projectStore")(l=(0,k.observer)((u=function(e){(0,y.default)(r,e);var a=x(r);function r(e){var n;return(0,h.default)(this,r),n=a.call(this,e),(0,m.default)(n,"tabName",o,(0,E.default)(n)),(0,m.default)(n,"specType",c,(0,E.default)(n)),(0,m.default)(n,"specNameSpaces",s,(0,E.default)(n)),(0,m.default)(n,"specCurNameSpace",i,(0,E.default)(n)),(0,m.default)(n,"specServices",f,(0,E.default)(n)),n.handleTabChange=function(e){n.tabName=e,n.specNameSpaces=[],n.specCurNameSpace=n.props.namespace,n.specServices=[]},n.handleNameSpaceChange=function(e){var t=n.props.cluster;n.specCurNameSpace=e,n.serviceStore.fetchList({namespace:e,cluster:t,limit:-1})},n.handleNameSpaceChecked=function(e,t){var a=(0,E.default)(n),r=a.specNameSpaces,l=a.tabName,u=r.filter((function(t){return t.name===e.name})).length>0;t&&!u?(r.push({name:e.name}),n.specNameSpaces=(0,D.toJS)(r)):!t&&u&&(n.specNameSpaces=r.filter((function(t){return t.name!==e.name}))),n.psRef.current.handleValueChange("type",null,l)},n.handleServiceChange=function(e,t){var a=(0,E.default)(n),r=a.specCurNameSpace,l=a.specServices,u=a.tabName,o=l.filter((function(t){return t.name===e.name&&t.namespace===r})).length>0;t&&!o?(l.push({name:e.name,namespace:r}),n.specServices=(0,D.toJS)(l)):!t&&o&&(n.specServices=l.filter((function(t){return!(t.name===e.name&&t.namespace===r)}))),n.psRef.current.handleValueChange("type",null,u)},n.handleSave=function(){var e=(0,E.default)(n),t=e.tabName,a=e.specType,r=e.specNameSpaces,l=e.specServices,u=n.props.formTemplate,o="projects"===t?r.map((function(e){return{namespace:e}})):l.map((function(e){return{service:e}}));if(o.length){var c="egress"===a?"to":"from";(0,R.default)(u,"spec.".concat(a,"[0].").concat(c),o),(0,R.default)(u,"metadata.name","policy-".concat(c,"-").concat((0,P.generateId)()))}(0,R.default)(u,'metadata.labels.["kubesphere.io/policy-traffic"]',"inside"),(0,R.default)(u,'metadata.labels.["kubesphere.io/policy-type"]',a),n.props.onOk(u)},n.psValidator=function(e,a,r){var l=(0,E.default)(n),u=l.tabName,o=l.specNameSpaces,c=l.specServices;0===("projects"===u?o.map((function(e){return{namespace:e}})):c.map((function(e){return{service:e}}))).length?r({message:t("EMPTY_RESOURCE_DESC")}):r()},n.projectStore=e.projectStore,n.serviceStore=new I.default,n.specCurNameSpace=e.namespace,n.psRef=N.default.createRef(),n}return(0,v.default)(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.namespace,a={cluster:e.cluster,limit:-1};this.projectStore.fetchList(M(M({},a),{},{labelSelector:this.ProjectLabelSelector})),this.serviceStore.fetchList(M({namespace:t},a))}},{key:"render",value:function(){var e=this,a=this.projectStore.list,r=this.serviceStore.list,n=Object.assign({},this.props),l=this.specNameSpaces,u=this.specType,o=this.tabName,c=this.specCurNameSpace,s=this.specServices;return N.default.createElement(C.default.Form,(0,d.default)({width:600,title:t("ADD_ALLOWLIST_ENTRY"),closable:!0},n,{onOk:this.handleSave}),N.default.createElement(_.Form.Item,{label:t("TRAFFIC_DIRECTION"),desc:t("INTERNAL_TRAFFIC_DIRECTION_DESC"),rules:[{required:!0,message:t("SELECT_RULE_DIRECTION_TIP")}]},N.default.createElement(_.RadioGroup,{name:"direction",defaultValue:u,wrapClassName:w.default.dirCheck,onChange:function(t){e.specType=t}},N.default.createElement(_.RadioButton,{value:"egress"},N.default.createElement(_.Icon,{name:"upload",size:32}),N.default.createElement("div",null,t("EGRESS"))),N.default.createElement(_.RadioButton,{value:"ingress"},N.default.createElement(_.Icon,{name:"download",size:32}),N.default.createElement("div",null,t("INGRESS"))))),N.default.createElement(_.Form.Item,{label:t("TYPE"),rules:[{validator:this.psValidator}],ref:this.psRef},N.default.createElement(_.RadioGroup,{name:"type",mode:"button",buttonWidth:155,defaultValue:o,onChange:this.handleTabChange,size:"small",rules:[{required:!0}]},N.default.createElement(_.RadioButton,{value:"projects"},t("PROJECT")),N.default.createElement(_.RadioButton,{value:"services"},t("SERVICE")))),N.default.createElement(T.default,{className:(0,O.default)("projects"===o?"block":"hide",w.default.panel_p)},N.default.createElement("ul",{className:w.default.list},a.data.map((function(a){return N.default.createElement("li",{key:a.name},N.default.createElement(_.Checkbox,{value:a.name,checked:l.filter((function(e){return e.name===a.name})).length>0,disabled:a.isFedManaged,onChange:function(t){e.handleNameSpaceChecked(a,t)}},(0,P.showNameAndAlias)(a)),a.isFedManaged&&N.default.createElement(_.Tooltip,{content:t("FED_HOST_NAMESPACE_TIP")},N.default.createElement(_.Icon,{className:w.default.tip,name:"question"})))})))),N.default.createElement(T.default,{className:(0,O.default)("services"===o?"block":"hide",w.default.panel_s)},N.default.createElement("div",{className:w.default.sheader},N.default.createElement(A.ProjectSelect,{cluster:this.props.cluster,defaultValue:c,onChange:this.handleNameSpaceChange,tipMessage:t("FED_HOST_NAMESPACE_TIP"),labelSelector:this.ProjectLabelSelector})),N.default.createElement("div",{className:w.default.sbody},N.default.createElement("ul",{className:w.default.list},r.data.map((function(t){return N.default.createElement("li",{key:t.name},N.default.createElement(_.Checkbox,{value:t.name,checked:s.filter((function(e){return e.name===t.name&&e.namespace===c})).length>0,onChange:function(a){e.handleServiceChange(t,a)}},t.name))}))))))}},{key:"ProjectLabelSelector",get:function(){var e=this.props.workspace;return"!kubesphere.io/devopsproject,kubesphere.io/workspace=".concat(e)}}]),r}(N.default.Component),o=(0,S.default)(u.prototype,"tabName",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"projects"}}),c=(0,S.default)(u.prototype,"specType",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s=(0,S.default)(u.prototype,"specNameSpaces",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i=(0,S.default)(u.prototype,"specCurNameSpace",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=(0,S.default)(u.prototype,"specServices",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=u))||l)||l;a.default=j},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(163)),p=n(r(798)),m=n(r(861));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.props,a=e.onOk,r=e.onCancel,n=t.editor.current.getData();(0,d.default)(n)?r():a(n)},t.state={value:{kind:"NetworkPolicy",apiVersion:"networking.k8s.io/v1",metadata:{name:"",namespace:""},spec:{podSelector:{}}}},t.editor=i.default.createRef(),t}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting;return i.default.createElement(p.default,{icon:"firewall",title:t("CREATE_NETWORK_POLICY_TCAP"),description:t("CREATE_NETWORK_POLICY_DESC"),onOk:this.handleOk,onCancel:r,okText:t("OK"),visible:a,isSubmitting:n,width:960},i.default.createElement(m.default,{ref:this.editor,value:this.state.value}))}}]),r}(i.default.Component);a.default=v,v.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool,readOnly:f.default.bool},v.defaultProps={visible:!1,isSubmitting:!1,readOnly:!1,detail:{},onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(51),r(194),r(24),r(138),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(51),r(194),r(29),r(24),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(195),r(11),r(7);var l,u=n(r(317)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(243),h=n(r(68)),v=n(r(67)),E=n(r(119)),y=r(189),g=n(r(1050)),b=n(r(325)),S=r(61),_=n(r(1449));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var R=(0,m.inject)("projectStore")(l=(0,m.observer)(l=function(e){(0,i.default)(r,e);var a=T(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).modifyCIDR=function(e,a){var r=t.state.cidrRules,n=r[e];r[e]=C(C({},n),a),t.setState(r)},t.addCIDRRule=function(){var e=t.state.cidrRules;e.push({ip:{value:""},mask:{value:""}}),t.setState(e)},t.copyCIDRRule=function(e){var a=t.state.cidrRules;a.splice(e,0,(0,E.default)(a[e])),t.setState(a,(function(){t.validCIDR()}))},t.delCIDRRule=function(e){var a=t.state.cidrRules;a.length>1&&(a.splice(e,1),t.setState(a))},t.addPortRule=function(){var e=t.state.portRules;e.push({port:{value:""},protocol:"TCP"}),t.setState(e)},t.addPortRangeRule=function(){var e=t.state.portRules;e.push({port:{value:""},endPort:{value:""},protocol:"TCP"}),t.setState(e)},t.copyPortRule=function(e){var a=t.state.portRules;a.splice(e,0,(0,E.default)(a[e])),t.setState(a,(function(){t.validPort()}))},t.delPortRule=function(e){var a=t.state.portRules;a.length>1&&(a.splice(e,1),t.setState(a))},t.modifyRule=function(e,a){var r=t.state.portRules,n=r[e];r[e]=C(C({},n),a),t.setState(r,(function(){t.validPort()}))},t.isRepeatCIDR=function(e,t,a){var r=!1;return t.forEach((function(t,n){""!==t.ip.value&&""!==t.mask.value&&a>n&&t.ip.value+t.mask.value===e.ip.value+e.mask.value&&(r=!0)})),r},t.validCIDR=function(){var e=t.state.cidrRules.slice(),a=!0;return e.forEach((function(r,n){var l=t.isRepeatCIDR(r,e,n);r.ip.valid=!(0,v.default)(r.ip.value)&&S.PATTERN_IP.test(r.ip.value)&&!l,r.mask.valid=!(0,v.default)(r.mask.value)&&S.PATTERN_IP_MASK.test(r.mask.value)&&!l&&Number(r.mask.value)>-1&&Number(r.mask.value)<33,r.ip.valid&&r.mask.valid||(a=!1)})),t.setState({cidrRules:e}),a},t.isValidPort=function(e){return""!==e&&/^(?![0])(\d{0,5})$/.test(e)&&e<65536},t.isRepeatPort=function(e,t,a){var r=!1;return t.forEach((function(t,n){var l,u,o;""!==t.port.value&&""!==(null==t||null===(l=t.endPort)||void 0===l?void 0:l.value)&&a>n&&e.protocol+e.port.value+(null==e||null===(u=e.endPort)||void 0===u?void 0:u.value)===t.protocol+t.port.value+(null==t||null===(o=t.endPort)||void 0===o?void 0:o.value)&&(r=!0)})),r},t.validPort=function(){var e=t.state.portRules.slice(),a=!0;return e.forEach((function(r,n){var l=t.isRepeatPort(r,e,n),u=!0;(null==r?void 0:r.endPort)&&Number(r.endPort.value)-Number(r.port.value)<0&&(u=!1),r.port.valid=(0,v.default)(r.port.value)||t.isValidPort(r.port.value)&&!l&&u,(null==r?void 0:r.endPort)&&(r.endPort.valid=(0,v.default)(r.endPort.value)||t.isValidPort(r.endPort.value)&&!l&&u,r.port.valid||r.endPort.valid||(a=!1))})),t.setState({portRules:e}),a},t.validSpecType=function(){var e=t.state.specType;return""===e&&t.setState({specType:!1}),""!==e},t.validFormData=function(){return t.validSpecType()&&t.validCIDR()&&t.validPort()},t.handleSave=function(){var e=t.state,a=e.specType,r=e.cidrRules,n=e.portRules;if(t.validFormData()){var l=t.props.formTemplate,u=n.filter((function(e){return!(0,v.default)(e.port.value)})).map((function(e){var t,a;return{port:+e.port.value,endPort:(null===(t=e.endPort)||void 0===t?void 0:t.value)?+(null===(a=e.endPort)||void 0===a?void 0:a.value):void 0,protocol:e.protocol}})),o=r.filter((function(e){return!(0,v.default)(e.ip.value)&&!(0,v.default)(e.mask.value)})).map((function(e){return{ipBlock:{cidr:"".concat(e.ip.value,"/").concat(e.mask.value)}}})),c="egress"===a?"to":"from";(0,h.default)(l,"spec.".concat(a,"[0].ports"),u),(0,h.default)(l,"spec.".concat(a,"[0].").concat(c),o),(0,h.default)(l,'metadata.labels.["kubesphere.io/policy-traffic"]',"outside"),(0,h.default)(l,'metadata.labels.["kubesphere.io/policy-type"]',a),t.props.onOk(l)}},t.projectStore=e.projectStore,t.serviceStore=new b.default,t.state={specType:e.edit?e.formTemplate.specType:"",specNameSpaces:[],specServices:[],specCurNameSpace:e.namespace,protocols:[{value:"TCP",label:"TCP"},{value:"UDP",label:"UDP"},{value:"SCTP",label:"SCTP"}],cidrRules:e.edit&&e.formTemplate.cidrRules.length>0?e.formTemplate.cidrRules:[{ip:{value:""},mask:{value:""}}],portRules:e.edit&&e.formTemplate.portRules.length>0?e.formTemplate.portRules:[{port:{value:""},protocol:"TCP"}]},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.maxNameLength,n=void 0===r?63:r,l=a.formTemplate,o=a.formRef,c=a.edit,s=Object.assign({},this.props),i=this.state,f=i.specType,d=i.protocols,m=i.portRules,h=i.cidrRules,E=!1,b=!1,O=253===n?t("LONG_NAME_DESC"):t("NAME_DESC");return p.default.createElement(g.default.Form,(0,u.default)({width:900,title:c?t("EDIT_ALLOWLIST_ENTRY"):t("ADD_ALLOWLIST_ENTRY"),closable:!0},s,{onOk:this.handleSave,data:l,ref:o}),p.default.createElement(y.Columns,null,p.default.createElement(y.Column,null,p.default.createElement(y.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:S.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:O})}]},p.default.createElement(y.Input,{name:"metadata.name",maxLength:n,disabled:c})))),p.default.createElement(y.Columns,null,p.default.createElement(y.Column,null,p.default.createElement(y.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:S.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},p.default.createElement(y.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),p.default.createElement(y.Columns,null,p.default.createElement(y.Column,null,p.default.createElement(y.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},p.default.createElement(y.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))),p.default.createElement(y.Form.Item,{label:t("TRAFFIC_DIRECTION"),desc:f?t("EXTERNAL_TRAFFIC_DIRECTION_DESC"):p.default.createElement("span",{className:_.default.errColor},t("SELECT_RULE_DIRECTION_TIP"))},p.default.createElement(y.RadioGroup,{size:"large",name:"direction",defaultValue:f,wrapClassName:_.default.dirCheck,onChange:function(t){return e.setState({specType:t})}},p.default.createElement(y.RadioButton,{value:"egress"},p.default.createElement(y.Icon,{name:"upload",size:32}),p.default.createElement("div",null,t("EGRESS"))),p.default.createElement(y.RadioButton,{value:"ingress"},p.default.createElement(y.Icon,{name:"download",size:32}),p.default.createElement("div",null,t("INGRESS"))))),p.default.createElement("div",{className:_.default.title},t("NETWORK_SEGMENT")),h.map((function(a,r){var n=a.ip,l=a.mask;return!1!==n.valid&&!1!==l.valid||(b=!0),1===h.length&&((0,v.default)(n.value)||(0,v.default)(l.value))&&(b=!0),p.default.createElement("div",{className:_.default.cidrrow,key:"".concat(r," ")},p.default.createElement("div",{className:_.default.cidr},p.default.createElement(y.Input,{name:"cidr-ip",className:!1===n.valid?_.default.error:"",value:n.value,placeholder:t("NETWORK_SEGMENT_EXAMPLE"),onChange:function(t,a){return e.modifyCIDR(r,{ip:{value:a}})},onBlur:e.validCIDR}),p.default.createElement("span",null,"/"),p.default.createElement(y.Input,{name:"cidr-mask",className:!1===l.valid?_.default.error:"",placeholder:"24",value:l.value,onChange:function(t,a){return e.modifyCIDR(r,{mask:{value:a}})},onBlur:e.validCIDR})),p.default.createElement("div",null,p.default.createElement(y.Tooltip,{content:t("ADD_REPLICA")},p.default.createElement(y.Icon,{changeable:!0,clickable:!0,name:"copy",className:_.default.copy,onClick:function(){e.copyCIDRRule(r)}})),p.default.createElement(y.Tooltip,{content:t("DROP")},p.default.createElement(y.Icon,{changeable:!0,clickable:!0,name:"trash",onClick:function(){e.delCIDRRule(r)}}))))})),p.default.createElement("div",{className:_.default.addBtn},p.default.createElement(y.Button,{onClick:this.addCIDRRule},t("ADD_NEW_NETWORK_SEGMENT"))),b&&p.default.createElement("div",{className:_.default.errColor},t("ENTER_VALID_SEGMENT_DESC")),E&&p.default.createElement("div",{className:_.default.errColor},t("ENTER_VALID_PORT_NUMBER_DESC")),p.default.createElement("div",{className:_.default.title},t("PORT_PL")),m.map((function(a,r){var n=a.port,l=a.protocol,u=a.endPort,o=void 0===u?"":u;return!1===n.valid&&(E=!0),p.default.createElement("div",{className:_.default.rulerow,key:"".concat(r," ")},p.default.createElement("div",null,p.default.createElement(y.Select,{name:"proto",value:l,options:d,onChange:function(t){return e.modifyRule(r,{protocol:t})}}),o?p.default.createElement("div",null,p.default.createElement(y.Input,{placeholder:t("PORT_EXAMPLE"),className:!1===n.valid?_.default.error:"",value:n.value,onBlur:e.validPort,onChange:function(t,a){return e.modifyRule(r,{port:{value:a}})}}),p.default.createElement("span",null," - "),p.default.createElement(y.Input,{placeholder:t("PORT_EXAMPLE"),className:!1===o.valid?_.default.error:"",value:o.value,onBlur:e.validPort,onChange:function(t,a){return e.modifyRule(r,{endPort:{value:a}})}})):p.default.createElement(y.Input,{placeholder:t("PORT_EXAMPLE"),className:!1===n.valid?_.default.error:"",value:n.value,onBlur:e.validPort,onChange:function(t,a){return e.modifyRule(r,{port:{value:a}})}})),p.default.createElement("div",null,p.default.createElement(y.Tooltip,{content:t("REPLICA")},p.default.createElement(y.Icon,{changeable:!0,clickable:!0,name:"copy",className:_.default.copy,onClick:function(){e.copyPortRule(r)}})),p.default.createElement(y.Tooltip,{content:t("DROP")},p.default.createElement(y.Icon,{changeable:!0,clickable:!0,name:"trash",onClick:function(){e.delPortRule(r)}}))))})),p.default.createElement("div",{className:_.default.addBtn},p.default.createElement(y.Button,{onClick:this.addPortRangeRule},t("ADD_NEW_PORT_RANGE")),p.default.createElement(y.Button,{onClick:this.addPortRule},t("ADD_NEW_PORT"))),E&&p.default.createElement("div",{className:_.default.errColor},t("ENTER_VALID_PORT_NUMBER_DESC")))}}]),r}(p.default.Component))||l)||l;a.default=R},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(70),r(20),r(14),r(138),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(14),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(69),r(7);var l,u=n(r(317)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(243),h=n(r(5)),v=r(56),E=n(r(92)),y=r(804),g=n(r(67)),b=n(r(26)),S=r(189),_=n(r(2686)),O=n(r(1050)),C=n(r(2687));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var k=(0,m.inject)("rootStore")(l=(0,m.inject)("projectStore")(l=(0,y.trigger)(l=(0,m.observer)(l=function(e){(0,i.default)(r,e);var a=D(r);function r(e){var n;return(0,c.default)(this,r),(n=a.call(this,e)).editIpBlock=function(){var e=n.detailInfo.name;n.trigger("network.policies.editIpBlock",R(R({},n.props),{},{formTemplate:n.formTemplate,edit:!0,name:e,success:n.props.fetchOutside}))},n.handleDelete=function(){var e=n.detailInfo.name;n.trigger("network.policies.delete",R(R({},n.props),{},{ruleName:e,resource:n.detailInfo.name,type:"ALLOWLIST_ENTRY",success:function(){n.props.fetchOutside(),n.props.onCancel()}}))},n.getAttrs=function(){return[{name:t("CLUSTER"),value:n.clusters},{name:t("PROJECT"),value:n.detailInfo.namespace},{name:t("CREATION_TIME_TCAP"),value:(0,v.getLocalTime)(n.detailInfo.createTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("CREATOR"),value:n.detailInfo.creator}]},n.getOperations=function(){return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",show:n.enableActions.includes("edit"),onClick:function(){return n.editIpBlock()}},{key:"delete",icon:"trash",text:t("DELETE"),action:"edit",show:n.enableActions.includes("delete"),onClick:function(){return n.handleDelete()}}]},n.renderIpRules=function(e,t){return 0===(0,b.default)(e,"spec.".concat(t,"[0].").concat("egress"===t?"to":"from"),[]).length?p.default.createElement("div",{key:(0,b.default)(e,"metadata.name"),className:C.default.row},p.default.createElement("div",{className:C.default.prow},p.default.createElement("span",{className:C.default.cell},p.default.createElement(S.Icon,{name:"eip"})),(0,b.default)(e,"spec.".concat(t,"[0].ports"),[]).map((function(e,t){var a=e.endPort?"".concat(e.port,"-").concat(e.endPort,"/").concat(e.protocol):"".concat(e.port,"/").concat(e.protocol);return p.default.createElement("label",{key:a},0===t&&p.default.createElement(S.Icon,{name:"port"}),p.default.createElement("span",{className:C.default.port},p.default.createElement("b",null,a)))})))):p.default.createElement(p.default.Fragment,null,(0,b.default)(e,"spec.".concat(t,"[0].").concat("egress"===t?"to":"from"),[]).map((function(a,r){var n;return p.default.createElement(p.default.Fragment,null,p.default.createElement("div",{key:(0,b.default)(e,"metadata.name")+r,className:C.default.row},p.default.createElement("div",{className:C.default.prow},p.default.createElement("span",{className:C.default.cell},p.default.createElement(S.Icon,{name:"eip"}),p.default.createElement("b",{key:r},null==a||null===(n=a.ipBlock)||void 0===n?void 0:n.cidr)),(0,b.default)(e,"spec.".concat(t,"[0].ports"),[]).map((function(e,t){var a=e.endPort?"".concat(e.port,"-").concat(e.endPort,"/").concat(e.protocol):"".concat(e.port,"/").concat(e.protocol);return p.default.createElement("label",{key:a},0===t&&p.default.createElement(S.Icon,{name:"port"}),p.default.createElement("span",{className:C.default.port},p.default.createElement("b",null,a)))})))))})))},n.formTemplate=e.formTemplate,n.clusters=(0,b.default)(e.projectStore,"detail.cluster",[]),n}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formTemplate,r=e.formRef,n=Object.assign({},this.props),l=[],o=[],c=a;return(0,g.default)((0,b.default)(c,"spec.egress[0].ports"))?(0,g.default)((0,b.default)(c,"spec.egress[0].to"))||((0,g.default)((0,b.default)(c,"spec.egress[0].to[0].ipBlock"))?[].push(c):l.push(c)):l.push(c),(0,g.default)((0,b.default)(c,"spec.ingress[0].ports"))?(0,g.default)((0,b.default)(c,"spec.ingress[0].from"))||((0,g.default)((0,b.default)(c,"spec.ingress[0].from[0].ipBlock"))?[].push(c):o.push(c)):o.push(c),p.default.createElement(O.default.Form,(0,u.default)({width:900,title:t("ALLOWLIST_ENTRY_DETAIL"),closable:!0},n,{onOk:!1,data:a,ref:r}),p.default.createElement("div",{className:C.default.rulebody},p.default.createElement("div",{className:C.default.rulemenu},p.default.createElement("div",null,p.default.createElement("div",{className:C.default.rulename},this.detailInfo.aliasName?"".concat(this.detailInfo.name,"(").concat(this.detailInfo.aliasName,")"):this.detailInfo.name),p.default.createElement("div",null,this.detailInfo.description)),p.default.createElement(_.default,{className:C.default.more,options:this.getOperations(a)})),p.default.createElement("div",{className:C.default.collapseWrapper},p.default.createElement(S.Collapse,null,p.default.createElement(S.Collapse.CollapseItem,{label:t("ATTRIBUTES"),key:"p1"},this.getAttrs().map((function(e){var t=e.name,a=e.value;return p.default.createElement("div",null,p.default.createElement("div",{className:C.default.name},p.default.createElement("span",null,t,": ")),p.default.createElement("div",{className:C.default.value},a))}))))),p.default.createElement("div",{className:(0,h.default)(C.default.rulegroup,{hide:0===l.length})},p.default.createElement("div",{className:C.default.ruletitle},p.default.createElement(S.Icon,{name:"upload",size:32}),p.default.createElement("div",null,p.default.createElement("div",{className:C.default.subtitle},t("EGRESS")),p.default.createElement("div",{className:C.default.disp},t("EXTERNAL_EGRESS_DESC")))),this.renderIpRules(l[0],"egress")),p.default.createElement("div",{className:(0,h.default)(C.default.rulegroup,{hide:0===o.length})},p.default.createElement("div",{className:C.default.ruletitle},p.default.createElement(S.Icon,{name:"download",size:32}),p.default.createElement("div",null,p.default.createElement("div",{className:C.default.subtitle},t("INGRESS")),p.default.createElement("div",{className:C.default.disp},t("EXTERNAL_INGRESS_DESC")))),this.renderIpRules(o[0],"ingress"))))}},{key:"detailInfo",get:function(){return E.default.default(this.formTemplate)}},{key:"namespace",get:function(){return this.props.match.params.namespace}},{key:"enableActions",get:function(){return globals.app.getActions(R(R({module:"networkpolicies"},this.props.match.params),{},{project:this.namespace}))}}]),r}(p.default.Component))||l)||l)||l)||l;a.default=k},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(192),a(44),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(192),a(44),a(20),a(29),a(4),a(18),a(43),a(11);var l=n(a(50)),u=n(a(25)),o=n(a(28)),c=n(a(41)),s=n(a(42)),i=n(a(37)),f=r(a(0)),d=n(a(1)),p=n(a(67)),m=a(189);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(a,e);var t=h(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).handleMoreClick=function(t,a){var r=e.props.options.find((function(e){return e.key===a})).onClick;r&&r()},e}return(0,o.default)(a,[{key:"renderMoreOptions",value:function(){var e=this.props.options.map((function(e){var t=e.icon,a=e.text,r=e.show,n=void 0===r||r,u=(0,l.default)(e,["icon","text","show"]);return n?f.default.createElement(m.Menu.MenuItem,u,t&&f.default.createElement(m.Icon,{name:t,type:"light"})," ",f.default.createElement("span",{"data-test":"detail-".concat(u.key)},a)):null}));return e.every((function(e){return null===e}))?null:f.default.createElement(m.Menu,{onClick:this.handleMoreClick},e)}},{key:"render",value:function(){var e=this.props,t=e.options,a=e.className;if((0,p.default)(t))return null;var r=this.renderMoreOptions();return r?f.default.createElement(m.Dropdown,{theme:"dark",content:r},f.default.createElement(m.Button,{className:a,type:"flat",icon:"more"})):null}}]),a}(f.Component);t.default=v,v.propTypes={className:d.default.string,options:d.default.array},v.defaultProps={options:[]}},function(e,t,a){e.exports={rulemenu:"judtUMFa6uhc62Leqi0FF",rulename:"_3-aMREaT4Mv4YlYuonPcol",rulebody:"_2NK9zYAlsFLFnoaK3j5yHO",ruletitle:"_1CUprNz4zBb319IAfFzgde",rulegroup:"MLTSn1q_zq4IVpaCX8dKL",subtitle:"_3gPIujsGyjY1YqPjXX7kdO",disp:"_2-gSRm32lNKszgiFNOz695",row:"_2PxYjU94glauluQgdgJeff",prow:"_1bgOuUOZKQ7ifKmtpNF2L8",cell:"_1XSU-3U1JjBZ8SQDA36rpM",pcell:"_348B25AXH0Ez-4S2EF_mbc",port:"eT4sNzbO-woqzs77FtrHT",collapseWrapper:"_18k10KEQsISh9Xg2fc33nQ"}},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(2689)),u=n(r(2690)),o=[{title:t("IP_POOL_RANGE"),icon:"earth",component:l.default,required:!0},{title:t("POD_IP_POOL"),icon:"eip-group",component:u.default,required:!0}];a.default=o},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.formRef,r=e.formTemplate;return c.createElement(u.Form,{ref:a,data:r},c.createElement(u.Columns,null,c.createElement(u.Column,null,c.createElement(u.Form.Item,{label:t("IP_ADDRESS"),rules:[{required:!0,message:t("IP_ADDRESS_EMPTY_DESC")},{pattern:s.PATTERN_IP,message:t("INVALID_IP_DESC")}]},c.createElement(u.Input,{name:"ip"}))),c.createElement(u.Column,null,c.createElement(u.Form.Item,{label:t("MASK"),rules:[{required:!0,message:t("MASK_TIP")}]},c.createElement(o.default,{name:"mask",defaultValue:24,integer:!0,min:0,max:32})))),c.createElement(u.Form.Item,{label:t("QUANTITY"),desc:t("IP_POOL_CREATE_COUNT_DESC"),rules:[{required:!0,message:t("IP_POOL_NUM_TIP")}]},c.createElement(o.default,{name:"count",defaultValue:1,integer:!0,min:1,max:10})))};var u=r(189),o=l(r(805)),c=n(r(0)),s=r(61)},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(192),r(199),r(6),r(36),r(66),r(20),r(194),r(24),r(4),r(30),r(11),r(71),r(139),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(192),r(199),r(6),r(36),r(66),r(20),r(27),r(194),r(29),r(24),r(4),r(30),r(195),r(11),r(71),r(7),r(40);var l=n(r(58)),u=n(r(97)),o=n(r(0)),c=r(189),s=n(r(5)),i=n(r(807)),f=n(r(800)),d=n(r(840)),p=n(r(1447)),m=n(r(119)),h=n(r(68)),v=r(496),E=r(56),y=r(61),g=r(439),b=n(r(1448));var S=function(e){var a=e.formRef,r=e.formTemplate,n=e.store,S=e.setButtonProps,_=e.isOutdated,O=e.cluster,C=e.namespace,T=e.hideWorkspace,R=void 0!==T&&T,D=o.default.useState(),k=(0,u.default)(D,2),N=k[0],I=k[1],P=o.default.useState((function(){var e=r.ip,t=r.mask,a=r.count,n=void 0===a?1:a,l=[];if(y.PATTERN_IP.test(e)&&t&&n>0)for(var u=(0,E.generateId)(4),o=0,c=new v.Netmask("".concat(e,"/").concat(t)),s=function(){var e=c.toString();l.every((function(t){return t.cidr!==e}))&&l.push({key:"ippool-".concat(u,"-").concat(o),cidr:e,name:"ippool-".concat(u,"-").concat(o),workspace:void 0,blockSize:Number(t)>26?t:26,disabled:!1,ipipMode:"Always",vxlanMode:"Never",natOutgoing:!0,nodeSelector:"all()"}),o+=1,c=c.next()};o<n;)s();return l})),A=(0,u.default)(P,2),w=A[0],L=A[1];o.default.useEffect((function(){(0,h.default)(r,"list",w)}),[w]),o.default.useEffect((function(){(0,h.default)(r,"list",w)}),[w]);var M,x=o.default.useCallback((function(){I(null),S({ok:{}})}),[]),j=function(){var e,t,a=w.findIndex((function(e){return e.key===N.key})),r=(0,l.default)(w);N.nodeSelectorLable&&(N.nodeSelector=(e=N.nodeSelectorLable,t="",e.forEach((function(e){var a="",r="";switch(e.operator){case"NotIn":r=e.values.map((function(e){return'"'.concat(e,'"')})).join(","),a="".concat(e.key," not in {").concat(r,"}");break;case"In":r=e.values.map((function(e){return'"'.concat(e,'"')})).join(","),a="".concat(e.key," in {").concat(r,"}");break;case"Exists":a="has(".concat(e.key,")");break;case"DoesNotExist":a="!has(".concat(e.key,")")}t=t?"".concat(t," && ").concat(a):a})),t)),N.nodeSelectorText?N.nodeSelector=N.nodeSelectorText.replace(/'/g,'"'):N.nodeSelector=N.nodeSelector.replace(/'/g,'"');var n=Number(N.cidr.split("/")[1])||0;N.blockSize=n>(N.blockSize||0)?n<27?26:n:N.blockSize,r.splice(a,1,N),L(r),I(null),S({ok:{}})};return N?o.default.createElement(o.default.Fragment,null,o.default.createElement(p.default,{cluster:O,namespace:C,formRef:a,formTemplate:N,goBack:x,isOutdated:_,hideWorkspace:R,onOk:j}),o.default.createElement(d.default,{className:b.default.confirm,onOk:j,onCancel:x})):o.default.createElement(c.Form,{ref:a,data:r},(M=w,o.default.createElement("div",{className:b.default.container},M.map((function(e){var a,r=(0,g.getOverlayStatus)(e);return o.default.createElement("div",{key:e.key,className:(0,s.default)(b.default.card,b.default.listItem)},o.default.createElement(f.default,{title:(0,E.getDisplayName)(e),icon:y.ICON_TYPES[n.module],description:e.description||"-",className:b.default.info}),!_&&o.default.createElement(f.default,{title:o.default.createElement(i.default,{type:e.disabled?"Disabled":"Running",name:t(e.disabled?"DISABLED":"ENABLED")}),description:t("STATUS")}),o.default.createElement(f.default,{title:e.cidr,description:t("NETWORK_SEGMENT")}),o.default.createElement(f.default,{title:null!==(a=e.blockSize)&&void 0!==a?a:"-",description:t("IPPOOL_BLOCK_SIZE")}),!_&&o.default.createElement(f.default,{title:o.default.createElement("div",null,o.default.createElement("span",{className:"font-bold"},r.type),r.value&&o.default.createElement("span",{style:{marginLeft:"4px"}},"(",r.value,")")),description:t("IPPOOL_OVERLAY_MODE")}),o.default.createElement("div",{className:b.default.workspace}),o.default.createElement("div",{className:b.default.action},o.default.createElement(c.Button,{className:b.default.edit,onClick:function(){return function(e){I((0,m.default)(e)),S({ok:{disabled:!0}})}(e)}},o.default.createElement(c.Icon,{name:"pen",type:"dark",size:16})),!_&&o.default.createElement(c.Tooltip,{content:t("DISABLE_POD_IP_POOL")},o.default.createElement(c.Toggle,{checked:!e.disabled,onChange:function(t){return function(e,t){var a=w.findIndex((function(t){return t.key===e.key})),r=(0,l.default)(w);r[a].disabled=t,L(r)}(e,!t)}}))))})))))};a.default=S},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(36),r(14),r(8),r(13),r(9),r(4),r(21),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(36),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(798)),i=n(r(191)),f=n(r(2692)),d=n(r(822)),p=n(r(483));function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var h={"node.bound.node.group.ext":{on:function(e){var a,r=e.store,n=e.cluster,d=e.detail,h=e.success,v=(0,c.default)(e,["store","cluster","detail","success"]),E=s.default.open(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({onOk:(a=(0,u.default)(l.default.mark((function e(a){var r,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],(u=a.group)&&(o=new p.default,r.push(o.addGroupNode({cluster:n,group:u,node:d.name}))),e.next=5,Promise.all(r);case 5:i.default.success({content:t("BOUND_SUCCESSFULLY")}),s.default.close(E),h&&h();case 8:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:f.default,cluster:n,store:r},v))}},"node.unbound.node.group.ext":{on:function(e){var a=e.resource,r=e.params,n=e.store,l=e.success,u=s.default.open({onOk:function(){n.removeNodeGroupEdgeNode(r).then((function(){i.default.success({content:t("UNBOUND_NODE_GROUP_SUCCESSFULLY")}),s.default.close(u),l&&l()}))},store:n,modal:d.default,resource:a,title:t("UNBOUND_NODE_GROUP"),desc:t.html("UNBOUND_NODE_GROUP_TIP",{resource:a,nodegroup:r.nodegroup})})}}};a.default=h},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u=n(r(31)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=r(243),m=n(r(244)),h=n(r(798)),v=r(189),E=n(r(323)),y=n(r(483)),g=n(r(2693));function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var O=(0,p.observer)(l=function(e){(0,s.default)(r,e);var a=_(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).groupStore=new y.default,e.userStore=new E.default,e.state={groupIsLoading:!0,nodeGroups:[]},e.formRef=d.default.createRef(),e.getGroupData=function(t){var a=e.props.cluster;e.setState({groupIsLoading:!0}),e.groupStore.fetchList(S({cluster:a},t)).then((function(){e.setState({nodeGroups:e.groupStore.list.data.map((function(e){var t=e.aliasName?"(".concat(e.aliasName,")"):"";return{label:"".concat(e.name).concat(t),value:e.name}})),groupIsLoading:!1})}))},e.fetchUseList=function(t){e.userStore.fetchList(S({},t))},e.handleOnOk=function(){var t=e.props.onOk,a=e.formRef.current;a&&a.validate((function(){t(a.getData())}))},e}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.getGroupData(),this.fetchUseList()}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=(0,m.default)(this.groupStore.list,["page","limit","total"]);return d.default.createElement(h.default,{visible:a,width:600,title:t("BOUND_NODE_GROUP"),onOk:this.handleOnOk,onCancel:r},d.default.createElement("div",{className:g.default.tipText},t("BOUND_NODE_GROUP_TIP")),d.default.createElement(v.Form,{ref:this.formRef},d.default.createElement(v.Form.Item,{label:t("NODE_GROUP"),rules:[{required:!0,message:t("SELECT_A_NODE_GROUP")}]},d.default.createElement(v.Select,{name:"group",options:this.state.nodeGroups,pagination:n,isLoading:this.state.groupIsLoading,onFetch:this.getGroupData,placeholder:" "}))))}}]),r}(d.default.Component))||l;a.default=O},function(e,t,a){e.exports={tipText:"_2W1_5MF4srJM8wpFRxDSLR"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(66),r(20),r(14),r(8),r(13),r(9),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(70),r(66),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(7);var l=n(r(38)),u=n(r(58));r(35);var o=n(r(39)),c=n(r(31)),s=n(r(50)),i=r(17),f=n(r(191)),d=n(r(1062)),p=n(r(26)),m=n(r(67)),h=n(r(68)),v=n(r(1057)),E=n(r(798)),y=n(r(822)),g=n(r(1402)),b=n(r(2695)),S=n(r(2696)),_=n(r(2699)),O=n(r(2701)),C=n(r(2703));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var D={"node.add":{on:function(e){var t,a=e.kkName,r=e.success,n=(0,s.default)(e,["kkName","success"]),c=new v.default,f=E.default.open(R({modal:g.default,onOk:(t=(0,o.default)(l.default.mark((function e(t){var n,o,s;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.fetchDetail({name:a});case 2:return n=(0,i.toJS)(c.detail._originData),o=(0,p.default)(n,"spec.hosts",[]),s=(0,p.default)(n,"spec.roleGroups",{}),t.roles.forEach((function(e){s[e]=s[e]||[],s[e].push(t.name)})),(0,h.default)(n,"spec.hosts",[].concat((0,u.default)(o),[t])),(0,h.default)(n,"spec.roleGroups",s),e.next=10,c.update({name:a},n).then((function(){E.default.close(f),r&&r()}));case 10:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),store:c,addAfterCreate:!0},n))}},"node.type.add":{on:function(){E.default.open({modal:b.default})}},"node.add.log":{on:function(e){var t=e.detail;E.default.open({modal:S.default,detail:t})}},"node.labels":{on:function(e){var t=e.store,a=e.detail,r=e.success,n=(0,s.default)(e,["store","detail","success"]),l=(0,i.toJS)(a.labels),u=E.default.open(R({onOk:function(e){(0,d.default)(l,(function(t,a){(0,m.default)(e[a])&&(l[a]="")}));var n=R(R({},l),e);t.patch(a,{metadata:{labels:n}}).then((function(){E.default.close(u),r&&r()}))},value:l,modal:_.default,store:t},n))}},"node.taint":{on:function(e){var t=e.store,a=e.detail,r=e.success,n=(0,s.default)(e,["store","detail","success"]),l=E.default.open(R({onOk:function(e){t.patch(a,e).then((function(){E.default.close(l),r&&r()}))},value:(0,i.toJS)(a.taints),modal:O.default,store:t},n))}},"node.taint.batch":{on:function(e){var a=e.store,r=e.success,n=(0,i.toJS)(a.list),l=n.data,u=n.selectedRowKeys,o=l.filter((function(e){return u.includes(e.name)})),c=E.default.open({onOk:function(e){a.batchPatchTaints(e).then((function(){E.default.close(c),f.default.success({content:t("UPDATE_SUCCESSFUL")}),r&&r()}))},nodes:o,modal:C.default,store:a})}},"node.batch.delete":{on:function(e){var a,r=e.store,n=e.cluster,u=e.success,c=e.selectedNodes,i=e.resource,d=(0,s.default)(e,["store","cluster","success","selectedNodes","resource"]),p=c.map((function(e){return{nodeName:e.name,taskName:"del_node"}})),m=E.default.open(R({onOk:(a=(0,o.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.patchNode(n,p);case 2:E.default.close(m),f.default.success({content:t("DELETED_SUCCESSFULLY")}),u&&u();case 5:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),title:t("BATCH_ACTION",{action:t("DELETE")}),resource:i,modal:y.default,store:r},d))}},"node.batch.cancel.managed":{on:function(e){var a,r=e.store,n=e.cluster,u=e.success,c=e.selectedNodes,i=(0,s.default)(e,["store","cluster","success","selectedNodes"]),d=c.map((function(e){return e.name})),p=E.default.open(R({onOk:(a=(0,o.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.map((function(e){return{nodeName:e,taskName:"cancel_managed"}})),e.next=3,r.patchNode(n,a);case 3:E.default.close(p),f.default.success({content:t("CANCEL_MANAGED_SUCCESSFULLY")}),null==u||u();case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),type:"ACCESS_NODE",title:t("BATCH_ACTION",{action:t("CANCEL_MANAGED")}),resource:d.join(", "),modal:y.default,store:r},i))}}};a.default=D},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(798)),p=r(189);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(r,e);var a=m(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"render",value:function(){return f.default.createElement(d.default.Form,(0,l.default)({width:600,icon:"nodes",title:t("ADD_NODE_TYPE")},this.props),f.default.createElement(p.Form.Item,{label:t("TYPE_NAME"),desc:t("NAME_DESC")},f.default.createElement(p.Input,{name:"name",maxLength:63})),f.default.createElement(p.Form.Item,{label:t("DESCRIPTION"),desc:t("NODE_TYPE_DESCRIPTION_DEC")},f.default.createElement(p.TextArea,{name:"description"})))}}]),r}(f.default.Component);a.default=h},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=n(r(798)),m=n(r(1179)),h=n(r(1057)),v=r(243),E=n(r(2698));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=(0,v.observer)(l=function(e){(0,c.default)(r,e);var a=y(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).kubekeyClusterStore=new h.default,e.fetchPod=function(){var t=(0,d.default)(e.props,"detail.kkName");t&&e.kubekeyClusterStore.fetchDetail({name:t})},e}return(0,o.default)(r,[{key:"componentDidMount",value:function(){this.fetchPod()}},{key:"renderContent",value:function(){var e=(0,d.default)(this.kubekeyClusterStore.detail,"status.jobInfo",{}),t=e.namespace,a=e.pods,r=(0,d.default)(a,"[0].name"),n=(0,d.default)(a,"[0].containers[0].name");return f.default.createElement(m.default,{className:E.default.containerLog,contentClassName:E.default.containerLogContent,namespace:t,podName:r,containerName:n,isRealtime:!0})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return f.default.createElement(p.default,{bodyClassName:E.default.body,title:t("LOGS"),visible:a,onCancel:r,fullScreen:!0,hideFooter:!0},this.renderContent())}}]),r}(f.default.Component))||l;a.default=g},,function(e,t,a){e.exports={body:"_1YPo-YXSjXshsvOLc6vDAH",containerLog:"_1BDHwOP-bAWoN4kDG1yCjv",containerLogContent:"_3zKOo0nnc69mFUX5on-BCT"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(1)),m=n(r(5)),h=n(r(67)),v=r(189),E=n(r(798)),y=n(r(829)),g=n(r(2700));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=function(e){(0,s.default)(r,e);var a=b(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).handleOk=function(){(0,t.props.onOk)(t.state.value)},t.handleChange=function(e){t.setState({value:e})},t.handleError=function(e){t.setState({enableSave:(0,h.default)(e)})},t.state={value:e.value,enableSave:!0},t}return(0,c.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,r=t.value;a&&a!==e.visible&&r!==e.value&&this.setState({value:r})}},{key:"render",value:function(){var e=this.props,a=e.title,r=(e.onOk,(0,u.default)(e,["title","onOk"])),n=this.state,o=n.value,c=n.enableSave;return d.default.createElement(E.default.Form,(0,l.default)({width:1162,bodyClassName:g.default.body,title:t("EDIT_TITLE",{title:a}),icon:"pen",okText:t("OK"),onOk:this.handleOk,disableOk:!c},r),d.default.createElement("div",{className:g.default.wrapper},d.default.createElement("div",{className:(0,m.default)(g.default.title,"h5")},t(a)),d.default.createElement("div",{className:g.default.content},d.default.createElement(v.Form.Item,null,d.default.createElement(y.default,{className:g.default.inputs,addText:t("ADD"),value:o,onChange:this.handleChange,onError:this.handleError})))))}}]),r}(d.default.Component);a.default=S,S.propTypes={value:p.default.object,title:p.default.string,visible:p.default.bool,onOk:p.default.func,onCancel:p.default.func},S.defaultProps={visible:!1,title:"",onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={body:"nGOiMiUdF85Rmj9KRQgJy",wrapper:"_3gcATE4Hg6mOM-FIQJUKap",title:"_1TC3EKShLbFxFx5bge4ASR",content:"_3du1pxv0kFceCZAjUywg8s",inputs:"_1PO0E_3BPNCJdOqw1k0o1P"}},function(e,a,r){"use strict";r(16);var n=r(19);r(6),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(6),r(29),r(4),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(1)),m=r(189),h=n(r(798)),v=n(r(26)),E=n(r(67)),y=n(r(1450)),g=n(r(1452));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=function(e){(0,s.default)(r,e);var a=b(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).handleSubmit=function(e){var a=(0,v.default)(e,"spec.taints");if((0,E.default)(a))t.props.onOk(e);else{var r={},n=!0;a.forEach((function(e){r[e.key]?n=!1:r[e.key]=1})),n&&t.props.onOk(e)}},t.state={formData:{spec:{taints:e.value}}},t}return(0,c.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,r=t.value;a&&a!==e.visible&&e.value!==r&&this.setState({formData:{spec:{taints:r}}})}},{key:"render",value:function(){var e=this.props,a=(e.value,e.onOk,(0,u.default)(e,["value","onOk"]));return d.default.createElement(h.default.Form,(0,l.default)({width:1162,bodyClassName:g.default.body,title:t("EDIT_TAINTS"),icon:"wrench",okText:t("OK"),data:this.state.formData,onOk:this.handleSubmit},a),d.default.createElement("div",{className:g.default.wrapper},d.default.createElement("div",{className:g.default.title},t("TAINTS")),d.default.createElement(m.Alert,{type:"info",message:t("TAINTS_DESC")}),d.default.createElement("div",{className:g.default.content},d.default.createElement(m.Form.Item,null,d.default.createElement(y.default,{name:"spec.taints"})))))}}]),r}(d.default.Component);a.default=S,S.propTypes={value:p.default.array,visible:p.default.bool,onOk:p.default.func,onCancel:p.default.func},S.defaultProps={visible:!1,value:[{}],onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(317)),u=n(r(50)),o=n(r(0)),c=r(189),s=n(r(841)),i=n(r(1451)),f=function(e){var a=e.onSelect,r=e.onDelete,n=e.disabled,f=(0,u.default)(e,["onSelect","onDelete","disabled"]),d=[{label:t("NOSCHEDULE"),value:"NoSchedule"},{label:t("PREFERNOSCHEDULE"),value:"PreferNoSchedule"},{label:t("NOEXECUTE"),value:"NoExecute"}];return o.default.createElement("div",{className:i.default.item},o.default.createElement(s.default,(0,l.default)({className:i.default.inputs},f),o.default.createElement(c.Input,{name:"key",placeholder:t("KEY")}),o.default.createElement(c.Input,{name:"value",placeholder:t("VALUE")}),o.default.createElement(c.Select,{name:"effect",options:d,defaultValue:"NoSchedule"})),o.default.createElement("div",{className:i.default.tips},o.default.createElement(c.Tooltip,{content:o.default.createElement("div",{style:{width:200},dangerouslySetInnerHTML:{__html:t("TAINTS_TIPS")}})},o.default.createElement(c.Icon,{name:"question",size:16}))),o.default.createElement("div",{className:i.default.actions},a&&o.default.createElement(c.Tooltip,{content:t("TAINT_SELECT_TIPS")},o.default.createElement(c.Button,{type:"flat",icon:"add",className:i.default.select,disabled:n,onClick:a})),r&&o.default.createElement(c.Tooltip,{content:t("TAINT_DELETE_TIP")},o.default.createElement(c.Button,{type:"flat",icon:"trash",className:i.default.delete,onClick:r}))))};a.default=f},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(44),r(6),r(70),r(20),r(87),r(14),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(87),r(29),r(14),r(4),r(18),r(43),r(11),r(73),r(7);var l=n(r(317)),u=n(r(50)),o=n(r(58)),c=n(r(25)),s=n(r(28)),i=n(r(74)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(1)),v=n(r(67)),E=n(r(68)),y=n(r(2704)),g=n(r(2705)),b=n(r(884)),S=n(r(808)),_=n(r(26)),O=r(56),C=r(189),T=n(r(798)),R=n(r(1450)),D=n(r(1452));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var N=function(e){(0,f.default)(r,e);var a=k(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).getTaints=function(e){return e.taints||[{}]},t.getCommonTaints=function(e){var t=e.nodes;if((0,v.default)(t)||1===t.length)return[{}];var a=t.map((function(e){return e.taints})),r=y.default.apply(void 0,(0,o.default)(a).concat([function(e,t){return e.key===t.key&&e.value===t.value&&e.effect===t.effect}]));return(0,v.default)(r)?[{}]:r},t.getDifferentTaints=function(e){var a=t.getTaints(e).filter((function(e){return(0,v.default)(e.key)&&(0,v.default)(e.value)||!t.commonTaintsKeys.includes(e.key)}));return(0,v.default)(a)?[{}]:a},t.handleSubmit=function(){var e=t.state,a=e.nodes,r=e.commonTaints,n=a.map((function(e){var a=t.getTaints(e),n=[].concat((0,o.default)(a),(0,o.default)(r)).filter((function(e){return e.key})).reduce((function(e,t){return e.find((function(e){return e.key===t.key}))||e.push(t),e}),[]);return(0,E.default)(e,"taints",n),e})),l=!0;n.forEach((function(e){var t=(0,_.default)(e,"taints",[]),a={};t.forEach((function(e){a[e.key]?l=!1:a[e.key]=1}))})),l&&t.props.onOk(n)},t.handleChangeAll=(0,S.default)((function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.setState((function(r){var n=r.nodes,l=(0,o.default)(n);return l.forEach((function(e){var r=t.getTaints(e);a.key&&(0,b.default)(r,(function(e){return e.key===a.key})),(0,b.default)(r,(function(e){return t.commonTaintsKeys.includes(e.key)}))})),{nodes:l,commonTaints:(0,v.default)(e)?[{}]:e}}))}),100),t.handleChange=function(e,a){return(0,O.cacheFunc)("_change_".concat(a),(function(e){t.setState((function(t){var r=t.nodes,n=(0,o.default)(r);return(0,E.default)(n,"[".concat(a,"].taints"),e),{nodes:n}}))}),(0,i.default)(t))},t.handleSelect=function(e){return(0,O.cacheFunc)("_select_".concat(e),(function(e){e.key&&t.setState((function(t){var a=t.nodes,r=t.commonTaints;return a.forEach((function(t){var a=t.taints||[];t.taints=(0,g.default)(a,[e],"key").filter((function(e){return e.key}))})),r.push(e),{nodes:a,commonTaints:r.filter((function(e){return e.key}))}}))}),(0,i.default)(t))},t.state={nodes:e.nodes,commonTaints:t.getCommonTaints(e)},t}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible!==e.visible&&this.setState({nodes:this.props.nodes,commonTaints:this.getCommonTaints(this.props)})}},{key:"renderCommonTaints",value:function(){var e=this.state,a=e.nodes,r=e.commonTaints;return(0,v.default)(a)||1===a.length?null:m.default.createElement("div",{className:D.default.node},m.default.createElement("div",{className:D.default.subTitle},t("COMMON_TAINTS")),m.default.createElement(R.default,{value:r,onChange:this.handleChangeAll}))}},{key:"renderNodeTaints",value:function(){var e=this,t=this.state,a=t.nodes,r=t.commonTaints,n=(0,v.default)(a)||1===a.length;return a.map((function(t,a){var l=e.getDifferentTaints(t);return m.default.createElement("div",{key:t.name,className:D.default.node},m.default.createElement("div",{className:D.default.subTitle},t.name),m.default.createElement(R.default,{common:r,value:l,onSelect:n?null:e.handleSelect(a),onChange:e.handleChange(t,a)}))}))}},{key:"render",value:function(){var e=this.props,a=(e.detail,e.onOk,(0,u.default)(e,["detail","onOk"]));return m.default.createElement(T.default.Form,(0,l.default)({width:1162,bodyClassName:D.default.body,title:t("EDIT_TAINTS"),icon:"wrench",okText:t("OK"),onOk:this.handleSubmit},a),m.default.createElement("div",{className:D.default.wrapper},m.default.createElement("div",{className:D.default.title},t("TAINTS")),m.default.createElement(C.Alert,{type:"info",message:t("TAINTS_DESC")}),m.default.createElement("div",{className:D.default.content},this.renderCommonTaints(),this.renderNodeTaints())))}},{key:"commonTaintsKeys",get:function(){return this.state.commonTaints.map((function(e){return e.key}))}}]),r}(m.default.Component);a.default=N,N.propTypes={visible:h.default.bool,nodes:h.default.array,onOk:h.default.func,onCancel:h.default.func},N.defaultProps={visible:!1,nodes:[],onOk:function(){},onCancel:function(){}}},,,function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(10),a(6),a(27),a(33),a(16),a(8),a(13),a(9),a(4),a(7);var n=r(a(31)),l=r(a(50)),u=r(a(798)),o=r(a(2707));function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var s={"notification.user.setting":{on:function(e){var t=e.store,a=(e.success,(0,l.default)(e,["store","success"]));u.default.open(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({onOk:null,modal:o.default,store:t},a))}}};t.default=s},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(138),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(1)),v=n(r(5)),E=n(r(26)),y=n(r(201)),g=r(189),b=n(r(798)),S=n(r(840)),_=r(56),O=n(r(2708)),C=n(r(933));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var k=function(e){(0,f.default)(r,e);var a=D(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={activeTab:(0,E.default)(e.tabs,"[0].name"),updatedTabs:{},subRoute:{}},e.registerUpdate=function(t,a){var r=e.state.updatedTabs;(0,y.default)(r,t)||e.setState({updatedTabs:R(R({},r),{},(0,c.default)({},t,a))})},e.handleChangeTab=function(t){var a=t.currentTarget.dataset.name;a&&e.setState({activeTab:a,subRoute:{}})},e.handleSaveChanges=function(t){return function(){var a=e["".concat(t,"FormRef")].current,r=e["".concat(t,"Ref")].current;a&&a.validate((0,o.default)(u.default.mark((function n(){var l;return u.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=a.getData(),n.next=3,r.handleSubmit(l);case 3:e.cancelUpdate(t),r.fetchData();case 5:case"end":return n.stop()}}),n)}))))}},e.handleDiscardChanges=function(t){return function(){var a=e["".concat(t,"Ref")].current;a&&(a.resetData(),e.cancelUpdate(t))}},e.cancelUpdate=function(t){var a=R({},e.state.updatedTabs);delete a[t],e.setState({updatedTabs:a})},e.renderForm=function(t){var a=t.name,r=t.component,n=e.state.activeTab,l=r;if(!l)return null;var u="".concat(a,"Ref");e[u]||(e[u]=m.default.createRef());var o="".concat(a,"FormRef");return e[o]||(e[o]=m.default.createRef()),m.default.createElement("div",{key:a,className:(0,v.default)(C.default.formContainer,(0,c.default)({},C.default.active,a===n))},m.default.createElement(l,{ref:e[u],formRef:e[o]}))},e}return(0,i.default)(r,[{key:"getChildContext",value:function(){return{registerUpdate:this.registerUpdate}}},{key:"renderTabs",value:function(){var e=this;return m.default.createElement("ul",{className:C.default.tabs},this.tabs.map((function(a){var r=a.icon,n=void 0===r?"appcenter":r,l=a.title,u=a.name,o=e.state,s=o.activeTab,i=o.updatedTabs,f=u===s,d=f?"light":"dark";return m.default.createElement("li",{onClick:e.handleChangeTab,key:l,"data-name":u,className:(0,v.default)((0,c.default)({},C.default.active,f))},m.default.createElement(g.Tooltip,{placement:"bottomLeft",content:(0,y.default)(i,u)?e.updateTip:""},m.default.createElement("span",{className:C.default.tooltipTrigger},m.default.createElement(g.Icon,{name:n,size:20,type:d}),(0,y.default)(i,u)&&m.default.createElement("span",{className:C.default.tipIcon}))),m.default.createElement("p",null,t(l)))})))}},{key:"renderFormComponents",value:function(){var e=this.state,t=e.activeTab,a=e.updatedTabs;return m.default.createElement("div",{className:C.default.form},m.default.createElement("div",{className:(0,v.default)(C.default.wrapper,(0,c.default)({},C.default.wrapperActive,(0,y.default)(a,t)))},this.tabs.map(this.renderForm)),m.default.createElement(S.default,{className:(0,v.default)(C.default.confirm,(0,c.default)({},C.default.confirmActive,(0,y.default)(a,t))),onOk:this.handleSaveChanges(t),onCancel:this.handleDiscardChanges(t)}))}},{key:"renderLicenseTip",value:function(){return m.default.createElement("div",{className:C.default.licenseTip},m.default.createElement("div",{className:C.default.wrapper},m.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/notification-license-icon.svg",alt:""}),m.default.createElement("div",{className:C.default.content},m.default.createElement("div",{className:C.default.title},t("TENANT_NOTIFICATION")),m.default.createElement("p",null,t("TENANT_NOTIFICATION_DESC")),m.default.createElement("p",{className:C.default.tip},this.isAdmin?(0,_.htmlLinkControl)(t.html("TENANT_NOTIFICATION_LICENSE_ACTIVATION_TIP")):t("UNADMIN_TENANT_NOTIFICATION_LICENSE_ACTIVATION_TIP")))))}},{key:"renderContent",value:function(){return m.default.createElement("div",{className:C.default.content},m.default.createElement("div",{className:C.default.container},this.renderTabs(),this.renderFormComponents()))}},{key:"render",value:function(){var e=Object.assign({},this.props);return m.default.createElement(b.default,(0,l.default)({},e,{bodyClassName:C.default.body,title:t("NOTIFICATION_SETTINGS"),icon:"loudspeaker",width:1162,cancelText:t("CLOSE")}),this.renderContent())}},{key:"isAdmin",get:function(){return globals.app.isPlatformAdmin}},{key:"updateTip",get:function(){return m.default.createElement("div",{className:C.default.tip},m.default.createElement("h6",null,t("CONTENT_NOT_SAVED_TIPS")),m.default.createElement("p",null,t("SAVE_EDIT_HINTS")))}},{key:"tabs",get:function(){return O.default}}]),r}(m.default.Component);a.default=k,k.propTypes={visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func},k.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},k.childContextTypes={registerUpdate:h.default.func}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(2709)),l=r(a(2715)),u=r(a(2718)),o=r(a(2721)),c=r(a(2724)),s=r(a(2727)),i=[{icon:"email",name:"mail",title:"EMAIL",component:n.default},{icon:"feishu",name:"feishu",title:"FEISHU",component:s.default},{icon:"dingtalk",name:"dingtalk",title:"DINGTALK",component:l.default},{icon:"wecom",name:"wecom",title:"WECOM",component:u.default},{icon:"slack",name:"slack",title:"SLACK",component:o.default},{icon:"webhook",name:"webhook",title:"WEBHOOK",component:c.default}];t.default=i},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var l=n(r(38));r(35);var u,o,c,s=n(r(39)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=n(r(1)),E=r(17),y=r(243),g=n(r(26)),b=n(r(196)),S=n(r(68)),_=n(r(119)),O=n(r(67)),C=n(r(191)),T=n(r(801)),R=n(r(2710)),D=n(r(438)),k=n(r(965)),N=n(r(933));function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var P=(0,y.observer)((c=o=function(e){(0,d.default)(r,e);var a=I(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).receiverStore=new k.default,e.state={formData:{},isLoading:!1,noConfig:!0},e.formTemplate={receiver:D.default.notificationreceivers({name:e.receiverName,type:e.type})},e.fetchData=function(){e.setState({isLoading:!0}),e.receiverStore.fetchList({name:e.receiverName,user:globals.user.username,type:e.type}).then((function(){var t=(0,E.toJS)(e.receiverStore.list.data).find((function(t){return(0,g.default)(t,"name")===e.receiverName}));(0,O.default)(t)||(0,S.default)(e.formTemplate,"receiver",(0,g.default)(t,"_originData",{})),e.setState({formData:(0,_.default)(e.formTemplate),isLoading:!1,noConfig:(0,O.default)(t)})}))},e.resetData=function(){e.setState({formData:(0,_.default)(e.formTemplate)})},e.getResource=(0,s.default)(l.default.mark((function t(){var a;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.receiverStore.getResource({name:e.receiverName,user:globals.user.username});case 2:return a=t.sent,t.abrupt("return",{isExitReceiver:a});case 4:case"end":return t.stop()}}),t)}))),e.handleFormChange=function(t,a){e.context.registerUpdate(e.name,{name:t,value:a})},e.getVerifyFormTemplate=function(e){var t=(0,_.default)(e),a=t.config,r=t.receiver,n=t.secret;return(0,b.default)(r,"spec.email.alertSelector"),{config:a,receiver:r,secret:n}},e.handleSubmit=function(){var a=(0,s.default)(l.default.mark((function a(r){var n,u,o,c;return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=(0,_.default)(r),u=n.receiver,(0,b.default)(u,"metadata.resourceVersion"),a.next=4,e.getResource();case 4:if(o=a.sent,!o.isExitReceiver){a.next=12;break}return a.next=9,e.receiverStore.update({name:e.receiverName,user:globals.user.username},u);case 9:c=t("UPDATE_SUCCESSFUL"),a.next=16;break;case 12:return(0,S.default)(u,"spec.mail.enabled",!0),a.next=15,e.receiverStore.create(u,{name:e.receiverName,user:globals.user.username});case 15:c=t("CREATE_SUCCESSFUL");case 16:C.default.success({content:c,duration:1e3});case 17:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e}return(0,f.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.formData,r=t.isValidating,n=t.isLoading,l=t.noConfig;return h.default.createElement(T.default,{loading:n,className:N.default.panel},h.default.createElement("div",{className:N.default.wrapper},h.default.createElement(R.default,{noConfig:l,formRef:e,data:a,isValidating:r,hideFooter:!0,user:globals.user.username,onChange:this.handleFormChange,getVerifyFormTemplate:this.getVerifyFormTemplate})))}},{key:"name",get:function(){return"mail"}},{key:"type",get:function(){return"email"}},{key:"receiverName",get:function(){return"".concat(globals.user.username,"-email-receiver")}}]),r}(h.default.Component),o.contextTypes={registerUpdate:v.default.func},u=c))||u;a.default=P},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(26)),h=r(189),v=l(r(1061)),E=l(r(1430)),y=r(61),g=l(r(964)),b=l(r(2714)),S=l(r(1454));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=function(e){(0,i.default)(r,e);var a=_(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={checked:(0,m.default)(e.props.data,"config.spec.email.requireTLS",!1)},e.handleChangeCheck=function(t){e.setState({checked:t})},e}return(0,s.default)(r,[{key:"renderServiceSetting",value:function(){var e=this.state.checked;return p.default.createElement("div",{className:S.default.row},p.default.createElement("div",{className:S.default.title},t("SERVER_SETTINGS")),p.default.createElement("div",{className:S.default.item},p.default.createElement(h.Form.Item,{label:t("SMTP_SERVER_ADDRESS")},p.default.createElement(v.default,{className:S.default.urlInput,portName:"config.spec.email.smartHost.port",hostName:"config.spec.email.smartHost.host",hostRules:[{required:!0,message:t("ADDRESS_EMPTY_DESC")},{pattern:y.PATTERN_HOST,message:t("INVALID_ADDRESS_DESC")}],portRules:[{required:!0,message:t("ENTER_PORT_NUMBER")},{pattern:y.PATTERN_PORT,message:t("INVALID_PORT_DESC")}],defaultPort:25})),p.default.createElement(h.Form.Item,null,p.default.createElement(h.Checkbox,{className:S.default.sslCheckbox,name:"config.spec.email.requireTLS",checked:e,onChange:this.handleChangeCheck},t("USE_SSL_SECURE_CONNECTION"))),p.default.createElement(h.Form.Item,{label:t("SMTP_USER"),rules:[{required:!0,message:t("SMTP_USER_EMPTY_DESC")}]},p.default.createElement(h.Input,{name:"config.spec.email.authUsername",placeholder:"admin@example.com"})),p.default.createElement(h.Form.Item,{label:t("SMTP_PASSWORD"),rules:[{required:!0,message:t("ENTER_PASSWORD_TIP")}]},p.default.createElement(h.InputPassword,{name:"secret.data.authPassword",type:"password",autoComplete:"new-password"})),p.default.createElement(h.Form.Item,{label:t("SENDER_EMAIL"),rules:[{required:!0,message:t("EMAIL_EMPTY_DESC")},{type:"email",message:t("INVALID_EMAIL_ADDRESS_DESC")}]},p.default.createElement(E.default,{name:"config.spec.email.from",placeholder:"admin@example.com"}))))}},{key:"renderReceiverSetting",value:function(){var e=this.props.wrapperClassName;return p.default.createElement("div",{className:S.default.row},p.default.createElement("div",{className:S.default.title},t("RECIPIENT_SETTINGS")),p.default.createElement("div",{className:S.default.item},p.default.createElement(h.Form.Item,{rules:[{required:!0,message:t("ENTER_RECIPIENT_EMAIL_DESC")}]},p.default.createElement(b.default,{className:e,name:"receiver.spec.email.to"}))))}},{key:"renderLinkSub",value:function(){return p.default.createElement("div",{className:S.default.annotation},p.default.createElement(h.Icon,{name:"information"}),p.default.createElement("p",{className:S.default.desc},p.default.createElement("span",null,t("NOTIFICATION_EMAIL_SUBSCRIPTION_DESC")),p.default.createElement("a",{href:"/settings/notification-subscription/subscription-mail"},t("ADD_EMAIL_NOTIFICATION_SUBSCRIPTION"))))}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.data,r=e.onChange,n=e.hideFooter,l=(0,o.default)(e,["user","data","onChange","hideFooter"]);return p.default.createElement(g.default,(0,u.default)({name:"email",module:"mail",icon:"email",data:a,onChange:r,hideFooter:n,user:t},l),!t&&this.renderServiceSetting(),t&&this.renderReceiverSetting(),!t&&this.renderLinkSub())}}]),r}(p.Component);a.default=O},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(8),a(4),a(18),a(43),a(11);var n,l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(45)),f=a(17);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var p=(n=function(e){(0,o.default)(a,e);var t=d(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).module="verification",e}return(0,u.default)(a,[{key:"checkInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return request.post("".concat(this.apiVersion).concat(this.getPath(t),"/").concat(this.module),e)}},{key:"apiVersion",get:function(){return"kapis/notification.kubesphere.io/v2beta2"}}]),a}(r(a(1063)).default),(0,i.default)(n.prototype,"checkInfo",[f.action],Object.getOwnPropertyDescriptor(n.prototype,"checkInfo"),n.prototype),n);t.default=p},function(e,t,a){e.exports={selectWrapper:"_3Q-vSjBsPVa1cWcNQgDJR5",optionsContainer:"_2Wib9obMhM5UwdLP6qjC5T",optionsList:"_9pQC5xaI9f4MzBkYKGAZB",customSelect:"_2AQi3m6oVvbPaIYLHFR7xP",iconWrapper:"_33Att7kcwNaPZ8FzNU0Xcy"}},function(e,t,a){e.exports={header:"_22ALTOnSqv-OBctNSh-yr",action:"_387mT2Z_KU1mqOXU01FvHp",contentWrapper:"_2i9fUH4W721BffhnIB_30e",isHorizon:"CSYmHDLZQJUkow6PLs1_g",item:"_18KaqkEBKZYSEO-x5aX0C0",annotation:"_2DBwJ48w5esK1kqRCwiJEc",desc:"_1lJGDrMo-26yS66124FyQb",footer:"_13SX5rGpPIQlYwbnt4w2vS"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(20),r(98),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(98),r(29),r(4),r(18),r(43),r(30),r(195),r(11);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(1)),p=n(r(5)),m=n(r(67)),h=n(r(26)),v=r(189),E=n(r(828)),y=n(r(1007)),g=n(r(191)),b=r(61),S=n(r(323)),_=n(r(1454));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var C=function(e){(0,c.default)(r,e);var a=O(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).userStore=new S.default,e.validateMail=function(a){var r=e.props.value,n=globals.config.notification.wecom.max_number_of_email;if(a)if(r.length>n-1)g.default.error({content:t.html("MAX_EAMIL_COUNT",{count:n}),duration:1e3});else if(r.some((function(e){return e===a})))g.default.error({content:t("EMAIL_EXISTS"),duration:1e3});else{if(b.PATTERN_EMAIL.test(a))return!0;g.default.error({content:t("INVALID_EMAIL"),duration:1e3})}else g.default.error({content:t("EMAIL_EMPTY_DESC"),duration:1e3})},e.handleAdd=function(t){var a=e.props,r=a.value;(0,a.onChange)([].concat((0,l.default)(r),[t]))},e.handleDelete=function(t){var a=e.props,r=a.value;(0,a.onChange)(r.filter((function(e){return e!==t})))},e.renderListItem=function(a){return f.default.createElement("div",null,a," ",a===e.userEmail&&f.default.createElement(v.Tag,null,t("CURRENT_USER")))},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this,t=this.props,a=t.value,r=t.className;return f.default.createElement("div",{className:(0,p.default)(_.default.wrapper,r)},f.default.createElement(y.default,{placeholder:"user@example.com",validate:this.validateMail,onAdd:this.handleAdd,showIcon:!0}),!(0,m.default)(a)&&f.default.createElement("div",{className:_.default.listWrapper},f.default.createElement(E.default,null,a.map((function(t){return f.default.createElement(E.default.Item,{key:t,className:_.default.listItem,title:e.renderListItem(t),onDelete:function(){return e.handleDelete(t)}})})))))}},{key:"userEmail",get:function(){return(0,h.default)(globals,"user.email")}}]),r}(f.default.Component);a.default=C,C.propTypes={value:d.default.array,onChange:d.default.func},C.defaultProps={value:[],onChange:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(192),r(44),r(6),r(36),r(14),r(9),r(4),r(21),r(18),r(11),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(44),r(6),r(36),r(29),r(14),r(9),r(4),r(21),r(18),r(43),r(11),r(46),r(7),r(40);var l=n(r(97)),u=n(r(38));r(35);var o,c,s,i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),E=r(17),y=r(243),g=n(r(1)),b=n(r(64)),S=n(r(67)),_=n(r(26)),O=n(r(68)),C=n(r(196)),T=n(r(119)),R=n(r(191)),D=n(r(801)),k=n(r(2716)),N=n(r(965)),I=n(r(1064)),P=r(324),A=n(r(438)),w=n(r(933));function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var M=(0,y.observer)((s=c=function(e){(0,p.default)(r,e);var a=L(r);function r(){var e;(0,f.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).receiverStore=new N.default,e.secretStore=new I.default,e.state={formData:{},noConfig:!0},e.formTemplate={receiver:A.default.notificationreceivers({name:e.receiverName,type:e.type}),secret:e.secretFormTemplate},e.fetchData=(0,i.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({isLoading:!0}),t.next=3,Promise.all([e.receiverStore.fetchList({name:e.receiverName,user:globals.user.username,type:e.type}),e.secretStore.fetchList({name:e.secretName,user:globals.user.username})]).then((function(){var t=(0,E.toJS)(e.receiverStore.list.data).find((function(t){return(0,_.default)(t,"name")===e.receiverName})),a=(0,E.toJS)(e.secretStore.list.data).find((function(t){return(0,_.default)(t,"name")===e.secretName}));(0,S.default)(t)||(0,O.default)(e.formTemplate,"receiver",(0,_.default)(t,"_originData",{})),(0,S.default)(a)||(0,O.default)(e.formTemplate,"secret",a),e.setState({formData:(0,T.default)(e.formTemplate),isLoading:!1,noConfig:(0,S.default)(t)})}));case 3:case"end":return t.stop()}}),t)}))),e.resetData=function(){e.setState({formData:(0,T.default)(e.formTemplate)})},e.handleFormChange=function(t,a){e.context.registerUpdate(e.name,{name:t,value:a})},e.getVerifyFormTemplate=function(e){var t={},a=(0,T.default)(e),r=a.receiver,n=a.secret,l=(0,_.default)(r,"spec.dingtalk.conversation.chatids"),u=(0,_.default)(r,"spec.dingtalk.chatbot.keywords"),o=(0,_.default)(n,"data",{}),c=o.webhook,s=o.chatbotsecret;return(0,S.default)(l)||(0,O.default)(t,"receiver.spec.dingtalk.conversation.chatids",l),c&&(0,O.default)(t,"receiver.spec.dingtalk.chatbot.webhook.value",c),s&&(0,O.default)(t,"receiver.spec.dingtalk.chatbot.secret.value",s),(0,S.default)(u)||(0,O.default)(t,"receiver.spec.dingtalk.chatbot.keywords",u),t},e.handleVerify=function(e){var a=e.receiver,r=e.secret,n=(0,_.default)(a,"spec.dingtalk.chatbot.keywords"),l=(0,_.default)(a,"spec.dingtalk.conversation.chatids"),u=(0,_.default)(r,"data",{}),o=u.webhook,c=u.chatbotsecret;if([l,o,c,n].every((function(e){return(0,b.default)(e)?(0,S.default)(e):!e})))return R.default.error({content:t("DINGTALK_SETTING_TIP")}),!1;if(o||c||!(0,S.default)(n)){if(!o)return R.default.error({content:t("PLEASE_ENTER_VALUE_CUSTOM",{value:"Webhook URL"})}),!1;if(!c&&(0,S.default)(n))return R.default.error({content:t("DINGTALK_CHATBOT_SECURITY_TIP")}),!1}return!0},e.getResource=(0,i.default)(u.default.mark((function t(){var a,r,n,o;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.receiverStore.getResource({name:e.receiverName,user:globals.user.username}),e.secretStore.getResource({name:e.secretName,user:globals.user.username})]);case 2:return a=t.sent,r=(0,l.default)(a,2),n=r[0],o=r[1],t.abrupt("return",{isExitReceiver:n,isExitSecret:o});case 7:case"end":return t.stop()}}),t)}))),e.handleSubmit=function(){var a=(0,i.default)(u.default.mark((function a(r){var n,l,o,c,s,i,f,d;return u.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=(0,T.default)(r),l=n.receiver,o=n.secret,e.handleVerify(r)){a.next=3;break}return a.abrupt("return");case 3:return c=(0,_.default)(o,"data",{}),Object.keys(c).forEach((function(e){c[e]=(0,P.safeBtoa)(c[e])})),(0,O.default)(l,"spec.dingtalk.chatbot.webhook.valueFrom.secretKeyRef.key","webhook"),(0,O.default)(l,"spec.dingtalk.chatbot.webhook.valueFrom.secretKeyRef.name",e.secretName),(0,O.default)(l,"spec.dingtalk.chatbot.secret.valueFrom.secretKeyRef.key","chatbotsecret"),(0,O.default)(l,"spec.dingtalk.chatbot.secret.valueFrom.secretKeyRef.name",e.secretName),c.webhook||(0,C.default)(l,"spec.dingtalk.chatbot.webhook"),c.chatbotsecret||(0,C.default)(l,"spec.dingtalk.chatbot.secret"),(0,S.default)((0,_.default)(l,"spec.dingtalk.conversation.chatids"))&&(0,C.default)(l,"spec.dingtalk.conversation"),(0,S.default)((0,_.default)(l,"spec.dingtalk.chatbot.keywords"))&&(0,C.default)(l,"spec.dingtalk.chatbot.keywords"),(0,S.default)((0,_.default)(l,"spec.dingtalk.chatbot"))&&(0,C.default)(l,"spec.dingtalk.chatbot"),a.next=16,e.getResource();case 16:if(s=a.sent,i=s.isExitReceiver,f=s.isExitSecret,!i){a.next=25;break}return a.next=22,e.receiverStore.update({name:e.receiverName,user:globals.user.username},l);case 22:d=t("UPDATE_SUCCESSFUL"),a.next=29;break;case 25:return(0,O.default)(l,"spec.dingtalk.enabled",!0),a.next=28,e.receiverStore.create(l,{name:e.receiverName,user:globals.user.username});case 28:d=t("CREATE_SUCCESSFUL");case 29:if(!f){a.next=34;break}return a.next=32,e.secretStore.update({name:e.secretName,user:globals.user.username},(0,O.default)(e.secretTemplate,"data",c));case 32:a.next=36;break;case 34:return a.next=36,e.secretStore.create((0,O.default)(e.secretTemplate,"data",c),{name:e.secretName,user:globals.user.username});case 36:R.default.success({content:d,duration:1e3});case 37:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.formData,r=t.isLoading,n=t.noConfig;return v.default.createElement(D.default,{loading:r,className:w.default.panel},v.default.createElement(k.default,{formRef:e,noConfig:n,wrapperClassName:w.default.wrapper,data:a,onChange:this.handleFormChange,onVerify:this.handleVerify,getVerifyFormTemplate:this.getVerifyFormTemplate,hideFooter:!0,user:globals.user.username}))}},{key:"receiverName",get:function(){return"".concat(globals.user.username,"-dingtalk-receiver")}},{key:"secretName",get:function(){return"".concat(globals.user.username,"-dingtalk-config-secret")}},{key:"name",get:function(){return"dingtalk"}},{key:"type",get:function(){return"dingtalk"}},{key:"secretTemplate",get:function(){return A.default.globalsecret({name:this.secretName})}}]),r}(v.default.Component),c.contextTypes={registerUpdate:g.default.func},o=s))||o;a.default=M},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(70),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(29),r(4),r(18),r(43),r(11),r(73);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(26)),h=r(189),v=l(r(191)),E=l(r(964)),y=l(r(2717)),g=l(r(1182)),b=l(r(1181));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var _=h.Tabs.TabPanel,O=function(e){(0,i.default)(r,e);var a=S(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).validateCid=function(a){var r=(0,m.default)(e.props.data,"receiver.spec.dingtalk.conversation.chatids",[]),n=globals.config.notification.dingtalk.max_number_of_cid;if(a)if(r.length>n-1)v.default.error({content:t.html("MAX_CID_COUNT",{count:n}),durantion:1e3});else{if(!r.includes(a))return!0;v.default.error({content:t("CHAT_ID_EXISTS"),duration:1e3})}else v.default.error({content:t("ENTER_CHAT_ID_DESC"),durantion:1e3})},e.validateKeywords=function(a){var r=(0,m.default)(e.props.data,"receiver.spec.dingtalk.chatbot.keywords",[]),n=globals.config.notification.dingtalk.max_number_of_keyword;if(a)if(r.length>n-1)v.default.error({content:t.html("MAX_KEYWORD_COUNT",{count:n}),durantion:1e3});else{if(!r.includes(a))return!0;v.default.error({content:t("KEYWORD_EXISTS"),duration:1e3})}else v.default.error({content:t("ENTER_KEYWORD_DESC"),durantion:1e3})},e}return(0,s.default)(r,[{key:"renderLabel",value:function(){return p.default.createElement("div",{className:b.default.labelWrapper},p.default.createElement("span",null,"Chat ID"),this.props.user&&p.default.createElement(h.Tooltip,{content:t("CHAT_ID_TIP")},p.default.createElement(h.Icon,{className:b.default.tip,name:"question"})))}},{key:"renderServiceSetting",value:function(){return p.default.createElement("div",{className:b.default.row},p.default.createElement("div",{className:b.default.title},t("APP_SETTINGS")),p.default.createElement("div",{className:b.default.item},p.default.createElement(h.Form.Item,{label:"App Key"},p.default.createElement(h.Input,{name:"secret.data.appkey"})),p.default.createElement(h.Form.Item,{label:"App Secret"},p.default.createElement(h.Input,{name:"secret.data.appsecret"}))))}},{key:"renderReceiverSetting",value:function(){var e=this.props.wrapperClassName;return p.default.createElement("div",{className:b.default.row},p.default.createElement("div",{className:b.default.title},p.default.createElement("span",null,t("RECIPIENT_SETTINGS"))),p.default.createElement("div",{className:b.default.item},p.default.createElement(h.Form.Item,{label:this.renderLabel()},p.default.createElement(y.default,{className:e,name:"receiver.spec.dingtalk.conversation.chatids",title:"Chat ID",placeholder:" ",validate:this.validateCid}))))}},{key:"renderChatSetting",value:function(){var e=this.props.wrapperClassName;return p.default.createElement("div",{className:b.default.row},p.default.createElement("div",{className:b.default.title},p.default.createElement("span",null,t("CHATBOT_SETTINGS"))),p.default.createElement("div",{className:b.default.item},p.default.createElement(h.Form.Item,{label:"Webhook URL"},p.default.createElement(h.Input,{name:"secret.data.webhook"})),p.default.createElement(h.Form.Item,{label:"Secret"},p.default.createElement(h.Input,{name:"secret.data.chatbotsecret"})),p.default.createElement(h.Form.Item,null,p.default.createElement(g.default,{className:e,name:"receiver.spec.dingtalk.chatbot.keywords",validate:this.validateKeywords}))))}},{key:"render",value:function(){var e=this.props,a=e.user,r=e.data,n=e.onChange,l=e.hideFooter,c=(0,o.default)(e,["user","data","onChange","hideFooter"]);return p.default.createElement(E.default,(0,u.default)({name:"dingtalk",module:"DingTalk",icon:"dingtalk",data:r,onChange:n,hideFooter:l,user:a},c),p.default.createElement(h.Tabs,{type:"button"},p.default.createElement(_,{label:t("CHAT_SETTINGS"),name:"conversation"},p.default.createElement(p.default.Fragment,null,!a&&this.renderServiceSetting(),this.renderReceiverSetting())),p.default.createElement(_,{label:t("CHATBOT_SETTINGS"),name:"chatbot"},this.renderChatSetting())))}}]),r}(p.Component);a.default=O},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(10),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(10),a(20),a(29),a(4),a(18),a(43),a(11);var n=r(a(58)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=r(a(1)),d=r(a(5)),p=r(a(67)),m=r(a(828)),h=r(a(1007)),v=r(a(1181));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(a,e);var t=E(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,u=new Array(r),o=0;o<r;o++)u[o]=arguments[o];return(e=t.call.apply(t,[this].concat(u))).handleAdd=function(t){var a=e.props,r=a.value;(0,a.onChange)([].concat((0,n.default)(r),[t]))},e.handleDelete=function(t){var a=e.props,r=a.value;(0,a.onChange)(r.filter((function(e){return e!==t})))},e}return(0,u.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.value,r=t.placeholder,n=t.validate,l=t.className;return i.default.createElement("div",{className:(0,d.default)(v.default.wrapper,l)},i.default.createElement(h.default,{className:v.default.wrapper,placeholder:r,validate:n,onAdd:this.handleAdd}),!(0,p.default)(a)&&i.default.createElement("div",{className:v.default.listWrapper},i.default.createElement(m.default,null,a.map((function(t){return i.default.createElement(m.default.Item,{key:t,className:v.default.listItem,title:t,onDelete:function(){return e.handleDelete(t)}})})))))}}]),a}(i.default.Component);t.default=y,y.propTypes={value:f.default.array,onChange:f.default.func},y.defaultProps={value:[],onChange:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(6),r(36),r(14),r(9),r(4),r(21),r(18),r(11),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(6),r(36),r(29),r(14),r(9),r(4),r(21),r(18),r(43),r(11),r(46),r(7),r(40);var l=n(r(97)),u=n(r(38));r(35);var o,c,s,i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),E=n(r(1)),y=r(17),g=r(243),b=n(r(68)),S=n(r(26)),_=n(r(196)),O=n(r(119)),C=n(r(67)),T=r(324),R=n(r(191)),D=n(r(801)),k=n(r(2719)),N=n(r(438)),I=n(r(965)),P=n(r(1064)),A=n(r(933));function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var L=(0,g.observer)((s=c=function(e){(0,p.default)(r,e);var a=w(r);function r(){var e;(0,f.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).receiverStore=new I.default,e.secretStore=new P.default,e.state={formData:{},isLoading:!1,noConfig:!0},e.formTemplate={receiver:N.default.notificationreceivers({name:e.receiverName,type:e.type}),secret:e.secretFormTemplate},e.fetchData=(0,i.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({isLoading:!0}),t.next=3,Promise.all([e.receiverStore.fetchList({name:e.receiverName,user:globals.user.username,type:e.type}),e.secretStore.fetchList({name:e.secretName,user:globals.user.username})]).then((function(){var t=(0,y.toJS)(e.receiverStore.list.data).find((function(t){return(0,S.default)(t,"name")===e.receiverName})),a=(0,y.toJS)(e.secretStore.list.data).find((function(t){return(0,S.default)(t,"name")===e.secretName}));(0,C.default)(t)||(0,b.default)(e.formTemplate,"receiver",(0,S.default)(t,"_originData",{})),(0,C.default)(a)||(0,b.default)(e.formTemplate,"secret",a),e.setState({formData:(0,O.default)(e.formTemplate),isLoading:!1,noConfig:(0,C.default)(t)})}));case 3:case"end":return t.stop()}}),t)}))),e.resetData=function(){e.setState({formData:(0,O.default)(e.formTemplate)})},e.handleFormChange=function(t,a){e.context.registerUpdate(e.name,{name:t,value:a})},e.getVerifyFormTemplate=function(e){var t=(0,O.default)(e),a=t.config,r=t.receiver,n=t.secret,l=(0,S.default)(n,"data",{}).webhook;return l?((0,b.default)(r,"spec.wechat.chatbot.webhook.value",l),(0,_.default)(r,"spec.wechat.toUser"),(0,_.default)(a,"spec.wechat.wechatApiAgentId"),(0,_.default)(a,"spec.wechat.wechatApiCorpId"),(0,_.default)(a,"spec.wechat.wechatApiSecret")):(0,b.default)(a,"spec.wechat.wechatApiSecret.value",(0,S.default)(n,"data.appsecret")),(0,b.default)(a,"spec.wechat.wechatApiSecret.value",(0,S.default)(n,"data.appsecret")),(0,_.default)(r,"spec.wechat.alertSelector"),(0,_.default)(a,"spec.wechat.wechatApiSecret.valueFrom"),{config:a,receiver:r,secret:n}},e.getResource=(0,i.default)(u.default.mark((function t(){var a,r,n,o;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.receiverStore.getResource({name:e.receiverName,user:globals.user.username}),e.secretStore.getResource({name:e.secretName,user:globals.user.username})]);case 2:return a=t.sent,r=(0,l.default)(a,2),n=r[0],o=r[1],t.abrupt("return",{isExitReceiver:n,isExitSecret:o});case 7:case"end":return t.stop()}}),t)}))),e.handleSubmit=function(){var a=(0,i.default)(u.default.mark((function a(r){var n,l,o,c,s,i,f,d,p,m;return u.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=(0,O.default)(r),l=n.receiver,o=n.secret,c=(0,S.default)(o,"data",{}),s=c.webhook,i=(0,S.default)(o,"data",{}),Object.keys(i).forEach((function(e){i[e]=(0,T.safeBtoa)(i[e])})),s&&(0,b.default)(l,"spec.wechat.chatbot.webhook.value",s),a.next=7,e.getResource();case 7:if(f=a.sent,d=f.isExitReceiver,p=f.isExitSecret,!d){a.next=16;break}return a.next=13,e.receiverStore.update({name:e.receiverName,user:globals.user.username},l);case 13:m=t("UPDATE_SUCCESSFUL"),a.next=20;break;case 16:return(0,b.default)(l,"spec.wechat.enabled",!0),a.next=19,e.receiverStore.create(l,{name:e.receiverName,user:globals.user.username});case 19:m=t("CREATE_SUCCESSFUL");case 20:if(!p){a.next=25;break}return a.next=23,e.secretStore.update({name:e.secretName,user:globals.user.username},(0,b.default)(e.secretTemplate,"data",i));case 23:a.next=27;break;case 25:return a.next=27,e.secretStore.create((0,b.default)(e.secretTemplate,"data",i),{name:e.secretName,user:globals.user.username});case 27:R.default.success({content:m,duration:1e3});case 28:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.formData,r=t.isLoading,n=t.noConfig;return v.default.createElement(D.default,{loading:r,className:A.default.panel},v.default.createElement(k.default,{noConfig:n,wrapperClassName:A.default.wrapper,formRef:e,data:a,hideFooter:!0,user:globals.user.username,onChange:this.handleFormChange,getVerifyFormTemplate:this.getVerifyFormTemplate}))}},{key:"receiverName",get:function(){return"".concat(globals.user.username,"-wechat-receiver")}},{key:"secretName",get:function(){return"".concat(globals.user.username,"-wechat-config-secret")}},{key:"secretTemplate",get:function(){return N.default.globalsecret({name:this.secretName})}},{key:"name",get:function(){return"wecom"}},{key:"type",get:function(){return"wechat"}}]),r}(v.default.Component),c.contextTypes={registerUpdate:E.default.func},o=s))||o;a.default=L},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(192),r(70),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(70),r(29),r(4),r(18),r(43),r(11),r(73);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(26)),h=l(r(67)),v=r(189),E=l(r(191)),y=l(r(1367)),g=l(r(964)),b=l(r(2720)),S=l(r(1455));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=v.Tabs.TabPanel,C=function(e){(0,i.default)(r,e);var a=_(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).state={type:"toUser",chatbotType:"atUsers"},e.validate=function(a){var r=e.state.type,n=(0,m.default)(e.props.data,"receiver.spec.wechat.".concat(r),[]),l=globals.config.notification.wecom["max_number_of_".concat(r)];if(a)if(n.length>l-1)E.default.error({content:t.html("MAX_".concat(r.toUpperCase(),"_COUNT"),{count:l}),duration:1e3});else{if(!n.includes(a))return!0;E.default.error({content:t("".concat(r.toUpperCase(),"_EXISTS")),duration:1e3})}else E.default.error({content:t("ENTER_".concat(r.toUpperCase(),"_TIP")),duration:1e3})},e.receiverValidator=function(a,r,n){if(["toParty","toUser","toTag"].every((function(t){return(0,h.default)((0,m.default)(e.props.data,"receiver.spec.wechat.".concat(t)))})))return n({message:t("RECIPIENT_SETTINGS_TIP")});n()},e.handleTypeChange=function(t){e.setState({type:t})},e.handleChatTypeChange=function(t){e.setState({chatbotType:t})},e}return(0,s.default)(r,[{key:"renderServiceSetting",value:function(){return p.default.createElement("div",{className:S.default.row},p.default.createElement("div",{className:S.default.title},t("SERVER_SETTINGS")),p.default.createElement("div",{className:S.default.item},p.default.createElement(v.Form.Item,{label:"Corp ID",rules:[{required:!0,message:t("ENTER_WECOM_CORP_ID_DESC")}]},p.default.createElement(v.Input,{name:"config.spec.wechat.wechatApiCorpId"})),p.default.createElement(v.Form.Item,{label:"Agent ID",rules:[{required:!0,message:t("ENTER_WECOM_AGENT_ID_DESC")}]},p.default.createElement(v.Input,{name:"config.spec.wechat.wechatApiAgentId"})),p.default.createElement(v.Form.Item,{label:"Secret",rules:[{required:!0,message:t("ENTER_WECOM_SECRET_DESC")}]},p.default.createElement(v.Input,{name:"secret.data.appsecret"}))))}},{key:"renderReceiverSetting",value:function(){var e=this.state.type,a=this.props.wrapperClassName;return p.default.createElement("div",{className:S.default.row},p.default.createElement("div",{className:S.default.title},t("RECIPIENT_SETTINGS")),p.default.createElement("div",{className:S.default.subTitle},t("RECIPIENT_SETTINGS_TIP")),p.default.createElement("div",{className:S.default.item},p.default.createElement("div",{className:"margin-b12"},p.default.createElement(y.default,{value:e,onChange:this.handleTypeChange,options:this.tabs})),p.default.createElement(v.Form.Item,{rules:[{validator:this.receiverValidator}]},p.default.createElement(b.default,{name:"receiver.spec.wechat.".concat(e),className:a,validate:this.validate,type:e}))))}},{key:"renderChatbotSetting",value:function(){return p.default.createElement("div",{className:S.default.row},p.default.createElement("div",{className:S.default.title},p.default.createElement("span",null,t("CHATBOT_SETTINGS"))),p.default.createElement("div",{className:S.default.item},p.default.createElement(v.Form.Item,{label:"Webhook URL"},p.default.createElement(v.Input,{name:"secret.data.webhook"}))))}},{key:"renderChatbotReceiverSetting",value:function(){var e=this.state.chatbotType,a=this.props.wrapperClassName;return p.default.createElement("div",{className:S.default.row},p.default.createElement("div",{className:S.default.title},t("RECIPIENT_SETTINGS")),p.default.createElement("div",{className:S.default.item},p.default.createElement("div",{className:"margin-b12"},p.default.createElement(y.default,{value:e,onChange:this.handleChatTypeChange,options:this.chatbotTabs})),p.default.createElement(v.Form.Item,null,p.default.createElement(b.default,{name:"receiver.spec.wechat.chatbot.".concat(e),className:a,validate:this.validate,type:e}))))}},{key:"render",value:function(){var e=this.props,a=e.user,r=e.data,n=e.onChange,l=e.hideFooter,c=(0,o.default)(e,["user","data","onChange","hideFooter"]);return p.default.createElement(g.default,(0,u.default)({name:"wechat",module:"WeCom",icon:"wecom",data:r,onChange:n,hideFooter:l,user:a},c),p.default.createElement(v.Tabs,{type:"button"},p.default.createElement(O,{label:t("CHAT_SETTINGS"),name:"conversation"},!a&&this.renderServiceSetting(),this.renderReceiverSetting()),p.default.createElement(O,{label:t("CHATBOT_SETTINGS"),name:"chatbot"},this.renderChatbotSetting(),this.renderChatbotReceiverSetting())))}},{key:"tabs",get:function(){return[{label:"User ID",value:"toUser"},{label:"Department ID",value:"toParty"},{label:"Tag ID",value:"toTag"}]}},{key:"chatbotTabs",get:function(){return[{label:"User ID",value:"atUsers"},{label:t("WHIZARD_NOTIFICATION.PHONE_NUMBER"),value:"atMobiles"}]}}]),r}(p.Component);a.default=C},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(10),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(29),r(4),r(18),r(43),r(11);var u=l(r(58)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(1)),m=l(r(5)),h=l(r(67)),v=r(189),E=l(r(1007)),y=l(r(1455));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=function(e){(0,s.default)(r,e);var a=g(r);function r(){var e;(0,o.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleAdd=function(t){var a=e.props,r=a.value;(0,a.onChange)([].concat((0,u.default)(r),[t]))},e.handleDelete=function(t){var a=e.props,r=a.value;(0,a.onChange)(r.filter((function(e){return e!==t})))},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.validate,n=a.type,l=a.value,u=a.className,o=n.toUpperCase();return d.default.createElement("div",{className:(0,m.default)(y.default.wrapper,u)},d.default.createElement(E.default,{placeholder:" ",validate:r,onAdd:this.handleAdd}),d.default.createElement("p",{className:"margin-t8"},t("".concat(n.toUpperCase(),"_LIST"))),d.default.createElement("div",{className:(0,m.default)(y.default.boxWrapper,u)},(0,h.default)(l)?d.default.createElement("div",{className:y.default.empty},t("EMPTY_".concat(o,"_DESC"))):l.map((function(t){return d.default.createElement(v.Tag,{className:y.default.tag,key:t},t,d.default.createElement(v.Icon,{name:"close",type:"light",size:12,clickable:!0,onClick:function(){return e.handleDelete(t)}}))}))))}}]),r}(d.Component);a.default=b,b.propTypes={value:p.default.array,onChange:p.default.func},b.defaultProps={value:[],onChange:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var l=n(r(38));r(35);var u,o,c,s=n(r(39)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=n(r(1)),E=r(17),y=r(243),g=n(r(68)),b=n(r(26)),S=n(r(196)),_=n(r(119)),O=n(r(67)),C=n(r(191)),T=n(r(801)),R=n(r(2722)),D=n(r(438)),k=n(r(965)),N=n(r(933));function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var P=(0,y.observer)((c=o=function(e){(0,d.default)(r,e);var a=I(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).receiverStore=new k.default,e.state={formData:{},isLoading:!1,noConfig:!0},e.formTemplate={receiver:D.default.notificationreceivers({name:e.receiverName,type:e.type})},e.fetchData=function(){e.setState({isLoading:!0}),e.receiverStore.fetchList({name:e.receiverName,user:globals.user.username,type:e.type}).then((function(){var t=(0,E.toJS)(e.receiverStore.list.data).find((function(t){return(0,b.default)(t,"name")===e.receiverName}));(0,O.default)(t)||(0,g.default)(e.formTemplate,"receiver",(0,b.default)(t,"_originData",{})),e.setState({formData:(0,_.default)(e.formTemplate),isLoading:!1,noConfig:(0,O.default)(t)})}))},e.resetData=function(){e.setState({formData:(0,_.default)(e.formTemplate)})},e.handleFormChange=function(t,a){e.context.registerUpdate(e.name,{name:t,value:a})},e.getVerifyFormTemplate=function(e){var t=(0,_.default)(e),a=t.config,r=t.receiver,n=t.secret;return(0,g.default)(a,"spec.slack.slackTokenSecret.value",(0,b.default)(n,"data.token")),(0,S.default)(r,"spec.slack.alertSelector"),(0,S.default)(a,"spec.slack.slackTokenSecret.valueFrom"),{config:a,receiver:r,secret:n}},e.getResource=(0,s.default)(l.default.mark((function t(){var a;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.receiverStore.getResource({name:e.receiverName,user:globals.user.username});case 2:return a=t.sent,t.abrupt("return",{isExitReceiver:a});case 4:case"end":return t.stop()}}),t)}))),e.handleSubmit=function(){var a=(0,s.default)(l.default.mark((function a(r){var n,u,o,c;return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=(0,_.default)(r),u=n.receiver,a.next=3,e.getResource();case 3:if(o=a.sent,!o.isExitReceiver){a.next=11;break}return a.next=8,e.receiverStore.update({name:e.receiverName,user:globals.user.username},u);case 8:c=t("UPDATE_SUCCESSFUL"),a.next=15;break;case 11:return(0,g.default)(u,"spec.slack.enabled",!0),a.next=14,e.receiverStore.create(u,{name:e.receiverName,user:globals.user.username});case 14:c=t("CREATE_SUCCESSFUL");case 15:C.default.success({content:c,duration:1e3});case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e}return(0,f.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.formData,r=t.isLoading,n=t.noConfig;return h.default.createElement(T.default,{loading:r,className:N.default.panel},h.default.createElement(R.default,{noConfig:n,wrapperClassName:N.default.wrapper,formRef:e,data:a,hideFooter:!0,user:globals.user.username,onChange:this.handleFormChange,getVerifyFormTemplate:this.getVerifyFormTemplate}))}},{key:"receiverName",get:function(){return"".concat(globals.user.username,"-slack-receiver")}},{key:"name",get:function(){return"slack"}},{key:"type",get:function(){return"slack"}}]),r}(h.default.Component),o.contextTypes={registerUpdate:v.default.func},u=c))||u;a.default=P},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(98),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(98),r(29),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(26)),h=r(189),v=l(r(191)),E=l(r(964)),y=l(r(1182)),g=l(r(2723));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=function(e){(0,i.default)(r,e);var a=b(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).validateChannel=function(a){var r=e.props.data,n=(0,m.default)(r,"receiver.spec.slack.channels",[]),l=globals.config.notification.dingtalk.max_number_of_keyword;if(a)if(n.length>l-1)v.default.error({content:t.html("MAX_CHANNEL_COUNT",{count:l}),durantion:1e3});else{if(!n.some((function(e){return e===a})))return!0;v.default.error({content:t("CHANNEL_EXISTS"),duration:1e3})}else v.default.error({content:t("ADD_CHANNEL_TIP"),duration:1e3})},e}return(0,s.default)(r,[{key:"renderServiceSetting",value:function(){return p.default.createElement("div",{className:g.default.row},p.default.createElement("div",{className:g.default.title},t("SERVER_SETTINGS")),p.default.createElement("div",{className:g.default.item},p.default.createElement(h.Form.Item,{label:t("SLACK_TOKEN"),rules:[{required:!0,message:t("SLACK_TOKEN_DESC")}]},p.default.createElement(h.Input,{name:"secret.data.token"}))))}},{key:"renderReceiverSetting",value:function(){var e=this.props.wrapperClassName;return p.default.createElement("div",{className:g.default.row},p.default.createElement("div",{className:g.default.title},t("CHANNEL_SETTINGS")),p.default.createElement("div",{className:g.default.item},p.default.createElement(h.Form.Item,{rules:[{required:!0,message:t("ADD_CHANNEL_TIP")}]},p.default.createElement(y.default,{className:e,name:"receiver.spec.slack.channels",validate:this.validateChannel,title:t("SLACK_CHANNEL"),listTitle:t("ADDED_CHANNELS"),emptyDesc:t("EMPTY_CHANNEL_DESC")}))))}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.data,r=e.onChange,n=e.hideFooter,l=(0,o.default)(e,["user","data","onChange","hideFooter"]);return p.default.createElement(E.default,(0,u.default)({name:"slack",module:"slack",icon:"slack",data:a,onChange:r,hideFooter:n,user:t},l),!t&&this.renderServiceSetting(),this.renderReceiverSetting())}}]),r}(p.Component);a.default=S},function(e,t,a){e.exports={title:"_3elAhqGTewHKeiw6V0UPaX",row:"_1td6CdgMPVF4Cctcyr4p7D",item:"_27kS6c7nE8a42TJ6raKfgw",boxWrapper:"_2Eheikyi4hirTv6JInA8o0",empty:"_2XsEWMcxnB32ONK9LPkWPK",wrapper:"_3r_etzcqlf8QpBsvosXwTe",tag:"_2jfxlVwie6ylJ-Gabg_PeE"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(36),r(14),r(4),r(21),r(18),r(11),r(46),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(36),r(29),r(14),r(4),r(21),r(18),r(43),r(11),r(46),r(40);var l=n(r(97)),u=n(r(38));r(35);var o,c,s,i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),E=r(17),y=r(243),g=n(r(1)),b=n(r(67)),S=n(r(26)),_=n(r(68)),O=n(r(196)),C=n(r(119)),T=n(r(191)),R=n(r(801)),D=n(r(2725)),k=n(r(965)),N=n(r(1064)),I=r(324),P=n(r(438)),A=n(r(933));function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var L=(0,y.observer)((s=c=function(e){(0,p.default)(r,e);var a=w(r);function r(){var e;(0,f.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).receiverStore=new k.default,e.secretStore=new N.default,e.state={formData:{},isLoading:!1,noConfig:!0},e.formTemplate={receiver:e.receiverFormTemplate,secret:e.secretFormTemplate},e.fetchData=(0,i.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({isLoading:!0}),t.next=3,Promise.all([e.receiverStore.fetchList({name:e.receiverName,user:globals.user.username,type:e.type}),e.secretStore.fetchList({name:e.secretName,user:globals.user.username})]).then((function(){var t=(0,E.toJS)(e.receiverStore.list.data).find((function(t){return(0,S.default)(t,"name")===e.receiverName})),a=(0,E.toJS)(e.secretStore.list.data).find((function(t){return(0,S.default)(t,"name")===e.secretName}));(0,b.default)(t)||(0,_.default)(e.formTemplate,"receiver",(0,S.default)(t,"_originData",{})),(0,b.default)(a)||(0,_.default)(e.formTemplate,"secret",a),e.setState({formData:(0,C.default)(e.formTemplate),isLoading:!1,noConfig:(0,b.default)(t)})}));case 3:case"end":return t.stop()}}),t)}))),e.resetData=function(){e.setState({formData:(0,C.default)(e.formTemplate)})},e.handleFormChange=function(t,a){e.context.registerUpdate(e.name,{name:t,value:a})},e.getResource=(0,i.default)(u.default.mark((function t(){var a,r,n,o;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.receiverStore.getResource({name:e.receiverName,user:globals.user.username}),e.secretStore.getResource({name:e.secretName,user:globals.user.username})]);case 2:return a=t.sent,r=(0,l.default)(a,2),n=r[0],o=r[1],t.abrupt("return",{isExitReceiver:n,isExitSecret:o});case 7:case"end":return t.stop()}}),t)}))),e.getVerifyFormTemplate=function(e){var t=(0,C.default)(e),a=t.receiver,r=t.secret,n=(0,S.default)(a,'metadata.annotations["kubesphere.io/verify-type"]'),l=(0,S.default)(a,"spec.webhook.httpConfig.basicAuth.username"),u=(0,S.default)(r,"data",{}),o=u.password,c=u.token;return(0,O.default)(a,"spec.webhook.httpConfig.bearerToken"),(0,O.default)(a,"spec.webhook.httpConfig.basicAuth"),"basic"===n&&o&&((0,_.default)(a,"spec.webhook.httpConfig.basicAuth.password.value",o),(0,_.default)(a,"spec.webhook.httpConfig.basicAuth.username",l)),"token"===n&&c&&(0,_.default)(a,"spec.webhook.httpConfig.bearerToken.value",c),(0,O.default)(a,"spec.webhook.alertSelector"),{receiver:a}},e.handleSubmit=function(){var a=(0,i.default)(u.default.mark((function a(r){var n,l,o,c,s,i,f,d,p,m;return u.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=(0,C.default)(r),l=n.receiver,o=n.secret,c=e.secretTemplate,s=(0,S.default)(l,'metadata.annotations["kubesphere.io/verify-type"]'),i=(0,S.default)(l,"spec.webhook.httpConfig.basicAuth.username"),(0,O.default)(l,"spec.webhook.httpConfig.bearerToken"),(0,O.default)(l,"spec.webhook.httpConfig.basicAuth"),"basic"===s&&((0,_.default)(c,"data.password",(0,I.safeBtoa)((0,S.default)(o,"data.password"))),(0,_.default)(l,"spec.webhook.httpConfig.basicAuth.username",i),(0,_.default)(l,"spec.webhook.httpConfig.basicAuth.password.valueFrom.secretKeyRef.key","password"),(0,_.default)(l,"spec.webhook.httpConfig.basicAuth.password.valueFrom.secretKeyRef.name",e.secretName)),"token"===s&&((0,_.default)(c,"data.token",(0,I.safeBtoa)((0,S.default)(o,"data.token"))),(0,_.default)(l,"spec.webhook.httpConfig.bearerToken.valueFrom.secretKeyRef.key","token"),(0,_.default)(l,"spec.webhook.httpConfig.bearerToken.valueFrom.secretKeyRef.name",e.secretName)),a.next=10,e.getResource();case 10:if(d=a.sent,p=d.isExitReceiver,m=d.isExitSecret,!p){a.next=19;break}return a.next=16,e.receiverStore.update({name:e.receiverName,user:globals.user.username},l);case 16:f=t("UPDATE_SUCCESSFUL"),a.next=22;break;case 19:(0,_.default)(l,"spec.webhook.enabled",!0),e.receiverStore.create(l,{name:e.receiverName,user:globals.user.username}),f=t("CREATE_SUCCESSFUL");case 22:if(!m){a.next=27;break}return a.next=25,e.secretStore.update({name:e.secretName,user:globals.user.username},c);case 25:a.next=29;break;case 27:return a.next=29,e.secretStore.create(c,{name:e.secretName,user:globals.user.username});case 29:T.default.success({content:f,duration:1e3});case 30:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.formData,r=t.isValidating,n=t.isLoading,l=t.noConfig;return v.default.createElement(R.default,{loading:n,className:A.default.panel},v.default.createElement(D.default,{noConfig:l,formRef:e,user:globals.user.username,wrapperClassName:A.default.wrapper,data:a,onChange:this.handleFormChange,getVerifyFormTemplate:this.getVerifyFormTemplate,isValidating:r,hideFooter:!0}))}},{key:"receiverName",get:function(){return"".concat(globals.user.username,"-webhook-receiver")}},{key:"secretName",get:function(){return"".concat(globals.user.username,"-webhook-secret")}},{key:"name",get:function(){return"webhook"}},{key:"type",get:function(){return"webhook"}},{key:"receiverFormTemplate",get:function(){return P.default.notificationreceivers({name:this.receiverName,type:this.type})}},{key:"secretTemplate",get:function(){return P.default.globalsecret({name:this.secretName})}}]),r}(v.default.Component),c.contextTypes={registerUpdate:g.default.func},o=s))||o;a.default=L},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(26)),h=r(189),v=l(r(1006)),E=l(r(964)),y=l(r(2726));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=function(e){(0,i.default)(r,e);var a=g(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={type:(0,m.default)(e.props.data,'receiver.metadata.annotations["kubesphere.io/verify-type"]',""),enabled:(0,m.default)(e.props.data,"receiver.spec.webhook.httpConfig.tlsConfig.insecureSkipVerify",!1)},e.handleTypeChange=function(t){e.setState({type:t})},e.handleChangeCheck=function(t){e.setState({enabled:t})},e}return(0,s.default)(r,[{key:"renderServiceSetting",value:function(){var e=this.state,a=e.type,r=e.enabled;return p.default.createElement("div",{className:y.default.row},p.default.createElement("div",{className:y.default.title},t("SERVER_SETTINGS")),p.default.createElement("div",{className:y.default.item},p.default.createElement(h.Form.Item,{label:"Webhook URL",rules:[{required:!0,message:t("WEBHOOK_URL_DESC")}]},p.default.createElement(h.Input,{name:"receiver.spec.webhook.url"})),p.default.createElement(h.Form.Item,{label:t("AUTHENTICATION_TYPE"),rules:[{required:!0,message:t("AUTHENTICATION_TYPE_DESC")}]},p.default.createElement(h.Select,{name:"receiver.metadata.annotations['kubesphere.io/verify-type']",value:a,options:this.options,onChange:this.handleTypeChange,placeholder:" "})),"basic"===a&&p.default.createElement(p.default.Fragment,null,p.default.createElement(h.Form.Item,{label:t("USERNAME"),rules:[{required:!0,message:t("WEBHOOK_USERNAME_EMPTY_DESC")}]},p.default.createElement(h.Input,{name:"receiver.spec.webhook.httpConfig.basicAuth.username"})),p.default.createElement(h.Form.Item,{label:t("PASSWORD"),rules:[{required:!0,message:t("WEBHOOK_PASSWORD_EMPTY_DESC")}]},p.default.createElement(v.default,{name:"secret.data.password",type:"password",autoComplete:"new-password"}))),"token"===a&&p.default.createElement(p.default.Fragment,null,p.default.createElement(h.Form.Item,{label:t("TOKEN"),rules:[{required:!0,message:t("WEBHOOK_TOKEN_EMPTY_DESC")}]},p.default.createElement(h.Input,{name:"secret.data.token"}))),p.default.createElement(h.Form.Item,null,p.default.createElement(h.Checkbox,{name:"receiver.spec.webhook.httpConfig.tlsConfig.insecureSkipVerify",checked:r,onChange:this.handleChangeCheck},t("SKIP_TLS_VERFICATION")))))}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.data,r=e.onChange,n=e.hideFooter,l=(0,o.default)(e,["user","data","onChange","hideFooter"]);return p.default.createElement(E.default,(0,u.default)({name:"webhook",module:"webhook",icon:"webhook",data:a,onChange:r,hideFooter:n,user:t},l),this.renderServiceSetting())}},{key:"options",get:function(){return[{label:t("NO_AUTH"),value:"no"},{label:t("BEARER_TOKEN"),value:"token"},{label:t("BASIC_AUTH"),value:"basic"}]}}]),r}(p.Component);a.default=b},function(e,t,a){e.exports={row:"_3VnLDYjLdHoxb33xLn5VuH",title:"_1ZsuBlfatMWIaoQC2wmrZK",item:"NwnaO1er604LDlEE8l-cB"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(192),r(44),r(6),r(36),r(14),r(9),r(4),r(21),r(18),r(11),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(192),r(44),r(6),r(36),r(29),r(14),r(9),r(4),r(21),r(18),r(43),r(11),r(46),r(7),r(40);var l=n(r(97)),u=n(r(38));r(35);var o,c,s,i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),E=r(17),y=r(243),g=n(r(1)),b=n(r(64)),S=n(r(67)),_=n(r(26)),O=n(r(68)),C=n(r(196)),T=n(r(119)),R=n(r(191)),D=n(r(801)),k=n(r(2728)),N=n(r(965)),I=n(r(1064)),P=r(324),A=n(r(438)),w=n(r(933));function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var M=(0,y.observer)((s=c=function(e){(0,p.default)(r,e);var a=L(r);function r(){var e;(0,f.default)(this,r);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=a.call.apply(a,[this].concat(o))).receiverStore=new N.default,e.secretStore=new I.default,e.state={formData:{},noConfig:!0},e.formTemplate={receiver:A.default.notificationreceivers({name:e.receiverName,type:e.type}),secret:e.secretFormTemplate},e.fetchData=(0,i.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({isLoading:!0}),t.next=3,Promise.all([e.receiverStore.fetchList({name:e.receiverName,user:globals.user.username,type:e.type}),e.secretStore.fetchList({name:e.secretName,user:globals.user.username})]).then((function(){var t=(0,E.toJS)(e.receiverStore.list.data).find((function(t){return(0,_.default)(t,"name")===e.receiverName})),a=(0,E.toJS)(e.secretStore.list.data).find((function(t){return(0,_.default)(t,"name")===e.secretName}));(0,S.default)(t)||((0,O.default)(e.formTemplate,"receiver",(0,_.default)(t,"_originData",{})),e.setState({isExitReceiver:!0})),(0,S.default)(a)||((0,O.default)(e.formTemplate,"secret",a),e.setState({isExitSecret:!0})),e.setState({formData:(0,T.default)(e.formTemplate),isLoading:!1,noConfig:(0,S.default)(t)})}));case 3:case"end":return t.stop()}}),t)}))),e.resetData=function(){e.setState({formData:(0,T.default)(e.formTemplate)})},e.handleFormChange=function(t,a){e.context.registerUpdate(e.name,{name:t,value:a})},e.getVerifyFormTemplate=function(e){var t={},a=(0,T.default)(e),r=a.receiver,n=a.secret,l=(0,_.default)(r,"spec.feishu.chatbot.keywords"),u=(0,_.default)(r,"spec.feishu.department"),o=(0,_.default)(r,"spec.feishu.user"),c=(0,_.default)(n,"data",{}),s=c.webhook,i=c.chatbotsecret;return s&&(0,O.default)(t,"receiver.spec.feishu.chatbot.webhook.value",s),i&&(0,O.default)(t,"receiver.spec.feishu.chatbot.secret.value",i),(0,S.default)(l)||(0,O.default)(t,"receiver.spec.feishu.chatbot.keywords",l),(0,S.default)(u)||(0,O.default)(t,"receiver.spec.feishu.department",u),(0,S.default)(o)||(0,O.default)(t,"receiver.spec.feishu.user",o),t},e.handleVerify=function(e){var a=e.receiver,r=e.secret,n=(0,_.default)(a,"spec.feishu.chatbot.keywords"),l=(0,_.default)(a,"spec.feishu.department",[]),u=(0,_.default)(a,"spec.feishu.user",[]),o=(0,_.default)(r,"data",{}),c=o.webhook,s=o.chatbotsecret;if([c,s,n].every((function(e){return(0,b.default)(e)?(0,S.default)(e):!e}))&&l.length<1&&u.length<1)return R.default.error({content:t("DINGTALK_SETTING_TIP")}),!1;if(c||s||!(0,S.default)(n)){if(!c)return R.default.error({content:t("PLEASE_ENTER_VALUE_CUSTOM",{value:"Webhook URL"})}),!1;if(!s&&(0,S.default)(n))return R.default.error({content:t("DINGTALK_CHATBOT_SECURITY_TIP")}),!1}return!0},e.getResource=(0,i.default)(u.default.mark((function t(){var a,r,n,o;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.receiverStore.getResource({name:e.receiverName,user:globals.user.username}),e.secretStore.getResource({name:e.secretName,user:globals.user.username})]);case 2:return a=t.sent,r=(0,l.default)(a,2),n=r[0],o=r[1],t.abrupt("return",{isExitReceiver:n,isExitSecret:o});case 7:case"end":return t.stop()}}),t)}))),e.handleSubmit=function(){var a=(0,i.default)(u.default.mark((function a(r){var n,l,o,c,s,i,f;return u.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=(0,T.default)(r),l=n.receiver,o=n.secret,e.handleVerify(r)){a.next=3;break}return a.abrupt("return",!1);case 3:return c=(0,_.default)(o,"data",{}),Object.keys(c).forEach((function(e){c[e]=(0,P.safeBtoa)(c[e])})),(0,O.default)(l,"spec.feishu.chatbot.webhook.valueFrom.secretKeyRef.key","webhook"),(0,O.default)(l,"spec.feishu.chatbot.webhook.valueFrom.secretKeyRef.name",e.secretName),(0,O.default)(l,"spec.feishu.chatbot.secret.valueFrom.secretKeyRef.key","chatbotsecret"),(0,O.default)(l,"spec.feishu.chatbot.secret.valueFrom.secretKeyRef.name",e.secretName),c.webhook||(0,C.default)(l,"spec.feishu.chatbot.webhook"),c.chatbotsecret||(0,C.default)(l,"spec.feishu.chatbot.secret"),(0,S.default)((0,_.default)(l,"spec.feishu.chatbot.keywords"))&&(0,C.default)(l,"spec.feishu.chatbot.keywords"),(0,S.default)((0,_.default)(l,"spec.feishu.chatbot"))&&(0,C.default)(l,"spec.feishu.chatbot"),a.next=15,e.getResource();case 15:if(s=a.sent,i=s.isExitReceiver,f=s.isExitSecret,!i){a.next=23;break}return a.next=21,e.receiverStore.update({name:e.receiverName,user:globals.user.username},l);case 21:a.next=26;break;case 23:return(0,O.default)(l,"spec.feishu.enabled",!0),a.next=26,e.receiverStore.create(l,{name:e.receiverName,user:globals.user.username});case 26:if(!f){a.next=31;break}return a.next=29,e.secretStore.update({name:e.secretName,user:globals.user.username},(0,O.default)(e.secretTemplate,"data",c));case 29:a.next=33;break;case 31:return a.next=33,e.secretStore.create((0,O.default)(e.secretTemplate,"data",c),{name:e.secretName,user:globals.user.username});case 33:R.default.success({content:t("UPDATE_SUCCESSFUL"),duration:1e3});case 34:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e}return(0,d.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.formData,r=t.isLoading,n=t.noConfig;return v.default.createElement(D.default,{loading:r,className:w.default.panel},v.default.createElement(k.default,{formRef:e,noConfig:n,wrapperClassName:w.default.wrapper,data:a,onChange:this.handleFormChange,onVerify:this.handleVerify,getVerifyFormTemplate:this.getVerifyFormTemplate,hideFooter:!0,user:globals.user.username}))}},{key:"receiverName",get:function(){return"".concat(globals.user.username,"-feishu-receiver")}},{key:"secretName",get:function(){return"".concat(globals.user.username,"-feishu-config-secret")}},{key:"name",get:function(){return"feishu"}},{key:"type",get:function(){return"feishu"}},{key:"secretTemplate",get:function(){return A.default.globalsecret({name:this.secretName})}}]),r}(v.default.Component),c.contextTypes={registerUpdate:g.default.func},o=s))||o;a.default=M},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(70),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(29),r(4),r(18),r(43),r(11),r(73);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(26)),h=r(189),v=l(r(191)),E=l(r(964)),y=l(r(1182)),g=l(r(2729));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=h.Tabs.TabPanel,_=function(e){(0,i.default)(r,e);var a=b(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).validateKeywords=function(a){var r=(0,m.default)(e.props.data,"receiver.spec.feishu.chatbot.keywords",[]),n=globals.config.notification.feishu.max_number_of_keyword;if(a)if(r.length>n-1)v.default.error({content:t.html("MAX_KEYWORD_COUNT",{count:n}),durantion:1e3});else{if(!r.includes(a))return!0;v.default.error({content:t("KEYWORD_EXISTS"),duration:1e3})}else v.default.error({content:t("ENTER_KEYWORD_DESC"),durantion:1e3})},e}return(0,s.default)(r,[{key:"renderServiceSetting",value:function(){return p.default.createElement("div",{className:g.default.row},p.default.createElement("div",{className:g.default.title},t("CHAT_SETTINGS")),p.default.createElement("div",{className:g.default.item},p.default.createElement(h.Form.Item,{label:"App Key"},p.default.createElement(h.Input,{name:"secret.data.appkey"})),p.default.createElement(h.Form.Item,{label:"App Secret"},p.default.createElement(h.Input,{name:"secret.data.appsecret"}))))}},{key:"renderReceiverSetting",value:function(){var e=this.props.wrapperClassName;return p.default.createElement("div",{className:g.default.row},p.default.createElement("div",{className:g.default.title},p.default.createElement("span",null,t("RECIPIENT_SETTINGS")),p.default.createElement("p",{className:g.default.subtitle},t("FEISHU_RECEIPIENT_SETTINGS_DESC"))),p.default.createElement("div",{className:g.default.item},p.default.createElement(h.Tabs,{type:"button"},p.default.createElement(S,{label:t("USER_ID"),name:"conversation"},p.default.createElement(h.Form.Item,null,p.default.createElement(y.default,{className:e,title:t(""),listTitle:t("TOUSER_LIST"),emptyDesc:t("EMPTY_TOUSER_DESC"),placeholder:" ",name:"receiver.spec.feishu.user",validate:this.validateKeywords}))),p.default.createElement(S,{label:t("DEPARTMENT_ID"),name:"chatbot"},p.default.createElement(h.Form.Item,null,p.default.createElement(y.default,{className:e,title:t(""),listTitle:t("TOPARTY_LIST"),emptyDesc:t("EMPTY_TOPARTY_DESC"),placeholder:" ",name:"receiver.spec.feishu.department",validate:this.validateKeywords}))))))}},{key:"renderChatSetting",value:function(){var e=this.props.wrapperClassName;return p.default.createElement("div",{className:g.default.row},p.default.createElement("div",{className:g.default.title},p.default.createElement("span",null,t("CHATBOT_SETTINGS"))),p.default.createElement("div",{className:g.default.item},p.default.createElement(h.Form.Item,{label:"Webhook URL"},p.default.createElement(h.Input,{name:"secret.data.webhook"})),p.default.createElement(h.Form.Item,{label:t("FEISHU_SECRET")},p.default.createElement(h.Input,{name:"secret.data.chatbotsecret"})),p.default.createElement(h.Form.Item,null,p.default.createElement(y.default,{className:e,name:"receiver.spec.feishu.chatbot.keywords",validate:this.validateKeywords}))))}},{key:"render",value:function(){var e=this.props,a=e.user,r=e.data,n=e.onChange,l=e.hideFooter,c=(0,o.default)(e,["user","data","onChange","hideFooter"]);return p.default.createElement(E.default,(0,u.default)({name:"feishu",module:"Feishu",icon:"feishu",data:r,onChange:n,hideFooter:l,user:a},c),p.default.createElement(h.Tabs,{type:"button"},p.default.createElement(S,{label:t("CHAT_SETTINGS"),name:"conversation"},!a&&this.renderServiceSetting(),p.default.createElement(p.default.Fragment,null,this.renderReceiverSetting())),p.default.createElement(S,{label:t("CHATBOT_SETTINGS"),name:"chatbot"},this.renderChatSetting())))}}]),r}(p.Component);a.default=_},function(e,t,a){e.exports={title:"w38gUtxv9TsKfvoAPzGLg",subtitle:"_1sN9qR8-xcipMqkjNomKrU",row:"_2RkkoTG18m5eYPXcTVUt9j",item:"_1xG2cy3wsSAKG_CRKOwumL"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(0)),i=n(r(191)),f=n(r(798)),d=n(r(2731)),p=n(r(2748)),m=n(r(2749)),h=n(r(822)),v=n(r(2751)),E=n(r(2776)),y=n(r(1460)),g=n(r(1322)),b=n(r(2785)),S=n(r(1462)),_=n(r(2797)),O=n(r(2807)),C=n(r(2809)),T=n(r(2811)),R=n(r(2813)),D=n(r(2814)),k=n(r(2816)),N=n(r(2817)),I=n(r(2821)),P=n(r(1186)),A=n(r(2823)),w=n(r(2848)),L=n(r(2849)),M=n(r(2850)),x=n(r(2851)),j=n(r(2852)),U=n(r(2854)),F=r(955);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function G(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var B={"openpitrix.app.create":{on:function(e){var t=e.store,a=e.cluster,r=e.namespace,n=(0,c.default)(e,["store","cluster","namespace"]),l=f.default.open(G({onOk:function(){f.default.close(l)},store:t,cluster:a,namespace:r,modal:d.default},n))}},"openpitrix.app.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=f.default.open(G({onOk:function(e){a.patch(r,e).then((function(){f.default.close(u),i.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},store:a,detail:r,modal:p.default},l))}},"openpitrix.app.template.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=f.default.open(G({onOk:function(e){a.upgrade(e,r).then((function(){f.default.close(u),i.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},store:a,detail:r,modal:m.default},l))}},"openpitrix.repo.add":{on:function(e){var t,a=e.store,r=e.workspace,n=e.success,o=(0,c.default)(e,["store","workspace","success"]),s=f.default.open(G({onOk:(t=(0,u.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.create(G(G({},t),{},{workspace:r,app_default_status:"active"}));case 2:f.default.close(s),n&&n();case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),store:a,modal:v.default,workspace:r},o))}},"openpitrix.repo.edit":{on:function(e){var t,a=e.store,r=e.detail,n=e.workspace,o=e.success,s=(0,c.default)(e,["store","detail","workspace","success"]),i=f.default.open(G({onOk:(t=(0,u.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.update(t);case 2:f.default.close(i),o&&o();case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),store:a,detail:r,modal:v.default,workspace:n},s))}},"openpitrix.template.create":{on:function(e){var t=e.store,a=e.success,r=(0,c.default)(e,["store","success"]),n=f.default.open(G({onOk:function(){f.default.close(n),a&&a()},store:t,modal:E.default},r))}},"openpitrix.template.upload":{on:function(e){var a,r=e.store,n=e.workspace,o=e.success,s=(0,c.default)(e,["store","workspace","success"]),d=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.create(G(G({},a),{},{workspace:n}));case 2:i.default.success({content:t("UPLOAD_SUCCESSFUL")}),f.default.close(d),o&&o();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,modal:y.default,title:t("UPLOAD_HELM_TITLE"),description:t("UPLOAD_HELM_CHART_DESC"),icon:"templet",type:"CREATE_APP",workspace:n},s))}},"openpitrix.template.edit":{on:function(e){var a,r=e.store,n=e.success,o=(0,c.default)(e,["store","success"]),s=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.update(a);case 2:f.default.close(s),i.default.success({content:t("MODIFY_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,modal:g.default,success:n},o))}},"openpitrix.template.addVersion":{on:function(e){var a,r=e.store,n=e.versionStore,o=e.workspace,s=e.success,d=(0,c.default)(e,["store","versionStore","workspace","success"]),p=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.create(a);case 2:i.default.success({content:t("ADD_VERSION_SUCCESSFUL")}),f.default.close(p),s&&s();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,modal:y.default,title:t("UPLOAD_HELM_TITLE"),description:t("UPLOAD_HELM_CHART_DESC"),icon:"templet",type:"CREATE_APP",workspace:o},d))}},"openpitrix.template.deploy":{on:function(e){var a,r=e.store,n=e.success,o=(0,c.default)(e,["store","success"]),s=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,d,p;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=a.namespace,o=a.cluster,d=a.workspace,p=(0,c.default)(a,["namespace","cluster","workspace"]),e.next=3,r.deploy(p,{workspace:d,namespace:u,cluster:o});case 3:f.default.close(s),i.default.success({content:"".concat(t("DEPLOYED_SUCCESSFUL"))}),n&&n();case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,modal:b.default},o))}},"openpitrix.template.delete":{on:function(e){var a=e.store,r=e.detail,n=e.versions,o=e.success,d=(0,c.default)(e,["store","detail","versions","success"]),p=r.name,m=t.html("DELETE_APP_TEMPLATE_DESC",{resource:p});n.length&&(m=s.default.createElement("span",null,t.html("DELETE_APP_TEMPLATE_VERSIONS_DESC",{resource:p})));var v,E=f.default.open(G({onOk:(v=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.delete(r);case 2:f.default.close(E),i.default.success({content:t("DELETED_SUCCESSFULLY")}),o&&o();case 5:case"end":return e.stop()}}),e)}))),function(){return v.apply(this,arguments)}),store:a,desc:m,type:"APP_TEMPLATE",resource:p,modal:h.default},d))}},"openpitrix.template.action":{on:function(e){var a,r=e.store,n=e.detail,o=e.handleType,s=e.success,d=(0,c.default)(e,["store","detail","handleType","success"]),p=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.handle({action:o,app_id:n.app_id,app_version_types:n.app_version_types});case 2:a=F.HANDLE_TYPE_TO_SHOW[o]||o,f.default.close(p),i.default.success({content:"".concat(t("".concat(a.toUpperCase(),"_SUCCESSFUL")))}),s&&s();case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),content:t.html("APP_".concat((o||"suspend").toUpperCase(),"_TIP"),{name:n.name}),modal:S.default,store:r},d))}},"openpitrix.template.review":{on:function(e){var a,r=e.store,n=e.detail,o=e.type,s=e.success,d=e.onReject,p=(0,c.default)(e,["store","detail","type","success","onReject"]),m=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(){var a,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.app_id,u=n.version_id,e.next=3,r.handle({app_id:a,version_id:u,action:"pass"});case 3:f.default.close(m),i.default.success(t("RELEASE_SUCCESSFUL")),s&&s();case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),onReject:function(){f.default.close(m),d()},icon:"safe-notice",title:t("APP_DETAILS"),description:t("APP_DETAILS_DESC"),canHandle:"unprocessed"===o,modal:_.default,detail:n,store:r},p))}},"openpitrix.template.reject":{on:function(e){var a,r=e.store,n=e.detail,o=e.type,s=e.success,d=(0,c.default)(e,["store","detail","type","success"]),p=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=n.app_id,o=n.version_id,e.next=3,r.handle(G({app_id:u,version_id:o,action:"reject"},a));case 3:f.default.close(p),i.default.success(t("REJECT_SUCCESSFUL")),s&&s();case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),icon:"safe-notice",title:t("REJECTION_REASON"),description:t("REJECT_REASON_DESC"),canHandle:"unprocessed"===o,versionId:n.version_id||"",modal:O.default,store:r},d))}},"openpitrix.category.edit":{on:function(e){var a,r=e.store,n=e.detail,o=e.names,s=e.success,d=(0,c.default)(e,["store","detail","names","success"]),p=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.category_id){e.next=6;break}return e.next=3,r.update(a);case 3:u="".concat(t("MODIFY_SUCCESSFUL")),e.next=9;break;case 6:return e.next=8,r.create(a);case 8:u=t("CREATE_SUCCESSFUL");case 9:f.default.close(p),i.default.success({content:u}),s&&s();case 12:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),title:t("CATEGORY"),icon:"tag",detail:n,categoryNames:o,modal:C.default,store:r},d))}},"openpitrix.category.delete":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,s=(0,c.default)(e,["store","detail","success"]),d=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.delete(n);case 2:f.default.close(d),i.default.success({content:t("DELETED_SUCCESSFULLY")}),o&&o();case 5:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),desc:t.html("DELETE_CATEGORY_DESC",{name:n.name}),modal:h.default,store:r},s))}},"openpitrix.category.ajust":{on:function(e){var a,r=e.store,n=e.success,o=(0,c.default)(e,["store","success"]),s=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.adjustCategory(a);case 2:f.default.close(s),i.default.success({content:"".concat(t("CHANGED_SUCCESSFULLY"))}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),title:t("CHANGE_CATEGORY"),icon:"tag",modal:T.default,store:r},o))}},"openpitrix.db.adjustCapacity":{on:function(e){var a,r=e.store,n=e.success,o=e.icon,s=(0,c.default)(e,["store","success","icon"]),d=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.default.close(d),i.default.success({content:"".concat(t("MODIFY_SUCCESSFUL"))}),n&&n();case 3:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),title:t("EXPAND_VOLUME"),icon:o,modal:R.default,store:r},s))}},"openpitrix.db.createDBNode":{on:function(e){var a,r=e.store,n=e.success,o=e.icon,s=(0,c.default)(e,["store","success","icon"]),d=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.default.close(d),a?i.default.success({content:"".concat(t("DELETED_SUCCESSFULLY"))}):i.default.success({content:"".concat(t("CREATE_SUCCESSFUL"))}),n&&n();case 3:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),title:t("SCALE_OUT"),icon:o,modal:D.default,store:r},s))}},"openpitrix.db.adjustSpecification":{on:function(e){var a,r=e.store,n=e.success,o=e.icon,s=(0,c.default)(e,["store","success","icon"]),d=f.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.default.close(d),i.default.success({content:"".concat(t("MODIFY_SUCCESSFUL"))}),n&&n(a);case 3:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),title:t("ADJUST_RESOURCES"),icon:o,modal:k.default,store:r},s))}},"openpitrix.db.createAccount":{on:function(e){var t,a=e.store,r=e.success,n=e.icon,o=e.content,s=(0,c.default)(e,["store","success","icon","content"]),d=f.default.open(G({onOk:(t=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.default.close(d),o&&i.default.success({content:o}),r&&r();case 3:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),onCancel:function(){f.default.close(d)},icon:n,modal:N.default,store:a},s))}},"openpitrix.db.app.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=f.default.open(G({onOk:function(e){a.patch(r,e).then((function(){f.default.close(u),i.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},store:a,detail:r,modal:I.default},l))}},"openpitrix.db.app.update":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=f.default.open(G({onOk:function(){a.updateVersion(r).then((function(){f.default.close(u),i.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},store:a,detail:r,modal:U.default},l))}},"openpitrix.db.app.create":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=P.default.open(G({onOk:function(){f.default.close(u),i.default.success({content:"".concat(t("CREATE_SUCCESSFUL"))}),n&&n()},store:a,detail:r,modal:A.default},l))}},"openpitrix.db.backup.create":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,s=(0,c.default)(e,["store","detail","success"]),d=P.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.add(G(G({},s),a));case 2:f.default.close(d),i.default.success({content:"".concat(t("CREATE_SUCCESSFUL"))}),o&&o();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:n,modal:w.default},s))}},"openpitrix.db.backup.auto":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,s=(0,c.default)(e,["store","detail","success"]),d=P.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.autoBackup(a);case 2:f.default.close(d),i.default.success({content:"".concat(t("MODIFY_SUCCESSFUL"))}),o&&o();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:n,modal:L.default},s))}},"openpitrix.db.kafka.rebalance":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=P.default.open(G({onOk:function(){f.default.close(u),i.default.success({content:"".concat(t("CREATE_SUCCESSFUL"))}),n&&n()},store:a,detail:r,modal:M.default},l))}},"openpitrix.db.topic.create":{on:function(e){var a,r=e.store,n=e.isEdit,o=e.detail,s=e.success,d=(0,c.default)(e,["store","isEdit","detail","success"]),p=P.default.open(G({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}return e.next=3,r.edit(G({topic:a,oldTopicName:o.name},d));case 3:i.default.success({content:"".concat(t("UPDATE_SUCCESSFUL"))}),e.next=9;break;case 6:return e.next=8,r.create(G({topic:a},d));case 8:i.default.success({content:"".concat(t("CREATE_SUCCESSFUL"))});case 9:f.default.close(p),s&&s();case 11:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:o,isEdit:n,modal:x.default,okText:t("OK")},d))}},"openpitrix.app.agreement":{on:function(e){var t=e.success,a=(0,c.default)(e,["success"]),r=f.default.open(G({onOk:function(){f.default.close(r),t&&t()},modal:j.default},a))}}};a.default=B},function(e,t,a){"use strict";var r=a(19),n=a(162);a(12),a(10),a(6),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(10),a(6),a(27),a(29),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var l,u,o,c=r(a(317)),s=r(a(50)),i=r(a(31)),f=r(a(25)),d=r(a(28)),p=r(a(41)),m=r(a(42)),h=r(a(37)),v=n(a(0)),E=a(243),y=r(a(244)),g=r(a(1)),b=a(189),S=r(a(798)),_=r(a(2732)),O=r(a(2739)),C=r(a(2747));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var k=(0,E.observer)((o=u=function(e){(0,p.default)(a,e);var t=D(a);function a(e){var r;return(0,f.default)(this,a),(r=t.call(this,e)).setViewType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"appList",t=arguments.length>1?arguments[1]:void 0;r.setState({selectRepo:t,viewType:e})},r.handleClickApp=function(e){r.setState({viewType:"appDetail",selectApp:e})},r.handleDeploy=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.props.trigger("openpitrix.template.deploy",R(R(R({},e),(0,y.default)(r.props,["cluster","workspace","namespace"])),{},{success:function(){return r.props.onOk()}}))},r.state={selectRepo:"",viewType:"appList",selectApp:null},r}return(0,d.default)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,r=e.workspace,n=(e.onDeploy,(0,s.default)(e,["visible","onCancel","workspace","onDeploy"])),l=this.state,u=l.viewType,o=l.selectApp,i=l.selectRepo;return v.default.createElement(S.default,(0,c.default)({width:1070,className:C.default.modal,bodyClassName:C.default.body,visible:t,onCancel:a,rightScreen:!0,hideHeader:!0,hideFooter:!0},n),v.default.createElement(b.Button,{className:C.default.close,icon:"close",iconType:"light",type:"control",onClick:a}),"appList"===u&&v.default.createElement(_.default,{workspace:r,selectRepo:i,setType:this.setViewType,onClickApp:this.handleClickApp}),"appDetail"===u&&v.default.createElement(O.default,{setType:this.setViewType,app:o,workspace:r,onDeploy:this.handleDeploy}))}}]),a}(v.Component),u.propTypes={workspace:g.default.string,visible:g.default.bool,onOk:g.default.func,onCancel:g.default.func},u.defaultProps={workspace:"",visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;t.default=k},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(71),r(197),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(860),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(71),r(197),r(7);var u=n(r(58)),o=n(r(38)),c=n(r(31));r(35);var s,i,f,d=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=l(r(0)),g=r(243),b=n(r(1)),S=n(r(26)),_=n(r(458)),O=r(189),C=n(r(2733)),T=n(r(468)),R=n(r(1183)),D=r(329),k=n(r(2738));function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var A=(0,g.observer)((f=i=function(e){(0,h.default)(n,e);var a,r=P(n);function n(e){var t;return(0,p.default)(this,n),(t=r.call(this,e)).fetchRepos=(0,d.default)(o.default.mark((function e(){var a,r,n=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.length>0&&void 0!==n[0]?n[0]:{},r=t.props.workspace,e.next=4,t.repoStore.fetchList(I({status:"active",noLimit:!0,workspace:r},a));case 4:case"end":return e.stop()}}),e)}))),t.fetchApps=(0,d.default)(o.default.mark((function e(){var a,r,n,l,c,s=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>0&&void 0!==s[0]?s[0]:{},r=!(s.length>1&&void 0!==s[1])||s[1],e.next=4,t.appStore.fetchList(I({page:1,limit:D.STORE_APP_LIMIT,status:t.isFormWorkspace?"":"active",workspace:t.isFormWorkspace?t.props.workspace:"",repo_id:t.selectedRepo},a));case 4:n=t.appStore,l=n.allApps,c=n.list,r?(l.clear(),l.replace(c.data)):l.push.apply(l,(0,u.default)(c.data));case 6:case"end":return e.stop()}}),e)}))),t.fetchMoreApps=(0,d.default)(o.default.mark((function e(){var a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.appStore.list.page,e.next=3,t.fetchApps({page:a+1},!1);case 3:case"end":return e.stop()}}),e)}))),t.handleSearch=function(e){t.fetchApps({keyword:e})},t.handleRefresh=function(){t.fetchApps()},t.handleChangeRepo=function(e){t.selectedRepo!==e&&t.setState({selectRepo:e},(function(){t.fetchApps()}))},t.state={selectRepo:e.selectRepo},t.appStore=new T.default,t.repoStore=new R.default,t}return(0,m.default)(n,[{key:"componentDidMount",value:(a=(0,d.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchRepos();case 2:if(!(this.repoSelectOptions.length>0)){e.next=5;break}return e.next=5,this.fetchApps();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderHeader",value:function(){return y.default.createElement("div",{className:k.default.header},y.default.createElement("div",{className:k.default.logo},y.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/application.svg",alt:""})),y.default.createElement("div",{className:k.default.text},y.default.createElement("h2",null,t("APP_TEMPLATE_PL")),y.default.createElement("p",null,t("APP_TEMPLATES_MODAL_DESC"))))}},{key:"renderToolbar",value:function(){return y.default.createElement("div",{className:k.default.toolbar},y.default.createElement(O.Select,{name:"repo",placeholder:t("SELECT_APP_REPOSITORY"),onChange:this.handleChangeRepo,className:k.default.selectRepos,options:this.repoSelectOptions,value:this.selectedRepo}),y.default.createElement(O.InputSearch,{onSearch:this.handleSearch,className:k.default.search,placeholder:t("SEARCH")}),y.default.createElement(O.Button,{type:"flat",icon:"refresh",onClick:this.handleRefresh}))}},{key:"render",value:function(){var e=this.appStore,t=e.allApps,a=e.list,r=a.isLoading,n=a.total;return y.default.createElement(y.default.Fragment,null,this.renderHeader(),this.renderToolbar(),y.default.createElement("div",{className:k.default.apps},y.default.createElement(C.default,{itemCls:k.default.appItem,apps:t.toJS(),isLoading:r,total:n,onFetchMore:this.fetchMoreApps,onClickAppItem:this.props.onClickApp,disableLink:!0})))}},{key:"isFormWorkspace",get:function(){return!this.selectedRepo}},{key:"repoSelectOptions",get:function(){var e=this.repoStore.list.data.map((function(e){var t=e.name;return{value:e.repo_id,label:t}}));return e.unshift({value:null,label:t("CURRENT_WORKSPACE")}),e}},{key:"selectedRepo",get:function(){return this.state.selectRepo||(0,S.default)(this.repoSelectOptions,"[0].value")}}]),n}(y.Component),i.propTypes={workspace:b.default.string,store:b.default.object,onClickApp:b.default.func,fetchApps:b.default.func,selectRepo:b.default.string},i.defaultProps={workspace:"",store:{},onClickApp:_.default},s=f))||s;a.default=A},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(5)),m=n(r(458)),h=r(437),v=n(r(2734)),E=r(248),y=n(r(2737));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var b=function(e){(0,o.default)(r,e);var a=g(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"renderApps",value:function(){var e=this.props,a=e.workspace,r=e.cluster,n=e.namespace,l=e.apps,u=e.iconName,o=e.showCreateVendor,c=e.isLoading,s=e.itemCls,f=e.disableLink,d=e.onClickAppItem;if(0===l.length&&!c)return i.default.createElement("div",{className:y.default.noApp},i.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/empty-card.svg",alt:""}),i.default.createElement("p",null,t("NO_RESOURCE_FOUND")));var m=(0,E.stringify)({workspace:a,cluster:r,namespace:n});return i.default.createElement(i.default.Fragment,null,l.map((function(e){var t="/apps/".concat(e.app_id,"?").concat(m);return f&&d?i.default.createElement("div",{key:e.app_id,className:(0,p.default)(y.default.appItem,s),onClick:function(){return d(e)}},i.default.createElement(v.default,{app:e,showCreateVendor:o,iconName:u})):i.default.createElement(h.Link,{key:e.app_id,className:(0,p.default)(y.default.appItem,s),to:t},i.default.createElement(v.default,{app:e,showCreateVendor:o,iconName:u}))})))}},{key:"render",value:function(){var e=this.props,a=e.apps,r=e.isLoading,n=e.total,l=e.onFetchMore,u=e.title,o=e.className,c=e.appRef;return i.default.createElement("div",{className:(0,p.default)(y.default.appList,o),ref:c},u&&i.default.createElement("p",{className:"apps-title"},u),this.renderApps(),r&&i.default.createElement("div",{className:y.default.loading},i.default.createElement(d.Loading,null)),!r&&a.length<n&&i.default.createElement("a",{className:y.default.loadMore,onClick:l},i.default.createElement("span",null,t("VIEW_MORE"))))}}]),r}(i.default.PureComponent);a.default=b,b.propTypes={apps:f.default.array,isLoading:f.default.bool,total:f.default.number,onFetchMore:f.default.func,itemCls:f.default.string,title:f.default.string,disableLink:f.default.bool,onClickAppItem:f.default.func,iconName:f.default.string,showCreateVendor:f.default.bool},b.defaultProps={apps:[],isLoading:!1,total:0,onFetchMore:m.default,disableLink:!1,showCreateVendor:!1}},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=n(r(826)),p=r(56),m=n(r(1456)),h=r(189),v=n(r(2736));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"renderVendor",value:function(){var e=this.props,a=e.app;if(e.showCreateVendor)return t("CREATOR_VALUE",{value:a.creator||"-"});var r=(0,p.safeParseJSON)(a.latest_app_version.maintainers,[]).map((function(e){return e.name}));return t("MAINTAINER_VALUE",{value:r[0]||"-"})}},{key:"render",value:function(){var e=this.props,a=e.app,r=e.iconName,n=(0,f.default)(globals.user,"lang")||(0,p.getBrowserLang)(),l=(0,f.default)(a,"description_".concat(n),a.description);return i.default.createElement("div",{className:v.default.wrapper},i.default.createElement("div",{className:v.default.title},i.default.createElement("span",{className:v.default.icon},r?i.default.createElement(h.Icon,{name:r,size:48}):i.default.createElement(d.default,{iconSize:48,src:a.icon,iconLetter:a.name,alt:""})),i.default.createElement("div",{className:v.default.text},i.default.createElement("div",null,i.default.createElement("strong",null,a.name||"-"),i.default.createElement(m.default,{app:a})),i.default.createElement("p",{className:v.default.desc,title:l||""},l||"-"))),i.default.createElement("div",{className:v.default.bottom},i.default.createElement("span",{className:v.default.vendor},this.renderVendor()),i.default.createElement("span",{className:v.default.version,title:a.latest_app_version.name},t("LATEST_VALUE",{value:a.latest_app_version.name||"-"}))))}}]),r}(i.default.Component);a.default=y},function(e,t,a){e.exports={content:"_3K7XcF23Jr-6yl5gk0sUpA",authorizedTip:"_3wRwZh7wpRb0keKGmC6P9F",authorizedTipTitle:"_37-SrvFOHEgEEq2XbhamIN"}},function(e,t,a){e.exports={wrapper:"_1zF0xPww2LpgxDFbVDQtWc",title:"_2Nq0b4RJcpqibfUTxirGBM",icon:"BqQX23omFu9bVU3UdZO12",text:"SpkoXwVuepyl5mMB85r9s",desc:"_30UPhHVa7pOp-XEWz2eRz_",bottom:"_3ZaAkU1nl0bI9b6j2pMyzm",vendor:"fQ6ZLtTi2AjCEIgH1eLeM",version:"_--5xd3q0U7oxxx1TragFp"}},function(e,t,a){e.exports={appList:"_3e_tmkJx9nmHjU2sjIk5fC",appItem:"_2shYOeim1w7KZ_ArClfUd",noApp:"_2tfdcH8dm5pbWjj8uR2TlS",loading:"_2cilLcQtThJ_7F0QvkSkCB",loadMore:"_2zMYJZr8vU75-lyWEPh98A"}},function(e,t,a){e.exports={apps:"_1UatQrbMOVzFuohgTg31oP",appItem:"_1M1BO3tpD1NAdxEzt9622l",header:"_2X4awaWFWZe3_0szPQS1tG",logo:"_2VFLGzBVR1DwI0uG14Iij",text:"_180h4OHwH9Gfe3LwWRj5r1",toolbar:"fwgiubvg9GxvkA5OEo1tO",selectRepos:"hUYgP6O2Qv2aSSy9gAShl",search:"_1Qe3PDhi2sBCabmc6Pwcpf"}},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(109),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var u=n(r(38)),o=n(r(31));r(35);var c,s,i,f=n(r(39)),d=n(r(25)),p=n(r(28)),m=n(r(41)),h=n(r(42)),v=n(r(37)),E=l(r(0)),y=r(243),g=n(r(1)),b=n(r(26)),S=n(r(245)),_=r(189),O=n(r(827)),C=n(r(2740)),T=n(r(1458)),R=n(r(468)),D=n(r(890)),k=n(r(2744)),N=n(r(2746));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var w=(0,y.observer)((i=s=function(e){(0,m.default)(n,e);var a,r=A(n);function n(e){var t;return(0,d.default)(this,n),(t=r.call(this,e)).fetchVersions=(0,f.default)(u.default.mark((function e(){var a,r=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,t.versionStore.fetchList(P(P({},a),{},{app_id:t.appId,noLimit:!0}));case 3:case"end":return e.stop()}}),e)}))),t.handleTabChange=function(e){t.setState({tab:e})},t.handleClickBack=function(){var e=t.props.app;t.props.setType("appList",e.repo_id)},t.showDeploy=function(){t.props.onDeploy({app:t.appStore.detail,store:t.appStore})},t.handleChangeAppVersion=function(e){t.setState({selectAppVersion:e})},t.state={tab:"versionInfo",selectAppVersion:"",showDeploy:!1},t.appStore=new R.default,t.versionStore=new D.default,t}return(0,p.default)(n,[{key:"componentDidMount",value:(a=(0,f.default)(u.default.mark((function e(){var t;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchVersions();case 2:t=(0,b.default)(this.versionStore,"list.data[0].version_id",""),this.setState((function(){return{selectAppVersion:t}})),this.appStore.fetchDetail({app_id:[this.appId]});case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){this.props.setType()}},{key:"renderVersionList",value:function(){return E.default.createElement("div",{className:"margin-b12"},E.default.createElement("div",{className:"h6 margin-b12"},t("VERSION")),E.default.createElement(O.default,{value:this.state.selectAppVersion,options:this.versionOptions,onChange:this.handleChangeAppVersion}))}},{key:"render",value:function(){var e=this.props.app,a=this.state,r=a.selectAppVersion,n=a.tab,l=this.appStore.detail;return E.default.createElement(E.default.Fragment,null,E.default.createElement(k.default,{onClickBack:this.handleClickBack,title:e.name,desc:e.description,icon:e.icon}),E.default.createElement("div",{className:N.default.bar},E.default.createElement(_.RadioGroup,{mode:"button",value:n,options:this.tabs,onChange:this.handleTabChange}),E.default.createElement(_.Button,{type:"control",onClick:this.showDeploy},t("INSTALL"))),E.default.createElement("div",{className:N.default.content},E.default.createElement(_.Columns,null,E.default.createElement(_.Column,null,E.default.createElement(C.default,{appId:this.appId,versionId:r,currentTab:n})),E.default.createElement(_.Column,{className:"is-narrow"},this.renderVersionList(),E.default.createElement(T.default,{app:l})))))}},{key:"appId",get:function(){return this.props.app.app_id}},{key:"tabs",get:function(){return[{label:t("APP_INFORMATION"),value:"versionInfo"},{label:t("CHART_FILES"),value:"chartFiles"}]}},{key:"versionOptions",get:function(){return this.versionStore.list.data.map((function(e){var t=e.version_id,a=e.name,r=e.create_time;return{label:a,description:(0,S.default)(r).format("YYYY-MM-DD"),value:t}}))}}]),n}(E.Component),s.propTypes={app:g.default.object,setType:g.default.func,workspace:g.default.string},s.defaultProps={app:{}},c=i))||c;a.default=w},function(e,a,r){"use strict";r(16);var n=r(19);r(8),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(8),r(4),r(18),r(43),r(11);var l,u,o,c,s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(45)),h=n(r(0)),v=n(r(1)),E=r(17),y=r(243),g=r(189),b=n(r(67)),S=n(r(887)),_=n(r(932)),O=n(r(1457)),C=n(r(2742));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var R=g.Tabs.TabPanel,D=(0,y.observer)((c=o=function(e){(0,f.default)(r,e);var a=T(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).handleTabChange=function(e){n.setState({tab:e})},n.renderReadMe=function(){var e=n.files["README.md"];return e||n.fileStore.isLoading?h.default.createElement(_.default,{source:e}):h.default.createElement("p",{className:C.default.noReadme},t("VERSION_INTRO_EMPTY_DESC"))},n.renderChartFiles=function(){if(!(0,b.default)(n.files)){return h.default.createElement(O.default,{files:(0,E.toJS)(n.files),editorOptions:{options:{readOnly:!0}}})}},n.fileStore=new S.default,n.state={tab:"versionInfo"},n}return(0,i.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props.versionId;t!==e.versionId&&this.fetchFile(t)}},{key:"componentDidMount",value:function(){var e=this.props.versionId;this.fetchFile(e)}},{key:"fetchFile",value:function(e){var t=this.props.appId;e&&this.fileStore.fetch({app_id:t,version_id:e})}},{key:"render",value:function(){var e=this.props,a=e.versionId,r=e.currentTab,n=this.state.tab;return a?this.fileStore.isLoading?h.default.createElement(g.Loading,{className:C.default.loading}):"versionInfo"===r?h.default.createElement(h.default.Fragment,null,this.renderReadMe()):"chartFiles"===r?h.default.createElement(h.default.Fragment,null,this.renderChartFiles()):h.default.createElement(g.Tabs,{type:"button",activeName:n,onChange:this.handleTabChange},h.default.createElement(R,{label:t("APP_INTRODUCTION"),name:"versionInfo"},h.default.createElement("div",{className:C.default.wrapper},this.renderReadMe())),h.default.createElement(R,{label:t("CHART_FILES"),name:"chartFiles"},h.default.createElement("div",{className:C.default.wrapper},this.renderChartFiles()))):null}},{key:"files",get:function(){return this.fileStore.files}}]),r}(h.default.Component),o.propTypes={appId:v.default.string,versionId:v.default.string,currentTab:v.default.string},o.defaultProps={currentTab:"",appId:"",versionId:""},u=c,(0,m.default)(u.prototype,"files",[E.computed],Object.getOwnPropertyDescriptor(u.prototype,"files"),u.prototype),l=u))||l;a.default=D},,function(e,t,a){e.exports={wrapper:"_22Uqg9uSekELpB6KOCdXpB",noReadme:"_2op9wgbzpexIMRcDqKNfeb",loading:"_2ycCMmftlBf-UDzqsr_oJG"}},function(e,t,a){e.exports={appBase:"_1I6e4FCt60BefNpkAUBRMO"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=l(r(1)),p=r(189),m=l(r(826)),h=l(r(2745));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=function(e){(0,c.default)(r,e);var a=v(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleClickBack=function(){e.props.onClickBack?e.props.onClickBack():history.back()},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.title,r=e.desc,n=e.icon;return f.default.createElement("div",{className:h.default.banner},f.default.createElement("div",{className:h.default.back,onClick:this.handleClickBack},f.default.createElement(p.Icon,{name:"return",size:20}),f.default.createElement("span",null,t("BACK"))),f.default.createElement("div",{className:h.default.intro},f.default.createElement("span",{className:h.default.icon},f.default.createElement(m.default,{src:n,alt:"",iconLetter:a,iconSize:48})),f.default.createElement("div",{className:h.default.text},f.default.createElement("h3",null,a),f.default.createElement("p",null,r))),f.default.createElement("div",{className:h.default.rightIcon},f.default.createElement("span",{className:h.default.image},f.default.createElement(m.default,{src:n,alt:"",iconLetter:a,iconSize:200}))))}}]),r}(f.PureComponent);E.propTypes={title:d.default.string,desc:d.default.string,icon:d.default.string,onClickBack:d.default.func};var y=E;a.default=y},function(e,t,a){e.exports={banner:"_1FsQGq61FOegh8j3_GhZif",back:"_1gmVPVuByhMa57J036PSxv",intro:"_3j5upf16nlGbfjUg4e-X34",icon:"fDrmqEhdOkv6q7azoOFUs",text:"Pk8jY_OQnHqX_iBCCvh9r",rightIcon:"_Ea0pMqGjtHduLt6SbNPo",image:"_2Dw5Wj1kIEH4VCAKK2-1q6"}},function(e,t,a){e.exports={bar:"_1DaaC_xsG5XhBKwZhkgEg2",content:"_9_gu9ro0MHL2Y29sszoZI",loading:"_4r_xEprGi4V3ulL1P_Ojc"}},function(e,t,a){e.exports={modal:"_1KackZTxL0khYUVdXmINz7",body:"_1QrRgA4KOz3Xeinog9zRKn",close:"_3PAVlOmYX1mSke11tsE8YY"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).handleOk=function(t){(0,e.props.onOk)(t)},e}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.detail,r=e.visible,n=e.isSubmitting,l=e.onCancel;return i.default.createElement(p.default.Form,{data:a,width:691,title:t("EDIT_INFORMATION"),icon:"pen",onOk:this.handleOk,okText:t("OK"),onCancel:l,visible:r,isSubmitting:n},i.default.createElement(d.Form.Item,{label:t("NAME"),desc:t("LONG_NAME_DESC")},i.default.createElement(d.Input,{name:"name",disabled:!0})),i.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},i.default.createElement(d.TextArea,{maxLength:256,name:"description"})))}}]),r}(i.default.Component);a.default=h,h.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},h.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(20),r(320),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(320),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(38)),o=n(r(31));r(35);var c,s,i,f,d=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=n(r(45)),g=n(r(0)),b=n(r(1)),S=r(17),_=r(243),O=n(r(26)),C=n(r(68)),T=n(r(244)),R=r(189),D=n(r(838)),k=n(r(798)),N=n(r(890)),I=n(r(887)),P=r(873),A=n(r(2750));function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var x=(0,_.observer)((f=i=function(e){(0,h.default)(r,e);var a=M(r);function r(e){var n;return(0,p.default)(this,r),(n=a.call(this,e)).updateValuesYaml=function(){var e=n.fileStore.files;e&&e["values.yaml"]?((0,C.default)(n.state.formData,"conf",e["values.yaml"]),n.setState({valuesYaml:e["values.yaml"],loadingFile:!1})):n.setState({loadingFile:!1})},n.versionOptionRender=function(e){var a=e.label,r=e.value;return g.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",r===n.latestVersion&&g.default.createElement(R.Tag,{type:"warning"},t("LATEST_VERSION")))},n.fetchVersions=(0,d.default)(u.default.mark((function e(){var t,a,r=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},a=n.props.detail,e.abrupt("return",n.versionStore.fetchList(L(L({},t),{},{app_id:a.app_id})));case 3:case"end":return e.stop()}}),e)}))),n.handleVersionChange=function(e){var t=n.props.detail;(0,C.default)(n.state.formData,"version_id",e),n.setState({loadingFile:!0,valuesYaml:""}),n.fileStore.fetch({app_id:t.app_id,version_id:e}).then((function(){n.updateValuesYaml()}))},n.handleYamlChange=function(e){var t=n.state.formData;n.setState({valuesYaml:e},(function(){(0,C.default)(t,"conf",e)}))},n.handleOk=function(){n.props.onOk(n.state.formData)},n.state={currentStep:0,formData:L(L({},(0,T.default)(e.detail,["app_id","cluster_id","description","name","owner","version_id"])),{},{namespace:e.namespace,cluster:e.cluster,workspace:e.workspace}),valuesYaml:"",conf:(0,O.default)(e.detail,"env",""),loadingFile:!1},n.versionStore=new N.default,n.fileStore=new I.default,n}return(0,m.default)(r,[{key:"componentDidMount",value:function(){this.init()}},{key:"init",value:function(){var e=this;this.setState({loadingFile:!0}),this.versionStore.fetchList({app_id:this.props.detail.app_id}),this.fileStore.fetch({app_id:this.props.detail.app_id,version_id:this.state.formData.version_id}).then((function(){e.updateValuesYaml()}))}},{key:"render",value:function(){var e=this.props.detail,a=this.state,r=a.valuesYaml,n=a.conf,u=a.loadingFile;return g.default.createElement(k.default,(0,l.default)({title:t("EDIT_APP_SETTINGS")},this.props,{onOk:this.handleOk,width:1280,okText:t("OK")}),g.default.createElement(R.Columns,null,g.default.createElement(R.Column,null,g.default.createElement("div",{className:A.default.label},t("CURRENT_APP_VERSION")),g.default.createElement(R.Input,{className:"margin-b12",value:e.version.name,readOnly:!0}),g.default.createElement("div",{className:A.default.label},t("CURRENT_APP_SETTINGS_READONLY")),g.default.createElement(R.Loading,{spinning:!1},g.default.createElement(D.default,{mode:"yaml",className:A.default.readOnly,value:n,options:{readOnly:!0}}))),g.default.createElement(R.Column,null,g.default.createElement("div",{className:A.default.label},t("TARGET_APP_VERSION")),g.default.createElement(R.Select,{name:"version_id",className:"margin-b12",value:this.state.formData.version_id,options:this.sortedVersions,placeholder:t("VERSION_EMPTY_DESC"),pagination:(0,T.default)(this.versionStore.list,["page","limit","total"]),isLoading:this.versionStore.list.isLoading,onFetch:this.fetchVersions,onChange:this.handleVersionChange,optionRenderer:this.versionOptionRender,valueRenderer:this.versionOptionRender}),g.default.createElement("div",{className:A.default.label},t("TARGET_APP_SETTINGS")),g.default.createElement(R.Loading,{spinning:u},g.default.createElement(D.default,{mode:"yaml",value:r,onChange:this.handleYamlChange})))))}},{key:"sortedVersions",get:function(){return this.versionStore.list.data.map((function(e){return{label:e.name,value:e.version_id}})).sort((function(e,t){return(0,P.compareVersion)(t.name,e.name)}))}},{key:"latestVersion",get:function(){return(0,O.default)(this.sortedVersions,"[0].value","")}}]),r}(g.default.Component),i.propTypes={visible:b.default.bool,detail:b.default.object,store:b.default.object,cluster:b.default.string,workspace:b.default.string,namespace:b.default.string,onOk:b.default.func,onCancel:b.default.func},i.defaultProps={visible:!1,detail:{},onOk:function(){},onCancel:function(){}},s=f,(0,y.default)(s.prototype,"sortedVersions",[S.computed],Object.getOwnPropertyDescriptor(s.prototype,"sortedVersions"),s.prototype),(0,y.default)(s.prototype,"latestVersion",[S.computed],Object.getOwnPropertyDescriptor(s.prototype,"latestVersion"),s.prototype),c=s))||c;a.default=x},function(e,t,a){e.exports={label:"_3uikzxbVhWftLhURgoCd7X",readOnly:"_3khog5JHAOn8kW0CFIpLvI"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(51),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(51),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(440),r(18),r(43),r(30),r(195),r(11),r(69),r(7);var u=l(r(317)),o=l(r(50)),c=l(r(31)),s=l(r(25)),i=l(r(28)),f=l(r(41)),d=l(r(42)),p=l(r(37)),m=n(r(0)),h=l(r(1)),v=l(r(26)),E=r(189),y=l(r(798)),g=l(r(2752)),b=l(r(2753)),S=l(r(1184));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var C=function(e){(0,f.default)(r,e);var a=O(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).getFormData=function(e){var t="https";if(e&&e.url){var a=e.url.match(/^(.*):\/\//);a[1]&&(t=a[1])}return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({type:t,name:"",sync_period:(0,v.default)(e,"sync_period","0s"),repoType:"Helm",visibility:"public",credential:"{}",providers:["kubernetes"]},e)},n.getSeconds=function(e){var t=e.slice(-1),a=e.slice(0,-1),r=parseFloat(e);if(r.toString()!==a)return 179;switch(t){default:case"s":return r;case"m":return 60*r;case"h":return 60*r*60}},n.timeValidator=function(e,a,r){var l=n.getSeconds(a);return l?/^[0-9]*$/.test(l)?0!==l&&(l>86400||l<180)?r({message:t("SYNC_INTERVAL_TIP")}):void r():r({message:t("SYNC_INTERVAL_INVALID")}):r()},n.handleSubmit=function(e){n.props.onOk(e).then((function(){n.setState({formData:n.getFormData({})})}))},n.handleCancel=function(){n.props.onCancel(),n.setState({formData:n.getFormData({})})},n.handleUrlValidate=function(e){n.setState({isValid:e.isValid})},n.formRef=m.default.createRef(),n.state={formData:n.getFormData(e.detail)},n}return(0,i.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.detail!==e.detail&&this.setState({formData:this.getFormData(this.props.detail)})}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.store,n=(e.onOk,e.onCancel,e.workspace),l=(0,o.default)(e,["detail","store","onOk","onCancel","workspace"]),c=a?"EDIT_APP_REPO":"ADD_APP_REPO";return m.default.createElement(y.default.Form,(0,u.default)({bodyClassName:S.default.body,title:t(c),icon:"firewall",width:691,data:this.state.formData,onOk:this.handleSubmit,onCancel:this.handleCancel},l),m.default.createElement(E.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")}]},m.default.createElement(E.Input,{name:"name",autoFocus:!0})),m.default.createElement(b.default,{store:r,workspace:n,formData:this.state.formData,onValidate:this.handleUrlValidate,isSubmitting:this.props.isSubmitting}),m.default.createElement(E.Form.Item,{label:t("SYNC_INTERVAL"),desc:t("SYNC_INTERVAL_DESC"),rules:[{required:!0,message:t("SYNC_PERIOD_EMPTY_DESC")},{validator:this.timeValidator}]},m.default.createElement(g.default,{name:"sync_period"})),m.default.createElement(E.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},m.default.createElement(E.TextArea,{name:"description",maxLength:256})))}}]),r}(m.Component);a.default=C,C.propTypes={store:h.default.object,detail:h.default.object,visible:h.default.bool,isSubmitting:h.default.bool,onOk:h.default.func,onCancel:h.default.func},C.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(51),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(51),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(1184));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(r,e);var a=p(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleChangeValue=function(e,a){var r=t.props.onChange,n=t.state.unit;t.setState({value:a}),r(a?"".concat(a).concat(n):a)},t.handleChangeUnit=function(e){var a=t.props.onChange,r=t.state.value;t.setState({unit:e}),a(r?"".concat(r).concat(e):r)},t.state={value:e.value.slice(0,-1),unit:e.value.slice(-1)},t}return(0,u.default)(r,[{key:"render",value:function(){var e=this.state,t=e.value,a=e.unit;return i.default.createElement("div",{className:d.default.timeInput},i.default.createElement(f.Input,{className:d.default.input,value:t,onChange:this.handleChangeValue}),i.default.createElement(f.Select,{className:d.default.select,value:a,options:this.options,onChange:this.handleChangeUnit}))}},{key:"options",get:function(){return[{label:t("SECONDS"),value:"s"},{label:t("MINUTES"),value:"m"},{label:t("HOURS"),value:"h"}]}}]),r}(i.default.Component);a.default=m},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(143),r(30),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(250),r(32),r(3),r(10),r(6),r(27),r(141),r(29),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(143),r(251),r(30),r(252),r(195),r(11),r(7);var l,u,o,c,s,i,f,d,p,m=n(r(31)),h=n(r(62)),v=n(r(25)),E=n(r(74)),y=n(r(28)),g=n(r(41)),b=n(r(42)),S=n(r(37)),_=n(r(45)),O=(n(r(63)),n(r(0))),C=n(r(1)),T=r(17),R=r(243),D=n(r(2754)),k=n(r(67)),N=n(r(26)),I=n(r(68)),P=n(r(914)),A=r(873),w=r(189),L=n(r(1184));function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,m.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,S.default)(e);if(t){var n=(0,S.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,b.default)(this,a)}}var U=/^(http|https|s3):\/\//,F=[{label:"http://",value:"http"},{label:"https://",value:"https"},{label:"s3://",value:"s3"}],V=(0,R.observer)((p=d=function(e){(0,g.default)(r,e);var a=j(r);function r(e){var n;(0,v.default)(this,r),n=a.call(this,e),(0,h.default)(n,"handleTypeChange",o,(0,E.default)(n)),(0,h.default)(n,"handleUrlChange",c,(0,E.default)(n)),(0,h.default)(n,"handleAccessInputChange",s,(0,E.default)(n)),(0,h.default)(n,"handleVerify",i,(0,E.default)(n)),(0,h.default)(n,"handleVerifyResult",f,(0,E.default)(n));var l=(0,N.default)(e.formData,"type","http"),u=n.getUrl(e.formData),d=n.getCredential(e.formData);return(0,T.extendObservable)((0,E.default)(n),{type:l,url:u,credential:d,validateStatus:"",validateStatusCode:0,isValid:!1}),n.validateSchema=new D.default({url:function(e,a,r){n.isValid&&"success"===n.validateStatus?r():r(new Error(t("INVALID_URL_DESC")))}}),n}return(0,y.default)(r,[{key:"store",get:function(){return this.props.store}}]),(0,y.default)(r,[{key:"getUrl",value:function(e){if(e.url){var t=new RegExp("^([\\s\\S]*?:\\/\\/)([\\s\\S]*)$","g").exec(e.url);return t?t[2]:""}return""}},{key:"getCredential",value:function(e){var t={accessKeyID:"",secretAccessKey:""};if(e.credential)try{return x(x({},t),JSON.parse(e.credential))}catch(e){}return t}},{key:"resetValidateStatus",value:function(){this.validateStatus="",this.validate()}},{key:"checkVerifyEnable",value:function(){if("validating"===this.validateStatus)return!1;if("s3"===this.type){var e=this.credential,t=e.accessKeyID,a=e.secretAccessKey;return!(0,k.default)(this.url)&&!(0,k.default)(t)&&!(0,k.default)(a)}return!(0,k.default)(this.url)}},{key:"validate",value:function(){var e=this.props,t=e.formData,a=e.onValidate;this.validateSchema.validate(t,{first:!0},(function(e,t){a({isValid:(0,k.default)(t)})}))}},{key:"render",value:function(){return O.default.createElement("div",{className:L.default.urlInput},this.renderField(),this.renderAccess())}},{key:"renderValidateStatus",value:function(){var e=this.validateStatus,a=this.validateStatusCode;if(""===e)return null;var r="validating"===e?O.default.createElement(w.Loading,{size:16}):O.default.createElement(w.Tooltip,{placement:"top",content:"success"===e?t("VALID_URL_DESC"):(0,A.checkRepoInvalidReason)(a)},O.default.createElement(w.Icon,{name:e}));return O.default.createElement("div",{className:L.default.validStatus},r)}},{key:"renderField",value:function(){return O.default.createElement("div",{className:L.default.field},O.default.createElement("label",{className:L.default.label},t("URL")),O.default.createElement("div",{className:L.default.fieldInput},O.default.createElement(w.Select,{className:L.default.protocol,value:this.type,options:F,onChange:this.handleTypeChange}),O.default.createElement(w.Input,{className:L.default.url,type:"text",name:"url",value:this.url,validateStatus:this.validateStatus,placeholder:"example.com",onChange:this.handleUrlChange}),this.renderValidateStatus(),"s3"!==this.type&&O.default.createElement(w.Button,{className:L.default.verifyBtn,onClick:this.handleVerify,disabled:!this.checkVerifyEnable()||this.props.isSubmitting},t("VALIDATE"))),O.default.createElement("div",{className:L.default.desc},t("APP_REPO_URL_DESC")))}},{key:"renderAccess",value:function(){return"s3"!==this.type?null:O.default.createElement("div",{className:L.default.access},O.default.createElement("div",{className:L.default.accessItem},O.default.createElement("label",{className:L.default.label},t("ACCESS_KEY_ID")),O.default.createElement(w.Input,{name:"accessKeyID",value:this.credential.accessKeyID,onChange:this.handleAccessInputChange})),O.default.createElement("div",{className:L.default.accessItem},O.default.createElement("label",{className:L.default.label},t("SECRET_ACCESS_KEY")),O.default.createElement(w.Input,{name:"secretAccessKey",value:this.credential.secretAccessKey,onChange:this.handleAccessInputChange})),O.default.createElement(w.Button,{className:L.default.verifyBtn,onClick:this.handleVerify,disabled:!this.checkVerifyEnable()||this.props.isSubmitting},t("VALIDATE")))}}]),r}(O.default.Component),d.propTypes={formData:C.default.object,onValidate:C.default.func,isSubmitting:C.default.bool},d.defaultProps={formData:{},onValidate:function(){},isSubmitting:!1},u=p,o=(0,_.default)(u.prototype,"handleTypeChange",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.props.formData;(0,I.default)(a,"credential","s3"===t?JSON.stringify(e.credential):"{}"),(0,I.default)(a,"type",t),e.type=t,U.test(e.url)||(0,I.default)(a,"url","".concat(t,"://").concat(e.url)),e.resetValidateStatus()}}}),c=(0,_.default)(u.prototype,"handleUrlChange",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var r=e.props.formData,n=(0,P.default)(a);(0,I.default)(r,"url",U.test(n)?n:"".concat(e.type,"://").concat(n)),e.url=n,e.resetValidateStatus()}}}),s=(0,_.default)(u.prototype,"handleAccessInputChange",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.target.name;e.credential[a]=t.target.value,(0,I.default)(e.props.formData,"credential",JSON.stringify(e.credential)),e.resetValidateStatus()}}}),i=(0,_.default)(u.prototype,"handleVerify",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.validateStatus="validating";var t=e.props.formData,a=t.url,r=t.credential;e.store.validate({type:e.type,url:a,workspace:e.props.workspace,credential:r}).then((function(t){e.handleVerifyResult(t.ok,t.errorCode)})).catch((function(){e.handleVerifyResult(!1)}))}}}),f=(0,_.default)(u.prototype,"handleVerifyResult",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){e.validateStatus=t?"success":"error",e.validateStatusCode=t?0:a,e.isValid=t,e.validate()}}}),(0,_.default)(u.prototype,"resetValidateStatus",[T.action],Object.getOwnPropertyDescriptor(u.prototype,"resetValidateStatus"),u.prototype),l=u))||l;a.default=V},,,,,,,,,,,,,,,,,,,,,,,function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(12),r(109),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(29),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(1)),h=l(r(5)),v=r(189),E=l(r(798)),y=l(r(2777)),g=l(r(2779));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=function(e){(0,i.default)(r,e);var a=b(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onOk,n=(0,o.default)(e,["visible","onOk"]);return p.default.createElement(E.default,(0,u.default)({width:600,bodyClassName:g.default.body,visible:a,hideHeader:!0},n),p.default.createElement("div",{className:(0,h.default)(g.default.header,"clearfix")},p.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/application.svg",alt:""}),p.default.createElement("div",{className:g.default.title}," ",t("CREATE_APP_TEMPLATE")),p.default.createElement("div",{className:g.default.description},t("CREATE_APP_TEMPLATE_DESC"))),p.default.createElement(y.default,{className:g.default.item,title:t("UPLOAD_HELM_TITLE"),show:!0},p.default.createElement("div",{className:g.default.more},p.default.createElement("div",{className:g.default.description},t("HELM_CHART_FORMAT_DESC")),p.default.createElement(v.Button,{type:"control",onClick:r},t("UPLOAD")))))}}]),r}(p.Component);a.default=S,S.propTypes={visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func},S.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),a(3),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(32),a(3),a(29),a(14),a(4),a(18),a(43),a(11);var n=r(a(31)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(1),d=r(a(5)),p=a(189),m=r(a(2778));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(a,e);var t=h(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).state={show:e.props.show,close:!1},e.toggle=function(){e.setState((function(e){return{show:!e.show}}))},e.close=function(){e.setState({close:!0})},e}return(0,u.default)(a,[{key:"render",value:function(){var e,t=this.props,a=t.className,r=t.title,l=t.hasClose,u=t.description,o=t.children,c=this.state,s=c.show,f=c.close;return i.default.createElement("div",{className:(0,d.default)(m.default.item,(e={},(0,n.default)(e,m.default.hideBg,!s),(0,n.default)(e,m.default.close,f),e),a)},i.default.createElement("div",{className:m.default.name,onClick:this.toggle},i.default.createElement(p.Icon,{name:s?"chevron-down":"chevron-right",size:20}),r,l&&!s&&i.default.createElement(p.Icon,{onClick:this.close,name:"close",size:20,className:m.default.closeIcon})),i.default.createElement("div",{className:(0,d.default)(m.default.detail,(0,n.default)({},m.default.more,!s))},u||o))}}]),a}(i.default.Component);t.default=v,v.propTypes={title:f.PropTypes.string,description:f.PropTypes.string,show:f.PropTypes.bool,hasClose:f.PropTypes.bool},v.defaultProps={title:"",description:"",show:!1,hasClose:!1}},function(e,t,a){e.exports={item:"_2R-OA2wgFv3mbPJKfBIaX7",hideBg:"aSyW8y8emrhSy2MBzQKcD",close:"_3VPiR9lK6WXBhSkrUNdy-H",name:"_33hMf-OF9XImHwm-LhooXh",closeIcon:"_3PIL0xxkZX8ydOOwdHurfc",detail:"QO8FskG69CUNwCFVUQSRe",more:"_3U3WzN-jhR4kf_IMbMjLGK"}},function(e,t,a){e.exports={body:"_3h99wEjjBu7dM8XLM260Si",header:"_28t6cMjRrw-hLtf4pMoFxM",title:"rZl0p0p0PvUroTZyEmQ0C",description:"CTcfpOJrLSYc8t6F5szin",item:"_1ytH-qXuR9Oiy1Assaixn0",more:"_39janX0J74H9bDKIZeydBs",note:"_2QwVboTlporGzzInUuRTuz"}},,,,,,function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(71),r(991),r(7);var l=n(r(317)),u=n(r(50)),o=n(r(38)),c=n(r(31));r(35);var s,i,f,d=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=n(r(0)),g=n(r(1)),b=r(243),S=n(r(26)),_=r(189),O=n(r(798)),C=n(r(1461)),T=n(r(2789)),R=n(r(890)),D=n(r(887)),k=r(56),N=n(r(2793)),I=n(r(2795));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var L=(0,b.observer)((f=i=function(e){(0,h.default)(n,e);var a,r=w(n);function n(e){var t;return(0,p.default)(this,n),(t=r.call(this,e)).handlePrev=function(){t.setState((function(e){var t=e.currentStep;return{currentStep:Math.max(0,t-1)}}))},t.handleNext=function(){var e=t.formRef.current;e&&e.validate((function(){t.setState((function(e){var a=e.currentStep;return{currentStep:Math.min(t.steps.length-1,a+1)}}))}))},t.handleOk=function(){var e=t.formRef.current;e&&e.validate((function(){t.props.onOk(t.state.formData)}))},t.state={currentStep:0,formData:{app_id:e.app.app_id,name:"".concat(e.app.name.slice(0,7).toLowerCase().replaceAll(" ","-"),"-").concat((0,k.generateId)()),version_id:e.versionId,namespace:e.namespace,cluster:e.cluster,workspace:e.workspace},intializing:!0},t.versionStore=new R.default,t.fileStore=new D.default,t.formRef=y.default.createRef(),t}return(0,m.default)(n,[{key:"componentDidMount",value:function(){this.init()}},{key:"init",value:(a=(0,d.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.versionStore.fetchList({app_id:this.props.app.app_id});case 2:return this.state.formData.version_id||this.setState({formData:A(A({},this.state.formData),{},{version_id:(0,S.default)(this.versionStore,"list.data[0].version_id","")})}),e.next=5,this.fileStore.fetch({app_id:this.props.app.app_id,version_id:this.state.formData.version_id});case 5:this.setState({intializing:!1});case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderSteps",value:function(){return y.default.createElement("div",{className:I.default.steps},y.default.createElement(N.default,{steps:this.steps,current:this.state.currentStep}))}},{key:"renderForm",value:function(){var e=this.props,t=e.app,a=e.cluster,r=e.workspace,n=e.namespace,l=e.versionId,u=this.state,o=u.formData,c=u.currentStep;if(u.intializing)return y.default.createElement(_.Loading,{className:I.default.loading});var s=this.steps[c],i=s.component,f={formData:o,cluster:a,workspace:r,namespace:n,versionId:l,versionStore:this.versionStore,fileStore:this.fileStore,appId:t.app_id};return s.isForm?f.formRef=this.formRef:f.ref=this.formRef,y.default.createElement("div",{className:I.default.form},y.default.createElement(i,f))}},{key:"renderFooter",value:function(){var e=this.state.currentStep,a=this.steps.length-1;return y.default.createElement("div",{className:I.default.footer},e>0&&y.default.createElement(_.Button,{type:"control",onClick:this.handlePrev},t("PREVIOUS")),e<a?y.default.createElement(_.Button,{type:"control",onClick:this.handleNext},t("NEXT")):y.default.createElement(_.Button,{type:"control",onClick:this.handleOk,loading:this.props.store.isSubmitting},t("INSTALL")))}},{key:"render",value:function(){var e=this.props,t=e.app,a=(e.versionId,e.onOk,e.onCancel),r=(e.isSubmitting,(0,u.default)(e,["app","versionId","onOk","onCancel","isSubmitting"]));return y.default.createElement(O.default,(0,l.default)({bodyClassName:I.default.body,imageIcon:t.icon||t.name,title:t.name,description:t.description,onCancel:a,rightScreen:!0,hideFooter:!0},r),this.renderSteps(),this.renderForm(),this.renderFooter())}},{key:"steps",get:function(){return[{title:"BASIC_INFORMATION",component:C.default,required:!0,isForm:!0},{title:"APP_SETTINGS",component:T.default,required:!0}]}}]),n}(y.default.Component),i.propTypes={visible:g.default.bool,app:g.default.object,store:g.default.object,cluster:g.default.string,workspace:g.default.string,namespace:g.default.string,versionId:g.default.string,onOk:g.default.func,onCancel:g.default.func},i.defaultProps={visible:!1,app:{},onOk:function(){},onCancel:function(){}},s=f))||s;a.default=L},function(e,t,a){e.exports={title:"_33R0U9boImf8m2I9YsvtEM",placement:"_1DPArJcOi3947q7-jkb3IH",placementWrapper:"Cn8-UAsOj9IFn4AwvBErg",placementContent:"ZsCFEc87YJzsBpso9LRfs"}},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(44),r(6),r(20),r(14),r(138),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var u=n(r(38)),o=n(r(31));r(35);var c,s,i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(45)),E=r(189),y=n(r(5)),g=n(r(981)),b=n(r(800)),S=n(r(840)),_=n(r(26)),O=n(r(244)),C=n(r(68)),T=r(17),R=r(243),D=l(r(0)),k=n(r(441)),N=n(r(443)),I=r(56),P=n(r(2788));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var M=(0,R.observer)((s=function(e){(0,p.default)(c,e);var a,r,n,l=L(c);function c(){var e;(0,f.default)(this,c);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=l.call.apply(l,[this].concat(r))).state={showForm:!1,initializing:!0,formData:e.props.formData},e.formRef=D.default.createRef(),e.workspaceStore=new N.default,e.projectStore=new k.default,e.fetchNamespaces=(0,i.default)(u.default.mark((function t(){var a,r,n,l,o=arguments;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=o.length>0&&void 0!==o[0]?o[0]:{},r=e.state.formData,n=r.workspace,l=r.cluster,!n||!l){t.next=5;break}return t.next=5,e.projectStore.fetchList(w(w({},a),{},{workspace:n,cluster:l,ascending:!0}));case 5:case"end":return t.stop()}}),t)}))),e.handleWorkspaceChange=function(){e.fetchClusters(),(0,C.default)(e.state.formData,"cluster",""),(0,C.default)(e.state.formData,"namespace","")},e.handleClusterChange=function(){e.fetchNamespaces(),(0,C.default)(e.state.formData,"namespace","")},e.handleSubmit=function(){var t=e.formRef.current;t&&t.validate((function(){Object.assign(e.props.formData,w({},e.state.formData)),e.hideForm()}))},e.showForm=function(){e.setState({showForm:!0})},e.hideForm=function(){e.setState({showForm:!1})},e.projectOptionRenderer=function(e){return D.default.createElement("span",{className:P.default.option},e.isFedManaged?D.default.createElement("img",{className:P.default.indicator,src:"/extensions-static/ks-console-embed/dist/v3dist/assets/cluster.svg"}):D.default.createElement(E.Icon,{name:"project"}),e.label,e.isFedManaged&&D.default.createElement(E.Tooltip,{content:t("FEDPROJECT_CANNOT_DEPLOY_APP_TIP")},D.default.createElement(E.Icon,{className:P.default.tip,name:"question"})))},e.clusterOptionRenderer=function(e){return D.default.createElement("div",null,D.default.createElement("div",null,e.label),!e.cluster.isReady&&D.default.createElement("div",null,D.default.createElement(g.default,{data:e.cluster,noTip:!0})))},e}return(0,d.default)(c,[{key:"componentDidMount",value:function(){this.init()}},{key:"init",value:(n=(0,i.default)(u.default.mark((function e(){var t,a,r,n,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({initializing:!0}),t=this.state.formData,a=t.workspace,r=t.cluster,n=t.namespace,e.next=4,this.fetchWorkspaces();case 4:return a||(0,C.default)(this.state.formData,"workspace",(0,_.default)(this.workspaces,"[0].value")),e.next=7,this.fetchClusters();case 7:return r||(0,C.default)(this.state.formData,"cluster",(0,_.default)(this.clusters,"[0].value")),e.next=10,this.fetchNamespaces();case 10:n||(l=this.namespaces.find((function(e){return!e.disabled}))||{},(0,C.default)(this.state.formData,"namespace",l.value||"")),Object.assign(this.props.formData,this.state.formData),this.setState({initializing:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"fetchWorkspaces",value:(r=(0,i.default)(u.default.mark((function e(){var t,a=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.workspaceStore.fetchList(w(w({},t),{},{limit:-1,ascending:!0}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"fetchClusters",value:(a=(0,i.default)(u.default.mark((function e(){var t,a,r=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},!(a=this.state.formData.workspace)){e.next=5;break}return e.next=5,this.workspaceStore.fetchClusters(w(w({},t),{},{workspace:a,limit:-1,ascending:!0}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderPlacement",value:function(){var e=this.props.formData,a=e.namespace,r=e.workspace,n=e.cluster;return D.default.createElement("div",{className:P.default.placement},D.default.createElement(b.default,{className:P.default.text,title:(0,I.showNameAndAlias)(r,"workspace"),description:t("WORKSPACE")}),D.default.createElement(b.default,{className:P.default.text,title:(0,I.showNameAndAlias)(n,"cluster"),description:t("CLUSTER")}),D.default.createElement(b.default,{className:P.default.text,icon:"project",title:(0,I.showNameAndAlias)(a,"project",{cluster:n}),description:t("PROJECT")}),D.default.createElement(E.Icon,{className:P.default.icon,name:"chevron-down",size:20}))}},{key:"renderForm",value:function(){var e=this.props.workspace;return D.default.createElement("div",{className:P.default.form},D.default.createElement(E.Form,{ref:this.formRef,type:"inner",data:this.state.formData},D.default.createElement(E.Columns,null,D.default.createElement(E.Column,null,D.default.createElement(E.Form.Item,{label:t("WORKSPACE")},D.default.createElement(E.Select,{name:"workspace",placeholder:t("WORKSPACE_EMPTY_DESC"),options:this.workspaces,onChange:this.handleWorkspaceChange,prefixIcon:D.default.createElement(E.Icon,{name:"enterprise",size:16}),disabled:!!e}))),D.default.createElement(E.Column,null,D.default.createElement(E.Form.Item,{label:t("CLUSTER")},D.default.createElement(E.Select,{name:"cluster",placeholder:" ",options:this.clusters,onChange:this.handleClusterChange,optionRenderer:this.clusterOptionRenderer,prefixIcon:D.default.createElement(E.Icon,{name:"cluster",size:16}),showTip:!0}))),D.default.createElement(E.Column,null,D.default.createElement(E.Form.Item,{label:t("PROJECT"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")}]},D.default.createElement(E.Select,{name:"namespace",placeholder:" ",options:this.namespaces,pagination:(0,O.default)(this.projectStore.list,["page","limit","total"]),isLoading:this.projectStore.list.isLoading,onFetch:this.fetchNamespaces,valueRenderer:this.projectOptionRenderer,optionRenderer:this.projectOptionRenderer,clearable:!0}))))),D.default.createElement(S.default,{className:P.default.confirm,onOk:this.handleSubmit,onCancel:this.hideForm}))}},{key:"render",value:function(){var e=this.state,a=e.showForm,r=e.formData,n=e.initializing;return a?this.renderForm():D.default.createElement("div",{className:(0,y.default)(P.default.wrapper,(0,o.default)({},P.default.expand,a)),onClick:this.showForm},r.namespace?this.renderPlacement():D.default.createElement("div",{className:P.default.placeholder},n?D.default.createElement(E.Loading,{className:"text-center"}):t("PROJECT_NOT_SELECT_DESC")))}},{key:"workspaces",get:function(){return this.workspaceStore.list.data.filter((function(e){return e.name!==globals.config.systemWorkspace})).map((function(e){return{label:(0,I.showNameAndAlias)(e),value:e.name}}))}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data.map((function(e){return{label:(0,I.showNameAndAlias)(e),value:e.name,disabled:!e.isReady,cluster:e}}))}},{key:"namespaces",get:function(){return this.projectStore.list.data.filter((function(e){return"Terminating"!==e.status})).map((function(e){return{label:(0,I.showNameAndAlias)(e),value:e.name,disabled:e.isFedManaged,isFedManaged:e.isFedManaged}}))}}]),c}(D.Component),(0,v.default)(s.prototype,"workspaces",[T.computed],Object.getOwnPropertyDescriptor(s.prototype,"workspaces"),s.prototype),(0,v.default)(s.prototype,"clusters",[T.computed],Object.getOwnPropertyDescriptor(s.prototype,"clusters"),s.prototype),(0,v.default)(s.prototype,"namespaces",[T.computed],Object.getOwnPropertyDescriptor(s.prototype,"namespaces"),s.prototype),c=s))||c;a.default=M},function(e,t,a){e.exports={wrapper:"_1-zzsgQcL6AnKOs_Sxiu20",placeholder:"_1VOZnqeyx9mHYMTD8k_Q3_",form:"_1AI73FeUImn3gHEsO9StyJ",confirm:"_3w7hJkkJRGqAW2U6H4l_3l",placement:"_2RflgzEx5EebIR0t5yYHhq",text:"_3sMJ4G-DVsOmo9TkX6Xlhr",icon:"_19fvfv87icQ9tqCf2bPw6L",option:"_3GsdSpU7z-pczQtQ6zwAgG",tip:"-gsMZiJ2S2gdBb2vcv9oy"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(68)),p=r(17),m=r(243),h=r(189),v=n(r(838)),E=n(r(858)),y=r(56),g=r(463),b=n(r(2790)),S=n(r(2792));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var O=(0,m.observer)(l=function(e){(0,c.default)(r,e);var a=_(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={valuesYaml:"",valuesJSON:{},valuesSchema:void 0,loadingFile:!0,isCodeMode:!1},e.updateState=function(){var t=e.props.fileStore.files;t?e.setState({valuesYaml:t["values.yaml"],valuesJSON:(0,g.getValueObj)(t["values.yaml"]),valuesSchema:(0,y.safeParseJSON)(t["values.schema.json"]),loadingFile:!1}):e.setState({loadingFile:!1})},e.updateFormData=function(){var t=e.props.formData,a=e.state,r=a.isCodeMode,n=a.valuesYaml,l=a.valuesJSON,u=a.valuesSchema;(0,d.default)(t,"conf",(0,g.getValue)(r||!u?(0,g.getValueObj)(n):l))},e.handleModeChange=function(){var t=e.state.isCodeMode;e.setState({isCodeMode:!t})},e.handleValueChange=function(t){e.setState({valueJSON:t})},e.handleYamlChange=function(t){e.setState({valuesYaml:t})},e}return(0,o.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.updateState(),this.props.fileStore.files.packageFiles||(this.dispather=(0,p.reaction)((function(){return e.props.fileStore.files}),this.updateState))}},{key:"componentWillUnmount",value:function(){this.dispather&&this.dispather()}},{key:"validate",value:function(e){this.updateFormData(),e&&e()}},{key:"renderYamlEdit",value:function(){var e=this.state.valuesYaml;return f.default.createElement("div",{className:S.default.codeWrapper},f.default.createElement(v.default,{mode:"yaml",value:e,onChange:this.handleYamlChange}))}},{key:"renderSchemaForm",value:function(){var e=this.state,t=e.valuesJSON,a=e.valuesSchema;return f.default.createElement("div",{className:S.default.schemaWrapper},f.default.createElement(b.default,{schema:a,value:t,onChange:this.handleValueChange}))}},{key:"render",value:function(){var e=this.state,a=e.valuesSchema,r=e.loadingFile,n=e.isCodeMode,l=n||!a;return r?f.default.createElement(h.Loading,{className:S.default.loading}):f.default.createElement("div",{className:S.default.wrapper},f.default.createElement("div",{className:S.default.title},f.default.createElement("div",null,t("APP_SETTINGS")),a&&f.default.createElement(E.default,{className:S.default.switch,text:t("EDIT_YAML"),onChange:this.handleModeChange,checked:n})),a&&f.default.createElement(h.Alert,{className:"margin-b12",type:"info",message:t("HELM_APP_SCHEMA_FORM_TIP")}),l?this.renderYamlEdit():this.renderSchemaForm())}}]),r}(f.default.Component))||l;a.default=O},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),a(3),a(192),a(24),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(32),a(3),a(192),a(29),a(24),a(4),a(321),a(18),a(43),a(11);var n=r(a(58)),l=r(a(246)),u=r(a(317)),o=r(a(25)),c=r(a(28)),s=r(a(41)),i=r(a(42)),f=r(a(37)),d=r(a(0)),p=r(a(1)),m=r(a(862)),h=r(a(26)),v=r(a(68)),E=r(a(1031)),y=r(a(201)),g=r(a(808)),b=r(a(67)),S=r(a(880)),_=a(189),O=r(a(800)),C=r(a(805)),T=r(a(2791));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var D=function(e){(0,s.default)(a,e);var t=R(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={value:e.props.value},e.triggerChange=(0,g.default)((function(t){e.props.onChange(t)}),300),e.generateMarks=function(e,t){for(var a=parseInt((t-e)/5,10),r={},n=0;n<5;n++){var l=e+n*a;r[l]=l}return r[t]=t,r},e.renderFormItem=function(t,a,r){var n,l=e.state.value,o={defaultValue:(0,h.default)(l,r,""),onChange:function(t){return e.handleFormChange((0,v.default)(l,r,t))}};switch(t.type){case"string":if("slider"===t.render){var c,s=null!==(c=t.sliderMin)&&void 0!==c?c:0,i=Number(t.sliderMax),f=(0,S.default)(i)?100:i<s?s+100:i;n=d.default.createElement(_.Slider,(0,u.default)({max:f,min:s,unit:t.sliderUnit,marks:e.generateMarks(s,f)},o,{withInput:!0}))}else n="textArea"===t.render?d.default.createElement(_.TextArea,o):d.default.createElement(_.Input,o);break;case"integer":n=d.default.createElement(C.default,(0,u.default)({},o,{min:0,integer:!0}));break;case"boolean":n=d.default.createElement("div",{className:T.default.boolean},d.default.createElement(_.Toggle,(0,u.default)({},o,{defaultChecked:(0,h.default)(l,r,!1)})),d.default.createElement(O.default,{title:t.title,description:t.description}));break;case"array":n=d.default.createElement(d.default.Fragment,null,"todo");break;default:n=d.default.createElement(d.default.Fragment,null)}return d.default.createElement(_.Form.Item,{key:a,label:"boolean"===t.type?"":t.title,desc:"boolean"===t.type?"":t.description},n)},e.renderSchemaForm=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],u=t.type,o=t.form,c=e.state.value,s="object"===(0,l.default)(t.hidden)?(0,h.default)(c,t.hidden.value,null)===t.hidden.condition:(0,h.default)(c,t.hidden,!1);if(s)return null;if("object"===u){var i=(0,m.default)(t.properties,(function(t,a){return e.renderSchemaForm(t,a,[].concat((0,n.default)(r),[a]))}));if((0,b.default)(i)||i.every((function(e){return!e})))return null;var f=t.properties&&(0,E.default)(t.properties,(function(e){return(0,y.default)(e,"properties")}));return d.default.createElement("div",{key:a,className:f?T.default.parentGroup:T.default.group},t.title&&d.default.createElement("div",{className:T.default.title},t.title),t.description&&d.default.createElement("p",{className:T.default.description},t.description),i)}return o?e.renderFormItem(t,a,r):null},e}return(0,c.default)(a,[{key:"handleFormChange",value:function(e){this.setState({value:e}),this.triggerChange(e)}},{key:"render",value:function(){var e=this.props.schema;return this.renderSchemaForm(e)}}]),a}(d.default.Component);t.default=D,D.propTypes={schema:p.default.object,value:p.default.object,onChange:p.default.func},D.defaultProps={onChange:function(){}}},function(e,t,a){e.exports={group:"_3xTfalXI7Y64g0li2u6vG2",title:"_182KrRnt2udLzkiRSMx9JE",description:"_2839u1rW56wEbtmaeCpjpO",boolean:"_3mnMZpC4gF0oolH9K1bn2W",parentGroup:"HW1rPNOyhUpkrn584aGu-"}},function(e,t,a){e.exports={wrapper:"TLG9iSoooMsoVDmn61N6I",title:"_1eUI0tEXI3u8lHvjGDMO3f",switch:"_32tTvAbdJ_mXTYRvGpAE2n",codeWrapper:"_3uRVlVgjuj0HJpjr9wInob",schemaWrapper:"_3VOv76O-06CKHBW5mIv-lM",loading:"_2ckKN8H46Wi058LIpHKyNF"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(4),r(18),r(43),r(11);var u=l(r(31)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(5)),m=l(r(2794));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var v=function(e){(0,s.default)(r,e);var a=h(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.steps,r=e.current;return d.default.createElement("div",{className:m.default.wrapper},a.map((function(e,a){var n;return d.default.createElement("div",{key:e.title},d.default.createElement("span",{className:(0,p.default)(m.default.indicator,(n={},(0,u.default)(n,m.default.fullfill,r>a),(0,u.default)(n,m.default.current,r===a),(0,u.default)(n,m.default.pending,r<a),n))}),d.default.createElement("span",null,t(e.title)))})))}}]),r}(d.Component);a.default=v},function(e,t,a){e.exports={wrapper:"_1rMJfMVFnxLy1REsL1b0d2",indicator:"_1AbVJwEGRYpTCxZ4fg8_sj",pending:"_1G5x995omZkUPUMTKD4tAN",current:"_2bAp9vrnpwq4_uGyp0SW3g",fullfill:"GN3iaoOEvA_qq-V2O-jXe"}},function(e,t,a){e.exports={body:"llEBCzPZ3tg-xtEiqsqId",form:"_1CBuVzX83GlsKJl1N68JLM",steps:"_3GIS02Ma2AO6qKKu1n_m0z",footer:"_3huyye8nSYCWnxBm26xXvq",loading:"_1A8KLi4Z4xBf-34211Mprr"}},,function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(12),r(109),r(3),r(20),r(14),r(4),r(18),r(30),r(11),r(139),r(79),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(20),r(29),r(14),r(4),r(21),r(18),r(43),r(11),r(79);var u=n(r(317)),o=n(r(31)),c=n(r(50)),s=n(r(38));r(35);var i,f,d,p=n(r(39)),m=n(r(25)),h=n(r(28)),v=n(r(41)),E=n(r(42)),y=n(r(37)),g=l(r(0)),b=n(r(1)),S=r(243),_=n(r(5)),O=r(189),C=n(r(26)),T=r(17),R=n(r(798)),D=n(r(826)),k=n(r(2798)),N=n(r(2800)),I=n(r(2802)),P=n(r(1185)),A=n(r(2804)),w=n(r(468)),L=n(r(890)),M=n(r(887)),x=n(r(2806));function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,y.default)(e);if(t){var n=(0,y.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,E.default)(this,a)}}var U=O.Tabs.TabPanel,F=(0,S.observer)((d=f=function(e){(0,v.default)(r,e);var a=j(r);function r(e){var t;return(0,m.default)(this,r),(t=a.call(this,e)).fetchData=function(e){var a=e.detail;t.store.fetchDetail({app_id:a.app_id}),t.versionStore.fetchDetail({app_id:a.app_id,version_id:a.version_id}),t.fileStore.fetch({app_id:a.app_id,version_id:a.version_id})},t.getPackageName=function(){var e=t.props.detail,a=(0,C.default)(t.versionStore,"detail.package_name");return!a||a.startsWith("att-")?"".concat(e.app_name,"-").concat(e.version_name):a},t.handleTabChange=function(){var e=(0,p.default)(s.default.mark((function e(a){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setState({tab:a});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.store=new w.default,t.versionStore=new L.default,t.fileStore=new M.default,t.state={tab:"appInfo"},t}return(0,h.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.fetchData(this.props)}},{key:"componentDidMount",value:function(){this.props.visible&&this.fetchData(this.props)}},{key:"renderBaseInfo",value:function(){var e=(0,T.toJS)(this.store.detail),a=(0,T.toJS)(this.versionStore.detail),r=(0,C.default)(e,"screenshots",""),n=r?r.split(","):[],l=n.length;return g.default.createElement(g.default.Fragment,null,g.default.createElement(k.default,{detail:e,versionName:a.name}),g.default.createElement("div",{className:x.default.screenshots},g.default.createElement("div",{className:x.default.title},t("APP_SCREENSHOTS")),l>0?g.default.createElement("ul",null,n.map((function(e,t){return g.default.createElement("li",{key:t},g.default.createElement(D.default,{src:e}))}))):g.default.createElement("p",null,t("NONE"))))}},{key:"renderConfigFiles",value:function(){var e=this.versionStore.detail,t=this.fileStore.files;return g.default.createElement("div",null,g.default.createElement(P.default,{className:x.default.downloadInfo,fileStore:this.fileStore,packageName:this.getPackageName(),updateTime:e.update_time||e.status_time,appId:e.app_id,versionId:e.version_id,hasPackage:!0}),g.default.createElement(I.default,{files:t}))}},{key:"renderFooter",value:function(){var e=this.props,a=e.isSubmitting,r=e.onReject,n=e.onOk;return g.default.createElement("div",{className:x.default.footer},g.default.createElement(O.Button,{type:"danger",onClick:r},t("REJECT")),g.default.createElement(O.Button,{type:"control",loading:a,disabled:a,onClick:n},t("APPROVE")))}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.canHandle,n=(0,c.default)(e,["visible","canHandle"]),l=(0,T.toJS)(this.versionStore.detail),s=this.state.tab,i=(0,C.default)(this.fileStore,"files",{})["README.md"];return g.default.createElement(R.default,(0,u.default)({bodyClassName:(0,_.default)(x.default.body,(0,o.default)({},x.default.hideFooter,!r)),visible:a},n,{rightScreen:!0,hideFooter:!0}),g.default.createElement(O.Tabs,{type:"button",activeName:s,onChange:this.handleTabChange},g.default.createElement(U,{label:t("APP_INFORMATION"),name:"appInfo"},this.renderBaseInfo()),g.default.createElement(U,{label:t("DOCUMENTATION"),name:"readme"},g.default.createElement(N.default,{readme:i})),g.default.createElement(U,{label:t("CHART_FILES"),name:"configFiles"},this.renderConfigFiles()),g.default.createElement(U,{label:t("UPDATE_LOG"),name:"updateLog"},g.default.createElement(A.default,{description:l.description}))),r&&this.renderFooter())}}]),r}(g.Component),f.propTypes={visible:b.default.bool,canHandle:b.default.bool,detail:b.default.object,onReject:b.default.func,onOk:b.default.func,onCancel:b.default.func},f.defaultProps={visible:!1,canHandle:!1,detail:{},onReject:function(){},onOk:function(){},onCancel:function(){}},i=d))||i;a.default=F},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(29),r(14),r(4),r(18),r(43),r(30),r(195),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(826)),m=n(r(932)),h=r(243),v=n(r(1)),E=n(r(0)),y=r(56),g=n(r(2799));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=b(r);function r(){return(0,c.default)(this,r),a.apply(this,arguments)}return(0,s.default)(r,[{key:"renderBase",value:function(){var e=this.props,a=e.detail,r=e.versionName,n=a.home?/^https?:\/\//.test(a.home)?a.home:"http://".concat(a.home):a.home;return E.default.createElement("div",{className:g.default.base},E.default.createElement("div",{className:g.default.title},t("BASIC_INFORMATION")),E.default.createElement("div",{className:g.default.info},E.default.createElement("div",{className:g.default.icon},E.default.createElement(p.default,{src:a.icon,iconLetter:a.name,iconSize:100})),E.default.createElement("div",{className:g.default.words},E.default.createElement("dl",null,E.default.createElement("dd",null,a.name),E.default.createElement("dt",null,t("NAME"))),E.default.createElement("dl",null,E.default.createElement("dd",null,globals.config.showOutSiteLink&&E.default.createElement("a",{href:(0,y.hrefControl)(n),target:"_blank",rel:"noopener noreferrer"},a.home),!a.home&&E.default.createElement("span",null,"-")),E.default.createElement("dt",null,t("SERVICE_PROVIDER_WEBSITE")))),E.default.createElement("div",null,E.default.createElement("dl",null,E.default.createElement("dd",null,r),E.default.createElement("dt",null,t("VERSION"))),E.default.createElement("dl",null,E.default.createElement("dd",null,(0,y.showNameAndAlias)(a.isv,"workspace")),E.default.createElement("dt",null,t("WORKSPACE"))))),E.default.createElement("div",{className:g.default.description},E.default.createElement("dl",null,E.default.createElement("pre",null,a.description||"-"),E.default.createElement("dt",null,t("INTRODUCTION")))),E.default.createElement("div",{className:g.default.title},t("APP_DESCRIPTION")),E.default.createElement("div",null,E.default.createElement(m.default,{source:a.abstraction||t("NONE")})))}},{key:"render",value:function(){return E.default.createElement("div",{className:g.default.main},this.renderBase())}}]),r}(E.default.Component),u.propTypes={detail:v.default.object,versionName:v.default.string},u.defaultProps={detail:{},versionName:""},l=o))||l;a.default=S},function(e,t,a){e.exports={base:"_3RhG54Afc3jTrbfar2yUo0",info:"_2pPSF0uuUVhnDFREH_W1RE",icon:"sN1v3yg2lJsboH2B2H53J",words:"vEULlxo--39bvTHCeQZnd",description:"_1Sv5X8JxKxpsz_-ZoHkVMt",title:"_1PRTS92xyJ2yUX613onuo4",banLink:"VE_ECtfsbM2wxJue7ZAW3"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(932)),p=n(r(2801));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props.readme;return e?i.default.createElement(d.default,{source:e,className:p.default.markdown}):i.default.createElement("p",null,t("NO_DOCUMENT_FOUND"))}}]),r}(i.default.PureComponent);a.default=h,h.propTypes={readme:f.default.string},h.defaultProps={readme:""}},function(e,t,a){e.exports={markdown:"V_-mqFB-1z1gAg3djZCMg"}},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(8),r(9),r(4),r(18),r(30),r(11),r(71),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(141),r(29),r(120),r(8),r(9),r(4),r(18),r(43),r(30),r(11),r(71);var l,u,o,c,s,i=n(r(31)),f=n(r(62)),d=n(r(25)),p=n(r(28)),m=n(r(74)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=(n(r(63)),n(r(45))),g=n(r(0)),b=r(243),S=r(189),_=r(17),O=r(893),C=n(r(5)),T=n(r(503)),R=n(r(838)),D=n(r(2803));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var N=(0,b.observer)((u=function(e){(0,h.default)(r,e);var a=k(r);function r(e){var t;return(0,d.default)(this,r),(t=a.call(this,e)).DEFAULT_PREVIEW_FILE="values.yaml",(0,f.default)(t,"changeMode",o,(0,m.default)(t)),(0,f.default)(t,"changeSelectFile",c,(0,m.default)(t)),(0,f.default)(t,"changePreviewType",s,(0,m.default)(t)),t.handleDownload=function(){var e=t.props.files[t.selectFile];"yaml"===t.mode?t.downloadAsYaml(e):"json"===t.mode&&t.downloadAsJSON(e)},(0,_.extendObservable)((0,m.default)(t),{selectFile:t.defaultSelectFile,mode:"yaml"}),t}return(0,p.default)(r,[{key:"downloadAsJSON",value:function(e){var t=this.selectFile.replace(/yaml$/,"json"),a="";try{a=JSON.stringify(T.default.safeLoad(e),null,2)}catch(e){a=e}this.saveAs(a,t)}},{key:"downloadAsYaml",value:function(e){var t=this.selectFile;this.saveAs(e,t)}},{key:"saveAs",value:function(e,t){var a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,O.saveAs)(a,t)}},{key:"render",value:function(){return this.selectFile?g.default.createElement("div",{className:D.default.wrapper},g.default.createElement("div",{className:D.default.topbar},g.default.createElement("div",{className:D.default.icon},g.default.createElement(S.Icon,{name:"coding",size:20}),g.default.createElement("span",null,t("CHART_FILES"))),this.renderFileSelect()),g.default.createElement("div",{className:D.default.edit},this.renderPreviewToolbar(),this.renderPreviewContent())):g.default.createElement("p",null,t("NO_APP_CHART_FILE_FOUND"))}},{key:"renderFileSelect",value:function(){return g.default.createElement(S.Select,{defaultValue:this.selectFile,onChange:this.changeSelectFile,options:this.fileOptions})}},{key:"renderPreviewToolbar",value:function(){return g.default.createElement("div",{className:D.default.toolbar},g.default.createElement(S.Icon,{className:D.default.download,name:"download",size:20,color:{primary:"#fff"},onClick:this.handleDownload,clickable:!0,changeable:!0}))}},{key:"renderPreviewTypeBtn",value:function(e,t){var a=this;return g.default.createElement("span",{className:(0,C.default)(D.default.preview_btn,(0,i.default)({},D.default.active,this.mode===e)),onClick:function(){return a.changePreviewType(e)}},t)}},{key:"renderPreviewContent",value:function(){return g.default.createElement(R.default,{mode:this.mode,value:this.props.files[this.selectFile],options:{readOnly:!0}})}},{key:"fileOptions",get:function(){var e=this.props.files,t=void 0===e?{}:e;return Object.keys(t).map((function(e){return{label:e,value:e}}))}},{key:"defaultSelectFile",get:function(){var e=this.props.files,t=(void 0===e?{}:e)[this.DEFAULT_PREVIEW_FILE],a=this.fileOptions.length?this.fileOptions[0].value:"";return t?this.DEFAULT_PREVIEW_FILE:a}}]),r}(g.default.Component),(0,y.default)(u.prototype,"fileOptions",[_.computed],Object.getOwnPropertyDescriptor(u.prototype,"fileOptions"),u.prototype),(0,y.default)(u.prototype,"defaultSelectFile",[_.computed],Object.getOwnPropertyDescriptor(u.prototype,"defaultSelectFile"),u.prototype),o=(0,y.default)(u.prototype,"changeMode",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.mode=t}}}),c=(0,y.default)(u.prototype,"changeSelectFile",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectFile=t}}}),s=(0,y.default)(u.prototype,"changePreviewType",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.mode=t}}}),l=u))||l;a.default=N},function(e,t,a){e.exports={wrapper:"C9RBDezZTSZ9wuANVHPsi",topbar:"_1qDSB0O58SB7_GXNCw7_dc",icon:"_3srqZVcOkSMEixaltbPZi7",edit:"_2jL4KvBNHuC4jU_RiiIi4_",toolbar:"_2_GUQMPwxTWMMjXHWFT_Ka",download:"_3jjk2LxhatXGcY7nGnb2Fl",preview_btn:"_20Qa4VKbEwotZP_JgGCEar",active:"_3QE1zwmNIDX4CN7ZNPOTga"}},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(2805));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(r,e);var a=p(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props.description;return i.default.createElement("div",{className:d.default.main},i.default.createElement("div",{className:d.default.title},t("UPDATE_LOG")),i.default.createElement("pre",{className:d.default.updateLog},e||t("NO_UPDATE_LOG_DESC")))}}]),r}(i.default.PureComponent);a.default=m,m.propTypes={description:f.default.string},m.defaultProps={description:""}},function(e,t,a){e.exports={main:"_2u4FA6A7MCUfIFe4Z8dqKO",title:"_1xP27HuPsxtLPGTg0MT-St"}},function(e,t,a){e.exports={body:"_2IouoNUd7iTI3nxkqsDwX7",hideFooter:"_3c8gxa4F0ILHsBRr299LfN",downloadInfo:"_3KDp6pP6cAe17QzOMgHY9_",screenshots:"_2hMAd_6nxqkUS9UaXkSw-a",title:"_1CJO5lsaTds2qNIyfcMs4u",footer:"_3qPgJzENw1ErWJvWwB6Ij6"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(1)),h=r(189),v=l(r(798)),E=l(r(2808));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var g=function(e){(0,i.default)(r,e);var a=y(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleReject=function(){return t.formRef.validate((function(){return t.props.onOk({version_id:t.props.versionId,message:t.state.message})}))},t.changeMessage=function(e){t.setState({message:e})},t.state={message:""},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.visible,n=(0,o.default)(a,["visible"]),l={message:this.state.message};return p.default.createElement(v.default,(0,u.default)({width:600,visible:r},n,{onOk:this.handleReject,footerClassName:E.default.footer}),p.default.createElement(h.Form,{data:l,ref:function(t){e.formRef=t},className:E.default.rejectForm},p.default.createElement(h.Form.Item,{rules:[{required:!0,message:t("REJECT_REASON_TIP")}]},p.default.createElement(h.TextArea,{name:"message",onChange:this.changeMessage}))))}}]),r}(p.Component);a.default=g,g.propTypes={versionId:m.default.string,onOk:m.default.func,onCancel:m.default.func},g.defaultProps={versionId:"",onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={rejectForm:"_2HRp9_fNHxQCirZ1195MMj",footer:"_2lsP4pTvid2tIQnqGzOeDI"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(12),r(109),r(70),r(20),r(14),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(70),r(20),r(29),r(14),r(4),r(18),r(43),r(11),r(73);var u=l(r(317)),o=l(r(31)),c=l(r(50)),s=l(r(25)),i=l(r(28)),f=l(r(41)),d=l(r(42)),p=l(r(37)),m=n(r(0)),h=l(r(1)),v=l(r(5)),E=r(189),y=l(r(811)),g=l(r(798)),b=r(329),S=l(r(2810));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var O=function(e){(0,f.default)(r,e);var a=_(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).changeName=function(e){n.setState({name:e})},n.changeIcon=function(e){n.setState({description:e})},n.nameValidator=function(e,a,r){if(!a)return r();var l=n.props,u=l.detail,o=l.categoryNames;if(a!==u.name&&o.includes(a))return r({message:t("NAME_EXIST_DESC"),field:e.field});r()},n.createOrModify=function(){var e={name:n.state.name,description:n.state.description,locale:"{}"},t=n.props.detail.category_id;t&&(e.category_id=t),n.formRef.validate((function(){n.props.onOk(e)}))},n.onCancel=function(){n.setState({name:"",description:""}),n.props.onCancel()},n.state={name:n.props.detail.name,description:n.props.detail.description},n}return(0,i.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props.detail;(0,y.default)(t,e.detail)||this.setState({name:t.name,description:t.description})}},{key:"render",value:function(){var e=this,a=this.props,r=a.visible,n=(0,c.default)(a,["visible"]),l={name:this.state.name,description:this.state.description};return m.default.createElement(g.default,(0,u.default)({width:600,visible:r,footerClassName:S.default.footer},n,{onOk:this.createOrModify,onCancel:this.onCancel}),m.default.createElement(E.Form,{data:l,ref:function(t){e.formRef=t}},m.default.createElement(E.Form.Item,{label:t("NAME"),desc:t("CATEGORY_NAME_DESC"),rules:[{required:!0,message:t("ENTER_CATEGORY_NAME_TIP")},{validator:this.nameValidator}]},m.default.createElement(E.Input,{name:"name",onChange:this.changeName,maxLength:20})),m.default.createElement(E.Form.Item,{label:t("ICON")},m.default.createElement("div",{name:"description",className:S.default.icons,value:l.description},b.CATEGORY_ICONS.map((function(t){return m.default.createElement("label",{key:t,onClick:function(){return e.changeIcon(t)},className:(0,v.default)((0,o.default)({},S.default.active,t===l.description))},m.default.createElement(E.Icon,{name:t,size:20}))}))))))}}]),r}(m.Component);a.default=O,O.propTypes={detail:h.default.object,categoryNames:h.default.array,onOk:h.default.func,onCancel:h.default.func},O.defaultProps={detail:{},categoryNames:[],onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={footer:"_2Qp-Oq8oA7HhDGSXylc-1b",icons:"XKu-mU-Dz1wbD5ksgEs7z",active:"_3i5IWpdoNOUzlLf-hGhkbI"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(14),r(138),r(4),r(18),r(30),r(11),r(71),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(14),r(138),r(4),r(18),r(43),r(30),r(11),r(71);var u=l(r(58)),o=l(r(317)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(1)),h=r(189),v=l(r(798)),E=l(r(2812));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var g=function(e){(0,i.default)(r,e);var a=y(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleChange=function(e){t.setState({categoryId:e})},t.adjustCategory=function(){t.props.onOk({category_id:t.state.categoryId})},t.onCancel=function(){t.setState({categoryId:""}),t.props.onCancel()},t.state={categoryId:t.props.categoryId},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this,a=Object.assign({},this.props),r={category_id:this.state.categoryId};return p.default.createElement(v.default,(0,o.default)({width:600,footerClassName:E.default.footer},a,{onOk:this.adjustCategory,onCancel:this.onCancel}),p.default.createElement(h.Form,{className:E.default.form,data:r,ref:function(t){e.formRef=t}},p.default.createElement(h.Form.Item,{label:t("CHANGE_CATEGORY"),desc:t("CHANGE_CATEGORY_DESC")},p.default.createElement(h.Select,{name:"category_id",options:this.categories,value:this.state.categoryId,onChange:this.handleChange}))))}},{key:"categories",get:function(){return(0,u.default)(this.props.categories.map((function(e){var a=e.name,r=e.category_id;return{label:t("APP_CATE_".concat(a.toUpperCase().replace(/[^A-Z]+/g,"_")),{defaultValue:a}),value:r}})))}}]),r}(p.Component);a.default=g,g.propTypes={categories:m.default.array,categoryId:m.default.string,onOk:m.default.func,onCancel:m.default.func},g.defaultProps={categories:[],categoryId:"",onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={footer:"_2TvTf_D-_JM0vtni7wgWQZ",form:"_3wLMP_UWlRBwrQYi452Fek"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(10),r(138),r(4),r(18),r(30),r(11),r(71),r(79),r(817),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(138),r(4),r(440),r(321),r(21),r(18),r(43),r(30),r(11),r(71),r(79),r(817);var u=l(r(317)),o=l(r(38));r(35);var c=l(r(39)),s=l(r(25)),i=l(r(28)),f=l(r(41)),d=l(r(42)),p=l(r(37)),m=n(r(0)),h=l(r(1)),v=l(r(26)),E=l(r(119)),y=r(189),g=l(r(894)),b=l(r(798)),S=l(r(918)),_=r(815);function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var C=function(e){(0,f.default)(r,e);var a=O(r);function r(e){var n;(0,s.default)(this,r),(n=a.call(this,e)).getSliderMax=function(e){return e?(0,v.default)(n.valueSchema,"properties.".concat(e,".properties.volume.sliderMax"),2048):(0,v.default)(n.valueSchema,"properties.volume.sliderMax",2048)},n.onChange=function(e){var a=(0,_.validateStorage)(e,{app_id:n.props.app_id,nodeRole:n.state.nodeRole,max:n.max,oldStorage:n.oldStorage}).message,r=void 0===a?"":a,l=parseFloat(e);l<parseFloat(n.oldStorage)&&(r=t("CANNOT_REDUCE_VOLUME_SIZE")),e&&l>0&&e.trim().startsWith("0")?n.setState({storage:e.replace(/^0*/,""),errorMessage:r}):n.setState({storage:e,errorMessage:r})},n.onRoleChange=function(e){var t=n.props.storages,a=(void 0===t?{}:t)[e]||{};n.oldStorage=a,n.max="zookeeper"===e?100:2048,n.setState({nodeRole:e,storage:a});var r=n.getSliderMax(e);n.max=r},n.onOk=(0,c.default)(o.default.mark((function e(){var t,a,r,l,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.errorMessage){e.next=2;break}return e.abrupt("return");case 2:return t=n.props,a=t.workspace,r=t.namespace,l=t.cluster,u=t.cluster_id,e.next=5,n.props.store.updateStorage({workspace:a,namespace:r,cluster:l,cluster_id:u,storage:n.state.storage,nodeRole:n.state.nodeRole});case 5:n.props.onOk();case 6:case"end":return e.stop()}}),e)}))),n.onCancel=function(){n.setState({categoryId:""}),n.props.onCancel()},n.generateMarks=function(){for(var e=parseInt((n.max-n.min)/4,10),t={},a=0;a<4;a++){var r=n.min+a*e;t[r]=0===r?r:r+"Gi"}return t[n.max]=n.max+"Gi",t};var l=e.storage,u=e.storages,i=e.nodes,f=e.app_id;n.valueSchema=(0,E.default)(_.ValuesSchema[f]),n.roleOptions=(0,_.getNodeRoleOptions)(f,"storage").filter((function(e){var t=e.value;return!i||i[t]>0}));var d=(0,v.default)(n.roleOptions,"[0].value");return n.state={nodeRole:d,storage:u?u[d]:l,errorMessage:""},n.min=1,n.max=u?n.getSliderMax(d):n.getSliderMax(),n.oldStorage=n.state.storage,n}return(0,i.default)(r,[{key:"render",value:function(){var e=this,a=Object.assign({},this.props),r=this.state,n=r.storage,l=r.errorMessage,o=r.nodeRole,c={storage:n},s=l?{message:l}:null;return m.default.createElement(b.default,(0,u.default)({width:600,footerClassName:S.default.footer},a,{onOk:this.onOk,onCancel:this.onCancel}),m.default.createElement(y.Alert,{className:S.default.alert,type:"warning",message:t("DATABASE_OPERATION_WARNING")}),m.default.createElement(y.Form,{className:S.default.form,data:c,ref:function(t){e.formRef=t}},o&&m.default.createElement(y.Form.Item,{label:t("NODE_ROLE")},m.default.createElement(y.Select,{name:"nodeRole",value:o,defaultValue:o,options:this.roleOptions,onChange:this.onRoleChange})),m.default.createElement(y.Form.Item,{label:t("VOLUME"),error:s},m.default.createElement(g.default,{max:this.max,marks:this.generateMarks(),value:this.state.storage,unit:"Gi",onChange:this.onChange,withInput:!0}))))}}]),r}(m.Component);a.default=C,C.propTypes={storage:h.default.string,onOk:h.default.func,onCancel:h.default.func},C.defaultProps={storage:"10Gi",onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(109),r(3),r(10),r(6),r(70),r(20),r(138),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(71),r(79),r(817),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(440),r(21),r(18),r(43),r(30),r(11),r(73),r(71),r(79),r(817),r(7);var u=l(r(317)),o=l(r(31)),c=l(r(38));r(35);var s=l(r(39)),i=l(r(25)),f=l(r(28)),d=l(r(41)),p=l(r(42)),m=l(r(37)),h=n(r(0)),v=l(r(1)),E=r(189),y=l(r(26)),g=l(r(894)),b=l(r(798)),S=l(r(1065)),_=l(r(918)),O=r(815);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var D=function(e){(0,d.default)(r,e);var a=R(r);function r(e){var n;(0,i.default)(this,r),(n=a.call(this,e)).handleChange=function(e){var a="";n.oldShardsCount>e&&![O.RadonDBAppId.MySQL,O.RadonDBAppId.PostgreSQL,O.RadonDBAppId.RedisCluster,O.RadonDBAppId.RedisSentinel,O.RadonDBAppId.MongoDB,O.RadonDBAppId.Elasticsearch,O.RadonDBAppId.OpenSearch].includes(n.props.app_id)&&(a=t("CANNOT_REDUCE_DATABASE_NODES")),""===e&&(a=t("ENTER_POSITIVE_INTEGER_DESC")),n.setState({shardsCount:e,errorMessage:a})},n.onOk=(0,s.default)(c.default.mark((function e(){var t,a,r,l,u,o,s,i,f,d,p;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,a=t.workspace,r=t.namespace,l=t.cluster,u=t.cluster_id,o=n.state,s=o.specifications,i=o.nodeRole,f=o.errorMessage,d=o.storageErrorMessage,p=o.storage,!f&&!d){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,n.props.store.updateShardsCount({workspace:a,namespace:r,cluster:l,cluster_id:u,shardsCount:n.state.shardsCount,nodeRole:i,specifications:s,storage:p});case 6:n.props.onOk(n.oldShardsCount>n.state.shardsCount);case 7:case"end":return e.stop()}}),e)}))),n.onCancel=function(){n.props.onCancel()},n.onRoleChange=function(e){var t=n.props,a=t.nodes,r=void 0===a?{}:a,l=t.specificationsObject,u=void 0===l?{}:l,o=t.storages,c=void 0===o?{}:o,s=t.app_id;switch(n.oldShardsCount=r[e],s){case O.RadonDBAppId.Elasticsearch:n.input.range="kibana"===e?{min:0,max:8}:{min:0===n.oldShardsCount?n.oldShardsCount:1,max:200};break;case O.RadonDBAppId.RedisCluster:n.input.range="proxy"===e?{min:0,max:50}:{min:3,max:50};break;case O.RadonDBAppId.Kafka:n.input="zookeeper"===e?{type:"select",title:"NODE_COUNT",description:" ",options:[1,3,5,7,9].map((function(e){return{label:e,value:e}}))}:{type:"integer",title:"NODE_COUNT",range:{min:1,max:100},showFunc:!0};break;case O.RadonDBAppId.OpenSearch:n.input.range="dashboard"===e?{min:0,max:8}:"logstash"===e?{min:0,max:10}:{min:0===n.oldShardsCount?n.oldShardsCount:1,max:200}}var i=u[e]||{},f=i.cpu,d=i.memory;n.setSpecificationsOptions(e);var p=c[e]||{};n.setState({nodeRole:e,shardsCount:r[e],specifications:"".concat(f,", ").concat(d),storage:p,errorMessage:""})},n.onSpecificationsChange=function(e){n.setState({specifications:e})},n.onStorageChange=function(e){var t=(0,O.validateStorage)(e,{app_id:n.props.app_id}).message,a=void 0===t?"":t,r=parseFloat(e);e&&r>0&&e.trim().startsWith("0")?n.setState({storage:e.replace(/^0*/,""),storageErrorMessage:a}):n.setState({storage:e,storageErrorMessage:a})};var l=e.shardsCount,u=e.nodes,o=e.specificationsObject,f=e.storages,d=e.storage,p=e.app_id;n.roleOptions=(0,O.getNodeRoleOptions)(p,"node").map((function(e){return T(T({},e),{},{disabled:void 0===(0,y.default)(u,e.value)})}));var m=(0,y.default)(n.roleOptions,"[0].value",""),h=(o||{})[m]||{},v=h.cpu,E=h.memory;switch(n.state={shardsCount:u?u[m]:l,specifications:"".concat(v||n.props.cpu,", ").concat(E||n.props.memory),storage:f?f[m]:d,nodeRole:m,errorMessage:"",storageErrorMessage:""},p){case O.RadonDBAppId.ClickHouse:n.input={type:"integer",title:"SHARD_COUNT",description:"SHARDS_DESC",range:{min:1,max:100},showFunc:!0};break;case O.RadonDBAppId.MySQL:n.input={type:"select",title:"NODE_COUNT",description:"MYSQL_NODES_DESC",options:[2,3,5].map((function(e){return{label:e,value:e}}))};break;case O.RadonDBAppId.PostgreSQL:n.input={type:"integer",title:"DATA_NODE_COUNT",range:{min:2,max:8},showFunc:!0};break;case O.RadonDBAppId.RedisCluster:n.input={type:"integer",title:"NODE_COUNT",range:{min:3,max:50},showFunc:!0};break;case O.RadonDBAppId.RedisSentinel:n.input={type:"select",title:"NODE_COUNT",description:"REDIS_SENTINEL_NODES_DESC",options:[3,5,7].map((function(e){return{label:e,value:e}}))};break;case O.RadonDBAppId.MongoDB:n.input={type:"select",title:"NODE_COUNT",description:"MONGODB_NODES_DESC",options:[1,3,5,7].map((function(e){return{label:e,value:e}}))};break;case O.RadonDBAppId.Elasticsearch:n.input={type:"integer",title:"NODE_COUNT",range:{min:0===n.oldShardsCount?n.oldShardsCount:1,max:200},showFunc:!0};break;case O.RadonDBAppId.Kafka:n.input={type:"integer",title:"NODE_COUNT",range:{min:3,max:100},showFunc:!0};break;case O.RadonDBAppId.OpenSearch:n.input={type:"integer",title:"NODE_COUNT",range:{min:0===n.oldShardsCount?n.oldShardsCount:1,max:200},showFunc:!0};break;default:n.input={range:{}}}return n.setSpecificationsOptions(m),n.oldShardsCount=n.state.shardsCount,n}return(0,f.default)(r,[{key:"setSpecificationsOptions",value:function(e){this.specificationsOptions=this.props.specificationsObject?O.SpecificationOptionsObject[this.props.app_id][e]:O.SpecificationOptionsObject[this.props.app_id]||O.SpecificationsOptions}},{key:"render",value:function(){var e=Object.assign({},this.props),a=this.input,r=a.description,n=a.type,l=a.title,o=a.options,c=a.range,s=a.showFunc,i=this.state,f=i.errorMessage,d=i.nodeRole,p=i.shardsCount,m=i.storageErrorMessage,v=f?{message:f}:null,y=m?{message:m}:null,O=0===this.oldShardsCount&&0!==this.state.shardsCount,C=O&&!["kibana","proxy","dashboard","logstash"].includes(d);return h.default.createElement(b.default,(0,u.default)({width:600,footerClassName:_.default.footer},e,{onOk:this.onOk,onCancel:this.onCancel}),h.default.createElement(E.Alert,{className:_.default.alert,type:"warning",message:t("DATABASE_OPERATION_WARNING")}),h.default.createElement(E.Form,{className:_.default.form},d&&h.default.createElement(E.Form.Item,{label:t("NODE_ROLE")},h.default.createElement(E.Select,{name:"nodeRole",value:d,defaultValue:d,options:this.roleOptions,onChange:this.onRoleChange})),h.default.createElement(E.Form.Item,{label:t(l),desc:r?t(r):t("NODE_COUNT_DESC",{min:c.min,max:c.max}),error:v},"select"===n?h.default.createElement(E.Select,{value:p,defaultValue:p,onChange:this.handleChange,options:o.map((function(e){return T(T({},e),{},{label:"number"==typeof e.label?e.label:t(e.label)})}))}):h.default.createElement(S.default,{value:p,onChange:this.handleChange,min:c.min,max:c.max,showFunc:s,integer:!0})),O&&h.default.createElement(E.Form.Item,{label:t("RESOURCES"),desc:t("RESOURCES_DESC")},h.default.createElement(E.Select,{name:"specifications",value:this.state.specifications,defaultValue:this.state.specifications,options:this.specificationsOptions,onChange:this.onSpecificationsChange})),C&&h.default.createElement(E.Form.Item,{label:t("VOLUME"),error:y},h.default.createElement(g.default,{max:2048,marks:{0:"0",512:"512 Gi",1024:"1024 Gi",1536:"1536 Gi",2048:"2048 Gi"},value:this.state.storage,unit:"Gi",onChange:this.onStorageChange,withInput:!0}))))}}]),r}(h.Component);a.default=D,D.propTypes={specificationsObject:v.default.object,shardsCount:v.default.number,onOk:v.default.func,onCancel:v.default.func,app_id:v.default.string},D.defaultProps={shardsCount:1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={withUnit:"_3MkVmyFjamQAHbMfqPEKDP",funcContainer:"_ptAO3HqFm-oaIp8hrkii",func:"_2Z8YdS1HCE46ycS48Ju1fF"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(3),r(10),r(6),r(20),r(138),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(440),r(21),r(18),r(43),r(11),r(7);var u=l(r(317)),o=l(r(31)),c=l(r(38));r(35);var s=l(r(39)),i=l(r(25)),f=l(r(28)),d=l(r(41)),p=l(r(42)),m=l(r(37)),h=n(r(0)),v=l(r(1)),E=r(189),y=l(r(26)),g=l(r(798)),b=l(r(918)),S=r(815);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var T=function(e){(0,d.default)(r,e);var a=C(r);function r(e){var t;(0,i.default)(this,r),(t=a.call(this,e)).onChange=function(e){t.setState({specifications:e})},t.onRoleChange=function(e){var a=t.props.specificationsObject,r=(void 0===a?{}:a)[e]||{},n=r.cpu,l=r.memory;t.setSpecificationsOptions(e),t.setState({nodeRole:e,specifications:"".concat(n,", ").concat(l)})},t.onOk=(0,s.default)(c.default.mark((function e(){var a,r,n,l,u;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props,r=a.workspace,n=a.namespace,l=a.cluster,u=a.cluster_id,e.next=3,t.props.store.updateSpecifications({workspace:r,namespace:n,cluster:l,cluster_id:u,specifications:t.state.specifications,nodeRole:t.state.nodeRole});case 3:t.props.onOk(t.state.specifications);case 4:case"end":return e.stop()}}),e)}))),t.onCancel=function(){t.props.onCancel()};var n=e.specificationsObject,l=void 0===n?{}:n,u=e.nodes,o=e.app_id;t.roleOptions=(0,S.getNodeRoleOptions)(o,"specifications").filter((function(e){var t=e.value;return!u||u[t]>0}));var f=(0,y.default)(t.roleOptions,"[0].value",""),d=l[f]||{},p=d.cpu,m=d.memory;return t.state={specifications:"".concat(p||e.cpu,", ").concat(m||e.memory),nodeRole:f},t.setSpecificationsOptions(f),t}return(0,f.default)(r,[{key:"setSpecificationsOptions",value:function(e){var t=this,a=this.props.app_id;this.specificationsOptions=this.props.specificationsObject?S.SpecificationOptionsObject[a][e]:S.SpecificationOptionsObject[a]||S.SpecificationsOptions,a!==S.RadonDBAppId.RedisCluster&&a!==S.RadonDBAppId.RedisSentinel||(this.specificationsOptions=this.specificationsOptions.map((function(a){var r=(0,S.getCpuAndMemoryFromSpecifications)(a.value),n=r.cpu,l=r.memory,u=(0,y.default)(t.props,'specificationsObject["'.concat(e,'"]'),t.props);return O(O({},a),{},{disabled:parseFloat(n)<parseFloat(u.cpu)||parseFloat(l)<parseFloat(u.memory)})})))}},{key:"render",value:function(){var e=this,a=Object.assign({},this.props);return h.default.createElement(g.default,(0,u.default)({width:600,footerClassName:b.default.footer},a,{onOk:this.onOk,onCancel:this.onCancel}),h.default.createElement(E.Alert,{className:b.default.alert,type:"warning",message:t("DATABASE_OPERATION_WARNING")}),h.default.createElement(E.Form,{className:b.default.form,ref:function(t){e.formRef=t}},this.state.nodeRole&&h.default.createElement(E.Form.Item,{label:t("NODE_ROLE")},h.default.createElement(E.Select,{name:"nodeRole",value:this.state.nodeRole,defaultValue:this.state.nodeRole,options:this.roleOptions,onChange:this.onRoleChange})),h.default.createElement(E.Form.Item,{label:t("RESOURCES"),desc:t("RESOURCES_DESC")},h.default.createElement(E.Select,{name:"specifications",value:this.state.specifications,defaultValue:this.state.specifications,options:this.specificationsOptions,onChange:this.onChange}))))}}]),r}(h.Component);a.default=T,T.propTypes={specificationsObject:v.default.object,onOk:v.default.func,onCancel:v.default.func,app_id:v.default.string},T.defaultProps={onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(109),r(3),r(10),r(44),r(6),r(70),r(20),r(194),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(44),r(6),r(70),r(20),r(27),r(194),r(141),r(29),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(73),r(7),r(110);var u=l(r(317)),o=l(r(50)),c=l(r(58)),s=l(r(38));r(35);var i=l(r(39)),f=l(r(31)),d=l(r(25)),p=l(r(28)),m=l(r(41)),h=l(r(42)),v=l(r(37)),E=n(r(0)),y=r(17),g=l(r(119)),b=l(r(26)),S=l(r(68)),_=l(r(196)),O=l(r(1)),C=r(189),T=l(r(191)),R=l(r(899)),D=l(r(798)),k=l(r(918)),N=r(815),I=l(r(2818)),P=l(r(2820)),A=r(1126);function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,f.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var x=function(e){(0,m.default)(r,e);var a=M(r);function r(e){var n;(0,d.default)(this,r),(n=a.call(this,e)).formRef=E.default.createRef(),n.passwordRef=E.default.createRef(),n.checkDatabase=function(e,t,a){var r=a||n.state.detail;return"permission"===e&&"Advanced"===t&&"*"!==r.database&&(r.database="*",n.setState({detail:L({},r)})),"authentication"===e&&n.setState({showAuthenticationAlert:n.props.authentication!==t}),r},n.getEmptyResourceNameRuleIndexes=function(e){return(e||n.state.detail.permissionRules||[]).map((function(e,t){return"cluster"===(0,b.default)(e,"resource.type")||(0,b.default)(e,"resource.name")?-1:t})).filter((function(e){return e>-1}))},n.onOk=function(){var e=n.props,a=e.action,r=e.detail,l=n.checkDatabase("permission",n.state.detail.permission,L({},n.state.detail));n.formRef.current.validate((0,i.default)(s.default.mark((function e(){var u;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=15;break}if(e.prev=1,u=n.getEmptyResourceNameRuleIndexes(),n.setState({emptyResourceNameRuleIndexes:u}),!(u.length>0)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,a(L(L({},n.props),{},{user:l,oldUser:r}));case 8:e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(1),e.t0.message&&T.default.error({content:"".concat(t(e.t0.message))}),n.props.onCancel(),e.abrupt("return");case 15:n.props.onOk();case 16:case"end":return e.stop()}}),e,null,[[1,10]])}))))},n.customNameValidator=function(e,t){return n.props.nameReplicationValidator(t,(0,b.default)(n.props,"detail.name"))},n.getFormItems=function(e){return e.map((function(e){var a=e.name,r=e.type,l=e.label,u=e.description,o=e.rules,s=void 0===o?[]:o,i=e.options,f=e.range,d=e.disabled,p="name"===a?[].concat((0,c.default)(s),[{required:!0,validator:n.customNameValidator,message:t("USERNAME_EXISTS")}]):s;switch(r){case"text":return E.default.createElement(C.Form.Item,{key:a,label:t(l),desc:t(u),rules:p||[]},E.default.createElement(C.Input,{name:a,maxLength:f&&f.max?f.max:-1,disabled:d}));case"password":return E.default.createElement(C.Form.Item,{key:a,label:t(l),desc:t(u),rules:p||[]},E.default.createElement(C.InputPassword,{name:a,innerRef:n.passwordRef,maxLength:f&&f.max?f.max:-1,disabled:d}));case"textArea":return E.default.createElement(C.Form.Item,{key:a,label:t(l),desc:t(u),rules:p},E.default.createElement(C.TextArea,{maxLength:256,name:a,disabled:d}));case"select":return E.default.createElement(C.Form.Item,{key:a,label:t(l),desc:t(u),rules:p},E.default.createElement(C.Select,{disabled:d,name:a,options:i}));default:return null}}))},n.onPermissionRuleChange=function(e,t){if(t){var a=n.state.detail.permissionRules;(0,S.default)(a,t,e)}},n.onKafkaUserConfigChange=function(e,t){if(t){var a=n.state.detail.kafkaUserConfig;""===e?(0,_.default)(a,t):(0,S.default)(a,t,e)}},n.addPermissionRule=function(){var e=n.state.detail.permissionRules||[];n.setState({detail:L(L({},n.state.detail),{},{permissionRules:[].concat((0,c.default)(e),[JSON.parse(A.DefaultPermissionRuleString)])})})},n.deletePermissionRule=function(e){var t=n.state.detail.permissionRules||[];t.splice(e-1,1);var a=n.getEmptyResourceNameRuleIndexes(t);n.setState({detail:L({},n.state.detail),emptyResourceNameRuleIndexes:a})};var l=[N.RadonDBAppId.RedisCluster,N.RadonDBAppId.RedisSentinel].includes(e.app_id);return n.state={detail:(0,g.default)((0,y.toJS)(e.detail))||{name:"",password:"",network:"::/0",database:"*",permission:l?"~* &* +@all":"General",host:"%",authentication:"tls",authorization:"simple",permissionRules:e.app_id===N.RadonDBAppId.Kafka?[JSON.parse(A.DefaultPermissionRuleString)]:[],kafkaUserConfig:(e.app_id,N.RadonDBAppId.Kafka,{})},emptyResourceNameRuleIndexes:[],showAuthenticationAlert:e.authentication&&e.authentication!==(0,b.default)(e,"detail.authentication","tls")},n}return(0,p.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.timer=setTimeout((function(){var t=e.passwordRef.current;t&&(t.value=(0,b.default)(e.props,"detail.password",""))}),200)}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"renderOtherItems",value:function(e){var a=this;if(e===N.RadonDBAppId.Kafka){var r=this.state.detail,n=r.permissionRules,l=void 0===n?[]:n,u=r.kafkaUserConfig,o=void 0===u?{}:u;return E.default.createElement("div",null,E.default.createElement("div",{className:k.default.otherItems,key:"PermissionRule"},l.map((function(e,t){return E.default.createElement(I.default,{key:"".concat(JSON.stringify(e)).concat(t),permissionRule:e,index:t+1,isEmptyError:a.state.emptyResourceNameRuleIndexes.includes(t),onChange:a.onPermissionRuleChange,canDelete:l.length>1,onDelete:a.deletePermissionRule})})),E.default.createElement("div",{className:k.default.addRuleRow},E.default.createElement("div",null,E.default.createElement(C.Icon,{name:"information",size:16}),E.default.createElement("span",null,t("PERMISSION_RULE_DESC"))),E.default.createElement(C.Button,{onClick:this.addPermissionRule},t("ADD")))),E.default.createElement(R.default,null,E.default.createElement(P.default,{kafkaUserConfig:o,onChange:this.onKafkaUserConfigChange})))}return null}},{key:"render",value:function(){var e=this.props,a=e.app_id,r=e.authentication,n=void 0===r?"":r,l=(0,o.default)(e,["app_id","authentication"]),c=[A.UserName,A.Password];switch(a){case N.RadonDBAppId.ClickHouse:c=A.CKAccount;break;case N.RadonDBAppId.PostgreSQL:c=(0,A.getPGAccount)(!!this.props.detail);break;case N.RadonDBAppId.MySQL:c=A.MySQLAccount;break;case N.RadonDBAppId.RedisCluster:case N.RadonDBAppId.RedisSentinel:c.push({name:"permission",label:"PERMISSIONS",type:"text",description:"ACL_DESC"});break;case N.RadonDBAppId.Kafka:c=A.KafkaAccount}if(this.props.detail){var s=(c=(0,g.default)(c)).find((function(e){return"name"===e.name}));s&&(s.disabled=!0)}return E.default.createElement(D.default,(0,u.default)({width:610,footerClassName:k.default.footer},l,{onOk:this.onOk}),this.state.showAuthenticationAlert&&E.default.createElement(C.Alert,{className:k.default.alert,type:"warning",message:t("AUTHENTICATION_MODE_INCORRECT_ALERT",{cluster:n.toUpperCase(),user:this.state.detail.authentication.toUpperCase()})}),E.default.createElement(C.Form,{className:k.default.form,data:this.state.detail,ref:this.formRef,onChange:this.checkDatabase},this.getFormItems(c),this.renderOtherItems(a)))}}]),r}(E.Component);a.default=x,x.propTypes={detail:O.default.object,onOk:O.default.func,onCancel:O.default.func},x.defaultProps={onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(31)),u=n(r(246)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37));r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(141),r(29),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var d=n(r(0)),p=n(r(26)),m=n(r(68)),h=n(r(5)),v=r(189),E=n(r(2819));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=["Read","Write","Delete","Alter","Describe","All","IdempotentWrite","ClusterAction","Create","AlterConfigs","DescribeConfigs"].map((function(e){return{label:e,value:e}})),S=function(e){(0,s.default)(r,e);var a=g(r);function r(e){var n;return(0,o.default)(this,r),(n=a.call(this,e)).handleDetele=function(){n.props.onDelete(n.props.index)},n.onChange=function(e){return function(t){var a=n.props,r=a.index,o=void 0===r?1:r,c=a.onChange;"object"===(0,u.default)(t)&&(t=t.target.value),(0,m.default)(n.state.permissionRule,e,t),n.setState(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n.state.permissionRule)),c(t,"[".concat(o-1,"]").concat(e))}},n.renderModeTip=function(){return d.default.createElement("div",null,d.default.createElement("div",null,t("PREFIX_DESC")),d.default.createElement("div",null,t("LITERAL_DESC")))},n.state={permissionRule:JSON.parse(JSON.stringify(e.permissionRule))},n}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.index,r=void 0===a?1:a,n=e.canDelete,l=e.isEmptyError,u=this.state.permissionRule,o="cluster"===(0,p.default)(u,"resource.type"),c=""===(0,p.default)(u,"resource.name"),s=!o&&c&&l;return d.default.createElement("div",{className:E.default.cardContainer},d.default.createElement("div",{className:E.default.cardHeader},d.default.createElement("div",null,t("PERMISSION_RULE")," ",r),n&&d.default.createElement(v.Icon,{className:E.default.delete,onClick:this.handleDetele,name:"trash",size:16})),d.default.createElement("div",{className:E.default.cardRow},d.default.createElement("div",{className:E.default.inputItem},d.default.createElement("div",null,t("RESOURCE_TYPE")),d.default.createElement(v.Select,{value:(0,p.default)(u,"resource.type"),onChange:this.onChange("resource.type"),options:[{label:t("TOPIC"),value:"topic"},{label:t("GROUP"),value:"group"},{label:t("CLUSTER"),value:"cluster"},{label:t("TRANSACTION_ID"),value:"transactionalId"}]}),d.default.createElement("div",{className:E.default.desc},t("RESOURCE_TYPE_DESC"))),d.default.createElement("div",{className:E.default.inputItem},d.default.createElement("div",null,t("RESOURCE_MATCHING_MODE"),d.default.createElement(v.Tooltip,{content:this.renderModeTip()},d.default.createElement(v.Icon,{name:"question",size:16,className:"margin-l6"}))),d.default.createElement(v.Select,{value:(0,p.default)(u,"resource.patternType"),onChange:this.onChange("resource.patternType"),options:[{label:t("PREFIX"),value:"prefix"},{label:t("LITERAL"),value:"literal"}],disabled:o}),d.default.createElement("div",{className:E.default.desc},t("RESOURCE_MATCHING_MODE_DESC"))),d.default.createElement("div",{className:(0,h.default)(E.default.inputItem,E.default.wide,{"form-item":s,"error-item":s})},d.default.createElement("div",null,t("RESOURCE_NAME")),d.default.createElement(v.Input,{defaultValue:(0,p.default)(u,"resource.name"),onChange:this.onChange("resource.name"),disabled:o,maxLength:1e3,placeholder:" "}),d.default.createElement("div",{className:E.default.desc},t("")),s&&d.default.createElement("div",{className:"form-item-error"},t("KAFKA_USER_RESOURCE_NAME_EMPTY_ERROR")))),d.default.createElement("div",{className:E.default.cardRow},d.default.createElement("div",{className:E.default.inputItem},d.default.createElement("div",null,t("OPERATION")),d.default.createElement(v.Select,{value:(0,p.default)(u,"operation"),onChange:this.onChange("operation"),options:b}),d.default.createElement("div",{className:E.default.desc},t("OPERATION_DESC"))),d.default.createElement("div",{className:E.default.inputItem},d.default.createElement("div",null,t("TYPE")),d.default.createElement(v.Select,{value:(0,p.default)(u,"type"),onChange:this.onChange("type"),options:[{label:t("ALLOW"),value:"allow"}],disabled:!0}),d.default.createElement("div",{className:E.default.desc},t("RULE_TYPE_DESC")))))}}]),r}(d.default.Component);a.default=S},function(e,t,a){e.exports={cardContainer:"_1A0ZzaFXe0rRkSIT_gpKJ4",cardHeader:"_2dF0B0snhoVr7iw3jASRyk",delete:"_2Um9MHt5tpHKT_Nq7dvpHp",cardRow:"_2my6m4oEFPGfbrKAVIE63t",inputItem:"_1bUd16IKIt35JoTshl1iPk",desc:"_3owrxQsOb3muWi0cGMoJWu",wide:"_3JHn1sebkO15-qnvoTd9tz"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(246)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=r(189),m=n(r(805)),h=n(r(26)),v=n(r(68));function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=function(e){(0,s.default)(r,e);var a=y(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).onChange=function(e){return function(a){var r=t.props.onChange;"object"===(0,u.default)(a)&&(a=a.target.value),(0,v.default)(t.state.kafkaUserConfig,e,a),t.setState(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t.state.kafkaUserConfig)),r(a,e)}},t.state={kafkaUserConfig:e.kafkaUserConfig},t}return(0,c.default)(r,[{key:"render",value:function(){var e=this,t=this.state.kafkaUserConfig;return this.config.map((function(a){return d.default.createElement(p.Form.Item,{label:a.name,desc:a.desc,key:a.name},d.default.createElement(m.default,{defaultValue:(0,h.default)(t,a.name),onChange:e.onChange(a.name),placeholder:" ",integer:!0,min:a.min,max:a.max}))}))}},{key:"config",get:function(){return[{name:"producerByteRate",min:0,max:2147483647,desc:t("DBPARAM_PRODUCER_BYTERATE_DESC",{min:0,max:2147483647})},{name:"consumerByteRate",min:0,max:2147483647,desc:t("DBPARAM_CONSUMER_BYTERATE_DESC",{min:0,max:2147483647})},{name:"requestPercentage",min:0,max:100,desc:t("DBPARAM_REAUSET_PERCENTAGE_DESC",{min:0,max:100})},{name:"controllerMutationRate",min:0,max:2147483647,desc:t("DBPARAM_CONTROLLER_MUTATION_DESC",{min:0,max:2147483647})}]}}]),r}(d.default.Component);a.default=g},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).handleOk=function(t){(0,e.props.onOk)(t)},e}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.detail,r=e.visible,n=e.isSubmitting,l=e.onCancel;return i.default.createElement(p.default.Form,{data:a,width:691,title:t("EDIT_INFORMATION"),icon:"pen",onOk:this.handleOk,okText:t("OK"),onCancel:l,visible:r,isSubmitting:n},i.default.createElement(d.Form.Item,{label:t("NAME"),desc:t("CLUSTER_NAME_DESC")},i.default.createElement(d.Input,{name:"name",disabled:!0})),i.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},i.default.createElement(d.TextArea,{maxLength:256,name:"description"})))}}]),r}(i.default.Component);a.default=h,h.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},h.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,t,a){e.exports={modal:"uCpjMDHerDwIah6qfWz9h",header:"_8lnL68RyqZ8Mf9SZb7Hrd",description:"_33_m7zffZwxc_WSXhaDLod",title:"_1RCLSA0CgpowJeAz2EvXQd",close:"_3b-UjX6y3xFVR7jYPyBDQE",body:"_2RmBWnxQTqO-v5_7aoCgAc",hideFooter:"_19r6Epwcx_6rYUzr7-lTOk",footer:"_2VxqjGKUCqjewkc5qwInwk",formFooter:"l6hFXqhvTTUulkgDi7kbg",formBody:"_3stxqSfgjAuUqDRJxt4317",formWrapper:"_3KZJuiPCVxqGEbnqGR-4Dk",fullscreen:"_1A5dMkmDhaACu6DAJ7ZbL5",rightScreen:"GUyZ7UV2FZGD28gs3w7W5",image:"_1eulCwUt1yUJJF8dAZdtkb",iconBg:"_1mtvZOIPGtBjUPmBpKWC7l"}},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(6),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(50)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(1456)),v=n(r(826)),E=n(r(26)),y=r(56),g=n(r(2824)),b=r(189),S=n(r(1186)),_=n(r(2832)),O=n(r(2837)),C=n(r(2847));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var k=function(e){(0,i.default)(r,e);var a=D(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).appStore=new g.default,e.state={step:{count:1,hideFooter:!0}},e.showDeploy=function(){e.setState({step:{count:2,hideFooter:!1,okText:t("NEXT"),onOk:e.showDeployNext}})},e.showDeployNext=function(){e.setState({step:R(R({},e.state.step),{},{count:3,onFormOk:function(){return e.setState({step:R(R({},e.state.step),{},{okText:t("INSTALL"),onOk:e.handleDeploy,onPrev:e.showDeploy,next:null})})},next:3===e.state.step.count})})},e.handleDeploy=function(){e.setState({step:{count:4,hideFooter:!1,okText:t("INSTALL"),onOk:e.handleDeploy,onPrev:e.showDeploy,next:{}}})},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.appStore.fetchDetail({app_id:this.props.detail.app_id}).then((function(){return e.forceUpdate()}))}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,r=(e.onDeploy,e.detail),n=(0,u.default)(e,["visible","onCancel","onDeploy","detail"]),o=r.name,c=r.icon,s=(0,E.default)(globals.user,"lang")||(0,y.getBrowserLang)(),i=(0,E.default)(r,"description_".concat(s),r.description),f=this.state.step,d=this.appStore.isLoading?p.default.createElement(b.Loading,{className:C.default.loading}):p.default.createElement(p.default.Fragment,null,1===f.count&&p.default.createElement(_.default,(0,l.default)({showDeploy:this.showDeploy,detail:r,appStore:this.appStore},n)),1!==f.count&&p.default.createElement(O.default,(0,l.default)({appStore:this.appStore,stepCount:f.count-2,next:f.next,onFormOk:f.onFormOk},n)));return p.default.createElement(S.default,(0,l.default)({width:1070,className:C.default.modal,visible:t,onCancel:a,rightScreen:!0,customTitle:p.default.createElement("div",{className:C.default.intro},p.default.createElement("span",{className:C.default.icon},p.default.createElement(v.default,{iconSize:48,iconLetter:o,src:c,alt:""})),p.default.createElement("div",{className:C.default.text},p.default.createElement("div",null,p.default.createElement("span",null,o),p.default.createElement(h.default,{iconSize:32,isShowTip:!1,app:r})),p.default.createElement("p",null,i))),hideFooter:f.hideFooter},n,f),d)}}]),r}(p.default.Component);a.default=k,k.propTypes={detail:m.default.object,visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool},k.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,t,a){"use strict";a(16);var r=a(19);a(12),a(109),a(3),a(14),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(109),a(32),a(3),a(29),a(14),a(8),a(4),a(440),a(21),a(18),a(43),a(11);var n=r(a(38));a(35);var l,u,o=r(a(39)),c=r(a(62)),s=r(a(25)),i=r(a(28)),f=r(a(74)),d=r(a(41)),p=r(a(42)),m=r(a(37)),h=(r(a(63)),r(a(45))),v=a(17),E=a(56),y=r(a(26)),g=r(a(1463)),b=r(a(468)),S=a(815),_=a(934);function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var C=(l=function(e){(0,d.default)(r,e);var t,a=O(r);function r(){var e;(0,s.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).alertRuleStore=new g.default,e.getUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.workspace,a=e.cluster,r=e.namespace;return(0,_.getManifestApi)({workspace:t,cluster:a,namespace:r})},(0,c.default)(e,"fetchDetail",u,(0,f.default)(e)),e}return(0,i.default)(r,[{key:"deploy",value:(t=(0,o.default)(n.default.mark((function e(t,a){var r,l,u,o,c,s,i,f,d,p;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.workspace,l=a.namespace,u=a.cluster,o=a.restoreParams,c=t.app_id,s=t.name,i=t.conf,f=t.version_id,d=t.description,i.volume&&parseFloat(i.volume)<10&&(i.volume="10Gi"),(p={name:s,description:d,version:1,appVersion:"",customResource:"{}",relatedResources:[]}).appVersion=f,!l){e.next=39;break}e.t0=c,e.next=e.t0===S.RadonDBAppId.ClickHouse?9:e.t0===S.RadonDBAppId.PostgreSQL?11:e.t0===S.RadonDBAppId.MySQL?13:e.t0===S.RadonDBAppId.RedisCluster?16:e.t0===S.RadonDBAppId.RedisSentinel?19:e.t0===S.RadonDBAppId.MongoDB?22:e.t0===S.RadonDBAppId.Elasticsearch?25:e.t0===S.RadonDBAppId.Kafka?28:e.t0===S.RadonDBAppId.OpenSearch?31:34;break;case 9:return p.customResource=(0,S.mergeCKInstallationData)({name:s,valuesJson:i,namespace:l}),e.abrupt("break",35);case 11:return p.customResource=(0,S.mergePGInstallationData)({name:s,valuesJson:i,namespace:l,restoreParams:o}),e.abrupt("break",35);case 13:return p.customResource=(0,S.mergeMySQLInstallationData)({name:s,valuesJson:i,namespace:l,restoreParams:o}),p.relatedResources=[{name:"secret",data:(0,S.getSecretCrd)({name:s,namespace:l})}],e.abrupt("break",35);case 16:return p.customResource=(0,S.mergeRedisClusterInstallationData)({name:s,namespace:l,valuesJson:i}),p.relatedResources=(0,S.getRedisClusterRelatedResources)({name:s,namespace:l,password:i.password,specifications:i.specifications}),e.abrupt("break",35);case 19:return p.customResource=(0,S.mergeRedisSentinelInstallationData)({name:s,namespace:l,valuesJson:i}),p.relatedResources=(0,S.getRedisSentinelRelatedResources)({name:s,namespace:l,password:i.password,specifications:i.specifications}),e.abrupt("break",35);case 22:return p.customResource=(0,S.mergeMongoDBInstallationData)({name:s,namespace:l,valuesJson:i}),p.relatedResources=(0,S.getMongoDBRelatedResources)({name:s,namespace:l}),e.abrupt("break",35);case 25:return p.customResource=(0,S.mergeECKInstallationData)({name:s,namespace:l,valuesJson:i}),p.relatedResources=(0,S.getECKRelatedResources)({name:s,namespace:l,kibanaValues:i.kibana||{}}),e.abrupt("break",35);case 28:return p.customResource=(0,S.mergeKafkaInstallationData)({name:s,namespace:l,valuesJson:i}),p.relatedResources=(0,S.getKafkaRelatedResources)({namespace:l,name:s}),e.abrupt("break",35);case 31:return p.customResource=(0,S.mergeOpenSearchInstallationData)({name:s,namespace:l,valuesJson:i}),p.relatedResources=(0,S.getOpenSearchRelatedResources)({name:s,namespace:l,logstashValues:i.logstash||{},username:i.username,password:i.password}),e.abrupt("break",35);case 34:return e.abrupt("return");case 35:return e.next=37,this.submitting(request.post(this.getUrl({namespace:l,workspace:r,cluster:u}),p));case 37:return e.next=39,this.alertRuleStore.createDefaultAlert(c,{name:s,namespace:l,cluster:u});case 39:case"end":return e.stop()}}),e,this)}))),function(e,a){return t.apply(this,arguments)})}]),r}(b.default),(0,h.default)(l.prototype,"deploy",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"deploy"),l.prototype),u=(0,h.default)(l.prototype,"fetchDetail",[v.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,o.default)(n.default.mark((function t(a){var r,l,u,o;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.app_id,l=(0,y.default)(globals.user,"lang")||(0,E.getBrowserLang)(),e.isLoading=!0,u="/kapis/application.kubesphere.io/v2/apps/".concat(r),t.next=6,request.get(u);case 6:(o=t.sent).abstraction=(0,y.default)(o,"abstraction_".concat(l),o.abstraction),o.description=(0,y.default)(o,"description_".concat(l),o.description),o.screenshots=(0,y.default)(o,"screenshots_".concat(l),o.screenshots),e.detail=o,e.isLoading=!1;case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),l);t.default=C},,,,,,,,function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(51),r(14),r(4),r(18),r(30),r(11),r(197),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(51),r(29),r(14),r(4),r(18),r(43),r(30),r(11),r(197);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=r(248),p=r(17),m=n(r(245)),h=r(189),v=n(r(890)),E=n(r(1464)),y=n(r(1458)),g=r(56),b=n(r(2836));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var _=h.Tabs.TabPanel,O=function(e){(0,o.default)(r,e);var a=S(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleDeploy=function(){t.props.showDeploy()},t.params=(0,d.parse)(location.search.slice(1))||{},t.htmlOrigBgColor="",t.state={tab:"appInfo",selectAppVersion:"",showDeploy:!1},t.appId=t.props.app_id,t.versionStore=new v.default,t}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getData",value:function(){var e=this;this.versionStore.fetchList({app_id:this.appId,status:"active"}).then((function(){var t=(0,f.default)(e.versionStore,"list.data[0].version_id","");e.setState({selectAppVersion:t})}))}},{key:"renderDeployButton",value:function(){var e=this.props.appStore.detail,a=(0,g.isAppIsRadonDBAndAuthorized)(e),r=a.isRadondb,n=a.isSupport,l=r&&!n;return i.default.createElement(h.Tooltip,{content:l?i.default.createElement("div",{className:b.default.authorizedTip},i.default.createElement("div",{className:b.default.authorizedTipTitle},i.default.createElement(h.Icon,{name:"information",color:{primary:"#fff",secondary:"#F5A623"}}),i.default.createElement("span",null,t("APP_UNAUTHORIZED"))),i.default.createElement("p",null,t("APP_UNAUTHORIZED_DESC"))):""},i.default.createElement("div",{className:b.default.deployButton},i.default.createElement(h.Button,{onClick:this.handleDeploy,type:"control",disabled:l},t("INSTALL"))))}},{key:"renderContent",value:function(){var e=this.state.tab,a=this.props.appStore.detail,r=this.versionStore.list.data;return i.default.createElement(h.Tabs,{className:"tabs-new",activeName:e,onChange:this.handleTabChange},i.default.createElement(_,{label:t("APP_INFORMATION"),name:"appInfo"},this.renderDeployButton(),i.default.createElement(h.Columns,null,i.default.createElement(h.Column,{className:"is-9"},i.default.createElement(E.default,{app:a,versions:(0,p.toJS)(r)})),i.default.createElement(h.Column,null,i.default.createElement(y.default,{app:a})))))}},{key:"render",value:function(){return i.default.createElement("div",{className:b.default.main},i.default.createElement("div",{className:b.default.content},this.renderContent()))}},{key:"versionOptions",get:function(){return this.versionStore.list.data.map((function(e){var a=e.version_id,r=e.name,n=e.create_time;return{label:r,description:(0,m.default)(n).format(t("YYYY-MM-DD")),value:a}}))}}]),r}(i.default.Component);a.default=O},,,,function(e,t,a){e.exports={content:"F9cCXv2wjuVST_W7U5zvb",deployButton:"_1DTp0_lcWeecxqs_-It4KA",keywords:"_1A3YmiMHk1xXcfQiwW-ykl",deployModal:"_2Ut2mhc56BgtCHaPbBcvrj",authorizedTip:"_1mGVVHb7CDZ80rcKOYpjMH",authorizedTipTitle:"_3WSM1_DidAthIrad3ItYSB"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(73),r(71),r(991),r(7);var l=n(r(38)),u=n(r(31));r(35);var o,c=n(r(39)),s=n(r(50)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=n(r(26)),E=r(243),y=r(189),g=n(r(890)),b=n(r(2838)),S=n(r(1461)),_=r(56),O=n(r(2839)),C=n(r(2844)),T=n(r(2846)),R=r(815);function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var I=(0,E.observer)(o=function(e){(0,d.default)(n,e);var a,r=N(n);function n(e){var t;(0,i.default)(this,n),(t=r.call(this,e)).handleOk=function(){var e=t.formRef.current;e&&e.validate((function(){var e=t.state.formData,a=e.cluster,r=e.workspace,n=e.namespace,l=(0,s.default)(e,["cluster","workspace","namespace"]);t.props.appStore.deploy(l,{cluster:a,namespace:n,workspace:r,restoreParams:t.props.restoreParams}).then((function(){t.props.onOk()}))}))},t.handleNext=function(){var e=t.formRef.current;e&&e.validate((function(){2!==t.props.stepCount?(t.setState((function(e){var a=e.currentStep;return{currentStep:Math.min(t.steps.length-1,a+1)}})),t.props.onFormOk&&t.props.onFormOk()):t.handleOk()}))},t.appId=e.app_id,t.versionStore=new g.default,t.fileStore=new b.default;var a=e.workspace,l=e.cluster,u=e.namespace;return t.state={currentStep:e.stepCount,formData:{app_id:t.appId,workspace:a,cluster:l,namespace:u}},t.formRef=h.default.createRef(),t}return(0,f.default)(n,[{key:"componentDidMount",value:function(){this.fixBodyColor(),this.getData()}},{key:"componentDidUpdate",value:function(e){var t=this.props.stepCount;this.props.next?this.handleNext():e.stepCount!==t&&(t>e.stepCount?this.handleNext():this.setState({currentStep:t}))}},{key:"componentWillUnmount",value:function(){document.querySelector("html").style.backgroundColor=this.htmlOrigBgColor}},{key:"fixBodyColor",value:function(){var e=document.querySelector("html");this.htmlOrigBgColor=window.getComputedStyle(e).backgroundColor,e.style.backgroundColor="white"}},{key:"getData",value:(a=(0,c.default)(l.default.mark((function e(){var t,a,r;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.versionStore.fetchList({app_id:this.appId,status:"active"});case 2:t=(0,v.default)(this.versionStore,"list.data[0].version_id",""),a=(0,v.default)(this.versionStore,"list.data[0].name",""),r=this.props.appStore.detail.name,this.fileStore.loadRadonDB({app_id:this.appId,restoreParams:this.props.restoreParams}),this.setState({formData:k(k({},this.state.formData),{},{name:"".concat(r.slice(0,7).toLowerCase().replaceAll(" ","-"),"-").concat((0,_.generateId)()),version_id:this.isRadonDB?a:t})});case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderForm",value:function(){var e=this.state,t=e.formData,a=e.currentStep,r=this.steps[a],n=r.component,l={formData:t,fromStore:!0,versionStore:this.versionStore,fileStore:this.fileStore,appId:this.appId};return r.isForm?l.formRef=this.formRef:l.ref=this.formRef,h.default.createElement("div",{className:T.default.form},h.default.createElement(n,l))}},{key:"renderControl",value:function(){var e=this.state.currentStep,a=this.steps.length-1;return h.default.createElement("div",{className:T.default.control},e<a?h.default.createElement(y.Button,{type:"control",onClick:this.handleNext},t("NEXT")):h.default.createElement(y.Button,{type:"control",onClick:this.handleOk,loading:this.props.appStore.isSubmitting},t("INSTALL")))}},{key:"renderSteps",value:function(){return h.default.createElement("div",{className:T.default.steps},h.default.createElement(C.default,{steps:this.steps,current:this.state.currentStep}))}},{key:"render",value:function(){return h.default.createElement("div",{className:T.default.main},h.default.createElement("div",{className:T.default.content},this.renderSteps(),h.default.createElement("div",{className:T.default.formWrapper},this.renderForm())))}},{key:"isRadonDB",get:function(){return R.RadonDBAppIds.includes(this.appId)}},{key:"steps",get:function(){var e=[{title:"BASIC_INFORMATION",component:S.default,required:!0,isForm:!0}];return e.push({title:"APP_SETTINGS",component:O.default,required:!0}),e}}]),n}(h.default.Component))||o;a.default=I},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n,l,u=r(a(62)),o=r(a(25)),c=r(a(74)),s=r(a(41)),i=r(a(42)),f=r(a(37)),d=r(a(45)),p=(r(a(63)),a(17)),m=r(a(887)),h=r(a(119)),v=r(a(68)),E=a(815);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=(n=function(e){(0,s.default)(a,e);var t=y(a);function a(){var e;(0,o.default)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).resourceName="files",(0,u.default)(e,"loadRadonDB",l,(0,c.default)(e)),e}return a}(m.default),l=(0,d.default)(n.prototype,"loadRadonDB",[p.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.app_id,r=t.restoreParams;e.files={"values.schema":(0,h.default)(E.ValuesSchema[a]),"values.json":(0,h.default)(E.ValuesJSON[a])},r&&(r.databaseVersion&&((0,v.default)(e.files,'["values.schema"].properties.version.disabled',!0),(0,v.default)(e.files,'["values.json"].version',r.databaseVersion)),r.nodes&&((0,v.default)(e.files,'["values.schema"].properties.nodes.disabled',!0),(0,v.default)(e.files,'["values.json"].nodes',r.nodes)),r.volume&&((0,v.default)(e.files,'["values.schema"].properties.volume.disabled',!0),(0,v.default)(e.files,'["values.schema"].properties.volumeType.disabled',!0),(0,v.default)(e.files,'["values.json"].volume',r.volume)),r.specifications&&((0,v.default)(e.files,'["values.schema"].properties.specifications.disabled',!0),(0,v.default)(e.files,'["values.json"].specifications',r.specifications))),e.isLoading=!1,e.isRadonDB=!0}}}),n);t.default=g},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(68)),p=r(17),m=r(243),h=r(189),v=n(r(191)),E=r(56),y=r(463),g=r(815),b=n(r(2840)),S=n(r(2843));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var O=(0,m.observer)(l=function(e){(0,c.default)(r,e);var a=_(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={valuesJSON:{},valuesSchema:void 0,loadingFile:!0},e.validatorResult={errorCount:0},e.updateState=function(){var t=e.props.fileStore.files;e.props.fileStore.isRadonDB?e.setState({valuesSchema:t["values.schema"],valuesJSON:t["values.json"],loadingFile:!1}):t&&t["values.yaml"]&&e.setState({valuesJSON:(0,y.getValueObj)(t["values.yaml"]),valuesSchema:(0,E.safeParseJSON)(t["values.schema.json"]),loadingFile:!1})},e.updateFormData=function(){var t=e.props.formData,a=e.state.valuesJSON;(0,d.default)(t,"conf",a)},e}return(0,o.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.updateState(),this.props.fileStore.files.packageFiles||(this.dispather=(0,p.reaction)((function(){return e.props.fileStore.files}),this.updateState))}},{key:"componentWillUnmount",value:function(){this.dispather&&this.dispather()}},{key:"validate",value:function(e){if(!(this.validatorResult.errorCount>0)){var a=this.props.formData,r=this.state.valuesJSON,n=a.name,l=a.namespace,u=a.app_id,o=r.version,c="";if(u===g.RadonDBAppId.MySQL&&"5.7"===o&&(l.length>16||n.length>14)){if(l.length>16)return c=t("PROJECT_NAME_EXCEEDS_LIMIT"),void v.default.warning({content:c});if(n.length>14)return c=t("APP_NAME_EXCEED_LIMIT"),void v.default.warning({content:c})}this.updateFormData(),e&&e()}}},{key:"renderSchemaForm",value:function(){var e=this.state,t=e.valuesJSON,a=e.valuesSchema;return f.default.createElement("div",{className:S.default.schemaWrapper},f.default.createElement(b.default,{schema:a,value:t,validatorResult:this.validatorResult,formData:this.props.formData}))}},{key:"render",value:function(){return this.state.loadingFile?f.default.createElement(h.Loading,{className:S.default.loading}):f.default.createElement("div",{className:S.default.wrapper},f.default.createElement("div",{className:S.default.title},f.default.createElement("div",null,t("APP_SETTINGS"))),this.renderSchemaForm())}}]),r}(f.default.Component))||l;a.default=O},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(192),r(10),r(6),r(70),r(66),r(20),r(98),r(14),r(8),r(13),r(9),r(4),r(190),r(18),r(30),r(11),r(73),r(71),r(79),r(817),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(192),r(10),r(6),r(70),r(66),r(20),r(27),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(440),r(321),r(18),r(43),r(30),r(195),r(11),r(73),r(71),r(79),r(817),r(7);var l=n(r(58)),u=n(r(246)),o=n(r(317)),c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(1)),v=n(r(1062)),E=n(r(26)),y=n(r(68)),g=n(r(1031)),b=n(r(201)),S=n(r(67)),_=r(189),O=n(r(800)),C=n(r(5)),T=n(r(894)),R=r(17),D=n(r(1065)),k=n(r(2841)),N=n(r(2842));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var w=function(e){(0,f.default)(r,e);var a=A(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,i=new Array(n),f=0;f<n;f++)i[f]=arguments[f];return(e=a.call.apply(a,[this].concat(i))).state={value:e.props.value,showAdvanced:(0,E.default)(e.props.schema,"unfoldAdvanced",!1),error:{}},e.toggleAdvanced=function(){e.setState({showAdvanced:!e.state.showAdvanced})},e.generateMarks=function(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=4,n=parseInt((t-e)/r,10),l={},u=0;u<r;u++){var o=e+u*n;l[o]=0===o?o:o+a}return l[t]=t+a,l},e.renderFormItem=function(a,r,n){var l,u=e.state,s=u.value,i=u.error,f={defaultValue:(0,E.default)(s,n,""),onChange:function(r){a.rules&&a.rules.some((function(e){return e.pattern&&!e.pattern.test(r)?((0,y.default)(i,'["'.concat(n.join("."),'"]'),t(e.message)),!0):((0,y.default)(i,'["'.concat(n.join("."),'"]'),""),!1)}));var l=Object.values(i).filter((function(e){return e})).length;(0,y.default)(e.props.validatorResult,"errorCount",l),e.handleFormChange((0,y.default)(s,n,r))}};switch(a.type){case"string":l="slider"===a.render?m.default.createElement(T.default,(0,o.default)({className:(0,C.default)((0,c.default)({},N.default.disabled,a.disabled)),withInput:!a.disabled,max:a.sliderMax,min:a.sliderMin,unit:a.sliderUnit,marks:e.generateMarks(a.sliderMin,a.sliderMax,a.sliderUnit)},f,{onChange:function(t){if(a.validator){var r=a.validator(t,{app_id:e.props.formData.app_id,max:a.sliderMax,nodeRole:(0,E.default)(n,"[0]")}),l=r.error,u=r.message;l?(0,y.default)(i,'["'.concat(n.join("."),'"]'),u):(0,y.default)(i,'["'.concat(n.join("."),'"]'),"")}t&&parseFloat(t)>0&&t.trim().startsWith("0")?f.onChange(t.replace(/^0*/,"")):f.onChange(t)}})):"textArea"===a.render?m.default.createElement(_.TextArea,f):"select"===a.render?"volumeType"===r?m.default.createElement(k.default,(0,o.default)({disabled:a.disabled},f,{cluster:e.props.formData.cluster})):m.default.createElement(_.Select,(0,o.default)({},f,{options:(0,R.toJS)(a.options).map((function(e){return P(P({},e),{},{label:"number"==typeof e.label?e.label:t(e.label)})})),disabled:a.disabled})):"password"===a.render?m.default.createElement(_.InputPassword,(0,o.default)({name:a.name,disabled:a.disabled,autoComplete:"new-password",placeholder:a.placeholder?t(a.placeholder):""},f)):m.default.createElement(_.Input,(0,o.default)({},f,{disabled:a.disabled}));break;case"integer":l=m.default.createElement(D.default,(0,o.default)({},f,{integer:!0,min:a.min,max:a.max,showFunc:a.showFunc,disabled:a.disabled,style:{maxWidth:"455px"}}));break;case"boolean":l=m.default.createElement("div",{className:N.default.boolean},m.default.createElement(_.Toggle,(0,o.default)({},f,{defaultChecked:(0,E.default)(s,n,!1)})),m.default.createElement(O.default,{title:a.title,description:a.description}));break;case"alert":l=m.default.createElement(_.Alert,{className:N.default.alert,icon:"information",message:t(a.content)});break;case"array":l=m.default.createElement(m.default.Fragment,null,"todo");break;default:l=m.default.createElement(m.default.Fragment,null)}var d="";"boolean"!==a.type&&(d=a.tooltipContent?m.default.createElement("div",null,m.default.createElement("span",{style:{verticalAlign:"bottom"}},t(a.title)),m.default.createElement(_.Tooltip,{content:t(a.tooltipContent)},m.default.createElement(_.Icon,{size:20,name:"question"}))):t(a.title));var p="integer"===a.type&&"number"==typeof a.min&&"number"==typeof a.max?"".concat(t(a.description||"")).concat(t("VALUE_RANGE_DESC",{min:a.min,max:a.max})):t(a.description),h=(0,E.default)(i,'["'.concat(n.join("."),'"]')),v=(0,E.default)(e.state.value,"[".concat(n.join(".").replace(r,"version"),"]"));return a.forVersion&&a.forVersion instanceof Array&&!a.forVersion.includes(v)?null:m.default.createElement(_.Form.Item,{key:r,className:a.rowExclusive&&!a.halfRow?"row":"",label:d,desc:p,error:h?{message:h}:null},l)},e.renderSchemaForm=function(a){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=a.type,c=e.state.value,s="object"===(0,u.default)(a.hidden)?(0,E.default)(c,a.hidden.value,null)===a.hidden.condition:(0,E.default)(c,a.hidden,!1);if(s)return null;if("object"===o){var i=[],f=[];if((0,v.default)(a.properties,(function(t,a){t.advanced?f.push(e.renderSchemaForm(t,a,[].concat((0,l.default)(n),[a]))):i.push(e.renderSchemaForm(t,a,[].concat((0,l.default)(n),[a])))})),(0,S.default)(i)||i.every((function(e){return!e})))return null;var d=a.properties&&(0,g.default)(a.properties,(function(e){return(0,b.default)(e,"properties")}));return m.default.createElement("div",{key:r,className:d?N.default.parentGroup:N.default.group},a.title&&m.default.createElement("div",{className:N.default.titleContainer},a.icon&&m.default.createElement(_.Icon,{name:a.icon,size:20}),m.default.createElement("div",{className:N.default.title},t(a.title))),a.description&&m.default.createElement("p",{className:N.default.description},t(a.description)),i,f.length>0&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:N.default.advanced,onClick:e.toggleAdvanced},m.default.createElement("span",null,t("ADVANCED_SETTINGS")),m.default.createElement(_.Icon,{name:e.state.showAdvanced?"chevron-up":"chevron-down",size:"20"})),m.default.createElement("div",null)),e.state.showAdvanced&&f,f.length%2==1&&m.default.createElement("div",{className:"form-item"}))}return m.default.createElement(m.default.Fragment,null,e.renderFormItem(a,r,n),a.halfRow&&m.default.createElement("div",{className:"form-item"}))},e}return(0,i.default)(r,[{key:"handleFormChange",value:function(e){this.setState({value:e})}},{key:"render",value:function(){var e=this.props.schema;return this.renderSchemaForm(e)}}]),r}(m.default.Component);a.default=w,w.propTypes={schema:h.default.object,value:h.default.object,onChange:h.default.func,validatorResult:h.default.object,formData:h.default.object},w.defaultProps={onChange:function(){}}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(20),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(14),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=a(189),d=r(a(26));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).state={options:[]},e.getUrl=function(){return"\n      /kapis".concat(globals.app.isMultiCluster?"/clusters/".concat(e.props.cluster):"","/resources.kubesphere.io/v1alpha3/storageclasses?sortBy=createTime")},e}return(0,u.default)(a,[{key:"componentDidMount",value:function(){var e=this;request.get(this.getUrl()).then((function(t){var a=t.items.map((function(e){return{label:e.metadata.name,value:e.metadata.name}}));e.setState({options:a}),e.props.onChange((0,d.default)(e.state.options,"[0].value"))}))}},{key:"render",value:function(){return i.default.createElement(f.Select,(0,n.default)({},this.props,{options:this.state.options}))}}]),a}(i.default.Component);t.default=m},function(e,t,a){e.exports={group:"_1LEM6H2hiHcNQ8bUU3mJuw",titleContainer:"_3d3-PHNYtbjdjLYgLjSooE",title:"_2zPbKOf3hJMkI0WpS-Z3eB",description:"_12__-bkxGteMzlKHt_OWt6",boolean:"_3z596UuO4JJfAARMnB9iEc",parentGroup:"_3n-j-dfbxo2qVkAjSkNyjz",advanced:"_19fZQMwrad5YJBF1CtSSdg",alert:"_2i-Xv0soiNQZQGbxkpXi8R",disabled:"_2Phc2CXUSzuqeWaTUbmWRH"}},function(e,t,a){e.exports={wrapper:"_2UpPoM0Aj97SWE8BeEzdgl",title:"_2JPY252bQeGvx258GYWwO5",switch:"_2SpL0hTaRrp2E5f_wTEGpY",codeWrapper:"_2UTeaFK_M0EfVWjoTimlTg",loading:"_12fEXFIn68d7_pvL5Cq5E1"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(4),r(18),r(43),r(11);var u=l(r(31)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(5)),m=l(r(2845));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var v=function(e){(0,s.default)(r,e);var a=h(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.steps,r=e.current;return d.default.createElement("div",{className:m.default.wrapper},a.map((function(e,a){var n;return d.default.createElement("div",{key:e.title},d.default.createElement("span",{className:(0,p.default)(m.default.indicator,(n={},(0,u.default)(n,m.default.fullfill,r>a),(0,u.default)(n,m.default.current,r===a),(0,u.default)(n,m.default.pending,r<a),n))}),d.default.createElement("span",null,t(e.title)))})))}}]),r}(d.Component);a.default=v},function(e,t,a){e.exports={wrapper:"thPTMVSpjM6ZufPDuzykF",indicator:"_1lBM82p9Ksgncv6GSgHrHt",pending:"_3NeVNf4NiX9V831jYF8w4M",current:"_3PpRNuetQdN9jDMxk5z1wk",fullfill:"_2ULf1mAxJvjg65-bY76hGR"}},function(e,t,a){e.exports={content:"THjO0nqOHFnL0C82sdOjK",formWrapper:"_1pMNOwJjEl4YoOiRYTZuel",form:"_1eqfbeVSMtiU8imBQ_IVsQ",steps:"_3UYFmXGEQit5rJh-8U6XXe",control:"_1gpDWlp0j17OplfPf6bRt"}},function(e,t,a){e.exports={modal:"_1XlWaPapH46cbNu3hZGvaK",intro:"_1tgVqbLxsu1iO0JifaIrDW",icon:"_1564b2zp57bs2ZwihiPDBe",text:"P-C3WCuJxI66ExNOL235G",loading:"_8dlv9Jo5agw2j4WbF_zur"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(12),r(109),r(20),r(14),r(138),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(20),r(29),r(14),r(138),r(4),r(21),r(18),r(43),r(11);var u=l(r(317)),o=l(r(38));r(35);var c=l(r(39)),s=l(r(25)),i=l(r(28)),f=l(r(41)),d=l(r(42)),p=l(r(37)),m=r(189),h=l(r(798)),v=l(r(1)),E=n(r(0)),y=r(815),g=r(1126),b=l(r(918));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=function(e){(0,f.default)(r,e);var a=S(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).formRef=E.default.createRef(),n.onOk=(0,c.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.formRef.current.validate((0,c.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.props.onOk(n.state.backup);case 1:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)}))),n.onCancel=function(){n.props.onCancel()},n.state={backup:{name:"",alias:""}},n.formItems=e.app_id===y.RadonDBAppId.PostgreSQL?null:[{name:"name",label:"NAME",type:"text",description:"BACKUP_NAME_DESC",rules:[{pattern:g.backupNameRegx,message:t("INVALID_BACKUP_NAME_DESC")},{required:!0,message:t("BACKUP_NAME_EMPTY_DESC")}],range:{max:24}},{name:"alias",label:"ALIAS",type:"text",description:"ALIAS_NAME_DESC",range:{max:63}}],n}return(0,i.default)(r,[{key:"render",value:function(){var e=Object.assign({},this.props);return E.default.createElement(h.default,(0,u.default)({width:600,footerClassName:b.default.footer},e,{onOk:this.onOk,onCancel:this.onCancel,okText:t("BACK_UP")}),E.default.createElement("div",{className:b.default.tips},t("BACKUP_WARNING")),this.props.app_id===y.RadonDBAppId.PostgreSQL&&E.default.createElement("div",{className:b.default.tips},t("BACKUP_POSTGRE_SQL_TIP")),E.default.createElement(m.Form,{className:b.default.form,data:this.state.backup,ref:this.formRef},this.formItems?this.formItems.map((function(e){var a=e.name,r=e.label,n=e.description,l=e.rules,u=e.range;return E.default.createElement(m.Form.Item,{key:a,label:t(r),desc:t(n),rules:l||[]},E.default.createElement(m.Input,{name:a,maxLength:u&&u.max?u.max:-1}))})):E.default.createElement("div",null,t("BACKUP_COMFIRM_TIP"))))}}]),r}(E.Component);a.default=_,_.propTypes={onOk:v.default.func,onCancel:v.default.func,app_id:v.default.string},_.defaultProps={onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(3),r(10),r(6),r(70),r(66),r(138),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(66),r(27),r(29),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(321),r(21),r(18),r(43),r(11),r(73),r(7);var u=l(r(317)),o=l(r(38)),c=l(r(31));r(35);var s=l(r(39)),i=l(r(25)),f=l(r(28)),d=l(r(41)),p=l(r(42)),m=l(r(37)),h=n(r(0)),v=l(r(1)),E=l(r(26)),y=r(189),g=l(r(191)),b=l(r(798)),S=l(r(1065)),_=r(815),O=l(r(918));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var D=[{label:"00:00:00–02:00:00",value:"0"},{label:"02:00:00–04:00:00",value:"2"},{label:"04:00:00–06:00:00",value:"4"},{label:"06:00:00–08:00:00",value:"6"},{label:"08:00:00–10:00:00",value:"8"},{label:"10:00:00–12:00:00",value:"10"},{label:"12:00:00–14:00:00",value:"12"},{label:"14:00:00–16:00:00",value:"14"},{label:"16:00:00–18:00:00",value:"16"},{label:"18:00:00–20:00:00",value:"18"},{label:"20:00:00–22:00:00",value:"20"},{label:"22:00:00–24:00:00",value:"22"}],k=function(e){(0,d.default)(r,e);var a=R(r);function r(e){var n;(0,i.default)(this,r),(n=a.call(this,e)).getBackupSchedule=function(){var e=n.state,t=e.checked,a=e.timePeriod,r=e.cycle;return t&&r.length?"0 ".concat(a," * * ").concat(r.join(",")):""},n.handleToggle=function(e){n.setState({checked:e})},n.handleCheckBoxChange=function(e){n.setState({cycle:e})},n.handleSelectChange=function(e){n.setState({timePeriod:e})},n.onOk=(0,s.default)(o.default.mark((function e(){var a,r,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.state,r=a.retentionTime,l=a.cycle,!a.checked){e.next=8;break}if(r){e.next=5;break}return g.default.error({content:t("BACKUP_RETENTION_DAYS_ERROR")}),e.abrupt("return");case 5:if(0!==l.length){e.next=8;break}return g.default.error({content:t("BACKUP_DATE_ERROR")}),e.abrupt("return");case 8:n.props.onOk(T(T({},n.props),{},{backupSchedule:n.getBackupSchedule(),retentionTime:r}));case 9:case"end":return e.stop()}}),e)}))),n.onCancel=function(){n.props.onCancel()};var l=e.backupSchedule,u=!!l,c="0",f=["0","1","2","3","4","5","6"],d=e.retentionTime||30;if(u){var p=l.split(" ");c=(0,E.default)(p,"[1]",c),f=(0,E.default)(p,"[4]","").split(",").filter((function(e){return f.includes(e)}))}return n.state={checked:u,timePeriod:c,cycle:f,isScheduledDelete:e.isScheduledDelete||!1,retentionTime:d},n}return(0,f.default)(r,[{key:"checkBoxOptions",get:function(){return[{label:t("MONDAY"),value:"1"},{label:t("TUESDAY"),value:"2"},{label:t("WEDNESDAY"),value:"3"},{label:t("THURSDAY"),value:"4"},{label:t("FRIDAY"),value:"5"},{label:t("SATURDAY"),value:"6"},{label:t("SUNDAY"),value:"0"}]}},{key:"checkBoxPGOptions",get:function(){return[{label:t("MONDAY"),value:"0"},{label:t("TUESDAY"),value:"1"},{label:t("WEDNESDAY"),value:"2"},{label:t("THURSDAY"),value:"3"},{label:t("FRIDAY"),value:"4"},{label:t("SATURDAY"),value:"5"},{label:t("SUNDAY"),value:"6"}]}},{key:"showScheduledDelete",get:function(){return this.props.app_id===_.RadonDBAppId.PostgreSQL}}]),(0,f.default)(r,[{key:"render",value:function(){var e=this,a=Object.assign({},this.props);return h.default.createElement(b.default,(0,u.default)({width:600,footerClassName:O.default.footer},a,{onOk:this.onOk,onCancel:this.onCancel}),h.default.createElement("div",{className:O.default.autoBackupToggle},h.default.createElement(y.Toggle,{checked:this.state.checked,onChange:this.handleToggle}),h.default.createElement("span",null,this.state.checked?t("ENABLED"):t("DISABLED"))),this.state.checked?h.default.createElement("div",{className:O.default.autoBackupSetting},h.default.createElement("div",{className:O.default.formItem},h.default.createElement("span",{className:O.default.label},t("BACKUP_TIME")),h.default.createElement(y.Select,{options:D,value:this.state.timePeriod,onChange:this.handleSelectChange})),h.default.createElement("div",{className:O.default.formItem},h.default.createElement("span",{className:O.default.label},t("BACKUP_DATE")),h.default.createElement(y.CheckboxGroup,{value:this.state.cycle,options:this.showScheduledDelete?this.checkBoxPGOptions:this.checkBoxOptions,onChange:this.handleCheckBoxChange})),this.showScheduledDelete&&h.default.createElement("div",null,h.default.createElement("span",{className:O.default.label},t("BACKUP_RETENTION_DAYS")),h.default.createElement(S.default,{className:O.default.retentionTime,min:1,unit:t("BACKUP_DAY"),value:this.state.retentionTime,max:365,showUnit:!0,integer:!0,showFunc:!0,onChange:function(t){var a=""===t?t:parseInt(t,10);e.setState({retentionTime:a})}}))):null)}}]),r}(h.Component);a.default=k,k.propTypes={onOk:v.default.func,onCancel:v.default.func},k.defaultProps={onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(3),r(10),r(6),r(20),r(51),r(14),r(138),r(8),r(13),r(9),r(4),r(18),r(11),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(51),r(29),r(14),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7),r(110);var u=l(r(317)),o=l(r(38)),c=l(r(31));r(35);var s=l(r(39)),i=l(r(25)),f=l(r(28)),d=l(r(41)),p=l(r(42)),m=l(r(37)),h=n(r(0)),v=l(r(1)),E=l(r(5)),y=r(189),g=l(r(26)),b=r(56),S=l(r(807)),_=l(r(1186)),O=l(r(918));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var D=function(e){(0,d.default)(r,e);var a=R(r);function r(){var e;(0,i.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).onOk=(0,s.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.store.create(T(T({},e.props),{},{id:e.props.cluster_id}));case 2:return t.next=4,e.props.store.fetchList(T(T({},e.props),{},{id:e.props.cluster_id}));case 4:e.props.onOk();case 5:case"end":return t.stop()}}),t)}))),e.onCancel=function(){e.props.onCancel()},e}return(0,f.default)(r,[{key:"getIsRebalancing",value:function(e){var t=(0,g.default)(e,"[0]");return t&&"Creating"===t.status}},{key:"componentDidMount",value:function(){var e=this;if(this.getIsRebalancing(this.props.store.list.data)){var t=this.props,a={cluster:t.cluster,namespace:t.namespace,id:t.cluster_id};this.props.store.fetchList(a),this.timer=setInterval((function(){e.props.store.fetchList(a).then((function(t){e.getIsRebalancing(t)||clearInterval(e.timer)}),(function(){clearInterval(e.timer)}))}),1e4)}}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"render",value:function(){var e=Object.assign({},this.props),a=this.props.store.list,r=this.getIsRebalancing(this.props.store.list.data),n=a.isLoading||r;return h.default.createElement(_.default,(0,u.default)({width:600,footerClassName:O.default.footer},e,{disableSubmit:n,onOk:this.onOk,onCancel:this.onCancel,okText:t("START_REBALANCING"),okTooltip:r?t("REBALANCING_IN_PROGRESS_DESC"):""}),h.default.createElement("div",{className:O.default.modalPadding},h.default.createElement(y.Alert,{className:O.default.alert,type:"warning",message:t("KAFKA_OPERATION_WARNING")}),h.default.createElement("div",{className:O.default.rebalance},h.default.createElement("div",{className:O.default.subTitle},t("REBALANCING_HISTORY")),h.default.createElement("div",{className:O.default.historyContainer},h.default.createElement("div",{className:O.default.row},h.default.createElement("div",{className:O.default.time},t("TIME")),h.default.createElement("div",{className:O.default.status},t("STATUS"))),a.data.slice(0,3).map((function(e){return h.default.createElement("div",{key:e.name,className:(0,E.default)(O.default.row,O.default.historyItem)},h.default.createElement("div",{className:O.default.time},(0,b.getLocalTime)(e.creationTimestamp).format("YYYY-MM-DD HH:mm:ss")),h.default.createElement("div",{className:O.default.status},h.default.createElement(S.default,{type:e.status,name:t(e.statusName),flicker:!0})))}))))))}}]),r}(h.Component);a.default=D,D.propTypes={onOk:v.default.func,onCancel:v.default.func},D.defaultProps={onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(109),r(10),r(6),r(66),r(20),r(14),r(24),r(886),r(138),r(8),r(13),r(9),r(4),r(190),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(10),r(6),r(66),r(20),r(27),r(29),r(14),r(886),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(321),r(21),r(18),r(43),r(11),r(7);var u=l(r(31)),o=l(r(317)),c=l(r(50)),s=l(r(38));r(35);var i=l(r(39)),f=l(r(25)),d=l(r(28)),p=l(r(41)),m=l(r(42)),h=l(r(37)),v=n(r(0)),E=l(r(1)),y=r(189),g=l(r(26)),b=l(r(68)),S=l(r(163)),_=l(r(798)),O=l(r(894)),C=l(r(1065)),T=l(r(918));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var N=function(e){(0,p.default)(r,e);var a=k(r);function r(e){var n;(0,f.default)(this,r),(n=a.call(this,e)).formRef=v.default.createRef(),n.onOk=(0,i.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===Object.values(n.state.error).join("")){e.next=2;break}return e.abrupt("return");case 2:n.formRef.current.validate((0,i.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.props.onOk(n.state.detail);case 1:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e)}))),n.onCancel=function(){n.props.onCancel()},n.generateMarks=function(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=4,n=parseInt((t-e)/r,10),l={},u=0;u<r;u++){var o=e+u*n;l[o]=0===o?o:o+a}return l[t]=t+a,l},n.toggleAdvanced=function(){n.setState({showAdvanced:!n.state.showAdvanced})},n.getFormItems=function(e){var t=n.state,a=t.error,r=t.detail;return e.map((function(e){var t=e.name,l=e.type,u=e.label,s=e.description,i=e.rules,f=void 0===i?[]:i,d=e.range,p=e.unit,m=e.showFunc,h=e.options,E=e.validator,S=(0,c.default)(e,["name","type","label","description","rules","range","unit","showFunc","options","validator"]),_=(0,g.default)(a,'["'.concat(t,'"]')),T=(0,g.default)(r,'["'.concat(t,'"]'));switch(l){case"text":return v.default.createElement(y.Form.Item,{key:t,label:u,desc:s,rules:f},v.default.createElement(y.Input,(0,o.default)({name:t,maxLength:d&&d.max?d.max:-1},S)));case"textArea":return v.default.createElement(y.Form.Item,(0,o.default)({key:t,label:u,desc:s,rules:f},S),v.default.createElement(TextArea,{maxLength:256,name:t}));case"number":return v.default.createElement(y.Form.Item,{key:t,label:u,desc:s,rules:f},v.default.createElement(C.default,(0,o.default)({name:t,integer:!0,min:d.min,max:d.max,showFunc:m,unit:p,showUnit:!!p,value:(0,g.default)(n.state,'detail["'.concat(t,'"]'),T),onChange:function(e){(0,b.default)(n.state,'detail["'.concat(t,'"]'),""===e?e:parseInt(e,10)),n.forceUpdate()}},S)));case"select":return v.default.createElement(y.Form.Item,{key:t,label:u,desc:s,rules:f},v.default.createElement(y.Select,{name:t,options:h}));case"slider":return v.default.createElement(y.Form.Item,{key:t,label:u,desc:s,rules:f,error:_?{message:_}:null},S.disabled?v.default.createElement(C.default,(0,o.default)({integer:!0,unit:p,showUnit:!!p,name:t,value:(0,g.default)(n.state,'detail["'.concat(t,'"]'),T)},S)):v.default.createElement(O.default,{name:t,max:d.max,min:d.min,unit:p,marks:n.generateMarks(d.min,d.max,p),value:T,onChange:function(e){if(E){var r=E(e,D(D({},d),{},{unit:p})),l=r.error,u=r.message;l?(0,b.default)(a,'["'.concat(t,'"]'),u):(0,b.default)(a,'["'.concat(t,'"]'),"")}(0,b.default)(n.state,'detail["'.concat(t,'"]'),e),n.forceUpdate()},withInput:!0}));default:return null}}))};var l={name:"",partitions:3,replicas:Math.min(3,e.kafkaReplicas),"cleanup.policy":"delete","min.insync.replicas":1,"unclean.leader.election.enable":"true","segment.ms":6048e5,"retention.ms":6048e5,"retention.bytes":-1,"max.message.bytes":1048588};return n.state={detail:e.detail?D(D({},l),e.detail):l,error:{},showAdvanced:!1},n.formItems=[{name:"name",label:t("NAME"),type:"text",description:t("TOPIC_NAME_DESC"),range:{max:100},rules:[{pattern:/^[a-z][a-z0-9-.]{0,100}$/,message:t("INVALID_TOPIC_NAME_DESC")},{required:!0,message:t("TOPIC_NAME_EMPTY_DESC")}],disabled:!!e.detail},{name:"partitions",label:t("PARTITION_COUNT"),type:"slider",unit:"",description:e.detail?"":" ",range:{min:1,max:1e3},validator:function(a,r){var n=r.min,l=r.max,u=parseInt(a,10),o=(0,g.default)(e,"detail.partitions");return!(0,S.default)(o)&&u<o?{error:!0,message:t("INVALID_PARTITION_COUNT_DESC",{min:o,max:l})}:Number.isNaN(u)||u<n||u>l?{error:!0,message:t("INVALID_PARTITION_COUNT_DESC",{min:n,max:l})}:{error:!1}},rules:[{required:!0,message:t("PARAM_REQUIRED")}]},{name:"replicas",label:t("REPLICA_COUNT"),type:"number",range:{min:1,max:e.kafkaReplicas},showFunc:!0,description:t("TOPIC_REPLICA_COUNT_DESC"),disabled:!!e.detail,rules:[{required:!0,message:t("PARAM_REQUIRED")}]}],n.advancedItems=[{name:"cleanup.policy",label:"cleanup.policy",type:"select",description:t("CLEANUP_POLICY_DESC"),options:[{label:t("CLEANUP_POLICY_DELETE"),value:"delete"},{label:t("CLEANUP_POLICY_COMPACT"),value:"compact"}]},{name:"min.insync.replicas",label:"min.insync.replicas",type:"number",description:t("MIN_INSYNC_REPLICAS_DESC"),range:{min:1,max:(0,g.default)(n.state.detail,"replicas",1)},showFunc:!0},{name:"unclean.leader.election.enable",label:"unclean.leader.election.enable",type:"select",description:t("UNCLEAN_LEADER_ELECTION_ENABLE_DESC"),options:[{label:t("TRUE"),value:"true"},{label:t("FALSE"),value:"false"}]},{name:"segment.ms",label:"segment.ms",type:"number",description:t("SEGMENT_MS_DESC"),range:{min:864e5},unit:"ms"},{name:"retention.ms",label:"retention.ms",type:"number",description:t("RETENTION_MS_DESC"),range:{min:-1},unit:"ms"},{name:"retention.bytes",label:"retention.bytes",type:"number",description:t("RETENTION_BYTES_DESC"),range:{min:-1},unit:"byte"},{name:"max.message.bytes",label:"max.message.bytes",type:"number",description:t("MAX_MESSAGE_BYTES_DESC"),range:{min:0},unit:"byte"}],n}return(0,d.default)(r,[{key:"render",value:function(){var e=Object.assign({},this.props);return v.default.createElement(_.default,(0,o.default)({width:600,footerClassName:T.default.footer},e,{onOk:this.onOk,onCancel:this.onCancel}),v.default.createElement(y.Form,{className:T.default.form,data:this.state.detail,ref:this.formRef},this.getFormItems(this.formItems),v.default.createElement("div",{className:T.default.advanced,onClick:this.toggleAdvanced},v.default.createElement("span",null,t("ADVANCED_SETTINGS")),v.default.createElement(y.Icon,{name:this.state.showAdvanced?"chevron-up":"chevron-down",size:"20"})),this.state.showAdvanced&&this.getFormItems(this.advancedItems)))}}]),r}(v.Component);a.default=N,N.propTypes={onOk:E.default.func,onCancel:E.default.func,app_id:E.default.string},N.defaultProps={onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(1)),h=r(189),v=l(r(798)),E=l(r(2853));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var g=function(e){(0,i.default)(r,e);var a=y(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleChangeCheck=function(e){localStorage.setItem("".concat(globals.user.username,"-app-agreement"),e)},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onOk,n=(0,o.default)(e,["visible","onOk"]);return p.default.createElement(v.default,(0,u.default)({width:600,bodyClassName:E.default.body,visible:a,hideHeader:!0,onOk:r,okText:t("AGREE")},n),p.default.createElement("div",{className:E.default.wrapper},p.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/app-safety.svg",alt:""}),p.default.createElement("div",{className:E.default.content},p.default.createElement("div",{className:E.default.title}," ",t("APP_DEPLOY_AGREEMENT")),p.default.createElement("ul",null,p.default.createElement("li",null,t("APP_DEPLOY_AGREEMENT_DESC_1")),p.default.createElement("li",null,t("APP_DEPLOY_AGREEMENT_DESC_2"))),p.default.createElement(h.Checkbox,{onChange:this.handleChangeCheck},t("DO_NOT_REMIND_AGAIN")))))}}]),r}(p.Component);a.default=g,g.propTypes={visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func},g.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={body:"_1yenBd_xxty8LIDUQZfbje",wrapper:"_1hbebsdjZ3ZpoZNh-lJuTR",content:"_2sujFFe0rBgZgjurei191W",title:"_2ZVasVLtnF01STWETyn4LD"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(30),r(11),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798)),m=n(r(2855));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).state={confirm:""},e.handleInputChange=function(t){e.setState({confirm:t.target.value})},e.handleOk=function(){e.props.onOk()},e}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({confirm:""})}},{key:"render",value:function(){var e=this.props,a=e.resource,r=e.visible,n=e.onCancel,l=e.title,u=e.desc,o=e.isSubmitting,c=u||(a?1===a.split(", ").length?t.html("DELETE_RESOURCE_TYPE_DESC_SI",{resource:a,type:""}):t.html("DELETE_RESOURCE_TYPE_DESC_PL",{resource:a,type:""}):t.html("UPDATE_VERSION_DESC",{resource:a,type:""}));return i.default.createElement(p.default,{width:504,bodyClassName:m.default.modalBody,visible:r,isSubmitting:o,onCancel:n,hideHeader:!0,hideFooter:!0},i.default.createElement("div",{className:m.default.body},i.default.createElement("div",{className:"h5"},i.default.createElement(d.Icon,{name:"update",type:"light",className:m.default.closeIcon}),l||t("UPDATE_VERSION")),i.default.createElement("div",{className:m.default.content},i.default.createElement("p",null,c),a&&i.default.createElement(d.Input,{name:"confirm",value:this.state.confirm,onChange:this.handleInputChange,placeholder:a,autoFocus:!0}))),i.default.createElement("div",{className:m.default.footer},i.default.createElement(d.Button,{onClick:n,"data-test":"modal-cancel"},t("CANCEL")),i.default.createElement(d.Button,{type:"danger",loading:o,disabled:o||!!a&&this.state.confirm!==a,onClick:this.handleOk,"data-test":"modal-ok"},t("OK"))))}}]),r}(i.default.Component);a.default=v,v.propTypes={resource:f.default.string,visible:f.default.bool,title:f.default.oneOfType([f.default.string,f.default.node]),desc:f.default.oneOfType([f.default.string,f.default.node]),onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},v.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={modalBody:"dSVZHFsjnhedVNtz82AvW",body:"_2Mux1kpI6qcjYjhrMA0o9m",content:"_3dYpBTkEKI5yi-0GJv33vk",closeIcon:"_1DzCeDvGNINV5MBXfi4wr-",footer:"_15WXkPqTa6X7mFd75RF17q"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(87),r(14),r(8),r(13),r(9),r(4),r(21),r(30),r(73),r(46),r(139),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(58)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(31)),s=n(r(50));r(12),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(27),r(87),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40);var i=n(r(191)),f=n(r(798)),d=n(r(2857)),p=n(r(819)),m=n(r(822)),h=n(r(2859)),v=n(r(2865)),E=n(r(2867)),y=n(r(2868)),g=n(r(2923)),b=r(2925),S=n(r(2936)),_=n(r(119)),O=n(r(26)),C=n(r(67)),T=n(r(140)),R=n(r(68)),D=r(17),k=r(1165),N=r(902);function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=e.type.toLowerCase().split("parameterdefinition")[0],a=(0,O.default)(e,"defaultParameterValue.value"),r=e.name,n=(0,O.default)(e,"choices",[]),l={};switch(t){case"choice":l={name:r,value:a||n[0]};break;default:l={name:r,value:a}}return l}var w={"pipeline.create":{on:function(e){var a,r=e.store,n=e.cluster,l=e.devops,c=(e.workspace,e.module),d=e.success,m=e.formTemplate,h=(0,s.default)(e,["store","cluster","devops","workspace","module","success","formTemplate"]),v=f.default.open(P({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,N.updatePipelineParams)(a),(0,N.updatePipelineParamsInSpec)(a,l),e.next=4,r.createPipeline({data:a,devops:l,cluster:n});case 4:f.default.close(v),i.default.success({content:t("CREATE_SUCCESSFUL")}),d&&d();case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,module:c,cluster:n,devops:l,formTemplate:m,modal:p.default,steps:b.PIPELINE_PROJECT_CREATE_STEPS,noCodeEdit:!0},h))}},"pipeline.batch.delete":{on:function(e){var a,r=e.store,n=e.success,l=e.rowKey,c=e.devops,d=e.cluster,p=(0,s.default)(e,["store","success","rowKey","devops","cluster"]),h=(0,D.toJS)(r.list),v=h.data,E=h.selectedRowKeys,y=v.filter((function(e){return E.includes(e[l])})).map((function(e){return e.name})),g=f.default.open(P({onOk:(a=(0,o.default)(u.default.mark((function e(){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],v.forEach((function(e){y.includes(e.name)&&a.push(r.delete({name:e.name,devops:c,cluster:d}))})),e.next=4,Promise.all(a);case 4:f.default.close(g),i.default.success({content:t("DELETED_SUCCESSFULLY")}),r.setSelectRowKeys([]),n&&n();case 8:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),resource:y.join(", "),modal:m.default,store:r},p))}},"pipeline.batch.run":{on:function(e){return(0,o.default)(u.default.mark((function a(){var r,n,l,c,s,f,d,p,m,h;return u.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.store,n=e.success,l=e.rowKey,c=e.devops,s=e.cluster,f=(0,D.toJS)(r.list),d=f.data,p=f.selectedRowKeys,i.default.success({content:1===d.length?t("PIPELINE_RUN_START_SI"):t("PIPELINE_RUN_START_PL")}),m=d.filter((function(e){return p.includes(e[l])})).map((function(e){return e.name})),h=[],d.forEach(function(){var e=(0,o.default)(u.default.mark((function e(t){var a,n,l,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m.includes(t.name)){e.next=11;break}if(a=t.parameters,n=t.branchNames,l=(0,O.default)(n,"[0]",""),!n||(0,C.default)(n)){e.next=9;break}return e.next=7,r.getBranchDetail({branch:l,name:t.name,devops:c,cluster:s});case 7:o=e.sent,a=o.parameters||void 0;case 9:(0,C.default)(a)||(a=a.map((function(e){return A(e)}))),h.push(r.runBranch({name:t.name,devops:c,cluster:s,branch:l,parameters:a}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.next=8,Promise.all(h);case 8:i.default.success({content:1===d.length?t("BATCH_RUN_SUCCESS_SI"):t("BATCH_RUN_SUCCESS_PL")}),r.setSelectRowKeys([]),n&&n();case 11:case"end":return a.stop()}}),a)})))()}},"pipeline.edit":{on:function(e){var a=e.store,r=e.cluster,n=e.devops,c=e.success,d=e.formTemplate,p=(0,s.default)(e,["store","cluster","devops","success","formTemplate"]),m=null;if((0,O.default)(d,"multi_branch_pipeline")){var h=(0,O.default)(d,"multi_branch_pipeline"),E=(0,O.default)(h,"source_type"),y=(0,O.default)(h,"".concat(E,"_source.scm_id"));(0,R.default)(d,"multi_branch_pipeline.key",y),m=E;var g=k.omitRepoKeys[E].map((function(e){return"".concat(E,"_source.").concat(e)}));(0,R.default)(d,"__multi_branch_pipeline",(0,T.default)(h,["source_type"].concat((0,l.default)(g),["key"])))}var b,S=f.default.open(P({onOk:(b=(0,o.default)(u.default.mark((function e(l){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,N.resetPipelineMultiBranch)(l),(0,N.updatePipelineParams)(l,!0),(0,N.updatePipelineParamsInSpec)(l,n),e.next=5,a.updatePipeline({data:l,devops:n,cluster:r});case 5:f.default.close(S),i.default.success({content:t("UPDATE_SUCCESSFUL")}),c&&c();case 8:case"end":return e.stop()}}),e)}))),function(e){return b.apply(this,arguments)}),store:a,cluster:r,devops:n,provider:m,formTemplate:(0,_.default)(d),modal:v.default},p))}},"pipeline.advance.edit":{on:function(e){var a,r=e.store,n=e.cluster,l=e.devops,c=e.success,d=e.formTemplate,p=(0,s.default)(e,["store","cluster","devops","success","formTemplate"]),m=f.default.open(P({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,N.updatePipelineParams)(a,!0),(0,N.updatePipelineParamsInSpec)(a,l),e.next=4,r.updatePipeline({data:a,devops:l,cluster:n});case 4:f.default.close(m),i.default.success({content:t("UPDATE_SUCCESSFUL")}),c&&c();case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,cluster:n,devops:l,formTemplate:(0,_.default)(d),modal:h.default},p))}},"pipeline.params":{on:function(e){var a,r=e.store,n=e.success,l=e.devops,c=e.cluster,p=(0,s.default)(e,["store","success","devops","cluster"]),m=f.default.open(P({onOk:(a=(0,o.default)(u.default.mark((function e(a,o){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.default.success({content:"".concat(t("PIPELINE_RUN_START_SI"))}),e.next=3,r.runBranch({devops:l,name:p.params.name,branch:o,parameters:a,cluster:c});case 3:f.default.close(m),n&&n(o);case 5:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)}),store:r,devops:l,cluster:c,modal:d.default},p))}},"pipeline.scanRepositoryLogs":{on:function(e){var t,a=e.store,r=(e.success,(0,s.default)(e,["store","success"])),n=f.default.open(P({onOk:(t=(0,o.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.default.close(n);case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),modal:g.default,store:a},r))}},"pipeline.jenkins":{on:function(e){var a,r=e.store,n=e.params,l=e.defaultValue,c=e.success,d=(0,s.default)(e,["store","params","defaultValue","success"]),p=f.default.open(P({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.updateJenkinsFile(a,n);case 2:f.default.close(p),i.default.success({content:t("UPDATE_SUCCESSFUL")}),c&&c();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:S.default,defaultValue:l,params:n},d))}},"pipeline.pipelineCreate":{on:function(e){var a,r=e.store,n=(e.rootStore,e.success),l=e.jsonData,c=e.params,d=(0,s.default)(e,["store","rootStore","success","jsonData","params"]),p=f.default.open(P({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.updateJenkinsFile(a,c);case 2:f.default.close(p),i.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:y.default,jsonData:l,params:c,store:r},d))}},"pipeline.pipelineTemplateOld":{on:function(e){var t,a=e.store,r=(e.rootStore,e.success),n=e.jsonData,l=e.params,c=(0,s.default)(e,["store","rootStore","success","jsonData","params"]),i=f.default.open(P({onOk:(t=(0,o.default)(u.default.mark((function e(t){var n,o,c,s,d,p,m,h;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.jenkinsFile,"custom"===t.template){e.next=13;break}return o=t.paramsForm,c=void 0===o?{}:o,s=Object.keys(c).reduce((function(e,t){return e.push({name:t,value:c[t]}),e}),[]),e.next=6,a.getTempleJenkins(t.template,{parameters:s},{cluster:l.cluster});case 6:return d=e.sent,p=l.devops,m=l.name,h=l.cluster,e.next=10,a.checkScriptCompile({devops:p,pipeline:m,value:d,cluster:h});case 10:return e.next=12,a.convertJenkinsFileToJson(d,h);case 12:n=e.sent;case 13:f.default.close(i),r&&r(n);case 15:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),modal:p.default,steps:b.PIPELINE_CREATE_STEPS_OLD,jsonData:n,params:l,store:a},c))}},"pipeline.pipelineTemplate":{on:function(e){var t=e.store,a=(e.rootStore,e.success),r=e.jsonData,n=e.params,l=(e.pipelineDetailStore,(0,s.default)(e,["store","rootStore","success","jsonData","params","pipelineDetailStore"]));t.isSubmitting=!1;var c,i=f.default.open(P({onOk:(c=(0,o.default)(u.default.mark((function e(r){var l,o,c,s,d,p,m,h,v,E,y;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("custom"===r.template){e.next=17;break}return o=r.paramsForm,c=void 0===o?{}:o,s=Object.keys(c).reduce((function(e,t){return e.push({name:t,value:c[t]}),e}),[]),e.next=5,t.getTempleJenkins(r.template,{parameters:s},{cluster:n.cluster});case 5:return d=e.sent,p=n.devops,m=n.name,h=n.cluster,e.next=9,t.checkScriptCompile({devops:p,pipeline:m,value:d,cluster:h});case 9:return e.next=11,t.convertJenkinsFileToJson(d,h,p,m,!0);case 11:v=e.sent,E=v.mode,y=v.jsonData,l={jenkinsFile:d,jsonData:y,mode:E,template:r.template},e.next=18;break;case 17:l={jenkinsFile:"",json:{},mode:"raw",template:"custom"};case 18:f.default.close(i),a&&a(l);case 20:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),modal:p.default,steps:b.PIPELINE_CREATE_STEPS,jsonData:r,params:n,store:t},l))}},"pipeline.copy":{on:function(e){var a,r=e.store,n=e.cluster,l=e.devops,c=e.success,d=e.formTemplate,p=(0,s.default)(e,["store","cluster","devops","success","formTemplate"]),m=f.default.open(P({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,N.updatePipelineParams)(a,!0),(0,N.updatePipelineParamsInSpec)(a,l),Object.keys(a).forEach((function(e){"metadata"===e&&a[e]&&Object.keys(a[e]).forEach((function(t){"name"!==t&&"namespace"!==t&&delete a[e][t]}))})),e.next=5,r.createPipeline({data:a,devops:l,cluster:n});case 5:f.default.close(m),i.default.success({content:t("CREATE_SUCCESSFUL")}),c&&c();case 8:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,cluster:n,devops:l,success:c,formTemplate:d,modal:E.default},p))}}};a.default=w},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(10),r(6),r(70),r(20),r(320),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(10),r(6),r(70),r(121),r(20),r(27),r(320),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(73),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(38));r(35);var c,s,i,f=n(r(39)),d=n(r(25)),p=n(r(28)),m=n(r(41)),h=n(r(42)),v=n(r(37)),E=n(r(0)),y=n(r(1)),g=r(189),b=r(243),S=n(r(798)),_=n(r(142)),O=n(r(26)),C=n(r(67)),T=n(r(1009)),R=n(r(2858));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var I=(0,b.observer)((i=s=function(e){(0,m.default)(r,e);var a=N(r);function r(e){var t;return(0,d.default)(this,r),(t=a.call(this,e)).init=(0,f.default)(o.default.mark((function e(){var a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.branch){e.next=6;break}return e.next=3,t.getParametersFromBranch(t.branch);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=t.props.parameters;case 7:a=e.t0,t.setState({currentBranch:t.branch,parameters:a});case 9:case"end":return e.stop()}}),e)}))),t.handleOk=function(){var e=t.formRef.current.getData(),a=e.branch,r=(0,u.default)(e,["branch"]),n=t.state,l=n.parameters,o=n.currentBranch;t.formRef.current.validate((function(){!(0,C.default)(r)&&r.__branch&&(r.branch=r.__branch,delete r.__branch);var e=(0,C.default)(r)?!(0,C.default)(l)&&Array.isArray(l)?l.map((function(e){return{name:e.name,value:""}})):null:Object.keys(r).map((function(e){return{name:e,value:r[e]}}));t.props.onOk(e,a||o)}))},t.handleBranchChange=function(){var e=(0,f.default)(o.default.mark((function e(a){var r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getParametersFromBranch(a);case 2:r=e.sent,t.setState({currentBranch:a,parameters:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getParametersFromBranch=function(){var e=(0,f.default)(o.default.mark((function e(a){var r,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.params,e.next=3,t.store.getBranchDetail(k({branch:a},r));case 3:return n=e.sent,e.abrupt("return",(0,O.default)(n,"parameters",null));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.formRef=E.default.createRef(),t.store=new T.default,t.state={parameters:null,currentBranch:t.branch},t}return(0,p.default)(r,[{key:"componentDidMount",value:function(){this.init()}},{key:"componentDidUpdate",value:function(e){var t=this.props.visible;!e.visible&&t&&this.init()}},{key:"renderParamsItem",value:function(e){var t,a=(null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"").toLowerCase().split("parameterdefinition")[0],r=(0,O.default)(e,"defaultParameterValue.value");switch(a){case"string":return E.default.createElement(g.Form.Item,{key:e.name,label:e.name,desc:e.description},E.default.createElement(g.Input,{defaultValue:r,name:"branch"===e.name?"__branch":e.name}));case"text":return E.default.createElement(g.Form.Item,{key:e.name,label:e.name,desc:e.description},E.default.createElement(g.TextArea,{defaultValue:r,name:e.name}));case"boolean":return E.default.createElement(g.Form.Item,{key:e.name,label:e.name,desc:e.description},E.default.createElement(g.RadioGroup,{name:e.name,defaultValue:String(r)},E.default.createElement(g.Radio,{name:e.name,value:"true"},"True"),E.default.createElement(g.Radio,{name:e.name,value:"false"},"False")));case"choice":var n=(0,O.default)(e,"choices",[]),l=(0,O.default)(e,"defaultParameterValue.value","");return E.default.createElement(g.Form.Item,{key:e.name,label:e.name,desc:e.description},(0,C.default)(n)?E.default.createElement(g.Input,{name:e.name,defaultValue:l}):E.default.createElement(g.Select,{name:e.name,options:n.map((function(e){return{label:e,value:e}})),defaultValue:l||n[0]}));case"password":return E.default.createElement(g.Form.Item,{key:e.name,label:e.name,desc:e.description},E.default.createElement(g.Input,{defaultValue:r,type:"password",name:e.name}));default:return E.default.createElement(g.Form.Item,{key:e.name,label:e.name,desc:e.description},E.default.createElement(g.Input,{defaultValue:r,name:e.name}))}}},{key:"render",value:function(){var e=this,a=this.props,r=a.visible,n=a.onCancel,l=a.branches,u=this.state,o=u.parameters,c=u.currentBranch;return E.default.createElement(S.default,{width:680,onCancel:n,onOk:this.handleOk,visible:r,closable:!1,title:t("SET_PARAMETERS")},E.default.createElement(g.Form,{ref:this.formRef},(0,C.default)(l)?null:E.default.createElement(g.Form.Item,{label:t("BRANCH_SI"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},E.default.createElement(g.Select,{name:"branch",options:this.branchOptions,defaultValue:c,onChange:this.handleBranchChange})),(0,C.default)(o)?null:E.default.createElement("div",{className:R.default.desc},t("PARAMS_DESC")),Array.isArray(o)&&o.map((function(t){return e.renderParamsItem(t)}))))}},{key:"branch",get:function(){var e=this.props,t=e.branches,a=e.params,r=a?a.branch:"";return(0,C.default)(t)||(r=(0,O.default)(this.branchOptions,"[0].value")),r}},{key:"branchOptions",get:function(){var e=this.props,t=e.branches,a=e.params,r=e.disabledBrancheNames,n=void 0===r?[]:r,l=Array.isArray(t)?t.filter((function(e){return!n.includes(e)})).map((function(e){return{label:decodeURIComponent(e),value:e}})):[];return a&&a.branch&&(l=[{label:decodeURIComponent(a.branch),value:a.branch}]),l.sort((function(e,t){return(0,_.default)(e.value)&&["master","main"].includes(e.value.toLowerCase())?-1:(0,_.default)(t.value)&&["master","main"].includes(t.value.toLowerCase())?1:e.value<t.value?-1:e.value>t.value?1:0}))}}]),r}(E.default.Component),s.propTypes={name:y.default.string,branches:y.default.array},s.defaultProps={branches:[],visible:!1,name:"",onOk:function(){},onCancel:function(){}},c=i))||c;a.default=I},function(e,t,a){e.exports={desc:"_3eh_E2EhQNcWLy8V-DL0TU"}},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(6),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(6),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(798)),p=n(r(26)),m=n(r(1465));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=["discarder","timer_trigger","remote_trigger","regex_filter","multibranch_job_trigger"],E=function(e){(0,o.default)(r,e);var a=h(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).setEnableFlag=function(e){var a=e||{},r=a.pipeline,n=a.multi_branch_pipeline,l=r||n;l&&(v.forEach((function(t){var a=l[t]||(0,p.default)(l,"svn_source.".concat(t))||(0,p.default)(l,"git_source.".concat(t))||(0,p.default)(l,"github_source.".concat(t))||(0,p.default)(l,"gitlab_source.".concat(t))||(0,p.default)(l,"bitbucket_server_source.".concat(t))||(0,p.default)(l,"multibranch_job_trigger");(l[t]||a)&&(e["enable_".concat(t)]=!0)})),e.description=l.description,t.setState({formTemplate:e}))},t.handleOk=function(){var e=t.formRef&&t.formRef.current;e&&e.validate((function(){t.props.onOk(t.formRef.current.getData())}))},t.formRef=i.default.createRef(),t.state={formTemplate:{}},t}return(0,u.default)(r,[{key:"componentDidMount",value:function(){this.setEnableFlag(this.props.formTemplate)}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return i.default.createElement(d.default,{width:1162,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("EDIT_PIPELINE")},i.default.createElement(m.default,{type:"edit",formRef:this.formRef,formTemplate:this.state.formTemplate,devops:this.props.devops,cluster:this.props.cluster}))}}]),r}(i.default.Component);a.default=E,E.propTypes={name:f.default.string,branches:f.default.array},E.defaultProps={branches:[],visible:!1,onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(73),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(446),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(73),r(71),r(7);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(201)),d=n(r(140)),p=n(r(67)),m=n(r(0)),h=n(r(1)),v=r(189),E=r(61),y=n(r(2861)),g=n(r(1466));function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var O=function(e){(0,c.default)(r,e);var a=_(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleChange=function(t){var a=e.props,r=a.value;(0,a.onChange)(S(S({},r),t))},e.handleDelete=function(t){var a=e.props,r=a.value;(0,a.onChange)((0,d.default)(r,t))},e.handleMoreMenuClick=function(t,a){var r=e.props,n=r.value,l=r.onChange;if(!(0,f.default)(n,a))switch(a){case"discover_branches":l(S(S({},n),{},{discover_branches:1}));break;case"discover_pr_from_origin":l(S(S({},n),{},{discover_pr_from_origin:1}));break;case"discover_pr_from_forks":l(S(S({},n),{},{discover_pr_from_forks:{strategy:1,trust:2}}));break;case"discover_tags":l(S(S({},n),{},{discover_tags:!0}))}},e}return(0,o.default)(r,[{key:"renderMoreMenu",value:function(){var e=this,a=this.props.value,r=Object.keys(a);return m.default.createElement(v.Menu,{onClick:this.handleMoreMenuClick},!(0,p.default)(this.menuData)&&Object.keys(this.menuData).map((function(a){return m.default.createElement(v.Menu.MenuItem,{key:a,disabled:r.includes(a)},m.default.createElement(v.Icon,{name:"ticket"})," ",t(e.menuData[a].replace(/\s/g,"_").toUpperCase()))})))}},{key:"render",value:function(){var e=this,a=this.props,r=a.name,n=a.value;return m.default.createElement("div",null,m.default.createElement("div",{className:g.default.header},m.default.createElement(v.Dropdown,{theme:"dark",content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},m.default.createElement(v.Button,{type:"control"},t("ADD_STRATEGY")))),m.default.createElement("div",{className:g.default.content},Object.keys(this.menuData).filter(f.default.bind(this,n)).map((function(t,a){return m.default.createElement(y.default,{key:a,value:(0,l.default)({},t,n[t]),prefix:"".concat(r,"[").concat(a,"]"),onDelete:e.handleDelete.bind(e,t),onChange:e.handleChange,menuData:e.menuData})}))))}},{key:"menuData",get:function(){var e=this.props.sourceType;return["gitlab","github","bitbucket_server"].includes(e)?E.PIPELINE_ACTION_TYPES:{}}}]),r}(m.default.Component);a.default=O,O.propTypes={name:h.default.string,value:h.default.object,onChange:h.default.func,sourceType:h.default.string},O.defaultProps={name:"",value:{},sourceType:"",onChange:function(){}}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(71),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(71),r(7);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(1)),p=n(r(26)),m=n(r(808)),h=n(r(68)),v=r(189),E=n(r(1466));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var S=function(e){(0,c.default)(r,e);var a=b(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).triggerChange=(0,m.default)((function(t){e.props.onChange(t)}),500),e.handleChange=function(t){return function(a){var r=t.split(".");if(r.length>1){var n=(0,p.default)(e.props.value,r[0]);return n?(0,h.default)(n,r[1],a):n=(0,l.default)({},r[1],a),void e.triggerChange(g(g({},e.props.value),{},(0,l.default)({},r[0],n)))}e.triggerChange(g(g({},e.props.value),{},(0,l.default)({},t,a)))}},e}return(0,o.default)(r,[{key:"renderFormItems",value:function(e){var t=null;switch(e){case"discover_branches":t=this.renderBranchesFormItems();break;case"discover_pr_from_origin":t=this.renderPrOriginFormItems();break;case"discover_pr_from_forks":t=this.renderPrForkFormItems();break;default:t=this.renderTagBranchesFormItems()}return t}},{key:"renderTagBranchesFormItems",value:function(){var e=this.props.value;return f.default.createElement("div",null,f.default.createElement(v.Form.Item,{label:t("STRATEGY")},f.default.createElement(v.Select,{name:"discover_tags",defaultValue:e.discover_tags,onChange:this.handleChange("discover_tags"),options:[{label:t("ENABLE_TAG_BRANCH_DISCOVERY"),value:!0},{label:t("DISABLE_TAG_BRANCH_DISCOVERY"),value:!1}]})))}},{key:"renderBranchesFormItems",value:function(){var e=this.props.value;return f.default.createElement("div",null,f.default.createElement(v.Form.Item,{label:t("STRATEGY")},f.default.createElement(v.Select,{name:"discover_branches",defaultValue:e.discover_branches,onChange:this.handleChange("discover_branches"),options:[{label:t("EXCLUDE_PR_BRANCHES"),value:1},{label:t("ONLY_PR_BRANCHES"),value:2},{label:t("ALL_BRANCHES"),value:3}]})))}},{key:"renderPrOriginFormItems",value:function(){var e=this.props.value;return f.default.createElement("div",null,f.default.createElement(v.Form.Item,{label:t("PULL_STRATEGY")},f.default.createElement(v.Select,{name:"discover_pr_from_origin",defaultValue:e.discover_pr_from_origin,onChange:this.handleChange("discover_pr_from_origin"),options:[{label:t("OPTIONS_PR_PARAMS_1"),value:1},{label:t("OPTIONS_PR_PARAMS_2"),value:2},{label:t("OPTIONS_PR_PARAMS_3"),value:3}]})))}},{key:"renderPrForkFormItems",value:function(){var e=this.props.value;return f.default.createElement("div",null,f.default.createElement(v.Columns,null,f.default.createElement(v.Column,null,f.default.createElement(v.Form.Item,{label:t("PULL_STRATEGY")},f.default.createElement(v.Select,{name:"discover_pr_from_forks.strategy",defaultValue:e.discover_pr_from_forks&&e.discover_pr_from_forks.strategy,onChange:this.handleChange("discover_pr_from_forks.strategy"),options:[{label:t("OPTIONS_PR_PARAMS_1"),value:1},{label:t("OPTIONS_PR_PARAMS_2"),value:2},{label:t("OPTIONS_PR_PARAMS_3"),value:3}]}))),f.default.createElement(v.Column,null,f.default.createElement(v.Form.Item,{label:t("TRUSTED_USERS")},f.default.createElement(v.Select,{name:"discover_pr_from_forks.trust",defaultValue:e.discover_pr_from_forks&&e.discover_pr_from_forks.trust,onChange:this.handleChange("discover_pr_from_forks.trust"),options:[{label:t("CONTRIBUTORS"),value:1},{label:t("EVERYONE"),value:2},{label:t("USERS_WITH_PERMISSION"),value:3},{label:t("NOBODY"),value:4}]})))))}},{key:"render",value:function(){var e=this.props,a=e.value,r=e.onDelete,n=e.menuData,l=Object.keys(a)[0];return f.default.createElement("div",{className:E.default.itemWrapper},f.default.createElement("div",{className:E.default.itemTitle},f.default.createElement("p",null,f.default.createElement("strong",null,t(n[l].replace(/\s/g,"_").toUpperCase()))),f.default.createElement(v.Button,{className:E.default.delete,type:"flat",icon:"trash",onClick:r})),l&&this.renderFormItems(l))}}]),r}(f.default.Component);a.default=S,S.propTypes={value:d.default.object,onChange:d.default.func,onDelete:d.default.func},S.defaultProps={value:{},onChange:function(){},onDelete:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(20),r(14),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(29),r(446),r(14),r(9),r(4),r(18),r(43),r(11);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(67)),d=n(r(64)),p=n(r(26)),m=n(r(68)),h=n(r(0)),v=n(r(1)),E=r(189),y=r(61),g=n(r(2863)),b=n(r(1467));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=function(e){(0,c.default)(r,e);var a=S(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).handleDelete=function(t){var a=e.props,r=a.formTemplate,n=a.name;(0,m.default)(r,n,e.value.filter((function(e,a){return a!==t}))),e.forceUpdate()},e.handleMoreMenuClick=function(t,a){var r=e.props,n=r.formTemplate,u=r.name;(0,m.default)(n,u,[].concat((0,l.default)((0,d.default)(e.value)?e.value:[]),[{type:a}])),e.forceUpdate()},e}return(0,o.default)(r,[{key:"renderMoreMenu",value:function(){return h.default.createElement(E.Menu,{onClick:this.handleMoreMenuClick},Object.keys(y.PIPELINE_PARAMS_TYPES).map((function(e){return h.default.createElement(E.Menu.MenuItem,{key:e},h.default.createElement(E.Icon,{name:"ticket"})," ",t(y.PIPELINE_PARAMS_TYPES[e]))})))}},{key:"render",value:function(){var e=this,a=this.props.name;return h.default.createElement("div",{className:b.default.wrapper},h.default.createElement("div",{className:b.default.header},h.default.createElement(E.Dropdown,{theme:"dark",content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},h.default.createElement(E.Button,{type:"control"},t("ADD")))),h.default.createElement("div",{className:b.default.content},(0,f.default)(this.value)&&h.default.createElement("p",{className:"text-center padding-12"},t("NO_DATA")),(0,d.default)(this.value)&&this.value.map((function(t,r){return h.default.createElement(g.default,{key:r,value:t,prefix:"".concat(a,"[").concat(r,"]"),onDelete:e.handleDelete.bind(e,r)})}))))}},{key:"value",get:function(){return(0,p.default)(this.props.formTemplate,this.props.name,[])}}]),r}(h.default.Component);a.default=_,_.propTypes={name:v.default.string,value:v.default.array,onChange:v.default.func},_.defaultProps={name:"",value:[],onChange:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(29),r(14),r(9),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=r(61),m=n(r(1467));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"renderFormItems",value:function(e){var t=null;switch(e){case"string":t=this.renderStringFormItems();break;case"text":t=this.renderTextFormItems();break;case"boolean":t=this.renderBooleanFormItems();break;case"choice":t=this.renderChoiceFormItems();break;case"password":t=this.renderPasswordFormItems()}return t}},{key:"renderStringFormItems",value:function(){var e=this.props.value;return i.default.createElement("div",null,i.default.createElement(d.Columns,null,i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("PARAMETER_NAME_EMPTY_DESC")}]},i.default.createElement(d.Input,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name}))),i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("DEFAULT_VALUE"),desc:t("PIPELINE_PARAM_DEFAULT_DESC")},i.default.createElement(d.Input,{name:"".concat(this.props.prefix,".default_value"),defaultValue:e.default_value||""})))),i.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("PARAMETER_DESCRIPTION_DESC")},i.default.createElement(d.TextArea,{className:"max-width-full",name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"renderTextFormItems",value:function(){var e=this.props.value;return i.default.createElement("div",null,i.default.createElement(d.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("PARAMETER_NAME_EMPTY_DESC")}]},i.default.createElement(d.Input,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name})),i.default.createElement(d.Form.Item,{label:t("DEFAULT_VALUE")},i.default.createElement(d.TextArea,{className:"max-width-full",name:"".concat(this.props.prefix,".default_value"),defaultValue:e.default_value||""})),i.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("PARAMETER_DESCRIPTION_DESC")},i.default.createElement(d.TextArea,{className:"max-width-full",name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"renderBooleanFormItems",value:function(){var e=this.props.value;return i.default.createElement("div",null,i.default.createElement(d.Columns,null,i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("PARAMETER_NAME_EMPTY_DESC")}]},i.default.createElement(d.Input,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name}))),i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("DEFAULT_VALUE")},i.default.createElement(d.RadioGroup,{name:"".concat(this.props.prefix,".default_value"),defaultValue:JSON.parse(e.default_value||"true")},i.default.createElement(d.Radio,{value:"true"},"True"),i.default.createElement(d.Radio,{value:"false"},"False"))))),i.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("PARAMETER_DESCRIPTION_DESC")},i.default.createElement(d.TextArea,{className:"max-width-full",name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"renderChoiceFormItems",value:function(){var e=this.props.value;return i.default.createElement("div",null,i.default.createElement(d.Columns,null,i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("PARAMETER_NAME_EMPTY_DESC")}]},i.default.createElement(d.Input,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name}))),i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("OPTIONS"),desc:t("CHOICE_PARAM_OPTION_DESC")},i.default.createElement(d.TextArea,{className:"max-width-full",name:"".concat(this.props.prefix,".default_value"),defaultValue:e.choice})))),i.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("PARAMETER_DESCRIPTION_DESC")},i.default.createElement(d.TextArea,{className:"max-width-full",name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"renderPasswordFormItems",value:function(){var e=this.props.value;return i.default.createElement("div",null,i.default.createElement(d.Columns,null,i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},i.default.createElement(d.Input,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name}))),i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("PASSWORD")},i.default.createElement(d.Input,{name:"".concat(this.props.prefix,".default_value"),type:"password",defaultValue:e.default_value||""})))),i.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("PARAMETER_DESCRIPTION_DESC")},i.default.createElement(d.TextArea,{name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"render",value:function(){var e=this.props,a=e.value,r=e.onDelete;return i.default.createElement("div",{className:m.default.itemWrapper},i.default.createElement("div",{className:m.default.itemTitle},i.default.createElement("p",null,i.default.createElement("strong",null,"PARAMS_TEXT"===p.PIPELINE_PARAMS_TYPES[a.type]?t("PARAMS_TEXT_TCAP"):t(p.PIPELINE_PARAMS_TYPES[a.type]))),i.default.createElement(d.Button,{className:m.default.delete,type:"flat",icon:"trash",onClick:r})),a.type&&this.renderFormItems(a.type))}}]),r}(i.default.Component);a.default=v,v.propTypes={value:f.default.object,onChange:f.default.func,onDelete:f.default.func},v.defaultProps={value:{},onChange:function(){},onDelete:function(){}}},function(e,t,a){e.exports={advance:"CL0stuq5jSYOBJiO8mU2C",wrapper:"XW_-pU8ZwuxgGpjgUHW-8"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(21),r(18),r(43),r(11);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(1)),m=r(189),h=n(r(798)),v=n(r(26)),E=n(r(1407)),y=n(r(1066));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=function(e){(0,s.default)(r,e);var a=g(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.hideSelectRepo=function(){t.setState({showSelectRepo:!1})},t.showSelectRepo=function(){t.setState({showSelectRepo:!0})},t.handleOk=(0,u.default)(l.default.mark((function e(){var a,r;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.onOk,r=t.form.current.getData(),e.next=4,a(r);case 4:t.state.subRoute&&t.props.handleScanRepository();case 5:case"end":return e.stop()}}),e)}))),t.form=d.default.createRef(),t.scmRef=d.default.createRef(),t.state={showSelectRepo:!1,repo:{}},t}return(0,c.default)(r,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.formTemplate,l=void 0===n?{}:n,u=(0,v.default)(l,"pipeline.name","")||(0,v.default)(l,"multi_branch_pipeline.name",""),o=(0,v.default)(l,"pipeline.description","")||(0,v.default)(l,"multi_branch_pipeline.description","");return this.state.showSelectRepo?d.default.createElement(h.default,{width:1e3,hideHeader:!0,onOk:this.handleSaveRepo,visible:a},d.default.createElement(E.default,{sourceData:l.multi_branch_pipeline,devops:l.devops,cluster:l.cluster,name:u,onSave:this.handleRepoChange,onCancel:this.hideSelectRepo,enableTypeChange:!1})):d.default.createElement(h.default,{width:691,title:t("EDIT_INFORMATION"),icon:"pen",onOk:this.handleOk,onCancel:r,visible:a},d.default.createElement(m.Form,{ref:this.form,data:l},d.default.createElement(m.Form.Item,{label:t("NAME"),desc:t("")},d.default.createElement(m.Input,{name:"name",defaultValue:u,disabled:!0})),d.default.createElement(m.Form.Item,{label:t("DESCRIPTION"),desc:t("")},d.default.createElement(m.TextArea,{name:"description",defaultValue:o})),l.multi_branch_pipeline?d.default.createElement(m.Form.Item,{label:t("CODE_REPOSITORY")},d.default.createElement(y.default,{name:"multi_branch_pipeline",cluster:l.cluster,devops:l.devops,isCreatePipeline:!0,trigger:this.props.trigger})):null))}}]),r}(d.default.Component);a.default=b,b.propTypes={formTemplate:p.default.object,visible:p.default.bool,onOk:p.default.func,onCancel:p.default.func},b.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},b.childContextTypes={registerSubRoute:p.default.func,resetSubRoute:p.default.func}},function(e,t,a){e.exports={option:"_3mIiIau0E55cqSsXvtolhg",select:"_34FEBq7gI9Px86nIWbr_Pt","multi-repo":"_2nIdZAqBbg0vOZn6U8y_f-"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798)),m=r(61);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(e){var n;return(0,l.default)(this,r),(n=a.call(this,e)).handleOk=function(){var e=n.props.onOk,t=n.form.current;t&&t.validate((function(){var a=t.getData();e(a)}))},n.validator=function(e,a,r){if(!a)return r();n.props.store.checkPipelineName({name:a,cluster:n.props.cluster,devops:n.props.devops}).then((function(a){if(a.exist)return r({field:e.field,message:t("NAME_EXIST_DESC")});r()}))},n.form=i.default.createRef(),n}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.title,l=e.icon,u=e.formTemplate,o=void 0===u?{}:u;return i.default.createElement(p.default,{width:691,title:n,icon:l,onOk:this.handleOk,onCancel:r,visible:a},i.default.createElement(d.Form,{ref:this.form,data:o},i.default.createElement(d.Form.Item,{label:t("NAME"),desc:t("PIPELINE_NAME_DESC"),rules:[{required:!0,message:t("PIPELINE_NAME_TIP")},{pattern:m.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.validator}]},i.default.createElement(d.Input,{name:"name",maxLength:63})),i.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},i.default.createElement(d.TextArea,{name:"description",maxLength:256}))))}}]),r}(i.default.Component);a.default=v,v.propTypes={formTemplate:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func},v.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(31)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(1)),m=n(r(798)),h=n(r(822)),v=n(r(1187)),E=n(r(5)),y=n(r(67)),g=n(r(2922));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=function(e){(0,s.default)(r,e);var a=b(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).hideConfirm=function(){t.setState({isshowComfirm:!1})},t.showConfirm=function(){t.setState({isshowComfirm:!0})},t.handleCancel=function(){t.hideConfirm();var e=t.props.params,a=e.devops,r=e.name;localStorage.removeItem("".concat(globals.user.username,"-").concat(a,"-").concat(r)),t.props.onCancel()},t.CLIENT_WIDTH=document.body.clientWidth,t.state={isshowComfirm:!1,createPipelineType:(0,y.default)(t.props.jsonData)?void 0:"custom",jsonData:t.props.jsonData},t}return(0,c.default)(r,[{key:"renderPipelineContent",value:function(){var e=this.props,t=e.params,a=e.isSubmitting,r=e.onOk,n=this.state.jsonData;return d.default.createElement(v.default,{className:g.default.content,isEditMode:!0,params:t,jsonData:n,onOk:r,onCancel:this.showConfirm,isSubmitting:a,trigger:this.props.trigger})}},{key:"render",value:function(){var e=this.props.visible,a=this.state.createPipelineType,r=!(0,y.default)(a),n={hideHeader:r,closable:!r,title:t("CREATE_PIPELINE"),imageIcon:"/extensions-static/ks-console-embed/dist/v3dist/assets/pipeline/pipeline-icon-dark.svg",description:t("CREATE_PIPELINE_DESC")};return d.default.createElement(d.default.Fragment,null,d.default.createElement(m.default,(0,l.default)({width:a?Math.max(this.CLIENT_WIDTH-40,1200):"1400px",bodyClassName:(0,E.default)(g.default.body,(0,u.default)({},g.default.templeHeight,!a)),headerClassName:g.default.header,visible:e,closable:!1,maskClosable:!1,onOk:this.props.onOk,onCancel:this.showConfirm,hideFooter:!0},n),this.renderPipelineContent()),d.default.createElement(h.default,{visible:this.state.isshowComfirm,onCancel:this.hideConfirm,onOk:this.handleCancel,title:t("CLOSE"),desc:t("Are you sure to close this pipeline Editor ?")}))}}]),r}(d.default.Component);a.default=S,S.propTypes={name:p.default.string,module:p.default.string,store:p.default.object,formTemplate:p.default.object,visible:p.default.bool,onOk:p.default.func,onCancel:p.default.func,jsonData:p.default.object,isSubmitting:p.default.bool},S.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(20),a(51),a(14),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(51),a(29),a(14),a(8),a(4),a(18),a(43),a(11);var n,l,u,o,c,s,i,f=r(a(58)),d=r(a(62)),p=r(a(25)),m=r(a(28)),h=r(a(74)),v=r(a(41)),E=r(a(42)),y=r(a(37)),g=r(a(45)),b=(r(a(63)),r(a(0))),S=a(17),_=a(243),O=r(a(2870)),C=r(a(2872));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,y.default)(e);if(t){var n=(0,y.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,E.default)(this,a)}}var R=(0,_.observer)((i=s=function(e){(0,v.default)(a,e);var t=T(a);function a(){var e;(0,p.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return e=t.call.apply(t,[this].concat(n)),(0,d.default)(e,"heights",u,(0,h.default)(e)),e.handleAddBranch=function(t){return function(){e.props.store.handleAddBranch(t)}},e.onInsertColumn=function(t){e.props.store.insertColumn(t)},e.handleFocus=function(t){return function(a){e.props.store.setFocus(t,a)}},(0,d.default)(e,"onAddStep",o,(0,h.default)(e)),(0,d.default)(e,"setHeight",c,(0,h.default)(e)),e}return(0,m.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.stages,r=t.isEditMode;return!a.length&&r?b.default.createElement(C.default,{onInsertColumn:this.onInsertColumn,isEditMode:r,index:-1,heights:[]}):b.default.createElement(b.default.Fragment,null,b.default.createElement(C.default,{onInsertColumn:this.onInsertColumn,isEditMode:r,index:-1,heights:this.sumHeights}),a.map((function(t,a){return b.default.createElement(b.default.Fragment,{key:"".concat(t.name).concat(a)},b.default.createElement(O.default,{onAddBranch:e.handleAddBranch(a),onAddStep:e.onAddStep,isEditMode:r,nodes:(0,S.toJS)(t),index:a,setHeight:e.setHeight(a),onFocus:e.handleFocus(a)}),b.default.createElement(C.default,{onInsertColumn:e.onInsertColumn,isEditMode:r,index:a,heights:e.sumHeights}))})))}},{key:"sumHeights",get:function(){var e=this.props.stages,t=void 0===e?[]:e;return this.heights.slice(0,t.length).map((function(e){var t=0;return e.map((function(e){return t+=e}))}))}}]),a}(b.default.Component),s.defaultProps={},l=i,u=(0,g.default)(l.prototype,"heights",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,g.default)(l.prototype,"sumHeights",[S.computed],Object.getOwnPropertyDescriptor(l.prototype,"sumHeights"),l.prototype),o=(0,g.default)(l.prototype,"onAddStep",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.store.isAddingStep=!0}}}),c=(0,g.default)(l.prototype,"setHeight",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){var r=(0,f.default)(e.heights);r[t]=a,e.heights=r}}}}),n=l))||n;t.default=R},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(141),r(29),r(14),r(120),r(4),r(18),r(43),r(11);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(17),p=r(189),m=n(r(5)),h=n(r(26)),v=n(r(2871)),E=n(r(67)),y=n(r(811)),g=n(r(119)),b=r(1188),S=n(r(966));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var O={echo:"loudspeaker",mail:"mail",shell:"terminal",sh:"terminal",container:"terminal",checkout:"network-router",git:"network-router",withCredentials:"key",kubernetesDeploy:"kubernetes",branch:"network-router",timeout:"clock",withSonarQubeEnv:"network"},C=function(e){(0,c.default)(r,e);var a=_(r);function r(e){var n;return(0,u.default)(this,r),(n=a.call(this,e)).handleAddStep=function(){n.props.onAddStep()},n.handleFocus=function(e){return function(t){n.props.isEditMode&&(t.stopPropagation(),n.props.onFocus(e))}},n.renderNestStages=function(e){return n.props.isEditMode?f.default.createElement("div",{className:S.default.errorTip},t("not support edit nested stage")):!(0,E.default)(e)&&(0,d.isObservableArray)(e)?f.default.createElement("div",{className:S.default.nestStage_content},f.default.createElement("div",{className:S.default.indentBorder}),f.default.createElement("div",{className:S.default.nestsStage_detail},e.map((function(e){return n.renderCardContent(e)})))):void 0},n.renderSteps=function(e,a){if(e&&e.length)return e.map((function(e,r){return f.default.createElement("div",{key:JSON.stringify(e)+r,className:S.default.pipelineCard__item},f.default.createElement("div",{className:(0,m.default)(S.default.content__title,S.default.content__title__noDetail,(0,l.default)({},S.default.content__title__error,a&&a.index===r))},f.default.createElement(p.Icon,{size:20,name:O[e.name]||"cdn"}),f.default.createElement("span",{className:S.default.content__title__text},t(e.name))),"sh"===e.name||"script"===e.name?f.default.createElement("div",{className:S.default.content__text},(0,b.renderStepArgs)((0,d.toJS)(e))):null,n.renderSteps(e.children))}))},n.domTree=[],n.heights=[],n.nodes=(0,d.toJS)(n.props.nodes),n}return(0,o.default)(r,[{key:"shouldComponentUpdate",value:function(e){var t=(0,d.toJS)(e.nodes);return!(0,y.default)(t,this.nodes)&&(this.nodes=(0,g.default)(t),!0)}},{key:"componentDidMount",value:function(){this.calculateHeight()}},{key:"componentDidUpdate",value:function(){this.calculateHeight()}},{key:"calculateHeight",value:function(){var e=(0,v.default)(this.domTree.map((function(e){return e&&e.clientHeight})),null);JSON.stringify(e)!==JSON.stringify(this.heights)&&(this.heights=e,this.props.setHeight(this.heights))}},{key:"renderAddBranchCard",value:function(){return f.default.createElement("div",{className:S.default.addBranchCard,onClick:this.props.onAddBranch},f.default.createElement(p.Icon,{size:16,name:"add"}),f.default.createElement("span",null,t("Add Parallel Stage")))}},{key:"renderConditions",value:function(e){return e.when?f.default.createElement("div",{className:S.default.conditions},f.default.createElement("p",{className:S.default.conditions__title},t("pipeline_conditions")),this.renderSteps(e.when.conditions,e.conditionError)):null}},{key:"renderCard",value:function(e,a){var r,n=this.props.isEditMode;return f.default.createElement("div",{className:(0,m.default)(S.default.pipelineCard,{"pipelineCard-edit":n}),onClick:this.handleFocus(a)},f.default.createElement("div",{className:(0,m.default)(S.default.pipelineCard__title,(0,l.default)({},S.default["pipelineCard__title-error"],e.error))},e.name||t("Unnamed")),f.default.createElement("div",{className:(0,m.default)(S.default.pipelineCard__content,(r={},(0,l.default)(r,S.default["pipelineCard-active"],e.isActive),(0,l.default)(r,S.default["pipelineCard-error"],e.error),r))},this.renderCardContent(e)))}},{key:"renderCardContent",value:function(e){var a=this.props.isEditMode,r=!!e.stages;return f.default.createElement(f.default.Fragment,null,e.error||e.conditionError?f.default.createElement("div",{className:S.default.errorTip},t((0,h.default)(e,"error.error")||(0,h.default)(e,"conditionError.error"))||t("Configuration error")):null,this.renderConditions(e,e.conditionError),e.stages?this.renderNestStages(e.stages):this.renderSteps((0,h.default)(e,"branches[0].steps"),e.error),a&&!r?f.default.createElement("div",{className:S.default.addSteps,onClick:this.handleAddStep},f.default.createElement(p.Icon,{size:16,name:"add"}),f.default.createElement("span",null,t("Add Step"))):null)}},{key:"render",value:function(){var e=this,t=this.props,a=t.nodes,r=t.isEditMode;return a.parallel?f.default.createElement("div",{className:S.default.pipeline_column,"data-card":"card"},a.parallel.map((function(t,a){return f.default.createElement("div",{key:JSON.stringify(t),ref:function(t){e.domTree[a]=t}},e.renderCard(t,a))})),r?this.renderAddBranchCard():null):f.default.createElement("div",{className:S.default.pipeline_column,"data-card":"card"},f.default.createElement("div",{ref:function(t){e.domTree=[t]}},this.renderCard(a,0)),r?this.renderAddBranchCard():null)}}]),r}(f.default.Component);a.default=C},,function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(27),a(29),a(4),a(18),a(43),a(11);var n=r(a(58)),l=r(a(25)),u=r(a(28)),o=r(a(41)),c=r(a(42)),s=r(a(37)),i=r(a(0)),f=r(a(64)),d=r(a(67)),p=r(a(2873));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(a,e);var t=m(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,u=new Array(r),o=0;o<r;o++)u[o]=arguments[o];return(e=t.call.apply(t,[this].concat(u))).getMaxHeight=function(){var t=e.props,a=t.heights,r=t.index;return Math.max.apply(Math,[].concat((0,n.default)(a[r]||[]),(0,n.default)(a[r+1]||[])))},e.onInsertColumn=function(t){return function(){e.props.onInsertColumn(t)}},e.renderLines=function(t,a){return(0,f.default)(t)?t.map((function(r,n){return n===t.length-1?null:i.default.createElement(i.default.Fragment,{key:n},e.renderLine(r,a))})):null},e.renderEditLines=function(){var t=e.props,a=t.heights,r=t.index,n=t.isEditMode,l=[];if(!(0,f.default)(a)||!n)return null;if((0,f.default)(a[r])&&!(0,d.default)(a[r])){var u=a[r],o=u.length,c=u.last,s=void 0===c?o-1:c;l.push(e.renderLine(a[r][s]-50,"left",!0))}if((0,f.default)(a[r+1])&&!(0,d.default)(a[r+1])){var i=a[r+1],p=i.length,m=i.last,h=void 0===m?p-1:m;l.push(e.renderLine(a[r+1][h]-50,"right",!0))}return l},e}return(0,u.default)(a,[{key:"getRightLinePath",value:function(e){return e?(e+=-4,"M".concat(35," ").concat(6,"  V ").concat(e-10," Q ").concat(35,", ").concat(e," ").concat(45,", ").concat(e," H ").concat(64)):"M ".concat(35," ").concat(6," H ").concat(64)}},{key:"getLeftLinePath",value:function(e){return e?(e+=-4,"M".concat(6," ").concat(e," H ").concat(25," Q ").concat(35,",").concat(e," ").concat(35,",").concat(e-10," V ").concat(6)):"M".concat(6," ").concat(6," H ").concat(35)}},{key:"renderEditButton",value:function(){var e=this.props,t=e.index;if(e.isEditMode)return i.default.createElement("g",{className:p.default.editButton},i.default.createElement("circle",{cx:35,cy:6,r:"10",stroke:"#d8dee5",strokeDasharray:"3,3",fill:"white",strokeWidth:2,onClick:this.onInsertColumn(t+1)}),i.default.createElement("line",{x1:30,x2:40,y1:6,y2:6,stroke:"black"}),i.default.createElement("line",{x1:35,x2:35,y1:1,y2:11,stroke:"black"}))}},{key:"renderLine",value:function(e,t,a){return"left"===t?i.default.createElement("path",{key:"left-".concat(this.props.index),d:this.getLeftLinePath(e),stroke:a?"#d8dee5":"black",strokeWidth:2,fill:"none",markerStart:"url(#path-marker-".concat(a?"grey":"black",")"),markerEnd:"url(#path-marker-".concat(a?"grey":"black",")")}):i.default.createElement("path",{key:"right-".concat(this.props.index),d:this.getRightLinePath(e),stroke:a?"#d8dee5":"black",strokeWidth:2,fill:"none",markerStart:"url(#path-marker-".concat(a?"grey":"black",")"),markerEnd:"url(#path-marker-".concat(a?"grey":"black",")")})}},{key:"renderFirstLines",value:function(){return i.default.createElement(i.default.Fragment,null,this.renderLine(0,"right"),this.renderLine(0,"left"))}},{key:"renderBoldLines",value:function(){var e=this.props,t=e.heights,a=e.index;return i.default.createElement(i.default.Fragment,null,this.renderLines(t[a],"left"),this.renderLines(t[a+1],"right"))}},{key:"renderEdges",value:function(){return i.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg"},i.default.createElement("defs",null,i.default.createElement("marker",{id:"path-marker-black",viewBox:"0 0 12 12",refX:"6",refY:"6",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},i.default.createElement("circle",{cx:6,cy:6,r:5,fill:"#329dce"})),i.default.createElement("marker",{id:"path-marker-grey",viewBox:"0 0 12 12",refX:"6",refY:"6",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},i.default.createElement("circle",{cx:6,cy:6,r:5,fill:"#d8dee5"}))),this.renderEditLines(),this.renderBoldLines(),this.renderFirstLines(),this.renderEditButton())}},{key:"render",value:function(){var e=this.props,t=e.heights,a=e.index,r=e.posision,n=e.isEditMode;return n||a!==t.length-1?i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:p.default.connects__column,style:{height:"".concat(this.getMaxHeight()+32,"px")}},this.renderEdges(),n&&!a&&"Right"===r?this.renderEditButton():null)):i.default.createElement("div",{className:p.default.connects__column})}}]),a}(i.default.Component);t.default=h},function(e,t,a){e.exports={connects__column:"_2vvBGS23XmT5sAwppCC8tF",editButton:"PnGDJ8pHWNAj86cz9vAV1"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(87),r(8),r(9),r(4),r(21),r(200),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(121),r(20),r(27),r(87),r(29),r(8),r(9),r(4),r(21),r(200),r(18),r(43),r(11);var l=n(r(38));r(35);var u,o,c,s,i,f,d,p,m,h,v=n(r(39)),E=n(r(62)),y=n(r(25)),g=n(r(28)),b=n(r(74)),S=n(r(41)),_=n(r(42)),O=n(r(37)),C=n(r(45)),T=(n(r(63)),r(189)),R=n(r(26)),D=n(r(68)),k=r(17),N=r(243),I=n(r(0)),P=r(56),A=n(r(1189)),w=r(2875),L=n(r(935));function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,O.default)(e);if(t){var n=(0,O.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,_.default)(this,a)}}var x=[{label:"Any",value:"any"},{label:"node",value:"node"},{label:"kubernetes",value:"kubernetes"}],j=(0,N.observer)((o=function(e){(0,S.default)(r,e);var a=M(r);function r(){var e;(0,y.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return e=a.call.apply(a,[this].concat(u)),(0,E.default)(e,"stageName",c,(0,b.default)(e)),(0,E.default)(e,"formData",s,(0,b.default)(e)),(0,E.default)(e,"showYaml",i,(0,b.default)(e)),(0,E.default)(e,"loading",f,(0,b.default)(e)),(0,E.default)(e,"handleSetYaml",d,(0,b.default)(e)),(0,E.default)(e,"hideYamlEditor",p,(0,b.default)(e)),(0,E.default)(e,"showEditor",m,(0,b.default)(e)),e.handleDelete=function(){e.props.store.deleteStage()},e.handleCancel=function(){e.props.onCancel()},(0,E.default)(e,"handleAgentTypeChange",h,(0,b.default)(e)),e.handleConfirm=(0,v.default)(l.default.mark((function t(){var a;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.getAgentArguments(),e.loading=!0,t.next=4,e.props.store.saveJenkinsFile(e.props.store.params);case 4:(a=t.sent)&&e.props.onOk(a);case 6:case"end":return t.stop()}}),t)}))),e.handleConfirmOld=(0,v.default)(l.default.mark((function t(){var a;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.getAgentArguments(),e.loading=!0,t.next=4,e.props.store.convertJsonToJenkinsFile(e.props.store.params).finally((function(){e.loading=!1}));case 4:(a=t.sent)&&"success"===(0,R.default)(a,"data.result")&&e.props.onOk((0,R.default)(a,"data.jenkinsfile",""));case 6:case"end":return t.stop()}}),t)}))),e.renderAgentForms=function(){var a=(0,k.toJS)(e.labelDataList),r=(0,R.default)(a,"0.value","");switch(e.agentType){case"node":return I.default.createElement(T.Form,{data:e.formData,ref:e.formRef},I.default.createElement(T.Form.Item,{label:t("label"),desc:t("The label on which to run the Pipeline or individual stage")},I.default.createElement(T.Select,{name:"label",options:a,defaultValue:r})));case"kubernetes":return I.default.createElement(T.Form,{data:e.formData,ref:e.formRef},I.default.createElement(T.Form.Item,{label:t("label"),desc:t("")},I.default.createElement(T.Input,{name:"label"})),I.default.createElement(T.Form.Item,{label:t("yaml"),desc:I.default.createElement("span",{className:L.default.clickable,onClick:e.showEditor},t("show yaml editor"))},I.default.createElement(T.Input,{name:"yaml"})),I.default.createElement(T.Form.Item,{label:t("defaultContainer"),desc:t("")},I.default.createElement(T.Input,{name:"defaultContainer"})));default:return null}},e}return(0,g.default)(r,[{key:"componentDidMount",value:function(){var e=(0,k.toJS)((0,R.default)(this.props.store.jsonData,"json.pipeline.agent.arguments",[]));this.formData=e.reduce((function(e,t){if(Array.isArray(t.value)){var a=t.value.reduce((function(e,t){var a={};return a[t.key]=t.value.value,e.push(a),e}),[]);e[t.key]=a}else e[t.key]=t.value.value;return e}),{})}},{key:"getAgentArguments",value:function(){var e=this,t=Object.keys(this.formData).map((function(t){var a=(0,k.toJS)(e.formData[t]);return Array.isArray(a)?{key:t,value:a.map((function(e){return Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}))[0]}))}:{key:t,value:{isLiteral:!0,value:a}}}));(0,D.default)(this.props.store.jsonData,"json.pipeline.agent.arguments",t)}},{key:"render",value:function(){var e=this.props.store,a=e.activeStage,r=e.jsonData.json.pipeline,n=void 0===r?{}:r,l=this.props.isSubmitting,u=this.StepsEditor;return I.default.createElement("div",{className:L.default.sider},I.default.createElement("div",{className:L.default.sheet},I.default.createElement("div",{className:L.default.title},t("AGENT")),I.default.createElement(T.Form.Item,{desc:t("AGENT_TYPE_DESC"),label:t("TYPE")},I.default.createElement(T.Select,{options:x,value:n.agent.type,onChange:this.handleAgentTypeChange})),this.renderAgentForms(),I.default.createElement("div",{className:L.default.footer},I.default.createElement(T.Button,{onClick:this.handleCancel},t("CANCEL")),I.default.createElement(T.Button,{disabled:!n||!n.stages.length,loading:l||this.loading,type:"control",onClick:this.isOld?this.handleConfirmOld:this.handleConfirm},t("OK")))),a?I.default.createElement("div",{className:L.default.content},I.default.createElement(u,{activeStage:a,store:this.props.store,trigger:this.props.trigger})):null,I.default.createElement(A.default,{value:this.formData.yaml||"",visible:this.showYaml,onCancel:this.hideYamlEditor,onOk:this.handleSetYaml}))}},{key:"agentType",get:function(){return(0,R.default)(this.props.store.jsonData,"json.pipeline.agent.type","")}},{key:"ksVersion",get:function(){var e,t,a=this.props.cluster;return(null===(e=window.parent)||void 0===e||null===(t=e.globals)||void 0===t?void 0:t.app.isMultiCluster)?(0,R.default)(window,"parent.globals.clusterConfig.".concat(a,".ksVersion")):(0,R.default)(window,"parent.globals.ksConfig.ksVersion")}},{key:"isOld",get:function(){return(0,P.compareVersion)(this.ksVersion,"3.4.0")<0}},{key:"labelDataList",get:function(){return(0,R.default)(this.props.store,"labelDataList",[])}},{key:"StepsEditor",get:function(){return(0,w.getStepsEditor)(this.ksVersion)}}]),r}(I.default.Component),c=(0,C.default)(o.prototype,"stageName",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=(0,C.default)(o.prototype,"formData",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),i=(0,C.default)(o.prototype,"showYaml",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=(0,C.default)(o.prototype,"loading",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=(0,C.default)(o.prototype,"handleSetYaml",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.formData.yaml=t,e.showYaml=!1}}}),p=(0,C.default)(o.prototype,"hideYamlEditor",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showYaml=!1}}}),m=(0,C.default)(o.prototype,"showEditor",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showYaml=!0}}}),(0,C.default)(o.prototype,"agentType",[k.computed],Object.getOwnPropertyDescriptor(o.prototype,"agentType"),o.prototype),(0,C.default)(o.prototype,"labelDataList",[k.computed],Object.getOwnPropertyDescriptor(o.prototype,"labelDataList"),o.prototype),h=(0,C.default)(o.prototype,"handleAgentTypeChange",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.formData={},(0,D.default)(e.props.store.jsonData,"json.pipeline.agent.type",t)}}}),u=o))||u;a.default=j},function(e,t,a){"use strict";a(16);var r=a(19);a(44),Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.getStepsEditor=void 0;var n=r(a(97));a(44),a(4);var l=a(56),u=r(a(2876)),o=r(a(2907));t.getStepsEditor=function(e){return[[function(e){return(0,l.compareVersion)(e,"3.4.0")<0},u.default],[function(){return!0},o.default]].find((function(t){return(0,(0,n.default)(t,1)[0])(e)}))[1]};var c=o.default;t.default=c},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(20),r(87),r(194),r(14),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(121),r(20),r(27),r(87),r(194),r(141),r(29),r(14),r(120),r(9),r(4),r(18),r(43),r(11);var l,u,o,c,s,i,f,d,p,m,h,v,E,y,g,b,S,_,O,C,T=n(r(62)),R=n(r(25)),D=n(r(28)),k=n(r(74)),N=n(r(41)),I=n(r(42)),P=n(r(37)),A=n(r(45)),w=(n(r(63)),r(189)),L=n(r(26)),M=n(r(67)),x=n(r(811)),j=n(r(68)),U=r(17),F=r(243),V=n(r(1)),G=n(r(0)),B=n(r(966)),z=n(r(935)),Y=n(r(1189)),H=n(r(2877)),q=n(r(1469));function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,P.default)(e);if(t){var n=(0,P.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,I.default)(this,a)}}var W=[{label:"Any",value:"any"},{label:"node",value:"node"},{label:"kubernetes",value:"kubernetes"},{label:"none",value:"none"}],Q=(0,F.observer)((C=O=function(e){(0,N.default)(r,e);var a=K(r);function r(){var e;(0,R.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return e=a.call.apply(a,[this].concat(l)),(0,T.default)(e,"zIndex",o,(0,k.default)(e)),(0,T.default)(e,"isEditMode",c,(0,k.default)(e)),(0,T.default)(e,"formData",s,(0,k.default)(e)),(0,T.default)(e,"showYaml",i,(0,k.default)(e)),(0,T.default)(e,"handleChangeName",f,(0,k.default)(e)),(0,T.default)(e,"handleSetYaml",d,(0,k.default)(e)),(0,T.default)(e,"hideYamlEditor",p,(0,k.default)(e)),(0,T.default)(e,"showEditor",m,(0,k.default)(e)),e.initFormData=function(){var t=(0,U.toJS)((0,L.default)(e.props.activeStage,"agent.arguments",[]));e.formData=t.reduce((function(e,t){if(Array.isArray(t.value)){var a=t.value.reduce((function(e,t){var a={};return a[t.key]=t.value.value,e.push(a),e}),[]);e[t.key]=a}else e[t.key]=t.value.value;return e}),{})},e.handleAgentTypeArg=function(){e.getAgentArguments()},e.renderAgentForms=function(){var a=(0,U.toJS)(e.labelDataList),r=(0,L.default)(a,"0.value","");switch(e.agentType){case"node":return G.default.createElement(w.Form,{data:e.formData,ref:e.formRef},G.default.createElement(w.Form.Item,{label:t("label"),desc:t("The label on which to run the Pipeline or individual stage")},G.default.createElement(w.Select,{name:"label",options:a,defaultValue:r,onChange:e.handleAgentTypeArg})));case"kubernetes":return G.default.createElement(w.Form,{data:e.formData,ref:e.formRef},G.default.createElement(w.Form.Item,{label:t("label"),desc:t("")},G.default.createElement(w.Input,{name:"label",defaultValue:"default",onChange:e.handleAgentTypeArg})),G.default.createElement(w.Form.Item,{label:t("yaml"),desc:G.default.createElement("span",{className:z.default.clickable,onClick:e.showEditor},t("show yaml editor"))},G.default.createElement(w.Input,{name:"yaml",onChange:e.handleAgentTypeArg})),G.default.createElement(w.Form.Item,{label:t("defaultContainer"),desc:t("")},G.default.createElement(w.Input,{name:"defaultContainer",onChange:e.handleAgentTypeArg})));default:return null}},(0,T.default)(e,"handleAgentTypeChange",h,(0,k.default)(e)),e.handleDelete=function(){e.props.store.deleteStage()},(0,T.default)(e,"toggleAddStep",v,(0,k.default)(e)),(0,T.default)(e,"handleEdit",E,(0,k.default)(e)),(0,T.default)(e,"handleEditCancel",y,(0,k.default)(e)),(0,T.default)(e,"handleEditStep",g,(0,k.default)(e)),(0,T.default)(e,"handleAddStep",b,(0,k.default)(e)),e.addNoInputTask=function(t){var a=e.props.activeStage;if(a.when||(0,j.default)(a,"when.conditions",[]),e.zIndex.length){var r=e.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,L.default)(a.when.conditions,"".concat(r,".children")).push({name:t,children:[]})}else a.when.conditions.push({name:t,children:[]});e.props.store.isAddingStep=!1,e.handleSetValue()},(0,T.default)(e,"handleDeleteStep",S,(0,k.default)(e)),(0,T.default)(e,"handleSortSteps",_,(0,k.default)(e)),e.handleSetValue=function(){e.props.activeStage.when&&!e.props.activeStage.when.conditions.length&&delete e.props.activeStage.when,e.props.activeStage.error&&(e.props.activeStage.error=void 0),e.props.store.setValue(e.props.activeStage)},e.cancelFocus=function(){e.getAgentArguments(),e.props.store.clearFocus()},e}return(0,D.default)(r,[{key:"getChildContext",value:function(){return{toggleAddStep:this.toggleAddStep,handleEdit:this.handleEdit,handleDeleteStep:this.handleDeleteStep}}},{key:"componentDidMount",value:function(){this.initFormData()}},{key:"componentDidUpdate",value:function(e){(0,x.default)(this.props.activeStage,e.activeStage)||this.initFormData()}},{key:"getAgentArguments",value:function(){var e=this,t=(0,L.default)(this.props.activeStage,"agent.type"),a=(0,L.default)(this.props.activeStage,"agent.arguments"),r=(0,U.toJS)(this.formData);if(t||(0,j.default)(this.props.activeStage,"agent.type","none"),!(0,M.default)(r)){var n=Object.keys(this.formData).map((function(t){var a=(0,U.toJS)(e.formData[t]);return Array.isArray(a)?{key:t,value:a.map((function(e){return Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}))[0]}))}:{key:t,value:{isLiteral:!0,value:a}}}));(0,j.default)(this.props.activeStage,"agent.arguments",(0,M.default)(n)?void 0:n)}(0,M.default)(r)&&!(0,M.default)((0,U.toJS)(a))&&delete this.props.activeStage.agent.arguments}},{key:"renderConditions",value:function(){var e=(0,L.default)(this.props,"activeStage.when.conditions");return e?G.default.createElement(q.default,{steps:e,zIndex:[],listType:"condition"}):null}},{key:"render",value:function(){var e=this.props.store.isAddingStep;return G.default.createElement("div",{className:z.default.sheet},G.default.createElement("div",{className:z.default.title},t("STAGE"),G.default.createElement("span",{className:z.default.delete,onClick:this.handleDelete},G.default.createElement(w.Icon,{name:"trash",clickable:!0}))),G.default.createElement("div",{className:z.default.form},G.default.createElement(w.Form.Item,{label:t("NAME")},G.default.createElement(w.Input,{className:z.default.name_input,value:this.props.activeStage.name||"",onChange:this.handleChangeName})),G.default.createElement("div",{className:z.default.title},t("AGENT")),G.default.createElement(w.Form.Item,{desc:t("AGENT_TYPE_DESC"),label:t("TYPE")},G.default.createElement(w.Select,{options:W,defaultValue:"none",value:this.agentType,onChange:this.handleAgentTypeChange})),this.renderAgentForms(),G.default.createElement("div",{className:z.default.title},t("pipeline_conditions"),G.default.createElement("span",null,t("The conditions required to implement the current phase (optional)."))),G.default.createElement("div",{className:z.default.conditionList},this.renderConditions()),this.hasNestStage?null:G.default.createElement("div",{className:B.default.addSteps,onClick:this.toggleAddStep("","condition")},G.default.createElement(w.Icon,{name:"add"}),"  ",t("Add conditions")),G.default.createElement("div",{className:z.default.title},t("TASK")),G.default.createElement(q.default,{steps:this.steps,zIndex:[]}),this.hasNestStage?null:G.default.createElement("div",{className:B.default.addSteps,onClick:this.toggleAddStep("")},G.default.createElement(w.Icon,{name:"add"}),"  ",t("Add Step"))),G.default.createElement("div",{className:z.default.footer},G.default.createElement(w.Button,{onClick:this.cancelFocus},t("OK"))),e?G.default.createElement(H.default,{onAddStep:this.handleAddStep,store:this.props.store,isEditMode:this.isEditMode,onCancel:this.handleEditCancel,onAddNoInputTask:this.addNoInputTask}):null,G.default.createElement(Y.default,{value:this.formData.yaml||"",visible:this.showYaml,onCancel:this.hideYamlEditor,onOk:this.handleSetYaml}))}},{key:"steps",get:function(){return(0,L.default)(this.props.activeStage,"branches[0].steps",[])}},{key:"labelDataList",get:function(){return(0,L.default)(this.props.store,"labelDataList",[])}},{key:"hasNestStage",get:function(){return!!this.props.activeStage.stages}},{key:"agentType",get:function(){return(0,L.default)(this.props.activeStage,"agent.type","none")}}]),r}(G.default.Component),O.defaultProps={activeStage:{}},O.childContextTypes={toggleAddStep:V.default.func,handleEdit:V.default.func,handleDeleteStep:V.default.func},u=C,o=(0,A.default)(u.prototype,"zIndex",[U.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),c=(0,A.default)(u.prototype,"isEditMode",[U.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=(0,A.default)(u.prototype,"formData",[U.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),i=(0,A.default)(u.prototype,"showYaml",[U.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=(0,A.default)(u.prototype,"handleChangeName",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.activeStage.name=t,e.handleSetValue()}}}),d=(0,A.default)(u.prototype,"handleSetYaml",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.formData.yaml=t,e.handleAgentTypeArg(),e.showYaml=!1}}}),p=(0,A.default)(u.prototype,"hideYamlEditor",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showYaml=!1}}}),m=(0,A.default)(u.prototype,"showEditor",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showYaml=!0}}}),h=(0,A.default)(u.prototype,"handleAgentTypeChange",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a="";switch(t){case"node":a=(0,L.default)((0,U.toJS)(e.labelDataList),"0.value",""),e.formData={label:a};break;case"kubernetes":a="default",e.formData={label:a};break;default:e.formData={}}(0,j.default)(e.props.activeStage,"agent.type",t),e.handleAgentTypeArg(),e.handleSetValue()}}}),v=(0,A.default)(u.prototype,"toggleAddStep",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){return function(){e.isEditMode=!1,e.zIndex=t,e.props.store.isAddingStep=a||!0}}}}),E=(0,A.default)(u.prototype,"handleEdit",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a,r,n){return function(){e.props.store.setEdittingData({type:r.name,data:r.arguments}),e.index=a,e.zIndex=t,e.isEditMode=!0,e.props.store.isAddingStep=n||!0}}}}),y=(0,A.default)(u.prototype,"handleEditCancel",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isEditMode&&(e.isEditMode=!1,e.props.store.isAddingStep=!1,e.props.store.setEdittingData({}))}}}),g=(0,A.default)(u.prototype,"handleEditStep",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.zIndex.length){var a=e.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),""),r=(0,L.default)(e.steps,"".concat(a,".children[").concat(e.index,"].children"));r&&(t.children=r),(0,L.default)(e.steps,"".concat(a,".children")).splice(e.index,1,t)}else{var n=(0,L.default)(e.steps,"[".concat(e.index,"].children"));n&&(t.children=n),e.steps.splice(e.index,1,t)}e.props.store.isAddingStep=!1,e.isEditMode=!1,e.props.store.setEdittingData({}),e.handleSetValue()}}}),b=(0,A.default)(u.prototype,"handleAddStep",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.isEditMode)e.handleEditStep(t);else{var a=e.steps;if("string"==typeof e.props.store.isAddingStep&&(e.props.activeStage.when||(0,j.default)(e.props.activeStage,"when.conditions",[]),a=e.props.activeStage.when.conditions),e.zIndex.length){var r=e.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,L.default)(a,"".concat(r,".children")).push(t)}else a.push(t);e.props.store.isAddingStep=!1,e.handleSetValue()}}}}),S=(0,A.default)(u.prototype,"handleDeleteStep",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a,r){return function(){var n=r?e.props.activeStage.when.conditions:e.steps;if(a.length){var l=a.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,L.default)(n,"".concat(l,".children")).splice(t,1)}else n.splice(t,1);e.setState({index:1}),e.handleSetValue()}}}}),_=(0,A.default)(u.prototype,"handleSortSteps",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){if(t.length){var r=t.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),""),n=(0,L.default)(e.steps,"".concat(r,".children")),l=a.map((function(e){return n.find((function(t,a){return JSON.stringify(t)+a===e}))}));(0,j.default)(e.steps,"".concat(r,".children"),l)}else{var u=e.steps,o=a.map((function(e){return u.find((function(t,a){return JSON.stringify(t)+a===e}))}));(0,j.default)(e.props.activeStage,"branches[0].steps",o)}e.handleSetValue()}}}}),l=u))||l;a.default=Q},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(87),r(14),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(87),r(29),r(14),r(9),r(4),r(21),r(18),r(43),r(11);var l=n(r(58)),u=n(r(31)),o=n(r(38));r(35);var c,s,i,f,d,p,m,h,v=n(r(39)),E=n(r(62)),y=n(r(25)),g=n(r(28)),b=n(r(74)),S=n(r(41)),_=n(r(42)),O=n(r(37)),C=n(r(45)),T=(n(r(63)),r(189)),R=r(848),D=n(r(5)),k=n(r(1058)),N=r(17),I=r(243),P=n(r(0)),A=r(61),w=n(r(935)),L=r(2878),M=n(r(2905));function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,O.default)(e);if(t){var n=(0,O.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,_.default)(this,a)}}var j={not:!0,allOf:!0,anyOf:!0},U={echo:"loudspeaker",mail:"mail",shell:"terminal",container:"terminal",checkout:"network-router",git:"network-router",cd:"rocket",withCredentials:"key",kubernetesDeploy:"kubernetes",branch:"network-router",timeout:"clock",withSonarQubeEnv:"network"},F=(0,I.observer)((s=function(e){(0,S.default)(r,e);var a=x(r);function r(e){var n;return(0,y.default)(this,r),n=a.call(this,e),(0,E.default)(n,"activeTab",i,(0,b.default)(n)),(0,E.default)(n,"handleBack",f,(0,b.default)(n)),(0,E.default)(n,"handleAddTask",d,(0,b.default)(n)),(0,E.default)(n,"handleCancel",p,(0,b.default)(n)),(0,E.default)(n,"handleChangeActiveTab",m,(0,b.default)(n)),(0,E.default)(n,"handleAddStep",h,(0,b.default)(n)),n.handleSetValue=function(){n.stage.name=n.stageName||n.stage.name,n.props.store.setValue(n.stage)},n.handleCreateCredential=function(){var e=(0,v.default)(o.default.mark((function e(t,a){var r,l,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props.store.params,l=r.devops,u=r.cluster,e.next=3,n.props.store.createCredential(t,{devops:l,cluster:u});case 3:a(),n.hideCreateCredential();case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.hideCreateCredential=(0,v.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.store.getCredentials();case 2:n.setState({showCredential:!1});case 3:case"end":return e.stop()}}),e)}))),n.handleShowCredential=function(){n.setState({showCredential:!0})},n.renderStepsModal=function(){var e=n.props.store.params,t=e.devops,a=e.cluster,r=n.props.store,l=r.edittingData;return"condition"===r.isAddingStep?P.default.createElement(P.default.Fragment,null,P.default.createElement(L.Branch,{visible:n.state.isShowbranch,onAddStep:n.handleAddStep("branch"),onCancel:n.handleCancel("branch"),edittingData:l}),P.default.createElement(L.Environment,{visible:n.state.isShowenvironment,onAddStep:n.handleAddStep("environment"),onCancel:n.handleCancel("environment"),edittingData:l}),P.default.createElement(L.Expression,{visible:n.state.isShowexpression,onAddStep:n.handleAddStep("expression"),onCancel:n.handleCancel("expression"),edittingData:l})):P.default.createElement(P.default.Fragment,null,P.default.createElement(L.Echo,{visible:n.state.isShowecho,onAddStep:n.handleAddStep("echo"),onCancel:n.handleCancel("echo"),edittingData:l}),P.default.createElement(L.Shell,{visible:n.state.isShowshell,onAddStep:n.handleAddStep("shell"),onCancel:n.handleCancel("shell"),edittingData:l}),P.default.createElement(L.Dir,{visible:n.state.isShowdir,onAddStep:n.handleAddStep("dir"),onCancel:n.handleCancel("dir"),edittingData:l}),P.default.createElement(L.Container,{visible:n.state.isShowcontainer,onAddStep:n.handleAddStep("container"),onCancel:n.handleCancel("container"),edittingData:l}),P.default.createElement(L.ArchiveArtifacts,{visible:n.state.isShowarchiveArtifacts,onAddStep:n.handleAddStep("archiveArtifacts"),onCancel:n.handleCancel("archiveArtifacts"),edittingData:l}),P.default.createElement(L.Git,{visible:n.state.isShowgit,showCredential:n.handleShowCredential,onAddStep:n.handleAddStep("git"),onCancel:n.handleCancel("git"),edittingData:l,store:n.props.store}),P.default.createElement(L.CD,{visible:n.state.isShowcd,showCredential:n.handleShowCredential,onAddStep:n.handleAddStep("cd"),onCancel:n.handleCancel("cd"),edittingData:l,store:n.props.store}),P.default.createElement(L.Checkout,{visible:n.state.isShowcheckout,showCredential:n.handleShowCredential,onAddStep:n.handleAddStep("checkout"),onCancel:n.handleCancel("checkout"),edittingData:l,store:n.props.store}),P.default.createElement(L.InputStep,{devops:t,cluster:a,visible:n.state.isShowinput,edittingData:l,onAddStep:n.handleAddStep("input"),onCancel:n.handleCancel("input")}),P.default.createElement(L.WithCredentials,{visible:n.state.isShowwithCredentials,onAddStep:n.handleAddStep("withCredentials"),onCancel:n.handleCancel("withCredentials"),store:n.props.store,showCredential:n.handleShowCredential,edittingData:l}),P.default.createElement(L.KubernetesDeploy,{visible:n.state.isShowkubernetesDeploy,onAddStep:n.handleAddStep("kubernetesDeploy"),onCancel:n.handleCancel("kubernetesDeploy"),store:n.props.store,showCredential:n.handleShowCredential,edittingData:l}),P.default.createElement(L.Timeout,{visible:n.state.isShowtimeout,onAddStep:n.handleAddStep("timeout"),onCancel:n.handleCancel("timeout"),edittingData:l}),P.default.createElement(k.default,{visible:n.state.showCredential,onOk:n.handleCreateCredential,onCancel:n.hideCreateCredential,devops:t,cluster:a,credentialType:n.state.isShowkubernetesDeploy?"kubeconfig":""}),P.default.createElement(L.Sonarqube,{visible:n.state.isShowwithSonarQubeEnv,onAddStep:n.handleAddStep("withSonarQubeEnv"),onCancel:n.handleCancel("withSonarQubeEnv"),edittingData:l}),P.default.createElement(L.WaitForQualityGate,{visible:n.state.isShowwaitForQualityGate,onAddStep:n.handleAddStep("waitForQualityGate"),onCancel:n.handleCancel("waitForQualityGate"),edittingData:l}),P.default.createElement(L.Script,{visible:n.state.isShowscript,onAddStep:n.handleAddStep("script"),onCancel:n.handleCancel("script"),edittingData:l}),P.default.createElement(L.Mail,{visible:n.state.isShowmail,onAddStep:n.handleAddStep("mail"),onCancel:n.handleCancel("mail"),edittingData:l}))},n.renderSider=function(){return"condition"===n.props.store.isAddingStep?P.default.createElement("div",{className:w.default.sheet},P.default.createElement("div",{className:w.default.title},P.default.createElement("span",{className:(0,D.default)("custom-icon",M.default.back),onClick:n.handleBack},P.default.createElement(R.ReactComponent,null)),t("Add conditions")),P.default.createElement("div",{className:M.default.taskList},A.PIPELINE_CONDITIONS.map((function(e){return P.default.createElement("div",{className:M.default.task,key:e,onClick:n.handleAddTask(e)},P.default.createElement("div",{className:M.default.taskIcon},P.default.createElement(T.Icon,{name:U[e]||"cdn",size:24})),P.default.createElement("div",{className:M.default.taskInfo},P.default.createElement("div",{className:M.default.taskName},e),P.default.createElement("div",{className:M.default.desc},n.taskDescs[e]||"-")))})))):P.default.createElement("div",{className:w.default.sheet},P.default.createElement("div",{className:w.default.title},P.default.createElement("span",{className:(0,D.default)("custom-icon",M.default.back),onClick:n.handleBack},P.default.createElement(R.ReactComponent,null)),t("Add Step")),P.default.createElement("div",{className:M.default.tabs},Object.keys(A.PIPELINE_TASKS).map((function(e){return P.default.createElement("div",{key:e,className:(0,D.default)(M.default.tab,(0,u.default)({},M.default.tab_active,n.activeTab===e)),onClick:n.handleChangeActiveTab(e)},t(e))}))),P.default.createElement("div",{className:M.default.taskList},A.PIPELINE_TASKS[n.activeTab].map((function(e){return P.default.createElement("div",{className:M.default.task,key:e,onClick:n.handleAddTask(e)},P.default.createElement("div",{className:M.default.taskIcon},P.default.createElement(T.Icon,{name:U[e]||"cdn",size:24})),P.default.createElement("div",{className:M.default.taskInfo},P.default.createElement("div",{className:M.default.taskName},P.default.createElement("span",null,t(e)),"kubernetesDeploy"===e&&P.default.createElement(T.Tooltip,{content:t("KUBERNETES_DEPLOY_DEPRECATED_TIP")},P.default.createElement(T.Icon,{name:"exclamation",size:16,color:{primary:"#fff",secondary:"#F5A623"}}))),P.default.createElement("div",{className:M.default.desc},n.taskDescs[e]||"-")))}))))},n.taskDescs={git:t("Pull code by Git"),shell:t("You can execute shell commands or windows batch commands in the build."),container:t("Specify a container to add nested tasks to execute inside the container"),echo:t("Send messages in the build"),mail:t("Send messages by email"),checkout:t("CHECKOUT_DESC"),dir:t("Change Current Directory"),archiveArtifacts:t("Save Artifact"),cleanWs:t("Clean Workspace"),input:t("REVIEW_DESC"),withCredentials:t("Load credentials into environment variables"),kubernetesDeploy:t("Deploy resources to the Kubernetes cluster"),timeout:t("Executes the code inside the block with a determined time out limit."),branch:t("Current branch name must match the input value"),environment:t("The environment variable entered before running the pipeline is match the current value."),expression:t("Enter an expression"),not:t("Negative prefix"),allOf:t("Internal nesting conditions must be matched"),anyOf:t("Internal nested conditions only need to satisfy one"),withSonarQubeEnv:t("withSonarQubeEnv_DESC"),waitForQualityGate:t("waitForQualityGate_DESC"),script:t("script_DESC"),cd:t("CD_STEP_DESC")},n.state=[].concat((0,l.default)(A.PIPELINE_TASKS.All),(0,l.default)(A.PIPELINE_CONDITIONS)).reduce((function(e,t){return e["isShow".concat(t)]=!1,e}),{}),n.state.showCredential=!1,n}return(0,g.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.store.edittingData.type,t="sh"===e?"shell":e;this.setState((0,u.default)({},"isShow".concat(t),!0))}},{key:"render",value:function(){return P.default.createElement(P.default.Fragment,null,this.props.isEditMode?null:this.renderSider(),this.renderStepsModal())}}]),r}(P.default.Component),i=(0,C.default)(s.prototype,"activeTab",[N.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"All"}}),f=(0,C.default)(s.prototype,"handleBack",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.store.isAddingStep=!1}}}),d=(0,C.default)(s.prototype,"handleAddTask",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(){t in j?e.props.onAddNoInputTask(t):e.setState((0,u.default)({},"isShow".concat(t),!0))}}}}),p=(0,C.default)(s.prototype,"handleCancel",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(){e.setState((0,u.default)({},"isShow".concat(t),!1)),e.props.onCancel()}}}}),m=(0,C.default)(s.prototype,"handleChangeActiveTab",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(){e.activeTab=t}}}}),h=(0,C.default)(s.prototype,"handleAddStep",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){e.props.onAddStep(a),e.setState((0,u.default)({},"isShow".concat(t),!1))}}}}),c=s))||c;a.default=F},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Echo",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Shell",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Dir",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Container",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"ArchiveArtifacts",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"Git",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"Checkout",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"InputStep",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"WithCredentials",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"KubernetesDeploy",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"Timeout",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"Branch",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"Environment",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"Expression",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(t,"Sonarqube",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"Script",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"WaitForQualityGate",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"Mail",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(t,"CD",{enumerable:!0,get:function(){return _.default}});var n=r(a(2879)),l=r(a(2880)),u=r(a(2881)),o=r(a(2882)),c=r(a(2883)),s=r(a(2884)),i=r(a(2885)),f=r(a(2886)),d=r(a(2887)),p=r(a(2888)),m=r(a(2889)),h=r(a(2890)),v=r(a(2891)),E=r(a(2892)),y=r(a(2893)),g=r(a(2894)),b=r(a(2895)),S=r(a(2896)),_=r(a(2897))},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(20),r(87),r(9),r(4),r(18),r(11),r(817),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11),r(817);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798)),m=n(r(836));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData();t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t].trim()}}}));t.props.onAddStep({name:"echo",arguments:a.filter((function(e){return""!==e.value.value}))})}))},t.formRef=i.default.createRef(),t.state={formData:{}},t}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return i.default.createElement(p.default,{width:680,bodyClassName:m.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("Print message")},i.default.createElement(d.Form,{data:this.state.formData,ref:this.formRef},i.default.createElement(d.Form.Item,{label:t("message"),rules:[{required:!0,message:t("This parameter is required")}]},i.default.createElement(d.TextArea,{name:"message"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"echo"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(i.default.Component);a.default=v,v.propTypes={name:f.default.string},v.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(26)),v=r(243),E=n(r(798)),y=n(r(838)),g=n(r(836));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=b(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleChange=function(e){t.isInputed=!0,t.newValue=e},t.handleOk=function(){var e=t.state.initValue;t.props.onAddStep({name:"sh",arguments:[{key:"script",value:{isLiteral:!0,value:t.isInputed?t.newValue:e}}]})},t.state={value:""},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.state.value;return p.default.createElement(E.default,{width:680,bodyClassName:g.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("shell")},p.default.createElement(y.default,{className:g.default.CodeEditor,name:"script",mode:"yaml",value:n,onChange:this.handleChange}))}}],[{key:"getDerivedStateFromProps",value:function(e){if("sh"===e.edittingData.type){var t=(0,h.default)(e.edittingData.data,"[0].value.value","");return{value:t,initValue:t}}return null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(26)),v=r(243),E=n(r(798)),y=r(189),g=n(r(836));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=b(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData();t.props.onAddStep({name:"dir",arguments:{isLiteral:!0,value:e.path},children:[]})},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(E.default,{width:680,bodyClassName:g.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("dir")},p.default.createElement(y.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(y.Form.Item,{label:t("PATH")},p.default.createElement(y.Input,{name:"path"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"dir"===e.edittingData.type?{formData:{path:(0,h.default)(e.edittingData,"data.value","")}}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(26)),v=r(243),E=n(r(798)),y=r(189),g=n(r(836));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=b(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData();t.formRef.current.validate((function(){t.props.onAddStep({name:"container",arguments:{isLiteral:!0,value:e.name},children:[]})}))},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(E.default,{width:680,bodyClassName:g.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("container")},p.default.createElement(y.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(y.Form.Item,{label:t("name"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},p.default.createElement(y.Input,{name:"name"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"container"===e.edittingData.type?{formData:{name:(0,h.default)(e.edittingData,"data.value","")}}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=r(189),y=n(r(836));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData(),a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"archiveArtifacts",arguments:a})},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("archiveArtifacts")},p.default.createElement(E.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(E.Form.Item,{label:t("ARTIFACT_PL")},p.default.createElement(E.Input,{name:"artifacts"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"archiveArtifacts"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(20),r(87),r(14),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(87),r(29),r(14),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(58)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(1)),v=r(243),E=n(r(244)),y=r(189),g=n(r(798)),b=n(r(836));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,v.observer)((o=u=function(e){(0,f.default)(r,e);var a=S(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).handleOk=function(){var e=n.formRef.current.getData();n.formRef.current.validate((function(){var t=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));n.props.onAddStep({name:"git",arguments:[].concat((0,c.default)(t.filter((function(e){return""!==e.value.value}))),[{key:"changelog",value:{isLiteral:!0,value:!0}},{key:"poll",value:{isLiteral:!0,value:!1}}])})}))},n.getCredentialsListData=function(e){return n.props.store.getCredentials(e)},n.getCredentialsList=function(){return(0,c.default)(n.props.store.credentialsList.data.map((function(e){return{label:e.name,value:e.name,type:e.type,disabled:!1}})))},n.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return m.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",m.default.createElement(y.Tag,{type:n?"":"warning"},"ssh"===r?"SSH":t(r)))},n.formRef=m.default.createRef(),n.state={formData:{}},n}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.props.store.credentialsList;return m.default.createElement(g.default,{width:680,bodyClassName:b.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:"Git"},m.default.createElement(y.Form,{data:this.state.formData,ref:this.formRef},m.default.createElement(y.Form.Item,{label:t("Url"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},m.default.createElement(y.Input,{name:"url"})),m.default.createElement(y.Form.Item,{label:t("CREDENTIAL_NAME"),desc:m.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),m.default.createElement("span",{className:b.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL")))},m.default.createElement(y.Select,{name:"credentialsId",options:this.getCredentialsList(),pagination:(0,E.default)(n,["page","limit","total"]),isLoading:n.isLoading,onFetch:this.getCredentialsListData,optionRenderer:this.optionRender,valueRenderer:this.optionRender,searchable:!0,clearable:!0})),m.default.createElement(y.Form.Item,{label:t("BRANCH_SI")},m.default.createElement(y.Input,{name:"branch"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return e.edittingData&&"git"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(m.default.Component),u.propTypes={name:h.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=_},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(87),r(14),r(138),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(87),r(29),r(14),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u,o,c=n(r(31)),s=n(r(58)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=n(r(1)),E=n(r(244)),y=r(243),g=r(189),b=n(r(798)),S=r(902),_=r(17),O=n(r(836));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var R=(0,y.observer)((o=u=function(e){(0,d.default)(r,e);var a=T(r);function r(e){var n;return(0,i.default)(this,r),(n=a.call(this,e)).handleOk=function(){n.formRef.current.validate((function(){n.props.onAddStep({name:"checkout",arguments:[{key:"scm",value:{isLiteral:!1,value:"[$class: 'SubversionSCM', locations: [[cancelProcessOnExternalsFail: true,  ".concat(n.state.formData.credentialsId?"credentialsId: '".concat(n.state.formData.credentialsId,"',"):""," depthOption: 'infinity', ignoreExternalsOption: true, local: '.', remote: '").concat(n.state.formData.remote,"']], quietOperation: true, workspaceUpdater: [$class: 'UpdateUpdater']]")}},{key:"poll",value:{isLiteral:!0,value:!1}}]})}))},n.getCredentialsListData=function(e){return n.props.store.getCredentials(e)},n.getCredentialsList=function(){return(0,s.default)(n.props.store.credentialsList.data.map((function(e){return{label:e.name,value:e.name,type:e.type,disabled:!n.props.store.isPassWordCredentials(e.type)}})))},n.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return h.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",h.default.createElement(g.Tag,{type:n?"":"warning"},"ssh"===r?"SSH":t(r)))},n.formRef=h.default.createRef(),n.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n.getFormData(e)),n}return(0,f.default)(r,[{key:"getFormData",value:function(e){return"checkout"===e.edittingData.type?{formData:(0,_.toJS)(e.edittingData).data.reduce((function(e,t){if("scm"===t.key){var a=t.value.value;a&&Object.assign(e,(0,S.groovyToJS)(a))}return e[t.key]=t.value.value,e}),{})}:{formData:{}}}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.props.store.credentialsList;return h.default.createElement(b.default,{width:680,bodyClassName:O.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("checkout (svn)")},h.default.createElement(g.Form,{data:this.state.formData,ref:this.formRef},h.default.createElement(g.Form.Item,{label:t("CREDENTIAL_NAME"),desc:h.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),h.default.createElement("span",{className:O.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL")))},h.default.createElement(g.Select,{name:"credentialsId",options:this.getCredentialsList(),pagination:(0,E.default)(n,["page","limit","total"]),isLoading:n.isLoading,onFetch:this.getCredentialsListData,optionRenderer:this.optionRender,valueRenderer:this.optionRender,searchable:!0,clearable:!0})),h.default.createElement(g.Form.Item,{label:t("REMOTE_REPOSITORY_URL"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},h.default.createElement(g.Input,{name:"remote"}))))}}]),r}(h.default.Component),u.propTypes={name:v.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=R},function(e,a,r){"use strict";r(16);var n=r(19);r(6),r(88),r(66),r(20),r(51),r(320),r(4),r(18),r(30),r(11),r(69),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(6),r(88),r(66),r(20),r(51),r(320),r(29),r(4),r(18),r(43),r(30),r(11),r(69),r(7);var l,u,o,c,s,i=n(r(62)),f=n(r(25)),d=n(r(28)),p=n(r(74)),m=n(r(41)),h=n(r(42)),v=n(r(37)),E=n(r(45)),y=(n(r(63)),n(r(0))),g=n(r(1)),b=n(r(808)),S=n(r(253)),_=n(r(67)),O=n(r(64)),C=r(17),T=r(243),R=r(4567),D=r(189),k=n(r(798)),N=n(r(323)),I=n(r(836));function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var A=(0,T.observer)((s=c=function(e){(0,m.default)(r,e);var a=P(r);function r(e){var t;(0,f.default)(this,r),(t=a.call(this,e)).handleMessageChange=function(e){t.setState({value:e.target.value})},t.handleMessageSubmitter=function(){var e=(0,S.default)((t.state.value.match(/@([\w-.]*)?/g)||[]).map((function(e){return e.slice(1)})));t.setState({submitter:e})},t.getDefaultData=function(){var e=t.props.edittingData,a="",r=[],n=(0,C.toJS)(e);return(0,_.default)(n)||(0,_.default)(n.data)||!(0,O.default)(n.data)||n.data.forEach((function(e){"message"===e.key&&(a=e.value.value),"submitter"===e.key&&(r=e.value.value.split(", "))})),{value:a,submitter:r}},(0,i.default)(t,"fetchUsers",o,(0,p.default)(t)),t.getUsers=function(){var e=t.props,a=e.devops,r=e.cluster;t.setState({loading:!0}),t.memberStore.fetchList({devops:a,cluster:r}).then((function(e){return t.setState({loading:!1}),(0,_.default)(e)?[]:e.map((function(e){return{id:e.username,display:e.username,sort:e.username.indexOf((0,C.toJS)(t.query))}})).sort((function(e,t){return e.sort>=0&&t.sort>=0?e.sort-t.sort:t.sort-e.sort}))})).then(t.callback)},t.handleOk=function(){t.props.onAddStep({name:"input",arguments:[{key:"message",value:{isLiteral:!0,value:t.state.value}},{key:"submitter",value:{isLiteral:!0,value:t.state.submitter.join(", ")}}]})},t.memberStore=new N.default;var n=t.getDefaultData(),l=n.value,u=n.submitter;return t.state={loading:!1,value:l,submitter:u},t}return(0,d.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return y.default.createElement(k.default,{width:680,bodyClassName:I.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("input")},y.default.createElement(D.Alert,{type:"info",icon:"information",className:I.default.info,message:t("INPUT_DESC")}),y.default.createElement(D.Form,{data:this.formData,ref:this.formRef},y.default.createElement(D.Form.Item,{label:t("MESSAGE"),desc:t("INPUT_MESSAGE_DESC"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},y.default.createElement(R.MentionsInput,{className:"mention-input",value:this.state.value,onChange:this.handleMessageChange,onBlur:this.handleMessageSubmitter,placeholder:t("@somebody to help review")},y.default.createElement(R.Mention,{data:this.fetchUsers,loading:this.state.loading,type:"user",appendSpaceOnAdd:!0,displayTransform:function(e){return"@".concat(e)},markup:"@__id__ "})))))}}]),r}(y.default.Component),c.propTypes={name:g.default.string},c.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},u=s,o=(0,E.default)(u.prototype,"fetchUsers",[C.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){t&&(e.debounced||(e.debounced=(0,b.default)(e.getUsers,300)),e.query=t,e.callback=a,e.debounced())}}}),l=u))||l;a.default=A},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(20),r(87),r(14),r(99),r(9),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(58)),u=n(r(62)),o=n(r(25)),c=n(r(28)),s=n(r(74)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(45));n(r(63));r(32),r(3),r(44),r(20),r(87),r(29),r(14),r(99),r(9),r(4),r(18),r(43),r(30),r(11),r(69);var m,h,v,E,y,g=n(r(0)),b=n(r(1)),S=n(r(26)),_=n(r(244)),O=r(17),C=r(243),T=r(189),R=n(r(798)),D=r(902),k=n(r(836));function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var I=function(e,t){var a=Object.keys(e).reduce((function(t,a){return"".concat(t).concat(a," : '").concat(e[a],"' ,")}),"");return"${[".concat(t,"(").concat(a,")]}")},P={secret_text:"string",username_password:"usernamePassword",ssh:"sshUserPrivateKey",kubeconfig:"kubeconfigContent",kubeconfigFile:"kubeconfigFile"},A=(0,C.observer)((y=E=function(e){(0,i.default)(r,e);var a=N(r);function r(e){var n;return(0,o.default)(this,r),(n=a.call(this,e)).initEditor=function(){var e=n.props.edittingData;if("withCredentials"===e.type){var t=(0,S.default)(e,"data.value","");if(t){var a=(0,D.groovyToJS)(t),r=function(e){var t=/\$\{\[([\w-]*)\(/,a=e.match(t)&&e.match(t)[1];if(a){var r=Object.entries(P).find((function(e){return e[1]===a}));return r?r[0]:null}return null}(t);n.setState({formData:a,credentialType:r})}}},(0,u.default)(n,"handleCredentialChange",v,(0,s.default)(n)),n.handleOk=function(){var e=n.formRef.current.getData();n.formRef.current.validate((function(){n.props.onAddStep({name:"withCredentials",arguments:{isLiteral:!1,value:I(e,P[n.state.credentialType])},children:[]})}))},n.renderParams=function(){switch(n.state.credentialType){case"username_password":return g.default.createElement(g.default.Fragment,null,g.default.createElement(T.Form.Item,{label:t("Password Variable")},g.default.createElement(T.Input,{name:"passwordVariable"})),g.default.createElement(T.Form.Item,{label:t("Username Variable")},g.default.createElement(T.Input,{name:"usernameVariable"})));case"secret_text":return g.default.createElement(g.default.Fragment,null,g.default.createElement(T.Form.Item,{label:t("Text Variable")},g.default.createElement(T.Input,{name:"variable"})));case"ssh":return g.default.createElement(g.default.Fragment,null,g.default.createElement(T.Form.Item,{label:t("key File Variable")},g.default.createElement(T.Input,{name:"keyFileVariable"})),g.default.createElement(T.Form.Item,{label:t("passphrase Variable")},g.default.createElement(T.Input,{name:"passphraseVariable"})),g.default.createElement(T.Form.Item,{label:t("Username Variable")},g.default.createElement(T.Input,{name:"usernameVariable"})));case"kubeconfig":return g.default.createElement(T.Form.Item,{label:t("Kubeconfig Variable")},g.default.createElement(T.Input,{name:"variable"}));case"kubeconfigFile":return g.default.createElement(T.Form.Item,{label:t("KubeconfigFile Variable")},g.default.createElement(T.Input,{name:"variable"}));default:return null}},n.getCredentialsListData=function(e){return n.props.store.getCredentials(e)},n.getCredentialsList=function(){return(0,l.default)(n.props.store.credentialsList.data.map((function(e){return{label:e.name,value:e.name,type:e.type,disabled:!1}})))},n.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return g.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",g.default.createElement(T.Tag,{type:n?"":"warning"},"ssh"===r?"SSH":t(r)))},n.formRef=g.default.createRef(),n.state={formData:{},credentialType:"username_password"},n}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.props.store.getCredentials(),this.initEditor()}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.props.store.credentialsList;return g.default.createElement(R.default,{width:680,bodyClassName:k.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("withCredentials")},g.default.createElement(T.Form,{data:this.state.formData,ref:this.formRef},g.default.createElement(T.Form.Item,{label:t("CREDENTIAL_NAME"),rules:[{required:!0,message:t("PARAM_REQUIRED")}],desc:g.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),g.default.createElement("span",{className:k.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL")))},g.default.createElement(T.Select,{name:"credentialsId",options:this.getCredentialsList(),pagination:(0,_.default)(n,["page","limit","total"]),isLoading:n.isLoading,onFetch:this.getCredentialsListData,onChange:this.handleCredentialChange,optionRenderer:this.optionRender,valueRenderer:this.optionRender,searchable:!0,clearable:!0})),this.renderParams()))}}]),r}(g.default.Component),E.propTypes={name:b.default.string},E.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},h=y,v=(0,p.default)(h.prototype,"handleCredentialChange",[O.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.getCredentialsList().find((function(e){return e.value===t})),r=(0,S.default)(a,"type","username_password");e.setState({credentialType:r,formData:{credentialsId:t}})}}}),m=h))||m;a.default=A},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(66),r(20),r(87),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(71),r(139),r(817),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(31)),u=n(r(58)),o=n(r(97)),c=n(r(62)),s=n(r(25)),i=n(r(28)),f=n(r(74)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(45)),v=(n(r(63)),n(r(246)));r(12),r(32),r(3),r(10),r(44),r(6),r(66),r(20),r(27),r(87),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(30),r(11),r(69),r(71),r(817),r(7);var E,y,g,b,S,_,O,C,T,R=n(r(0)),D=n(r(1)),k=n(r(67)),N=n(r(244)),I=n(r(26)),P=n(r(68)),A=n(r(163)),w=r(17),L=r(243),M=r(189),x=n(r(798)),j=n(r(836));function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var G=function(e){var t=Object.keys(e).map((function(t){if("object"===(0,v.default)(e[t])){var a=Object.keys(e[t]).map((function(a){return"".concat(a,": '").concat(e[t][a],"'")})).join(", ");return"".concat(t,": [[").concat(a,"]]")}return"".concat(t,": '").concat(e[t],"'")})).join(", ");return"[".concat(t,"]")},B=(0,L.observer)((T=C=function(e){(0,d.default)(r,e);var a=V(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return e=a.call.apply(a,[this].concat(l)),(0,c.default)(e,"formData",g,(0,f.default)(e)),e.formRef=R.default.createRef(),(0,c.default)(e,"dockerCredentials",b,(0,f.default)(e)),(0,c.default)(e,"isShowAdvenced",S,(0,f.default)(e)),(0,c.default)(e,"isShowDetail",_,(0,f.default)(e)),(0,c.default)(e,"handleCredentialChange",O,(0,f.default)(e)),e.handleAddDockerCredential=function(){e.dockerCredentials.push({key:"".concat(Math.random())})},e.initData=function(){var t=e.formData.dockerCredentials;if(e.dockerCredentials=[],t){var a=t.match(/\$\{(\[(.+)\])\}$/),r=(0,I.default)(a,"[2]","").match(/(\[(.+)\])+/g);if((0,k.default)(r))e.dockerCredentials=[];else{var n=r[0].split("],[").map((function(t){var a={};return t.replace("[","").replace("]","").split(",").forEach((function(t){var r=e.handleStrToArr(t),n=(0,o.default)(r,2),l=n[0],u=n[1];a.key=u,a[l]=u})),a}));e.dockerCredentials=n}}else e.dockerCredentials=[]},e.handleStrToArr=function(e){var t=e.split(":"),a=(0,o.default)(t,2),r=a[0],n=a[1];return[r=r.trim(),n=n.trim().replace(/'/g,"")]},e.showAdvencedSetting=function(){e.isShowAdvenced=!0},e.handleRemove=function(t){return function(){e.dockerCredentials=e.dockerCredentials.filter((function(e){return e.key!==t}))}},e.toggleDesc=function(){e.isShowDetail=!e.isShowDetail},e.handleOk=function(){e.formRef.current.validate((function(){var t=Object.keys(e.formData).map((function(t){return{key:t,value:{isLiteral:!0,value:e.formData[t]}}}));if(e.isShowAdvenced){var a=e.dockerCredentials.reduce((function(t,a,r){return delete a.key,r===e.dockerCredentials.length-1?"".concat(t+G(a)):"".concat(t+G(a),",")}),"");if(!(0,k.default)(a)||"[]"!==a){var r=t.find((function(e){return"dockerCredentials"===e.key}));r?((0,P.default)(r,"value.value","${[".concat(a,"]}")),(0,P.default)(r,"value.isLiteral",!1)):t.push({key:"dockerCredentials",value:{isLiteral:!1,value:"${[".concat(a,"]}")}})}}e.props.onAddStep({name:"kubernetesDeploy",arguments:t.filter((function(e){return""!==e.value.value}))})}))},e.renderDockerCredentials=function(){var a=e.props.store.credentialsList;return R.default.createElement("div",{className:j.default.dockerCredentialsContent},R.default.createElement("div",{className:j.default.dockerCredentialsContent__title},t("Kubernetes Secrets")),R.default.createElement(M.Form.Item,{label:t("Kubernetes Namespace for Secret")},R.default.createElement(M.Input,{name:"secretNamespace"})),R.default.createElement(M.Form.Item,{label:t("SECRET")},R.default.createElement(M.Input,{name:"secretName"})),R.default.createElement("div",{className:j.default.dockerCredentialsContent__title},t("Docker Container Registry Credentials")),R.default.createElement("div",null,(0,w.toJS)(e.dockerCredentials).map((function(r){return R.default.createElement("div",{key:r.key,className:j.default.dockerCredentialsContent__content},R.default.createElement(M.Icon,{name:"trash",clickable:!0,className:j.default.dockerCredentialsContent__trashicon,onClick:e.handleRemove(r.key)}),R.default.createElement(M.Form.Item,{label:t("Docker Registry URL")},R.default.createElement(M.Input,{value:r.url,onChange:e.handleCredentialChange(r.key,"url")})),R.default.createElement(M.Form.Item,{label:t("Registry Credentials")},R.default.createElement(M.Select,{value:r.credentialsId,options:e.getRepoCredentialsList(),pagination:(0,N.default)(a,["page","limit","total"]),isLoading:a.isLoading,onFetch:e.getCredentialsListData,optionRenderer:e.optionRender,valueRenderer:e.optionRender,searchable:!0,clearable:!0,onChange:function(t){return e.handleCredentialChange(r.key,"credentialsId")(t)}})))})),R.default.createElement("div",{onClick:e.handleAddDockerCredential,className:j.default.clickable},t("Add another credential"))))},e.getCredentialsListData=function(t){return e.props.store.getCredentials(t)},e.getCredentialsList=function(){return(0,u.default)(e.props.store.credentialsList.data.map((function(t){return{label:t.name,value:t.name,type:t.type,disabled:!e.props.store.isKubeconfigCredentials(t.type)}})))},e.getRepoCredentialsList=function(){return e.getCredentialsList().filter((function(t){return e.props.store.isPassWordCredentials(t.type)})).map((function(e){return F(F({},e),{},{disabled:!1})}))},e.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return R.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",R.default.createElement(M.Tag,{type:n?"default":"warning"},"ssh"===r?"SSH":t(r)))},e.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return R.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",R.default.createElement(M.Tag,{type:n?"default":"warning"},"ssh"===r?"SSH":t(r)))},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){if("kubernetesDeploy"===this.props.edittingData.type){var e=this.props.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}),t=e.dockerCredentials,a=e.secretNamespace,r=e.secretName;this.isShowAdvenced=!!(t||a||r),this.formData=e,this.initData()}}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.props.store.credentialsList;return R.default.createElement(x.default,{width:680,bodyClassName:j.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("kubernetesDeploy")},R.default.createElement("div",{className:j.default.desc},t("KUBERNETES_DEPLOY_DESC"),this.isShowDetail?t.html("KUBERNETES_DEPLOY_DESC_MORE"):null,R.default.createElement("span",{className:j.default.clickable,onClick:this.toggleDesc},this.isShowDetail?t("Collapse"):t("More"))),R.default.createElement(M.Form,{className:j.default.KubernetesForm,data:this.formData,ref:this.formRef},R.default.createElement(M.Form.Item,{label:t("Kubeconfig"),rules:[{required:!0,message:t("PARAM_REQUIRED")}],desc:R.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),R.default.createElement("span",{className:j.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL")))},R.default.createElement(M.Select,{name:"kubeconfigId",options:this.getCredentialsList(),pagination:(0,N.default)(n,["page","limit","total"]),isLoading:n.isLoading,onFetch:this.getCredentialsListData,optionRenderer:this.optionRender,valueRenderer:this.optionRender,searchable:!0,clearable:!0})),R.default.createElement(M.Form.Item,{label:t("Config File Path")},R.default.createElement(M.Input,{name:"configs"})),R.default.createElement(M.Columns,{className:"margin-t12"},R.default.createElement(M.Column,null,R.default.createElement(M.Form.Item,null,R.default.createElement(M.Checkbox,{name:"enableConfigSubstitution",checked:this.formData.enableConfigSubstitution},t("enableConfigSubstitution")))),R.default.createElement(M.Column,null,R.default.createElement(M.Form.Item,null,R.default.createElement(M.Checkbox,{name:"deleteResource",checked:this.formData.deleteResource},t("Delete all resources of the deployment file"))))),this.isShowAdvenced?this.renderDockerCredentials():R.default.createElement("div",{className:j.default.clickable,onClick:this.showAdvencedSetting},t("Show Advanced Settings"))))}}]),r}(R.default.Component),C.propTypes={name:D.default.string},C.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},y=T,g=(0,h.default)(y.prototype,"formData",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{enableConfigSubstitution:!0,deleteResource:!1}}}),b=(0,h.default)(y.prototype,"dockerCredentials",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{key:"default"}]}}),S=(0,h.default)(y.prototype,"isShowAdvenced",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=(0,h.default)(y.prototype,"isShowDetail",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),O=(0,h.default)(y.prototype,"handleCredentialChange",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){return function(r){e.dockerCredentials=e.dockerCredentials.map((function(e){return e.key===t&&("credentialsId"===a&&(0,A.default)(r)?delete e[a]:e[a]=r&&r.target?r.target.value:r),e}))}}}}),E=y))||E;a.default=B},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(20),r(87),r(24),r(1067),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(20),r(87),r(29),r(1067),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=r(189),E=n(r(798)),y=n(r(805)),g=n(r(836));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=b(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData();t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:"time"===t?Number.parseInt(e[t],10):e[t]}}}));t.props.onAddStep({name:"timeout",arguments:a.filter((function(e){return""!==e.value.value})),children:[]})}))},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(E.default,{width:680,bodyClassName:g.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:"timeout"},p.default.createElement(v.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(v.Form.Item,{label:t("time")},p.default.createElement(y.default,{name:"time"})),p.default.createElement(v.Form.Item,{label:t("unit")},p.default.createElement(v.Select,{name:"unit",options:[{value:"NANOSECONDS",label:t("NanoSeconds")},{value:"MICROSECONDS",label:t("MicroSeconds")},{value:"MILLISECONDS",label:t("MilliSeconds")},{value:"SECONDS",label:t("Seconds")},{value:"MINUTES",label:t("Minutes")},{value:"HOURS",label:t("Hours")},{value:"DAYS",label:t("Days")}],defaultValue:"MINUTES"})),p.default.createElement(v.Form.Item,null,p.default.createElement(v.RadioGroup,{name:"activity",defaultValue:!0,options:[{label:t("Timeout after no activity in logs for this block"),value:!0},{label:t("Absolute duration"),value:!1}]}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"timeout"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=r(189),y=n(r(836));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData(),a=Object.keys(e).map((function(t){return{isLiteral:!0,value:e[t]}}));t.props.onAddStep({name:"branch",arguments:a[0]})},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("BRANCH_SI")},p.default.createElement(E.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(E.Form.Item,{label:t("BRANCH_SI")},p.default.createElement(E.Input,{name:"branch"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"branch"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=r(189),y=n(r(836));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData(),a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"environment",arguments:a})},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("ENVIRONMENT_VARIABLE")},p.default.createElement(E.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(E.Form.Item,{label:t("NAME")},p.default.createElement(E.Input,{name:"name"})),p.default.createElement(E.Form.Item,{label:t("VALUE")},p.default.createElement(E.Input,{name:"value"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"environment"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=r(189),y=n(r(836));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData(),a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"expression",arguments:a})},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("expression")},p.default.createElement(E.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(E.Form.Item,{label:t("expression")},p.default.createElement(E.Input,{name:"scriptBlock"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"expression"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(26)),v=r(243),E=n(r(798)),y=r(189),g=n(r(836));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=b(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=(t.formRef.current||{}).getData();t.formRef.current.validate((function(){t.props.onAddStep({name:"withSonarQubeEnv",arguments:{isLiteral:!0,value:e.name},children:[]})}))},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(E.default,{width:680,bodyClassName:g.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("withSonarQubeEnv")},p.default.createElement(y.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(y.Alert,{type:"info",className:g.default.info,message:t("Load the sonarqube configuration provided by Jenkins into the Pipeline.")}),p.default.createElement(y.Form.Item,{label:t("config name"),rules:[{required:!0,message:t("This parameter is required")}],desc:t("sonar is the default config name.")},p.default.createElement(y.Input,{name:"name",defaultValue:"sonar"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"withSonarQubeEnv"===e.edittingData.type?{formData:{name:(0,h.default)(e.edittingData,"data.value","")}}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string,edittingData:m.default.object},u.defaultProps={edittingData:{},visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=n(r(26)),v=r(243),E=n(r(798)),y=n(r(838)),g=n(r(836));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=b(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleChange=function(e){t.isInputed=!0,t.newValue=e},t.handleOk=function(){var e=t.state.initValue;t.props.onAddStep({name:"script",arguments:[{key:"scriptBlock",value:{isLiteral:!0,value:t.isInputed?t.newValue:e}}]})},t.state={value:""},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.state.value;return p.default.createElement(E.default,{width:680,bodyClassName:g.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("script")},p.default.createElement(y.default,{className:g.default.CodeEditor,name:"script",mode:"yaml",value:n,onChange:this.handleChange}))}}],[{key:"getDerivedStateFromProps",value:function(e){if("script"===e.edittingData.type){var t=(0,h.default)(e.edittingData.data,"[0].value.value","");return{value:t,initValue:t}}return null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=r(189),E=n(r(798)),y=n(r(836));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=(t.formRef.current||{}).getData();t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"waitForQualityGate",arguments:a.filter((function(e){return""!==e.value.value}))})}))},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"options",get:function(){return[{label:t("Inspection results do not affect subsequent tasks"),value:"false"},{label:t("Start the follow-up task after the inspection"),value:"true"}]}}]),(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(E.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("waitForQualityGate")},p.default.createElement(v.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(v.Alert,{type:"info",className:y.default.info,message:t("waitForQualityGate_desc")}),p.default.createElement(v.Form.Item,{label:t("abortPipeline"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},p.default.createElement(v.Select,{name:"abortPipeline",options:this.options,defaultValue:"true"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"waitForQualityGate"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=r(189),y=n(r(836));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData();t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"mail",arguments:a.filter((function(e){return""!==e.value.value}))})}))},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("mail")},p.default.createElement(E.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(E.Form.Item,{label:t("Recipient")},p.default.createElement(E.Input,{name:"to"})),p.default.createElement(E.Form.Item,{label:t("CC")},p.default.createElement(E.Input,{name:"cc"})),p.default.createElement(E.Form.Item,{label:t("Subject"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},p.default.createElement(E.Input,{name:"subject"})),p.default.createElement(E.Form.Item,{label:t("Body"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},p.default.createElement(E.TextArea,{name:"body"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"mail"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(31)),u=n(r(58)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37));r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var d,p,m,h=n(r(0)),v=n(r(1)),E=r(243),y=n(r(798)),g=r(189),b=r(2898),S=n(r(244)),_=n(r(836));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var R=(0,E.observer)((m=p=function(e){(0,s.default)(r,e);var a=T(r);function r(e){var n;return(0,o.default)(this,r),(n=a.call(this,e)).getCredentialsListData=function(e){return n.props.store.getCredentials(e)},n.getCredentialsList=function(){return(0,u.default)(n.props.store.credentialsList.data.map((function(e){return{label:e.name,value:e.name,type:e.type,disabled:"username_password"!==e.type}})))},n.getCDListData=function(e){return n.props.store.getCDListData(e)},n.getCDList=function(){return(0,u.default)(n.props.store.cdList.data.map((function(e){return{label:e.name,value:e.name}})))},n.handleOk=function(){var e=n.formRef.current.getData();n.formRef.current.validate((function(){var t=function(e){var t=e.credentialsId,a=e.appName,r=e.devops,n=e.name,l=e.newName,u=e.branch,o=e.tag;return{arguments:{isLiteral:!0,value:"base"},children:[{arguments:{isLiteral:!1,value:"${[usernamePassword(credentialsId : '".concat(t,"' ,passwordVariable : 'PASS' ,usernameVariable : 'USER')]}")},children:[{arguments:[{key:"script",value:{isLiteral:!0,value:"ks app update --app-name ".concat(a," \\\n --app-namespace ").concat(r," \\\n --name ").concat(n," \\\n --newName ").concat(l).concat(o?":".concat(o):""," \\\n --git-password $PASS --git-username=$USER \\\n --git-target-branch ").concat(u)}}],name:"sh"}],name:"withCredentials"}],name:"container"}}(C(C({},e),{},{devops:n.props.store.params.devops}));n.props.onAddStep(t)}))},n.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return h.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",h.default.createElement(g.Tag,{type:n?"default":"warning"},"ssh"===r?"SSH":t(r)))},n.formRef=h.default.createRef(),n.state={formData:{}},n}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.getCDListData()}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.props.store,l=n.credentialsList,u=n.cdList;return h.default.createElement(y.default,{width:680,bodyClassName:_.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("UPDATE_CD_TITLE")},h.default.createElement(g.Form,{data:this.state.formData,ref:this.formRef},h.default.createElement("div",{className:_.default.columns},h.default.createElement(b.Columns,null,h.default.createElement(b.Column,{className:"is-8"},h.default.createElement(g.Form.Item,{label:t("CONTINUOUS_DEPLOYMENT_PL"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},h.default.createElement(g.Select,{name:"appName",options:this.getCDList(),pagination:(0,S.default)(u,["page","limit","total"]),isLoading:u.isLoading,onFetch:this.getCDListData,searchable:!0,clearable:!0}))),h.default.createElement(b.Column,{className:"is-4"},h.default.createElement(g.Form.Item,{label:t("BRANCH_SI"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},h.default.createElement(g.Input,{name:"branch"}))))),h.default.createElement(g.Form.Item,{label:t("ORIGINAL_IMAGE_ADDRESS"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},h.default.createElement(g.Input,{name:"name"})),h.default.createElement("div",{className:_.default.columns},h.default.createElement(b.Columns,null,h.default.createElement(b.Column,{className:"is-8"},h.default.createElement(g.Form.Item,{label:t("NEW_IMAGE_ADDRESS"),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},h.default.createElement(g.Input,{name:"newName"}))),h.default.createElement(b.Column,{className:"is-4"},h.default.createElement(g.Form.Item,{label:t("NEW_IMAGE_TAG")},h.default.createElement(g.Input,{name:"tag"}))))),h.default.createElement(g.Form.Item,{label:t("CREDENTIAL_NAME"),desc:h.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),h.default.createElement("span",{className:_.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL"))),rules:[{required:!0,message:t("PARAM_REQUIRED")}]},h.default.createElement(g.Select,{name:"credentialsId",options:this.getCredentialsList(),pagination:(0,S.default)(l,["page","limit","total"]),isLoading:l.isLoading,onFetch:this.getCredentialsListData,optionRenderer:this.optionRender,valueRenderer:this.optionRender,searchable:!0,clearable:!0}))))}}]),r}(h.default.Component),p.propTypes={name:v.default.string},p.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},d=m))||d;a.default=R},,,,,,,,function(e,t,a){e.exports={taskList:"_1mvuF0JaPOTFby-aKz7ITW",task:"InAPkmg5wGwnwPe9BYzje",taskIcon:"_2lUh-l5-2NQGDMhbgHfhV",taskInfo:"_1HUk_3vCIOVJvf7IK0CEqp",taskName:"NuEAJH1Jzt3INW8Mo4R93",desc:"_3F06DauN4121vTP-bD2kMT",back:"_3-BAt_iwWh5dqhzyMSQxeP",tabs:"GgRBNfK3fdnzSHvxQ8b5k",tab:"_1TEV7ToyQdYz_FYCOYRIdD",tab_active:"_13AN3JZRy6s65zJfzej6em"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(70),r(14),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37));r(32),r(3),r(70),r(141),r(29),r(14),r(120),r(4),r(18),r(43),r(11),r(73);var f=n(r(0)),d=n(r(5)),p=r(189),m=r(61),h=n(r(1)),v=r(17),E=n(r(119)),y=n(r(811)),g=r(1188),b=n(r(935)),S=n(r(966)),_=n(r(1469));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var C={withCredentials:!0,dir:!0,container:!0,timeout:!0,withSonarQubeEnv:!0,not:!0,allOf:!0,anyOf:!0},T=function(e){(0,c.default)(r,e);var a=O(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).step=(0,v.toJS)(e.props.step),e.toggleAddStep=function(t,a){return function(){e.context.toggleAddStep(t,a)()}},e.handleEdit=function(t,a,r,n){return function(){e.context.handleEdit(t,a,r,n)()}},e.handleDeleteStep=function(t,a,r){return function(){e.context.handleDeleteStep(t,a,r)()}},e}return(0,o.default)(r,[{key:"shouldComponentUpdate",value:function(e){if("condition"===this.props.listType)return!0;var t=(0,v.toJS)(e.step);return!(0,y.default)(this.step,t)&&(this.step=(0,E.default)((0,v.toJS)(e.step)),!0)}},{key:"render",value:function(){var e=this.props,a=e.step,r=e.index,n=e.zIndex,u=e.listType,o=e.isLast;return f.default.createElement("div",{key:JSON.stringify(a.name)+r,className:(0,d.default)("pipelineCard__item-".concat(r),S.default.pipelineCard__item),"data-id":JSON.stringify(a)+r,style:o?{border:"none"}:null},f.default.createElement("span",{className:b.default.delete,onClick:this.handleDeleteStep(r,n,u)},f.default.createElement(p.Icon,{name:"trash",clickable:!0})),u||!function(e){return m.PIPELINE_TASKS.All.includes(e)||"sh"===e}(a.name)?null:f.default.createElement("span",{className:b.default.edit,onClick:this.handleEdit(n,r,a,u)},f.default.createElement(p.Icon,{name:"wrench",clickable:!0})),f.default.createElement("div",{style:{color:"#329dce"},className:S.default.content__title},t(a.name)),(0,g.renderStepArgs)((0,v.toJS)(a)),f.default.createElement(_.default,{steps:a.children,zIndex:[].concat((0,l.default)(n),[r]),listType:u}),a.name in C?f.default.createElement("div",{className:S.default.addSteps,onClick:this.toggleAddStep([].concat((0,l.default)(n),[r]),u)},f.default.createElement(p.Icon,{name:"add"}),"  ",u?t("Add nesting ".concat(u,"s")):t("Add nesting steps")):null)}}]),r}(f.default.Component);a.default=T,T.contextTypes={toggleAddStep:h.default.func,handleEdit:h.default.func,handleDeleteStep:h.default.func}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(44),r(20),r(87),r(194),r(14),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(121),r(20),r(27),r(87),r(194),r(141),r(29),r(14),r(120),r(9),r(4),r(18),r(43),r(11);var l,u,o,c,s,i,f,d,p,m,h,v,E,y,g,b,S,_,O,C,T=n(r(62)),R=n(r(25)),D=n(r(28)),k=n(r(74)),N=n(r(41)),I=n(r(42)),P=n(r(37)),A=n(r(45)),w=(n(r(63)),r(189)),L=n(r(26)),M=n(r(67)),x=n(r(811)),j=n(r(68)),U=r(17),F=r(243),V=n(r(1)),G=n(r(0)),B=n(r(966)),z=n(r(935)),Y=n(r(1189)),H=n(r(2908)),q=n(r(1470));function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,P.default)(e);if(t){var n=(0,P.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,I.default)(this,a)}}var W=[{label:"Any",value:"any"},{label:"node",value:"node"},{label:"kubernetes",value:"kubernetes"},{label:"none",value:"none"}],Q={sh:"shell"},J=(0,F.observer)((C=O=function(e){(0,N.default)(r,e);var a=K(r);function r(){var e;(0,R.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return e=a.call.apply(a,[this].concat(l)),(0,T.default)(e,"zIndex",o,(0,k.default)(e)),(0,T.default)(e,"isEditMode",c,(0,k.default)(e)),(0,T.default)(e,"formData",s,(0,k.default)(e)),(0,T.default)(e,"showYaml",i,(0,k.default)(e)),(0,T.default)(e,"handleChangeName",f,(0,k.default)(e)),(0,T.default)(e,"handleSetYaml",d,(0,k.default)(e)),(0,T.default)(e,"hideYamlEditor",p,(0,k.default)(e)),(0,T.default)(e,"showEditor",m,(0,k.default)(e)),e.initFormData=function(){var t=(0,U.toJS)((0,L.default)(e.props.activeStage,"agent.arguments",[]));e.formData=t.reduce((function(e,t){if(Array.isArray(t.value)){var a=t.value.reduce((function(e,t){var a={};return a[t.key]=t.value.value,e.push(a),e}),[]);e[t.key]=a}else e[t.key]=t.value.value;return e}),{})},e.handleAgentTypeArg=function(){e.getAgentArguments()},e.renderAgentForms=function(){var a=(0,U.toJS)(e.labelDataList),r=(0,L.default)(a,"0.value","");switch(e.agentType){case"node":return G.default.createElement(w.Form,{data:e.formData,ref:e.formRef},G.default.createElement(w.Form.Item,{label:t("label"),desc:t("The label on which to run the Pipeline or individual stage")},G.default.createElement(w.Select,{name:"label",options:a,defaultValue:r,onChange:e.handleAgentTypeArg})));case"kubernetes":return G.default.createElement(w.Form,{data:e.formData,ref:e.formRef},G.default.createElement(w.Form.Item,{label:t("label"),desc:t("")},G.default.createElement(w.Input,{name:"label",defaultValue:"default",onChange:e.handleAgentTypeArg})),G.default.createElement(w.Form.Item,{label:t("yaml"),desc:G.default.createElement("span",{className:z.default.clickable,onClick:e.showEditor},t("show yaml editor"))},G.default.createElement(w.Input,{name:"yaml",onChange:e.handleAgentTypeArg})),G.default.createElement(w.Form.Item,{label:t("defaultContainer"),desc:t("")},G.default.createElement(w.Input,{name:"defaultContainer",onChange:e.handleAgentTypeArg})));default:return null}},(0,T.default)(e,"handleAgentTypeChange",h,(0,k.default)(e)),e.handleDelete=function(){e.props.store.deleteStage()},(0,T.default)(e,"toggleAddStep",v,(0,k.default)(e)),(0,T.default)(e,"handleEdit",E,(0,k.default)(e)),(0,T.default)(e,"handleEditCancel",y,(0,k.default)(e)),(0,T.default)(e,"handleEditStep",g,(0,k.default)(e)),(0,T.default)(e,"handleAddStep",b,(0,k.default)(e)),e.addNoInputTask=function(t){var a=e.props.activeStage;if(a.when||(0,j.default)(a,"when.conditions",[]),e.zIndex.length){var r=e.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,L.default)(a.when.conditions,"".concat(r,".children")).push({name:t,children:[]})}else a.when.conditions.push({name:t,children:[]});e.props.store.isAddingStep=!1,e.handleSetValue()},(0,T.default)(e,"handleDeleteStep",S,(0,k.default)(e)),(0,T.default)(e,"handleSortSteps",_,(0,k.default)(e)),e.handleSetValue=function(){e.props.activeStage.when&&!e.props.activeStage.when.conditions.length&&delete e.props.activeStage.when,e.props.activeStage.error&&(e.props.activeStage.error=void 0),e.props.store.setValue(e.props.activeStage)},e.cancelFocus=function(){e.getAgentArguments(),e.props.store.clearFocus()},e}return(0,D.default)(r,[{key:"getChildContext",value:function(){return{toggleAddStep:this.toggleAddStep,handleEdit:this.handleEdit,handleDeleteStep:this.handleDeleteStep}}},{key:"componentDidMount",value:function(){this.initFormData()}},{key:"componentDidUpdate",value:function(e){(0,x.default)(this.props.activeStage,e.activeStage)||this.initFormData()}},{key:"getAgentArguments",value:function(){var e=this,t=(0,L.default)(this.props.activeStage,"agent.type"),a=(0,L.default)(this.props.activeStage,"agent.arguments"),r=(0,U.toJS)(this.formData);if(t||(0,j.default)(this.props.activeStage,"agent.type","none"),!(0,M.default)(r)){var n=Object.keys(this.formData).map((function(t){var a=(0,U.toJS)(e.formData[t]);return Array.isArray(a)?{key:t,value:a.map((function(e){return Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}))[0]}))}:{key:t,value:{isLiteral:!0,value:a}}}));(0,j.default)(this.props.activeStage,"agent.arguments",(0,M.default)(n)?void 0:n)}(0,M.default)(r)&&!(0,M.default)((0,U.toJS)(a))&&delete this.props.activeStage.agent.arguments}},{key:"renderConditions",value:function(){var e=(0,L.default)(this.props,"activeStage.when.conditions");return e?G.default.createElement(q.default,{steps:e,zIndex:[],listType:"condition"}):null}},{key:"render",value:function(){var e=this.props.store.isAddingStep;return G.default.createElement("div",{className:z.default.sheet,style:{zIndex:1}},G.default.createElement("div",{className:z.default.title},t("STAGE"),G.default.createElement("span",{className:z.default.delete,onClick:this.handleDelete},G.default.createElement(w.Icon,{name:"trash",clickable:!0}))),G.default.createElement("div",{className:z.default.form},G.default.createElement(w.Form.Item,{label:t("NAME")},G.default.createElement(w.Input,{className:z.default.name_input,value:this.props.activeStage.name||"",onChange:this.handleChangeName})),G.default.createElement("div",{className:z.default.title},t("AGENT")),G.default.createElement(w.Form.Item,{desc:t("AGENT_TYPE_DESC"),label:t("TYPE")},G.default.createElement(w.Select,{options:W,defaultValue:"none",value:this.agentType,onChange:this.handleAgentTypeChange})),this.renderAgentForms(),G.default.createElement("div",{className:z.default.title},t("pipeline_conditions"),G.default.createElement("span",null,t("The conditions required to implement the current phase (optional)."))),G.default.createElement("div",{className:z.default.conditionList},this.renderConditions()),this.hasNestStage?null:G.default.createElement("div",{className:B.default.addSteps,onClick:this.toggleAddStep("","condition")},G.default.createElement(w.Icon,{name:"add"}),"  ",t("Add conditions")),G.default.createElement("div",{className:z.default.title},t("TASK")),G.default.createElement(q.default,{steps:this.steps,zIndex:[]}),this.hasNestStage?null:G.default.createElement("div",{className:B.default.addSteps,onClick:this.toggleAddStep("")},G.default.createElement(w.Icon,{name:"add"}),"  ",t("Add Step"))),G.default.createElement("div",{className:z.default.footer},G.default.createElement(w.Button,{onClick:this.cancelFocus},t("OK"))),e?G.default.createElement(H.default,{onAddStep:this.handleAddStep,store:this.props.store,isEditMode:this.isEditMode,onCancel:this.handleEditCancel,onAddNoInputTask:this.addNoInputTask,trigger:this.props.trigger}):null,G.default.createElement(Y.default,{value:this.formData.yaml||"",visible:this.showYaml,onCancel:this.hideYamlEditor,onOk:this.handleSetYaml}))}},{key:"steps",get:function(){return(0,L.default)(this.props.activeStage,"branches[0].steps",[])}},{key:"labelDataList",get:function(){return(0,L.default)(this.props.store,"labelDataList",[])}},{key:"hasNestStage",get:function(){return!!this.props.activeStage.stages}},{key:"agentType",get:function(){return(0,L.default)(this.props.activeStage,"agent.type","none")}}]),r}(G.default.Component),O.defaultProps={activeStage:{}},O.childContextTypes={toggleAddStep:V.default.func,handleEdit:V.default.func,handleDeleteStep:V.default.func},u=C,o=(0,A.default)(u.prototype,"zIndex",[U.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),c=(0,A.default)(u.prototype,"isEditMode",[U.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=(0,A.default)(u.prototype,"formData",[U.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),i=(0,A.default)(u.prototype,"showYaml",[U.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=(0,A.default)(u.prototype,"handleChangeName",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.activeStage.name=t,e.handleSetValue()}}}),d=(0,A.default)(u.prototype,"handleSetYaml",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.formData.yaml=t,e.handleAgentTypeArg(),e.showYaml=!1}}}),p=(0,A.default)(u.prototype,"hideYamlEditor",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showYaml=!1}}}),m=(0,A.default)(u.prototype,"showEditor",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showYaml=!0}}}),h=(0,A.default)(u.prototype,"handleAgentTypeChange",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a="";switch(t){case"node":a=(0,L.default)((0,U.toJS)(e.labelDataList),"0.value",""),e.formData={label:a};break;case"kubernetes":a="default",e.formData={label:a};break;default:e.formData={}}(0,j.default)(e.props.activeStage,"agent.type",t),e.handleAgentTypeArg(),e.handleSetValue()}}}),v=(0,A.default)(u.prototype,"toggleAddStep",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){return function(){e.isEditMode=!1,e.zIndex=t,e.props.store.isAddingStep=a||!0}}}}),E=(0,A.default)(u.prototype,"handleEdit",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a,r,n){return function(){e.props.store.setEdittingData({type:Q[r.name]||r.name.toLowerCase(),data:r.arguments}),e.index=a,e.zIndex=t,e.isEditMode=!0,e.props.store.isAddingStep=n||!0}}}}),y=(0,A.default)(u.prototype,"handleEditCancel",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isEditMode&&(e.isEditMode=!1,e.props.store.isAddingStep=!1,e.props.store.setEdittingData({}))}}}),g=(0,A.default)(u.prototype,"handleEditStep",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.zIndex.length){var a=e.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),""),r=(0,L.default)(e.steps,"".concat(a,".children[").concat(e.index,"].children"));r&&(t.children=r),(0,L.default)(e.steps,"".concat(a,".children")).splice(e.index,1,t)}else{var n=(0,L.default)(e.steps,"[".concat(e.index,"].children"));n&&(t.children=n),e.steps.splice(e.index,1,t)}e.props.store.isAddingStep=!1,e.isEditMode=!1,e.props.store.setEdittingData({}),e.handleSetValue()}}}),b=(0,A.default)(u.prototype,"handleAddStep",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.isEditMode)e.handleEditStep(t);else{var a=e.steps;if("string"==typeof e.props.store.isAddingStep&&(e.props.activeStage.when||(0,j.default)(e.props.activeStage,"when.conditions",[]),a=e.props.activeStage.when.conditions),e.zIndex.length){var r=e.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,L.default)(a,"".concat(r,".children")).push(t)}else a.push(t);e.props.store.isAddingStep=!1,e.handleSetValue()}}}}),S=(0,A.default)(u.prototype,"handleDeleteStep",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a,r){return function(){var n=r?e.props.activeStage.when.conditions:e.steps;if(a.length){var l=a.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,L.default)(n,"".concat(l,".children")).splice(t,1)}else n.splice(t,1);e.setState({index:1}),e.handleSetValue()}}}}),_=(0,A.default)(u.prototype,"handleSortSteps",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){if(t.length){var r=t.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),""),n=(0,L.default)(e.steps,"".concat(r,".children")),l=a.map((function(e){return n.find((function(t,a){return JSON.stringify(t)+a===e}))}));(0,j.default)(e.steps,"".concat(r,".children"),l)}else{var u=e.steps,o=a.map((function(e){return u.find((function(t,a){return JSON.stringify(t)+a===e}))}));(0,j.default)(e.props.activeStage,"branches[0].steps",o)}e.handleSetValue()}}}}),l=u))||l;a.default=J},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(87),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(87),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(73),r(7);var l=n(r(58)),u=n(r(38));r(35);var o,c,s,i,f,d,p,m=n(r(39)),h=n(r(31)),v=n(r(62)),E=n(r(25)),y=n(r(28)),g=n(r(74)),b=n(r(41)),S=n(r(42)),_=n(r(37)),O=n(r(45)),C=(n(r(63)),n(r(0))),T=n(r(5)),R=r(189),D=r(17),k=r(243),N=r(848),I=n(r(1058)),P=r(61),A=r(2909),w=n(r(935)),L=n(r(2919));function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,h.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,_.default)(e);if(t){var n=(0,_.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,S.default)(this,a)}}var U={not:!0,allOf:!0,anyOf:!0},F={branch:"network-router"},V={branch:t("Current branch name must match the input value"),environment:t("The environment variable entered before running the pipeline is match the current value."),expression:t("Enter an expression"),not:t("Negative prefix"),allOf:t("Internal nesting conditions must be matched"),anyOf:t("Internal nested conditions only need to satisfy one")},G=(0,k.observer)((c=function(e){(0,b.default)(o,e);var a,r,n=j(o);function o(e){var a;return(0,E.default)(this,o),a=n.call(this,e),(0,v.default)(a,"activeTab",s,(0,g.default)(a)),(0,v.default)(a,"handleBack",i,(0,g.default)(a)),(0,v.default)(a,"handleCancel",f,(0,g.default)(a)),(0,v.default)(a,"handleChangeActiveTab",d,(0,g.default)(a)),(0,v.default)(a,"handleAddStep",p,(0,g.default)(a)),a.handleAddTask=function(e){return function(){if(e in U)a.props.onAddNoInputTask(e);else{var t=a.state.stepTemplates.filter((function(t){return t.name===e}));t.length?a.setState({activeTask:t[0],isShowParamModal:!0}):a.setState((0,h.default)({},"isShow".concat(e),!0))}}},a.handleCreateCredential=function(){var e=(0,m.default)(u.default.mark((function e(t,r){var n,l,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.store.params,l=n.devops,o=n.cluster,e.next=3,a.props.store.createCredential(t,{devops:l,cluster:o});case 3:r(),a.hideCreateCredential();case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.hideCreateCredential=(0,m.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.store.getCredentials();case 2:a.setState({showCredential:!1});case 3:case"end":return e.stop()}}),e)}))),a.handleShowCredential=function(){a.setState({showCredential:!0})},a.renderStepsModal=function(){var e=a.props.store.params,t=e.devops,r=e.cluster,n=a.props.store,l=n.edittingData,u=n.isAddingStep,o=a.state.activeTask,c=null==o?void 0:o.parameters.some((function(e){return"secret"===e.type}));return"condition"===u?C.default.createElement(C.default.Fragment,null,C.default.createElement(A.Branch,{visible:a.state.isShowbranch,onAddStep:a.handleAddStep("branch"),onCancel:a.handleCancel("branch"),edittingData:l}),C.default.createElement(A.Environment,{visible:a.state.isShowenvironment,onAddStep:a.handleAddStep("environment"),onCancel:a.handleCancel("environment"),edittingData:l}),C.default.createElement(A.Expression,{visible:a.state.isShowexpression,onAddStep:a.handleAddStep("expression"),onCancel:a.handleCancel("expression"),edittingData:l})):C.default.createElement(C.default.Fragment,null,o&&C.default.createElement(A.Params,{visible:a.state.isShowParamModal,activeTask:o,onAddStep:a.handleAddStep("ParamModal"),onCancel:a.handleCancel("ParamModal"),showCredential:a.handleShowCredential,edittingData:l,store:a.props.store,devops:t,cluster:r,trigger:a.props.trigger}),c&&C.default.createElement(I.default,{visible:a.state.showCredential,onOk:a.handleCreateCredential,onCancel:a.hideCreateCredential,devops:t,cluster:r}))},a.renderSider=function(){if("condition"===a.props.store.isAddingStep)return C.default.createElement("div",{className:w.default.sheet,style:{zIndex:2}},C.default.createElement("div",{className:w.default.title},C.default.createElement("span",{className:(0,T.default)("custom-icon",L.default.back),onClick:a.handleBack},C.default.createElement(N.ReactComponent,null)),t("Add conditions")),C.default.createElement("div",{className:L.default.taskList},P.PIPELINE_CONDITIONS.map((function(e){return C.default.createElement("div",{className:L.default.task,key:e,onClick:a.handleAddTask(e)},C.default.createElement("div",{className:L.default.taskIcon},C.default.createElement(R.Icon,{name:F[e]||"cdn",size:24})),C.default.createElement("div",{className:L.default.taskInfo},C.default.createElement("div",{className:L.default.taskName},e),C.default.createElement("div",{className:L.default.desc},V[e]||"-")))}))));var e=a.state.stepTemplates.filter((function(e){return e.category})).reduce((function(e,t){var a=e[t.category]||[];return x(x({},e),{},(0,h.default)({},t.category,[].concat((0,l.default)(a),[t])))}),{All:a.state.stepTemplates}),r=a.state.stepTemplates.filter((function(e){return!e.category}));return r.length&&(e.others=r),C.default.createElement("div",{className:w.default.sheet,style:{zIndex:2}},C.default.createElement("div",{className:w.default.title},C.default.createElement("span",{className:(0,T.default)("custom-icon",L.default.back),onClick:a.handleBack},C.default.createElement(N.ReactComponent,null)),t("Add Step")),a.state.isLoading?C.default.createElement(R.Loading,{className:L.default.loading}):C.default.createElement(C.default.Fragment,null,C.default.createElement("div",{className:L.default.tabs},Object.keys(e).map((function(e){return C.default.createElement("div",{key:e,className:(0,T.default)(L.default.tab,(0,h.default)({},L.default.tab_active,a.activeTab===e)),onClick:a.handleChangeActiveTab(e)},t(e))}))),C.default.createElement("div",{className:L.default.taskList},(e[a.activeTab]||[]).map((function(e){return C.default.createElement("div",{className:L.default.task,key:e.name,onClick:a.handleAddTask(e.name)},C.default.createElement("div",{className:L.default.taskIcon},C.default.createElement(R.Icon,{name:e.icon||"cdn",size:24})),C.default.createElement("div",{className:L.default.taskInfo},C.default.createElement("div",{className:L.default.taskName},C.default.createElement("span",null,t(e.title))),C.default.createElement("div",{className:L.default.desc},t(e.desc)||"-")))})))))},a.state=x({isLoading:!0,stepTemplates:[],activeTask:null,showCredential:!1,isShowParamModal:!1},P.PIPELINE_CONDITIONS.reduce((function(e,t){return x(x({},e),{},(0,h.default)({},"isShow".concat(t),!1))}),{})),a}return(0,y.default)(o,[{key:"componentDidMount",value:(r=(0,m.default)(u.default.mark((function e(){var t,a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.props.store.edittingData.type)||!P.PIPELINE_CONDITIONS.includes(t)){e.next=4;break}return this.setState((0,h.default)({},"isShow".concat(t),!0)),e.abrupt("return");case 4:if(!t){e.next=10;break}return e.next=7,this.props.store.fetchStepTemplate(t);case 7:return(a=e.sent)&&this.setState({activeTask:a,isShowParamModal:!0}),e.abrupt("return");case 10:return e.next=12,this.getPipelineSteps();case 12:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getPipelineSteps",value:(a=(0,m.default)(u.default.mark((function e(){var t;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.store.params.cluster,e.next=3,this.props.store.fetchPipelineStepTemplates({cluster:t});case 3:this.setState({stepTemplates:(0,l.default)(this.steps),isLoading:!1});case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){return C.default.createElement(C.default.Fragment,null,this.props.isEditMode?null:this.renderSider(),this.renderStepsModal())}},{key:"steps",get:function(){return this.props.store.pipelineSteps}}]),o}(C.default.Component),s=(0,O.default)(c.prototype,"activeTab",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"All"}}),i=(0,O.default)(c.prototype,"handleBack",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.store.isAddingStep=!1}}}),f=(0,O.default)(c.prototype,"handleCancel",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(){e.setState((0,h.default)({},"isShow".concat(t),!1)),e.props.onCancel()}}}}),d=(0,O.default)(c.prototype,"handleChangeActiveTab",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(){e.activeTab=t}}}}),p=(0,O.default)(c.prototype,"handleAddStep",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){e.props.onAddStep(a),e.setState((0,h.default)({},"isShow".concat(t),!1))}}}}),o=c))||o;a.default=G},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Branch",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Environment",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Expression",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Params",{enumerable:!0,get:function(){return o.default}});var n=r(a(2910)),l=r(a(2911)),u=r(a(2912)),o=r(a(2913))},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=r(189),y=n(r(1010));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData(),a=Object.keys(e).map((function(t){return{isLiteral:!0,value:e[t]}}));t.props.onAddStep({name:"branch",arguments:a[0]})},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("BRANCH_SI")},p.default.createElement(E.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(E.Form.Item,{label:t("BRANCH_SI")},p.default.createElement(E.Input,{name:"branch"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"branch"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=r(189),y=n(r(1010));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData(),a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"environment",arguments:a})},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("ENVIRONMENT_VARIABLE")},p.default.createElement(E.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(E.Form.Item,{label:t("NAME")},p.default.createElement(E.Input,{name:"name"})),p.default.createElement(E.Form.Item,{label:t("VALUE")},p.default.createElement(E.Input,{name:"value"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"environment"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(87),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(87),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(243),v=n(r(798)),E=r(189),y=n(r(1010));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var b=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=g(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.formRef.current.getData(),a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"expression",arguments:a})},t.formRef=p.default.createRef(),t.state={formData:{}},t}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel;return p.default.createElement(v.default,{width:680,bodyClassName:y.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:t("expression")},p.default.createElement(E.Form,{data:this.state.formData,ref:this.formRef},p.default.createElement(E.Form.Item,{label:t("expression")},p.default.createElement(E.Input,{name:"scriptBlock"}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return"expression"===e.edittingData.type?{formData:e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}:null}}]),r}(p.default.Component),u.propTypes={name:m.default.string},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=b},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(70),r(36),r(20),r(87),r(14),r(327),r(138),r(99),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(46),r(69),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(317)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(97)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(31));r(12),r(32),r(10),r(44),r(6),r(70),r(121),r(36),r(20),r(27),r(87),r(29),r(14),r(327),r(138),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(46),r(69),r(7),r(40);var h,v,E,y=n(r(0)),g=r(189),b=n(r(191)),S=n(r(805)),_=r(17),O=n(r(68)),C=n(r(67)),T=n(r(26)),R=n(r(798)),D=n(r(838)),k=n(r(1066)),N=r(902),I=r(243),P=r(61),A=n(r(2914)),w=n(r(2915)),L=n(r(2916)),M=r(2917),x=n(r(1010)),j=n(r(2918));function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){(0,m.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var G=new Map([[!0,"true"],[!1,"false"]]),B={secret_text:"string",username_password:"usernamePassword",ssh:"sshUserPrivateKey",kubeconfig:"kubeconfigContent"},z=function(e){var t,a=/\$\{\[([\w-]*)\(/,r=e.match(a)&&e.match(a)[1];return r?null===(t=Object.entries(B).find((function(e){return e[1]===r})))||void 0===t?void 0:t[0]:null},Y=(0,I.observer)((E=v=function(e){(0,f.default)(r,e);var a=U(r);function r(e){var n;return(0,s.default)(this,r),(n=a.call(this,e)).handleCodeEditorChange=function(e){return function(t){var a=n.state.formData;(0,O.default)(a,e,t)}},n.handleCheckboxChange=function(e){return function(t){var a=n.state.formData;(0,O.default)(a,e,t),n.setState({formData:a})}},n.handleSecretChange=function(e){return function(t){var a=n.state,r=a.formData,l=a.reactionForm,u=n.props.store.credentialsList.data.filter((function(e){return e.name===t}));u.length?e.postByQuery?n.query={secret:u[0].name,secretNamespace:u[0].namespace}:(0,O.default)(r,e.name,{name:u[0].name,type:"credential.devops.kubesphere.io/".concat(P.CREDENTIAL_KEY[u[0].type])}):(n.query={},(0,O.default)(r,e.name,{name:"",type:""})),l.handleFieldValueChange(e.name,(0,T.default)(r,e.name)),n.setState({formData:r})}},n.handleOk=function(){var e=n.props,a=e.activeTask,r=e.store,l=e.onAddStep,s=e.onCancel,i=n.state,f=i.typeMap,d=i.initData,p=i.reactionForm,h=Object.entries(p.getValues()).reduce((function(e,t){var a=(0,c.default)(t,2),r=a[0],n=a[1],l="bool"===f[r],u="number"==typeof n?n.toString():n;return V(V({},e),{},(0,m.default)({},r,l?G.get(u):u))}),{});n.formRef.current.validate((0,o.default)(u.default.mark((function e(){var o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getPipelineStepTempleJenkins(a.name,V(V({},d),h),n.query);case 2:o=e.sent;try{l(JSON.parse(o))}catch(e){b.default.error({content:t("ERROR")}),s()}case 4:case"end":return e.stop()}}),e)}))))},n.formRef=y.default.createRef(),n.query={},n.state={formData:{},value:"",typeMap:{},initData:{},name:"",reactionForm:new M.Reaction((function(){n.forceUpdate()}),{getRepoUrl:N.getRepoUrl})},n}return(0,i.default)(r,[{key:"renderFormItem",value:function(e){var a;if(e.condition&&!(0,N.parseCondition)(e.condition,this.state.formData))return null;var r=this.props.store,n={key:e.name,label:t(e.display),rules:[{required:null!==(a=e.required)&&void 0!==a&&a,message:t("PARAM_REQUIRED")}]};switch(e.type){case"pipeline":return y.default.createElement(A.default,{key:e.name,option:e,store:r});case"application":return y.default.createElement(w.default,{key:e.name,option:e,store:r});case"secret":return y.default.createElement(L.default,{key:e.name,option:e,store:r,formData:this.state.formData,onChange:this.handleSecretChange(e),showCredential:this.props.showCredential});case"number":return y.default.createElement(g.Form.Item,n,y.default.createElement(S.default,{name:e.name}));case"text":return y.default.createElement(g.Form.Item,n,y.default.createElement(g.TextArea,{name:e.name,rows:8}));case"enum":return y.default.createElement(g.Form.Item,n,y.default.createElement(g.Select,{name:e.name,options:e.options||[]}));case"code":return y.default.createElement(g.Form.Item,(0,l.default)({},n,{label:null}),y.default.createElement(D.default,{key:e.name,className:x.default.CodeEditor,name:e.name,mode:"yaml"}));case"bool":return y.default.createElement(g.Form.Item,V(V({},n),{},{label:"",desc:""}),y.default.createElement(g.Checkbox,{name:e.name,checked:(0,T.default)(this.state.formData,e.name,!1),onChange:this.handleCheckboxChange(e.name)},t(e.display)));case"hidden":return null;case"radioGroup":return y.default.createElement(g.Form.Item,n,y.default.createElement(g.RadioGroup,{name:e.name,options:e.options.map((function(e){return{value:e.value,label:t(e.label)}}))||[]}));case"codeRepository":return y.default.createElement(g.Form.Item,n,y.default.createElement(k.default,{name:e.name,cluster:this.props.cluster,devops:this.props.devops,isCreatePipeline:!0,trigger:this.props.trigger}));case"importCodeRepo":return y.default.createElement(g.Form.Item,n,y.default.createElement(j.default,{name:e.name,cluster:this.props.cluster,devops:this.props.devops,isCreatePipeline:!0,trigger:this.props.trigger}));case"string":default:return y.default.createElement(g.Form.Item,n,y.default.createElement(g.Input,{name:e.name}))}}},{key:"render",value:function(){var e=this,t=this.props,a=t.visible,r=t.onCancel,n=t.activeTask,l=["secret"],u=this.state.reactionForm;return y.default.createElement(R.default,{width:680,bodyClassName:x.default.body,onCancel:r,onOk:this.handleOk,visible:a,closable:!1,title:n.title},y.default.createElement(g.Form,{data:u.getValues(),ref:this.formRef,onChange:function(t,a){var r;l.includes(null===(r=n.parameters.find((function(e){return e.name===t})))||void 0===r?void 0:r.type)||e.state.reactionForm.handleFieldValueChange(t,a)}},u.getFields().map((function(t){return e.renderFormItem(t)}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a,r=e.activeTask,n=e.edittingData,l=r.name,u=r.parameters;if(l===t.name)return null;var o,c=t.reactionForm,s=function(e){return null==e?void 0:e.reduce((function(e,t){var a=t.name,r=t.type,n=t.defaultValue;return{initData:V(V({},e.initData),{},(0,m.default)({},a,"bool"===r?"true"===n:n||"")),typeMap:V(V({},e.typeMap),{},(0,m.default)({},a,r)),codeKey:"code"===r?a:e.codeKey}}),{initData:{},typeMap:{},codeKey:""})}(u),i=s.initData,f=s.typeMap,d=s.codeKey;if((0,C.default)(n))return c.init(null!==(o=r.parameters)&&void 0!==o?o:[],d?i[d]:i),d?{value:i[d],initData:i,typeMap:f,name:l,reactionForm:c}:{formData:i,initData:i,typeMap:f,name:l,reactionForm:c};var p={},h="",v=(0,_.toJS)(n),E=v.data,y=v.type;if("checkout"===y)p=function(e){return e.data.reduce((function(e,t){if("scm"===t.key){var a=t.value.value;a&&Object.assign(e,(0,N.groovyToJS)(a))}return e[t.key]=t.value.value,e}),{})}(n);else if("withcredentials"===y)p=function(e){var t=(0,T.default)(e,"data.value","");if(t){var a=z(t);return V(V({},(0,N.groovyToJS)(t)),{},{type:"credential.devops.kubesphere.io/".concat(P.CREDENTIAL_KEY[a])})}return{}}(n);else if(d){var g,b;h=(Array.isArray(E)?null===(g=E[0])||void 0===g||null===(b=g.value)||void 0===b?void 0:b.value:E.value)||"",p=(0,m.default)({},d,h)}else p=Array.isArray(E)?E.reduce((function(e,t){var a=t.value.value;return e[t.key]=a,"bool"===f[t.key]&&(e[t.key]="boolean"==typeof a?a:"true"===a),e}),{}):Object.keys(i).reduce((function(e,t){return V(V({},e),{},(0,m.default)({},t,E.value||""))}),{});return c.init(null!==(a=r.parameters)&&void 0!==a?a:[],p),{formData:p,value:h,initData:i,typeMap:f,name:l,reactionForm:c}}}]),r}(y.default.Component),v.formProps={visible:!1,onOk:function(){},onCancel:function(){}},h=E))||h;a.default=Y},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var u,o=n(r(58)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=l(r(0)),m=n(r(244)),h=r(243),v=r(189);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var y=(0,h.observer)(u=function(e){(0,i.default)(r,e);var a=E(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).getPipelineListData=function(t){return e.props.store.getPipelines(t)},e.getPipelineList=function(){return(0,o.default)(e.props.store.pipelineList.data.map((function(e){return{label:e.name,value:e.name}})))},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.getPipelineListData()}},{key:"render",value:function(){var e,a=this.props.option,r=this.props.store.pipelineList,n={key:a.name,label:t(a.display),rules:[{required:null!==(e=a.required)&&void 0!==e&&e,message:t("PARAM_REQUIRED")}]};return p.default.createElement(v.Form.Item,n,p.default.createElement(v.Select,{name:a.name,options:this.getPipelineList(),pagination:(0,m.default)(r,["page","limit","total"]),isLoading:r.isLoading,onFetch:this.getPipelineListData,searchable:!0,clearable:!0}))}}]),r}(p.Component))||u;a.default=y},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(44),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var u,o=n(r(58)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(50)),m=l(r(0)),h=n(r(244)),v=r(243),E=r(189);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var g=function(e){return(0,e.renderItem)((0,p.default)(e,["renderItem"]))},b=(0,v.observer)(u=function(e){(0,i.default)(r,e);var a=y(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).getCDListData=function(t){return e.props.store.getCDListData(t)},e.getCDList=function(){return(0,o.default)(e.props.store.cdList.data.map((function(e){return{label:e.name,value:e.name}})))},e}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.getCDListData()}},{key:"render",value:function(){var e,a=this,r=this.props.option,n=this.props.store.cdList,l={key:r.name,label:t(r.display),rules:[{required:null!==(e=r.required)&&void 0!==e&&e,message:t("PARAM_REQUIRED")}]};return m.default.createElement(E.Form.Item,l,m.default.createElement(g,{name:r.name,renderItem:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value,l=e.onChange;return m.default.createElement(E.Select,{name:r.name,options:a.getCDList(),pagination:(0,h.default)(n,["page","limit","total"]),isLoading:n.isLoading,onFetch:a.getCDListData,value:null==t?void 0:t.name,onChange:function(e){var t,r,n=e?null===(t=a.props.store.cdList)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.find((function(t){return t.name===e})):null;l(n?{name:n.name,namespace:n.devops}:null)},searchable:!0,clearable:!0})}}))}}]),r}(m.Component))||u;a.default=b},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var u=n(r(38));r(35);var o,c=n(r(39)),s=n(r(58)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=l(r(0)),v=n(r(244)),E=n(r(26)),y=r(189),g=r(243),b=n(r(1468));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var _=(0,g.observer)(o=function(e){(0,d.default)(n,e);var a,r=S(n);function n(){var e;(0,i.default)(this,n);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(e=r.call.apply(r,[this].concat(l))).getCredentialsListData=function(t){return e.props.store.getCredentials(t)},e.getCredentialsList=function(t){return(0,s.default)(e.props.store.credentialsList.data.map((function(e){return{label:e.name,value:e.name,type:e.type,disabled:!!t.secretType&&e.type!==t.secretType}})))},e.optionRender=function(e){var a=e.label,r=e.type,n=e.disabled;return h.default.createElement("span",{style:{display:"flex",alignItem:"center"}},a,"  ",h.default.createElement(y.Tag,{type:n?"":"warning"},"ssh"===r?"SSH":t(r)))},e}return(0,f.default)(n,[{key:"componentDidMount",value:(a=(0,c.default)(u.default.mark((function e(){var t,a,r,n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.formData,r=t.onChange,n=t.option,e.next=3,this.getCredentialsListData();case 3:(0,E.default)(a,"".concat(n.name,".name"))||r(a[n.name]);case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderCredentialDesc",value:function(){return h.default.createElement("p",null,t("SELECT_CREDENTIAL_DESC"),h.default.createElement("span",{className:b.default.clickable,onClick:this.props.showCredential},t("CREATE_CREDENTIAL")))}},{key:"render",value:function(){var e,a=this.props,r=a.option,n=a.onChange,l=this.props.store.credentialsList,u={key:r.name,label:t(r.display),rules:[{required:null!==(e=r.required)&&void 0!==e&&e,message:t("PARAM_REQUIRED")}],desc:this.renderCredentialDesc()};return h.default.createElement(y.Form.Item,u,h.default.createElement(y.Select,{name:"".concat(r.name,".name"),options:this.getCredentialsList(r),pagination:(0,v.default)(l,["page","limit","total"]),isLoading:l.isLoading,onFetch:this.getCredentialsListData,searchable:!0,clearable:!0,onChange:n}))}}]),n}(h.Component))||o;a.default=_},function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(36),a(20),a(87),a(14),a(99),a(8),a(13),a(9),a(4),a(190),a(30),a(71),a(7),a(40),Object.defineProperty(t,"__esModule",{value:!0}),t.runTemplate=h,t.Reaction=t.defaultConfig=void 0;var n=r(a(97)),l=r(a(25)),u=r(a(31)),o=r(a(246));a(12),a(10),a(6),a(36),a(20),a(27),a(87),a(141),a(446),a(14),a(120),a(33),a(16),a(99),a(8),a(13),a(9),a(4),a(190),a(30),a(195),a(71),a(7),a(40);var c=r(a(1162)),s=r(a(68)),i=r(a(26)),f=r(a(140));function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m=[{name:"fromCodeRepository",type:"importCodeRepo",reactions:JSON.stringify([{target:"url",fulfill:{state:{value:"{{$context?.getRepoUrl?.($self.value)}}"}}},{target:"credentialsId",fulfill:{state:{value:"{{$self.value?.secret}}"}}}])},{name:"url",type:"string",required:!0,display:"URL"},{name:"credentialsId",type:"secret",display:"Credential Name"},{name:"codeRepository",type:"codeRepository",required:!0,display:"CODE_REPO"},{name:"branch",type:"string",required:!0,display:"Branch",defaultValue:"master"}];function h(e,t){var a=/^\s*\{\{([\s\S]*)\}\}\s*$/;if(a.test(e)){var r=[],n=e.replace(a,(function(e,a){try{var n=new Function("root","with(root) {return ".concat(a,"}"))(t);return"object"===(0,o.default)(n)?(r.push(n),"res[".concat(r.length-1,"]")):n}catch(e){return console.error("Error evaluating expression:",e),"undefined"}}));try{return r.length?new Function("root","with(root) {return ".concat(n,"}"))(p({res:r},t)):n}catch(e){return}}return e}t.defaultConfig=m;t.Reaction=function e(t){var a=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,l.default)(this,e),this.state={},this.values={},this.config=[],this.context={},this.init=function(e,t){var r=e.map((function(e){return p(p({},e),{},{reactions:e.reactions?JSON.parse(e.reactions):[]})}));a.config=r;var n=0,l=[],u={},o=[];r.forEach((function(e){var r;void 0!==(0,i.default)(t,e.name)&&(0,s.default)(u,e.name,t[e.name]),l[e.name]={order:n++,display:"block",value:(0,i.default)(t,e.name),reactions:null!==(r=e.reactions)&&void 0!==r?r:[],"x-props":e},o.push((function(){a.handleValueChange({key:e.name,value:(0,i.default)(t,e.name)},!0)}))})),a.state=l,a.values=u,o.forEach((function(e){return e()}))},this.setValues=function(e,t){void 0!==t?(0,s.default)(a.values,e,t):a.values=(0,f.default)(a.values,e)},this.handleValueChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=a.state;a.setValues(e.key,e.value),a.state[e.key].value=e.value;var n=r[e.key].reactions;null==n||n.forEach((function(n){a.getStateByReaction(n,r[e.key],t)}))},this.getStateByReaction=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=e.target,u=e.fulfill,o=[];Object.entries(u.state).forEach((function(e){var u=(0,n.default)(e,2),c=u[0],s=u[1];if(!r||"value"!==c){var i=a.reactions[c],f=h(s,{$self:t,$context:a.context});a.state[l]&&(a.state[l][c]=f,i&&o.push((function(){return i(l,f)})))}})),o.forEach((function(e){return e()}))},this.handleFieldValueChange=function(e,t){var r;a.state[e]&&(a.handleValueChange({key:e,value:t}),null===(r=a.update)||void 0===r||r.call(a))},this.handleChangeValue=function(e,t){a.handleValueChange({key:e,value:t})},this.handleDisplayChange=function(e,t){"none"!==t?a.handleValueChange({key:e,value:a.state[e].value}):a.handleValueChange({key:e,value:void 0})},this.getValues=function(){return a.values},this.getFields=function(){return(0,c.default)(Object.values(a.state),"order").reduce((function(e,t){return"block"===t.display&&e.push(t["x-props"]),e}),[])},this.update=t,this.context=r,this.reactions={display:this.handleDisplayChange.bind(this),value:this.handleChangeValue.bind(this)}}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(317)),o=l(r(97)),c=l(r(50)),s=n(r(0)),i=l(r(1066)),f=r(189),d=l(r(798)),p=r(17);a.default=function(e){e.value;var a=e.onChange,r=e.devops,n=(0,c.default)(e,["value","onChange","devops"]),l=s.useState(!1),m=(0,o.default)(l,2),h=m[0],v=m[1],E=s.useState(),y=(0,o.default)(E,2),g=y[0],b=y[1];return s.createElement("div",null,s.createElement(f.Button,{style:{height:24},size:"small",onClick:function(){return v(!0)}},t("IMPORT_FROM_CODE_REPO")),s.createElement(d.default,{title:t("IMPORT_FROM_CODE_REPO"),visible:h,onCancel:function(){return v(!1)},onOk:function(){a((0,p.toJS)(g)),v(!1)}},s.createElement("div",{style:{minHeight:270}},s.createElement(i.default,(0,u.default)({},n,{isCreatePipeline:!1,devops:r,onChange:b,value:g})))))}},function(e,t,a){e.exports={taskList:"_2loGhzv-O4GHTu099n1Cyv",task:"_3H5tvVgBDXf5LETASGtiQX",taskIcon:"asNYafbtn7uKGjr5sY-W7",taskInfo:"T1TGQgJXmgkWz6kfGHnpl",taskName:"HhpjXE4lv1c6-E-Njs0GB",desc:"_1Dc2Z_g9XfSxnUhp4sdhcW",back:"cvvjfvqaVKSa83bk1OARZ",tabs:"_2L811SJ-R9sRJovtFY5HnN",tab:"_3Maur7P1LAsNs0yts_dt3h",tab_active:"_3Xttzou4W6mEktK8OWPKbx",loading:"LtyrCDUgHMI9Qxb85FWVO"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(121),r(141),r(29),r(14),r(120),r(4),r(18),r(43),r(11);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(5)),p=r(189),m=n(r(1)),h=r(17),v=n(r(119)),E=n(r(811)),y=r(1188),g=n(r(935)),b=n(r(966)),S=n(r(1470));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var O={not:!0,allOf:!0,anyOf:!0},C=function(e){(0,c.default)(r,e);var a=_(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).step=(0,h.toJS)(e.props.step),e.toggleAddStep=function(t,a){return function(){e.context.toggleAddStep(t,a)()}},e.handleEdit=function(t,a,r,n){return function(){e.context.handleEdit(t,a,r,n)()}},e.handleDeleteStep=function(t,a,r){return function(){e.context.handleDeleteStep(t,a,r)()}},e}return(0,o.default)(r,[{key:"shouldComponentUpdate",value:function(e){if("condition"===this.props.listType)return!0;var t=(0,h.toJS)(e.step);return!(0,E.default)(this.step,t)&&(this.step=(0,v.default)((0,h.toJS)(e.step)),!0)}},{key:"render",value:function(){var e=this.props,a=e.step,r=e.index,n=e.zIndex,u=e.listType,o=e.isLast;return f.default.createElement("div",{key:JSON.stringify(a.name)+r,className:(0,d.default)("pipelineCard__item-".concat(r),b.default.pipelineCard__item),"data-id":JSON.stringify(a)+r,style:o?{border:"none"}:null},f.default.createElement("span",{className:g.default.delete,onClick:this.handleDeleteStep(r,n,u)},f.default.createElement(p.Icon,{name:"trash",clickable:!0})),u?null:f.default.createElement("span",{className:g.default.edit,onClick:this.handleEdit(n,r,a,u)},f.default.createElement(p.Icon,{name:"wrench",clickable:!0})),f.default.createElement("div",{style:{color:"#329dce"},className:b.default.content__title},t(a.name)),(0,y.renderStepArgs)((0,h.toJS)(a)),f.default.createElement(S.default,{steps:a.children,zIndex:[].concat((0,l.default)(n),[r]),listType:u}),a.name in O||Array.isArray(a.children)?f.default.createElement("div",{className:b.default.addSteps,onClick:this.toggleAddStep([].concat((0,l.default)(n),[r]),u)},f.default.createElement(p.Icon,{name:"add"}),"  ",u?t("Add nesting ".concat(u,"s")):t("Add nesting steps")):null)}}]),r}(f.default.Component);a.default=C,C.contextTypes={toggleAddStep:m.default.func,handleEdit:m.default.func,handleDeleteStep:m.default.func}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(88),r(66),r(20),r(194),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(38));r(35);var u=n(r(39)),o=n(r(62)),c=n(r(25)),s=n(r(28)),i=n(r(74)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=(n(r(63)),n(r(45))),h=n(r(31));r(12),r(32),r(3),r(10),r(6),r(88),r(66),r(20),r(27),r(194),r(141),r(29),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(321),r(21),r(18),r(43),r(11),r(7);var v,E,y,g,b,S,_,O,C,T,R,D,k,N,I,P,A=n(r(191)),w=n(r(119)),L=n(r(26)),M=n(r(64)),x=n(r(67)),j=n(r(76)),U=n(r(68)),F=n(r(196)),V=r(17),G=n(r(248)),B=n(r(1432)),z=n(r(330)),Y=n(r(1164)),H=n(r(1009)),q=r(56),K=r(61),W=n(r(203));function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(Object(a),!0).forEach((function(t){(0,h.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Z=function(e){if((0,L.default)(e,"pipeline.stages")){if(e.pipeline.stages=e.pipeline.stages.map((function(e){return e.parallel?(e.parallel=e.parallel.map((function(e){return(0,F.default)(e,"branches[0].id"),delete e.error,delete e.conditionError,delete e.isActive,e})),e):((0,F.default)(e,"branches[0].id"),delete e.error,delete e.conditionError,delete e.isActive,e)})),(0,j.default)(e.pipeline.parameters)&&(0,x.default)(e.pipeline.parameters))delete e.pipeline.parameters;else{var t=(0,L.default)(e,"pipeline.parameters.parameters",[]);!(0,x.default)(t)&&(0,M.default)(t)&&t.forEach((function(e){var a=(0,L.default)(e,"arguments",[]);!(0,x.default)(t)&&(0,M.default)(a)&&a.forEach((function(e){!(0,L.default)(e,"value.value")&&e.key&&(0,U.default)(e,"value.value","")}))}))}return e}},$=function(e){var a="zh"===(0,W.default)("lang")?"ZH":"EN",r={},n=(0,L.default)(e,"metadata.annotations",{});if(r.icon=n["step.devops.kubesphere.io/icon"],r.category=(0,L.default)(e,["metadata","labels","step.devops.kubesphere.io/category"]),r.name=e.metadata.name,r.desc=n["devops.kubesphere.io/description".concat(a)]||n["devops.kubesphere.io/descriptionEN"],r.title=n["devops.kubesphere.io/displayName".concat(a)]||n["devops.kubesphere.io/displayNameEN"]||n.displayNameEN,r.parameters=(0,L.default)(e,"spec.parameters",[]).map((function(e){return X(X({},e),e.options?{options:(0,q.safeParseJSON)(e.options,[]).map((function(e){return{label:t(e.label),value:e.value}}))}:{})})),!(0,x.default)((0,L.default)(e,"spec.secret",{}))){var l,u=K.CREDENTIAL_DISPLAY_KEY[null===(l=e.spec.secret.type)||void 0===l?void 0:l.split("/")[1]];r.parameters.push({name:"secret",type:"secret",display:"Secret",postByQuery:!0,required:!0,secretType:u})}return r},ee=(v=function(e){(0,f.default)(F,e);var a,r,n,d,p,m,h,v,j=Q(F);function F(){var e;(0,c.default)(this,F);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=j.call.apply(j,[this].concat(a))).credentialStore=new Y.default,e.cdStore=new B.default,e.pipelineStore=new H.default,(0,o.default)(e,"jsonData",E,(0,i.default)(e)),(0,o.default)(e,"activeLineIndex",y,(0,i.default)(e)),(0,o.default)(e,"activeColumnIndex",g,(0,i.default)(e)),(0,o.default)(e,"isAddingStep",b,(0,i.default)(e)),(0,o.default)(e,"edittingData",S,(0,i.default)(e)),(0,o.default)(e,"params",_,(0,i.default)(e)),(0,o.default)(e,"labelDataList",O,(0,i.default)(e)),(0,o.default)(e,"credentialsList",C,(0,i.default)(e)),(0,o.default)(e,"cdList",T,(0,i.default)(e)),(0,o.default)(e,"pipelineList",R,(0,i.default)(e)),(0,o.default)(e,"pipelineSteps",D,(0,i.default)(e)),(0,o.default)(e,"getCredentials",k,(0,i.default)(e)),(0,o.default)(e,"getPipelines",N,(0,i.default)(e)),(0,o.default)(e,"getCDListData",I,(0,i.default)(e)),(0,o.default)(e,"createCredential",P,(0,i.default)(e)),e}return(0,s.default)(F,[{key:"handleAddBranch",value:function(e){this.jsonData.json.pipeline.stages[e].parallel?this.jsonData.json.pipeline.stages[e].parallel.push(this.newStage):this.jsonData.json.pipeline.stages[e]={name:"default-".concat(e),parallel:[this.jsonData.json.pipeline.stages[e],this.newStage]},this.handleSetInLocalStorage()}},{key:"handleSetInLocalStorage",value:function(){var e=this.params,t=e.devops,a=e.name;this.prevData=localStorage.setItem("".concat(globals.user.username,"-").concat(t,"-").concat(a),JSON.stringify((0,V.toJS)(this.jsonData)))}},{key:"setData",value:function(e){this.jsonData=e,Z(this.jsonData.json)}},{key:"insertColumn",value:function(e){this.jsonData.json.pipeline.stages.splice(e,0,this.newStage)}},{key:"setFocus",value:function(e,t){""!==this.activeLineIndex&&this.setActive(this.activeLineIndex,this.activeColumnIndex,void 0),this.activeLineIndex=e,this.activeColumnIndex=t,this.setActive(e,t,!0)}},{key:"setActive",value:function(e,t,a){this.jsonData.json.pipeline.stages[e]&&this.jsonData.json.pipeline.stages[e].parallel?this.jsonData.json.pipeline.stages[e].parallel[t]=X(X({},this.jsonData.json.pipeline.stages[e].parallel[t]),{isActive:a}):this.jsonData.json.pipeline.stages[e]=X(X({},this.jsonData.json.pipeline.stages[e]),{isActive:a})}},{key:"setEdittingData",value:function(e){this.edittingData=(0,w.default)(e)}},{key:"isPassWordCredentials",value:function(e){return"username_password"===e}},{key:"isKubeconfigCredentials",value:function(e){return"kubeconfig"===e}},{key:"clearFocus",value:function(){""!==this.activeLineIndex&&this.setActive(this.activeLineIndex,this.activeColumnIndex,void 0),this.activeLineIndex="",this.activeColumnIndex="",this.edittingData={},this.isAddingStep=!1}},{key:"deleteStage",value:function(){this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel?1===this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.length?this.jsonData.json.pipeline.stages.splice(this.activeLineIndex,1):2===this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.length?(this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.splice(this.activeColumnIndex,1),this.jsonData.json.pipeline.stages[this.activeLineIndex]=this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel[0]):this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.splice(this.activeColumnIndex,1):this.jsonData.json.pipeline.stages.splice(this.activeLineIndex,1),this.activeLineIndex="",this.activeColumnIndex="",this.handleSetInLocalStorage()}},{key:"setValue",value:function(e){this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel?this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.splice(this.activeColumnIndex,1,e):this.jsonData.json.pipeline.stages.splice(this.activeLineIndex,1,e),this.handleSetInLocalStorage()}},{key:"convertJsonToJenkinsFile",value:(v=(0,u.default)(l.default.mark((function e(a){var r,n=this;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.cluster,e.abrupt("return",request.post("".concat(this.getDevopsUrlV2({cluster:r}),"/tojenkinsfile"),{json:JSON.stringify(Z((0,V.toJS)(this.jsonData.json)))},{headers:{"content-type":"application/x-www-form-urlencoded"}}).then((function(e){if(e&&"success"===(0,L.default)(e,"data.result"))return n.jenkinsFile=e.data.jenkinsfile,e;e&&"failure"===(0,L.default)(e,"data.result")&&e.data.errors.forEach((function(e){if(e.location){var a=e.location.join(".").split(".branches"),r=(0,L.default)(n.jsonData.json,a[0]);if(r&&!(0,x.default)(r)){var l=-1!==e.location.indexOf("steps")?parseInt(e.location[e.location.indexOf("steps")+1],10):void 0;return void 0!==l?void(0,U.default)(n.jsonData.json,a[0],X(X({},(0,V.toJS)((0,L.default)(n.jsonData.json,a[0]))),{},{error:{error:e.error,index:l}})):void A.default.error({title:t("pipeline syntax error"),content:t(e.error),duration:6e3})}if(-1===e.location.indexOf("conditions")){var u=-1!==e.location.indexOf("steps")?parseInt(e.location[e.location.indexOf("steps")+1],10):void 0;(0,U.default)(n.jsonData.json,a[0],X(X({},(0,V.toJS)((0,L.default)(n.jsonData.json,a[0]))),{},{error:{error:e.error,index:u}}))}else{var o=e.location.join(".").split(".when"),c=-1!==e.location.indexOf("conditions")?parseInt(e.location[e.location.indexOf("conditions")+1],10):void 0;(0,U.default)(n.jsonData.json,o[0],X(X({},(0,V.toJS)((0,L.default)(n.jsonData.json,o[0]))),{},{conditionError:{error:e.error,index:c}}))}}else window.onunhandledrejection({status:"Failure",reason:t("pipeline syntax error"),message:e.error||JSON.stringify(e)})}))})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"saveJenkinsFile",value:(h=(0,u.default)(l.default.mark((function e(t){var a,r,n,u=this;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.devops,r=t.name,n=t.cluster,e.abrupt("return",request.put("".concat(this.getDevopsUrlV3({cluster:n,devops:a}),"/pipelines/").concat(r,"/jenkinsfile?mode=json"),{data:JSON.stringify(Z((0,V.toJS)(this.jsonData.json)))},{headers:{"content-type":"application/json"}}).then((function(e){if("success"===e.result)return u.jenkinsFile=JSON.stringify(Z((0,V.toJS)(u.jsonData.json))),u.jenkinsFile})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"handleConfirm",value:(m=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveJenkinsFile();case 2:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"handleConfirmOld",value:(p=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.convertJsonToJenkinsFile();case 2:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"fetchLabel",value:(d=(0,u.default)(l.default.mark((function e(){var t,a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.getDevopsUrlV3(),"ci/nodelabels"),this.labelDataList=[],e.next=4,request.get(t,{},{},(function(){return null}));case 4:(a=e.sent)&&"success"===a.status&&(0,M.default)(a.data)&&(this.labelDataList=a.data.map((function(e){return{label:e,value:e}})));case 6:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"fetchPipelineStepTemplates",value:(n=(0,u.default)(l.default.mark((function e(){var t,a,r,n,u=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},e.next=3,request.get("".concat(this.getBaseUrl(t),"clustersteptemplates?limit=100"));case 3:return a=e.sent,r=a.items,n=(void 0===r?[]:r).map($),this.pipelineSteps=n,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"fetchStepTemplate",value:(r=(0,u.default)(l.default.mark((function e(t){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,request.get("".concat(this.getBaseUrl(),"clustersteptemplates/").concat(t));case 2:return a=e.sent,e.abrupt("return",$(a));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getPipelineStepTempleJenkins",value:(a=(0,u.default)(l.default.mark((function e(t,a){var r,n,u,o=arguments;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:{},e.next=3,request.post("".concat(this.getBaseUrl(),"clustersteptemplates/").concat(t,"/render?").concat(G.default.stringify(r)),a);case 3:return n=e.sent,u=(0,L.default)(n,"data",""),e.abrupt("return",u);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"newStage",get:function(){return{branches:[{id:String(Math.random()),name:"",steps:[]}],agent:{type:"none"},name:"stage-".concat((0,q.generateId)(5))}}},{key:"stages",get:function(){return(0,L.default)(this.jsonData,"json.pipeline.stages",[])}},{key:"activeStage",get:function(){return""===this.activeLineIndex?"":this.stages[this.activeLineIndex]?this.stages[this.activeLineIndex].parallel?this.stages[this.activeLineIndex].parallel[this.activeColumnIndex]:this.stages[this.activeLineIndex]:""}}]),F}(z.default),(0,m.default)(v.prototype,"stages",[V.computed],Object.getOwnPropertyDescriptor(v.prototype,"stages"),v.prototype),(0,m.default)(v.prototype,"activeStage",[V.computed],Object.getOwnPropertyDescriptor(v.prototype,"activeStage"),v.prototype),E=(0,m.default)(v.prototype,"jsonData",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),y=(0,m.default)(v.prototype,"activeLineIndex",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),g=(0,m.default)(v.prototype,"activeColumnIndex",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),b=(0,m.default)(v.prototype,"isAddingStep",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=(0,m.default)(v.prototype,"edittingData",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),_=(0,m.default)(v.prototype,"params",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),O=(0,m.default)(v.prototype,"labelDataList",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),C=(0,m.default)(v.prototype,"credentialsList",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[]}}}),T=(0,m.default)(v.prototype,"cdList",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[]}}}),R=(0,m.default)(v.prototype,"pipelineList",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[]}}}),D=(0,m.default)(v.prototype,"pipelineSteps",[V.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,m.default)(v.prototype,"setData",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"setData"),v.prototype),(0,m.default)(v.prototype,"insertColumn",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"insertColumn"),v.prototype),(0,m.default)(v.prototype,"setFocus",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"setFocus"),v.prototype),(0,m.default)(v.prototype,"setActive",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"setActive"),v.prototype),(0,m.default)(v.prototype,"setEdittingData",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"setEdittingData"),v.prototype),(0,m.default)(v.prototype,"clearFocus",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"clearFocus"),v.prototype),(0,m.default)(v.prototype,"deleteStage",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"deleteStage"),v.prototype),(0,m.default)(v.prototype,"setValue",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"setValue"),v.prototype),(0,m.default)(v.prototype,"convertJsonToJenkinsFile",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"convertJsonToJenkinsFile"),v.prototype),(0,m.default)(v.prototype,"saveJenkinsFile",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"saveJenkinsFile"),v.prototype),k=(0,m.default)(v.prototype,"getCredentials",[V.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,u.default)(l.default.mark((function t(a){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.credentialStore.fetchList(X({devops:e.params.devops,cluster:e.params.cluster},a));case 2:e.credentialsList=e.credentialStore.list;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),N=(0,m.default)(v.prototype,"getPipelines",[V.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,u.default)(l.default.mark((function t(a){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.pipelineStore.fetchList(X({devops:e.params.devops,cluster:e.params.cluster,filter:"no-folders"},a));case 2:e.pipelineList=e.pipelineStore.list;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),I=(0,m.default)(v.prototype,"getCDListData",[V.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,u.default)(l.default.mark((function t(a){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cdStore.fetchList(X({devops:e.params.devops,cluster:e.params.cluster},a));case 2:e.cdList=e.cdStore.list;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),P=(0,m.default)(v.prototype,"createCredential",[V.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=(0,u.default)(l.default.mark((function t(a,r){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.credentialStore.handleCreate(a,r);case 2:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}}),(0,m.default)(v.prototype,"handleConfirm",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"handleConfirm"),v.prototype),(0,m.default)(v.prototype,"handleConfirmOld",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"handleConfirmOld"),v.prototype),(0,m.default)(v.prototype,"fetchPipelineStepTemplates",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"fetchPipelineStepTemplates"),v.prototype),(0,m.default)(v.prototype,"fetchStepTemplate",[V.action],Object.getOwnPropertyDescriptor(v.prototype,"fetchStepTemplate"),v.prototype),v);a.default=ee},function(e,t,a){e.exports={header:"_2saOnbMeHxpTm11Eed8tTs",body:"_2DgEUY-oZ3U39kMNOaJ0il",templeHeight:"_3spQYJcu5vaFgqKDKvxEzP",title:"_2xngYZLt3Su7hKoNhj6gjS",content:"LvzjWthXqdqyYc0TizKIr"}},function(e,a,r){"use strict";r(16);var n=r(19);r(88),r(4),r(18),r(30),r(11),r(69),r(139),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(88),r(29),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(110);var l=n(r(38));r(35);var u,o,c,s=n(r(39)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(0)),v=n(r(1)),E=r(189),y=n(r(191)),g=r(243),b=n(r(26)),S=n(r(67)),_=n(r(798)),O=n(r(2924));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var T=(0,g.observer)((c=o=function(e){(0,d.default)(r,e);var a=C(r);function r(e){var n;return(0,i.default)(this,r),(n=a.call(this,e)).refreshHandler=function(){for(var e=n.props.store.repositoryLog.split("\n"),t=!1,a=e.length-1;a>=0;a--)if(!(0,S.default)(e[a])&&e[a].indexOf("Finished")>-1)return void(t=!0);if(t)clearInterval(n.refresh),n.refresh=null;else{var r=n.props.params;n.props.store.getRepoScanLogs(r)}},n.handleFetch=(0,s.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.params,e.next=3,n.props.handleScanRepository();case 3:return e.next=5,n.props.store.getRepoScanLogs(a);case 5:y.default.success({content:t("LOGS_OBTAINED_SUCCESSFULLY")});case 6:case"end":return e.stop()}}),e)}))),n.handleDownloadLogs=function(){var e=n.props.store.repositoryLog;n.props.store.saveAsFile(e,"log.txt")},n.formRef=h.default.createRef(),n.refresh=setInterval((function(){n.refreshHandler()}),4e3),n}return(0,f.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.params;this.props.store.getRepoScanLogs(e)}},{key:"componentDidUpdate",value:function(e){if(!e.visible&&this.props.visible){var t=this.props.params;this.props.store.getRepoScanLogs(t)}}},{key:"componentWillUnmount",value:function(){clearInterval(this.refresh)}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.props.store.repositoryLog;return h.default.createElement(_.default,{width:1160,onCancel:r,visible:a,closable:!1,title:t("REPOSITORY_SCAN_LOGS"),cancelText:t("CLOSE")},h.default.createElement("div",{className:O.default.content},h.default.createElement("div",{className:O.default.btn_group},h.default.createElement(E.Icon,{name:"human",size:20}),this.startBy,h.default.createElement(E.Button,{onClick:this.handleDownloadLogs},t("DOWNLOAD")),h.default.createElement(E.Button,{onClick:this.handleFetch},t("RESCAN"))),h.default.createElement("pre",{className:O.default.pre},n)))}},{key:"startBy",get:function(){var e=this.props.store.repositoryLog.split("\n"),a=(0,b.default)(e,"[0]",""),r=a.match(/^Started by (user )?(.*)?/)||[],n=r[1],l=r[2];return a&&n?t("STARTED_BY_NAME",{name:l}):a&&!n?t("STARTED_BY_NAME",{name:t(l)}):t("STARTED_BY_NAME",{name:"-"})}}]),r}(h.default.Component),o.propTypes={name:v.default.string,branches:v.default.array},o.defaultProps={branches:[],visible:!1,onOk:function(){},onCancel:function(){}},u=c))||u;a.default=T},function(e,t,a){e.exports={content:"_1TtDoHIK3aC3dRiBhRTT0F",btn_group:"_1iXbGXD3S6h6qcpzVlnDq1",pre:"_8f1VfuEP3pLkfRwcKptfp"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.PIPELINE_CREATE_STEPS_OLD=t.PIPELINE_CREATE_STEPS=t.PIPELINE_PROJECT_CREATE_STEPS=void 0;var n=r(a(1465)),l=r(a(2926)),u=r(a(2928)),o=r(a(2934)),c=r(a(2935)),s=[{title:"BASIC_INFORMATION",component:l.default,icon:"cdn",required:!0},{title:"ADVANCED_SETTINGS",component:n.default,required:!0}];t.PIPELINE_PROJECT_CREATE_STEPS=s;var i=[{title:"SELECT_TEMPLATE",component:u.default,required:!0},{title:"PARAMETER_CONFIG",component:o.default,required:!0,icon:"slider"}];t.PIPELINE_CREATE_STEPS=i;var f=[{title:"SELECT_TEMPLATE",component:u.default,required:!0},{title:"PARAMETER_CONFIG",component:c.default,required:!0,icon:"slider"}];t.PIPELINE_CREATE_STEPS_OLD=f},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(26)),d=n(r(68)),p=n(r(0)),m=r(56),h=r(61),v=r(873),E=r(865),y=n(r(1066)),g=n(r(2927));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var S=function(e){(0,o.default)(r,e);var a=b(r);function r(e){var n;(0,l.default)(this,r),(n=a.call(this,e)).validator=function(e,a,r){if(!a)return r();n.props.store.checkPipelineName({name:a,cluster:n.props.cluster,devops:n.props.devops},(0,v.compareVersion)(n.ksVersion,"3.4.0")<0).then((function(a){if(a.exist)return r({field:e.field,message:t("NAME_EXIST_DESC")});r()}))};var u=e.formTemplate;return n.state={type:(0,f.default)(u,"multi_branch_pipeline",null)?1:0},n}return(0,u.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.formRef,n=a.formTemplate,l=a.devops,u=a.cluster;return p.default.createElement(i.Form,{ref:r,data:n,className:g.default.from},p.default.createElement(i.Columns,null,p.default.createElement(i.Column,null,p.default.createElement(i.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:h.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.validator}]},p.default.createElement(i.Input,{name:"name",maxLength:63})),p.default.createElement(i.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},p.default.createElement(i.TextArea,{name:"description",maxLength:256}))),p.default.createElement(i.Column,null,p.default.createElement(i.Form.Item,{label:t("DEVOPS_PROJECT"),desc:t("PIPELINE_CREATE_DEVOPS_PROJECT_DESC")},p.default.createElement("div",{name:"devopsName",className:"disabled-input"},(0,m.showNameAndAlias)(null==n?void 0:n.devopsName,"devops"))))),p.default.createElement("div",{className:"form-item"},p.default.createElement("label",{className:"form-item-label"},t("PIPELINE_TYPE")),p.default.createElement(E.TypeSelect,{value:this.state.type,onChange:function(t){e.setState({type:t}),(0,d.default)(n,"multi_branch_pipeline",void 0)},name:"pipeline-type",options:[{label:t("PIPELINE_PL"),value:0,icon:"branch",description:t("BRANCH_PIPELINE_DESC")},{label:t("MULTI_BRANCH_PIPELINE"),value:1,icon:"branch",description:t("MULTI_BRANCH_PIPELINE_DESC")}]})),1===this.state.type&&p.default.createElement(i.Form.Item,{label:t("CODE_REPOSITORY_OPTIONAL"),rules:[{required:!0,message:t("CODE_REPOSITORY_REQUIRED_DESC")}]},p.default.createElement(y.default,{name:"multi_branch_pipeline",devops:l,cluster:u,isCreatePipeline:!0,trigger:this.props.trigger})))}},{key:"ksVersion",get:function(){var e=this.props.cluster;return globals.app.isMultiCluster?(0,f.default)(globals,"clusterConfig.".concat(e,".ksVersion")):(0,f.default)(globals,"ksConfig.ksVersion")}}]),r}(p.default.Component);a.default=S},function(e,t,a){e.exports={from:"_3leGyYanySt4QBpWlptmsl"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=r(189),d=n(r(68)),p=r(243),m=n(r(2929)),h=n(r(0)),v=n(r(2933));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=(0,p.observer)(l=function(e){(0,c.default)(r,e);var a=E(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleTemplateChange=function(t,a){(0,d.default)(e.props.formTemplate,"template",t),(0,d.default)(e.props.formTemplate,"params",a)},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=e.params;return h.default.createElement(f.Form,{data:r,ref:a,className:v.default.pipeline_template_form},h.default.createElement(f.Form.Item,{name:"template",rules:[{required:!0,message:t("PIPELINE_VALIDATOR_DESC")}]},h.default.createElement(m.default,{name:"template",templateLoading:!1,handleTemplateChange:this.handleTemplateChange,formTemplate:r,params:n})))}}]),r}(h.default.Component))||l;a.default=y},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(4),r(21),r(200),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(20),r(27),r(4),r(21),r(200);var u=l(r(31)),o=l(r(317)),c=l(r(38));r(35);var s=l(r(39)),i=l(r(97)),f=l(r(1068)),d=l(r(5)),p=l(r(244)),m=n(r(0)),h=l(r(1009)),v=l(r(2932)),E=function(e){var a=e.handleTemplateChange,r=e.formTemplate,n=e.params,l={type:"custom",image:"/extensions-static/ks-console-embed/dist/v3dist/assets/pipeline/custom.svg",title:t("CUSTOM_PIPELIEN"),desc:t("CUSTOM_PIPELIEN_DESC")},u=new h.default,d=(0,m.useState)([]),E=(0,i.default)(d,2),g=E[0],b=E[1],S=(0,m.useState)(r.template),_=(0,i.default)(S,2),O=_[0],C=_[1],T=(0,m.useState)(!1),R=(0,i.default)(T,2),D=R[0],k=R[1],N=function(){var e=(0,s.default)(c.default.mark((function e(t){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getPipelineTemplateList(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,m.useEffect)((function(){k(!0),N((0,p.default)(n,"cluster")).then((function(e){e.push(l),b(e)})).finally((function(){k(!1)}))}),[]);var I=function(e,t){C(e),a&&a(e,t)};return m.default.createElement("div",{className:v.default.container},m.default.createElement(f.default,{spinning:D},m.default.createElement("div",{className:v.default.template},g&&g.map((function(e){return m.default.createElement(y,(0,o.default)({key:e.type,isSelected:O===e.type},e,{getTemple:I}))})))))};a.default=E;var y=function(e){var t=e.type,a=e.image,r=e.title,n=e.desc,l=e.parameters,o=e.getTemple,c=e.isSelected,s=(0,m.useRef)();return m.default.createElement("div",{className:(0,d.default)(v.default.card,(0,u.default)({},v.default.cardSelected,c)),onClick:function(){return o(t,l)}},m.default.createElement("div",{className:(0,d.default)(v.default.bg)},m.default.createElement("img",{src:a,ref:s,onError:function(){s.current.src="/extensions-static/ks-console-embed/dist/v3dist/assets/pipeline/custom.svg"}})),m.default.createElement("div",{className:v.default.info},m.default.createElement("div",{className:v.default.subtitle},r),m.default.createElement("p",{title:n,className:v.default.desc,style:{"-webkit-box-orient":"vertical"}},n)))}},,,function(e,t,a){e.exports={container:"_1kaDdvsCDov05n6ER1wlbB",title:"_1C-7dQGtX33JkSHwYAWGYz",card:"_3Aib_reYwYhPU8Swp57k0j",cardSelected:"_2oJj50hK159qSfvarGMI7E",bg:"CpVt8f8oNp_vruCV0QJh5",info:"_3tOaVhp-H4O_o1UMo84zEV",subtitle:"_3C_MhMM1PU2LSxvd1kyT5O",desc:"vq8hCrTUwI7BHDDDguAxC"}},function(e,t,a){e.exports={pipeline_template_form:"_2ZhLZbeOlhAnmZtNqK4Xug"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(87),r(14),r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.formTemplate,r=e.formRef,n=e.store,l=(0,s.default)(e,["formTemplate","formRef","store"]),b=a.params,S=void 0===b?[]:b,_=(0,i.useState)("params"),O=(0,c.default)(_,2),C=O[0],T=O[1],R=(0,i.useState)(!1),D=(0,c.default)(R,2),k=D[0],N=D[1],I=(0,i.useState)({}),P=(0,c.default)(I,2),A=P[0],w=P[1],L=(0,i.useState)(!1),M=(0,c.default)(L,2),x=M[0],j=M[1],U=function(){var e=(0,o.default)(u.default.mark((function e(t){var r,o,c,s,i,f,d,p,m,v,E,y;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("view"!==t){e.next=25;break}return r=a.paramsForm,o=void 0===r?{}:r,c=Object.keys(o).reduce((function(e,t){return e.push({name:t,value:o[t]}),e}),[]),N(!0),e.next=6,n.getTempleJenkins(a.template,{parameters:c},{cluster:l.params.cluster});case 6:return s=e.sent,i=l.params,f=i.devops,d=i.name,p=i.cluster,e.next=10,n.checkScriptCompile({devops:f,pipeline:d,value:s,cluster:p});case 10:return e.prev=10,e.next=13,n.convertJenkinsFileToJson(s,p,f,d);case 13:m=e.sent,v=m.mode,E=m.jsonData,y=JSON.parse(E),v||(w({json:y}),(0,h.default)(a,"jenkinsFile",{json:y})),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(10),console.error(e.t0),j(!0);case 24:N(!1);case 25:T(t);case 26:case"end":return e.stop()}}),e,null,[[10,20]])})));return function(t){return e.apply(this,arguments)}}();return i.default.createElement("div",{className:y.default.templateParams},i.default.createElement(v.default,{spinning:n.isSubmitting},i.default.createElement(f.Tabs,{type:"button",tabs:C,onChange:U},i.default.createElement(g,{label:t("PARAMETER_CONFIG"),name:"params"},i.default.createElement("div",{className:y.default.container},i.default.createElement("div",{className:y.default.params},i.default.createElement(f.Form,{data:a,ref:r},(0,p.default)(S)&&S.length>0?i.default.createElement("div",{className:y.default.params_container},S.map((function(e,t){return i.default.createElement(E.default,{key:t,option:e})}))):i.default.createElement("div",{className:y.default.empty},i.default.createElement("div",{className:y.default.icon},i.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/pipeline-temp-empty.svg",alt:""})),i.default.createElement("p",null,t("EMPTY_PARAMS_CONFIG"))))))),i.default.createElement(g,{label:t("PREVIEW"),name:"view",disabled:(0,m.default)(S)},i.default.createElement("div",{className:y.default.view},x?i.default.createElement("div",{className:y.default.timeOut},i.default.createElement("div",{className:y.default.icon},i.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/pipeline-temp-empty.svg",alt:""})),i.default.createElement("p",null,t("CONNECTION_TIMEOUT"))):i.default.createElement(v.default,{spinning:k},i.default.createElement(f.Form,{data:a,ref:r},i.default.createElement(d.default,{className:y.default.content,jsonData:A}))))))))},r(20),r(27),r(87),r(14),r(9),r(4),r(21);var u=l(r(38));r(35);var o=l(r(39)),c=l(r(97)),s=l(r(50)),i=n(r(0)),f=r(189),d=l(r(1187)),p=l(r(64)),m=l(r(67)),h=l(r(68)),v=l(r(1068)),E=l(r(1471)),y=l(r(1190)),g=f.Tabs.TabPanel},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(87),r(14),r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.formTemplate,r=e.formRef,n=e.store,l=(0,s.default)(e,["formTemplate","formRef","store"]),b=a.params,S=void 0===b?[]:b,_=(0,v.useState)("params"),O=(0,c.default)(_,2),C=O[0],T=O[1],R=(0,v.useState)(!1),D=(0,c.default)(R,2),k=D[0],N=D[1],I=(0,v.useState)({}),P=(0,c.default)(I,2),A=P[0],w=P[1],L=function(){var e=(0,o.default)(u.default.mark((function e(t){var r,o,c,s,i,f,d,p,m;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("view"!==t){e.next=16;break}return r=a.paramsForm,o=void 0===r?{}:r,c=Object.keys(o).reduce((function(e,t){return e.push({name:t,value:o[t]}),e}),[]),N(!0),e.next=6,n.getTempleJenkins(a.template,{parameters:c},{cluster:l.params.cluster});case 6:return s=e.sent,i=l.params,f=i.devops,d=i.name,p=i.cluster,e.next=10,n.checkScriptCompile({devops:f,pipeline:d,value:s,cluster:p});case 10:return e.next=12,n.convertJenkinsFileToJson(s,p);case 12:m=e.sent,w(m),(0,h.default)(a,"jenkinsFile",m),N(!1);case 16:T(t);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return v.default.createElement("div",{className:E.default.templateParams},v.default.createElement(f.default,{spinning:n.isSubmitting},v.default.createElement(i.Tabs,{type:"button",tabs:C,onChange:L},v.default.createElement(g,{label:t("PARAMETER_CONFIG"),name:"params"},v.default.createElement("div",{className:E.default.container},v.default.createElement("div",{className:E.default.params},v.default.createElement(i.Form,{data:a,ref:r},(0,p.default)(S)&&S.length>0?v.default.createElement("div",{className:E.default.params_container},S.map((function(e,t){return v.default.createElement(y.default,{key:t,option:e})}))):v.default.createElement("div",{className:E.default.empty},v.default.createElement("div",{className:E.default.icon},v.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/pipeline-temp-empty.svg",alt:""})),v.default.createElement("p",null,t("EMPTY_PARAMS_CONFIG"))))))),v.default.createElement(g,{label:t("PREVIEW"),name:"view",disabled:(0,m.default)(S)},v.default.createElement("div",{className:E.default.view},v.default.createElement(f.default,{spinning:k},v.default.createElement(i.Form,{data:a,ref:r},v.default.createElement(d.default,{className:E.default.content,jsonData:A}))))))))},r(20),r(27),r(87),r(14),r(9),r(4),r(21);var u=l(r(38));r(35);var o=l(r(39)),c=l(r(97)),s=l(r(50)),i=r(189),f=l(r(1068)),d=l(r(1187)),p=l(r(64)),m=l(r(67)),h=l(r(68)),v=n(r(0)),E=l(r(1190)),y=l(r(1471)),g=i.Tabs.TabPanel},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(14),r(4),r(21),r(200),r(18),r(30),r(11),r(71),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(14),r(4),r(21),r(200),r(18),r(43),r(30),r(11),r(71);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(798)),p=n(r(838)),m=n(r(822)),h=n(r(26)),v=n(r(811)),E=n(r(1)),y=n(r(0)),g=n(r(1009)),b=r(56),S=n(r(2937));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var O=function(e){(0,s.default)(r,e);var a=_(r);function r(e){var t,n;return(0,o.default)(this,r),(n=a.call(this,e)).showConfirm=function(){var e=n.props.defaultValue,t=n.state.value;(0,v.default)(e,t)?n.props.onCancel():n.setState({isShowConfirm:!0})},n.hideConfirm=function(){n.setState({isShowConfirm:!1})},n.handleCancel=function(){n.hideConfirm(),n.props.onCancel()},n.handleChange=function(e){n.setState({value:e})},n.getEditorInstance=function(e){n.editor=e},n.checkScriptCompile=(0,u.default)(l.default.mark((function e(){var t,a,r,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.params,a=t.devops,r=t.name,u=t.cluster,n.setState({isLoading:!0}),e.next=4,n.store.checkScriptCompile({value:n.newValue,pipeline:r,devops:a,cluster:u},(function(){n.setState({shouldCheckScriptCompile:!1})})).finally((function(){return n.setState({isLoading:!1})}));case 4:if("fail"!==(o=e.sent).status){e.next=9;break}return n.setState({error:{row:o.line-1,column:o.column,type:"error",text:o.message}}),n.forceUpdate(),e.abrupt("return",o);case 9:return n.setState({error:null}),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)}))),n.saveJenkins=function(e){var t=n.props.params,a=t.devops,r=t.name,l=t.cluster;n.setState({isLoading:!0});var u=l&&"default"!==l?"/klusters/".concat(l):"";return request.put("/kapis/devops.kubesphere.io/v1alpha3".concat(u,"/namespaces/").concat(a,"/pipelines/").concat(r,"/jenkinsfile?mode=raw"),{data:e},{headers:{"content-type":"application/json"}}).finally((function(){return n.setState({isLoading:!1})}))},n.handleOk=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.newValue=n.state.value.replace(/\t/g,"    "),!n.state.shouldCheckScriptCompile){e.next=7;break}return e.next=4,n.checkScriptCompile();case 4:if(!e.sent){e.next=7;break}return e.abrupt("return");case 7:if(n.isOld){e.next=10;break}return e.next=10,n.saveJenkins(n.newValue);case 10:n.props.onOk(n.newValue);case 11:case"end":return e.stop()}}),e)}))),n.store=new g.default,n.state={value:null!==(t=e.defaultValue)&&void 0!==t?t:"",isLoading:!1,isShowConfirm:!1,shouldCheckScriptCompile:!0},n}return(0,c.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,r=t.defaultValue;a&&!e.visible&&r&&this.setState({value:r})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=this.state,l=n.isShowConfirm,u=n.error,o=n.shouldCheckScriptCompile,c=n.value,s=n.isLoading;return y.default.createElement(y.default.Fragment,null,y.default.createElement(d.default,{icon:"cogwheel",width:900,bodyClassName:S.default.body,isSubmitting:r||s,onCancel:this.showConfirm,onOk:this.handleOk,okButtonType:o?void 0:"danger",okText:o?void 0:"continue",visible:a,closable:!1,maskClosable:!1,title:"Jenkinsfile"},y.default.createElement(y.default.Fragment,null,y.default.createElement(p.default,{className:S.default.codeEditor,name:"script",mode:"groovy",value:c,onChange:this.handleChange,options:u&&{annotations:[u]}}),u&&y.default.createElement("div",{className:S.default.checkResult},y.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/error.svg"}),y.default.createElement("span",null,t("JENKINS_LINS_ERROR",{line:u.row+1}))),!o&&y.default.createElement("div",{className:S.default.checkResult},y.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/error.svg"}),y.default.createElement("span",null,t("FAILED_CHECK_SCRIPT_COMPILE"))))),y.default.createElement(m.default,{visible:l,onCancel:this.hideConfirm,onOk:this.handleCancel,title:t("CLOSE"),desc:t("CLOSE_JENKINSFILE_EDITOR_TIP")}))}},{key:"ksVersion",get:function(){var e=this.props.params.cluster;return window.parent.globals.app.isMultiCluster?(0,h.default)(window,"parent.globals.clusterConfig.".concat(e,".ksVersion")):(0,h.default)(window,"parent.globals.ksConfig.ksVersion")}},{key:"isOld",get:function(){return(0,b.compareVersion)(this.ksVersion,"3.4.0")<0}}]),r}(y.default.Component);a.default=O,O.propTypes={name:E.default.string,params:E.default.object},O.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={codeEditor:"FwGVnxxpNbU-YwCj8hrz_",checkResult:"_177fFbaR70Um61ePRL6Q86",body:"_33dDTLMi8Kh16V0VchwicK"}},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(10),r(6),r(8),r(13),r(9),r(30),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(30),r(71),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(798)),c=n(r(191)),s=n(r(2939)),i=n(r(1124));function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={"update.platformInfo.theme":{on:function(e){var a=e.store,r=e.success,n=(e.cluster,e.workspace,(0,u.default)(e,["store","success","cluster","workspace"])),l=o.default.open(d({onOk:function(e){var n=e.title,u=e.description,s=e.logo,i=e.favicon,f=e.background,d={title:n,description:u,logo:s.replace(/\/theme\/static\/images\//g,""),favicon:i.replace(/\/theme\/static\/images\//g,""),background:f.replace(/\/theme\/static\/images\//g,"")};a.updateTheme(d).then((function(){o.default.close(l),c.default.success({content:t("UPDATE_SUCCESSFUL")}),r&&r()}))},modal:s.default,store:a},n))}},"platformInfo.resetTheme":{on:function(e){var a=e.store,r=e.success,n=(e.cluster,e.workspace,(0,u.default)(e,["store","success","cluster","workspace"])),l=o.default.open(d({onOk:function(){a.updateTheme({title:"",logo:"",favicon:"",background:"",description:""}).then((function(){o.default.close(l),c.default.success({content:t("UPDATE_SUCCESSFUL")}),r&&r()}))},modal:i.default,title:t("RESET_PLATFORM_INFO"),desc:t("RESET_PLATFORM_INFO_TIP"),store:a},n))}}};a.default=p},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u,o,c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(1)),v=r(189),E=n(r(798)),y=r(243),g=n(r(2940)),b=n(r(2942));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var C={title:"",description:"",logo:"",favicon:"",background:""},T=(0,y.observer)((o=u=function(e){(0,f.default)(r,e);var a=O(r);function r(e){var t;return(0,s.default)(this,r),(t=a.call(this,e)).handleLogoChange=function(e){var a=e.image,r=t.state.formTemplate;t.setState({formTemplate:_(_({},r),{},{logo:a})})},t.handleFavicon=function(e){var a=t.state.formTemplate,r=e.image;t.setState({formTemplate:_(_({},a),{},{favicon:r})})},t.handleBackground=function(e){var a=t.state.formTemplate,r=e.image;t.setState({formTemplate:_(_({},a),{},{background:r})})},t.handleOK=function(){t.formRef.current.validate((function(){t.props.onOk(t.formRef.current.getData())}))},t.state={formTemplate:_(_({},C),globals.theme)},t.formRef=m.default.createRef(),t}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=this.state.formTemplate;return m.default.createElement(E.default,{width:960,onOk:this.handleOK,onCancel:r,visible:a,title:t("MODIFY_PLATFORM_INFO"),icon:"cogwheel",okText:t("OK"),cancelText:t("CANCEL"),isSubmitting:n},m.default.createElement(v.Form,{data:l,ref:this.formRef},m.default.createElement("div",{className:b.default.form},m.default.createElement("div",{className:b.default.item},m.default.createElement(v.Form.Item,{label:t("PLATFORM_TITLE_TCAP"),desc:t("PLATFORM_TITLE_TIP"),rules:[{required:!0,message:t("TITLE_EMPTY_TIP")}]},m.default.createElement(v.Input,{name:"title",maxLength:63}))),m.default.createElement("div",{className:b.default.item},m.default.createElement(v.Form.Item,{label:t("PLATFORM_DESCRIPTION_TCAP"),desc:t("DESCRIPTION_DESC")},m.default.createElement(v.TextArea,{name:"description",maxLength:256})))),m.default.createElement("div",{className:b.default.form},m.default.createElement("div",{className:b.default.item},m.default.createElement(v.Form.Item,{label:t("PLATFORM_LOGO"),rules:[{required:!0,message:t("PLATFORM_LOGO_REQUIRED")}]},m.default.createElement(g.default,{name:"logo",uploadName:"image",type:["png","svg","jpg"],tooltipText:t("PLATFORM_LOGO_DESC",{imageSize:"200*40",fileSize:"2M",fileType:"svg、png、jpg"}),uploadUrl:this.uploadUrl,imagUrl:l.logo,fileSize:2,onChange:this.handleLogoChange})),m.default.createElement(v.Form.Item,{className:b.default.marginTop,label:t("BROWSER_FAVICON"),rules:[{required:!0,message:t("BROWSER_FAVICON_REQUIRED")}]},m.default.createElement(g.default,{name:"favicon",text:t("UPLOAD"),uploadName:"image",type:["ico","png","svg","jpg"],tooltipText:t("BROWSER_FAVICON_DESC"),imagUrl:l.favicon,uploadUrl:this.uploadUrl,fileSize:2,onChange:this.handleFavicon}))),m.default.createElement("div",{className:b.default.item},m.default.createElement(v.Form.Item,{label:t("LOGIN_BACKGROUND")},m.default.createElement(g.default,{text:t("UPLOAD"),height:288,uploadName:"image",type:["png","svg","jpg"],tooltipText:t("LOGIN_BACKGROUND_DESC"),uploadUrl:this.uploadUrl,imagUrl:l.background,onChange:this.handleBackground,fileSize:2,preview:!0}))))))}},{key:"store",get:function(){return this.props.store}},{key:"uploadUrl",get:function(){return this.store.getImagePath()}}]),r}(m.default.Component),u.propTypes={visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func,isSubmitting:h.default.bool},u.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=T},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(199),r(66),r(917),r(51),r(14),r(4),r(21),Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.title,r=e.height,n=void 0===r?120:r,l=e.width,y=void 0===l?450:l,g=e.uploadName,b=e.uploadUrl,S=e.imagUrl,_=void 0===S?"":S,O=e.logoUrl,C=void 0===O?"":O,T=e.type,R=void 0===T?["png"]:T,D=e.preview,k=void 0!==D&&D,N=e.tooltipText,I=void 0===N?"":N,P=e.fileSize,A=void 0===P?null:P,w=a||t("UPLOAD"),L=(0,i.useState)(""),M=(0,s.default)(L,2),x=M[0],j=M[1],U=(0,i.useState)(globals.useDefaultThem||""===_),F=(0,s.default)(U,2),V=F[0],G=F[1],B=(0,i.useState)(!1),z=(0,s.default)(B,2),Y=z[0],H=z[1],q=(0,i.useRef)(),K={name:g,method:"post",action:b,multiple:!1,beforeUpload:function(){var e=(0,c.default)(o.default.mark((function e(a){var r,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.size,1048576,!(A&&r>1048576*A)){e.next=5;break}return d.default.error(t("UPLOAD_FILE_TOO_LARGE")),e.abrupt("return",Promise.reject(t("UPLOAD_FILE_TOO_LARGE")));case 5:if(n=a.name.slice(a.name.lastIndexOf(".")+1),-1!==R.findIndex((function(e){return e===n}))){e.next=9;break}return d.default.error(t("WRONG_FILE_EXTENSION_NAME",{type:R.join(",")})),e.abrupt("return",Promise.reject(t("WRONG_FILE_EXTENSION_NAME",{type:R.join(",")})));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onSuccess:function(a,r){var n=e.onChange,l=new FileReader;if(200===a.code||a.image)return l.readAsDataURL(r),l.addEventListener("load",(function(){var e=l.result;j(e),G(!1),n&&n(a,e)})),d.default.success({content:t("UPLOAD_SUCCESSFUL")});d.default.error({content:t("UPLOAD_PLATFORM_IMAGE_FAILED",{message:a.message||"Internal Server Error"})})},onError:function(a){var r=e.onError;r&&r(),d.default.error({content:t("UPLOAD_PLATFORM_IMAGE_FAILED",{message:a.message||"Internal Server Error"})}),G(!0)}};return i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:h.default.container,style:{height:n,width:y}},(J=V?{}:{visibility:"hidden"},i.default.createElement("div",{className:h.default.uploadBox,style:J},i.default.createElement(p.default,(0,u.default)({},K,{ref:q}),i.default.createElement("div",{className:h.default.selectContainer,style:{height:n,width:y}},i.default.createElement(f.Icon,{className:h.default.icon,size:40,name:"upload"}),i.default.createElement("p",{className:h.default.title},w),i.default.createElement("p",{className:h.default.desc},I))))),(!globals.useDefaultTheme||""!==x)&&(W=x||_,Q=""!==globals.theme.background||""!==x,i.default.createElement("div",{className:h.default.imageBox},!V&&i.default.createElement(v.default,{style:(0,m.default)({favicon:{maxHeight:40},logo:{maxHeight:40}},e.name,{}),src:W}),i.default.createElement("div",{className:h.default.overlay},i.default.createElement(f.Tooltip,{content:I,placement:"top",style:{width:400}},i.default.createElement(f.Button,{type:"control",onClick:function(){return q.current.onClick()}},t("UPLOAD"))),k&&Q&&i.default.createElement(f.Button,{onClick:function(){return H(!0)}},t("PREVIEW"))))),Y&&function(){var e=x||_;return i.default.createElement(E.default,{logoUrl:C,imagUrl:e,onClick:H})}()));var W,Q;var J},r(199),r(66),r(917),r(51),r(14),r(4),r(21);var u=l(r(317)),o=l(r(38));r(35);var c=l(r(39)),s=l(r(97)),i=n(r(0)),f=r(189),d=l(r(191)),p=l(r(897)),m=l(r(26)),h=l(r(1191)),v=l(r(1472)),E=l(r(2941))},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),u=r(a(0)),o=a(189),c=n(a(5)),s=n(a(1191)),i=function(e){var t=e.imagUrl,a=e.logoUrl,r=e.style,n=e.className,i=e.onClick,f=(0,u.useState)(!0),d=(0,l.default)(f,2),p=d[0],m=d[1],h=globals.config.logo||globals.defaultTheme.logo,v=globals.useDefaultTheme?h:globals.theme.logo,E=""!==a?a:v;return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:(0,c.default)(n,s.default.loadingPreviewImage)},u.default.createElement("div",{className:s.default.preview},u.default.createElement("div",{className:s.default.box},u.default.createElement("div",{className:s.default.image},p&&u.default.createElement(o.Loading,{className:s.default.loading}),u.default.createElement("img",{style:r,src:t,alt:"",onLoad:function(){return m(!1)}}),!p&&u.default.createElement(u.default.Fragment,null,u.default.createElement("img",{className:s.default.logo,src:E}),u.default.createElement("img",{className:s.default.loginForm,src:"/extensions-static/ks-console-embed/dist/v3dist/assets/loginForm.svg"}))),!p&&u.default.createElement(o.Icon,{name:"close",className:s.default.cancel,onClick:function(){return i(!1)}})))))};t.default=i},function(e,t,a){e.exports={form:"_117p4N5fmQ3xC2Jt2kqjt3",item:"_3QGGQazz9cLTxnGlDt0_dA",marginTop:"_2-DqDXEz5x0GhYdEsFqQNI"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(11),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(67)),f=n(r(457)),d=n(r(68)),p=n(r(191)),m=n(r(798)),h=n(r(2944)),v=n(r(2956)),E=n(r(2958)),y=n(r(2959)),g=n(r(438)),b=r(56),S=n(r(323)),_=n(r(874));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var T={"project.create":{on:function(e){var a,r=e.store,n=e.success,o=e.cluster,i=e.workspace,f=(0,c.default)(e,["store","success","cluster","workspace"]),h=m.default.open(C({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,s.default)(globals,"ksConfig.springcloud",!1)&&(0,d.default)(a,'metadata.labels["springcloud.kubesphere.io/enabled"]',"true"),(0,d.default)(a,'metadata.labels["kubesphere.io/workspace"]',i),u=o||(0,s.default)(a,"cluster"),c={cluster:u,workspace:i},e.next=6,r.create(a,c);case 6:m.default.close(h),p.default.success({content:t("CREATE_SUCCESSFUL")}),n&&n(u);case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),hideCluster:!globals.app.isMultiCluster||!!o,cluster:o,workspace:i,formTemplate:g.default.project(),modal:v.default,store:r},f))}},"project.quota.edit":{on:function(e){e.store;var a,r=e.detail,n=e.success,o=(0,c.default)(e,["store","detail","success"]),d=new _.default,v=m.default.open(C({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,c,h;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,s.default)(a,"spec.hard",{}),o=(0,s.default)(a,"storageLimit",{}),c={name:a.name,namespace:r.name,cluster:r.cluster},(0,b.quota_limits_requests_Dot)(u),h=(0,f.default)(u,(function(e){return e?(0,i.default)(e.toString()):!e})),a.spec={hard:C(C({},h),o)},e.next=8,d.checkName(c);case 8:if(!e.sent.exist){e.next=14;break}return e.next=12,d.update(c,{apiVersion:"v1",kind:"ResourceQuota",metadata:C(C({},c),{},{name:r.name}),spec:a.spec});case 12:e.next=16;break;case 14:return e.next=16,d.create({apiVersion:"v1",kind:"ResourceQuota",metadata:C(C({},c),{},{name:r.name}),spec:a.spec},c);case 16:m.default.close(v),p.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 19:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),detail:r,store:d,modal:h.default,supportGpuSelect:!0},o))}},"project.default.resource":{on:function(e){var a,r=e.store,n=e.detail,o=e.namespace,s=e.cluster,f=e.success,h=e.isFederated,v=e.projectDetail,E=(0,c.default)(e,["store","detail","namespace","cluster","success","isFederated","projectDetail"]),S=m.default.open(C({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,c,E,y,_;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=(0,b.limits_Request_EndsWith_Dot)({limits:a.default,requests:a.defaultRequest||{}}),c=u.limits,E=u.requests,a.default=C(C({},a.default),c),a.defaultRequest=C(C({},a.defaultRequest),E),!(0,i.default)(n)){e.next=10;break}return y=g.default.limitRange(),h?(y=g.default.federated({data:g.default.limitRange(),clusters:v.clusters.map((function(e){return e.name})),kind:"LimitRange"}),(0,d.default)(y,"metadata.name",o),(0,d.default)(y,"spec.template.spec",{limits:[C(C({},a),{},{type:"Container"})]})):(0,d.default)(y,"spec",{limits:[C(C({},a),{},{type:"Container"})]}),e.next=8,r.create(y,{namespace:o,cluster:s});case 8:e.next=15;break;case 10:return _=C({},n._originData),h?(0,d.default)(_,"spec.template.spec",{limits:[C(C({},n.limit),a)]}):(0,d.default)(_,"spec",{limits:[C(C({},n.limit),a)]}),(0,d.default)(_,"metadata.resourceVersion",n.resourceVersion),e.next=15,r.update(C(C({},n),{},{namespace:o,cluster:s}),_);case 15:m.default.close(S),p.default.success({content:t("UPDATE_SUCCESSFUL")}),f&&f();case 18:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:y.default,store:r,detail:n,supportGpuSelect:!0,namespace:o,cluster:s,isFederated:h},E))}},"project.assignworkspace":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,i=(0,c.default)(e,["store","detail","success"]),f=new S.default,d=m.default.open(C({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,c,i,h;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.patch(n,a);case 2:return u=n.cluster,c=n.name,i=(0,s.default)(a,'metadata.annotations["kubesphere.io/creator"]'),h=(0,s.default)(a,'metadata.labels["kubesphere.io/workspace"]'),e.next=7,f.create([{username:i,roleRef:"admin"}],{cluster:u,workspace:h,namespace:c});case 7:m.default.close(d),p.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o();case 10:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:E.default,store:r,detail:n},i))}}};a.default=T},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(70),r(36),r(66),r(51),r(98),r(14),r(24),r(193),r(99),r(8),r(13),r(9),r(4),r(190),r(21),r(18),r(30),r(11),r(328),r(73),r(46),r(139),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(70),r(36),r(66),r(27),r(51),r(98),r(29),r(14),r(24),r(193),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(190),r(21),r(18),r(43),r(11),r(328),r(73),r(46),r(469),r(470),r(471),r(472),r(473),r(474),r(475),r(7),r(40);var u=l(r(38));r(35);var o=l(r(39)),c=l(r(97)),s=l(r(58)),i=l(r(31)),f=l(r(25)),d=l(r(28)),p=l(r(41)),m=l(r(42)),h=l(r(37)),v=l(r(0)),E=l(r(1)),y=r(17),g=l(r(26)),b=l(r(68)),S=l(r(196)),_=l(r(67)),O=l(r(993)),C=l(r(1445)),T=l(r(457)),R=l(r(444)),D=l(r(338)),k=l(r(1473)),N=l(r(845)),I=l(r(140)),P=l(r(880)),A=r(189),w=l(r(798)),L=l(r(843)),M=n(r(1192)),x=l(r(874)),j=l(r(888)),U=r(249),F=l(r(453)),V=r(56),G=l(r(2952)),B=l(r(2955));function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var q=function(e){(0,p.default)(n,e);var a,r=H(n);function n(e){var t;return(0,f.default)(this,n),(t=r.call(this,e)).getStorageSpec=function(e,t){var a={storage:void 0,persistentvolumeclaims:void 0},r=(0,g.default)(e,"status.used",{}),n=(0,g.default)(e,"spec.hard",{}),l=(0,g.default)(n,["requests.storage"],null),u=(0,g.default)(n,"persistentvolumeclaims",null),o=Number((0,g.default)(r,["requests.storage"],"0")),c=(0,g.default)(r,"persistentvolumeclaims","0"),s=(0,g.default)(t,"storage"),i=(0,g.default)(t,"persistentvolumeclaims");if(l){l=(0,V.memoryFormat)(l,"Gi"),o=(0,V.memoryFormat)(o,"Gi");var f=(0,k.default)(l,o);a.storage=isFinite(s)?Math.min(s,f):f}else a.storage=s;if(u){var d=(0,k.default)(Number(u),Number(c));a.persistentvolumeclaims=isFinite(i)?Math.min(i,d):d}else a.persistentvolumeclaims=i;var p={"requests.storage":!l||(0,P.default)(l)?"InfinityGi":"".concat(l,"Gi"),persistentvolumeclaims:u||""};return Object.keys(n).forEach((function(e){(e.includes(M.STORAGE_CLASS_STORAGE)||e.includes(M.STORAGE_CLASS_VOLUME_CLAIMS))&&(p[e]=n[e])})),{spec:Y({},p),nsAvailableStorage:Y({},a)}},t.cancelGpuSetting=function(e){var t=(0,g.default)(e,"spec.hard",{}),a=globals.config.supportGpuType,r=(0,T.default)(t,(function(e,t){return a.some((function(e){return(0,R.default)(t,e)}))}));if((0,b.default)(e,"spec.hard",r),(0,_.default)(t))(0,b.default)(e,"spec.gpu",{type:"",value:""});else{var n=(0,D.default)(t,(function(e,t){return a.some((function(e){return(0,R.default)(t,e)}))}));if(!(0,_.default)(n)){var l=Object.keys(n)[0].split(".");(0,b.default)(e,"spec.gpu",{type:l.slice(1).join("."),value:Object.values(n)[0]})}}return e},t.getProjectSpec=function(){var e=t.state.spec,a=e["requests.storage"],r=e.persistentvolumeclaims,n=(0,V.memoryFormat)(a,"Gi");return{storage:(0,P.default)(n)?1/0:n,persistentvolumeclaims:""===r?1/0:Number(r)}},t.omitKey=["requests.storage","persistentvolumeclaims"],t.countTotalRelatedResource=function(){var e=t.state.spec,a=Y({},(0,I.default)(e,t.omitKey)),r={totalStorage:0,totalVolumeClaims:0,addedItems:[]},n=new Set;return Object.keys(a).forEach((function(e){if(e.includes("requests.storage")){n.add(e.split(".storageclass.storage.k8s.io/requests.storage")[0]);var t=(0,V.memoryFormat)(a[e],"Gi");(0,P.default)(t)||(r.totalStorage+=t)}if(e.includes("persistentvolumeclaims")){n.add(e.split(".storageclass.storage.k8s.io/persistentvolumeclaims")[0]);var l=a[e],u=Number(l);""===l||(0,P.default)(u)||(r.totalVolumeClaims+=u)}})),r.addedItems=(0,s.default)(n.values()),r},t.validStorage=function(){var e=t.getProjectSpec(),a=e.storage,r=e.persistentvolumeclaims,n=t.countTotalRelatedResource(),l=n.totalStorage,u=n.totalVolumeClaims,o=!1;(r<u||0===r&&0===u)&&(o=!0),t.setState({disableSave:o,totalStorageError:a<l,totalVolumeClaimsError:r<u})},t.setRelateSourceResult=function(){var e=t.countTotalRelatedResource(),a=e.totalStorage,r=e.totalVolumeClaims,n=e.addedItems;t.setState({currentRelatedStorageTotal:a,currentRelatedVolumeClaimsTotal:r,addedItems:n})},t.handleOnChange=function(e){var a=e.actionType,r=e.data,n=e.originName,l=Y({},t.state.spec);switch(a){case"delete":Object.keys(r).forEach((function(e){delete l[e]})),t.setState({spec:Y({},l)},(function(){t.setRelateSourceResult()}));break;case"edit":delete l["".concat(n,".storageclass.storage.k8s.io/persistentvolumeclaims")],delete l["".concat(n,".storageclass.storage.k8s.io/requests.storage")],t.setState({spec:Y(Y({},l),r)},(function(){t.validStorage(),t.setRelateSourceResult()}));break;default:t.setState({spec:Y(Y({},t.state.spec),r)},(function(){t.validStorage(),t.setRelateSourceResult()}))}},t.handleOk=function(){var e=t.props.onOk,a=Y({},t.state.spec);Object.entries(a).forEach((function(e){var t=(0,c.default)(e,2),r=t[0],n=t[1];"InfinityGi"!==n&&""!==n||delete a[r]}));var r=Y({},(0,g.default)(t.state.formTemplate,"spec.hard",{})),n=(0,T.default)(r,(function(e,t){return t.includes("requests.storage")||t.includes("persistentvolumeclaims")}));e({name:t.state.formTemplate.name,spec:{hard:Y({},n),gpu:(0,g.default)(t.state.formTemplate,"spec.gpu",{})},storageLimit:Y({},a)})},t.form=v.default.createRef(),t.store=new x.default,t.workspaceQuotaStore=new j.default,t.state={formTemplate:{},error:"",leftQuota:{},allStorageClass:[],spec:{},nsAvailableStorage:{},wsAvailableRequest:{},wsRelatedStoragesLimit:[],disableSave:!1,totalStorageError:!1,totalVolumeClaimsError:!1,currentRelatedStorageTotal:0,currentRelatedVolumeClaimsTotal:0,addedItems:[]},t.storageStore=new F.default,t}return(0,d.default)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.detail||{},a=t.workspace,r=t.cluster;this.props.detail&&this.props.detail.name&&Promise.all([this.workspaceQuotaStore.fetchDetail({workspace:a,name:a,cluster:r})]).then((function(){e.fetchQuota(),e.fetchData(e.props.detail)}))}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,r=t.detail;a&&a!==e.visible&&r&&r.name&&this.fetchData(r)}},{key:"fetchQuota",value:function(){var e=this,t=this.props.detail||{},a=t.workspace,r=t.name,n=t.cluster;a&&r&&Promise.all([this.store.fetch({cluster:n,namespace:r})]).then((function(t){var a=(0,g.default)(e.workspaceQuotaStore.detail,"status.total",{}),r=(0,g.default)(e.workspaceQuotaStore.detail,"spec.quota",{}),n=(0,U.getLeftQuota)((0,_.default)(a)?r:a,(0,g.default)(t[0],"data")).workspace,l=(0,U.getUsedQuota)((0,g.default)(t[0],"data"));e.setState({leftQuota:(0,O.default)(l,n,(function(e,t){return t?(0,C.default)(e,t):e}))})}))}},{key:"fetchData",value:(a=(0,o.default)(u.default.mark((function e(){var t,a,r,n,l,o,c,i,f,d,p=this,m=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{},e.next=3,this.store.checkName({name:t.name,namespace:t.name,cluster:t.cluster});case 3:if(!e.sent.exist){e.next=7;break}return e.next=7,this.store.fetchDetail({name:t.name,namespace:t.name,cluster:t.cluster});case 7:return a=(0,y.toJS)(this.store.detail),e.next=10,this.storageStore.fetchList({cluster:t.cluster});case 10:r=e.sent,n=Y({},(0,g.default)(this.workspaceQuotaStore.detail,"spec.quota.hard",{})),l=this.getWorkspaceAvailableStorageConfig(n),o=l.wsAvailableRequest,c=l.wsRelatedStoragesLimit,i=this.getStorageSpec(a,o),f=i.spec,d=i.nsAvailableStorage,this.setState({formTemplate:this.cancelGpuSetting(a),allStorageClass:(0,s.default)(r),spec:f,nsAvailableStorage:d,wsAvailableRequest:o,wsRelatedStoragesLimit:c},(function(){p.setRelateSourceResult()}));case 15:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getWorkspaceAvailableStorageConfig",value:function(){var e=1/0,t=1/0,a=(0,y.toJS)(this.workspaceQuotaStore.detail),r=(0,g.default)(a,"spec.quota.hard",{}),n=(0,T.default)(r,(function(e,t){return!t.includes(M.STORAGE_CLASS_STORAGE)&&!t.includes(M.STORAGE_CLASS_VOLUME_CLAIMS)})),l=(0,g.default)(r,["requests.storage"],void 0),u=(0,g.default)(r,["persistentvolumeclaims"],void 0);(l&&(e=l=(0,V.memoryFormat)(l,"Gi")),u)&&(t=Number(u));return{wsAvailableRequest:{storage:e,persistentvolumeclaims:t},wsRelatedStoragesLimit:(0,N.default)(Object.entries(n),(function(e){return(0,c.default)(e,1)[0].split(".")[0]}))}}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.visible,n=e.onCancel,l=e.isFederated,u=e.isSubmitting,o=this.state,c=o.error,s=o.spec,i=o.allStorageClass,f=o.nsAvailableStorage,d=o.wsAvailableRequest,p=o.wsRelatedStoragesLimit,m=o.disableSave,h=o.totalStorageError,E=o.totalVolumeClaimsError,y=o.currentRelatedStorageTotal,g=o.currentRelatedVolumeClaimsTotal,b=o.addedItems;return v.default.createElement(w.default.Form,{width:960,title:t("EDIT_PROJECT_QUOTAS"),icon:"pen",data:this.state.formTemplate,onOk:this.handleOk,onCancel:n,visible:r,isSubmitting:u,disableOk:!!c||m},v.default.createElement("div",{className:B.default.body},v.default.createElement(A.Form.Item,{label:t("NAME")},v.default.createElement(A.Input,{name:"name",defaultValue:a.name,disabled:!0})),v.default.createElement(A.Form.Item,null,v.default.createElement(L.default,this.resourceLimitProps)),v.default.createElement("div",{className:B.default.storageLimit},v.default.createElement(M.default,{namespace:a.name,quota:s,isWorkspace:!1,availableQuota:f,wsAvailableRequest:d,relatedStoragesLimit:p,allStorageClass:i,onChange:this.handleOnChange,renderOutOfLimitTip:h||E,totalStorageError:h,totalVolumeClaimsError:E,currentRelatedStorageTotal:y,currentRelatedVolumeClaimsTotal:g,addedItems:b})),v.default.createElement("div",{className:B.default.label},t("APPLICATION_RESOURCE_QUOTAS")),v.default.createElement(G.default,{data:this.state.formTemplate,isFederated:l})))}},{key:"resourceLimitProps",get:function(){var e=this,a=this.state.formTemplate,r=this.state.leftQuota,n=(0,_.default)(r)?{}:{limits:{cpu:(0,g.default)(r,"limits.cpu"),memory:(0,g.default)(r,"limits.memory")},requests:{cpu:(0,g.default)(r,"requests.cpu"),memory:(0,g.default)(r,"requests.memory")}},l=(0,g.default)(a,"spec.gpu.type",""),u=(0,g.default)(a,"spec.gpu.value",""),o={};return(0,b.default)(o,'["'.concat(l,'"]'),u),{cpuProps:{marks:[{value:0,label:t("NO_REQUEST"),weight:4},{value:1,label:1,weight:4},{value:2,label:2,weight:2},{value:3,label:3,weight:2},{value:4,label:4},{value:5,label:5},{value:6,label:6},{value:7,label:7},{value:8,label:8},{value:1/0,label:t("NO_LIMIT")}]},memoryProps:{marks:[{value:0,label:t("NO_REQUEST"),weight:4},{value:2,label:2,weight:4},{value:4,label:4,weight:2},{value:6,label:6,weight:2},{value:8,label:8},{value:10,label:10},{value:12,label:12},{value:14,label:14},{value:16,label:16},{value:1/0,label:t("NO_LIMIT")}],unit:"Gi",valueFormatter:function(e){return e>0&&e<1?e.toFixed(2):e>1&&e!==1/0?e.toFixed(1):e}},defaultValue:{limits:Y({cpu:(0,g.default)(a,'spec.hard["limits.cpu"]'),memory:(0,g.default)(a,'spec.hard["limits.memory"]')},o),requests:Y({cpu:(0,g.default)(a,'spec.hard["requests.cpu"]'),memory:(0,g.default)(a,'spec.hard["requests.memory"]')},o)},workspaceLimitProps:n,onChange:function(e){var t;(0,S.default)(a,"spec.hard"),(0,b.default)(a,'spec.hard["limits.cpu"]',(0,g.default)(e,"limits.cpu",null)),(0,b.default)(a,'spec.hard["limits.memory"]',(0,g.default)(e,"limits.memory",null)),(0,b.default)(a,'spec.hard["requests.cpu"]',(0,g.default)(e,"requests.cpu",null)),(0,b.default)(a,'spec.hard["requests.memory"]',(0,g.default)(e,"requests.memory",null));var r=(0,g.default)(e,"requests",{}),n=null===(t=Object.keys(r))||void 0===t?void 0:t.filter((function(e){return e.includes("gpu")})),l=(0,g.default)(n,"0","");l&&(0,b.default)(a,'spec.hard["requests.'.concat(l,'"]'),(0,g.default)(r,l))},onError:function(t){e.setState({error:t})},supportGpuSelect:this.props.supportGpuSelect,omitQuotaCheck:!0}}}]),n}(v.default.Component);a.default=q,q.propTypes={detail:E.default.object,visible:E.default.bool,onOk:E.default.func,onCancel:E.default.func,isSubmitting:E.default.bool},q.defaultProps={visible:!1,isSubmitting:!1,detail:{},onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(3),r(10),r(6),r(51),r(24),r(193),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(317)),o=l(r(31)),c=l(r(97)),s=l(r(50));r(12),r(3),r(10),r(6),r(27),r(51),r(24),r(193),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var i=n(r(0)),f=r(189),d=l(r(1133)),p=l(r(26)),m=l(r(444)),h=l(r(958)),v=l(r(142)),E=r(56),y=l(r(5)),g=l(r(1474)),b=l(r(2946)),S=l(r(1475)),_=l(r(2948));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var T=f.Tabs.TabPanel,R=[{value:0,label:t("NO_REQUEST"),weight:2},{value:512,label:512,weight:2},{value:1024,label:1024,weight:2},{value:1536,label:1536,weight:2},{value:2048,label:2048},{value:1/0,label:t("NO_LIMIT")}],D=function(e){return e>0&&e<1?e.toFixed(2):e>1&&e!==1/0?e.toFixed(1):e},k=function(e){var a=e.storageLimitSpec,r=e.renderOutOfLimitTip,n=void 0!==r&&r,l=e.totalStorageError,O=void 0!==l&&l,k=e.totalVolumeClaimsError,N=void 0!==k&&k,I=(0,s.default)(e,["storageLimitSpec","renderOutOfLimitTip","totalStorageError","totalVolumeClaimsError"]),P=(0,i.useState)(!1),A=(0,c.default)(P,2),w=A[0],L=A[1],M=(0,i.useState)({"requests.storage":"InfinityGi",persistentvolumeclaims:""}),x=(0,c.default)(M,2),j=x[0],U=x[1],F=(0,i.useState)("workspace"),V=(0,c.default)(F,2),G=V[0],B=V[1];(0,i.useEffect)((function(){var e=(0,p.default)(a,["requests.storage"],"InfinityGi"),t={"requests.storage":e,persistentvolumeclaims:(0,p.default)(a,["persistentvolumeclaims"],"")};L("InfinityGi"===e),U(C({},t))}),[a]);var z,Y,H,q,K,W,Q,J,X=i.default.createElement("div",{className:b.default.tipContent},i.default.createElement("div",{className:b.default.warning},t("TOTAL_STORAGE_LIMIT_LESS_THAN_RELATE_RESOURCE")));return i.default.createElement("div",{className:b.default.storageClassBox},i.default.createElement("div",{className:b.default.titleLine},i.default.createElement("div",{className:b.default.icon},i.default.createElement(f.Icon,{name:"storage",size:40})),i.default.createElement("div",null,i.default.createElement("span",{className:b.default.title},t("STORAGE_QUOTA")),i.default.createElement("span",{className:b.default.desc},I.isWorkspace?t("WS_STORAGE_QUOTA_DESC"):t("NS_STORAGE_QUOTA_DESC")))),i.default.createElement("div",{className:b.default.setting},i.default.createElement(f.Tabs,{type:"button",activeName:G,onChange:function(e){return B(e)}},i.default.createElement(T,{label:t("TOTAL_STORAGE_RESOURCE"),name:"workspace"},(W=j["requests.storage"],Q=(0,v.default)(W)?"InfinityGi"===W?1/0:(0,E.memoryFormat)(W,"Gi"):W,J=j.persistentvolumeclaims,i.default.createElement("div",{className:b.default.storageClassBox},i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement("div",{className:b.default.slider},i.default.createElement("span",{className:b.default.text},t("VOLUME_TOTAL_CAPACITY",{unit:"Gi"})),i.default.createElement(S.default,{value:w?1/0:Q,marks:R,unit:"Gi",valueFormatter:D,onChange:function(e){return function(e){(0,h.default)(e)?L(!1):L(!0);var t={"requests.storage":isNaN(e)?"InfinityGi":"".concat(e).concat("Gi"),persistentvolumeclaims:(0,p.default)(j,["persistentvolumeclaims"],"")};I.handleWsLimitChange(C({},t))}(e)}})))),i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement("span",{className:b.default.text},t("RESOURCE_LIMITS")),i.default.createElement("div",{className:(0,y.default)(b.default.wrapper,(0,o.default)({},b.default.error,O))},i.default.createElement(g.default,{className:b.default.input,min:0,value:w?"":Q,placeholder:w?t("NO_LIMIT"):"",onChange:function(e){return a=t=e,(0,m.default)(t,".")&&(a=Number(t.slice(0,t.length-1))),""!==t&&"-"!==t||(a=1/0),void I.handleWsLimitChange({"requests.storage":"".concat(a,"Gi"),persistentvolumeclaims:(0,p.default)(j,["persistentvolumeclaims"],"")});var t,a}}),i.default.createElement("span",{className:b.default.unit},"Gi"))),i.default.createElement(f.Column,null,i.default.createElement("span",{className:b.default.text},t("VOLUME_MAX_NUM")),i.default.createElement("div",{className:(0,y.default)(b.default.wrapper,(0,o.default)({},b.default.error,N))},i.default.createElement(d.default,{className:b.default.input,min:0,value:J,placeholder:t("NO_LIMIT"),onChange:function(e){return r=t=e,(0,m.default)(t,".")&&(r=Number(t.slice(0,t.length-1))),""!==t&&"-"!==t||(r=""),void I.handleWsLimitChange({"requests.storage":(0,p.default)(a,["requests.storage"]),persistentvolumeclaims:r});var t,r}})))),!I.isWorkspace&&(z=(0,p.default)(I.wsAvailableRequest,"storage",1/0),Y=(0,p.default)(I.wsAvailableRequest,"persistentvolumeclaims",1/0),H=(0,h.default)(z)?t("STORAGE_VOLUME_LIMIT_HAS_A_LIMIT",{num:z}):t("STORAGE_VOLUME_LIMIT_NO_LIMIT"),q=(0,h.default)(Y)?t("STORAGE_PERSISTENT_VOLUME_HAS_A_LIMIT",{num:Y}):t("STORAGE_PERSISTENT_VOLUME_NO_LIMIT"),K="".concat(H,", ").concat(q),i.default.createElement("div",{className:b.default.tipContent},i.default.createElement(f.Alert,{type:"info",title:t("AVAILABLE_QUOTAS"),message:K}))),n&&X))),i.default.createElement(T,{label:t("STORAGE_RELATED_RESOURCE"),name:"related"},i.default.createElement(_.default,(0,u.default)({wsQuotaSpec:j,namespaceStorageClass:I.namespaceStorageClass,onChange:I.handleRelateVolumeChange},I))))))};a.default=k},function(e,t,a){e.exports={body:"_1Zibu60vRfDthPuTtmecl6",quotaItem:"_2B9mfPAIPrv87rpL8gK0Z3",label:"_387XF4DSpyII0xdPCm5Ol-",storageClassBox:"GsUeOovHSpbPHsXrfFSVd",titleLine:"_2b5PjG5EJ76L_CdkwSPf0d",icon:"_2hX0yF-a_71od_SpFGkHPc",title:"_3cGLB1-_7HM9DFtM2TaigR",desc:"_2FnNeo05GhWmAnl1WF1MM0",setting:"_19mHEHTw_bOB7NvvH2ASZE",labelTitle:"_2grZ3IUkiniMD2AXEHolyr",slider:"_277WgEgy_uhoHRu4K8tYrV",wrapper:"_3Ys-12L0fXQ8IAT8TOQMwA",unit:"_2TZjwDYDSzQuS9x7nY2Wos",text:"IUX493SRHJsoFy1nCdpuo",tipContent:"_1PqAcxrcsIzCF2KVhpciIh",warning:"DwT3n4gVdL1CX0m9GWbi8",relatedBox:"_3tHVi0clIheoFTfZ_VAWTr",value:"_1CvMaWz4ZY1zV_f_gqXywE",addQuota:"Ob66euHsOLSyS_BwVPVpw",addBox:"_2OxV92PCBs2dkZd5Qt2usU",addContent:"_2v8rozHDR2mazzNtAk6O4c",closeContent:"_2Z5LKlEGF3nX0OW0XM5GTw",error:"cVDyGh3umWPB0JhKLe8w1"}},function(e,t,a){e.exports={sliderWrapper:"INNBh97y-sYhMpVHkK4Cx",slider:"_3UgYaCslbwFNrg1OHhgtCa",rail:"_1M9nwpLeBwN-yBGjjJS0wK",track:"_9S1TEImvI4d7kGjcNqPN-",handler:"b0ekkTeiTmxUXjH6CcDL6",mark:"_3hurtyaOWHzXYBzgHj0tE",inputWrapper:"_1OHarvGzBe3xdofM0FT4cA",inputGroup:"_3MBu3VVqJNZxy6JdlTFD8l",input:"tY1BQ6yan1T6oqPBCIZSV",error:"_1xlDWH5PHscTddpENrWRA0",label:"_2OHx8yT3Rc_GlstfwtAOqg",inputBox:"_1GlrMZcwurb0PmqkDTfdw",unit:"_2-SWp1Be4AZe-14gP-4L1F",message:"_2GhODRzieuOaggJkAMiQt1"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(3),r(10),r(44),r(6),r(88),r(20),r(51),r(14),r(24),r(193),r(99),r(8),r(13),r(9),r(30),r(69),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(31)),o=l(r(97));r(12),r(3),r(10),r(44),r(6),r(88),r(20),r(27),r(51),r(14),r(24),r(193),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(30),r(69),r(71),r(7);var c=r(189),s=l(r(5)),i=l(r(805)),f=l(r(444)),d=l(r(26)),p=l(r(958)),m=n(r(0)),h=r(56),v=r(1192),E=l(r(1475)),y=l(r(1474)),g=l(r(2949)),b=l(r(2950));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O=[{value:0,label:t("NO_REQUEST"),weight:2},{value:512,label:512,weight:2},{value:1024,label:1024,weight:2},{value:1536,label:1536,weight:2},{value:2048,label:2048},{value:1/0,label:t("NO_LIMIT")}],C={name:"","requests.storage":"InfinityGi",persistentvolumeclaims:""};function T(e){return e>0&&e<1?e.toFixed(2):e>1&&e!==1/0?e.toFixed(1):e}var R=function(e){var a=(0,m.useState)(!1),r=(0,o.default)(a,2),n=r[0],l=r[1],S=(0,m.useState)(_({},C)),R=(0,o.default)(S,2),D=R[0],k=R[1],N=(0,m.useRef)(),I=(0,m.useState)({editItemName:"",isEditMode:!1,storage:0,claims:0}),P=(0,o.default)(I,2),A=P[0],w=P[1],L=(0,m.useState)({limit:"",count:""}),M=(0,o.default)(L,2),x=M[0],j=M[1],U=(0,m.useState)(!1),F=(0,o.default)(U,2),V=F[0],G=F[1],B=(0,m.useState)(!1),z=(0,o.default)(B,2),Y=z[0],H=z[1],q=(0,m.useCallback)((function(){n&&N.current.scrollIntoView({behavior:"smooth"})}),[N,n]);(0,m.useEffect)((function(){q()}),[n,V,Y]),(0,m.useEffect)((function(){var t=(0,d.default)(e.availableQuota,["storage"],1/0),a=(0,d.default)(e.availableQuota,["persistentvolumeclaims"],1/0),r=(0,d.default)(e.wsQuotaSpec,["persistentvolumeclaims"]),n=(0,d.default)(e.wsQuotaSpec,["requests.storage"]);if(r=""===r?1/0:r,"string"==typeof(n=""===n?1/0:n)){var l=(0,h.memoryFormat)(n,"Gi");n=l||1/0}if(!e.isWorkspace){var u=D.name,c=(0,d.default)(e.relatedStoragesLimit,["".concat(u)],null);if(c){var s=c.filter((function(e){return(0,o.default)(e,1)[0].match("storageclass.storage.k8s.io/requests.storage")})),i=c.filter((function(e){return(0,o.default)(e,1)[0].match("storageclass.storage.k8s.io/persistentvolumeclaims")})),f=1/0,m=1/0;if(s.length>0&&(f=(0,h.memoryFormat)(s[0][1],"Gi")),i.length>0&&(m=Number(i[0][1])),(t-=e.currentRelatedStorageTotal)<f){if(A.isEditMode){var v=(0,h.memoryFormat)(A.storage,"Gi");t+=v=isNaN(v)?0:Number(v)}}else t=f;(a-=e.currentRelatedVolumeClaimsTotal)<m?A.isEditMode&&(a+=Number(A.claims)):a=m}else{var E=Math.min(t,n),y=Math.min(a,r);if(E-=e.currentRelatedStorageTotal,y-=e.currentRelatedVolumeClaimsTotal,A.isEditMode){var g=(0,h.memoryFormat)(A.storage,"Gi");E+=g=isNaN(g)?0:Number(g),y+=Number(A.claims)}t=E,a=y}}var b=t>=0?Math.min(t,n):(0,p.default)(n)?n:1/0,S=Math.min(a,r);j({limit:b,count:S})}),[e.availableQuota,D,n]),(0,m.useEffect)((function(){$(D.persistentvolumeclaims);var e=(0,h.memoryFormat)(D["requests.storage"],"Gi");Z(e=""!==e?e:"Infinity")}),[x]);var K,W,Q,J,X=(0,m.useCallback)((function(e){k(_(_({},D),{},{name:e.name}))}),[D]),Z=function(t){var a=x.limit,r=e.currentRelatedStorageTotal,n=A.isEditMode,l=A.storage,u=(0,h.memoryFormat)(l,"Gi");if("InfinityGi"!==a&&""!==a&&(0,p.default)(t)){var o=Number(a);e.isWorkspace&&(o-=r,!isNaN(u)&&n&&(o+=u)),"string"==typeof a&&(o=Number(a.replace(/[a-zA-Z]/g,""))),G(t>o)}else V&&G(!1)},$=function(t){var a=x.count,r=e.currentRelatedVolumeClaimsTotal,n=A.isEditMode,l=A.claims;if(""!==a&&""!==t){var u=a;e.isWorkspace&&(u-=r,""!==l&&n&&(u+=Number(l))),"string"==typeof a&&(u=a.replace(/[a-zA-Z]/g,"")),Number(t)>u?H(!0):H(!1)}else H(!1)},ee=(0,m.useCallback)((function(){l(!1),k(_({},C)),H(!1),G(!1),w({editItemName:"",isEditMode:!1,storage:0,claims:0})}),[]),te=(0,m.useCallback)((function(){var t;l(!1);var a=D.name,r=D["requests.storage"],n=D.persistentvolumeclaims,o=(t={},(0,u.default)(t,"".concat(a,".").concat(v.STORAGE_CLASS_STORAGE),r),(0,u.default)(t,"".concat(a,".").concat(v.STORAGE_CLASS_VOLUME_CLAIMS),n),t),c=A.isEditMode?{actionType:"edit",originName:A.editItemName,data:_({},o)}:{actionType:"add",data:_({},o)};e.onChange(c),k(C),w({editItemName:"",isEditMode:!1,limit:0,claims:0})}),[D]),ae=(0,m.useCallback)((function(t){var a,r=t.name;e.onChange({actionType:"delete",data:(a={},(0,u.default)(a,"".concat(r,".").concat(v.STORAGE_CLASS_STORAGE),""),(0,u.default)(a,"".concat(r,".").concat(v.STORAGE_CLASS_VOLUME_CLAIMS),""),a)})}),[]),re=(0,m.useCallback)((function(e,t){k({name:e.name,"requests.storage":t.storage,persistentvolumeclaims:t.claims}),w({editItemName:e.name,isEditMode:!0,storage:t.storage,claims:t.claims}),l(!0)}),[]),ne=(0,m.useCallback)((function(){return m.default.createElement("div",{className:g.default.relatedBox},m.default.createElement("div",{className:g.default.list},Object.entries(e.namespaceStorageClass).map((function(a,r){var n=(0,o.default)(a,2),l=n[0],u=n[1],s=e.allStorageClass.find((function(e){return e.name===l})),i="InfinityGi",f="",p=u.filter((function(e){return-1!==e.key.indexOf("requests.storage")}));p.length>0&&(i=p[0].value);var v,E,y,b=u.filter((function(e){return-1!==e.key.indexOf("persistentvolumeclaims")}));return b.length>0&&(f=b[0].value),s&&m.default.createElement("div",{className:g.default.card,key:r},(v=s,E={storage:"InfinityGi"===i?"InfinityGi":"".concat((0,h.memoryFormat)(i,"Gi"),"Gi"),claims:f},y=(0,h.memoryFormat)(E.storage,"Gi"),m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:g.default.baseInfo},m.default.createElement("div",{className:g.default.Icon},m.default.createElement(c.Icon,{name:"database",size:40})),m.default.createElement("div",{className:g.default.text},m.default.createElement("p",{className:g.default.label},v.name,v.default&&m.default.createElement("span",{className:g.default.default},t("DEFAULT"))),m.default.createElement("p",{className:g.default.value},t("NAME"))),m.default.createElement("div",{className:g.default.text},m.default.createElement("p",{className:g.default.label},(0,d.default)(e.relatedCount,v.name,0)),m.default.createElement("p",{className:g.default.value},t("VOLUME_COUNT"))),m.default.createElement("div",{className:g.default.iconText},m.default.createElement("div",null,m.default.createElement("p",{className:g.default.label},v.provisioner),m.default.createElement("p",{className:g.default.value},t("PROVISIONER"))),m.default.createElement("div",{className:g.default.opt},m.default.createElement(c.Icon,{name:"trash",size:16,onClick:function(){return ae(v)}}),m.default.createElement(c.Icon,{name:"pen",size:16,onClick:function(){return re(v,E)}})))),m.default.createElement("div",{className:g.default.config},m.default.createElement("span",{className:g.default.config_text},m.default.createElement("span",{className:g.default.value},t("STORAGE_LIMIT"),": "),m.default.createElement("span",{className:g.default.label},"InfinityGi"===E.storage||isNaN(y)?t("NO_LIMIT"):"".concat(y,"Gi"))),m.default.createElement("span",{className:g.default.config_text},m.default.createElement("span",{className:g.default.value},t("STORAGE_CLASS_VOLUME"),": "),m.default.createElement("span",{className:g.default.label},""!==E.claims?E.claims:t("NO_LIMIT")))))))}))),m.default.createElement("div",{className:g.default.addQuota,onClick:function(){return l(!0)}},m.default.createElement("p",{className:g.default.label},t("SELECT_A_STORAGECLASS")),m.default.createElement("p",{className:g.default.value},t("SET_RELATED_STORAGE_CLASS_QUOTA"))))}),[e.namespaceStorageClass]);return n?(K=(0,h.memoryFormat)(D["requests.storage"],"Gi"),W=D.persistentvolumeclaims,Q=isNaN(K)?1/0:K,J=!1,(""===D.name||0===Q||0===W)&&(J=!0),m.default.createElement("div",{className:g.default.addBox},m.default.createElement("div",{className:g.default.addContent,ref:N},m.default.createElement(b.default,{addedItems:e.addedItems,allStorageClass:e.allStorageClass,editName:D.name,editMode:A.isEditMode,onChange:X}),m.default.createElement("div",null,m.default.createElement(c.Columns,null,m.default.createElement(c.Column,null,m.default.createElement("div",{className:g.default.slider},m.default.createElement("span",{className:g.default.text},t("VOLUME_TOTAL_CAPACITY",{unit:"Gi"})),m.default.createElement(E.default,{value:(0,p.default)(K)?Number(K):1/0,marks:O,unit:"Gi",valueFormatter:T,onChange:function(e){return function(e){var t=isNaN(e)?"InfinityGi":"".concat(e).concat("Gi");Z(t),k(_(_({},D),{},{"requests.storage":t}))}(e)}})))),m.default.createElement(c.Columns,null,m.default.createElement(c.Column,null,m.default.createElement("span",{className:g.default.text},t("RESOURCE_LIMITS")),m.default.createElement("div",{className:(0,s.default)(g.default.wrapper,(0,u.default)({},g.default.error,V))},m.default.createElement(y.default,{className:g.default.input,min:0,value:(0,p.default)(K)?K:"",placeholder:(0,p.default)(K)?"":t("NO_LIMIT"),onChange:function(e){return a=t=e,(0,f.default)(t,".")&&(a=Number(t.slice(0,t.length-1))),""!==t&&"-"!==t||(a=1/0),Z(a),void k(_(_({},D),{},{"requests.storage":"".concat(a).concat("Gi")}));var t,a}}),m.default.createElement("span",{className:g.default.unit},"Gi"))),m.default.createElement(c.Column,null,m.default.createElement("span",{className:g.default.text},t("VOLUME_MAX_NUM")),m.default.createElement("div",{className:(0,s.default)(g.default.wrapper,(0,u.default)({},g.default.error,Y))},m.default.createElement(i.default,{className:g.default.input,min:0,value:W,placeholder:t("NO_LIMIT"),onChange:function(e){return a=t=e,(0,f.default)(t,".")&&(a=Number(t.slice(0,t.length-1))),""!==t&&"-"!==t||(a=""),$(a),void k(_(_({},D),{},{persistentvolumeclaims:a}));var t,a}}))))),function(){var a=x.limit,r=x.count,n=e.currentRelatedStorageTotal,l=e.currentRelatedVolumeClaimsTotal,u=a,o=r;if(e.isWorkspace){(0,p.default)(a)&&(u-=n),(0,p.default)(r)&&(o-=l);var s=A.isEditMode,i=A.storage,f=A.claims,d=(0,h.memoryFormat)(i,"Gi");(0,p.default)(a)&&s&&!isNaN(d)&&(u+=d),""!==f&&(0,p.default)(r)&&s&&(o+=Number(f))}var v=(0,p.default)(a)?t("STORAGE_VOLUME_LIMIT_HAS_A_LIMIT",{num:u}):t("STORAGE_VOLUME_LIMIT_NO_LIMIT"),E=(0,p.default)(r)?t("STORAGE_PERSISTENT_VOLUME_HAS_A_LIMIT",{num:o}):t("STORAGE_PERSISTENT_VOLUME_NO_LIMIT"),y="".concat(v,", ").concat(E);return m.default.createElement("div",{className:g.default.tipContent},m.default.createElement(c.Alert,{type:"info",title:t("AVAILABLE_QUOTAS"),message:y}),(V||Y)&&m.default.createElement("div",{className:g.default.warning},t("REQUEST_EXCEED_AVAILABLE_QUOTA")))}(),m.default.createElement("div",{className:g.default.closeContent},m.default.createElement("div",{className:g.default.icon,onClick:ee},m.default.createElement(c.Icon,{name:"close",size:16})),m.default.createElement("div",{className:(0,s.default)(g.default.icon,(0,u.default)({},g.default.disabled,J||Y||V)),onClick:te},m.default.createElement(c.Icon,{name:"check",size:16})))))):ne()};a.default=R},function(e,t,a){e.exports={relatedBox:"_1GGmkso_4IJTkxjrWF32_6",label:"_1CGNqu-q5sfQ050_H30wts",value:"KKbwkLC9KvM1xuHdZVHBw",list:"RdLtbOozPGoubquDaAr3O",card:"_3owbF3meZl7eQCaMwjlyRC",baseInfo:"_3eNCBNEnGHEBCoYOrxEYRn",Icon:"_1668ydHLavkdcsClp6BPDz",text:"_3tYSIDE5E8DLQS1Fpwu63f",default:"_3cN04CNtBKjf8lFfA73-v",iconText:"_1-XxK_YcydUaYulcve3UHw",opt:"_1dQEbMcYDc_524orHLVEEK",config:"etu-pGB83QqKQxJDXo-Sm",config_text:"_1lbPmxNq09U-73j0TaoBgQ",addQuota:"_2HKZQ-LKndrfIztjRwDalI",addBox:"_3WSfp73NfezhHgTmYM4qnb",addContent:"_14unDCHvUsTwbIvUhkQ_vD",wrapper:"_1_w447Hic4nOy-sCH5RDzV",unit:"_3SYBak0N4z7MISs51IM25h",tipContent:"QM2pl7XTGNSX9NTrqJmFa",warning:"_3QnOEHy7BNAOBXqS6JWz1A",closeContent:"_37J22EJXV49Y4H_NAS6KDh",icon:"_2YbiBieUBwoH8Dyg-XrDIu",disabled:"_9VqM3CRNqJWJJ4sz0ijXt",error:"V6cUjfRc1-lPhfqYMb029"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(88),r(20),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(88),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var u=l(r(31)),o=l(r(97)),c=n(r(0)),s=r(189),i=l(r(5)),f=l(r(67)),d=l(r(2951));function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h=function(e){var a=(0,c.useState)(!1),r=(0,o.default)(a,2),n=r[0],l=r[1],p=(0,c.useState)({}),h=(0,o.default)(p,2),v=h[0],E=h[1];(0,c.useEffect)((function(){var t=e.allStorageClass.filter((function(t){return t.name===e.editName}))[0];E(m({},t))}),[e.editName]);var y=(0,c.useCallback)((function(t){l(!1),E(m({},t)),e.onChange(t)})),g=(0,c.useCallback)((function(e){return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:d.default.Icon},c.default.createElement(s.Icon,{name:"database",size:40})),c.default.createElement("div",{className:d.default.text},c.default.createElement("p",{className:d.default.label},e.name," ",e.default&&c.default.createElement("span",{className:d.default.default},t("DEFAULT"))),c.default.createElement("p",{className:d.default.value},t("NAME"))),c.default.createElement("div",{className:d.default.text},c.default.createElement("p",{className:d.default.label},e.associationPVCCount||0),c.default.createElement("p",{className:d.default.value},t("VOLUME_COUNT"))),c.default.createElement("div",{className:d.default.text},c.default.createElement("p",{className:d.default.label},e.provisioner),c.default.createElement("p",{className:d.default.value},t("PROVISIONER"))))})),b=e.allStorageClass.filter((function(t){return-1===e.addedItems.indexOf(t.name)})),S=e.editMode,_=c.default.createElement("div",{className:(0,i.default)(d.default.addBox,(0,u.default)({},d.default.hover,!S)),onClick:function(){return l(!n)}},(0,f.default)(v)?c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:d.default.Icon},c.default.createElement(s.Icon,{name:"database",size:40})),c.default.createElement("div",{className:d.default.text},c.default.createElement("p",{className:d.default.label},t("SELECT_STORAGE_CLASS")),c.default.createElement("p",{className:d.default.value},t("SET_RELATED_STORAGE_CLASS_QUOTA")))):c.default.createElement(c.default.Fragment,null,g(v)),!S&&c.default.createElement("div",{className:n?d.default.rotate:""},c.default.createElement(s.Icon,{name:"chevron-down",size:20}))),O=(0,c.useCallback)((function(){return b.length>0?c.default.createElement("div",{className:d.default.list},c.default.createElement("div",{className:d.default.extraContent},b.map((function(e){return c.default.createElement("div",{className:d.default.card,key:e.name,onClick:function(){return y(e)}},g(e))})))):null}));return c.default.createElement("div",{className:d.default.wrapper},_,c.default.createElement(c.default.Fragment,null,!S&&n&&O()))};a.default=h},function(e,t,a){e.exports={addBox:"_2P0f0FwDVpHJ7wtcHg4mZP",Icon:"_2EoBETTKKnmy_fVgMCB9yR",text:"_164oSWx0vc9753lp2Rf8EW",label:"_3Os24eJRt_vq5NdAj6PtUr",default:"_1iDV2CgIhUQCZE-BWJqX03",value:"yp2bvppkb-cW4cXDNXuEr",hover:"_14g5XwSM1u8TqXP18Hl3Ij",list:"_2iNtlWNCQ_kNrIK58DBunO",extraContent:"_3leBkLEhf6uYuWG1Al7lTt",card:"_7YZjcuF7SXPzsBKEKEqhm",wrapper:"_32Jj8ViLQU8hzot9rBIvko",rotate:"JUvzx2dwgkpp6dtYPx2A9"}},function(e,a,r){"use strict";r(16);var n=r(19);r(199),r(6),r(70),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(199),r(6),r(70),r(27),r(860),r(29),r(4),r(18),r(43),r(11),r(73),r(7);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(1005)),p=n(r(26)),m=n(r(67)),h=n(r(68)),v=n(r(140)),E=n(r(163)),y=n(r(204)),g=n(r(244)),b=n(r(457)),S=r(189),_=n(r(824)),O=r(61),C=r(56),T=n(r(2953)),R=r(1476),D=n(r(2954));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var N=function(e){(0,c.default)(r,e);var a=k(r);function r(e){var t;return(0,u.default)(this,r),(t=a.call(this,e)).handleAddQuotaItem=function(e){t.setState({items:e},(function(){var a=(0,p.default)(t.props.data,"spec.hard"),r=(0,g.default)(a,t.omitKeys),n={};e.forEach((function(e){var t=e.module,a=e.value;if(!(0,E.default)(t)){var r=(0,p.default)(O.QUOTAS_MAP,"".concat(t,".name"),t);n["".concat(r)]=a}})),(0,h.default)(t.props.data,"spec.hard",(0,y.default)(n,r))}))},t.checkItemValid=function(e){return!(0,m.default)(e)&&e.module},t.state={items:(0,l.default)(t.getItems(e))},t}return(0,o.default)(r,[{key:"componentDidUpdate",value:function(e){e.data!==this.props.data&&this.setState({items:(0,l.default)(this.getItems(this.props))})}},{key:"getItems",value:function(e){var t=(0,v.default)((0,p.default)(e.data,"spec.hard",{}),this.omitKeys),a=(0,b.default)(t,(function(e,t){return t.includes("requests.storage")||t.includes("persistentvolumeclaims")})),r=[];(0,d.default)(a,(function(e,t){var a={module:R.QUOTAS_KEY_MODULE_MAP[t]||t,value:e};r.push(a)}));var n=r.findIndex((function(e){return"pods"===e.module}));if(n>0){var l=r[0];r[0]=r[n],r[n]=l}return n<0&&r.unshift({module:"pods",value:""}),r}},{key:"render",value:function(){var e=this.state.items;return f.default.createElement("div",{className:D.default.wrapper},f.default.createElement(S.Form.Item,null,f.default.createElement(_.default,{value:e,itemType:"object",addText:t("ADD"),onChange:this.handleAddQuotaItem,checkItemValid:this.checkItemValid},f.default.createElement(T.default,{isFederated:this.props.isFederated}))))}},{key:"omitKeys",get:function(){var e=globals.config.supportGpuType,t=(0,l.default)(C.resourceLimitKey);return e.forEach((function(e){return t.push("limits.".concat(e),"requests.".concat(e))})),t}}]),r}(f.default.Component);a.default=N},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(70),r(20),r(9),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(70),r(20),r(29),r(9),r(4),r(18),r(43),r(11),r(73);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(189),p=r(61),m=n(r(841)),h=n(r(805)),v=r(1476);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var y=function(e){(0,c.default)(r,e);var a=E(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).handleLimitValue=function(t){e.props.onChange(t)},e.renderInputByModule=function(){var a=e.props.value;return Object.keys(p.QUOTAS_MAP).includes(a.module)?f.default.createElement(h.default,{name:"value",className:"margin-l12",placeholder:t("QUOTA"),integer:!0}):f.default.createElement(d.Input,{name:"value",className:"margin-l12",placeholder:t("QUOTA")})},e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props.value;return f.default.createElement(m.default,{value:e,onChange:this.handleLimitValue},f.default.createElement(d.Select,{name:"module",options:this.options,searchable:!0,disabled:"pods"===e.module,placeholder:t("SELECT_RESOURCE_TIP")}),this.renderInputByModule())}},{key:"options",get:function(){var e=this,a=this.props,r=a.arrayValue,n=a.value.module,u=r.map((function(e){return e.module})),o=[].concat((0,l.default)(u.filter((function(e){return e!==n}))),(0,l.default)(v.RESERVED_MODULES));return Object.keys(p.QUOTAS_MAP).filter((function(t){return!(o.includes(t)||e.props.isFederated&&v.FEDERATED_PROJECT_UNSOPPORT_QUOTA.includes(t))})).map((function(e){return{label:t("NUMBER_OF_".concat(e.toUpperCase())),value:e}}))}}]),r}(f.default.Component);a.default=y},function(e,t,a){e.exports={wrapper:"_2f9FtzUmnr8s0l-t7pIdZ6",add:"_12llEGhtVNhuZkDEOFJruL",item:"ldxiI3Htv3eXoJDTeeX_k"}},function(e,t,a){e.exports={body:"_3saq57SXrBCpwOp8y8Yn9v",quotaItem:"lZFyXdiuUr16N-QbFejXg",label:"_2tWA6RsFJazk5XKsXgERqG",storageLimit:"_1P5oo__wk4zvMZ0OFveyyz"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(88),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(88),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u,o,c,s=n(r(31)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(45)),v=n(r(0)),E=r(243),y=r(17),g=n(r(26)),b=n(r(67)),S=n(r(163)),_=n(r(1)),O=r(189),C=n(r(798)),T=n(r(899)),R=n(r(829)),D=n(r(846)),k=r(56),N=n(r(443)),I=r(61),P=n(r(2957));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var M=(0,E.observer)((c=o=function(e){(0,d.default)(r,e);var a=L(r);function r(e){var n;return(0,i.default)(this,r),(n=a.call(this,e)).nameValidator=function(e,a,r){if(!a)return r();if(0===a.indexOf("kube-"))return r({message:t("NAME_VALIDATION_FAILED"),field:e.field});var l=n.props.cluster||(0,g.default)(n.props.formTemplate,"cluster");if(!l&&globals.app.isMultiCluster)return r();n.store.checkName({name:a,cluster:l}).then((function(a){if(a.exist)return r({message:t("PROJECT_NAME_EXIST_DESC"),field:e.field});r()}))},n.annotationValidator=function(e,a,r){return(0,S.default)(a)||(0,b.default)(a)?r():(0,k.isValidAnnotation)(a)?void r():r({message:t("ANNOTATION_FORMAT_DESC")})},n.handleClusterChange=function(){if(n.nameRef&&n.nameRef.current){var e="metadata.name";n.formRef&&n.formRef.current&&!(0,b.default)(n.formRef.current.state.errors)&&n.formRef.current.resetValidateResults(e),n.nameRef.current.validate((0,s.default)({},e,(0,g.default)(n.props.formTemplate,e)))}},n.valueRenderer=function(e){return v.default.createElement(D.default,{cluster:e.cluster,size:"small",noStatus:!0})},n.optionRenderer=function(e){return v.default.createElement(D.default,{cluster:e.cluster,size:"small",theme:"light",noStatus:!0})},n.store=e.store,n.workspaceStore=new N.default,n.formRef=v.default.createRef(),n.nameRef=v.default.createRef(),n}return(0,f.default)(r,[{key:"componentDidMount",value:function(){this.props.hideCluster||this.fetchClusters()}},{key:"fetchClusters",value:function(e){this.workspaceStore.fetchClusters(w(w({},e),{},{workspace:this.props.workspace}))}},{key:"renderClusters",value:function(){var e=t("KS_CLUSTER");return v.default.createElement(O.Form.Group,{label:e,desc:t("SELECT_CLUSTER_DESC",{type:e})},v.default.createElement(O.Form.Item,{rules:[{required:!0,message:t("CLUSTER_EMPTY_DESC")}]},v.default.createElement(O.Select,{name:"cluster",className:P.default.cluster,options:this.clusters,defaultValue:this.props.defaultCluster,valueRenderer:this.valueRenderer,optionRenderer:this.optionRenderer,onChange:this.handleClusterChange,placeholder:" ",showTip:!0})))}},{key:"renderAdvancedSettings",value:function(){return v.default.createElement(T.default,{className:P.default.advanced},v.default.createElement(O.Columns,null,v.default.createElement(O.Column,null,v.default.createElement(O.Form.Item,{label:t("ANNOTATION_PL"),rules:[{validator:this.annotationValidator}]},v.default.createElement(R.default,{name:"metadata.annotations",addText:t("ADD")})))))}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.formTemplate,n=e.hideCluster,l=e.onOk,u=e.onCancel,o=e.isSubmitting;return v.default.createElement(C.default.Form,{width:960,formRef:this.formRef,bodyClassName:P.default.body,data:r,onCancel:u,onOk:l,visible:a,closable:!1,isSubmitting:o,hideHeader:!0},v.default.createElement("div",{className:P.default.header},v.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/project-create.svg",alt:""}),v.default.createElement("div",{className:P.default.title},v.default.createElement("div",null,t("CREATE_PROJECT")),v.default.createElement("p",null,t("CREATE_PROJECT_DESC")))),v.default.createElement("div",{className:P.default.content},v.default.createElement(O.Columns,null,v.default.createElement(O.Column,null,v.default.createElement(O.Form.Item,{label:t("NAME"),desc:t("PROJECT_NAME_DESC"),ref:this.nameRef,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:I.PATTERN_SERVICE_NAME,message:t("PROJECT_NAME_INVALID_DESC")},{validator:this.nameValidator}]},v.default.createElement(O.Input,{name:"metadata.name",autoFocus:!0,maxLength:63}))),v.default.createElement(O.Column,null,v.default.createElement(O.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:I.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},v.default.createElement(O.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),v.default.createElement(O.Columns,null,v.default.createElement(O.Column,null,v.default.createElement(O.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},v.default.createElement(O.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256}))),v.default.createElement(O.Column,null)),!n&&this.renderClusters(),this.isClusterManage&&this.renderAdvancedSettings()))}},{key:"isClusterManage",get:function(){return globals.app.isPlatformAdmin||globals.app.hasPermission({module:"clusters",action:"manage"})}},{key:"clusters",get:function(){return this.workspaceStore.clusters.data.map((function(e){return{label:e.name,value:e.name,cluster:e,disabled:!e.isReady}}))}},{key:"defaultClusters",get:function(){var e=this.workspaceStore.clusters.data.filter((function(e){return e.isReady})).map((function(e){return{name:e.name}}));return(0,b.default)(e)?void 0:e}}]),r}(v.default.Component),o.propTypes={formTemplate:_.default.object,visible:_.default.bool,isSubmitting:_.default.bool,onOk:_.default.func,onCancel:_.default.func},o.defaultProps={formTemplate:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},u=c,(0,h.default)(u.prototype,"clusters",[y.computed],Object.getOwnPropertyDescriptor(u.prototype,"clusters"),u.prototype),(0,h.default)(u.prototype,"defaultClusters",[y.computed],Object.getOwnPropertyDescriptor(u.prototype,"defaultClusters"),u.prototype),l=u))||l;a.default=M},function(e,t,a){e.exports={body:"yQVuHwvZatSDhyjLUxSq5",header:"_3s8iAobkuDQP3egb7N_LV-",title:"_1N6z-WOWpmvXrCkFLYrEFO",content:"_2J8aCzfL8eRgztGnCRkwJc",cluster:"_3sckvxZYDol88LJbcAn1US",toolmessage:"_37IuScW3NoMm7a6hjFHwUR",advanced:"_1nriC6RCBOcZwoZ1MEx5VH"}},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var u=n(r(317)),o=n(r(31)),c=n(r(38));r(35);var s,i,f,d=n(r(39)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=r(189),g=n(r(798)),b=n(r(244)),S=n(r(68)),_=r(243),O=n(r(1)),C=l(r(0)),T=n(r(323)),R=n(r(443)),D=r(56);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var P=(0,_.observer)((f=i=function(e){(0,h.default)(r,e);var a=I(r);function r(e){var t;return(0,p.default)(this,r),(t=a.call(this,e)).handleWorkspaceChange=function(e){(0,S.default)(t.formTemplate,"metadata.annotations['kubesphere.io/creator']",""),t.setState({workspace:e},(function(){t.fetchMembers()}))},t.fetchWorkspaces=function(){var e=(0,d.default)(c.default.mark((function e(a){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.workspaceStore.fetchList(a));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.fetchMembers=function(){var e=(0,d.default)(c.default.mark((function e(a){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.state.workspace){e.next=2;break}return e.abrupt("return",t.memberStore.fetchList(N({workspace:t.state.workspace},a)));case 2:return e.abrupt("return",Promise.resolve({}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.state={workspace:""},t.formTemplate={},t.workspaceStore=new R.default,t.memberStore=new T.default,t}return(0,m.default)(r,[{key:"componentDidMount",value:function(){this.fetchList()}},{key:"fetchList",value:function(){this.workspaceStore.fetchList({labelSelector:"!cluster-role.kubesphere.io/edge"})}},{key:"getWorkspaces",value:function(){return this.workspaceStore.list.data.map((function(e){return{label:(0,D.showNameAndAlias)(e),value:e.name}}))}},{key:"getUsers",value:function(){return this.memberStore.list.data.map((function(e){return{label:e.username,value:e.username}}))}},{key:"render",value:function(){return C.default.createElement(g.default.Form,(0,u.default)({title:t("ASSIGN_WORKSPACE"),icon:"firewall",width:691,data:this.formTemplate},this.props),C.default.createElement(y.Alert,{className:"margin-b12",type:"info",message:t("PROJECT_ASSIGN_DESC")}),C.default.createElement(y.Form.Item,{label:t("WORKSPACE"),desc:t("SELECT_WORKSPACE_DESC"),rules:[{required:!0,message:t("SELECT_WORKSPACE_DESC")}]},C.default.createElement(y.Select,{name:"metadata.labels['kubesphere.io/workspace']",onChange:this.handleWorkspaceChange,options:this.getWorkspaces(),pagination:(0,b.default)(this.workspaceStore.list,["page","total","limit"]),isLoading:this.workspaceStore.list.isLoading,onFetch:this.fetchWorkspaces,placeholder:" ",searchable:!0,clearable:!0})),C.default.createElement(y.Form.Item,{label:t("PROJECT_ADMINISTRATOR"),desc:t("PROJECT_ADMINISTRATOR_DESC")},C.default.createElement(y.Select,{name:"metadata.annotations['kubesphere.io/creator']",options:this.getUsers(),pagination:(0,b.default)(this.memberStore.list,["page","total","limit"]),isLoading:this.memberStore.list.isLoading,onFetch:this.fetchMembers,placeholder:" ",searchable:!0,clearable:!0})))}}]),r}(C.Component),i.propTypes={visible:O.default.bool,onOk:O.default.func,onCancel:O.default.func},i.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},s=f))||s;a.default=P},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(36),r(20),r(98),r(24),r(8),r(13),r(9),r(4),r(190),r(21),r(18),r(11),r(111),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(36),r(20),r(27),r(98),r(29),r(24),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(21),r(18),r(43),r(11),r(111),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(444)),m=n(r(26)),h=n(r(163)),v=n(r(993)),E=n(r(906)),y=n(r(140)),g=n(r(338)),b=n(r(1045)),S=n(r(0)),_=n(r(1)),O=n(r(798)),C=n(r(843)),T=n(r(874)),R=n(r(888)),D=r(56);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var P=function(e){(0,i.default)(r,e);var a=I(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleChange=function(e){t.setState({data:{default:e.limits,defaultRequest:e.requests}})},t.handleOk=function(){(0,t.props.onOk)(t.state.data)},t.handleError=function(e){return t.setState({error:e})},t.availableQuota_memory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=N({},e);return Object.keys(e).forEach((function(a){a.endsWith("memory")&&(t[a]=(0,D.memoryFormat)(e[a])),a.endsWith("cpu")&&(t[a]=(0,D.cpuFormat)(e[a]))})),t},t.singleClusterQuota=function(e,a,r){return new Promise((function(n){Promise.all([t.quotaStore.fetch({cluster:r,namespace:a}),t.workspaceQuotaStore.fetchDetail({name:e,workspace:e,cluster:r})]).then((function(e){var a=(0,m.default)(e[1],"hard"),r=(0,m.default)(e[0],"data.hard");n({workspaceQuota:t.availableQuota_memory(a),namespaceQuota:t.availableQuota_memory(r)})}))}))},t.multiClusterQuota=function(e,a){var r=[],n={"limits.cpu":void 0,"limits.memory":void 0};t.props.clusters.forEach((function(n){return r.push(t.singleClusterQuota(e,a,n))})),Promise.all(r).then((function(e){var a=e.map((function(e){return(0,m.default)(e,"workspaceQuota",n)})),r=e.map((function(e){return(0,m.default)(e,"namespaceQuota",n)})),l=e.map((function(e){return(0,y.default)((0,m.default)(e,"namespaceQuota",{}),D.resourceLimitKey)}));t.setState({availableQuota:{workspace:t.transformQuota(a),namespace:N(N({},t.transformQuota(r)),t.transformGpu(l))}})}))},t.transformQuota=function(e){return{"limits.cpu":t.findCpuOrMemoryMin(e,"limits.cpu"),"limits.memory":t.findCpuOrMemoryMin(e,"limits.memory"),"requests.cpu":t.findCpuOrMemoryMin(e,"requests.cpu"),"requests.memory":t.findCpuOrMemoryMin(e,"requests.memory")}},t.findCpuOrMemoryMin=function(e,t){var a=e.map((function(e){return e[t]}));return(0,E.default)(a)},t.transformGpu=function(e){var t=globals.config.supportGpuType,a=e.map((function(e){return(0,g.default)(e,(function(e,a){return t.some((function(e){return(0,p.default)(a,e)}))}))}));return(0,b.default)(a,(function(e,t){var a=(0,m.default)(e,"".concat(Object.keys(t)[0]));return a?Number(a)>Number(Object.values(t)[0])?N(N({},e),t):N({},e):N(N({},e),t)}),{})},t.fetchQuota=(0,u.default)(l.default.mark((function e(){var a,r,n,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,r=a.workspace,n=a.cluster,u=a.namespace,a.isFederated){e.next=8;break}return e.next=4,t.singleClusterQuota(r,u,n);case 4:o=e.sent,t.setState({availableQuota:{workspace:(0,m.default)(o,"workspaceQuota"),namespace:(0,m.default)(o,"namespaceQuota")}}),e.next=9;break;case 8:t.multiClusterQuota(r,u);case 9:case"end":return e.stop()}}),e)}))),t.getQuotaInfo=function(e){return(0,m.default)(t.workspaceQuota,e,void 0)},t.handleOk=function(){(0,t.props.onOk)(t.state.data)},t.handleError=function(e){return t.setState({error:e})},t.getQuotaInfo=function(e){return(0,m.default)(t.workspaceQuota,e,void 0)},t.quotaStore=new T.default,t.workspaceQuotaStore=new R.default,t.state={data:(0,m.default)(e.detail,"limit",{}),error:"",availableQuota:{}},t}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.fetchQuota()}},{key:"componentDidUpdate",value:function(e){var t=this.props.detail;t.limit&&t.limit!==e.detail.limit&&this.setState({data:t.limit})}},{key:"getGpuLimit",value:function(){return(0,D.gpuLimitsArr)(this.workspaceQuota)}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=this.state.error;return S.default.createElement(O.default,{width:960,title:t("EDIT_DEFAULT_CONTAINER_QUOTAS"),icon:"firewall",onOk:this.handleOk,onCancel:r,visible:a,isSubmitting:n,disableSubmit:!!l},S.default.createElement(C.default,{defaultValue:this.resourceLimit,onChange:this.handleChange,onError:this.handleError,supportGpuSelect:this.props.supportGpuSelect||!1,workspaceLimitProps:this.workspaceLimitProps}))}},{key:"resourceLimit",get:function(){return{requests:(0,m.default)(this.props.detail,"limit.defaultRequest",{}),limits:(0,m.default)(this.props.detail,"limit.default",{})}}},{key:"workspaceQuota",get:function(){var e=(0,m.default)(this.state,"availableQuota.namespace",{}),t=(0,m.default)(this.state,"availableQuota.workspace",{});return(0,v.default)(e,t,(function(e,t){if(e||t)return(0,h.default)(e)?t:e<t?e:t}))}},{key:"workspaceLimitProps",get:function(){return{limits:{cpu:this.getQuotaInfo("limits.cpu"),memory:this.getQuotaInfo("limits.memory")},requests:{cpu:this.getQuotaInfo("requests.cpu"),memory:this.getQuotaInfo("requests.memory")},gpuLimit:this.getGpuLimit()}}}]),r}(S.default.Component);a.default=P,P.propTypes={detail:_.default.object,namespace:_.default.string,visible:_.default.bool,onOk:_.default.func,onCancel:_.default.func,isSubmitting:_.default.bool},P.defaultProps={visible:!1,isSubmitting:!1,namespace:"",detail:{},onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(70),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(44),r(6),r(70),r(36),r(66),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(798)),f=n(r(822)),d=n(r(2961)),p=n(r(325));function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v={"resource.delete":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=e.onOk,u=e.k8sVersion,o=void 0===u?"":u,d=(0,c.default)(e,["store","detail","success","onOk","k8sVersion"]),p=i.default.open(h({onOk:function(){if(l)return null==l?void 0:l().then((function(){i.default.close(p),n&&n()}));a.delete(r,o).then((function(){i.default.close(p),s.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n()}))},store:a,modal:f.default,resource:r.name},d))}},"resource.batch.delete":{on:function(e){var a,r=e.store,n=e.success,o=e.rowKey,d=e.once,m=e.k8sVersion,v=void 0===m?"":m,E=(0,c.default)(e,["store","success","rowKey","once","k8sVersion"]),y=new p.default,g=r.list,b=g.data,S=g.selectedRowKeys,_=b.filter((function(e){return S.includes(e[o])})).map((function(e){return{name:e.name,namespace:e.namespace}})),O=_.map((function(e){return e.name})),C=i.default.open(h({onOk:(a=(0,u.default)(l.default.mark((function e(){var a,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=6;break}return a=b.filter((function(e){return _.find((function(t){return t.name===e.name&&t.namespace===e.namespace}))})),e.next=4,r.batchDelete(h({selectedItems:a},E));case 4:e.next=10;break;case 6:return u=[],b.forEach((function(e){_.find((function(t){return t.name===e.name&&t.namespace===e.namespace}))&&(u.push(r.delete(e,v)),"statefulsets"===r.module&&u.push(y.delete(h(h({},e),{},{name:e.spec.serviceName}))))})),e.next=10,Promise.all(u);case 10:i.default.close(C),s.default.success({content:t("DELETED_SUCCESSFULLY")}),r.setSelectRowKeys([]),n&&n();case 14:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),resource:O.join(", "),modal:f.default,store:r},E))}},"resource.batch.stop":{on:function(e){var a,r=e.store,n=e.success,o=e.rowKey,f=(0,c.default)(e,["store","success","rowKey"]),p=r.list,m=p.data,v=p.selectedRowKeys,E=m.filter((function(e){return v.includes(e[o])})).map((function(e){return{name:e.name,namespace:e.namespace}})),y=E.map((function(e){return e.name})),g=i.default.open(h({onOk:(a=(0,u.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],m.forEach((function(e){E.find((function(t){return t.name===e.name&&t.namespace===e.namespace}))&&a.push(r.stop(e))})),e.next=4,Promise.all(a);case 4:i.default.close(g),s.default.success({content:"".concat(t("STOP_SUCCESS_DESC"))}),r.setSelectRowKeys([]),n&&n();case 8:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),resource:y.join(", "),modal:d.default,store:r},f))}}};a.default=v},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(30),r(11),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798)),m=n(r(2962));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).state={confirm:""},e.handleInputChange=function(t){e.setState({confirm:t.target.value})},e.handleOk=function(){e.props.onOk()},e}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({confirm:""})}},{key:"render",value:function(){var e=this.props,a=e.app,r=e.type,n=e.resource,l=e.visible,u=e.onCancel,o=e.title,c=e.desc,s=e.isSubmitting,f=r||void 0,h=r?"".concat(r,"_LOW"):void 0,v=r?"".concat(r,"_PL"):void 0,E=c||(n&&r?1===n.split(", ").length?t.html("DELETE_RESOURCE_TYPE_DESC_SI",{type:t(h),resource:n}):t.html("DELETE_RESOURCE_TYPE_DESC_PL",{type:t(h),resource:n}):t.html("STOP_DESC",{resource:n,type:""}));return a&&(E=t.html("STOP_APP_RESOURCE_TIP",{type:r,resource:n,app:a})),i.default.createElement(p.default,{width:504,bodyClassName:m.default.modalBody,visible:l,isSubmitting:s,onCancel:u,hideHeader:!0,hideFooter:!0},i.default.createElement("div",{className:m.default.body},i.default.createElement("div",{className:"h5"},i.default.createElement(d.Icon,{name:"close",type:"light",className:m.default.closeIcon}),o||(n&&r?1===n.split(", ").length?t("STOP_TITLE_SI",{type:t(f)}):t("STOP_TITLE_PL",{type:t(v)}):t("STOP"))),i.default.createElement("div",{className:m.default.content},i.default.createElement("p",null,E),n&&i.default.createElement(d.Input,{name:"confirm",value:this.state.confirm,onChange:this.handleInputChange,placeholder:n,autoFocus:!0}))),i.default.createElement("div",{className:m.default.footer},i.default.createElement(d.Button,{onClick:u,"data-test":"modal-cancel"},t("CANCEL")),i.default.createElement(d.Button,{type:"danger",loading:s,disabled:s||!!n&&this.state.confirm!==n,onClick:this.handleOk,"data-test":"modal-ok"},t("OK"))))}}]),r}(i.default.Component);a.default=v,v.propTypes={type:f.default.string,resource:f.default.string,visible:f.default.bool,title:f.default.oneOfType([f.default.string,f.default.node]),desc:f.default.oneOfType([f.default.string,f.default.node]),onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},v.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={modalBody:"V3WE_gCdFFccI6xtK2Ggx",body:"_1zlECIP6AUyOgycNLNcLO0",content:"YrlO8vrb3S-LDnaRDeIJM",closeIcon:"_2Rw7-E0IzpRuCWq8Nbr_QQ",footer:"_1xi-T9pvoKbF80RaXo2H7X"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(68)),f=n(r(191)),d=n(r(798)),p=n(r(1177)),m=n(r(2964)),h=n(r(978));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={"resource.baseinfo.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=e.k8sVersion,u=void 0===l?"":l,o=(0,c.default)(e,["store","detail","success","k8sVersion"]),i=(0,s.default)(a,"module",""),m=d.default.open(E({onOk:function(e){var l="workspace"===i?null:e;"workspaces"===(0,s.default)(a,"module","")&&(l=[{op:"add",path:"/metadata/annotations",value:(0,s.default)(e,"metadata.annotations")},{op:"add",path:"/spec",value:(0,s.default)(e,"spec")}]);a.patch(r,l,u).then((function(){d.default.close(m),f.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},detail:r,modal:p.default,store:a},o))}},"resource.annotations.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=d.default.open(E({onOk:function(e){a.update(r,e).then((function(){d.default.close(u),f.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},detail:r,modal:m.default,store:a},l))}},"resource.yaml.edit":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,s=e.k8sVersion,p=void 0===s?"":s,m=(0,c.default)(e,["store","detail","success","k8sVersion"]),v=d.default.open(E({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isScheduleProject){e.next=9;break}return(0,i.default)(a[0],"metadata.resourceVersion",n.resourceVersion),e.next=5,r.update(n,a[0],p);case 5:return e.next=7,r.updateScheduleYaml(n,a[1],p);case 7:e.next=12;break;case 9:return(0,i.default)(a,"metadata.resourceVersion",n.resourceVersion),e.next=12,r.update(n,a,p);case 12:f.default.success({content:t("UPDATE_SUCCESSFUL")}),d.default.close(v),o&&o();case 15:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),detail:n,store:r,modal:h.default,k8sVersion:p},m))}}};a.default=y},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(17),v=r(243),E=n(r(67)),y=n(r(163)),g=n(r(831)),b=r(189),S=n(r(798)),_=n(r(829)),O=r(56);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var T=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=C(r);function r(e){var n;return(0,c.default)(this,r),(n=a.call(this,e)).annotationValidator=function(e,a,r){return(0,y.default)(a)||(0,E.default)(a)?r():(0,O.isValidAnnotation)(a)?void r():r({message:t("ANNOTATION_FORMAT_DESC")})},n.handleOk=function(e){n.props.onOk(e)},n.state={formData:(0,g.default)((0,h.toJS)(e.detail._originData||e.detail))},n}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,g.default)((0,h.toJS)(this.props.detail._originData||this.props.detail))})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting;return p.default.createElement(S.default.Form,{title:t("EDIT_ANNOTATIONS"),icon:"pen",visible:a,width:960,data:this.state.formData,onOk:this.handleOk,onCancel:r,isSubmitting:n},p.default.createElement(b.Form.Item,{rules:[{validator:this.annotationValidator}]},p.default.createElement(_.default,{name:"metadata.annotations",hiddenKeys:globals.config.preservedAnnotations,addText:t("ADD")})))}}]),r}(p.default.Component),u.propTypes={detail:m.default.object,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool},u.defaultProps={detail:{},isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=T},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(138),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(138),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(68)),c=n(r(119)),s=n(r(191)),i=n(r(798)),f=n(r(2966)),d=n(r(1477)),p=n(r(2969)),m=n(r(438));function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E={"role.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.workspace,o=e.success,c=e.devops,d=(0,u.default)(e,["store","cluster","namespace","workspace","success","devops"]),p=a.module,h=i.default.open(v({onOk:function(e){e?(c&&(e.metadata.namespace=c),a.create(e,{cluster:r,namespace:n,workspace:l,devops:c}).then((function(){i.default.close(h),s.default.success({content:t("CREATE_SUCCESSFUL")}),o&&o()}))):i.default.close(h)},modal:f.default,store:a,module:p,cluster:r,namespace:n,workspace:l,formTemplate:m.default[p]({namespace:n})},d))}},"role.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,u.default)(e,["store","detail","success"]),f=a.module,p=Object.assign(m.default[f]({namespace:l.namespace}),(0,c.default)(r._originData));(0,o.default)(p,"metadata.resourceVersion",r.resourceVersion);var h=i.default.open(v({onOk:function(e){var l;e?(delete p.roleTemplates,(null==p||null===(l=p.metadata)||void 0===l?void 0:l.annotations)&&delete p.metadata.annotations["iam.kubesphere.io/rego-override"],(0,o.default)(p,"aggregationRoleTemplates.templateNames",e),a.update(r,p).then((function(){i.default.close(h),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))):i.default.close(h)},modal:d.default,store:a,module:f,edit:!0,formTemplate:p},l))}},"role.delete":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,u.default)(e,["store","detail","success"]),o=i.default.open(v({onOk:function(){a.delete(r).then((function(){i.default.close(o),s.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n()}))},modal:p.default,module:a.module,detail:r,store:a},l))}}};a.default=E},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(58)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(26)),h=n(r(68)),v=n(r(0)),E=r(243),y=n(r(1)),g=r(189),b=n(r(798)),S=n(r(1477)),_=r(61);function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var C=(0,E.observer)((o=u=function(e){(0,f.default)(r,e);var a=O(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).state={showEditAuthorization:!1},e.showEditAuthorization=function(){e.setState({showEditAuthorization:!0})},e.hideEditAuthorization=function(){e.setState({showEditAuthorization:!1})},e.handleCreate=function(t){var a=e.props.basicRoleTemplates,r=a?a.map((function(e){return e.name})):[];(0,h.default)(e.props.formTemplate,"aggregationRoleTemplates.templateNames",[].concat((0,c.default)(t),(0,c.default)(r))),e.props.onOk(e.props.formTemplate)},e.roleNameValidator=function(a,r,n){if(!r)return n();var l=e.props,u=l.workspace,o=l.cluster,c=l.namespace,s=(0,m.default)(e.props.formTemplate,"metadata.name");if(e.props.edit&&s===r)return n();e.props.store.checkName({name:r,workspace:u,cluster:o,namespace:c}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e}return(0,i.default)(r,[{key:"render",value:function(){var e=this.props,a=e.title,r=e.visible,n=e.module,l=e.onCancel,u=e.formTemplate,o=e.roleTemplates,c=e.isSubmitting,s=e.roleModules,i=this.state.showEditAuthorization,f="workspaceroles"===n;return i?v.default.createElement(S.default,{module:n,visible:i,roleModules:s,formTemplate:u,roleTemplates:o,onOk:this.handleCreate,onCancel:this.hideEditAuthorization,isSubmitting:c}):v.default.createElement(b.default.Form,{width:600,title:a||t("CREATE_ROLE"),icon:"role",data:u,onCancel:l,onOk:this.showEditAuthorization,okText:t("EDIT_PERMISSIONS"),visible:r},v.default.createElement(g.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),tip:f?t("WORKSPACE_ROLE_NAME_TIP"):null,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:_.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.roleNameValidator}]},v.default.createElement(g.Input,{name:"metadata.name",maxLength:63})),v.default.createElement(g.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_DESC")},v.default.createElement(g.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),v.default.createElement(g.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},v.default.createElement(g.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})),v.default.createElement(g.Alert,{className:"margin-t12",title:t("NEXT_STEP"),message:t("NEXT_STEP_DESC")}))}}]),r}(v.default.Component),u.propTypes={store:y.default.object,module:y.default.string,roleTemplates:y.default.array,formTemplate:y.default.object,title:y.default.string,visible:y.default.bool,onOk:y.default.func,onCancel:y.default.func,isSubmitting:y.default.bool,roleModules:y.default.array},u.defaultProps={visible:!1,isSubmitting:!1,module:"roles",onOk:function(){},onCancel:function(){}},l=o))||l;a.default=C},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(10),r(6),r(70),r(66),r(20),r(14),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(6),r(70),r(66),r(20),r(27),r(29),r(14),r(4),r(18),r(43),r(11),r(73),r(7);var u=l(r(58)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(26)),m=l(r(67)),h=r(189),v=l(r(191)),E=l(r(800)),y=r(56),g=l(r(1478));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=function(e){(0,s.default)(r,e);var a=b(r);function r(){var e;(0,o.default)(this,r);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(e=a.call.apply(a,[this].concat(l))).getName=function(t){return(0,p.default)(t,"_originData.spec.displayName[".concat(e.lang,"]"))||(0,p.default)(t,"_originData.spec.displayName.en")},e.getDesc=function(t){return(0,p.default)(t,"_originData.spec.description[".concat(e.lang,"]"))||(0,p.default)(t,"_originData.spec.description.en")},e.handleCheck=function(){var a=e.props,r=a.roleTemplates,n=a.roleTemplatesMap,l=a.data,o=a.onChange,c=(0,u.default)(r);if(c.includes(l.name)){var s=c.filter((function(t){return t!==l.name&&e.getDependencies([t]).includes(l.name)}));0===s.length?c=c.filter((function(e){return e!==l.name})):v.default.warning(t("DESELECT_RESOURCE_FIRST",{resource:s.map((function(t){return e.getName(n[t])})).join("/")}))}else c.push(l.name);o([].concat((0,u.default)(c),(0,u.default)(e.getDependencies(c))))},e.getDependencies=function(t){var a=e.props.roleTemplatesMap,r=[];return(0,m.default)(t)||(t.forEach((function(e){var n=a[e];n&&n.dependencies&&n.dependencies.forEach((function(e){t.includes(e)||r.includes(e)||r.push(e)}))})),r.length>0&&r.push.apply(r,(0,u.default)(e.getDependencies(r)))),r},e}return(0,c.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.roleTemplates,n=a.roleTemplatesMap,l=a.data,u=l.dependencies.length>0?l.dependencies.map((function(t){return e.getName(n[t])})).filter((function(e){return void 0!==e})):[];return d.default.createElement("div",{className:g.default.checkItem},d.default.createElement(h.Checkbox,{checked:r.includes(l.name),onClick:this.handleCheck}),d.default.createElement(E.default,{title:this.getName(l),onClick:this.handleCheck,description:this.getDesc(l)}),u.length>0&&d.default.createElement("div",{className:g.default.extra},t("DEPENDS_ON"),u.map((function(e){return d.default.createElement(h.Tag,{className:g.default.tag,type:"info",key:e},e)}))))}},{key:"lang",get:function(){return(0,p.default)(globals.user,"lang")||(0,y.getBrowserLang)()}}]),r}(d.Component);a.default=S},function(e,t,a){"use strict";a(16),Object.defineProperty(t,"__esModule",{value:!0}),t.ROLE_MODULES_ICON=t.ROLE_MODULES=void 0;var r={globalroles:[{name:"Clusters Management",icon:"cluster"},{name:"Access Control",icon:"key"},{name:"Apps Management",icon:"openpitrix",hide:!globals.app.enableAppStore},{name:"Platform Settings",icon:"cogwheel"}],workspaceroles:[{name:"Projects Management",icon:"project"},{name:"DevOps Management",icon:"strategy-group",hide:!globals.app.hasKSModule("devops")},{name:"Apps Management",icon:"appcenter",hide:!globals.app.hasKSModule("openpitrix")},{name:"Access Control",icon:"key"},{name:"Workspace Settings",icon:"cogwheel"}],roles:[{name:"Application Workloads",icon:"appcenter"},{name:"Storage Management",icon:"storage"},{name:"Configuration Center",icon:"hammer"},{name:"Monitoring & Alerting",icon:"monitor"},{name:"Access Control",icon:"human"},{name:"Project Settings",icon:"project"}],devopsroles:[{name:"Pipelines Management",icon:"application"},{name:"Continuous Deployments Management",icon:"rocket"},{name:"Code Repositories Management",icon:"code"},{name:"Credentials Management",icon:"key"},{name:"Access Control",icon:"human"},{name:"DevOps Settings",icon:"strategy-group"}],clusterroles:[{name:"Cluster Resources Management",icon:"nodes"},{name:"Project Resources Management",icon:"project"},{name:"Network Management",icon:"earth"},{name:"Storage Management",icon:"database"},{name:"Monitoring & Alerting",icon:"monitor"},{name:"Access Control",icon:"human"},{name:"Cluster Settings",icon:"cluster"}]};t.ROLE_MODULES=r;t.ROLE_MODULES_ICON={"cluster-management":"cluster","access-control":"key","apps-management":"openpitrix","platforms-settings":"cogwheel","projects-management":"project","devOps-management":"strategy-group","workspace-settings":"cogwheel","Application Workloads":"appcenter","storage-management":"storage","configuration-center":"hammer","project-settings":"project"}},function(e,a,r){"use strict";r(16);var n=r(19);r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(21),r(18),r(43),r(11);var l=n(r(38)),u=n(r(31));r(35);var o,c,s,i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),E=n(r(1)),y=r(243),g=n(r(67)),b=n(r(798)),S=n(r(323)),_=n(r(1479)),O=r(61),C=n(r(2973));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var R=(0,y.observer)((s=c=function(e){(0,p.default)(n,e);var a,r=T(n);function n(e){var t;return(0,f.default)(this,n),(t=r.call(this,e)).state={users:[],groups:{},isLoading:!1},t.store=new S.default,t.groupStore=new _.default,t}return(0,d.default)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.visible,a=e.detail;t&&a.name&&this.fetchData()}},{key:"fetchData",value:(a=(0,i.default)(l.default.mark((function e(){var t,a,r,n,o,c,s,i,f;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props,r=a.module,n=a.detail.name,o=a.cluster,c=a.workspace,s=a.namespace,this.setState({isLoading:!0}),e.next=4,this.store.fetchList((t={},(0,u.default)(t,O.ROLE_QUERY_KEY[r],n),(0,u.default)(t,"cluster",o),(0,u.default)(t,"workspace",c),(0,u.default)(t,"namespace",s),(0,u.default)(t,"limit",-1),t));case 4:if(i=e.sent,!(0,g.default)(i)||!c){e.next=10;break}return e.next=8,this.groupStore.getWorkspaceRoleBinding("",{cluster:o,workspace:c,namespace:s,rolename:n});case 8:f=e.sent,this.setState({groups:f});case 10:this.setState({users:i,isLoading:!1});case 11:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.visible,n=e.onOk,l=e.onCancel,u=e.isSubmitting,o=this.state,c=o.users,s=o.groups,i=o.isLoading;return v.default.createElement(b.default,{width:504,onOk:i||c.length||s.totalItems?null:n,onCancel:l,visible:r,isSubmitting:u,okButtonType:"danger",hideHeader:!0},v.default.createElement("div",{className:C.default.body},v.default.createElement("div",{className:"h5"},t("DELETE_ROLE")),v.default.createElement("p",null,!i&&c.length?t.html("DELETE_ROLE_USER_TIP".concat(1===c.length?"":"_PL"),{count:c.length}):s.totalItems?t.html("DELETE_ROLE_DEPARTMENT_TIP".concat(1===s.totalItems?"":"_PL"),{count:s.totalItems}):t.html("DELETE_ROLE_TIP",{resource:a.name}))))}}]),n}(v.default.Component),c.propTypes={detail:E.default.object,module:E.default.string,visible:E.default.bool,onOk:E.default.func,onCancel:E.default.func,isSubmitting:E.default.bool},c.defaultProps={detail:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},o=s))||o;a.default=R},,,,function(e,t,a){e.exports={body:"_2OPaWn_o79qbwztkINRFGV"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(202),r(36),r(20),r(14),r(8),r(13),r(9),r(4),r(190),r(328),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(202),r(36),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(190),r(21),r(328),r(46),r(469),r(470),r(471),r(472),r(473),r(474),r(475),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(68)),f=n(r(196)),d=n(r(64)),p=n(r(191)),m=n(r(798)),h=n(r(819)),v=n(r(2975)),E=n(r(2976)),y=n(r(2978)),g=n(r(2980)),b=r(61),S=n(r(438)),_=n(r(864)),O=n(r(1323));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R={"router.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.module,u=e.success,d=e.isFederated,v=(0,c.default)(e,["store","cluster","namespace","module","success","isFederated"]),E=b.MODULE_KIND_MAP[l],y=(0,o.default)({},E,S.default[l]({namespace:n}));d&&Object.keys(y).forEach((function(e){y[e]=S.default.federated({data:y[e],clusters:v.projectDetail.clusters.map((function(e){return e.name})),kind:e})}));var g=m.default.open(T({onOk:function(e){var o=(0,s.default)(e,E);if(e){var c={cluster:r,namespace:n};if(c.namespace=c.namespace||(0,s.default)(o,"metadata.namespace"),d){var h=(0,s.default)(o,"spec.ingressClassName"),v=(0,s.default)(o,"spec.overrides"),y=[],b={clusters:[]};v.forEach((function(e){0!==(0,s.default)(e,"clusterOverrides[0].value",[]).length&&(b.clusters.push({name:e.clusterName}),y.push(e))})),(0,f.default)(o,"spec.ingressClassName"),(0,i.default)(o,"spec.template.spec.ingressClassName",h),(0,i.default)(o,"spec.overrides",y),(0,i.default)(o,"spec.placement",b)}a.create(o,c).then((function(){m.default.close(g),p.default.success({content:t("CREATE_SUCCESSFUL")}),u&&u(),_.default.delete("".concat(l,"_create_form"))}))}},module:l,cluster:r,namespace:n,name:"Route",formTemplate:y,isFederated:d,steps:O.default,modal:h.default,store:a},v))}},"router.rules.edit":{on:function(e){var a=e.store,r=e.namespace,n=e.detail,l=e.success,u=(0,c.default)(e,["store","namespace","detail","success"]),o=m.default.open(T({onOk:function(e){a.update(n,e).then((function(){m.default.close(o),p.default.success({content:t("UPDATE_SUCCESSFUL")}),l&&l()}))},modal:y.default,detail:n,cluster:n.cluster,store:a,namespace:r},u))}},"fedproject.router.rules.edit":{on:function(e){var a=e.store,r=e.namespace,n=e.detail,l=e.success,u=(0,c.default)(e,["store","namespace","detail","success"]),o=m.default.open(T({onOk:function(e){var r=(0,s.default)(e,"spec.template",{}),u=new Set;Object.values(r.spec).forEach((function(e){(0,d.default)(e)&&(null==e||e.forEach((function(e){var t;return null===(t=e.clusters)||void 0===t?void 0:t.forEach((function(e){return u.add(e)}))})))}));var c=Array.from(u).map((function(e){return{name:e}}));(0,i.default)(e,"spec.placement.clusters",c),a.update(n,e).then((function(){m.default.close(o),p.default.success({content:t("UPDATE_SUCCESSFUL")}),l&&l()}))},modal:g.default,detail:n,cluster:n.cluster,namespace:r,store:a},u))}},"router.annotations.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=m.default.open(T({onOk:function(e){a.update(r,e).then((function(){m.default.close(u),p.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},modal:E.default,detail:r,store:a},l))}},"router.setting.create":{on:function(e){return(0,u.default)(l.default.mark((function a(){var r,n,o,s,i,f,d;return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=e.store,e.detail,n=e.module,o=e.success,s=e.cluster,i=(0,c.default)(e,["store","detail","module","success","cluster"]),f=S.default[n](),d=m.default.open(T({onOk:function(){var e=(0,u.default)(l.default.mark((function e(a){var n;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={cluster:s},r.create(a,n).then((function(){m.default.close(d),p.default.success({content:t("CREATE_SUCCESSFUL")}),o&&o()}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),title:t("CREATE_DOMAIN_NAME"),modal:v.default,formTemplate:f,cluster:s,store:r},i));case 3:case"end":return a.stop()}}),a)})))()}},"router.setting.edit":{on:function(e){return(0,u.default)(l.default.mark((function a(){var r,n,o,s,i,f,d,h;return l.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=e.store,n=e.detail,o=e.module,s=e.success,i=e.cluster,f=(0,c.default)(e,["store","detail","module","success","cluster"]),d=S.default[o],h=m.default.open(T({onOk:function(){var e=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.patch(n,a).then((function(){m.default.close(h),p.default.success({content:t("MODIFY_SUCCESSFUL")}),s&&s()}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),title:t("EDIT"),modal:v.default,formTemplate:d,cluster:i,store:r,detail:n},f));case 3:case"end":return a.stop()}}),a)})))()}}};a.default=R},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=n(r(26)),p=n(r(831)),m=r(17),h=r(189),v=n(r(798)),E=r(61);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var g=function(e){(0,o.default)(r,e);var a=y(r);function r(e){var n;return(0,l.default)(this,r),(n=a.call(this,e)).nameValidator=function(e,a,r){var l=n.props.isEdit;if(!a||l)return r();var u=n.props.cluster||(0,d.default)(n.props.formTemplate,"cluster");n.props.store.checkName({cluster:u},{name:a}).then((function(a){if(a.exist)return r({message:t("NAME_EXIST_DESC"),field:e.field});r()}))},n.domainValidator=function(e,a,r){var l=n.props.isEdit;if(!a||l)return r();var u=n.props.cluster||(0,d.default)(n.props.formTemplate,"cluster");n.props.store.checkName({cluster:u},{fieldSelector:"spec.uniqueDomainPattern=".concat(a)}).then((function(a){if(a.exist)return r({message:t("INVALID_CREATE_DOMAIN_NAME"),field:e.field});r()}))},n.handleOk=function(e){var t=n.props,a=t.onOk,r=t.store,l=t.detail,u=r.list,o=(0,m.toJS)(u.selectedRowKeys),c=o?o.filter((function(e){return e!==l.uid})):"";a(e),o&&u.setSelectRowKeys(c)},n.state={formData:e.isEdit?(0,p.default)((0,m.toJS)(e.detail._originData||e.detail)):e.formTemplate},n}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=e.isEdit,u=this.state.formData;return i.default.createElement(v.default.Form,{data:u,width:691,title:this.props.title,onOk:this.handleOk,okText:t("OK"),onCancel:n,visible:a,isSubmitting:r},i.default.createElement(h.Form.Item,{label:t("NAME"),desc:l?"":t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:E.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("NAME_DESC")})},{validator:this.nameValidator}]},i.default.createElement(h.Input,{name:"metadata.name",maxLength:63,disabled:l})),i.default.createElement(h.Form.Item,{label:t("DOMAIN_NAME_TCAP"),desc:l?"":t("CREATE_DOMAIN_NAME_DES"),rules:[{required:!0,message:t("DOMAIN_NAME_EMPTY_DESC")},{pattern:E.PATTERN_HOST,message:t("INVALID_DOMAIN_DESC")},{validator:this.domainValidator}]},i.default.createElement(h.Input,{name:"spec.uniqueDomainPattern",maxLength:63,disabled:l})),i.default.createElement(h.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},i.default.createElement(h.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))}}]),r}(i.default.Component);a.default=g,g.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},g.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(17),v=r(243),E=r(189),y=n(r(798)),g=n(r(956)),b=n(r(2977));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var _=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=S(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleOk=function(e){var a=t.props,r=a.onOk,n=a.store,l=a.detail,u=n.list,o=(0,h.toJS)(u.selectedRowKeys).filter((function(e){return e!==l.uid}));r(e),u.setSelectRowKeys(o)},t.state={formTemplate:(0,h.toJS)(e.detail._originData)},t}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){(0,h.toJS)(this.props.detail._originData)!==e.detail._originData&&this.setState({formTemplate:(0,h.toJS)(this.props.detail._originData)})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting;return p.default.createElement(y.default.Form,{title:t("EDIT_ANNOTATIONS"),icon:"firewall",visible:a,width:960,data:this.state.formTemplate,onOk:this.handleOk,onCancel:r,isSubmitting:n},p.default.createElement("div",{className:b.default.wrapper},p.default.createElement("div",{className:b.default.formWrapper},p.default.createElement(E.Form.Item,null,p.default.createElement(g.default,{name:"metadata.annotations",hiddenKeys:globals.config.preservedAnnotations,addText:t("ADD")})))))}}]),r}(p.default.Component),u.propTypes={detail:m.default.object,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool},u.defaultProps={detail:{},isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=_},function(e,t,a){e.exports={wrapper:"_1Krvo8pJnzz9dd6tFsz7bY",formWrapper:"_313r2ZWWe5GzJhGz_CNWWG"}},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(44),r(6),r(70),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(44),r(6),r(70),r(29),r(4),r(18),r(43),r(11),r(73),r(7);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(26)),m=n(r(119)),h=n(r(67)),v=n(r(798)),E=n(r(1127)),y=n(r(2979));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var b=function(e){(0,o.default)(r,e);var a=g(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleOk=function(){var e=t.state.subRoute;if(e.onSave)return e.onSave((function(){t.setState({subRoute:{}})}));var a=t.props,r=a.onOk,n=a.store,l=a.detail,u=t.state.formTemplate.Ingress,o=n.list,c=(0,d.toJS)(o.selectedRowKeys).filter((function(e){return e!==l.uid}));r(u),o.setSelectRowKeys(c)},t.handleCancel=function(){var e=t.state.subRoute;if(e.onCancel)return e.onCancel(),void t.setState({subRoute:{}});(0,t.props.onCancel)()},t.form=i.default.createRef(),t.state={subRoute:{},formTemplate:t.getFormTemplate((0,d.toJS)(e.detail._originData))},t}return(0,u.default)(r,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}}]),(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){(0,d.toJS)(this.props.detail._originData)!==e.detail._originData&&this.setState({formTemplate:this.getFormTemplate((0,d.toJS)(this.props.detail._originData))})}},{key:"getFormTemplate",value:function(e){var t=(0,m.default)(e),a=(0,p.default)(t,"spec.tls",[]),r=(0,p.default)(t,"spec.rules",[]);return a.length>0&&r.length>0&&r.forEach((function(e){var t=a.find((function(t){return t.hosts&&t.hosts.includes(e.host)}));t?(e.protocol="https",e.secretName=t.secretName):e.protocol="http"})),{Ingress:t}}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.cluster,n=e.isSubmitting,l=e.namespace,u=this.state,o=u.subRoute,c=u.formTemplate;return i.default.createElement(v.default,{width:960,title:t("EDIT_ROUTING_RULES"),icon:"firewall",onOk:this.handleOk,okText:t("OK"),cancelText:(0,h.default)(o)?null:t("PREVIOUS"),onCancel:this.handleCancel,visible:a,isSubmitting:n},i.default.createElement("div",{className:y.default.wrapper},i.default.createElement(E.default,{module:"ingresses",formRef:this.form,formTemplate:c,cluster:r,namespace:l})))}}]),r}(i.default.Component);b.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},b.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1},b.childContextTypes={registerSubRoute:f.default.func,resetSubRoute:f.default.func};var S=b;a.default=S},function(e,t,a){e.exports={wrapper:"_2wf3cNZWhIeqht7bbNiU00"}},function(e,a,r){"use strict";r(16);var n=r(19);r(44),r(6),r(70),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(44),r(6),r(70),r(29),r(4),r(18),r(43),r(11),r(73),r(7);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(26)),m=n(r(119)),h=n(r(67)),v=n(r(811)),E=n(r(798)),y=n(r(1127)),g=n(r(2981));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var S=function(e){(0,o.default)(r,e);var a=b(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleOk=function(){var e=t.state.subRoute;if(e.onSave)return e.onSave((function(){t.setState({subRoute:{}})}));(0,t.props.onOk)(t.state.formTemplate.Ingress)},t.handleCancel=function(){var e=t.state.subRoute;if(e.onCancel){var a=e.onCancel();if(!a)return;return a(),void t.setState({subRoute:{}})}(0,t.props.onCancel)()},t.formRef=i.default.createRef(),t.state={subRoute:{},formTemplate:t.getFormTemplate((0,d.toJS)(e.detail._originData))},t}return(0,u.default)(r,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}}]),(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){(0,v.default)((0,d.toJS)(this.props.detail._originData),(0,d.toJS)(e.detail._originData))||this.setState({formTemplate:this.getFormTemplate((0,d.toJS)(this.props.detail._originData))})}},{key:"getFormTemplate",value:function(e){var t=(0,m.default)(e),a=(0,p.default)(t,"spec.tls",[]),r=(0,p.default)(t,"spec.rules",[]);return a.length>0&&r.length>0&&r.forEach((function(e){var t=a.find((function(t){return t.hosts&&t.hosts.includes(e.host)}));t?(e.protocol="https",e.secretName=t.secretName):e.protocol="http"})),{Ingress:t}}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.cluster,n=e.isSubmitting,l=e.isFederated,u=e.projectDetail,o=e.detail,c=this.state,s=c.subRoute,f=c.formTemplate;return i.default.createElement(E.default,{width:960,title:t("EDIT_ROUTING_RULES"),icon:"firewall",onOk:this.handleOk,okText:t("OK"),cancelText:(0,h.default)(s)?null:t("PREVIOUS"),onCancel:this.handleCancel,visible:a,isSubmitting:n},i.default.createElement("div",{className:g.default.wrapper},i.default.createElement(y.default,{module:"ingresses",formRef:this.formRef,formTemplate:f,cluster:r,detail:o,isFederated:l,projectDetail:u})))}}]),r}(i.default.Component);S.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},S.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1},S.childContextTypes={registerSubRoute:f.default.func,resetSubRoute:f.default.func};var _=S;a.default=_},function(e,t,a){e.exports={wrapper:"_2SvyqGEvoXG9IXqxRtZsU7"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(20),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(44),r(6),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(244)),f=n(r(68)),d=n(r(140)),p=n(r(191)),m=n(r(798)),h=n(r(819)),v=n(r(2983)),E=r(61),y=n(r(438)),g=n(r(864)),b=n(r(2992)),S=n(r(2993));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var C={"secret.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,i=e.module,f=e.isFederated,v=e.success,S=(e.prevDefault,(0,c.default)(e,["store","cluster","namespace","module","isFederated","success","prevDefault"])),_=E.MODULE_KIND_MAP[i],C=(0,o.default)({},_,y.default[i]({namespace:n}));f&&Object.keys(C).forEach((function(e){C[e]=y.default.federated({data:C[e],clusters:S.projectDetail.clusters.map((function(e){return e.name})),kind:e})}));var T,R=m.default.open(O({onOk:(T=(0,u.default)(l.default.mark((function e(u){var o,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(0,s.default)(u,_),c=(0,d.default)(o,"spec")){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,D(a,c,{cluster:r,namespace:n||(0,s.default)(c,"metadata.namespace")});case 6:a.create(c,{cluster:r,namespace:n||(0,s.default)(c,"metadata.namespace")}).then((function(){m.default.close(R),p.default.success({content:t("CREATE_SUCCESSFUL")}),v&&v(c),g.default.delete("".concat(i,"_create_form"))}));case 7:case"end":return e.stop()}}),e)}))),function(e){return T.apply(this,arguments)}),module:i,cluster:r,namespace:n,name:_,isFederated:f,formTemplate:C,steps:b.default,modal:h.default,store:a},S))}},"secret.edit":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,s=(0,c.default)(e,["store","detail","success"]),i=m.default.open(O({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,f.default)(a,"metadata.resourceVersion",n.resourceVersion),s.isFederated&&((0,f.default)(a,"apiVersion",r.version),(0,f.default)(a,"kind",r.secretKind)),e.next=4,D(r,a,{cluster:n.cluster,namespace:n.namespace});case 4:r.update(n,a).then((function(){m.default.close(i),p.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o()}));case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:n,modal:v.default,disableSelect:!0},s))}},"secret.default":{on:function(e){var a,r=e.store,n=e.detail,o=e.cluster,s=e.success,i=(0,c.default)(e,["store","detail","cluster","success"]),f=m.default.open(O({onOk:(a=(0,u.default)(l.default.mark((function e(){var a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(r,{cluster:o,namespace:n.namespace});case 2:return a=e.sent,e.next=5,r.setDefault({cluster:o,namespace:n.namespace,name:n.name},{cluster:o,namespace:a.namespace,name:a.name});case 5:m.default.close(f),p.default.success({content:t("SET_DEFAULT_REGISTRY_SUCCESSFUL")}),s&&s();case 8:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),store:r,detail:n,modal:S.default},i))}}};function T(e,t){return R.apply(this,arguments)}function R(){return(R=(0,u.default)(l.default.mark((function e(t,a){var r,n,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.cluster,n=a.namespace,e.next=3,t.fetchList({cluster:r,namespace:n,annotation:"secret.kubesphere.io/is-default-class=true"});case 3:return u=e.sent,e.abrupt("return",(null==u?void 0:u.find((function(e){return e.isDefault})))||{});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,a){return k.apply(this,arguments)}function k(){return(k=(0,u.default)(l.default.mark((function e(t,a,r){var n,u,o;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.cluster,u=r.namespace,e.next=3,T(t,{cluster:n,namespace:u});case 3:if(o=e.sent,"true"!==(0,s.default)(a,'metadata.annotations["secret.kubesphere.io/is-default-class"]')||!o.name||o.name===a.metadata.name){e.next=7;break}return e.next=7,t.patch((0,i.default)(o,["cluster","namespace","name"]),{metadata:{annotations:{"secret.kubesphere.io/is-default-class":"false"}}});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a.default=C},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(1)),p=r(17),m=n(r(67)),h=n(r(798)),v=n(r(840)),E=n(r(1481)),y=n(r(2991));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=function(e){(0,c.default)(r,e);var a=S(r);function r(e){var t;return(0,u.default)(this,r),(t=a.call(this,e)).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleSubFormSave=function(){var e=t.state.subRoute;e&&e.onSave&&e.onSave((function(){t.setState({subRoute:{}})}))},t.handleSubFormCancel=function(){var e=t.state.subRoute;e&&e.onCancel&&(e.onCancel(),t.setState({subRoute:{}}))},t.handleOk=function(){(0,t.props.onOk)(t.state.formTemplate)},t.state={formTemplate:t.getFormTemplate(e.detail),subRoute:{}},t}return(0,o.default)(r,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}}]),(0,o.default)(r,[{key:"getFormTemplate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,p.toJS)(e._originData);return b({},t)}},{key:"renderSaveBar",value:function(){var e=this.state.subRoute;return(0,m.default)(e)?null:f.default.createElement(v.default,{className:y.default.confirm,onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel})}},{key:"render",value:function(){var e=this.state,a=e.subRoute,r=e.formTemplate,n=this.props,l=n.visible,u=n.isSubmitting,o=n.onCancel,c=n.isFederated,s=n.disableSelect,i=n.detail;return f.default.createElement(h.default,{width:960,title:t("EDIT_SETTINGS"),icon:"pen",bodyClassName:y.default.body,onOk:this.handleOk,okText:t("OK"),onCancel:o,visible:l,disableSubmit:!(0,m.default)(a),isSubmitting:u},f.default.createElement(E.default,{formTemplate:r,isFederated:c,cluster:i.cluster,mode:"edit",disableSelect:s}),this.renderSaveBar())}}]),r}(f.default.Component);a.default=_,_.propTypes={detail:d.default.object,visible:d.default.bool,onOk:d.default.func,onCancel:d.default.func,isSubmitting:d.default.bool,disableSelect:d.default.bool},_.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1,disableSelect:!1},_.childContextTypes={registerSubRoute:d.default.func,resetSubRoute:d.default.func}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(99),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(99),r(4),r(18),r(43),r(11);var l=n(r(97)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(140)),p=n(r(828)),m=r(324),h=n(r(2985));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=function(e){(0,c.default)(r,e);var a=v(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).handleDelete=function(t){return function(){var a=e.props,r=a.value;(0,a.onChange)((0,d.default)(r,t))}},e.handleEdit=function(t){return function(){(0,e.props.onEdit)(t)}},e}return(0,o.default)(r,[{key:"renderContent",value:function(){var e=this,a=this.props,r=a.value,n=a.onAdd;return f.default.createElement(p.default,null,Object.entries(r).map((function(t){var a=(0,l.default)(t,2),r=a[0],n=a[1];return f.default.createElement(p.default.Item,{key:r,icon:"key",title:r,description:(0,m.safeAtob)(n)||"-",onDelete:e.handleDelete(r),onEdit:e.handleEdit(r)})})),f.default.createElement(p.default.Add,{title:t("ADD_DATA_TCAP"),description:t("ADD_DATA_DESC"),onClick:n}))}},{key:"render",value:function(){return f.default.createElement("div",{className:h.default.wrapper},this.renderContent())}}]),r}(f.default.Component);a.default=E,E.defaultProps={value:{}}},function(e,t,a){e.exports={wrapper:"-jwoKUpfEA_iKuklHFsVt"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(914)),p=n(r(1)),m=r(189),h=r(848),v=r(324),E=n(r(2987));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=function(e){(0,c.default)(r,e);var a=y(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).formRef=f.default.createRef(),e.state={formData:e.getFormData()},e.registerForm=function(){var t=e.context.registerSubRoute,a=e.props.onCancel;t&&t(e.handleSubmit,a)},e.handleGoBack=function(){var t=e.context.resetSubRoute;t&&t(),e.props.onCancel()},e.handleSubmit=function(t){var a=e.props.onOk,r=e.formRef&&e.formRef.current;r&&r.validate((function(){var e=r.getData(),n=e.key,u=e.value;a((0,l.default)({},(0,d.default)(n),(0,v.safeBtoa)(u))),t&&t()}))},e}return(0,o.default)(r,[{key:"componentDidMount",value:function(){this.registerForm()}},{key:"getFormData",value:function(){var e=this.props,t=e.detail,a=e.selectKey;return{key:a||"",value:(0,v.safeAtob)(t[a]||"")}}},{key:"render",value:function(){var e=this.props,a=e.detail,r=e.selectKey;return f.default.createElement("div",{className:E.default.wrapper},f.default.createElement("div",{className:"h6"},f.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},f.default.createElement(h.ReactComponent,null)),a[r]?t("EDIT_DATA_TCAP"):t("ADD_DATA_TCAP")),f.default.createElement("div",{className:E.default.formWrapper},f.default.createElement(m.Form,{data:this.state.formData,ref:this.formRef},f.default.createElement(m.Form.Item,{label:t("DATA_KEY")},f.default.createElement(m.Input,{name:"key"})),f.default.createElement(m.Form.Item,{label:t("DATA_VALUE")},f.default.createElement(m.TextArea,{name:"value",rows:4,autoResize:!0})))))}}]),r}(f.default.Component);a.default=g,g.defaultProps={detail:{},selectKey:""},g.contextTypes={registerSubRoute:p.default.func,resetSubRoute:p.default.func}},function(e,t,a){e.exports={wrapper:"_1UlfrF0XQcQAvMsWWcTR1w",formWrapper:"_1Nq08DNhRDjFIGATy_iM_m",confirm:"_1BpCYDDpzOGUjDrFZPDMRN"}},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(3),a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(14),a(4),a(18),a(43),a(11);var l=n(a(25)),u=n(a(28)),o=n(a(41)),c=n(a(42)),s=n(a(37)),i=n(a(26)),f=r(a(0)),d=a(324);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).handleChange=function(t){var a=(0,i.default)(t,"target.value",t);return(0,e.props.onChange)((0,d.safeBtoa)(a))},e}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.children,r=e.value;return f.default.cloneElement(a,{name:t,value:(0,d.safeAtob)(r||""),onChange:this.handleChange})}}]),a}(f.Component);t.default=m},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(6),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(111),r(71),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(27),r(98),r(141),r(29),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(111),r(71),r(7);var u=n(r(38));r(35);var o,c=n(r(39)),s=n(r(31)),i=n(r(25)),f=n(r(28)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(808)),v=n(r(26)),E=l(r(0)),y=r(243),g=r(17),b=r(189),S=n(r(1428)),_=r(56),O=r(324),C=n(r(447)),T=n(r(448)),R=n(r(2990)),D=n(r(1482));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var P=(0,y.observer)(o=function(e){(0,d.default)(r,e);var a=I(r);function r(){var e;(0,i.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).getStateFromProps=function(e){var t=(0,_.safeParseJSON)(e),a=Object.keys((0,v.default)(t,"auths",{}))[0]||"";return{url:a,username:(0,v.default)(t,'auths["'.concat(a,'"].username'),""),password:(0,v.default)(t,'auths["'.concat(a,'"].password'),""),email:(0,v.default)(t,'auths["'.concat(a,'"].email'),"")}},e.store=new C.default,e.hostStore=new T.default,e.state=N(N({},e.getStateFromProps(e.props.value)),{},{isValidating:!1,default:!1}),e.triggerChange=(0,h.default)((function(){var t=e.props,a=t.onChange,r=t.onChangeState,n=e.state,l=n.url,u=n.username,o=n.password,c=n.email;e.setState({errorMsg:""}),l&&u&&o&&(a(JSON.stringify({auths:(0,s.default)({},l,{username:u,password:o,email:c,auth:(0,O.safeBtoa)("".concat(u,":").concat(o))})})),r(Math.random()))}),200),e.getHostName=(0,c.default)(u.default.mark((function t(){var a,r,n,l,o=arguments;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},t.next=3,e.hostStore.fetchList(N(N({},n),{},{labelSelector:"cluster-role.kubesphere.io/host=",limit:-1}));case 3:return l=(0,g.toJS)(e.hostStore.list.data).filter((function(e){return Object.keys(e.labels).some((function(e){return e.endsWith("cluster-role.kubesphere.io/host")}))})),t.abrupt("return",null!==(a=null===(r=l[0])||void 0===r?void 0:r.name)&&void 0!==a?a:"host");case 5:case"end":return t.stop()}}),t)}))),e.handleValidate=(0,c.default)(u.default.mark((function t(){var a,r,n,l,o,c,s;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props,r=a.cluster,n=a.isFederated,l=a.namespace,o=a.screatName,c=a.fedFormTemplate,!e.validate()){t.next=23;break}if(e.setState({isValidating:!0}),t.t1=e.store,t.t2=c,t.t3=o,t.t4=l,!n){t.next=13;break}return t.next=10,e.getHostName();case 10:t.t5=t.sent,t.next=14;break;case 13:t.t5=r;case 14:return t.t6=t.t5,t.t7={fedFormTemplate:t.t2,name:t.t3,namespace:t.t4,cluster:t.t6},t.next=18,t.t1.validateImageRegistrySecret.call(t.t1,t.t7);case 18:if(t.t0=t.sent,t.t0){t.next=21;break}t.t0={};case 21:s=t.t0,e.setState({validate:s.validate||!1,reason:s.reason||"",isValidating:!1});case 23:case"end":return t.stop()}}),t)}))),e.handleUrlChange=function(t){e.setState({url:t},e.triggerChange),"http"===t.replace(/^(http(s)?:\/\/)?(.*)$/,"$1").replace("://","")&&e.props.onChangeSkipVerify(!0)},e.handleUserNameChange=function(t){e.setState({username:t.target.value},e.triggerChange)},e.handleEmailChange=function(t){e.setState({email:t.target.value},e.triggerChange)},e.handlePasswordChange=function(t){e.setState({password:t.target.value},e.triggerChange)},e}return(0,f.default)(r,[{key:"validate",value:function(){return!!(this.state.url&&this.state.username&&this.state.password)||(this.setState({errorMsg:t("IMAGE_REGISTRY_REQUIRED_DESC")}),!1)}},{key:"renderTip",value:function(){var e=this.state,a=e.errorMsg,r=e.validate,n=e.reason;return a?E.default.createElement(b.Alert,{className:"margin-t12",type:"error",message:a}):r?E.default.createElement(b.Alert,{type:"info",icon:"success",message:t("REGISTRY_SECRET_VER_SUC")}):n?E.default.createElement(b.Alert,{type:"error",title:t("REGISTRY_SECRET_VER_ERR"),message:n}):E.default.createElement(b.Alert,{type:"info",message:t("IMAGE_REGISTRY_VALIDATE_TIP")})}},{key:"renderDefault",value:function(){var e=this.props,a=e.isDefault,r=e.onChangeDefault;return E.default.createElement("div",{className:D.default.defaultContainer},E.default.createElement(b.Toggle,{checed:a,onChange:r,defaultChecked:a}),E.default.createElement("div",null,E.default.createElement("div",{className:D.default.title},t("SET_AS_DEFAULT")),E.default.createElement("div",{className:D.default.desc},t("SET_AS_DEFAULT_REGISTRY_DESC"))))}},{key:"render",value:function(){var e=this.state,a=e.url,r=e.username,n=e.password,l=e.email,u=e.isValidating,o=this.props,c=o.onChangeSkipVerify,s=o.isSkipVerify;return E.default.createElement("div",null,E.default.createElement("input",{name:"username",className:"hidden-input",type:"text",disabled:!0}),E.default.createElement("input",{name:"password",className:"hidden-input",type:"password",disabled:!0}),E.default.createElement(b.Columns,null,E.default.createElement(b.Column,null,E.default.createElement(R.default,{label:t("REGISTRY_ADDRESS_TCAP"),desc:t("REGISTRY_ADDRESS_TIP"),required:!0},E.default.createElement(S.default,{value:a,onChange:this.handleUrlChange}))),E.default.createElement(b.Column,null,E.default.createElement(R.default,{label:t("USERNAME"),required:!0},E.default.createElement(b.Input,{value:r,onChange:this.handleUserNameChange,autoComplete:"nope"})))),!this.isHttp&&E.default.createElement(b.Columns,null,E.default.createElement(b.Column,{className:D.default.skip_verify},E.default.createElement(b.Checkbox,{checked:s,onChange:c},t("SKIP_VERIFY")))),E.default.createElement(b.Columns,null,E.default.createElement(b.Column,null,E.default.createElement(R.default,{label:t("EMAIL")},E.default.createElement(b.Input,{value:l,onChange:this.handleEmailChange}))),E.default.createElement(b.Column,null,E.default.createElement(R.default,{label:t("PASSWORD"),required:!0},E.default.createElement("div",{className:D.default.password},E.default.createElement(b.InputPassword,{type:"password",value:n,onChange:this.handlePasswordChange,autoComplete:"new-password"}),E.default.createElement(b.Button,{onClick:this.handleValidate,loading:u},t("VALIDATE")))))),this.renderDefault(),E.default.createElement("div",{className:D.default.tip},this.renderTip()))}},{key:"isHttp",get:function(){return"http"===this.state.url.replace(/^(http(s)?:\/\/)?(.*)$/,"$1").replace("://","")}}]),r}(E.Component))||o;a.default=P},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var l=n(a(25)),u=n(a(28)),o=n(a(41)),c=n(a(42)),s=n(a(37)),i=r(a(0)),f=n(a(1482));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var p=function(e){(0,o.default)(a,e);var t=d(a);function a(){return(0,l.default)(this,a),t.apply(this,arguments)}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.label,a=e.desc,r=e.required,n=e.children;return i.default.createElement("div",{className:f.default.wrapper},t&&i.default.createElement("label",{className:f.default.label,htmlFor:name},t,r?i.default.createElement("span",{className:f.default.requiredIcon},"*"):null),i.default.createElement("div",{className:f.default.control},n,a&&i.default.createElement("div",{className:f.default.desc},a)))}}]),a}(i.Component);t.default=p},function(e,t,a){e.exports={body:"ok_C6WKg4I2-lgwUuNM-G",confirm:"_3kOQ-5ctupyU0pPCq4MU3E"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(56),l=r(a(911)),u=r(a(1481)),o=[{title:"BASIC_INFORMATION",component:(0,n.withProps)(l.default,{maxNameLength:63}),required:!0},{title:"DATA_SETTINGS",component:u.default,required:!0}];t.default=o},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798)),m=n(r(2994));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.onOk,l=e.isSubmitting;return i.default.createElement(p.default,{width:520,onOk:n,onCancel:r,visible:a,okText:t("OK"),cancelText:t("CANCEL"),isSubmitting:l,hideHeader:!0},i.default.createElement("div",{className:m.default.body},i.default.createElement("div",{className:"h5"},i.default.createElement(d.Icon,{name:"information",color:{primary:"#ffffff",secondary:"#41b1ea"},size:18}),"  ",t("SET_AS_DEFAULT")),i.default.createElement("p",null,t("SET_AS_DEFAULT_REGISTRY_DESC"))))}}]),r}(i.default.Component);a.default=v,v.propTypes={visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},v.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={body:"twiD94s0MsB7Hfd8Ws7nW"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(70),r(14),r(8),r(13),r(9),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(44),r(6),r(70),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(67)),f=n(r(68)),d=r(17),p=n(r(191)),m=n(r(798)),h=n(r(819)),v=n(r(2996)),E=n(r(2998)),y=n(r(3001)),g=n(r(1380)),b=n(r(3005)),S=r(61),_=r(3007),O=n(r(864)),C=n(r(438)),T=n(r(1136)),R=n(r(1157));function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var N={"service.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.module,u=e.success,o=(0,c.default)(e,["store","cluster","namespace","module","success"]),s=S.MODULE_KIND_MAP[l],i=m.default.open(k({onOk:function(e){var o=e;o&&(s&&1===Object.keys(e).length&&e[s]&&(o=e[s]),a.create(o,{cluster:r,namespace:n}).then((function(){m.default.close(i),p.default.success({content:t("CREATE_SUCCESSFUL")}),u&&u(),O.default.delete("".concat(l,"_create_form"))})))},cluster:r,namespace:n,modal:v.default,store:a},o))}},"service.simple.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=e.module,u=e.success,i=(0,c.default)(e,["store","cluster","namespace","module","success"]),f=S.MODULE_KIND_MAP[l],d=(0,o.default)({},f,C.default[l]({namespace:n})),v=m.default.open(k({onOk:function(e){var o=(0,s.default)(e,f);o&&a.create(o,{cluster:r,namespace:n||(0,s.default)(o,"metadata.namespace")}).then((function(){m.default.close(v),p.default.success({content:t("CREATE_SUCCESSFUL")}),u&&u(),O.default.delete("".concat(l,"_create_form"))}))},module:l,cluster:r,namespace:n,name:f,formTemplate:d,steps:T.default.simpleservice,modal:h.default,store:a},i))}},"service.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=m.default.open(k({onOk:function(e){a.update(r,e).then((function(){m.default.close(u),p.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},modal:E.default,detail:r,type:r.type,cluster:r.cluster,store:a},l))}},"service.gateway.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=m.default.open(k({onOk:function(e){a.update(r,e).then((function(){m.default.close(u),p.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},modal:y.default,detail:r,store:a},l))}},"fedservice.gateway.edit":{on:function(e){var a=e.store,r=e.cluster,n=e.detail,l=e.resources,u=e.success,o=(0,c.default)(e,["store","cluster","detail","resources","success"]),i=m.default.open(k({onOk:function(e){var l=n.name,o=n.namespace,c=n.template,s=n.overrides,d={},h=s.find((function(e){return e.clusterName===r}));h||(h={clusterName:r,clusterOverrides:[]},s.push(h));h.clusterOverrides=(0,_.getOverrides)(c,e,["metadata.annotations","spec.type","spec.ports"]),(0,f.default)(d,"spec.overrides",s),a.patch({name:l,namespace:o},d).then((function(){m.default.close(i),p.default.success({content:t("UPDATE_SUCCESSFUL")}),u&&u()}))},modal:y.default,detail:(0,s.default)(l,"".concat(r)),store:a},o))}},"service.delete":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=m.default.open(k({onOk:function(){m.default.close(u),p.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n()},store:a,modal:b.default,resource:r},l))}},"service.batch.delete":{on:function(e){var a=e.store,r=e.success,n=e.rowKey,l=void 0===n?"name":n,u=(0,c.default)(e,["store","success","rowKey"]),o=(0,d.toJS)(a.list),s=o.data,f=o.selectedRowKeys,h=s.filter((function(e){return f.includes(e[l])}));if(!(0,i.default)(h))var v=m.default.open(k({onOk:function(){m.default.close(v),p.default.success({content:t("DELETED_SUCCESSFULLY")}),r&&r()},modal:b.default,resource:h,store:a},u))}},"service.monitor.edit":{on:function(e){e.store;var t,a=e.cluster,r=e.namespace,n=e.success,o=e.detail,d=(0,c.default)(e,["store","cluster","namespace","success","detail"]),p=new R.default,h=C.default.servicemonitors({name:o.name,namespace:r}),v=m.default.open(k({onOk:(t=(0,u.default)(l.default.mark((function e(t){var u,c;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(0,s.default)(t,"metadata.name"),e.next=3,p.checkName({name:u,cluster:a,namespace:r});case 3:if(c=e.sent,(0,f.default)(t,"metadata.ownerReferences",[{apiVersion:"v1",kind:"Service",name:o.name,uid:o.uid}]),c.exist){e.next=10;break}return e.next=8,p.create(t,{cluster:a,namespace:r});case 8:e.next=17;break;case 10:if(!(0,i.default)((0,s.default)(t,"spec.endpoints"))){e.next=15;break}return e.next=13,p.delete({name:u,cluster:a,namespace:r});case 13:e.next=17;break;case 15:return e.next=17,p.update({name:u,cluster:a,namespace:r},t);case 17:m.default.close(v),n&&n();case 19:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),cluster:a,namespace:r,formTemplate:h,detail:o,store:p,modal:g.default},d))}}};a.default=N},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(6),r(20),r(14),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(6),r(20),r(27),r(29),r(14),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(58)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(189),h=n(r(68)),v=n(r(798)),E=n(r(819)),y=n(r(1130)),g=n(r(459)),b=n(r(319)),S=n(r(450)),_=n(r(1136)),O=r(56),C=n(r(438)),T=r(902),R=r(61),D=n(r(2997));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var N=function(e){(0,i.default)(r,e);var a=k(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).fetchData=(0,o.default)(u.default.mark((function e(){var a,r,n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.cluster,e.next=3,t.s2iStore.getS2iSupportLanguage({cluster:a});case 3:r=e.sent,n=t.state.groups.map((function(e){return"b2i"===e.type&&(e.options=r.b2i),"s2i"===e.type&&(e.options=r.s2i),e})),t.setState({groups:n});case 6:case"end":return e.stop()}}),e)}))),t.handleTypeSelect=function(e){t.setState({type:e.currentTarget.dataset.value,s2iType:e.currentTarget.dataset.type})},t.handleWorkloadModuleChange=function(e){t.setState({workloadModule:e})},t.s2iStore=new g.default,t.workloadStore=new b.default,t.showDevOps=!1,t.state={type:"",workloadModule:"deployments",groups:[{name:"SELECT_SERVICE_TYPE",description:"SELECT_SERVICE_TYPE_DESC",options:[{icon:"backup",name:"STATELESS_SERVICE",value:"statelessservice"},{icon:"stateful-set",name:"STATEFUL_SERVICE",value:"statefulservice"}].concat((0,l.default)(t.props.isFederated?[]:[{icon:"ip",name:"EXTERNAL_SERVICE",value:"externalservice"}]))}].concat((0,l.default)(t.showDevOps?[{name:"SERVICE_FROM_CODE",type:"s2i",description:"SERVICE_FROM_CODE_DESC",options:R.S2I_SUPPORTED_TYPES},{name:"SERVICE_FROM_ARTIFACT",type:"b2i",description:"SERVICE_FROM_ARTIFACT_DESC",options:R.B2I_SUPPORTED_TYPES}]:[]),(0,l.default)(t.props.isFederated?[]:[{name:"CUSTOMIZE_SERVICE",description:"CUSTOMIZE_SERVICE_DESC",options:[{icon:"clock",name:"SPECIFY_WORKLOAD",value:"simpleservice"},{icon:"coding",name:"EDIT_YAML",value:"yaml"}]}]))},t}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.showDevOps&&this.fetchData()}},{key:"componentDidUpdate",value:function(e){var t=this.props.visible;this.props.visible||t===e.visible||this.setState({type:"",workloadModule:"deployments"})}},{key:"renderHeader",value:function(){return p.default.createElement("div",{className:D.default.header},p.default.createElement("div",{className:"h4 margin-b12"},t("CREATE_SERVICE")),p.default.createElement("p",null,t("CREATE_SERVICE_DESC")),p.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/create-service.svg",alt:""}))}},{key:"renderGroups",value:function(){var e=this;return p.default.createElement("div",{className:D.default.groups},this.state.groups.map((function(a){return p.default.createElement("div",{key:a.name,className:D.default.group},p.default.createElement("div",{className:D.default.title},p.default.createElement("div",null,t(a.name)),p.default.createElement("p",null,t(a.description))),p.default.createElement("ul",null,a.options&&a.options.map((function(r){return p.default.createElement("li",{key:r.value||r,"data-value":r.value||r,"data-type":a.type,onClick:e.handleTypeSelect},p.default.createElement("div",null,p.default.createElement(m.Icon,{name:r.icon||(0,T.getLanguageIcon)(r,"radio"),size:48})),p.default.createElement("div",null,t(r.name||r.toUpperCase())))}))))})))}},{key:"renderSubModal",value:function(e,a){var r,n=this.props,u=n.store,o=n.visible,c=n.onOk,s=n.onCancel,i=n.cluster,f=n.namespace,d=n.isFederated,m=n.projectDetail,v=n.isSubmitting,g=n.workspace,b=n.supportNodeGroupSelect;if(a){var T="s2i"===a,R={S2i:C.default.s2ibuilders({namespace:f,isS2i:T,languageType:e}),Deployment:C.default.deployments({namespace:f}),Service:C.default.services({namespace:f})},D=T?_.default.s2iservice:_.default.b2iservice,k=T?t("LANGUAGE_TYPE_VALUE",{value:t(e.toUpperCase())}):t("ARTIFACT_TYPE_VALUE",{value:t(e.toUpperCase())});return this.workloadStore.setModule("deployments"),p.default.createElement(E.default,{icon:e,title:T?t("SERVICE_FROM_CODE"):t("SERVICE_FROM_ARTIFACT"),description:k,width:960,module:this.state.workloadModule,store:this.workloadStore,name:t("STATELESS_SERVICE"),visible:o,steps:D,cluster:i,namespace:f,formTemplate:R,isSubmitting:v,projectDetail:m,updateModule:this.handleWorkloadModuleChange,workspace:g,supportNodeGroupSelect:b,onOk:c,onCancel:s,noCodeEdit:!0})}switch(e){case"statelessservice":var N={Deployment:C.default.deployments({namespace:f}),Service:C.default.services({namespace:f})};d&&Object.keys(N).forEach((function(e){N[e]=C.default.federated({data:N[e],clusters:m.clusters.map((function(e){return e.name})),kind:e})})),(0,h.default)(N,'Service.metadata.annotations["kubesphere.io/serviceType"]',e),this.workloadStore.setModule("deployments");var I=this.workloadStore,P=(0,l.default)(_.default[e]);d&&(P.push({title:"CLUSTER_DIFF",icon:"blue-green-deployment",component:(0,O.withProps)(y.default,{withService:!0})}),I=new S.default(this.workloadStore)),r=p.default.createElement(E.default,{width:960,module:"deployments",store:I,name:t("STATELESS_SERVICE"),visible:o,cluster:i,namespace:f,isFederated:d,projectDetail:m,steps:P,formTemplate:N,isSubmitting:v,workspace:g,supportNodeGroupSelect:b,onOk:c,onCancel:s});break;case"statefulservice":var A={StatefulSet:C.default.statefulsets({namespace:f}),Service:C.default.services({namespace:f})};d&&Object.keys(A).forEach((function(e){A[e]=C.default.federated({data:A[e],clusters:m.clusters.map((function(e){return e.name})),kind:e})})),(0,h.default)(A,'Service.metadata.annotations["kubesphere.io/serviceType"]',e),this.workloadStore.setModule("statefulsets");var w=this.workloadStore,L=(0,l.default)(_.default[e]);d&&(L.push({title:"CLUSTER_DIFF",icon:"blue-green-deployment",component:(0,O.withProps)(y.default,{withService:!0})}),w=new S.default(this.workloadStore)),r=p.default.createElement(E.default,{width:960,module:"statefulsets",store:w,name:t("STATEFUL_SERVICE"),visible:o,cluster:i,namespace:f,isFederated:d,projectDetail:m,steps:L,formTemplate:A,isSubmitting:v,workspace:g,supportNodeGroupSelect:b,onOk:c,onCancel:s});break;case"simpleservice":case"externalservice":var M={Service:C.default.services({namespace:f})};d&&Object.keys(M).forEach((function(e){M[e]=C.default.federated({data:M[e],clusters:m.clusters.map((function(e){return e.name})),kind:e})}));var x="externalservice"===e?t("CREATE_EXTERNAL_SERVICE"):t("SPECIFY_WORKLOAD_TO_CREATE_SERVICE"),j="externalservice"===e?t("CREATE_EXTERNAL_SERVICE_DESC"):t("SPECIFY_WORKLOAD_DESC");"externalservice"===e&&(0,h.default)(M,'Service.metadata.annotations["kubesphere.io/serviceType"]',e),r=p.default.createElement(E.default,{width:960,module:"services",store:u,title:x,description:j,visible:o,cluster:i,namespace:f,isFederated:d,projectDetail:m,steps:_.default[e],formTemplate:M,isSubmitting:v,workspace:g,supportNodeGroupSelect:b,onOk:c,onCancel:s});break;case"yaml":var U={Service:C.default.services({namespace:f})};d&&Object.keys(U).forEach((function(e){U[e]=C.default.federated({data:U[e],clusters:m.clusters.map((function(e){return e.name})),kind:e})}));var F=t("EDIT_YAML_TO_CREATE_SERVICE");r=p.default.createElement(E.default,{width:960,module:"services",store:u,title:F,visible:o,cluster:i,namespace:f,isFederated:d,projectDetail:m,formTemplate:U,isSubmitting:v,workspace:g,supportNodeGroupSelect:b,onOk:c,onCancel:s,onlyCode:!0})}return r}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,r=this.state,n=r.type,l=r.s2iType;return n?this.renderSubModal(n,l):p.default.createElement(v.default,{bodyClassName:D.default.body,width:960,visible:t,onCancel:a,hideHeader:!0},this.renderHeader(),this.renderGroups())}}]),r}(p.default.Component);a.default=N},function(e,t,a){e.exports={body:"cbNCVjWQhnReqPddm4gee",header:"_3z9Nw7EpOrYUdcFPCf6UQQ",groups:"_2jTLPN_SuLOVUctqK30Adg",group:"Hbk366BfbfqDSt72frwoc",title:"_1k3IuI_W90TycEVQwt3NcK"}},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(798)),m=n(r(1153)),h=r(61),v=n(r(2999)),E=n(r(3e3));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var g=function(e){(0,o.default)(r,e);var a=y(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.props,a=e.onOk,r=e.store,n=e.detail,l=t.formRef.current,u=r.list,o=(0,d.toJS)(u.selectedRowKeys).filter((function(e){return e!==n.uid}));l&&l.validate((function(){a(l.getData()),u.setSelectRowKeys(o)}))},t.handleCancel=function(){(0,t.props.onCancel)()},t.formRef=i.default.createRef(),t.state={formTemplate:(0,d.toJS)(e.detail._originData)},t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props.detail;t._originData!==e.detail._originData&&this.setState({formTemplate:(0,d.toJS)(t._originData)})}},{key:"renderServiceSettings",value:function(){var e=this.props,t=e.cluster,a=e.type;return i.default.createElement(v.default,{formRef:this.formRef,formTemplate:this.state.formTemplate,onCancel:this.resetState,cluster:t,type:h.SERVICE_TYPES_VALUE[a]})}},{key:"renderExternalName",value:function(){return i.default.createElement(m.default,{formRef:this.formRef,formTemplate:this.state.formTemplate,onCancel:this.resetState})}},{key:"renderEmpty",value:function(){return i.default.createElement("p",{className:E.default.empty},t("UNKNOWN_SERVICE_TYPE"))}},{key:"renderForm",value:function(){var e=null;switch(this.props.type){case h.SERVICE_TYPES.VirtualIP:case h.SERVICE_TYPES.Headless:e=this.renderServiceSettings();break;case h.SERVICE_TYPES.ExternalName:e=this.renderExternalName();break;default:e=this.renderEmpty()}return e}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.type;return i.default.createElement(p.default,{width:1162,title:t("EDIT_SERVICE"),onOk:n!==h.SERVICE_TYPES.Unknown?this.handleOk:null,onCancel:this.handleCancel,visible:a,isSubmitting:r},this.renderForm())}}]),r}(i.default.Component);a.default=g,g.propTypes={visible:f.default.bool,type:f.default.string,detail:f.default.object,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},g.defaultProps={visible:!1,type:"",detail:{},onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1154)),d=r(189),p=n(r(827));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"renderTypeSelect",value:function(){return i.default.createElement(d.Form.Item,{label:t("INTERNAL_ACCESS_MODE")},i.default.createElement(p.default,{className:"margin-b12",value:this.props.type,onChange:this.handleTypeChange,options:this.types,disabled:!0}))}}]),r}(f.default);a.default=h},function(e,t,a){e.exports={empty:"_1iYB_RtQyygADkaCOPvMXp"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(73),r(7);var l=n(r(31)),u=n(r(58)),o=n(r(38));r(35);var c=n(r(39)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(26)),h=n(r(140)),v=n(r(68)),E=n(r(196)),y=n(r(831)),g=n(r(0)),b=r(17),S=n(r(1)),_=r(189),O=n(r(798)),C=n(r(956)),T=n(r(3002)),R=r(61),D=n(r(1370)),k=r(1152),N=n(r(3004));function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var w=function(e){(0,f.default)(n,e);var a,r=A(n);function n(e){var a;return(0,s.default)(this,n),(a=r.call(this,e)).openELBStore=new D.default,a.checkOpenELBStatus=(0,c.default)(o.default.mark((function e(){var t,r,n,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.detail,r=t.cluster,n=t.namespace,e.next=3,a.openELBStore.isActive({clusters:[r],namespace:n});case 3:(l=e.sent)||a.setState({openELBOpened:l});case 5:case"end":return e.stop()}}),e)}))),a.providerOptionRenderer=function(e){return g.default.createElement("div",{className:N.default.selectOption},g.default.createElement(_.Icon,{className:"margin-r8",name:e.icon,type:"light",size:20}),g.default.createElement("span",{className:N.default.text},e.label),e.disabled&&g.default.createElement(_.Tooltip,{content:t("OPENELB_NOT_READY")},g.default.createElement(_.Icon,{name:"question",size:"16"})))},a.handleProvideChange=function(e){a.setState({provider:e})},a.handleTypeChange=function(e){if("LoadBalancer"!==e&&((0,E.default)(a.state.formTemplate,"metadata.annotations['kubesphere.io/annotations']"),Object.keys(globals.config.loadBalancerDefaultAnnotations).forEach((function(e){(0,E.default)(a.state.formTemplate,'metadata.annotations["'.concat(e,'"]'))})),a.providerOptions.forEach((function(e){(0,E.default)(a.state.formTemplate,'metadata.annotations["'.concat(e,'"]'))})),"ClusterIP"===e)){var t=(0,m.default)(a.state.formTemplate,"spec.ports",[]).map((function(e){return(0,h.default)(e,["nodePort"])}));(0,v.default)(a.state.formTemplate,"spec.ports",t)}a.setState({type:e})},a.optionRenderer=function(e){return g.default.createElement("div",{className:N.default.option},g.default.createElement("div",null,e.label),g.default.createElement("p",null,e.desc))},a.handleOk=function(e){var t=a.props,r=t.onOk,n=t.store,l=t.detail,u=n.list,o=(0,b.toJS)(u.selectedRowKeys).filter((function(e){return e!==l.uid}));r(e),u.setSelectRowKeys(o)},a.state={type:(0,m.default)((0,b.toJS)(e.detail._originData),"spec.type"),formTemplate:(0,y.default)((0,b.toJS)(e.detail._originData)),openELBOpened:!0,provider:"QingCloud Kubernetes Engine"},a}return(0,i.default)(n,[{key:"componentDidMount",value:(a=(0,c.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.checkOpenELBStatus();case 1:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=this.state,o=l.type,c=l.formTemplate,s=l.provider,i=l.openELBOpened,f=[].concat((0,u.default)(R.CLUSTER_PROVIDERS),[{label:"OpenELB",value:"OpenELB",icon:"kubernetes",disabled:!i,tip:""}]);return g.default.createElement(O.default.Form,{width:1162,title:t("EDIT_EXTERNAL_ACCESS"),data:c,onOk:this.handleOk,onCancel:r,visible:a,isSubmitting:n},g.default.createElement("div",null,g.default.createElement(T.default,{title:t("EXTERNAL_ACCESS"),desc:t("SERVICE_EXTERNAL_ACCESS_DESC")}),g.default.createElement("div",{className:N.default.wrapper},g.default.createElement("div",{className:N.default.contentWrapper},g.default.createElement(_.Columns,null,g.default.createElement(_.Column,null,g.default.createElement(_.Form.Item,{label:t("ACCESS_MODE"),className:N.default.types},g.default.createElement(_.Select,{name:"spec.type",options:this.accessModes,onChange:this.handleTypeChange,optionRenderer:this.optionRenderer}))),"LoadBalancer"===o&&g.default.createElement(_.Column,null,g.default.createElement(_.Form.Item,{label:t("LOAD_BALANCER_PROVIDER")},g.default.createElement(_.Select,{options:f,placeholder:" ",optionRenderer:this.providerOptionRenderer,onChange:this.handleProvideChange,value:s,name:"metadata.annotations['kubesphere.io/annotations']"})))),"LoadBalancer"===o&&g.default.createElement(_.Form.Item,{label:t("ANNOTATION_PL")},g.default.createElement(C.default,{name:"metadata.annotations",options:this.providerOptions,hiddenKeys:[/^kubesphere.io\//,"openpitrix_runtime"],addText:t("ADD")}))))))}},{key:"accessModes",get:function(){var e,a,r,n=[{label:t("NONE"),desc:t("ACCESS_NONE_TIP"),value:"ClusterIP"},{label:"NodePort",desc:t("ACCESS_NODEPORT_TIP"),value:"NodePort"},{label:"LoadBalancer",desc:t("ACCESS_LOADBALANCER_TIP"),value:"LoadBalancer"}];return(null===(e=globals.config)||void 0===e||null===(a=e.serviceGatewaySetting)||void 0===a||null===(r=a.disabledAccessMode)||void 0===r?void 0:r.length)?n.map((function(e){return P(P({},e),{},{disabled:globals.config.serviceGatewaySetting.disabledAccessMode.includes(e.value)})})):n}},{key:"providerOptions",get:function(){var e=this.state.provider;return""===e?[]:Object.keys(k.CLUSTER_PROVIDERS_ANNOTATIONS[e])}}]),n}(g.default.Component);a.default=w,w.propTypes={visible:S.default.bool,detail:S.default.object,onOk:S.default.func,onCancel:S.default.func,isSubmitting:S.default.bool},w.defaultProps={visible:!1,isSubmitting:!1,detail:{},onOk:function(){},onCancel:function(){}}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(0)),l=r(a(5)),u=r(a(3003)),o=function(e){var t=e.title,a=e.desc,r=e.className;return n.default.createElement("div",{className:(0,l.default)(u.default.title,r)},n.default.createElement("div",{className:"h4"},t),n.default.createElement("p",null,a))};t.default=o},function(e,t,a){e.exports={title:"QATgUSsoGzs-HirGBPJ_o"}},function(e,t,a){e.exports={wrapper:"_3TA3Qz6ifk73ngG3XZqG3_",title:"_2xJakYguvxIfuNLPwECuxz",contentWrapper:"AdN2olZI0P9-CfZJC-oJd",option:"_36a3_8ve0treEjf7MSk9_V",selectOption:"_2iUolxlw4P2wsBc_FfLi0a",text:"_3AWkYRTRQL_YG5rEAb0kgS"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(14),r(4),r(21),r(18),r(11),r(73),r(46),r(7),r(40),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(27),r(29),r(14),r(4),r(21),r(18),r(43),r(11),r(73),r(46),r(7),r(40),r(110);var l=n(r(317)),u=n(r(50)),o=n(r(31)),c=n(r(58)),s=n(r(38));r(35);var i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),E=n(r(1)),y=n(r(5)),g=n(r(26)),b=n(r(455)),S=n(r(64)),_=n(r(67)),O=n(r(850)),C=r(189),T=r(56),R=r(61),D=n(r(798)),k=n(r(844)),N=n(r(452)),I=n(r(319)),P=n(r(451)),A=n(r(450)),w=n(r(459)),L=n(r(3006));function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var x=["deployments","daemonsets","statefulsets"],j=function(e){(0,p.default)(n,e);var a,r=M(n);function n(e){var t;return(0,f.default)(this,n),(t=r.call(this,e)).stopPropagation=function(e){return e.stopPropagation()},t.handleOk=(0,i.default)(s.default.mark((function e(){var a,r,n,l,u,o,c,i;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,r=a.onOk,n=a.store,l=a.resource,u=t.state,o=u.selectedRelatedResourceIds,c=u.relatedResources,i=[],c.forEach((function(e){o.includes(e.uid)&&("persistentvolumeclaims"===e.module?i.push(t.volumeStore.delete(e)):x.includes(e.module)?(t.workloadStore.setModule(e.module),i.push(t.workloadStore.delete(e))):"s2ibuilders"===e.module||"s2i"===e.type?i.push(t.builderStore.delete(e)):"pods"===e.module&&i.push(t.podStore.delete(e)))})),!(0,S.default)(l)){e.next=10;break}return e.next=7,Promise.all(l.map((function(e){return n.delete(e)})));case 7:n.list.setSelectRowKeys([]),e.next=12;break;case 10:return e.next=12,n.delete(l);case 12:return e.next=14,Promise.all(i);case 14:r();case 15:case"end":return e.stop()}}),e)}))),t.handleItemClick=function(e){var a=e.currentTarget.dataset.id;t.setState((function(e){var t=e.selectedRelatedResourceIds;return{selectedRelatedResourceIds:t.includes(a)?t.filter((function(e){return e!==a})):[].concat((0,c.default)(t),[a])}}))},t.state={relatedResources:[],selectedRelatedResourceIds:[],enableConfirm:!1,timer:3},t.workloadStore=new I.default,t.volumeStore=new P.default,t.builderStore=new w.default,t.podStore=new N.default,e.isFederated&&(t.workloadStore=new A.default({module:"deployments"}),t.volumeStore=new A.default({module:t.volumeStore.module})),t}return(0,d.default)(n,[{key:"componentDidMount",value:function(){this.props.visible&&(this.fetchRelatedResources(this.props.resource),this.startTimer())}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"startTimer",value:function(){var e=this;this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){e.setState((function(e){var t=e.timer;return{timer:Math.max(t-1,0),enableConfirm:t<=1}}),(function(){e.state.enableConfirm&&e.timer&&clearInterval(e.timer)}))}),1e3)}},{key:"fetchRelatedResources",value:(a=(0,i.default)(s.default.mark((function e(t){var a,r,n,l,u,o,i,f=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),a=[],(0,S.default)(t)?(a=t.map((function(e){return e.selector||(0,g.default)(e,"resource.selector")})),r=t[0].namespace,n=t[0].cluster):(a.push(t.selector||(0,g.default)(t,"resource.selector")),r=t.namespace,n=t.cluster),l=[],u=this.props.isFederated?["deployments","statefulsets"]:x,a.forEach((function(e){if(!(0,_.default)(e)){var t=(0,T.joinSelector)(e);l.push.apply(l,[f.volumeStore.fetchListByK8s({cluster:n,namespace:r,labelSelector:t}),f.podStore.fetchListByK8s({cluster:n,namespace:r,labelSelector:t})].concat((0,c.default)(u.map((function(e){return f.workloadStore.fetchListByK8s({cluster:n,namespace:r,labelSelector:t,module:e})}))))),e.s2ibuilder&&l.push(f.builderStore.fetchDetail({cluster:n,namespace:r,name:e.s2ibuilder,module:"s2ibuilders"}).then((function(e){return[e]})))}})),e.next=8,Promise.all(l);case 8:o=e.sent,i=(0,O.default)((0,b.default)(o),"uid").filter((function(e){return!(0,_.default)(e.name)})),this.setState({relatedResources:i,isLoading:!1});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"renderContent",value:function(){var e=this,a=this.state,r=a.isLoading,n=a.relatedResources,l=a.selectedRelatedResourceIds;return!1===r&&(0,_.default)(n)?v.default.createElement(k.default,{icon:"appcenter",className:L.default.empty,title:t("NO_RELATED_RESOURCE_FOUND"),desc:t("NO_SERVICE_RELATED_RESOURCE_DESC")}):v.default.createElement("div",{className:L.default.resources},n.map((function(a){return v.default.createElement("div",{key:a.uid,"data-id":a.uid,className:(0,y.default)(L.default.resource,(0,o.default)({},L.default.selected,l.includes(a.uid))),onClick:e.handleItemClick},v.default.createElement(C.Checkbox,{checked:l.includes(a.uid),onClick:e.stopPropagation}),v.default.createElement(C.Icon,{name:R.ICON_TYPES[a.module],size:20,type:l.includes(a.uid)?"light":"dark"}),v.default.createElement("span",{className:L.default.resourceName},(0,T.getDisplayName)(a)),v.default.createElement("span",{className:L.default.resourceType},t(R.MODULE_KIND_MAP[a.module])))})))}},{key:"render",value:function(){var e=this.state,a=e.enableConfirm,r=e.timer,n=this.props,o=n.resource,c=(n.onOk,n.onCancel),s=n.isSubmitting,i=(0,u.default)(n,["resource","onOk","onCancel","isSubmitting"]),f=(0,S.default)(o)&&1!==o.length?t("DELETE_MULTIPLE_SERVICES"):t("DELETE_SERVICE"),d=(0,S.default)(o)&&1!==o.length?t.html("DELETE_SERVICE_DESC_PL",{resource:o.map((function(e){return e.name})).join(", ")}):(0,S.default)(o)?t.html("DELETE_SERVICE_DESC_SI",{resource:o.map((function(e){return e.name})).join(", ")}):t.html("DELETE_SERVICE_DESC_SI",{resource:o.name});return v.default.createElement(D.default,(0,l.default)({width:520,icon:"question",title:f,description:d,closable:!1,headerClassName:L.default.modalHeader,bodyClassName:L.default.modalBody,hideFooter:!0},i),v.default.createElement("div",{className:L.default.body},this.renderContent()),v.default.createElement("div",{className:L.default.footer},v.default.createElement(C.Button,{onClick:c},t("CANCEL")),v.default.createElement(C.Button,{type:"danger",loading:s,disabled:!a||s,onClick:this.handleOk},t("OK"),!a&&"(".concat(r,"s)"))))}}]),n}(v.default.Component);a.default=j,j.propTypes={resource:E.default.any,visible:E.default.bool,onOk:E.default.func,onCancel:E.default.func,isSubmitting:E.default.bool},j.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={modalHeader:"_26d-mmc1L8YE15w2c5ynj-",modalBody:"OJj3mjDoKuQusJLoJyxm0",body:"xh0ShGgPliDrZ8GV160Qz",resources:"_3pLESr3si_XDoA7Poj1ldk",resource:"LOltHxE-oCwWcX3uKoJ6r",selected:"_1S_nFSv86IHQku-q8oIIuP",resourceName:"_3wA790hRgUadmWOd56JWt3",resourceType:"_3B2I_N_Bhq2bs2Nl5XvfDZ",footer:"_2lXPmmJElrAhBjoXVAlMPI",empty:"_7aUFmc9Af5O59nrGIsW-3"}},function(e,t,a){"use strict";a(16);var r=a(19);a(6),a(30),a(71),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.getOverrides=void 0,a(6),a(27),a(141),a(120),a(4),a(30),a(71),a(7);var n=r(a(26));t.getOverrides=function(e,t,a){var r=[];return e&&t?(a.forEach((function(a){var l=(0,n.default)(e,a,{}),u=(0,n.default)(t,a,{});JSON.stringify(l)!==JSON.stringify(u)&&r.push({path:"/".concat(a.replace(/\./g,"/")),value:u})})),r):r}},function(e,a,r){"use strict";(function(e){var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(26)),c=n(r(191)),s=n(r(798)),i=n(r(819)),f=n(r(3009)),d=n(r(3010)),p=r(61),m=n(r(438)),h=n(r(3011));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={"serviceaccount.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,f=e.workspace,d=e.module,v=e.success,y=(0,u.default)(e,["store","cluster","namespace","workspace","module","success"]),g=p.MODULE_KIND_MAP[d],b=(0,l.default)({},g,m.default[d]({namespace:n})),S=s.default.open(E({onOk:function(e){var l=(0,o.default)(e,g);l?a.create(l,{cluster:r,namespace:n||(0,o.default)(l,"metadata.namespace")}).then((function(){s.default.close(S),c.default.success({content:t("CREATE_SUCCESSFUL")}),v&&v()})):c.default.error({content:t("INVALID_YAML_FILE_FORMAT")})},modal:i.default,steps:h.default,formTemplate:b,name:"SERVICE_ACCOUNT",store:a,module:d,cluster:r,namespace:n,workspace:f},y))}},"serviceaccount.edit":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,u.default)(e,["store","detail","success"]),o=s.default.open(E({onOk:function(e){a.patch(r,e).then((function(){s.default.close(o),c.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},detail:r,modal:f.default,namespace:r.namespace,store:a},l))}},"serviceaccount.role.edit":{on:function(a){var r=a.store,n=a.detail,l=a.success,o=(0,u.default)(a,["store","detail","success"]),i=s.default.open(E({onOk:function(e){r.patch(n,e).then((function(){s.default.close(i),c.default.success({content:t("UPDATE_SUCCESSFUL")}),l&&l()}))},detail:n,modal:d.default,store:r,module:e,namespace:n.namespace},o))}}};a.default=y}).call(this,r(144)(e))},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=r(189),m=n(r(798)),h=n(r(831)),v=r(17),E=r(243),y=n(r(1)),g=n(r(0)),b=n(r(322)),S=r(61);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=(0,E.observer)((o=u=function(e){(0,i.default)(r,e);var a=_(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).roleStore=new b.default,t.handleOk=function(e){var a=t.props,r=a.onOk,n=a.store,l=a.detail,u=n.list,o=(0,v.toJS)(u.selectedRowKeys).filter((function(e){return e!==l.uid}));r(e),u.setSelectRowKeys(o)},t.state={formData:(0,h.default)((0,v.toJS)(e.detail._originData||e.detail))},t}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,h.default)((0,v.toJS)(this.props.detail._originData||this.props.detail))})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=this.state.formData;return g.default.createElement(m.default.Form,{data:l,width:691,title:t("EDIT_INFORMATION"),icon:"pen",onOk:this.handleOk,okText:t("OK"),onCancel:n,visible:a,isSubmitting:r},g.default.createElement(p.Form.Item,{label:t("NAME")},g.default.createElement(p.Input,{name:"metadata.name",disabled:!0})),g.default.createElement(p.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:S.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},g.default.createElement(p.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),g.default.createElement(p.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},g.default.createElement(p.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))}}]),r}(g.default.Component),u.propTypes={detail:y.default.object,visible:y.default.bool,onOk:y.default.func,onCancel:y.default.func,isSubmitting:y.default.bool},u.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1},l=o))||l;a.default=O},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(17),v=r(243),E=n(r(831)),y=r(189),g=n(r(798)),b=n(r(1173)),S=n(r(322));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=(0,v.observer)((o=u=function(e){(0,i.default)(r,e);var a=_(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).roleStore=new S.default,t.handleOk=function(e){var a=t.props,r=a.onOk,n=a.store,l=a.detail,u=n.list,o=(0,h.toJS)(u.selectedRowKeys).filter((function(e){return e!==l.uid}));r(e),u.setSelectRowKeys(o)},t.state={formData:(0,E.default)((0,h.toJS)(e.detail._originData))},t}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,E.default)((0,h.toJS)(this.props.detail._originData))})}},{key:"render",value:function(){var e=this.props,a=e.title,r=e.visible,n=e.onCancel,l=e.isSubmitting,u=e.cluster,o=e.namespace,c=this.state.formData;return p.default.createElement(g.default.Form,{width:600,title:a||t("CHANGE_ROLE"),icon:"client",data:c,onOk:this.handleOk,onCancel:n,visible:r,isSubmitting:l},p.default.createElement(y.Form.Item,{label:t("PROJECT_ROLE_SI"),desc:t("SERVICE_ACCOUNT_PROJECT_ROLE_DESC")},p.default.createElement(b.default,{name:"metadata.annotations['iam.kubesphere.io/role']",cluster:u,namespace:o,placeholder:" "})))}}]),r}(p.default.Component),u.propTypes={detail:m.default.object,title:m.default.string,visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool},u.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=O},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(56),l=r(a(3012)),u=[{title:"BASIC_INFORMATION",component:(0,n.withProps)(l.default,{maxNameLength:63}),required:!0}];t.default=u},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=r(189),d=n(r(898)),p=n(r(1173)),m=n(r(26)),h=n(r(68)),v=r(243),E=n(r(0)),y=n(r(322)),g=r(61);function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var S=(0,v.observer)(l=function(e){(0,c.default)(r,e);var a=b(r);function r(e){var n;return(0,u.default)(this,r),(n=a.call(this,e)).roleStore=new y.default,n.nameValidator=function(e,a,r){if(!a)return r();n.props.store.checkName({name:a,namespace:n.state.namespace,cluster:n.state.cluster}).then((function(a){if(a.exist)return r({message:t("NAME_EXIST_DESC"),field:e.field});r()}))},n.handleChange=function(e){(0,h.default)(n.formTemplate,'metadata.annotations["iam.kubesphere.io/role"]',""),n.setState({namespace:e})},n.state={cluster:e.cluster,workspace:e.workspace,namespace:e.namespace},n}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props.formRef,a=this.state,r=a.cluster,n=a.namespace;return E.default.createElement(f.Form,{data:this.formTemplate,ref:e},E.default.createElement(f.Columns,null,E.default.createElement(f.Column,null,E.default.createElement(f.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:g.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.nameValidator}]},E.default.createElement(f.Input,{name:"metadata.name",autoFocus:!0,maxLength:63}))),E.default.createElement(f.Column,null,E.default.createElement(f.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:g.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},E.default.createElement(f.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),E.default.createElement(f.Columns,null,!this.props.namespace&&E.default.createElement(f.Column,null,E.default.createElement(f.Form.Item,{label:t("PROJECT"),desc:t("SELECT_PROJECT_DESC"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")}]},E.default.createElement(d.default,{name:"metadata.namespace",cluster:this.props.cluster,onChange:this.handleChange}))),E.default.createElement(f.Column,null,E.default.createElement(f.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},E.default.createElement(f.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))),E.default.createElement(f.Columns,null,E.default.createElement(f.Column,null,E.default.createElement(f.Form.Item,{label:t("PROJECT_ROLE_SI"),desc:t("SELECT_PROJECT_ROLE_DESC")},E.default.createElement(p.default,{name:"metadata.annotations['iam.kubesphere.io/role']",cluster:r,namespace:n,placeholder:" "})))))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,m.default)(t,g.MODULE_KIND_MAP[a],t)}}]),r}(E.default.Component))||l;a.default=S},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=r(17),c=n(r(68)),s=n(r(26)),i=n(r(191)),f=n(r(798)),d=n(r(819)),p=n(r(3014)),m=n(r(438)),h=n(r(3017));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={"servicerouting.create":{on:function(e){var a=e.store,r=e.namespace,n=e.module,l=e.cluster,o=e.gateway,p=e.success,v=(0,u.default)(e,["store","namespace","module","cluster","gateway","success"]),y=f.default.open(E({modal:d.default,onOk:function(e){var n=(0,s.default)(e,"metadata.name");(0,c.default)(e,"spec.routes[0].id",n),a.create(e,{cluster:l,namespace:r}).then((function(){f.default.close(y),i.default.success({content:t("CREATE_SUCCESSFUL")}),p&&p()}))},steps:h.default,formTemplate:m.default[n]({namespace:r,gateway:o}),store:a,namespace:r,cluster:l},v))}},"servicerouting.edit":{on:function(e){var a=e.store,r=e.namespace,n=(e.module,e.cluster),l=e.detail,c=e.title,s=void 0===c?t("EDIT_MICROSERVICE_ROUTE"):c,d=e.success,m=(0,u.default)(e,["store","namespace","module","cluster","detail","title","success"]),h=f.default.open(E({modal:p.default,onOk:function(e){a.update(l,e).then((function(){f.default.close(h),i.default.success({content:t("MODIFY_SUCCESSFUL")}),d&&d()}))},title:s,detail:(0,o.toJS)(l._originData),store:a,namespace:r,cluster:n,isEditMode:!0},m))}}};a.default=y},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(50)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=r(a(1)),p=r(a(831)),m=r(a(798)),h=r(a(1483));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=function(e){(0,c.default)(a,e);var t=v(a);function a(){var e;(0,u.default)(this,a);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).form=f.default.createRef(),e.state={formData:(0,p.default)(e.props.detail)},e.handleOk=function(){var t=e.props.onOk;e.form.current.validator((function(){t(e.form.current.getData())}))},e}return(0,o.default)(a,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,p.default)(this.props.detail)})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.title,r=e.onCancel,u=e.isSubmitting,o=(0,l.default)(e,["visible","title","onCancel","isSubmitting"]),c=this.state.formData;return f.default.createElement(m.default,{width:960,title:a,onCancel:r,onOk:this.handleOk,visible:t,isSubmitting:u},f.default.createElement(h.default,(0,n.default)({formRef:this.form,formTemplate:c},o)))}}]),a}(f.default.Component);t.default=E,E.propTypes={visible:d.default.bool,onOk:d.default.func,onCancel:d.default.func,isSubmitting:d.default.bool,isEditMode:d.default.bool},E.defaultProps={visible:!1,isSubmitting:!1,isEditMode:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(141),a(29),a(120),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(28)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(0)),i=r(a(142)),f=a(189),d=r(a(3016));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var m=function(e){(0,u.default)(a,e);var t=p(a);function a(){var e;(0,n.default)(this,a);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return(e=t.call.apply(t,[this].concat(l))).handleChange=function(t){e.props.onChange(t)},e}return(0,l.default)(a,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.options;return(0,i.default)(t)?s.default.createElement(f.AutoComplete,{value:t,className:d.default.autocomplete,options:a,onChange:this.handleChange}):s.default.createElement("div",{className:d.default.text},JSON.stringify(t))}}]),a}(s.default.Component);t.default=m},function(e,t,a){e.exports={wrapper:"KfR6-Hi6ChXCC8SEeyfK7",autocomplete:"_3JJmaE8GoZ93yjPsiD1M5V"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=[{title:"ROUTE_SETTINGS",component:r(a(1483)).default,required:!0}];t.default=n},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(87),r(98),r(8),r(13),r(9),r(79),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(27),r(87),r(98),r(141),r(29),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(79),r(7);var l=n(r(97)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(31)),s=n(r(50)),i=n(r(191)),f=n(r(819)),d=n(r(68)),p=n(r(26)),m=n(r(119)),h=n(r(798)),v=n(r(3019)),E=n(r(3026)),y=r(486),g=n(r(3028)),b=n(r(438)),S=r(61),_=n(r(1194)),O=n(r(92)),C=n(r(978));function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var D={"silent-policy.add":{on:function(e){var a,r=e.store,n=e.module,l=e.success,c=(e.namespace,(0,s.default)(e,["store","module","success","namespace"])),d=b.default[n]({}),p=(0,m.default)(S.silentDefaultItem),v=h.default.open(R({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.create(I(a,p));case 4:h.default.close(v),i.default.success({content:t("CREATE_SILENCE_POLICY_SUCCESSFULLY")}),l&&l();case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),module:n,form2codeParse:function(e){return I(e,p)},code2formParse:O.default[n],title:t("CREATE_SILENCE_POLICY"),steps:g.default,formTemplate:d,modal:f.default,isAdd:!0,store:r},c))}},"silent-policy.edit":{on:function(e){var a,r=e.store,n=e.module,l=e.success,c=(0,s.default)(e,["store","module","success"]),f=(0,m.default)(c.detail),d=h.default.open(R({onOk:(a=(0,o.default)(u.default.mark((function e(a){var n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return n=c.detail,e.next=5,r.patch(n,I(a,{},["metadata"]));case 5:i.default.success({content:t("EDIT_SILENCE_POLICY_SUCCESSFULLY")}),h.default.close(d),l&&l();case 8:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),module:n,formTemplate:f,okBtnText:t("OK"),title:t("EDIT_INFORMATION"),modal:_.default,store:r},c))}},"silent-policy.editCondition":{on:function(e){var a,r=e.store,n=e.module,l=e.success,c=(0,s.default)(e,["store","module","success"]),f=(0,m.default)(c.detail),d=h.default.open(R({onOk:(a=(0,o.default)(u.default.mark((function e(a){var n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return n=c.detail,e.next=5,r.patch(n,I(a,{},["spec.matcher"]));case 5:i.default.success({content:t("EDIT_SILENCE_POLICY_SUCCESSFULLY")}),h.default.close(d),l&&l();case 8:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),module:n,formTemplate:f,title:t("EDIT_SILENCE_CONDITIONS"),modal:E.default,store:r},c))}},"silent-policy.editTime":{on:function(e){var a=e.store,r=e.module,n=e.success,l=(0,s.default)(e,["store","module","success"]),c=(0,m.default)(l.detail);c.isDefaultCron=c.isCron;var f,d=h.default.open(R({onOk:(f=(0,o.default)(u.default.mark((function e(r){var o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return o=l.detail,e.next=5,a.patch(o,I(r,{},["spec"]));case 5:i.default.success({content:t("EDIT_SILENCE_POLICY_SUCCESSFULLY")}),h.default.close(d),n&&n();case 8:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)}),module:r,formTemplate:c,title:t("EDIT_SILENCE_TIME"),modal:v.default,store:a},l))}},"silent-policy.yaml.update":{on:function(e){var a,r=e.store,n=e.detail,c=e.success,f=(0,s.default)(e,["store","detail","success"]),d=h.default.open(R({onOk:(a=(0,o.default)(u.default.mark((function e(a){var o,s;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,l.default)(a,1),s=o[0],e.next=3,r.update(n,s);case 3:i.default.success({content:t("EDIT_SILENCE_POLICY_SUCCESSFULLY")}),h.default.close(d),c&&c();case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),detail:n,store:r,modal:C.default},f))}}};a.default=D;function k(e,t){var a=t-e,r=Math.floor(a/1e3/60/60),n=Math.floor(a/1e3/60%60),l=Math.floor(a/1e3%60);return"".concat(r?"".concat(r,"h"):"").concat(n?"".concat(n,"m"):r?"0m":"").concat(l?"".concat(l,"s"):"0s")}var N=[["metadata.name","name"],["metadata.annotations['kubesphere.io/alias-name']","aliasName"],["metadata.annotations['kubesphere.io/description']","desc"],["spec.matcher.matchExpressions","matchExpressions"],["spec.startsAt",function(e){return 1===e.type||2===e.type?(0,p.default)(e,"dateRange[0]",new Date):null}],["spec.duration",function(e){var t,a,r;return 2===e.type?k(new Date((0,p.default)(e,"dateRange[0]")).getTime(),new Date((0,p.default)(e,"dateRange[1]")).getTime()):3===e.type&&!e.isCron&&(null===(t=e.timeRange)||void 0===t?void 0:t.length)>1&&(null===(a=e.timeRange)||void 0===a?void 0:a[(null===(r=e.timeRange)||void 0===r?void 0:r.length)-1])?k(1e3*(0,p.default)(e,"timeRange[0]",0),1e3*(0,p.default)(e,"timeRange[1]",0)):e.duration?e.duration:null}],["spec.schedule",function(e){var t;if(e.isCron)return e.cron;if(3!==e.type)return null;var a=null!==(t=e.timeRange)&&void 0!==t?t:[],r=(0,l.default)(a,2),n=r[0],u=r[1],o=JSON.parse(JSON.stringify((0,y.parseExpression)("0 * * * *").fields));return u&&(n=Math.floor(n/60/60),u=Math.floor(u/60/60),o.hour=[n]),2===e.timeType&&e.week&&e.week.length&&(o.dayOfWeek=e.week),3===e.timeType&&e.month&&e.month.length&&(o.dayOfMonth=e.month),(0,y.fieldsToExpression)(o).stringify()}]];function I(e,t,a){return N.filter((function(e){var t=(0,l.default)(e,1)[0];return!a||a.some((function(e){return t.startsWith(e)}))})),function(e){return function(t,a){return e.reduce((function(e,a){var r,n=(0,l.default)(a,2),u=n[0],o=n[1];return"string"==typeof o&&(r=(0,p.default)(t,o)),"function"==typeof o&&(r=o(t,e)),void 0!==r&&(0,d.default)(e,u,r),e}),a)}}(N)(e,t)}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n,l=r(a(25)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(1484)),i=r(a(1194));function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var d=(0,r(a(961)).default)(["bell-off-duotone"])(n=function(e){(0,u.default)(a,e);var t=f(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).icon="bell-off-duotone",e.component=s.default,e}return a}(i.default))||n;t.default=d},function(e,t,a){e.exports={wrapper:"nRjz2FNzAh6uTBQ6oqXxD",formContainer:"JFXBI5AS30nGS_OLEcxq8"}},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(837),r(202),r(70),r(88),r(20),r(194),r(4),r(18),r(11),r(73),r(46),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=n(r(31)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37));r(32),r(837),r(202),r(70),r(88),r(20),r(27),r(194),r(29),r(4),r(18),r(43),r(11),r(73),r(46);var d,p=l(r(0)),m=r(189),h=n(r(5)),v=r(243),E=n(r(203)),y=n(r(3022));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var b=[{label:t("MONDAY"),value:1},{label:t("TUESDAY"),value:2},{label:t("WEDNESDAY"),value:3},{label:t("THURSDAY"),value:4},{label:t("FRIDAY"),value:5},{label:t("SATURDAY"),value:6},{label:t("SUNDAY"),value:0}],S=new Array(31).fill(1).map((function(e,t){return{label:t+1,value:t+1}})),_=(0,v.observer)(d=function(e){(0,s.default)(a,e);var t=g(a);function a(e){var r,n,l;return(0,o.default)(this,a),(l=t.call(this,e)).handleClick=function(e){var t=l.props,a=t.onChange,r=t.multi,n=void 0!==r&&r,u=l.state.value;if(n){var o=u.indexOf(e);o>-1?u.splice(o,1):u.push(e)}else u=[e];l.setState({value:u}),a&&a(u)},l.state={value:Array.from(null!==(r=null!==(n=e.value)&&void 0!==n?n:e.defaultValue)&&void 0!==r?r:[])},l}return(0,c.default)(a,[{key:"render",value:function(){var e=this,t=this.props.type,a=this.state.value,r="zh"===(0,E.default)("lang")?"zh":"en";return p.createElement("div",{className:y.default.wrapper},this.options.map((function(n,l){var o;return p.createElement(m.Button,{className:(0,h.default)(y.default.item,(o={},(0,u.default)(o,y.default.week,"week"===t),(0,u.default)(o,y.default.month,"month"===t),(0,u.default)(o,y.default.enButton,"week"===t&&"zh"!==r),o)),key:l,type:a.includes(n.value)?"control":"default",onClick:function(){return e.handleClick(n.value,n)}},n.label)})))}},{key:"options",get:function(){return"week"===this.props.type?b:S}}]),a}(p.Component))||d;a.default=_},function(e,t,a){e.exports={wrapper:"XZmcIRClmVHOLPXRuiFvg",item:"_3ATYh4oZAXiPyvZAhRjEDk",week:"_3kEoABe-m2t4ezm2s2pI5T",month:"xK5ma088M1lwXtXU4OmtS",enButton:"vD2nGEp1TRRzYsLcbY6qn"}},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);a(837),a(20),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(837),a(20),a(29),a(4),a(18),a(43),a(11);var l=n(a(31)),u=n(a(25)),o=n(a(28)),c=n(a(41)),s=n(a(42)),i=n(a(37)),f=r(a(0)),d=a(189),p=n(a(811)),m=n(a(3024));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(a,e);var t=h(a);function a(e){var r;(0,u.default)(this,a),(r=t.call(this,e)).handleChange=function(e,t){var a=r.state,n=a.startTime,u=a.endTime,o=r.props.onChange,c=(0,l.default)({startTime:n,endTime:u},e,t);r.setState((0,l.default)({},e,t)),o([c.startTime,c.endTime])},r.renderTimePicker=function(){var e=r.state,t=e.startTime,a=e.endTime;return f.createElement("div",{className:m.default.wrapper},f.createElement(d.Select,{value:t,defaultValue:t,onChange:function(e){return r.handleChange("startTime",e)},options:new Array(24).fill(0).map((function(e,t){return{value:3600*t,label:t<10?"0".concat(t):t}})),clearable:!0,searchable:!1}),f.createElement("span",null,"–"),f.createElement(d.Select,{value:a,defaultValue:a,onChange:function(e){return r.handleChange("endTime",e)},options:new Array(24).fill(0).map((function(e,t){return{value:3600*(t+1),label:t<10?"0".concat(t):t}})),clearable:!0}))},r.renderDatePicker=function(){var e=r.state,t=e.startTime,a=e.endTime;return f.createElement("div",{className:m.default.wrapper},f.createElement(d.DatePicker,{value:t,dateFormat:"Y-m-d H:i:S",onChange:function(e){r.handleChange("startTime",e[0])},enableTime:!0}),f.createElement("span",null,"–"),f.createElement(d.DatePicker,{value:a,dateFormat:"Y-m-d H:i:S",enableTime:!0,onChange:function(e){return r.handleChange("endTime",e[0])}}))};var n=r.props.value,o=void 0===n?[]:n;return r.state={startTime:o[0],endTime:o[1],value:e.value},r}return(0,o.default)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props.value,a=void 0===t?[]:t;(0,p.default)(a,e.value)||(0,p.default)(a,this.state.value)||this.setState({value:a,startTime:a[0],endTime:a[1]})}},{key:"render",value:function(){return"date"===this.props.type?this.renderDatePicker():this.renderTimePicker()}}]),a}(f.Component);t.default=v},function(e,t,a){e.exports={wrapper:"_4Y7QthNjz2h_QCRixWaez",timePicker:"SHh3pyqg08gPiDs1JiP-M",timeInput:"_2wG89BS0l6_fko0YVgH8Z_","is-hover":"_1eWtLiVXH-tZu8fDt6fJXb",isActive:"mMgB1a9fIAeuK9eW5RJzW",timeCloseIcon:"_2P4r9gVOJ3w0jmfDdmrJBk",timeIcon:"r-3lMVm-uygWaJSTU0vAZ",timeContent:"_3LLguW1J-JK5vSqztTVUTA",timeHeader:"_2I64-AObhngFrgHBvlp6Id",timeFields:"_2NnH5NwINte5FTsKIuUeOo",timeItem:"_2Yur1ll1Q_y3B920FlFkmN","is-active":"_1sq9NsV9C-tPDYXqK2XLHE","is-disabled":"_2DmTgBUO1uNvtla6uVTGBS",timeFooter:"_1QgYbx8f-Wrbfso_5wbKM-"}},function(e,t,a){e.exports={wrapper:"_5T9cqusVddZlw43e51Xmi",title:"_d3S2TlF7MtT9KW6k66qi"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n,l=r(a(25)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(1486)),i=r(a(1194));function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var d=(0,r(a(961)).default)(["bell-off-duotone"])(n=function(e){(0,u.default)(a,e);var t=f(a);function a(){var e;(0,l.default)(this,a);for(var r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];return(e=t.call.apply(t,[this].concat(n))).icon="bell-off-duotone",e.component=s.default,e}return a}(i.default))||n;t.default=d},function(e,t,a){e.exports={wrapper:"_2xsRF0uqYI17afilpJikSd",conditionContainer:"GBgAhhcFW1TBk9fXuLF-S",annotation:"bNRABKj08s3pTnTK2WRpy",desc:"Y44MOnEy8CKRM3mejdICW"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(56),l=r(a(1485)),u=r(a(1486)),o=r(a(1484)),c=[{title:"BASIC_INFORMATION",component:(0,n.withProps)(l.default,{maxNameLength:63}),required:!0,icon:"cdn"},{title:"SILENCE_CONDITIONS",component:u.default,required:!0,icon:"volume-off-duotone"},{title:"SILENCE_TIME",component:o.default,required:!0,icon:"volume-off-duotone"}];t.default=c},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(26)),i=n(r(68)),f=n(r(163)),d=n(r(1487)),p=n(r(191)),m=n(r(798)),h=n(r(819)),v=n(r(822)),E=n(r(3030)),y=n(r(1488)),g=n(r(3037)),b=n(r(3039)),S=r(61),_=n(r(438)),O=n(r(864)),C=n(r(3041)),T=n(r(3047));function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k={"storageclass.create":{on:function(e){var a=e.store,r=e.cluster,n=e.module,l=e.success,u=(0,c.default)(e,["store","cluster","module","success"]),f=S.MODULE_KIND_MAP[n],d=(0,o.default)({},f,_.default[n]({})),v=m.default.open(D({onOk:function(e){var u=(0,s.default)(e,f);u&&((0,s.default)(u,'metadata.labels["storage.kubesphere.io/storagetype"]')||(0,i.default)(u,'metadata.labels["storage.kubesphere.io/storagetype"]',"Undefined"),a.createAlongWithSnapshotClasses(u,{cluster:r}).then((function(){m.default.close(v),p.default.success({content:t("CREATE_SUCCESSFUL")}),l&&l(),O.default.delete("".concat(n,"_create_form"))})))},module:n,cluster:r,name:f,steps:C.default,formTemplate:d,modal:h.default,store:a},u))}},"torageclass.update":{on:function(e){var a=e.store,r=(e.cluster,e.detail),n=e.success,l=(0,c.default)(e,["store","cluster","detail","success"]),u=(0,s.default)(a,"module",""),o=m.default.open(D({onOk:function(e){var l="workspace"===u?null:e;a.patch(r,l).then((function(){m.default.close(o),p.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()}))},detail:r,modal:T.default,store:a},l))}},"storageclass.set.default":{on:function(e){var t,a=e.store,r=e.cluster,n=e.detail,o=e.defaultStorageClass,s=e.success,i=(0,c.default)(e,["store","cluster","detail","defaultStorageClass","success"]),f=m.default.open(D({onOk:(t=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=3;break}return e.next=3,a.patch({name:o,cluster:r},{metadata:{annotations:{"storageclass.kubernetes.io/is-default-class":"false","storageclass.beta.kubernetes.io/is-default-class":"false"}}});case 3:return e.next=5,a.patch(n,{metadata:{annotations:{"storageclass.kubernetes.io/is-default-class":"true","storageclass.beta.kubernetes.io/is-default-class":"true"}}});case 5:m.default.close(f),s&&s();case 7:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),cluster:r,modal:E.default,store:a},i))}},"storageclass.volume.function.update":{on:function(e){var a,r=e.cluster,n=e.store,o=e.detail,s=e.StorageClassStore,h=e.success,v=(0,c.default)(e,["cluster","store","detail","StorageClassStore","success"]),E=m.default.open(D({onOk:(a=(0,u.default)(l.default.mark((function e(a){var r,u,c,s;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},u=a.allowClone,c=a.allowSnapshot,s=a.allowVolumeExpansion,(0,f.default)(u)||(0,i.default)(r,'metadata.annotations["storageclass.kubesphere.io/allow-clone"]',String(u)),(0,f.default)(c)||(0,i.default)(r,'metadata.annotations["storageclass.kubesphere.io/allow-snapshot"]',String(c)),(0,f.default)(s)||(0,i.default)(r,"allowVolumeExpansion",(0,d.default)(s)?s:JSON.parse(s)),e.next=7,n.patch(o,r);case 7:return e.next=9,n.fetchDetail({name:o.name,cluster:o.cluster});case 9:p.default.success({content:t("UPDATE_SUCCESSFUL")}),m.default.close(E),h&&h();case 12:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),cluster:r,store:n,modal:g.default,StorageClassStore:s,detail:o},v))}},"storageclass.pvc.autoresizer":{on:function(e){var a,r=e.store,n=e.cluster,o=e.detail,s=e.success,f=(0,c.default)(e,["store","cluster","detail","success"]),d=m.default.open(D({onOk:(a=(0,u.default)(l.default.mark((function e(a){var n;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o._originData,(0,i.default)(n,"metadata.annotations",D(D({},n.metadata.annotations),a)),e.next=4,r.patch(o,n);case 4:return e.next=6,r.fetchDetail({name:o.name,cluster:o.cluster});case 6:p.default.success({content:t("UPDATE_SUCCESSFUL")}),m.default.close(d),s&&s();case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),cluster:n,store:r,formData:o._originData,modal:y.default},f))}},"storageclass.accessor":{on:function(e){var a,r=e.cluster,n=e.store,o=e.detail,c=e.storageClassName,s=e.success,i=e.shouldAddCrd,f=m.default.open({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.default.close(f),e.next=3,n.update({cluster:r,name:a.metadata.name},a);case 3:p.default.success({content:t("UPDATE_SUCCESSFUL")}),s&&s();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),storageClassName:c,cluster:r,store:n,detail:o,shouldAddCrd:i,modal:b.default})}},"storageclass.batch.delete":{on:function(e){var a,r=e.store,n=e.success,o=e.rowKey,s=void 0===o?"name":o,i=e.accessorStore,f=e.cluster,d=(0,c.default)(e,["store","success","rowKey","accessorStore","cluster"]),h=r.list,E=h.data,y=h.selectedRowKeys,g=E.filter((function(e){return y.includes(e[s])})).map((function(e){return{name:e.name,namespace:e.namespace}})).map((function(e){return e.name})),b=m.default.open(D({onOk:(a=(0,u.default)(l.default.mark((function e(){var a,u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],u=[],g.forEach((function(e){a.push(i.silentPatch({cluster:f,name:"".concat(e,"-accessor")},{spec:{storageClassName:"".concat(e,"-accessor-disabled")}})),u.push(r.delete({cluster:f,name:e}))})),e.next=5,Promise.all([].concat(a,u));case 5:m.default.close(b),p.default.success({content:t("DELETED_SUCCESSFULLY")}),r.setSelectRowKeys([]),n&&n();case 9:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),resource:g.join(", "),type:"STORAGE_CLASS",modal:v.default,store:r,desc:t.html("STORAGE_CLASS_DELETE_DESC_PL",{type:t("STORAGE_CLASS_LOW"),resource:g.join(", ")})},d))}},"storageclass.delete":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,s=e.accessorStore,i=e.cluster,f=(0,c.default)(e,["store","detail","success","accessorStore","cluster"]),d=m.default.open(D({onOk:(a=(0,u.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.silentPatch({cluster:i,name:"".concat(n.name,"-accessor")},{spec:{storageClassName:"".concat(n.name,"-accessor-disabled")}});case 2:r.delete(n).then((function(){m.default.close(d),p.default.success({content:t("DELETED_SUCCESSFULLY")}),o&&o()}));case 3:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),store:r,modal:v.default,resource:n.name,desc:t("STORAGE_CLASS_DELETE_DESC")},f))}}};a.default=k},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798)),m=n(r(3031));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.onOk,l=e.isSubmitting;return i.default.createElement(p.default,{width:520,onOk:n,onCancel:r,visible:a,okText:t("OK"),cancelText:t("CANCEL"),isSubmitting:l,hideHeader:!0},i.default.createElement("div",{className:m.default.body},i.default.createElement("div",{className:"h5"},i.default.createElement(d.Icon,{name:"information",color:{primary:"#ffffff",secondary:"#41b1ea"},size:18}),"  ",t("SET_DEFAULT_STORAGE_CLASS_TITLE")),i.default.createElement("p",null,t("STORAGE_CLASS_SET_DEFAULT_DESC"))))}}]),r}(i.default.Component);a.default=v,v.propTypes={visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},v.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={body:"LVUIJ9uwpeVUggtH-Ho5b"}},function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(28)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(0)),i=r(a(1)),f=a(189),d=r(a(805)),p=r(a(3033));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var h=function(e){(0,u.default)(a,e);var t=m(a);function a(e){var r;return(0,n.default)(this,a),(r=t.call(this,e)).handleSliderChange=function(e){r.setState({size:e},(function(){r.props.onChange(e)}))},r.inputChange=function(e){r.setState({size:e},(function(){r.props.onChange(e)}))},r.state={size:e.size},r}return(0,l.default)(a,[{key:"render",value:function(){var e=this.props,t=e.max,a=e.min,r=e.unit,n=e.marks,l=this.state.size;return s.default.createElement("div",{className:p.default.wrapper},s.default.createElement(f.Slider,{value:l,max:t,min:a,marks:n,unit:r,onChange:this.handleSliderChange}),s.default.createElement("div",{className:p.default.inputBox},s.default.createElement(d.default,{className:p.default.input,value:l,max:t,min:a,onChange:this.inputChange}),s.default.createElement("span",{className:p.default.unit},r)))}}]),a}(s.default.Component);t.default=h,h.propTypes={size:i.default.number,max:i.default.number,min:i.default.number,unit:i.default.string,onChange:i.default.func},h.defaultProps={size:10,max:2048,min:0,unit:"Gi",onChange:function(){}}},function(e,t,a){e.exports={wrapper:"_1mvTs5GBM24J0ZC-PZKOqS",inputBox:"_33_mEhm-GlTPmcsAdY4L1N",input:"_2l_4JhXkXDawwXxLZvphsr",unit:"MtGAFnWFj5-7jxF1gChe0"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(4),a(18),a(43),a(11);var n=r(a(25)),l=r(a(28)),u=r(a(41)),o=r(a(42)),c=r(a(37)),s=r(a(0)),i=r(a(1)),f=r(a(914)),d=a(189),p=r(a(805)),m=r(a(3035));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,o.default)(this,a)}}var v=function(e){(0,u.default)(a,e);var t=h(a);function a(e){var r;return(0,n.default)(this,a),(r=t.call(this,e)).handleSelectChange=function(e){var t=r.state.unit;r.props.onChange("".concat((0,f.default)(e)).concat(t))},r.handleInput=function(e){var t=r.state.unit;r.props.onChange("".concat((0,f.default)(e)).concat(t))},r.renderTail=function(){var e=r.props.options,t=r.state.unit;return e.length>1?s.default.createElement(d.Select,{className:m.default.tailSelect,options:e,value:t,defaultValue:t,onChange:r.handleSelectChange}):s.default.createElement("span",{className:m.default.unit},t)},r.state={unit:e.unit,value:e.value},r}return(0,l.default)(a,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.min,r=e.max,n=e.value;return s.default.createElement(s.default.Fragment,null,""!==t&&s.default.createElement("div",{className:m.default.title},t),s.default.createElement("div",{className:m.default.wrapper},s.default.createElement(p.default,{className:m.default.input,min:a,value:n,max:r,onChange:this.handleInput}),this.renderTail()))}}]),a}(s.default.Component);t.default=v,v.propTypes={onChange:i.default.func,options:i.default.array,value:i.default.string,min:i.default.number,max:i.default.number,unit:i.default.string,title:i.default.string},v.defaultProps={options:[],value:"",min:0,title:"",unit:"",onChange:function(){}}},function(e,t,a){e.exports={title:"_3gCzFcF7fcPTu22LltCShA",wrapper:"_20nfJFuMfJpHOHE9YDPewL",input:"vaY31bEaxpZlAVRmVYPix",tailSelect:"_2XbNfOs7f_36Ovqjfw_HK9",unit:"flR4Dw7LDIWhIn8tDx9jF"}},function(e,t,a){e.exports={wrapper:"_199UmNQHyBJS0ebwEpIGw8",text:"_3UfJ52LH7FrU0bLw8j0O95",switch:"_2fHHkpPHo-8wuOAbtg_-fy",settings:"_2whYmFUOtrDqPfsDr3UVMW",title:"_1fTGAl2lYYfATlfTHgdLWr",container:"_3Q1kslT3zayxpY8R7UfqIL",limit:"_2P6eNTXyz8rvKC5lg8NgeP",checkItem:"_14y0ciRr89j7e_M0WYMQ9w",des:"uDVdwpV_vBYrKbce_FYfE",group:"_44T5XYn5HzVMT8x5tJZXT"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(20),r(29),r(9),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=n(r(1)),h=r(189),v=n(r(798)),E=n(r(26)),y=n(r(163)),g=n(r(142)),b=r(243),S=n(r(3038));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var O=(0,b.observer)((o=u=function(e){(0,i.default)(r,e);var a=_(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state=e.getState,e.dataUndefined=function(e){return!(0,y.default)(e)&&((0,g.default)(e)?JSON.parse(e):e)},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this,a=this.props,r=a.visible,n=a.onCancel,l=a.onOk,u=a.isSubmitting;return p.default.createElement(v.default,{width:600,onOk:function(){return l(e.state)},onCancel:n,visible:r,title:t("SET_VOLUME_OPERATIONS"),icon:"slider",okText:t("OK"),cancelText:t("CANCEL"),isSubmitting:u},p.default.createElement(h.Alert,{type:"warning",className:"margin-b12",message:t.html("SET_VOLUME_OPERATIONS_TIP")}),p.default.createElement("div",{className:S.default.body},this.Items.map((function(t){var a=e.state[t.key],r=e.dataUndefined(a);return p.default.createElement("div",{className:S.default.Item,key:t.title},p.default.createElement("div",{className:S.default.icon},p.default.createElement(h.Toggle,{checked:r,disabled:(0,y.default)(a),onChange:function(){return t.onclick(r)}})),p.default.createElement("div",{className:S.default.textBox},p.default.createElement("span",{className:S.default.title},t.title),p.default.createElement("span",{className:S.default.des},t.des)))}))))}},{key:"getState",get:function(){var e=this.props.StorageClassStore,t=this.props.detail||e.detail;return{allowClone:(0,E.default)(t.annotations,"storageclass.kubesphere.io/allow-clone",void 0),allowSnapshot:(0,E.default)(t.annotations,"storageclass.kubesphere.io/allow-snapshot",void 0),allowVolumeExpansion:(0,E.default)(t,"allowVolumeExpansion",void 0)}}},{key:"onOkState",get:function(){return{allowClone:this.dataUndefined(this.state.allowClone),allowSnapshot:this.dataUndefined(this.state.allowSnapshot),allowVolumeExpansion:this.dataUndefined(this.state.allowVolumeExpansion)}}},{key:"Items",get:function(){var e=this;return[{title:t("VOLUME_CLONING"),des:t("VOLUME_CLONING_DESC"),key:"allowClone",onclick:function(t){return e.setState({allowClone:!t})}},{title:t("VOLUME_SNAPSHOT_CREATION"),des:t("VOLUME_SNAPSHOT_CREATION_DESC"),key:"allowSnapshot",onclick:function(t){return e.setState({allowSnapshot:!t})},hide:!globals.app.hasKSModule("storage-utils")},{title:t("VOLUME_EXPANSION"),des:t("VOLUME_EXPANSION_DESC"),key:"allowVolumeExpansion",onclick:function(t){return e.setState({allowVolumeExpansion:!t})}}].filter((function(e){return!e.hide}))}}]),r}(p.default.Component),u.propTypes={visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool},u.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},l=o))||l;a.default=O},function(e,t,a){e.exports={body:"_3QyHHg0hisjmcupBh_NvhW",Item:"SRjS5KHQZAgS4V27u_ywn",icon:"_15bRbSgLaZbaSnNzE8iSVC",textBox:"_3kTj8hcDzdP92R5Vjckb4u",title:"_4VY2gXWgMHU_XuA_Ke883",des:"j_xFi_rwmR4ZLJD46Ivr_"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(70),r(36),r(20),r(14),r(4),r(21),r(18),r(11),r(73),r(46),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(70),r(36),r(20),r(29),r(14),r(4),r(21),r(18),r(43),r(11),r(73),r(46),r(40);var u=l(r(97)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=r(189),p=l(r(798)),m=l(r(858)),h=l(r(800)),v=l(r(119)),E=l(r(26)),y=l(r(68)),g=l(r(1)),b=n(r(0)),S=l(r(441)),_=l(r(443)),O=r(56),C=l(r(3040));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var R=function(e){(0,s.default)(r,e);var a=T(r);function r(e){var t;return(0,o.default)(this,r),(t=a.call(this,e)).workspaceStore=new _.default,t.namespaceStore=new S.default,t.fetchData=function(){var e=t.props.cluster;Promise.all([t.workspaceStore.fetchClusterVisibilityList({cluster:e,limit:-1}),t.namespaceStore.fetchList({cluster:e,limit:-1})]).then((function(e){var a=(0,u.default)(e,2),r=a[0],n=a[1],l=r.map((function(e){return e.name})),o=n.map((function(e){return e.name}));t.setState({workspace:l,namespace:o})}))},t.handleNsChange=function(e){t.setState({nsValues:e})},t.handleWsChange=function(e){t.setState({wsValues:e})},t.handleEnable=function(){t.setState({enabled:!t.state.enabled})},t.expression=function(e){return{fieldExpressions:[{field:"Name",operator:"In",values:e}]}},t.handleOk=function(){var e,a,r=t.props,n=r.onOk,l=r.storageClassName,u=t.state,o=u.enabled,c=u.nsValues,s=u.wsValues,i=u.newObject,f=u.nsOpt,d=u.wsOpt,p=(0,E.default)(i.spec,"namespaceSelector.fieldSelector",[t.expression([])]),m=(0,E.default)(i.spec,"workspaceSelector.fieldSelector",[t.expression([])]),h=o?l:"".concat(l,"-disabled");((0,y.default)(i.spec,"storageClassName",h),(0,y.default)(p[0],"fieldExpressions[0].values",c),(0,y.default)(p[0],"fieldExpressions[0].operator",f),(0,y.default)(m[0],"fieldExpressions[0].values",s),(0,y.default)(m[0],"fieldExpressions[0].operator",d),(0,y.default)(i.spec,"namespaceSelector.fieldSelector",p),(0,y.default)(i.spec,"workspaceSelector.fieldSelector",m),0===c.length)&&(null==i||(null===(e=i.spec)||void 0===e||delete e.namespaceSelector));0===s.length&&(null==i||(null===(a=i.spec)||void 0===a||delete a.workspaceSelector));n(i)},t.handleNsOptChange=function(e){t.setState({nsOpt:e})},t.handleWsOptChange=function(e){t.setState({wsOpt:e})},t.state={newObject:(0,v.default)(e.detail),enabled:!(0,E.default)(e.detail.spec,"storageClassName","").includes("disabled"),workspace:[],namespace:[],nsOpt:(0,E.default)(e.detail,"spec.namespaceSelector.fieldSelector[0].fieldExpressions[0].operator","In"),wsOpt:(0,E.default)(e.detail,"spec.workspaceSelector.fieldSelector[0].fieldExpressions[0].operator","In"),nsValues:(0,E.default)(e.detail,"spec.namespaceSelector.fieldSelector[0].fieldExpressions[0].values",[]),wsValues:(0,E.default)(e.detail,"spec.workspaceSelector.fieldSelector[0].fieldExpressions[0].values",[])},t}return(0,c.default)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=e.shouldAddCrd,u=this.state,o=u.enabled,c=u.nsValues,s=u.wsValues,i=u.nsOpt,f=u.wsOpt;return b.default.createElement(p.default,{width:960,onOk:this.handleOk,onCancel:r,visible:a,title:t("SET_AUTHORIZATION_RULES"),okText:t("OK"),cancelText:t("CANCEL"),isSubmitting:n,hideFooter:l},l&&b.default.createElement(d.Alert,{type:"warning",message:(0,O.htmlLinkControl)(t.html("AUTHORIZATION_NOT_SUPPORT"))}),b.default.createElement("div",{className:C.default.wrapper},b.default.createElement(h.default,{className:C.default.text,icon:function(){return b.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/storageclass-tree.svg",style:{width:"40px",marginRight:"16px"}})},title:t("AUTHORIZATION_RULES"),description:t("AUTHORIZATION_RULES_DESC")}),b.default.createElement(m.default,{className:C.default.switch,text:o?t("ENABLED"):t("DISABLED"),checked:o,onChange:this.handleEnable})),b.default.createElement("div",{className:C.default.selectBox},b.default.createElement("div",{className:C.default.line},b.default.createElement(d.Select,{className:C.default.labelSelect,options:[{label:t("PROJECT"),value:"namespace"}],defaultValue:"namespace",disabled:!0}),b.default.createElement(d.Select,{className:C.default.operator,options:this.operatorOptions,onChange:this.handleNsOptChange,value:i}),b.default.createElement(d.Select,{multi:!0,className:C.default.labelSelect,options:this.namespaceOptions,onChange:this.handleNsChange,value:c})),b.default.createElement("div",{className:C.default.line},b.default.createElement(d.Select,{className:C.default.labelSelect,options:[{label:t("WORKSPACE"),value:"workspace"}],defaultValue:"workspace",disabled:!0}),b.default.createElement(d.Select,{className:C.default.operator,options:this.operatorOptions,onChange:this.handleWsOptChange,value:f}),b.default.createElement(d.Select,{multi:!0,className:C.default.labelSelect,options:this.workspaceOptions,onChange:this.handleWsChange,value:s}))))}},{key:"namespaceOptions",get:function(){var e=this.state.namespace,t=this.props.cluster;return e.map((function(e){return{label:(0,O.showNameAndAlias)(e,"project",t),value:e}}))}},{key:"workspaceOptions",get:function(){return this.state.workspace.map((function(e){return{label:(0,O.showNameAndAlias)(e,"workspace"),value:e}}))}},{key:"operatorOptions",get:function(){return[{label:t("OPERATOR_IN"),value:"In"},{label:t("OPERATOR_NOT_IN"),value:"NotIn"}]}}]),r}(b.Component);a.default=R,R.propTypes={visible:g.default.bool,onOk:g.default.func,onCancel:g.default.func,isSubmitting:g.default.bool},R.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={wrapper:"_3D_cTNGP8MQC4Uc5eHhLZA",text:"_2GwAeg4xLWT1Ao1HBA2aT",switch:"_1IAyFA7w5XmghrEXWgouQd",selectBox:"_1ksKSMg9kux_MBU1RZ-fq0",line:"HK72SgA9yU7peLgeKlWEO",labelSelect:"FZVIiDuWKdDJRqouL39O0",operator:"tmura1FWwKDbtn1CR9CU4"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1489)),l=r(a(3042)),u=r(a(3044)),o=[{title:"BASIC_INFORMATION",component:n.default,required:!0},{title:"STORAGE_SYSTEM",component:l.default,required:!0},{title:"STORAGE_CLASS_SETTINGS",component:u.default,required:!0}];t.default=o},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(44),r(20),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(44),r(20),r(29),r(9),r(4),r(18),r(43),r(11);var l=n(r(58)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=n(r(68)),m=n(r(140)),h=n(r(67)),v=r(189),E=n(r(1423)),y=r(61),g=r(56),b=n(r(3043));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=function(e){(0,c.default)(r,e);var a=S(r);function r(e){var n;if((0,u.default)(this,r),(n=a.call(this,e)).provisionersOptions=[].concat((0,l.default)(y.PROVISIONERS.map((function(e){return(0,m.default)(e,["description"])}))),[{label:t("CUSTOM"),value:"",icon:"hammer"}]),n.getDefaultModes=function(e){var a=y.PROVISIONERS.find((function(t){return t.value===e}))||{};return((0,h.default)(a.access_modes)?Object.keys(y.ACCESS_MODES):a.access_modes).map((function(e){return{label:t(e),value:e}})).map((function(e){return e.value}))},n.changeProvisioner=function(e){n.setState({provisioner:e},n.updateParams)},n.formTemplate.provisioner||(n.formTemplate.provisioner=y.PROVISIONERS[0].value,(0,p.default)(n.formTemplate,"metadata.annotations['kubesphere.io/provisioner']",n.formTemplate.provisioner)),n.formTemplate.provisioner){var o=n.getDefaultModes(n.formTemplate.provisioner);(0,p.default)(n.formTemplate,"metadata.annotations['storageclass.kubesphere.io/supported-access-modes']",o)}return n.state={provisioner:n.formTemplate.provisioner},n}return(0,o.default)(r,[{key:"updateParams",value:function(){var e=this.getDefaultModes(this.state.provisioner);this.formTemplate.provisioner=this.state.provisioner,this.formTemplate.metadata.annotations["storageclass.kubesphere.io/supported-access-modes"]=e,this.formTemplate.parameters={}}},{key:"render",value:function(){var e=this.props.formRef,a=this.state.provisioner,r=(y.PROVISIONERS.find((function(e){return e.value===a}))||{}).description,n=t(r);return f.default.createElement(v.Form,{data:this.formTemplate,ref:e},f.default.createElement(v.Form.Item,{label:f.default.createElement("div",{className:b.default.provisioner},f.default.createElement("h3",null,t("CHOOSE_STORAGE_SYSTEM_TIP")),f.default.createElement("p",null,t("PROVISIONER_DEPENDENCE_DESC")))},f.default.createElement(E.default,{onChange:this.changeProvisioner,name:"metadata.annotations['kubesphere.io/provisioner']",options:this.provisionersOptions})),f.default.createElement("p",{className:b.default.description,dangerouslySetInnerHTML:{__html:(0,g.hrefControl)(n)}}))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,y.MODULE_KIND_MAP[a],t)}}]),r}(f.default.Component);a.default=_},function(e,t,a){e.exports={provisioner:"XUh3rWXYiPF6kf28wKkXk",description:"_1ntIXDpZx7uRHczOv_FkZd"}},function(e,a,r){"use strict";r(16);var n=r(19);r(192),r(10),r(44),r(20),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(192),r(10),r(44),r(20),r(27),r(29),r(9),r(4),r(18),r(43),r(30),r(195),r(11);var l=n(r(317)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(26)),d=n(r(140)),p=n(r(67)),m=n(r(0)),h=r(189),v=n(r(829)),E=n(r(3045)),y=r(61);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var b={input:E.default,select:h.Select},S={maxsize:"GiB",stepsize:"GiB",minsize:"GiB"},_=function(e){(0,c.default)(r,e);var a=g(r);function r(e){var t;return(0,u.default)(this,r),(t=a.call(this,e)).isCustomizedProvision=y.PROVISIONERS.every((function(e){return e.value!==t.provisionerValue})),t}return(0,o.default)(r,[{key:"getRules",value:function(e){return this.validators.filter((function(t){return t._key===e})).map((function(e){return(0,d.default)(e,"_key")}))}},{key:"getAccessModesOptions",value:function(){var e=this,a=y.PROVISIONERS.find((function(t){return t.value===e.provisionerValue}))||{};return((0,p.default)(a.access_modes)?Object.keys(y.ACCESS_MODES):a.access_modes).map((function(e){return{label:t(e),value:e}}))}},{key:"renderCustom",value:function(){return m.default.createElement(h.Form.Item,{label:t("PARAMETERS")},m.default.createElement(v.default,{name:"parameters",addText:t("ADD")}))}},{key:"renderParams",value:function(){var e=this,a=y.PROVISIONERS.find((function(t){return t.value===e.provisionerValue}));if((0,p.default)(a)||(0,p.default)(a.params))return this.renderCustom();for(var r=[],n=0;n<a.params.length;n+=2){var u,o,c=a.params[n]||{},s=a.params[n+1]||{},i=c.options?c.options.map((function(e){return{label:t(e.label),value:e.value}})):[],v=b[c.type],E=(0,f.default)(b,s.type||"");r.push(m.default.createElement(h.Columns,{key:n},m.default.createElement(h.Column,null,m.default.createElement(h.Form.Item,{label:t(c.key.toUpperCase()),desc:t(c.desc.toUpperCase()),rules:this.getRules(c._key)},m.default.createElement(v,(0,l.default)({name:"parameters.".concat(c._key||c.key.toLowerCase())},(0,d.default)(c,["type","key","desc","placeholder","options"]),{unit:null!==(u=S[c.key.toLowerCase()])&&void 0!==u?u:null,options:i,placeholder:t(c.placeholder)})))),s.type&&m.default.createElement(h.Column,null,m.default.createElement(h.Form.Item,{label:t(s.key.toUpperCase()),desc:t(s.desc.toUpperCase()),rules:this.getRules(s._key)},m.default.createElement(E,(0,l.default)({name:"parameters.".concat(s._key||s.key.toLowerCase()),unit:null!==(o=S[s.key.toLowerCase()])&&void 0!==o?o:null},(0,d.default)(s,["type","key","desc"])))))))}return r}},{key:"render",value:function(){var e=this.props.formRef,a=this.getAccessModesOptions(),r=a.map((function(e){return e.value}));return m.default.createElement("div",null,m.default.createElement(h.Form,{data:this.formTemplate,ref:e},m.default.createElement(h.Columns,null,m.default.createElement(h.Column,null,m.default.createElement(h.Form.Item,{label:t("VOLUME_EXPANSION")},m.default.createElement(h.Select,{name:"allowVolumeExpansion",options:[{label:t("YES"),value:"true"},{label:t("NO"),value:"false"}]}))),m.default.createElement(h.Column,null,m.default.createElement(h.Form.Item,{label:t("RECLAIM_POLICY")},m.default.createElement(h.Select,{name:"reclaimPolicy",defaultValue:"Delete",options:this.options})))),m.default.createElement(h.Columns,null,m.default.createElement(h.Column,null,m.default.createElement(h.Form.Item,{label:t("ACCESS_MODE"),desc:t("ACCESS_MODES_DESC")},m.default.createElement(h.Select,{name:"metadata.annotations['storageclass.kubesphere.io/supported-access-modes']",options:a,defaultValue:r,multi:!0}))),m.default.createElement(h.Column,null,m.default.createElement(h.Form.Item,{rules:[{required:!0,message:t("PARAM_REQUIRED")}],label:t("PROVISIONER")},m.default.createElement(h.Input,{name:"provisioner"})))),m.default.createElement(h.Columns,null,m.default.createElement(h.Column,null,m.default.createElement(h.Form.Item,{label:t("VOLUME_BINDING_MODE")},m.default.createElement(h.Select,{name:"volumeBindingMode",options:this.volumeBindingMode,defaultValue:"WaitForFirstConsumer"}))),m.default.createElement(h.Column,null)),this.renderParams()))}},{key:"provisionerValue",get:function(){return(0,f.default)(this.formTemplate,'metadata.annotations["kubesphere.io/provisioner"]',this.formTemplate.provisioner)}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,f.default)(t,y.MODULE_KIND_MAP[a],t)}},{key:"volumeBindingMode",get:function(){return[{label:t("IMMEDIATE_BINDING"),value:"Immediate"},{label:t("BINDING_WAIT"),value:"WaitForFirstConsumer"}]}},{key:"options",get:function(){return[{label:"Delete",value:"Delete"},{label:"Retain",value:"Retain"}]}},{key:"validators",get:function(){var e=function(e,a,r){return a?/^[0-9]*$/.test(a)?a<2e3||a>2147483647?r({message:t("GID_RANGE_TIP"),field:e.field}):void r():r({message:t("ENTER_POSITIVE_INTEGER_DESC"),field:e.field}):r()};return[{_key:"gidMin",validator:e,checkOnSubmit:!0},{_key:"gidMax",validator:e,checkOnSubmit:!0}]}}]),r}(m.default.Component);a.default=_},function(e,t,a){"use strict";a(16);var r=a(19);a(14),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(14),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(50)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=r(a(1)),p=a(189),m=r(a(3046));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(a,e);var t=h(a);function a(){return(0,u.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.unit,r=e.onChange,u=(0,l.default)(e,["name","unit","onChange"]);return a?f.default.createElement(f.default.Fragment,null,f.default.createElement("div",{className:m.default.wrapper},f.default.createElement(p.Input,(0,n.default)({name:t,className:m.default.input,onChange:r||null},u)),a&&f.default.createElement("span",{className:m.default.unit},a))):f.default.createElement(p.Input,(0,n.default)({name:t,className:m.default.input,onChange:r||null},u))}}]),a}(f.default.Component);t.default=v,v.propTypes={onChange:d.default.func,unit:d.default.string}},function(e,t,a){e.exports={wrapper:"_2kGVdUbWOxTaeyX4b5Z8Q_",input:"qgxKLrXJOh3vbKAcB-CBG",unit:"_2GAL5LSZYi6CYdKZCidXt9"}},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(831)),m=r(189),h=n(r(798));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=function(e){(0,o.default)(r,e);var a=v(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleOk=function(e){var a=t.props,r=a.onOk,n=a.store,l=a.detail,u=n.list,o=(0,d.toJS)(u.selectedRowKeys),c=o?o.filter((function(e){return e!==l.uid})):"";r(e),o&&u.setSelectRowKeys(c)},t.state={formData:(0,p.default)((0,d.toJS)(e.detail._originData||e.detail))},t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,p.default)((0,d.toJS)(this.props.detail._originData||this.props.detail))})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=this.state.formData;return i.default.createElement(h.default.Form,{data:l,width:691,title:t("EDIT_INFORMATION"),icon:"pen",onOk:this.handleOk,okText:t("OK"),onCancel:n,visible:a,isSubmitting:r},i.default.createElement(m.Form.Item,{label:t("NAME")},i.default.createElement(m.Input,{name:"metadata.name",disabled:!0})),i.default.createElement(m.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_DESC")},i.default.createElement(m.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),i.default.createElement(m.Form.Item,{label:t("storageclasses")},i.default.createElement(m.Select,{name:'metadata.labels["storage.kubesphere.io/storagetype"]',options:this.options,clearable:!0})),i.default.createElement(m.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},i.default.createElement(m.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))}},{key:"options",get:function(){return[{value:"BlockStorage",label:t("BLOCK_STORAGE")},{value:"ObjectStorage",label:t("OBJECT_STORAGE")},{value:"FileStorage",label:t("FILE_STORAGE")},{value:"Undefined",label:t("UNCLASSIFIED")}]}}]),r}(i.default.Component);a.default=E,E.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},E.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(0)),c=r(189),s=n(r(798)),i=n(r(3049)),f=n(r(3134)),d=n(r(3144)),p=n(r(1507)),m=n(r(1511)),h=n(r(1512));function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={"toolbox.logquery":{on:function(e){e.store;var a=(0,u.default)(e,["store"]),r=s.default.open(E({onOk:function(){s.default.close(r)},modal:i.default,title:t("CONTAINER_LOG_SEARCH")},a))}},"toolbox.eventsearch":{on:function(e){e.store;var a=(0,u.default)(e,["store"]),r=s.default.open(E({onOk:function(){s.default.close(r)},modal:f.default,title:o.default.createElement("div",null,o.default.createElement(c.Icon,{size:20,name:"thunder",style:{marginRight:7}})," ",o.default.createElement("span",{style:{fontSize:12,fontWeight:600,lineHeight:"20px",height:"20px"}},t("RESOURCE_EVENT_SEARCH")))},a))}},"toolbox.auditingsearch":{on:function(e){e.store;var a=(0,u.default)(e,["store"]),r=s.default.open(E({onOk:function(){s.default.close(r)},modal:d.default,title:o.default.createElement("div",null,o.default.createElement(c.Icon,{size:20,name:"login-servers",style:{marginRight:7}})," ",o.default.createElement("span",{style:{fontSize:12,fontWeight:600,lineHeight:"20px",height:"20px"}},t("AUDIT_LOG_SEARCH")))},a))}},"toolbox.kubectl":{on:function(e){e.store;var t=(0,u.default)(e,["store"]),a=s.default.open(E({onOk:function(){s.default.close(a)},modal:p.default,title:"kubectl"},t))}},"toolbox.kubeconfig":{on:function(e){e.store;var t=(0,u.default)(e,["store"]),a=s.default.open(E({onOk:function(){s.default.close(a)},modal:m.default,title:"kubeconfig"},t))}},"toolbox.bill":{on:function(e){var t=e.store,a=(0,u.default)(e,["store"]),r=s.default.open(E({onOk:function(){s.default.close(r)},modal:h.default,store:t},a))}}};a.default=y},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(20),a(14),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(14),a(8),a(4),a(21),a(18),a(43),a(11);var n=r(a(317)),l=r(a(38));a(35);var u,o,c,s,i=r(a(39)),f=r(a(25)),d=r(a(28)),p=r(a(41)),m=r(a(42)),h=r(a(37)),v=r(a(45)),E=r(a(0)),y=r(a(1)),g=a(243),b=a(17),S=r(a(26)),_=r(a(872)),O=r(a(448)),C=a(3050);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var R=(0,g.observer)((s=c=function(e){(0,p.default)(r,e);var t,a=T(r);function r(){var e,t;(0,f.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).clusters=new O.default,e.formStepState=e.initStepState(),e.searchInputState=((t=(0,b.observable)({query:[],start:"",end:"",step:"",durationAlias:"",nextParamsKey:"",queryMode:1,cluster:""})).setCluster=(0,b.action)((function(e){t.cluster=e})),t),e.detailState=function(){var e=(0,b.observable)({container:"",host:"",log:"",namespace:"",pod:""});return e.setState=(0,b.action)((function(t){(0,_.default)(e,t)})),e}(),e}return(0,d.default)(r,[{key:"initStepState",value:function(){var e=(0,b.observable)({step:0});return e.next=(0,b.action)((function(){e.step+=1})),e.pre=(0,b.action)((function(){e.step-=1})),e}},{key:"componentDidMount",value:(t=(0,i.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clusters.fetchList({limit:-1,ascending:!0});case 2:this.searchInputState.setCluster((0,S.default)(this,"clustersOpts[0].value"));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.Content,t=e.Component,a=e.props;return t?E.default.createElement("div",{style:{height:"calc(100vh - 100px)"}},E.default.createElement(t,(0,n.default)({clustersOpts:this.clustersOpts,formStepState:this.formStepState},a))):null}},{key:"clustersOpts",get:function(){return this.clusters.list.data.map((function(e){var t=e.name;return{value:t,label:t}}))}},{key:"formStepConfig",get:function(){return[{Component:C.Home,props:{searchInputState:this.searchInputState}},{Component:C.Search,props:{searchInputState:this.searchInputState,detailState:this.detailState}},{Component:C.Detail,props:{searchInputState:this.searchInputState,detailState:this.detailState,close:this.props.onCancel}}]}},{key:"Content",get:function(){return this.formStepConfig[this.formStepState.step]||{}}}]),r}(E.default.Component),c.propTypes={onCancel:y.default.func},o=s,(0,v.default)(o.prototype,"clustersOpts",[b.computed],Object.getOwnPropertyDescriptor(o.prototype,"clustersOpts"),o.prototype),u=o))||u;t.default=R},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Home",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Search",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Detail",{enumerable:!0,get:function(){return u.default}});var n=r(a(3051)),l=r(a(3056)),u=r(a(3130))},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(62)),u=n(r(25)),o=n(r(28)),c=n(r(74)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(45));n(r(63));r(32),r(3),r(20),r(442),r(29),r(4),r(18),r(43),r(30),r(11),r(69);var p,m,h,v=n(r(97)),E=n(r(0)),y=r(17),g=r(243),b=n(r(245)),S=n(r(5)),_=r(189),O=n(r(969)),C=n(r(3053)),T=n(r(1490)),R=n(r(971)),D=n(r(3055));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var N=(0,g.observer)((m=function(e){(0,s.default)(r,e);var a=k(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=a.call.apply(a,[this].concat(o))).logStatisticsStore=new C.default,e.histogramStore=new T.default({startTime:Date.now()-432e5,endTime:Date.now(),interval:"30m"}),e.supportQueryParams=[{icon:"magnifier",title:t("SEARCH_BY_KEYWORD"),tips:t("CONTAINER_LOG_KEYWORD_TIP"),key:"log_query"},{icon:"project",title:t("SEARCH_BY_PROJECT"),tips:t("CONTAINER_LOG_PROJECT_TIP"),key:"namespace_query"},{icon:"backup",title:t("SEARCH_BY_WORKLOAD"),tips:t("CONTAINER_LOG_WORKLOAD_TIP"),key:"workload_query"},{icon:"pod",title:t("SEARCH_BY_POD"),tips:t("CONTAINER_LOG_POD_TIP"),key:"pod_query"},{icon:"docker",title:t("SEARCH_BY_CONTAINER"),tips:t("CONTAINER_LOG_CONTAINER_TIP"),key:"container_query"}],e.watchCluster=function(){var t=e.props.searchInputState;e.disposer=(0,y.reaction)((function(){return t.cluster}),(function(t){""!==t&&e.updateStatistics(t)}))},(0,l.default)(e,"selectedDurationParameter",h,(0,c.default)(e)),e.selectedParameter=function(t){e.props.searchInputState.nextParamsKey=t.currentTarget.dataset.query},e.onSearchParamsChange=function(){e.props.formStepState.next()},e.onClusterChange=function(t){e.props.searchInputState.setCluster(t)},e.clusterRenderer=function(e){return t("CLUSTER_VALUE",{value:e.label})},e}return(0,o.default)(r,[{key:"componentDidMount",value:function(){this.watchCluster()}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"updateStatistics",value:function(e){this.logStatisticsStore.fetch({cluster:e}),this.histogramStore.fetch({cluster:e})}},{key:"render",value:function(){return E.default.createElement("div",null,E.default.createElement("div",{className:D.default.pane},this.renderBanner()),E.default.createElement("div",{className:D.default.tips},E.default.createElement("div",{className:D.default.pane},E.default.createElement(_.Loading,{spinning:this.histogramStore.isLoading},E.default.createElement(E.default.Fragment,null,this.renderSearchBar(),E.default.createElement("h3",{className:D.default.rule},t("QUERYING_RULES")),this.renderRecentLogs())),this.renderQueryItems())))}},{key:"renderBanner",value:function(){return E.default.createElement("div",{className:D.default.banner},E.default.createElement("div",{className:D.default.illustration},E.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/log-statistics.svg",alt:"log-statistics"})),E.default.createElement(_.Loading,{spinning:this.logStatisticsStore.isLoading},E.default.createElement("div",{className:D.default.statistics},E.default.createElement("h3",null,t.html("TOTAL_LOGS_TODAY",{containers:this.logStatisticsStore.containersCount,logs:this.logStatisticsStore.logsCount,className:D.default.count})),E.default.createElement("p",null,E.default.createElement(_.Icon,{name:"clock"}),t("START_TIME_VALUE",{value:(0,b.default)(this.logStatisticsStore.startTime).format("YYYY-MM-DD HH:mm:ss")})))))}},{key:"renderSearchBar",value:function(){var e=this.props,a=e.searchInputState,r=e.clustersOpts;return E.default.createElement("div",{className:D.default.searchBarContainer},globals.app.isMultiCluster&&E.default.createElement(_.Select,{className:D.default.clusterSelector,value:a.cluster,options:r,valueRenderer:this.clusterRenderer,onChange:this.onClusterChange}),E.default.createElement(R.default,{className:D.default.searchBar,onChange:this.onSearchParamsChange,params:a,dropDownItems:{log_query:{icon:"magnifier",text:t("KEYWORD")},namespace_query:{icon:"project",text:t("PROJECT")},workload_query:{icon:"backup",text:t("WORKLOAD")},pod_query:{icon:"pod",text:t("POD")},container_query:{icon:"docker",text:t("CONTAINER")}}}))}},{key:"renderRecentLogs",value:function(){return E.default.createElement("div",{className:(0,S.default)(D.default.card,D.default.recent)},E.default.createElement("div",{className:D.default.recentSummary},E.default.createElement("h2",{className:D.default.count},this.histogramStore.logsCount),E.default.createElement("p",null,t("CONTAINER_LOGS_12H"))),E.default.createElement("div",{className:D.default.chart},E.default.createElement(O.default,{xKey:"time",data:(0,y.toJS)(this.histogramStore.histograms),legend:[["count",t("CONTAINER_LOG_COUNT")]],interval:this.histogramStore.interval,onBarClick:this.selectedDurationParameter})))}},{key:"renderQueryItems",value:function(){var e=this;return this.supportQueryParams.map((function(t){return E.default.createElement("div",{className:(0,S.default)(D.default.card,D.default.category),key:t.key,"data-query":t.key,onClick:e.selectedParameter},E.default.createElement("div",{className:D.default.icon},t.iconUrl?E.default.createElement("div",null,E.default.createElement("img",{src:t.iconUrl})):E.default.createElement(_.Icon,{name:t.icon,size:40})),E.default.createElement("div",{className:D.default.desc},E.default.createElement("h4",null,t.title),E.default.createElement("p",null,t.tips)))}))}}]),r}(E.default.Component),h=(0,d.default)(m.prototype,"selectedDurationParameter",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a,r,n,l,u,o=t.time,c=void 0===o?0:o,s=e.histogramStore.interval,i=e.props.searchInputState;i.durationAlias="",i.end=Math.ceil(c/1e3)+(a=s.match(/(\d+)(\w+)/),r=(0,v.default)(a,3),n=r[1],l=void 0===n?0:n,u=r[2],l*{s:1,m:60,h:3600,d:86400}[void 0===u?"s":u]),i.start=Math.ceil(c/1e3),i.step="1m",e.props.formStepState.next()}}}),p=m))||p;a.default=N},function(e,t,a){e.exports={wrapper:"q2bJ9Fc4ogjL_BgwY1Hyx"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(29),a(8),a(4),a(21),a(18),a(43),a(11);var n=r(a(38));a(35);var l,u,o,c,s=r(a(39)),i=r(a(62)),f=r(a(25)),d=r(a(28)),p=r(a(74)),m=r(a(41)),h=r(a(42)),v=r(a(37)),E=r(a(45)),y=(r(a(63)),a(17)),g=r(a(872)),b=r(a(26));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var _=(l=function(e){(0,m.default)(r,e);var t,a=S(r);function r(){var e;(0,f.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=a.call.apply(a,[this].concat(n)),(0,i.default)(e,"logsCount",u,(0,p.default)(e)),(0,i.default)(e,"startTime",o,(0,p.default)(e)),(0,i.default)(e,"namespaces",c,(0,p.default)(e)),e}return(0,d.default)(r,[{key:"fetch",value:(t=(0,s.default)(n.default.mark((function e(){var t,a,r,l,u,o,c,s=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},a=s.length>1?s[1]:void 0,r=new Date((new Date).setHours(0,0,0,0)).getTime(),l=(new Date).getTime(),u={operation:"statistics",start_time:r,end_time:l},o=(0,g.default)(u,t),e.next=9,this.request(o,"get",a);case 9:c=e.sent,this.containersCount=(0,b.default)(c,"statistics.containers",0),this.logsCount=(0,b.default)(c,"statistics.logs",0),this.startTime=r,this.namespaces=(0,b.default)(c,"statistics.namespaces",[])||[];case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleResult",value:function(e){return e}}]),r}(r(a(1195)).default),u=(0,E.default)(l.prototype,"logsCount",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=(0,E.default)(l.prototype,"startTime",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),c=(0,E.default)(l.prototype,"namespaces",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,E.default)(l.prototype,"fetch",[y.action],Object.getOwnPropertyDescriptor(l.prototype,"fetch"),l.prototype),l);t.default=_},function(e,t,a){e.exports={container:"_9S1O5r-gMFTAyyTvA9sMv",customRange:"_2BqYBrIOMJkPL86SU4ibiS",currentParam:"_3i9QkdJ1v3Z_RhND9_jhxB",input:"_3knlp77eQpb5h3x9_brJrc",dropdown:"_32W2hcNHwcqLHylSRb_-1d",dropdownItem:"_1zYu7D7XMgnPQj_cviMH7j",icon:"_18iZ6-QD8yhu2WuwGN6v_R",param:"_3tDB0wRE_DlH-PpkLdtKqh",removeParam:"_2XvI9g_dJmtEwGNcgmHBUn",durationDropdown:"_1DPb6P0nYZPe_y5qrx0OSD"}},function(e,t,a){e.exports={tips:"_1GT_qdXcQqMwqs4fdmzGR3",rule:"cRqPZ_AGuSTA4AXOY08lP",searchBar:"_2YhYKa3lwuBurnOP3Cjh0U",pane:"cOD4mfyo7pc1RctxOlLvj",card:"p9FBwWjFgQ1xMXHax1X3s",count:"_37LGouPZA8H7IdsZHwN2j5",banner:"_3Z5wUKjeTOL8V6zsED-TSu",illustration:"_2Vn-O2H0xzvZ1d-cX3OeAG",statistics:"_2hC4Kwsw_VHnZ2DGcDMAv5",category:"_2pdXo055DfDsFjef58FrhO",icon:"_3zX3KvzK9hvXil7z9WwH0M",desc:"_1ZgIwmJnkzKt2QVxat6c6D",recent:"_3H27V0Txnl5HUAeAEpNIdA",recentSummary:"_27IlxPyLQZxq8UFPRqaK0i",chart:"_14dkUVVhwB9DUaaWX787Fy",searchBarContainer:"fSF-k2IyFBXVBSF4fZccp",clusterSelector:"_26VjJfMUGT6XkqSnSUkqn7"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(199),r(6),r(20),r(87),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(71),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(58)),u=n(r(38));r(35);var o=n(r(39)),c=n(r(31)),s=n(r(62)),i=n(r(25)),f=n(r(28)),d=n(r(74)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(45));n(r(63));r(12),r(32),r(3),r(10),r(199),r(6),r(20),r(27),r(87),r(247),r(442),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(71),r(7),r(110);var E,y,g,b,S,_,O,C,T,R,D=n(r(97)),k=n(r(0)),N=r(243),I=r(17),P=n(r(245)),A=n(r(906)),w=n(r(142)),L=n(r(258)),M=n(r(3057)),x=n(r(1180)),j=n(r(1501)),U=n(r(1490)),F=r(189),V=n(r(1200)),G=r(3128),B=n(r(969)),z=n(r(971)),Y=n(r(3129));function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var W=new x.default,Q=600,J="10s",X=["m","h","d","M","y"],Z=(0,N.observer)((y=function(e){(0,p.default)(h,e);var a,r,n,c,m=K(h);function h(){var e;(0,i.default)(this,h);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=m.call.apply(m,[this].concat(r))).queryStore=new j.default({size:50}),e.histogramStore=new U.default,e.markMemoizee=(0,M.default)(G.markAll,{normalizer:function(e){var t=(0,D.default)(e,3),a=t[0],r=t[1],n=void 0===r?[]:r,l=t[2],u=void 0===l?function(){}:l;return"".concat(a,"+").concat(n.toString(),")+").concat(u.name)},maxAge:3e3}),(0,s.default)(e,"tableCols",g,(0,d.default)(e)),(0,s.default)(e,"logs",b,(0,d.default)(e)),(0,s.default)(e,"loading",S,(0,d.default)(e)),e.state={showHistogram:!0,polling:!1,pollingFrequency:5e3},e.tableRef=k.default.createRef(),e.frequencyOptions=[5,10,15].map((function(e){return{value:1e3*e,label:"".concat(t("TIME_S",{num:e}))}})),e.queryModeOptions=[1,0].map((function(e){return{value:e,label:e?t("EXACT_QUERY"):t("FUZZY_QUERY")}})),(0,s.default)(e,"selectedDurationParameter",_,(0,d.default)(e)),(0,s.default)(e,"onTableScrollTop",O,(0,d.default)(e)),e.onSearchParamsChange=function(){e.stopPolling(),e.fetchHistogram(),e.refreshQuery()},(0,s.default)(e,"toggleHistogram",C,(0,d.default)(e)),(0,s.default)(e,"togglePolling",T,(0,d.default)(e)),e.poll=function(){var t=e.props.searchInputState,a=Q,r=J;t.end=Math.ceil(Date.now()/1e3),t.start=t.end-a,t.step=r,t.durationAlias="".concat(a/60,"m"),e.fetchHistogram(),e.refreshQuery(),e.setState({polling:!0})},(0,s.default)(e,"changeFrequency",R,(0,d.default)(e)),e.changeQueryMode=function(t){e.props.searchInputState.queryMode=t,e.onSearchParamsChange()},e.changeClusterChange=function(t){e.props.searchInputState.setCluster(t),e.onSearchParamsChange()},e.selectLog=function(t){e.props.detailState.setState(q({},t)),e.props.formStepState.next()},e.clusterRenderer=function(e){return t("CLUSTER_VALUE",{value:e.label})},e.renderMoreMenu=function(){var a=q(q({},e.duration),e.getQueryParams()),r=[k.default.createElement(F.Menu.MenuItem,{key:"asc"},k.default.createElement("span",{className:Y.default.menuLinkContent},k.default.createElement("a",{href:e.queryStore.exportLinkFactory(q(q({},a),{},{sort:"asc"})),download:!0},t("ASC_EXPORT")))),k.default.createElement(F.Menu.MenuItem,{key:"desc"},k.default.createElement("span",{className:Y.default.menuLinkContent},k.default.createElement("a",{href:e.queryStore.exportLinkFactory(q(q({},a),{},{sort:"desc"})),download:!0},t("DESC_EXPORT"))," "))];return k.default.createElement(F.Menu,null,r)},e}return(0,f.default)(h,[{key:"getQueryParams",value:function(){var e=this.props.searchInputState,t=e.query,a=e.queryMode,r=e.cluster;return t.filter((function(e){return e.key})).reduce((function(e,t){var r=t.key,n=t.value,l=a?r.replace(/([^(log)]+)_query/,"$1s"):r,u=e[l];return e[l]=u?"".concat(u,",").concat(n):n,e}),{cluster:r})}},{key:"componentDidMount",value:function(){this.fetchHistogram(),this.refreshQuery()}},{key:"componentWillUnmount",value:function(){this.stopPolling(),this.markMemoizee.clear()}},{key:"refreshQuery",value:(c=(0,o.default)(u.default.mark((function e(){var t,a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,this.queryStore.from=0,t=this.getQueryParams(),e.next=5,this.fetchQuery(q(q({},t),this.duration));case 5:a=e.sent,this.loading=!1,this.logs=a.reverse(),this.scrollTo(this.logs.length);case 9:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"fetchQuery",value:(n=(0,o.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryStore.fetch(t);case 2:return e.abrupt("return",this.queryStore.records);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchHistogram",value:function(){var e=this.getQueryParams();this.histogramStore.interval=this.duration.interval,this.histogramStore.fetch(q(q({},e),this.duration))}},{key:"loadMoreLogs",value:(r=(0,o.default)(u.default.mark((function e(){var t,a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.queryStore.from+this.queryStore.size,e.next=3,this.fetchQuery(q(q({},this.queryStore.preParams),{from:t}));case 3:a=e.sent,this.logs=[].concat((0,l.default)(a.reverse()),(0,l.default)(this.logs)),this.scrollTo(a.length);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getNextStepLevel",value:function(e){var t=e.match(/\d+(\w+)$/),a=(0,D.default)(t,2)[1],r=void 0===a?"m":a,n=X.findIndex((function(e){return e===r}));return"1".concat(n<1?X[0]:X[n-1])}},{key:"renderHightLightMatchTd",value:function(e){var t=this,a=e.resKey,r=e.searchKey,n=e.handler,l=void 0===n?G.mark:n;return function(e){var n=e[a]||"",u=t.props.searchInputState.query.filter((function(e){var t=e.key;return e.value&&(0,L.default)(r,t)})).map((function(e){return e.value})),o=t.markMemoizee(n,u,l);return k.default.createElement("span",null,o.map((function(e,t){return(0,w.default)(e)?e:k.default.createElement("span",{key:t,className:Y.default.hightLightMatch},e.hightLighted)})))}}},{key:"renderHightLightMatchLogTd",value:function(e){var t=this,a=e.resKey,r=e.searchKey,n=e.handler,l=void 0===n?G.mark:n;return function(e){var n=W.ansi_to_html(e[a]||""),u=t.props.searchInputState.query.filter((function(e){var t=e.key;return e.value&&(0,L.default)(r,t)})).map((function(e){return e.value})),o=t.markMemoizee(n,u,l);return k.default.createElement("span",{dangerouslySetInnerHTML:{__html:o.map((function(e){return(0,w.default)(e)?e:'<span class="'.concat(Y.default.hightLightMatch,'">').concat(e.hightLighted,"</span>")}))}})}}},{key:"startPolling",value:function(e){this.poll(),this.pollingInterval&&clearInterval(this.pollingInterval),this.pollingInterval=setInterval(this.poll,e||this.state.pollingFrequency)}},{key:"stopPolling",value:function(){this.setState({polling:!1}),clearInterval(this.pollingInterval)}},{key:"addPollingQuery",value:(a=(0,o.default)(u.default.mark((function e(){var t,a,r,n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.getQueryParams(),r={from:0,start_time:Date.now()-this.state.pollingFrequency,end_time:Date.now()},e.next=4,this.fetchQuery(q(q({},a),r));case 4:n=e.sent,(t=this.logs).push.apply(t,(0,l.default)(n.reverse())),this.scrollTo(this.logs.length);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"scrollTo",value:function(e){this.tableRef.current.scrollToRow(e)}},{key:"render",value:function(){var e=this.state.showHistogram;return k.default.createElement("div",{className:Y.default.container},k.default.createElement(F.Loading,{spinning:this.loading},this.renderSearchBar()),k.default.createElement("div",{className:Y.default.searchResult},k.default.createElement(F.Loading,{spinning:this.loading},k.default.createElement(k.default.Fragment,null,this.renderToolBar(),e&&this.renderTimeChart())),this.renderTable()))}},{key:"renderSearchBar",value:function(){return k.default.createElement("div",{className:Y.default.searchBar},globals.app.isMultiCluster&&k.default.createElement(F.Select,{value:this.props.searchInputState.cluster,onChange:this.changeClusterChange,className:Y.default.select,valueRenderer:this.clusterRenderer,options:this.props.clustersOpts}),k.default.createElement(z.default,{className:Y.default.searchInput,onChange:this.onSearchParamsChange,params:this.props.searchInputState,dropDownItems:{log_query:{icon:"magnifier",text:t("KEYWORD")},namespace_query:{icon:"project",text:t("PROJECT")},workload_query:{icon:"backup",text:t("WORKLOAD")},pod_query:{icon:"pod",text:t("POD")},container_query:{icon:"docker",text:t("CONTAINER")}}}),k.default.createElement(F.Select,{className:Y.default.select,value:this.props.searchInputState.queryMode,onChange:this.changeQueryMode,options:this.queryModeOptions}))}},{key:"renderToolBar",value:function(){var e=this.state,a=e.showHistogram,r=e.polling,n=e.pollingFrequency;return k.default.createElement("div",{className:Y.default.toolbar},k.default.createElement("div",null,t("TIME_TOPOLOGY"),k.default.createElement("span",{className:Y.default.showHistogramBtn,onClick:this.toggleHistogram},a?t("DISPLAY"):t("HIDE"),k.default.createElement(F.Icon,{name:"caret-down",type:"light"}))),k.default.createElement("div",{className:Y.default.operation},k.default.createElement("span",{className:Y.default.pollingBtn,onClick:this.togglePolling},k.default.createElement(F.Tooltip,{content:r?t("STOP_REAL_TIME_CONTAINER_LOG"):t("START_REAL_TIME_CONTAINER_LOG")},k.default.createElement(F.Icon,{name:r?"stop":"start",type:"light",size:16}))),k.default.createElement("span",{className:Y.default.exportButton},k.default.createElement(F.Dropdown,{content:this.renderMoreMenu,trigger:"click",placement:"bottomRight"},k.default.createElement("div",{className:Y.default.exportText},k.default.createElement("span",{className:Y.default.text},t("LOG_EXPORT")),k.default.createElement(F.Icon,{name:"more",type:"light"})))),k.default.createElement("span",{className:Y.default.frequencyOpts},k.default.createElement("span",null," ",t("REFRESH_RATE_COLON")),k.default.createElement(F.Select,{value:n,onChange:this.changeFrequency,className:Y.default.frequencyOptions,options:this.frequencyOptions}))))}},{key:"renderTimeChart",value:function(){return k.default.createElement("div",{className:Y.default.chartContainer},k.default.createElement("div",{className:Y.default.recentSummary},k.default.createElement("h2",{className:Y.default.count},this.histogramStore.logsCount),k.default.createElement("p",null,t("SEARCH_RESULTS"))),k.default.createElement("div",{className:Y.default.chart},k.default.createElement(B.default,{xKey:"time",data:(0,I.toJS)(this.histogramStore.histograms),legend:[["count",t("CONTAINER_LOG_COUNT")]],interval:this.histogramStore.interval,onBarClick:this.selectedDurationParameter})))}},{key:"renderTable",value:function(){return k.default.createElement("div",{className:Y.default.table},k.default.createElement(V.default,{onScroll:this.onTableScrollTop,onTrClick:this.selectLog,cols:this.tableCols,data:this.logs,tableRef:this.tableRef}))}},{key:"defaultDuration",get:function(){return{start_time:0,end_time:Date.now(),interval:"1d"}}},{key:"duration",get:function(){var e=(this.props||{}).searchInputState,t=Date.now(),a=e.start,r=e.end,n=e.step;return a?{start_time:(0,A.default)([1e3*a,t]),end_time:(0,A.default)([1e3*r,t]),interval:n}:this.defaultDuration}}]),h}(k.default.Component),g=(0,v.default)(y.prototype,"tableCols",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{thead:t("TIME"),key:"time",content:function(e){return"[".concat((0,P.default)(e.time).format("YYYY-MM-DD HH:mm:ss"),"]")},hidden:!1},{thead:t("PROJECT"),key:"project",content:this.renderHightLightMatchTd({resKey:"namespace",searchKey:["namespace_query"]}),hidden:!1},{thead:t("POD"),key:"pod",hidden:!1,content:this.renderHightLightMatchTd({resKey:"pod",searchKey:["pod_query","workload_query"]})},{thead:t("CONTAINER"),key:"container",hidden:!0,content:this.renderHightLightMatchTd({resKey:"container",searchKey:["container_query"]})},{thead:t("LOG"),key:"log",className:Y.default.logItem,content:this.renderHightLightMatchLogTd({resKey:"log",searchKey:["log_query"],handler:G.esMark}),mustShow:!0}]}}),b=(0,v.default)(y.prototype,"logs",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=(0,v.default)(y.prototype,"loading",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),(0,v.default)(y.prototype,"refreshQuery",[I.action],Object.getOwnPropertyDescriptor(y.prototype,"refreshQuery"),y.prototype),(0,v.default)(y.prototype,"fetchQuery",[I.action],Object.getOwnPropertyDescriptor(y.prototype,"fetchQuery"),y.prototype),(0,v.default)(y.prototype,"fetchHistogram",[I.action],Object.getOwnPropertyDescriptor(y.prototype,"fetchHistogram"),y.prototype),_=(0,v.default)(y.prototype,"selectedDurationParameter",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a,r,n,l,u,o=t.time,c=void 0===o?0:o,s=e.histogramStore.interval,i=e.props.searchInputState;i.durationAlias="",i.end=Math.ceil(c/1e3)+(a=s.match(/(\d+)(\w+)/),r=(0,D.default)(a,3),n=r[1],l=void 0===n?0:n,u=r[2],l*{s:1,m:60,h:3600,d:86400}[void 0===u?"s":u]),i.start=Math.ceil(c/1e3),i.step=e.getNextStepLevel(s),e.fetchHistogram(),e.refreshQuery()}}}),O=(0,v.default)(y.prototype,"onTableScrollTop",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.scrollTop,r=e.queryStore,n=r.from,l=r.size,u=r.total;0===a&&u>n+l&&e.loadMoreLogs()}}}),(0,v.default)(y.prototype,"loadMoreLogs",[I.action],Object.getOwnPropertyDescriptor(y.prototype,"loadMoreLogs"),y.prototype),C=(0,v.default)(y.prototype,"toggleHistogram",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.setState((function(e){return{showHistogram:!e.showHistogram}}))}}}),T=(0,v.default)(y.prototype,"togglePolling",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.state.polling;t?e.stopPolling():e.startPolling(),e.setState({polling:!t})}}}),(0,v.default)(y.prototype,"addPollingQuery",[I.action],Object.getOwnPropertyDescriptor(y.prototype,"addPollingQuery"),y.prototype),R=(0,v.default)(y.prototype,"changeFrequency",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.setState({pollingFrequency:t}),e.state.polling&&(e.stopPolling(),e.startPolling(t))}}}),E=y))||E;a.default=Z},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports={table:"_31DHxUvHF9cvrtMF8hZ1NJ",body:"_1o0OrXH49u7IWnn__jySDi",header:"_3d3ile0MQ76mzy4gKMKVGa",headerItems:"cBGvp-qF5E0-Zn-DV66BU",visibleBtn:"_1QLOXkaGohLi2bLbAWcJjT",dropdown:"_16GV2vWPgU-_LY-TSI-nEL",visibleItem:"_10IfOBGBtVJ2cWMKKLCURw",tr:"_3wpavJr72BCdw4FWfpnkOc",bodyItems:"_1Jb5Hf9bhyeHQD05-MYz5N"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(87),a(51),a(143),a(30),a(11),a(69),a(71),Object.defineProperty(t,"__esModule",{value:!0}),t.mark=o,t.markAll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o;if(!t.length)return[e];return t.reduce((function(e,t){return e.reduce((function(e,r){return e.concat(a(r,t))}),[])}),[e])},t.esMark=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hightLighted";if(!(0,l.default)(e))return e;var r=t.match(/\w+|[\u4e00-\u9fa5]/g)||[],n=r.reduce((function(e,t){var a=e.slice(-1),r=c.test(t),n=c.test(a);return"".concat(e,"[^\\w\\u4e00-\\u9fa5]{").concat(r||n?0:1,",}").concat(t)}),"");if(!n)return[e];var u=new RegExp(n,"ig");return s(e,u,a)},t.markStrAsArray=s;var n=r(a(31));a(3),a(27),a(87),a(51),a(4),a(143),a(251),a(30),a(252),a(195),a(11),a(69),a(71);var l=r(a(142)),u=/[|\\{}()[\]^$+*?.]/g;function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hightLighted";if(!(0,l.default)(e))return e;if(!t)return[e];var r=t.replace(u,"\\$&"),n=new RegExp(r,"ig");return s(e,n,a)}var c=/[\u4e00-\u9fa5]/;function s(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hightLighted",r=[e],l=0;return e.replace(t,(function(e,t){var u=r.length-1,o=r[u],c=t-l,s=o.slice(0,c),i=o.slice(c+e.length);r[u]=s,r.push((0,n.default)({},a,e),i),l+=t+e.length})),r}},function(e,t,a){e.exports={searchBar:"_JTlDkrfohSwIxPpX97wp",searchInput:"_25v4Uq6VdGeubmXGfPRsa6",select:"_3t4uAxkZ2BFOTl4foQ1DRo",searchResult:"_3li-Ch_QP-SfD5vjzDIXgd",toolbar:"_1wFZR-2jbDGJY79Klx4L11",operation:"_23II8bjJaDDga7SzCWyMm7",exportButton:"_3eZWtrM_1V15_kaHWj-DpL",exportText:"_8g5V39tYUe7rdh7ZPduAB",text:"_1DLrO1c0pV2m8b_28dUerc",menuLinkContent:"LsDuLg9SzYCwxyLiKzBsS",frequencyOpts:"_3gotqRkYjzqimbLSXvXXoe",frequencyOptions:"_2FKKxtgN7QWnOcFKcoW-yl",chartContainer:"_1TbzGgX6Ll6A-GDc4T4Ad",recentSummary:"_32mzAeyZriH5v29CxUBHw0",chart:"_39jXgnORNLHHwWrfolFLAT",table:"_1LzMkW6YYbyYTptsNE4-Xa",logItem:"_1y2_hopFflOw1UUWDuImRk",count:"_3t6_PUErus14gjlZ0dSd0d",showHistogramBtn:"_9d9RtZ1b011VOdyFhrNMY",pollingBtn:"_1LWeyfeCE0ECAs__57lhjh",container:"_36atrKU0dMxQaHnt0CMWwj",hightLightMatch:"_2jhV5b7tn8RPILbYxuQt7g",hightLog:"_9VNSgJg53gFYpEK1pk5Co"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(44),r(6),r(88),r(20),r(51),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(817),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(88),r(20),r(27),r(247),r(51),r(860),r(442),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(817),r(7),r(110);var l=n(r(58)),u=n(r(38));r(35);var o,c,s,i,f,d,p=n(r(39)),m=n(r(31)),h=n(r(62)),v=n(r(25)),E=n(r(28)),y=n(r(74)),g=n(r(41)),b=n(r(42)),S=n(r(37)),_=n(r(45)),O=(n(r(63)),n(r(0))),C=n(r(245)),T=n(r(5)),R=r(243),D=r(17),k=n(r(1180)),N=n(r(26)),I=r(189),P=n(r(452)),A=n(r(441)),w=n(r(1501)),L=r(848),M=n(r(3131)),x=n(r(3133));function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,m.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,S.default)(e);if(t){var n=(0,S.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,b.default)(this,a)}}var V=new k.default,G=(0,R.observer)((c=function(e){(0,g.default)(S,e);var a,r,n,o,c,m,b=F(S);function S(e){var a;(0,v.default)(this,S),(a=b.call(this,e)).logWindow=O.default.createRef(),a.pollingFrequencyOpts=[5,10,15].map((function(e){return{label:"".concat(t("REFRESH_RATE_COLON")).concat(t("TIME_S",{num:e})),value:1e3*e}})),(0,h.default)(a,"logs",s,(0,y.default)(a)),(0,h.default)(a,"changePod",i,(0,y.default)(a)),(0,h.default)(a,"changeContainer",f,(0,y.default)(a)),a.changeSearchLog=function(e){a.setState({query:e.target.value})},a.queryLog=function(e){13===e.keyCode&&a.refreshLogs()},a.togglePolling=function(){var e=a.state.polling;e?a.stopPolling():a.startPolling(),a.setState({polling:!e})},a.stopPolling=function(){clearInterval(a.interval)},(0,h.default)(a,"onFrequencySelect",d,(0,y.default)(a)),a.onDurationChange=function(){a.refreshLogs()},a.onLogScroll=function(e){var t=e.currentTarget,r=t.scrollHeight;if(t.scrollTop+t.clientHeight>=r){var n=a.logStore,l=n.from,u=n.size;n.total>l+u&&a.loadMoreLogs()}},a.pre=function(){a.props.formStepState.pre()},a.clearQuery=function(){a.setState({query:""},(function(){a.refreshLogs()}))},a.renderMoreMenu=function(){var e=a.logStore,r=e.pods,n=e.containers,l=e.log_query,u=e.startTime,o=e.endTime,c=e.namespaces,s={cluster:a.props.searchInputState.cluster,namespaces:c,pods:r,containers:n,log_query:l,start_time:u,end_time:o},i=[O.default.createElement(I.Menu.MenuItem,{key:"asc"},O.default.createElement("span",{className:x.default.menuLinkContent},O.default.createElement("a",{href:a.logStore.exportLinkFactory(U(U({},s),{},{sort:"asc"})),download:!0},t("ASC_EXPORT")))),O.default.createElement(I.Menu.MenuItem,{key:"desc"},O.default.createElement("span",{className:x.default.menuLinkContent},O.default.createElement("a",{href:a.logStore.exportLinkFactory(U(U({},s),{},{sort:"desc"})),download:!0},t("DESC_EXPORT"))))];return O.default.createElement(I.Menu,null,i)};var r=a.props.detailState,n=r.pod,l=r.container,u=r.namespace,o=r.log,c=r.time,p=new Date(c).getTime();return a.logStore=new w.default({sort:"desc",pods:n,namespaces:u,containers:l,size:100,startTime:p-1e3,endTime:p+1e3}),a.podStore=new P.default,a.projectStore=new A.default,a.state={pollingFrequency:5e3,polling:!1,query:o},a}return(0,E.default)(S,[{key:"startPolling",value:(m=(0,p.default)(u.default.mark((function e(){var t,a=this;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Date.now(),e.next=3,this.fetchLogs({end_time:t,start_time:t-6e4,from:0});case 3:this.logs=e.sent,this.interval=setInterval((function(){a.addPollingLogs()}),this.state.pollingFrequency);case 5:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"addPollingLogs",value:(c=(0,p.default)(u.default.mark((function e(){var t,a,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Date.now(),e.next=3,this.fetchLogs({end_time:a,start_time:a-this.state.pollingFrequency,from:0});case 3:r=e.sent,(t=this.logs).unshift.apply(t,(0,l.default)(r)),this.scrollToBottom();case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"scrollToBottom",value:function(){var e=this.logWindow.current;e.scrollTop=e.scrollHeight}},{key:"loadMoreLogs",value:(o=(0,p.default)(u.default.mark((function e(){var t,a,r,n,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.logStore,r=a.from,n=a.size,this.logStore.from=r+n,e.next=4,this.fetchLogs();case 4:o=e.sent,(t=this.logs).push.apply(t,(0,l.default)(o));case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getPodContainers",value:function(e){var t=this.podStore.list.data.find((function(t){return t.name===e}))||{};return(0,N.default)(t,"containers",[])}},{key:"componentDidMount",value:function(){this.fetchPods(),this.fetchProject(),this.initialFetch()}},{key:"componentWillUnmount",value:function(){this.stopPolling()}},{key:"initialFetch",value:(n=(0,p.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchLogs();case 2:this.logs=e.sent;case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"refreshLogs",value:(r=(0,p.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logStore.from=0,this.logStore.log_query=this.state.query,this.setState({polling:!1}),this.stopPolling(),e.next=6,this.fetchLogs();case 6:this.logs=e.sent;case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"fetchLogs",value:(a=(0,p.default)(u.default.mark((function e(){var t,a,r=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},a=this.props.searchInputState.cluster,e.next=4,this.logStore.fetch(U(U({},t),{},{cluster:a}));case 4:return e.abrupt("return",this.logStore.records);case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"fetchProject",value:function(){var e=this.props.detailState.namespace,t=this.props.searchInputState.cluster;this.projectStore.fetchDetail({name:e,namespace:e,cluster:t},(function(){}))}},{key:"fetchPods",value:function(){var e=this.props.detailState.namespace,t=this.props.searchInputState.cluster;this.podStore.fetchList({cluster:t,namespace:e,limit:-1})}},{key:"render",value:function(){return O.default.createElement("div",{className:x.default.container},O.default.createElement("div",{className:x.default.article},this.renderSummary(),this.renderLog()))}},{key:"renderLog",value:function(){var e=this.state.polling;return O.default.createElement("div",{className:x.default.log},O.default.createElement("div",{className:(0,T.default)(x.default.toolbar,this.state.polling?x.default.pollingMode:"")},this.state.polling||this.renderDurationSelect(),this.renderSearchInput(),this.renderPollingBtn(),this.renderPollingOpts(),this.renderExportBtn()),O.default.createElement("div",{className:x.default.terminal,onScroll:e?null:this.onLogScroll,ref:this.logWindow},this.renderTerminal()))}},{key:"renderPollingOpts",value:function(){return O.default.createElement("div",{className:x.default.frequencyOpts},O.default.createElement(I.Select,{options:this.pollingFrequencyOpts,value:this.state.pollingFrequency,onChange:this.onFrequencySelect}))}},{key:"renderPollingBtn",value:function(){return O.default.createElement("div",{className:x.default.pollingBtn,onClick:this.togglePolling},O.default.createElement(I.Tooltip,{content:this.state.polling?t("STOP"):t("START")},O.default.createElement(I.Icon,{type:"light",name:this.state.polling?"stop":"start"})))}},{key:"renderExportBtn",value:function(){return O.default.createElement("div",{className:x.default.operation},O.default.createElement(I.Dropdown,{content:this.renderMoreMenu,trigger:"click",placement:"bottomRight"},O.default.createElement("div",{className:x.default.exportText},O.default.createElement("span",{className:x.default.text},t("LOG_EXPORT")),O.default.createElement(I.Icon,{name:"more",type:"light"}))))}},{key:"renderDurationSelect",value:function(){return O.default.createElement("div",{className:x.default.duration},O.default.createElement(M.default,{duration:this.logStore,onChange:this.onDurationChange}))}},{key:"renderSearchInput",value:function(){return O.default.createElement("div",{className:x.default.input},O.default.createElement(I.Icon,{name:"magnifier",type:"light"}),O.default.createElement("input",{type:"text",onKeyUp:this.queryLog,value:this.state.query,onChange:this.changeSearchLog}),this.state.query&&O.default.createElement(I.Icon,{className:x.default.clearQuery,name:"close",type:"light",onClick:this.clearQuery}))}},{key:"renderTerminal",value:function(){var e=this;return O.default.createElement("div",{className:x.default.logWindow},this.logs.reverse().map((function(t){var a=t.time,r=t.log;return O.default.createElement("p",{key:"".concat(a).concat(r)},O.default.createElement("span",{className:x.default.logTime},(0,C.default)(a).format("YYYY-MM-DD HH:mm:ss"),":"," ",e.renderHighLightLog(r)))})))}},{key:"renderHighLightLog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.state.query,a=t.trim(),r=e.toUpperCase().indexOf(a.toUpperCase());return a&&-1!==r?O.default.createElement("span",{className:x.default.queryLog},O.default.createElement("span",{dangerouslySetInnerHTML:{__html:V.ansi_to_html(e.slice(0,r))}}),O.default.createElement("span",{className:x.default.hightLight,dangerouslySetInnerHTML:{__html:V.ansi_to_html(e.slice(r,r+a.length))}}),O.default.createElement("span",{dangerouslySetInnerHTML:{__html:V.ansi_to_html(e.slice(r+a.length))}})):O.default.createElement("span",{className:x.default.queryLog,dangerouslySetInnerHTML:{__html:V.ansi_to_html(e)}})}},{key:"renderLink",value:function(e,a){return e?O.default.createElement(I.Tooltip,{content:t("VIEW_DETAILS")},O.default.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},a)):a}},{key:"renderSummary",value:function(){var e=this.props.detailState;return O.default.createElement("div",{className:x.default.summery},O.default.createElement("div",{className:x.default.header},O.default.createElement("div",{className:x.default.pre,onClick:this.pre},O.default.createElement(L.ReactComponent,{width:16,height:22}),O.default.createElement("span",null,t("BACK")))),O.default.createElement("h3",null,t("CONTAINER_LOG_SOURCE")),O.default.createElement("div",{className:x.default.dataList},O.default.createElement("div",null,O.default.createElement("h4",null,t("PROJECT")),O.default.createElement("p",null,O.default.createElement("span",null,O.default.createElement(I.Icon,{name:"project"})," ",e.namespace))),O.default.createElement("div",null,O.default.createElement("h4",null,t("POD")),O.default.createElement("div",{className:x.default.selectContainer},O.default.createElement(I.Select,{prefixIcon:O.default.createElement(I.Icon,{name:"pod"}),value:this.logStore.pods,onChange:this.changePod,options:this.PodOpts}),O.default.createElement("div",{className:x.default.resourceIcon},this.renderLink(this.podLink,O.default.createElement(I.Icon,{name:"cogwheel",size:16}))))),O.default.createElement("div",null,O.default.createElement("h4",null,t("CONTAINER")),O.default.createElement("div",{className:x.default.selectContainer},O.default.createElement(I.Select,{prefixIcon:O.default.createElement(I.Icon,{name:"docker"}),value:this.logStore.containers,options:this.ContainersOpts,onChange:this.changeContainer}),O.default.createElement("div",{className:x.default.resourceIcon},this.renderLink(this.containerLink,O.default.createElement(I.Icon,{name:"cogwheel",size:16})))))))}},{key:"podLink",get:function(){var e=this.props.detailState.namespace,t=this.props.searchInputState.cluster,a=this.logStore.pods,r=this.projectStore.detail.workspace;return r?"/".concat(r,"/clusters/").concat(t,"/projects/").concat(e,"/pods/").concat(a):""}},{key:"containerLink",get:function(){var e=this.props.detailState.namespace,t=this.props.searchInputState.cluster,a=this.logStore,r=a.pods,n=a.containers,l=this.projectStore.detail.workspace;return l?"/".concat(l,"/clusters/").concat(t,"/projects/").concat(e,"/pods/").concat(r,"/containers/").concat(n):""}},{key:"PodOpts",get:function(){return this.podStore.list.data.map((function(e){return{label:e.name||t("ALL"),value:e.name||""}}))}},{key:"ContainersOpts",get:function(){var e=this.logStore.pods;return this.getPodContainers(e).map((function(e){return{label:e.name,value:e.name}}))}}]),S}(O.default.Component),s=(0,_.default)(c.prototype,"logs",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,_.default)(c.prototype,"podLink",[D.computed],Object.getOwnPropertyDescriptor(c.prototype,"podLink"),c.prototype),(0,_.default)(c.prototype,"containerLink",[D.computed],Object.getOwnPropertyDescriptor(c.prototype,"containerLink"),c.prototype),(0,_.default)(c.prototype,"PodOpts",[D.computed],Object.getOwnPropertyDescriptor(c.prototype,"PodOpts"),c.prototype),(0,_.default)(c.prototype,"ContainersOpts",[D.computed],Object.getOwnPropertyDescriptor(c.prototype,"ContainersOpts"),c.prototype),i=(0,_.default)(c.prototype,"changePod",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.logStore.pods=t||"";var a=(0,N.default)(e.getPodContainers(t),"[0].name","");e.changeContainer(a)}}}),f=(0,_.default)(c.prototype,"changeContainer",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.logStore.containers=t,e.logStore.log_query="",e.refreshLogs()}}}),(0,_.default)(c.prototype,"startPolling",[D.action],Object.getOwnPropertyDescriptor(c.prototype,"startPolling"),c.prototype),(0,_.default)(c.prototype,"addPollingLogs",[D.action],Object.getOwnPropertyDescriptor(c.prototype,"addPollingLogs"),c.prototype),d=(0,_.default)(c.prototype,"onFrequencySelect",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.setState({pollingFrequency:t})}}}),(0,_.default)(c.prototype,"loadMoreLogs",[D.action],Object.getOwnPropertyDescriptor(c.prototype,"loadMoreLogs"),c.prototype),(0,_.default)(c.prototype,"initialFetch",[D.action],Object.getOwnPropertyDescriptor(c.prototype,"initialFetch"),c.prototype),(0,_.default)(c.prototype,"refreshLogs",[D.action],Object.getOwnPropertyDescriptor(c.prototype,"refreshLogs"),c.prototype),o=c))||o;a.default=G},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(8),r(4),r(18),r(30),r(11),r(69),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(442),r(29),r(8),r(4),r(18),r(43),r(30),r(11),r(69);var l,u,o,c,s,i,f,d,p,m=n(r(97)),h=n(r(62)),v=n(r(25)),E=n(r(28)),y=n(r(74)),g=n(r(41)),b=n(r(42)),S=n(r(37)),_=n(r(45)),O=(n(r(63)),n(r(0))),C=r(243),T=r(17),R=n(r(5)),D=n(r(245)),k=r(189),N=n(r(1041)),I=n(r(1040)),P=r(909),A=n(r(3132));function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,S.default)(e);if(t){var n=(0,S.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,b.default)(this,a)}}var L=(0,C.observer)((u=function(e){(0,g.default)(r,e);var a=w(r);function r(){var e;(0,v.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return e=a.call.apply(a,[this].concat(n)),(0,h.default)(e,"showDropDown",o,(0,y.default)(e)),(0,h.default)(e,"step",c,(0,y.default)(e)),(0,h.default)(e,"times",s,(0,y.default)(e)),(0,h.default)(e,"lastTime",i,(0,y.default)(e)),(0,h.default)(e,"handleTimeChange",f,(0,y.default)(e)),(0,h.default)(e,"changeLastTime",d,(0,y.default)(e)),(0,h.default)(e,"toggleDropdown",p,(0,y.default)(e)),e.hiddenDropdown=function(){e.showDropDown=!1},e}return(0,E.default)(r,[{key:"render",value:function(){return O.default.createElement("div",null,O.default.createElement("div",{className:(0,R.default)(A.default.select,this.props.className),onClick:this.toggleDropdown},O.default.createElement(k.Icon,{name:"timed-task",type:"light"}),O.default.createElement("div",{className:A.default.duration},this.duration),O.default.createElement(k.Icon,{name:"caret-down",type:"light"})),this.showDropDown&&this.renderDropdown())}},{key:"renderDropdown",value:function(){var e=this.props.duration,t=e.startTime,a=e.endTime;return O.default.createElement("div",{className:A.default.durationDropdown},O.default.createElement(I.default,{step:this.step,times:this.times,onChange:this.changeLastTime}),O.default.createElement(N.default,{start:t,end:a,showStep:!1,onSubmit:this.handleTimeChange,onCancel:this.hiddenDropdown}))}},{key:"duration",get:function(){if(this.lastTime)return"".concat(t("LAST")," ").concat((0,P.getTimeLabel)(this.lastTime));var e=this.props.duration,a=e.startTime,r=e.endTime;return"".concat((0,D.default)(a).format("YYYY-MM-DD HH:mm:ss")," \n    ~ ").concat((0,D.default)(r).format("YYYY-MM-DD HH:mm:ss"))}}]),r}(O.default.Component),o=(0,_.default)(u.prototype,"showDropDown",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=(0,_.default)(u.prototype,"step",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"1m"}}),s=(0,_.default)(u.prototype,"times",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),i=(0,_.default)(u.prototype,"lastTime",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),(0,_.default)(u.prototype,"duration",[T.computed],Object.getOwnPropertyDescriptor(u.prototype,"duration"),u.prototype),f=(0,_.default)(u.prototype,"handleTimeChange",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.end,r=t.lastTime,n=t.start,l=t.step,u=t.times;e.step=l,e.times=u,e.lastTime=r;var o=e.props.duration;o.startTime=1e3*n,o.endTime=1e3*a,e.hiddenDropdown(),e.props.onChange()}}}),d=(0,_.default)(u.prototype,"changeLastTime",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.step,r=t.times,n=t.lastTime;e.step=a,e.times=r,e.lastTime=n;var l=e.props.duration,u=Date.now();l.endTime=u;var o=a.match(/(\d+)(m)$/),c=(0,m.default)(o,2)[1],s=void 0===c?0:c;l.startTime=u-s*r*60*1e3,e.hiddenDropdown(),e.props.onChange()}}}),p=(0,_.default)(u.prototype,"toggleDropdown",[T.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showDropDown=!e.showDropDown}}}),l=u))||l;a.default=L},function(e,t,a){e.exports={select:"_2-F0UE11GOASs9vwCvAcD3",duration:"_3VnDK5FBqXs41y-iY5mRfB",durationDropdown:"gK8I8s07_BCnvFmuEmBd-"}},function(e,t,a){e.exports={container:"_1m9keQ11jYZGSfebO3qpB9",header:"xyd8UHpFORkv0cf8P_wf0",pre:"_3g32rijfAK3WWt8VnU59T2",article:"_2PKCbXH04u2gpKtsY8yyDh",summery:"_3gJXtGvSQDAIf7EYdR5pP7",dataList:"_3m957iXyjK0atgGWBiA_sD",selectContainer:"_1O3jNe9JTI_LYz5SBHVGB4",resourceIcon:"PDOkQidT1doiKY5qavaBk",log:"_3APlUWOBR7nWoAMy3lemSN",toolbar:"k0H9ir6QM9JOMpa3VARJ",pollingMode:"_1yWitRxNIDcs41bUD_FCr3",frequencyOpts:"_43PrR8I3aTFsUJ31zLNXY",pollingBtn:"_2Rb3c4PkpyUAvzXeOcST6B",duration:"CRFZxzq5h9lLhyFhE0_gL",clearQuery:"_1h00qMNuLivBoaAKWdG6Mw",input:"_2ka1dM2WjsmppvIY164F07",terminal:"_2pClDN0tGVKg_h8jlNQYoe",logTime:"_1J2jPkQwUcFHrxoLxhh4Aq",disableLink:"xo9-nJKZg7AddOFRdMuEW",hightLight:"tN1IxAbCahLEzTnd_KqIh",queryLog:"_3PceA_GY1Sw5LnNsUZSLGJ",operation:"_15WvnhV_n51t93-8Ww4305",exportText:"_18NEXm7R2Dwdn4LtprQ6Zb",text:"_1OIiGOWZAyBJT-5oJUDJQ2",menuLinkContent:"_33M5GMVgBdhmOOPk0rK6lz"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(20),a(14),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(14),a(8),a(4),a(21),a(18),a(43),a(11);var n=r(a(317)),l=r(a(38));a(35);var u,o,c=r(a(39)),s=r(a(25)),i=r(a(28)),f=r(a(41)),d=r(a(42)),p=r(a(37)),m=r(a(45)),h=r(a(0)),v=a(243),E=a(17),y=r(a(26)),g=r(a(448)),b=a(3135);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,v.observer)((o=function(e){(0,f.default)(r,e);var t,a=S(r);function r(){var e,t;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).clusters=new g.default,e.formStepState=e.initStepState(),e.searchInputState=((t=(0,E.observable)({query:[],start:"",end:"",step:"",durationAlias:"",nextParamsKey:"",queryMode:1,cluster:""})).setCluster=(0,E.action)((function(e){t.cluster=e})),t),e}return(0,i.default)(r,[{key:"initStepState",value:function(){var e=(0,E.observable)({step:0});return e.next=(0,E.action)((function(){e.step+=1})),e.pre=(0,E.action)((function(){e.step-=1})),e}},{key:"componentDidMount",value:(t=(0,c.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clusters.fetchList({limit:-1,ascending:!0});case 2:this.searchInputState.setCluster((0,y.default)(this,"clustersOpts[0].value",""));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.Content,t=e.Component,a=e.props;if(t)return h.default.createElement("div",{style:{height:"calc(100vh - 100px)"}},h.default.createElement(t,(0,n.default)({clustersOpts:this.clustersOpts,formStepState:this.formStepState},a)))}},{key:"clustersOpts",get:function(){return this.clusters.list.data.map((function(e){var t=e.name;return{value:t,label:t}}))}},{key:"formStepConfig",get:function(){return[{Component:b.Home,props:{searchInputState:this.searchInputState}},{Component:b.Detail,props:{searchInputState:this.searchInputState}}]}},{key:"Content",get:function(){return this.formStepConfig[this.formStepState.step]||{}}}]),r}(h.default.Component),(0,m.default)(o.prototype,"clustersOpts",[E.computed],Object.getOwnPropertyDescriptor(o.prototype,"clustersOpts"),o.prototype),u=o))||u;t.default=_},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Home",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Detail",{enumerable:!0,get:function(){return l.default}});var n=r(a(3136)),l=r(a(3138))},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(62)),s=n(r(25)),i=n(r(28)),f=n(r(74)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(45)),v=(n(r(63)),n(r(0))),E=r(17),y=r(243),g=n(r(245)),b=n(r(5)),S=r(189),_=n(r(971)),O=n(r(969)),C=n(r(1503)),T=r(1504),R=n(r(3137));function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var k=(0,y.observer)((u=function(e){(0,d.default)(r,e);var a=D(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).eventSearchStore=new C.default,e.watchCluster=function(){var t=e.props.searchInputState;e.disposer=(0,E.reaction)((function(){return t.cluster}),(function(t){""!==t&&e.updateStatistics(t)}))},(0,c.default)(e,"selectedDurationParameter",o,(0,f.default)(e)),e.selectedParameter=function(t){e.props.searchInputState.nextParamsKey=t.currentTarget.dataset.query},e.onSearchParamsChange=function(){e.props.formStepState.next()},e.onClusterChange=function(t){e.props.searchInputState.setCluster(t)},e.clusterRenderer=function(e){return t("CLUSTER_VALUE",{value:e.label})},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.watchCluster()}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"updateStatistics",value:function(e){this.eventSearchStore.fetchTodayHistogram({cluster:e}),this.eventSearchStore.fetchHistogram({cluster:e})}},{key:"render",value:function(){return v.default.createElement("div",null,v.default.createElement("div",{className:R.default.pane},this.renderBanner()),v.default.createElement("div",{className:R.default.tips},v.default.createElement("div",{className:R.default.pane},this.renderSearchBar(),v.default.createElement("h3",{className:R.default.rule},t("QUERYING_RULES")),this.renderRecentLogs(),this.renderQueryItems())))}},{key:"renderBanner",value:function(){var e=this.eventSearchStore,a=e.histogramTodayData,r=void 0===a?{}:a,n=e.isLoading;return v.default.createElement("div",{className:R.default.banner},v.default.createElement("div",{className:R.default.illustration},v.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/log-statistics.svg",alt:"log-statistics"})),v.default.createElement(S.Loading,{spinning:n},v.default.createElement("div",{className:R.default.statistics},v.default.createElement("h3",null,r.events?t.html("TOTAL_EVENTS_TODAY",{events:r.events,className:R.default.count}):t("NO_RESOURCE_EVENTS_TODAY")),r.events?v.default.createElement("p",null,v.default.createElement(S.Icon,{name:"clock"}),t("START_TIME_VALUE",{value:(0,g.default)(new Date).format("YYYY-MM-DD HH:mm:ss")})):null)))}},{key:"renderSearchBar",value:function(){var e=this.props,t=e.searchInputState,a=e.clustersOpts;return v.default.createElement("div",{className:R.default.searchBarContainer},globals.app.isMultiCluster&&v.default.createElement(S.Select,{className:R.default.clusterSelector,value:t.cluster,options:a,valueRenderer:this.clusterRenderer,onChange:this.onClusterChange}),v.default.createElement(_.default,{className:R.default.searchBar,onChange:this.onSearchParamsChange,params:t,dropDownItems:T.dropDownItems}))}},{key:"renderRecentLogs",value:function(){var e=this.eventSearchStore,a=e.isLoading,r=e.histogramData,n=void 0===r?{}:r,l=e.logsCount,u=e.interval;return v.default.createElement(S.Loading,{spinning:a},v.default.createElement("div",{className:(0,b.default)(R.default.card,R.default.recent)},v.default.createElement("div",{className:R.default.recentSummary},v.default.createElement("h2",{className:R.default.count},l||0),v.default.createElement("p",null,t("RESOURCE_EVENTS_12H"))),v.default.createElement("div",{className:R.default.chart},v.default.createElement(O.default,{xKey:"time",data:(0,E.toJS)(n.buckets||[]),legend:[["count",t("RESOURCE_EVENT_COUNT")]],interval:u||"30m",onBarClick:this.selectedDurationParameter}))))}},{key:"renderQueryItems",value:function(){var e=this;return T.supportQueryParams.map((function(t){return v.default.createElement("div",{className:(0,b.default)(R.default.card,R.default.category),key:t.key,"data-query":t.key,onClick:e.selectedParameter},v.default.createElement("div",{className:R.default.icon},t.iconUrl?v.default.createElement("div",null,v.default.createElement("img",{src:t.iconUrl})):v.default.createElement(S.Icon,{name:t.icon,size:40})),v.default.createElement("div",{className:R.default.desc},v.default.createElement("h4",null,t.title),v.default.createElement("p",null,t.tips)))}))}}]),r}(v.default.Component),o=(0,h.default)(u.prototype,"selectedDurationParameter",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.time,r=void 0===a?0:a,n=e.eventSearchStore.interval,l=e.props.searchInputState;l.durationAlias="",l.end=Math.ceil(r/1e3)+(0,T.getSecond)(n),l.start=Math.ceil(r/1e3),l.step="1m",e.onSearchParamsChange()}}}),l=u))||l;a.default=k},function(e,t,a){e.exports={tips:"HUiUrGnwqXHJnUdkfkdle",rule:"_2GLSFcLXNj2pgmR9iBP9za",searchBar:"_1tOc9TdP-PfQFdXeuWfDo_",pane:"_3ZqYSqDn-TyMEAUF_B4gqT",card:"_2z3MJaUK70hQ0cvHnNouc-",count:"_4Ia9Kde5mKVKcksKOMT4Q",banner:"_18aM0r1HY81ruJr8L4tP5f",illustration:"_1uYgas67hJARUuXbMRHkap",statistics:"_38fKj8hTGtC2lnm4foJlQK",category:"_21Xjq4g0hG38R-o4leFgg4",icon:"_20b2eyqQcQj7r1GAKm57yy",desc:"sNaHeBiU1jrv3yK6-vNS",recent:"_2BxwQBarq9ek5D4LQSS8ae",recentSummary:"XZOzn84R2bHEXCMSGTsQJ",chart:"GyTiLrVB0IA5Wo2Q3i9gm",searchBarContainer:"_3sr_dy9EvZ4c7zIsZ69Wxy",clusterSelector:"_19noImIzSvBQYMb-lW4qCe"}},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(44),r(199),r(6),r(20),r(87),r(14),r(8),r(13),r(9),r(4),r(18),r(143),r(30),r(11),r(69),r(139),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(199),r(6),r(20),r(27),r(87),r(442),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(143),r(251),r(30),r(252),r(11),r(69),r(139),r(7),r(110);var u=n(r(97)),o=n(r(58)),c=n(r(38)),s=n(r(31));r(35);var i,f,d,p,m,h,v,E,y,g=n(r(39)),b=n(r(62)),S=n(r(25)),_=n(r(28)),O=n(r(74)),C=n(r(41)),T=n(r(42)),R=n(r(37)),D=n(r(45)),k=(n(r(63)),l(r(0))),N=r(189),I=n(r(906)),P=n(r(245)),A=n(r(5)),w=r(243),L=r(17),M=n(r(971)),x=n(r(1200)),j=n(r(969)),U=n(r(1503)),F=n(r(3139)),V=r(1504),G=n(r(3143));function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,R.default)(e);if(t){var n=(0,R.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,T.default)(this,a)}}var H=600,q="10s",K=["m","h","d","M","y"],W=(0,w.observer)((f=function(e){(0,C.default)(f,e);var a,r,n,l,i=Y(f);function f(e){var a;return(0,S.default)(this,f),a=i.call(this,e),(0,b.default)(a,"logs",d,(0,O.default)(a)),(0,b.default)(a,"tableCols",p,(0,O.default)(a)),(0,b.default)(a,"selectedDurationParameter",m,(0,O.default)(a)),(0,b.default)(a,"onTableScrollEnd",h,(0,O.default)(a)),a.onSearchParamsChange=function(){a.stopPolling(),a.refreshQuery(),a.fetchHistogram()},(0,b.default)(a,"toggleHistogram",v,(0,O.default)(a)),(0,b.default)(a,"togglePolling",E,(0,O.default)(a)),a.renderHightLightMatchTd=function(e){var t=e.message,r=a.props.searchInputState.query.find((function(e){return"message_search"===e.key}));if(!r)return t;var n=new RegExp(r.value,"gi"),l=t.split(n);if(1===l.length)return t;var u=t.match(n);return k.default.createElement(k.Fragment,null,l.map((function(e,t){return k.default.createElement(k.Fragment,{key:e+t},e,k.default.createElement("span",{className:G.default.hightLightMatch},u[t]))})))},a.poll=function(){var e=a.props.searchInputState,t=H,r=q;e.end=Math.ceil(Date.now()/1e3),e.start=e.end-t,e.step=r,e.durationAlias="".concat(t/60,"m"),a.fetchHistogram(),a.refreshQuery(),a.setState({polling:!0})},(0,b.default)(a,"changeFrequency",y,(0,O.default)(a)),a.changeQueryMode=function(e){a.props.searchInputState.queryMode=e,a.onSearchParamsChange()},a.changeClusterChange=function(e){a.props.searchInputState.setCluster(e),a.onSearchParamsChange()},a.onCancel=function(){a.setState({visible:!1})},a.openDetailsModal=function(e){a.setState({detail:e,eventMetadata:(0,V.toArray)(e),visible:!0})},a.clusterRenderer=function(e){return t("CLUSTER_VALUE",{value:e.label})},a.renderTable=function(){return k.default.createElement("div",{className:G.default.table},k.default.createElement(x.default,{onScroll:a.onTableScrollEnd,onTrClick:a.openDetailsModal,cols:a.tableCols,data:a.logs,body:G.default.body}))},a.state={visible:!1,detail:{},eventMetadata:[],showHistogram:!0,polling:!1,pollingFrequency:5e3},a.frequencyOptions=[5,10,15].map((function(e){return{value:1e3*e,label:"".concat(t("TIME_S",{num:e}))}})),a.store=new U.default({size:50}),a}return(0,_.default)(f,[{key:"componentDidMount",value:function(){this.refreshQuery(),this.fetchHistogram()}},{key:"componentWillUnmount",value:function(){this.stopPolling()}},{key:"refreshQuery",value:(l=(0,g.default)(c.default.mark((function e(){var t;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.from=0,t=this.getQueryParams(),e.next=4,this.fetchQuery(z(z({},t),this.duration));case 4:this.logs=e.sent;case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"loadMoreLogs",value:(n=(0,g.default)(c.default.mark((function e(){var t,a,r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.store.from+this.store.size,e.next=3,this.fetchQuery(z(z({},this.store.preParams),{from:a}));case 3:r=e.sent,(t=this.logs).push.apply(t,(0,o.default)(r));case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getNextStepLevel",value:function(e){var t=e.match(/\d+(\w+)$/),a=(0,u.default)(t,2)[1],r=void 0===a?"m":a,n=K.findIndex((function(e){return e===r}));return"1".concat(n<1?K[0]:K[n-1])}},{key:"fetchQuery",value:(r=(0,g.default)(c.default.mark((function e(t){var a,r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.searchInputState.cluster,r=z(z({},t),{},{cluster:a}),e.next=4,this.store.fetchQuery(r);case 4:return e.abrupt("return",this.store.data);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"fetchHistogram",value:function(){var e=this.getQueryParams();this.store.interval=this.duration.interval,this.store.fetchHistogram(z(z({},e),this.duration))}},{key:"getQueryParams",value:function(){var e=this.props.searchInputState,t=e.query,a=e.queryMode,r=e.cluster;return t.filter((function(e){return e.key})).reduce((function(e,t){var r=t.key,n=t.value,l=a?r:V.queryKeyMapping[r],u=e[l];return e[l]=u?"".concat(u,",").concat(n):n,e}),{cluster:r})}},{key:"startPolling",value:function(e){this.poll(),this.pollingInterval&&clearInterval(this.pollingInterval),this.pollingInterval=setInterval(this.poll,e||this.state.pollingFrequency)}},{key:"stopPolling",value:function(){this.setState({polling:!1}),clearInterval(this.pollingInterval)}},{key:"addPollingQuery",value:(a=(0,g.default)(c.default.mark((function e(){var t,a,r,n;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.getQueryParams(),r={from:0,start_time:Date.now()-this.state.pollingFrequency,end_time:Date.now()},e.next=4,this.fetchQuery(z(z({},a),r));case 4:n=e.sent,(t=this.logs).push.apply(t,(0,o.default)(n)),this.scrollToBottom();case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"renderSearchBar",value:function(){var e=this.props,a=e.searchInputState,r=e.clustersOpts;return k.default.createElement("div",{className:G.default.searchBar},globals.app.isMultiCluster&&k.default.createElement(N.Select,{value:a.cluster,onChange:this.changeClusterChange,className:G.default.select,valueRenderer:this.clusterRenderer,options:r}),k.default.createElement(M.default,{className:G.default.searchInput,placeholder:t("SEARCH"),onChange:this.onSearchParamsChange,params:a,dropDownItems:V.dropDownItems}),k.default.createElement(N.Select,{value:a.queryMode,onChange:this.changeQueryMode,className:G.default.select,options:V.queryModeOptions}))}},{key:"renderToolBar",value:function(){var e=this.state,a=e.showHistogram,r=e.polling,n=e.pollingFrequency;return k.default.createElement("div",{className:G.default.toolbar},k.default.createElement("div",null,t("TIME_TOPOLOGY"),k.default.createElement("span",{className:G.default.showHistogramBtn,onClick:this.toggleHistogram},a?t("DISPLAY"):t("HIDE"),k.default.createElement(N.Icon,{name:"caret-down",type:"light"}))),k.default.createElement("div",null,k.default.createElement("span",{className:G.default.pollingBtn,onClick:this.togglePolling},k.default.createElement(N.Tooltip,{content:r?t("STOP_REAL_TIME_RESOURCE_EVENT"):t("START_REAL_TIME_RESOURCE_EVENT")},k.default.createElement(N.Icon,{name:r?"stop":"start",type:"light",size:16}))),k.default.createElement("span",{className:G.default.frequencyOpts},k.default.createElement("span",null," ",t("REFRESH_RATE_COLON")),k.default.createElement(N.Select,{value:n,onChange:this.changeFrequency,className:G.default.frequencyOptions,options:this.frequencyOptions}))))}},{key:"renderTimeChart",value:function(){var e=this.store,a=e.logsCount,r=e.histogramData,n=e.interval,l=((0,L.toJS)(r)||{}).buckets,u=void 0===l?[]:l;return k.default.createElement("div",{className:G.default.chartContainer},k.default.createElement("div",{className:G.default.recentSummary},k.default.createElement("h2",{className:G.default.count},a),k.default.createElement("p",null,t("SEARCH_RESULTS"))),k.default.createElement("div",{className:G.default.chart},k.default.createElement(j.default,{xKey:"time",data:u,legend:[["count",t("RESOURCE_EVENT_COUNT")]],interval:n,onBarClick:this.selectedDurationParameter})))}},{key:"render",value:function(){var e=this.state.showHistogram;return k.default.createElement("div",{className:G.default.container},this.renderSearchBar(),k.default.createElement("div",{className:G.default.searchResult},this.renderToolBar(),e&&this.renderTimeChart(),this.renderTable(),this.renderDetailModal()))}},{key:"renderDetailModal",value:function(){var e=this.state,t=e.visible,a=e.detail,r=e.eventMetadata,n=e.showHistogram;return t?k.default.createElement(k.default.Fragment,null,k.default.createElement("div",{className:G.default.mask,onClick:this.onCancel}),k.default.createElement("div",{className:(0,A.default)(G.default.detail,(0,s.default)({},G.default.visibleHeight,n))},k.default.createElement(F.default,{detail:a,eventMetadata:r}))):null}},{key:"defaultDuration",get:function(){return{start_time:0,end_time:Math.ceil(Date.now()/1e3),interval:"1d"}}},{key:"duration",get:function(){var e=(this.props||{}).searchInputState,t=Math.ceil(Date.now()/1e3),a=e.start,r=e.end,n=e.step;return a?{start_time:(0,I.default)([Math.ceil(a),t]),end_time:(0,I.default)([Math.ceil(r),t]),interval:n}:this.defaultDuration}}]),f}(k.default.PureComponent),d=(0,D.default)(f.prototype,"logs",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=(0,D.default)(f.prototype,"tableCols",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{thead:t("TIME"),key:"time",content:function(e){var t=e.lastTimestamp;return"[".concat((0,P.default)(t).format("YYYY-MM-DD HH:mm:ss"),"]")},hidden:!1,className:G.default.timecol},{thead:t("CATEGORY"),key:"type",hidden:!1,content:function(e){var t=e.type;return k.default.createElement("div",{className:(0,A.default)(G.default.category,G.default[t.toLocaleLowerCase()])},t)},className:G.default.typecol},{thead:t("PROJECT"),key:"name",hidden:!1,content:function(e){var t=e.involvedObject;return(void 0===t?{}:t).namespace},className:G.default.namecol},{thead:t("RESOURCE_NAME_AND_TYPE"),key:"kind",hidden:!1,content:function(e){var t=e.involvedObject,a=void 0===t?{}:t;return k.default.createElement(k.Fragment,null,k.default.createElement("div",{className:G.default.kind},a.kind),k.default.createElement("div",{className:G.default.name},a.name))},className:G.default.kindcol},{thead:t("REASON"),key:"reason",hidden:!1,content:function(e){return e.reason},className:G.default.reasoncol},{thead:t("MESSAGE"),key:"message",hidden:!1,content:this.renderHightLightMatchTd,mustShow:!0,className:G.default.messagecol}]}}),(0,D.default)(f.prototype,"refreshQuery",[L.action],Object.getOwnPropertyDescriptor(f.prototype,"refreshQuery"),f.prototype),m=(0,D.default)(f.prototype,"selectedDurationParameter",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.time,r=void 0===a?0:a,n=e.store.interval,l=e.props.searchInputState;l.durationAlias="",l.end=Math.ceil(r/1e3)+(0,V.getSecond)(n),l.start=Math.ceil(r/1e3),l.step=e.getNextStepLevel(n),e.fetchHistogram(),e.refreshQuery()}}}),h=(0,D.default)(f.prototype,"onTableScrollEnd",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.clientHeight,r=t.scrollHeight,n=t.scrollTop;if(Math.ceil(a+n)>=r){var l=e.store,u=l.from,o=l.size;l.total>u+o&&e.loadMoreLogs()}}}}),(0,D.default)(f.prototype,"loadMoreLogs",[L.action],Object.getOwnPropertyDescriptor(f.prototype,"loadMoreLogs"),f.prototype),(0,D.default)(f.prototype,"fetchQuery",[L.action],Object.getOwnPropertyDescriptor(f.prototype,"fetchQuery"),f.prototype),(0,D.default)(f.prototype,"fetchHistogram",[L.action],Object.getOwnPropertyDescriptor(f.prototype,"fetchHistogram"),f.prototype),v=(0,D.default)(f.prototype,"toggleHistogram",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.setState((function(e){return{showHistogram:!e.showHistogram}}))}}}),E=(0,D.default)(f.prototype,"togglePolling",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.state.polling;t?e.stopPolling():e.startPolling(),e.setState({polling:!t})}}}),(0,D.default)(f.prototype,"addPollingQuery",[L.action],Object.getOwnPropertyDescriptor(f.prototype,"addPollingQuery"),f.prototype),y=(0,D.default)(f.prototype,"changeFrequency",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.setState({pollingFrequency:t}),e.state.polling&&(e.stopPolling(),e.startPolling(t))}}}),i=f))||i;a.default=W},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(14),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(14),r(9),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(5)),d=r(189),p=r(56),m=n(r(3140)),h=n(r(3142));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=d.Tabs.TabPanel,y=function(e){(0,o.default)(r,e);var a=v(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).renderHeader=function(e){return i.default.createElement("div",{className:h.default.title},t(e))},e.renderEventMetadata=function(){var t=e.props.eventMetadata,a=void 0===t?[]:t;return e.renderMetadata(a)},e.renderDetail=function(){var a=e.props.detail,r=void 0===a?{}:a,n=r.source,l=void 0===n?{}:n,u=r.involvedObject,o=void 0===u?{}:u,c=r.type,s=r.count,d=r.firstTimestamp,m=r.lastTimestamp;return i.default.createElement("div",{className:h.default.center},i.default.createElement("div",{className:h.default.row},i.default.createElement("div",{className:h.default.rowTitle},t("PROJECT")),i.default.createElement("div",{className:h.default.rowDesc},t(o.namespace)||"-")),i.default.createElement("div",{className:h.default.row},i.default.createElement("div",{className:h.default.rowTitle},t("RESOURCE")),i.default.createElement("div",{className:h.default.rowDesc},i.default.createElement("span",null,"[".concat(o.kind,"]")),i.default.createElement("span",{className:h.default.namespace},o.name))),i.default.createElement("div",{className:h.default.row},i.default.createElement("div",{className:h.default.rowTitle},t("CATEGORY")),i.default.createElement("div",{className:(0,f.default)(h.default.category,h.default[c&&c.toLocaleLowerCase()]),style:{marginLeft:10}},c)),i.default.createElement("div",{className:h.default.row},i.default.createElement("div",{className:h.default.rowTitle},t("COUNT")),i.default.createElement("div",{className:h.default.rowDesc},s||0)),i.default.createElement("div",{className:h.default.row},i.default.createElement("div",{className:h.default.rowTitle},t("SOURCE")),i.default.createElement("div",{className:h.default.rowDesc},t(l.component)||"-")),i.default.createElement("div",{className:h.default.row},i.default.createElement("div",{className:h.default.rowTitle},t("EARLIEST_START_TIME")),i.default.createElement("div",{className:h.default.rowDesc},(0,p.getLocalTime)(d).format("YYYY-MM-DD HH:mm:ss"))),i.default.createElement("div",{className:h.default.row},i.default.createElement("div",{className:h.default.rowTitle},t("LATEST_START_TIME")),i.default.createElement("div",{className:h.default.rowDesc},(0,p.getLocalTime)(m).format("YYYY-MM-DD HH:mm:ss"))))},e.renderFooter=function(){var a=e.props.detail,r=(a=void 0===a?{}:a).reason,n=a.message;return i.default.createElement("div",{className:h.default.bottom},i.default.createElement("div",{className:h.default.reason},t("REASON_VALUE",{value:r})),i.default.createElement("div",{className:h.default.message},t("MESSAGE_VALUE",{value:n})))},e}return(0,u.default)(r,[{key:"renderMetadata",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){var a=Object.keys(t)[0];return i.default.createElement(m.default,{key:a,data:t,renderMetadata:e.renderMetadata})}))}},{key:"render",value:function(){return i.default.createElement(d.Tabs,{direction:"vertical",className:h.default.tabs},i.default.createElement(E,{label:i.default.createElement(d.Icon,{name:"resource",size:16}),name:"resource"},i.default.createElement("div",{className:h.default.content},this.renderHeader("METADATA"),this.renderEventMetadata())),i.default.createElement(E,{label:i.default.createElement(d.Icon,{name:"cloud",size:16}),name:"cloud"},i.default.createElement("div",{className:h.default.content},this.renderHeader("DETAILS"),this.renderDetail(),this.renderFooter())))}}]),r}(i.default.Component);a.default=y},function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(10),a(6),a(27),a(29),a(446),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var n=r(a(246)),l=r(a(31)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=a(189),p=r(a(3141));function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=function(e){(0,c.default)(a,e);var t=v(a);function a(e){var r;return(0,u.default)(this,a),(r=t.call(this,e)).state={data:e.data},r}return(0,o.default)(a,[{key:"onCollapsed",value:function(e){var t=h(h({},e),{},{collapsed:!e.collapsed});this.setState({data:t})}},{key:"render",value:function(){var e=this.state.data,t=Object.keys(e)[0];return"object"===(0,n.default)(e[t])&&null!=e[t]?f.default.createElement("div",{key:t,className:e.collapsed?p.default.close:"",style:{marginLeft:30*e.level}},f.default.createElement("div",{className:p.default.header,onClick:this.onCollapsed.bind(this,e)},f.default.createElement(d.Icon,{name:e.collapsed?"caret-right":"caret-down",size:16})," ",f.default.createElement("span",{className:p.default.title},t)," ",f.default.createElement("span",{className:p.default.count},Object.keys(e[t]).length||0," item")),this.props.renderMetadata(e[t])):f.default.createElement("div",{style:{marginLeft:e.level?30:0,display:"flex"},key:t},f.default.createElement("div",{className:p.default.text},"".concat(t,":"))," ",f.default.createElement("div",{className:p.default.value},"".concat(e[t])))}}]),a}(f.default.Component);t.default=E},function(e,t,a){e.exports={close:"_1ybq6PhKCe4sErBBt12vVg",header:"_1a2u4mWHl-XIXUCqegkkEa",title:"_1p7jwe-sSfl-gQ4MdoR5KC",count:"_3turCguC50Gkd9fwGF4zbI",text:"_1f4clHJHy6Ey5YK4e1NchO",value:"_3wYjBqjLPSSSdAgBS7i_2N"}},function(e,t,a){e.exports={tabs:"_1se9kbNqmbeKE4p5koCxJa",content:"_1139ZVmvCRHutaDUqo57Sm",title:"_1y5Gb9SU-eSKSgp0nm0T_O",center:"_2zRILf8tuqvmuqPrgLfySD",row:"_1GvSL_h1sLQmdtAqwfuF9W",rowTitle:"_3DJwy8Pl_qaJH7gPtGAILb",rowDesc:"_2GN3BlC9zmUvVclXusEqVa",bottom:"WdXl73XqPpDG3shAagx_Q",reason:"_1i02t70FQl-dTwHOf4zppC",message:"_3iHiOmuVf5KTLpKqwbEwQP",category:"Ymlku_NXsyZFYPKJUNB6L",normal:"_1vKkfcZlciv3nX2k3N3WK9",warning:"_1Lr-whxREdm5Kie-sqZiC9"}},function(e,t,a){e.exports={container:"_3gjOLxaR55_4lAD-c5QeAS",searchBar:"_25koHAGBANgQ8lDBfKCbdX",searchInput:"_3zo-xOz0XU_jMzkZsDgZS5",select:"vXXfIYWS9Igrt3UMQ69ED",searchResult:"_27ULQsi85u_C3XiRHCbNi9",toolbar:"dVDpJUjPeZtDgflPwxnr8",frequencyOpts:"_1nVWkpvesnFRWsW63VBTWJ",frequencyOptions:"FM2znfkfXuoCAgcDRMNDW",chartContainer:"_3dM9813Ygax_T5LK5pQezY",recentSummary:"aDQVgehy_qRw2nBwtLup5",chart:"_1aZVmUaijbpEDSfFaoIUUc",mask:"_14qyRF67463X-BroO7yTLb",detail:"_2BTJwh10p9YmMBwAM5PHO1",visibleHeight:"_1qPNFOmSiF41YYFYDzCE5U",table:"_26MTXUcnmnieF4FHKsEBFq",logItem:"ZctOWGJvZHvBkm2pk-nIP",timecol:"_3WIIfq1CJpihKOW_E0RF-_",typecol:"_2b3k2Vcx4BT3oZHo-lwPgN",namecol:"_3WwbzVKpYojUnY_qJElcTF",kindcol:"_3BsEi-O6J5rykxHMBYpwfx",reasoncol:"_3u0LPhavk6Tvf0LXRQY-QF",messagecol:"zY0FOlaYwDkt2a8La_xeU",body:"_23tE4nGfhQixdMKdDzLPUO",hightLightMatch:"_3-zvQSbRFtWxMCrZw2sf93",showHistogramBtn:"_19TWrDuboJwPItxLxY0cpo",exportBtn:"_2KP9BLyxOjvCuW8mE07fu",pollingBtn:"_3z240o33Bn7Ao_t5JmePzb",category:"_1WkGd7I8ASnDx7v5jtDtJK",normal:"_2eBENQgN29gCVl6OF49Id2",warning:"_3cjn-gIz6iRV1yDgf1nxxm",kind:"_2s7GAk0FxLJ2VwzmQfJC4O",name:"_11QPMYc4lwKvOjmkC12V5R"}},function(e,t,a){"use strict";a(16);var r=a(19);a(3),a(20),a(14),a(8),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(3),a(20),a(29),a(14),a(8),a(4),a(21),a(18),a(43),a(11);var n=r(a(317)),l=r(a(38));a(35);var u,o,c=r(a(39)),s=r(a(25)),i=r(a(28)),f=r(a(41)),d=r(a(42)),p=r(a(37)),m=r(a(45)),h=r(a(0)),v=a(243),E=a(17),y=r(a(26)),g=r(a(448)),b=r(a(3145)),S=a(3146);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var O=(0,v.observer)((o=function(e){(0,f.default)(r,e);var t,a=_(r);function r(){var e,t;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).clusters=new g.default,e.formStepState=e.initStepState(),e.searchInputState=((t=(0,E.observable)({query:[],start:"",end:"",step:"",durationAlias:"",nextParamsKey:"",queryMode:1,cluster:""})).setCluster=(0,E.action)((function(e){t.cluster=e})),t),e}return(0,i.default)(r,[{key:"initStepState",value:function(){var e=(0,E.observable)({step:0});return e.next=(0,E.action)((function(){e.step+=1})),e.pre=(0,E.action)((function(){e.step-=1})),e}},{key:"componentDidMount",value:(t=(0,c.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clusters.fetchList({limit:-1,ascending:!0});case 2:this.searchInputState.setCluster((0,y.default)(this,"clustersOpts[0].value",""));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.Content,t=e.Component,a=e.props;if(t)return h.default.createElement("div",{className:b.default.container},h.default.createElement(t,(0,n.default)({clustersOpts:this.clustersOpts,formStepState:this.formStepState},a)))}},{key:"clustersOpts",get:function(){return this.clusters.list.data.map((function(e){var t=e.name;return{value:t,label:t}}))}},{key:"formStepConfig",get:function(){return[{Component:S.Home,props:{searchInputState:this.searchInputState}},{Component:S.Detail,props:{searchInputState:this.searchInputState}}]}},{key:"Content",get:function(){return this.formStepConfig[this.formStepState.step]||{}}}]),r}(h.default.Component),(0,m.default)(o.prototype,"clustersOpts",[E.computed],Object.getOwnPropertyDescriptor(o.prototype,"clustersOpts"),o.prototype),u=o))||u;t.default=O},function(e,t,a){e.exports={container:"_3uZQcYFt5loGNW2yCMBAhN"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Home",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Detail",{enumerable:!0,get:function(){return l.default}});var n=r(a(3147)),l=r(a(3149))},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(442),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(62)),s=n(r(25)),i=n(r(28)),f=n(r(74)),d=n(r(41)),p=n(r(42)),m=n(r(37)),h=n(r(45)),v=(n(r(63)),n(r(0))),E=r(17),y=r(243),g=n(r(245)),b=n(r(5)),S=r(189),_=n(r(971)),O=n(r(969)),C=n(r(1505)),T=r(56),R=r(1506),D=n(r(3148));function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,p.default)(this,a)}}var N=(0,y.observer)((u=function(e){(0,d.default)(r,e);var a=k(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).auditingStore=new C.default,e.watchCluster=function(){var t=e.props.searchInputState;e.disposer=(0,E.reaction)((function(){return t.cluster}),(function(t){""!==t&&e.updateStatistics(t)}))},(0,c.default)(e,"selectedDurationParameter",o,(0,f.default)(e)),e.selectedParameter=function(t){e.props.searchInputState.nextParamsKey=t.currentTarget.dataset.query},e.onSearchParamsChange=function(){e.props.formStepState.next()},e.onClusterChange=function(t){e.props.searchInputState.setCluster(t)},e.clusterRenderer=function(e){return t("CLUSTER_VALUE",{value:e.label})},e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.watchCluster()}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"updateStatistics",value:function(e){this.auditingStore.fetchTodayHistogram({cluster:e}),this.auditingStore.fetchHistogram({cluster:e}),this.auditingStore.fetchQuery({start_time:Math.ceil(Date.now()/1e3)-43200,end_time:Math.ceil(Date.now()/1e3),interval:"24m",cluster:e})}},{key:"render",value:function(){return v.default.createElement("div",null,v.default.createElement("div",{className:D.default.pane},this.renderBanner()),v.default.createElement("div",{className:D.default.tips},v.default.createElement("div",{className:D.default.pane},v.default.createElement(S.Loading,{spinning:this.auditingStore.isHistogramLoading||this.auditingStore.isHistogramTodayLoading},v.default.createElement(v.default.Fragment,null,this.renderSearchBar(),v.default.createElement("h3",{className:D.default.rule},t("QUERYING_RULES")),this.renderRecentLogs())),this.renderQueryItems())))}},{key:"renderBanner",value:function(){var e=this.auditingStore,a=e.histogramTodayData,r=(a=void 0===a?{}:a).events,n=e.isHistogramTodayLoading,l=t.html("ENABLE_AUDIT_LOG_COLLECTION_DESC",{link:"https://kubesphere.io/docs/toolbox/auditing/auditing-receive-customize/#receive-auditing-logs-from-kubernetes"});return v.default.createElement("div",{className:D.default.banner},v.default.createElement("div",{className:D.default.illustration},v.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/log-statistics.svg",alt:"log-statistics"})),v.default.createElement(S.Loading,{spinning:n},v.default.createElement("div",{className:D.default.statistics},v.default.createElement("h3",null,r?t.html("TOTAL_AUDITING_TODAY",{auditing:r,className:D.default.count}):t("NO_AUDIT_LOG_TODAY")),r?v.default.createElement("p",null,v.default.createElement(S.Icon,{name:"clock"}),t("START_TIME_VALUE",{value:"".concat((0,g.default)(new Date).format("YYYY-MM-DD")," 00:00:00")})):null,v.default.createElement("p",{className:D.default.tip},v.default.createElement(S.Icon,{name:"information",color:{primary:"#fff",secondary:"#F5A623"}}),(0,T.htmlLinkControl)(l)))))}},{key:"renderSearchBar",value:function(){var e=this.props,t=e.searchInputState,a=e.clustersOpts;return v.default.createElement("div",{className:D.default.searchBarContainer},v.default.createElement(S.Select,{className:D.default.clusterSelector,value:t.cluster,options:a,valueRenderer:this.clusterRenderer,onChange:this.onClusterChange}),v.default.createElement(_.default,{className:D.default.searchBar,onChange:this.onSearchParamsChange,params:t,dropDownItems:R.dropDownItems}))}},{key:"renderRecentLogs",value:function(){var e=this.auditingStore,a=e.histogramData,r=void 0===a?{}:a,n=e.total,l=e.interval;return v.default.createElement("div",{className:(0,b.default)(D.default.card,D.default.recent)},v.default.createElement("div",{className:D.default.recentSummary},v.default.createElement("h2",{className:D.default.count},n||0),v.default.createElement("p",null,t("AUDIT_LOGS_12H"))),v.default.createElement("div",{className:D.default.chart},v.default.createElement(O.default,{xKey:"time",data:(0,E.toJS)(r.buckets||[]),legend:[["count",t("AUDIT_LOG_COUNT")]],interval:l||"30m",onBarClick:this.selectedDurationParameter})))}},{key:"renderQueryItems",value:function(){var e=this;return R.supportQueryParams.map((function(t){return v.default.createElement("div",{className:(0,b.default)(D.default.card,D.default.category),key:t.key,"data-query":t.key,onClick:e.selectedParameter},v.default.createElement("div",{className:D.default.icon},t.iconUrl?v.default.createElement("div",null,v.default.createElement("img",{alt:"icon",src:t.iconUrl})):v.default.createElement(S.Icon,{name:t.icon,size:40})),v.default.createElement("div",{className:D.default.desc},v.default.createElement("h4",null,t.title),v.default.createElement("p",null,t.tips)))}))}}]),r}(v.default.Component),o=(0,h.default)(u.prototype,"selectedDurationParameter",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.time,r=void 0===a?0:a,n=e.auditingStore.interval,l=e.props.searchInputState;l.durationAlias="",l.end=Math.ceil(r/1e3)+(0,R.getSecond)(n),l.start=Math.ceil(r/1e3),l.step="1m",e.onSearchParamsChange()}}}),l=u))||l;a.default=N},function(e,t,a){e.exports={tips:"_1VtgWiKRd_U33dsEufRwnV",rule:"_1QdP7uSc0e-A_-4bcxFMlN",searchBar:"_2-AjNx8g4uFxprutd36N90",pane:"_2wRJs3tk_X3Jlqathd-yNg",card:"_3mkuDJ9H8N54oZ93otNPOh",count:"hBUtk8OzXjNS1s4ii8Guh",banner:"_1wojFujr9YiM_ne9OJpzCH",illustration:"_3Bnzh7zNGFEdB8sW9D1eny",statistics:"_2r0KI2FnmKH4AHVQJwJdhK",category:"mRFyTP3fWxl2C6H7l4Z78",icon:"_3tFUNiXFwgA1VYQI7-58g8",desc:"_3fLQRwf0dnfVAauFnE16OM",recent:"TvUOGqNnW_iyDKfWn69SL",recentSummary:"eWOb0aa4fIssJ6ozBxOa3",chart:"_3cBgRlz5zX8dwPNDSNTonQ",searchBarContainer:"_3ty4EH3Pnl8WV44LeUpkfi",clusterSelector:"p5RuoM3Ganr0_URyaNg5u"}},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(199),r(6),r(20),r(87),r(14),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(69),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(199),r(6),r(20),r(27),r(87),r(442),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(30),r(11),r(69),r(7),r(110);var u=n(r(97)),o=n(r(58)),c=n(r(38)),s=n(r(31));r(35);var i,f,d,p,m,h,v,E,y,g,b=n(r(39)),S=n(r(62)),_=n(r(25)),O=n(r(28)),C=n(r(74)),T=n(r(41)),R=n(r(42)),D=n(r(37)),k=n(r(45)),N=(n(r(63)),l(r(0))),I=r(189),P=n(r(26)),A=n(r(906)),w=n(r(245)),L=n(r(5)),M=r(243),x=r(17),j=n(r(971)),U=n(r(1200)),F=n(r(969)),V=n(r(1505)),G=n(r(3150)),B=r(1506),z=n(r(3154));function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,D.default)(e);if(t){var n=(0,D.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,R.default)(this,a)}}var K=600,W="10s",Q=["m","h","d","M","y"],J=(0,M.observer)((f=function(e){(0,T.default)(i,e);var a,r,n,l=q(i);function i(e){var a;return(0,_.default)(this,i),a=l.call(this,e),(0,S.default)(a,"logs",d,(0,C.default)(a)),(0,S.default)(a,"loading",p,(0,C.default)(a)),(0,S.default)(a,"tableCols",m,(0,C.default)(a)),(0,S.default)(a,"selectedDurationParameter",h,(0,C.default)(a)),(0,S.default)(a,"onTableScrollEnd",v,(0,C.default)(a)),a.onSearchParamsChange=function(){a.stopPolling(),a.refreshQuery(),a.fetchHistogram()},(0,S.default)(a,"toggleHistogram",E,(0,C.default)(a)),(0,S.default)(a,"togglePolling",y,(0,C.default)(a)),a.poll=function(){var e=a.props.searchInputState,t=K,r=W;e.end=Math.ceil(Date.now()/1e3),e.start=e.end-t,e.step=r,e.durationAlias="".concat(t/60,"m"),a.fetchHistogram(),a.refreshQuery()},(0,S.default)(a,"changeFrequency",g,(0,C.default)(a)),a.changeQueryMode=function(e){a.props.searchInputState.queryMode=e,a.onSearchParamsChange()},a.changeClusterChange=function(e){a.props.searchInputState.setCluster(e),a.onSearchParamsChange()},a.onCancel=function(){a.setState({visible:!1})},a.openDetailsModal=function(e){a.setState({detail:e,eventMetadata:(0,B.toArray)(e),visible:!0})},a.clusterRenderer=function(e){return t("CLUSTER_VALUE",{value:e.label})},a.renderTable=function(){return N.default.createElement("div",{className:z.default.table},N.default.createElement(U.default,{onScroll:a.onTableScrollEnd,onTrClick:a.openDetailsModal,cols:a.tableCols,data:a.logs,body:z.default.body}))},a.state={visible:!1,detail:{},eventMetadata:[],showHistogram:!0,polling:!1,pollingFrequency:5e3},a.frequencyOptions=[5,10,15].map((function(e){return{value:1e3*e,label:"".concat(t("TIME_S",{num:e}))}})),a.store=new V.default({size:50}),a}return(0,O.default)(i,[{key:"componentDidMount",value:function(){this.refreshQuery(),this.fetchHistogram()}},{key:"componentWillUnmount",value:function(){this.stopPolling()}},{key:"refreshQuery",value:(n=(0,b.default)(c.default.mark((function e(){var t;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,this.store.from=0,t=this.getQueryParams(),e.next=5,this.fetchQuery(H(H({},t),this.duration));case 5:this.logs=e.sent,this.loading=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"loadMoreLogs",value:(r=(0,b.default)(c.default.mark((function e(){var t,a,r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.store.from+this.store.size,e.next=3,this.fetchQuery(H(H({},this.store.preParams),{from:a}));case 3:r=e.sent,(t=this.logs).push.apply(t,(0,o.default)(r));case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getNextStepLevel",value:function(e){var t=e.match(/\d+(\w+)$/),a=(0,u.default)(t,2)[1],r=void 0===a?"m":a,n=Q.findIndex((function(e){return e===r}));return"1".concat(n<1?Q[0]:Q[n-1])}},{key:"fetchQuery",value:(a=(0,b.default)(c.default.mark((function e(t){var a,r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.searchInputState.cluster,r=H(H({},t),{},{cluster:a}),e.next=4,this.store.fetchQuery(r);case 4:return e.abrupt("return",this.store.data);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchHistogram",value:function(){var e=this.getQueryParams();this.store.interval=this.duration.interval,this.store.fetchHistogram(H(H({},e),this.duration))}},{key:"getQueryParams",value:function(){var e=this.props.searchInputState,t=e.query,a=e.queryMode,r=e.cluster;return t.filter((function(e){return e.key})).reduce((function(e,t){var r=t.key,n=t.value,l=a?r:B.queryKeyMapping[r],u=e[l];return e[l]=u?"".concat(u,",").concat(n):n,e}),{cluster:r})}},{key:"startPolling",value:function(){this.poll(),this.pollingInterval=setInterval(this.poll,this.state.pollingFrequency)}},{key:"stopPolling",value:function(){this.setState({polling:!1}),clearInterval(this.pollingInterval)}},{key:"renderSearchBar",value:function(){var e=this.props,a=e.searchInputState,r=e.clustersOpts;return N.default.createElement("div",{className:z.default.searchBar},globals.app.isMultiCluster&&N.default.createElement(I.Select,{value:a.cluster,onChange:this.changeClusterChange,className:z.default.select,valueRenderer:this.clusterRenderer,options:r}),N.default.createElement(j.default,{className:z.default.searchInput,placeholder:t("SEARCH"),onChange:this.onSearchParamsChange,params:a,dropDownItems:B.dropDownItems}),N.default.createElement(I.Select,{value:a.queryMode,onChange:this.changeQueryMode,className:z.default.select,options:B.queryModeOptions}))}},{key:"renderToolBar",value:function(){var e=this.state,a=e.showHistogram,r=e.polling,n=e.pollingFrequency;return N.default.createElement("div",{className:z.default.toolbar},N.default.createElement("div",null,t("TIME_TOPOLOGY"),N.default.createElement("span",{className:z.default.showHistogramBtn,onClick:this.toggleHistogram},a?t("DISPLAY"):t("HIDE"),N.default.createElement(I.Icon,{name:"caret-down",type:"light"}))),N.default.createElement("div",null,N.default.createElement("span",{className:z.default.pollingBtn,onClick:this.togglePolling},N.default.createElement(I.Tooltip,{content:r?t("STOP_REAL_TIME_AUDIT_LOG"):t("START_REAL_TIME_AUDIT_LOG")},N.default.createElement(I.Icon,{name:r?"stop":"start",type:"light",size:16}))),N.default.createElement("span",{className:z.default.frequencyOpts},N.default.createElement("span",null," ",t("REFRESH_RATE_COLON")),N.default.createElement(I.Select,{value:n,onChange:this.changeFrequency,className:z.default.frequencyOptions,options:this.frequencyOptions}))))}},{key:"renderTimeChart",value:function(){var e=this.store,a=e.logsCount,r=e.histogramData,n=e.interval,l=((0,x.toJS)(r)||{}).buckets,u=void 0===l?[]:l;return N.default.createElement("div",{className:z.default.chartContainer},N.default.createElement("div",{className:z.default.recentSummary},N.default.createElement("h2",{className:z.default.count},a),N.default.createElement("p",null,t("SEARCH_RESULTS"))),N.default.createElement("div",{className:z.default.chart},N.default.createElement(F.default,{xKey:"time",data:u,legend:[["count",t("AUDIT_LOG_COUNT")]],interval:n,onBarClick:this.selectedDurationParameter})))}},{key:"render",value:function(){var e=this.state.showHistogram;return N.default.createElement("div",{className:z.default.container},N.default.createElement(I.Loading,{spinning:this.loading},this.renderSearchBar()),N.default.createElement("div",{className:z.default.searchResult},N.default.createElement(I.Loading,{spinning:this.loading},N.default.createElement(N.default.Fragment,null,this.renderToolBar(),e&&this.renderTimeChart())),this.renderTable(),this.renderDetailModal()))}},{key:"renderDetailModal",value:function(){var e=this.state,t=e.visible,a=e.detail,r=e.eventMetadata,n=e.showHistogram;return t?N.default.createElement(N.Fragment,null,N.default.createElement("div",{className:z.default.mask,onClick:this.onCancel}),N.default.createElement("div",{className:(0,L.default)(z.default.detail,(0,s.default)({},z.default.visibleHeight,n))},N.default.createElement(G.default,{detail:a,eventMetadata:r}))):null}},{key:"defaultDuration",get:function(){return{start_time:0,end_time:Math.ceil(Date.now()/1e3),interval:"1d"}}},{key:"duration",get:function(){var e=(this.props||{}).searchInputState,t=Math.ceil(Date.now()/1e3),a=e.start,r=e.end,n=e.step;return a?{start_time:(0,A.default)([Math.ceil(a),t]),end_time:(0,A.default)([Math.ceil(r),t]),interval:n}:this.defaultDuration}}]),i}(N.default.PureComponent),d=(0,k.default)(f.prototype,"logs",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=(0,k.default)(f.prototype,"loading",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),m=(0,k.default)(f.prototype,"tableCols",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{thead:t("TIME"),key:"Time",content:function(e){var t=e.RequestReceivedTimestamp;return"[".concat((0,w.default)(t).format("YYYY-MM-DD HH:mm:ss"),"]")},hidden:!1,className:z.default.timecol},{thead:t("VERB"),key:"verb",hidden:!1,content:function(e){return e.Verb},className:z.default.Verbcol},{thead:t("STATUS_CODE"),key:"Status Code",hidden:!1,content:function(e){var t=e.ResponseStatus;return(0,P.default)(t,"code")||""},className:z.default.statuscol},{thead:t("WORKSPACE"),key:"Workspace",hidden:!1,content:function(e){return e.Workspace},className:z.default.workspacecol},{thead:t("PROJECT"),key:"Project",hidden:!1,content:function(e){var t=e.ObjectRef;return(0,P.default)(t,"Namespace")},className:z.default.namespacecol},{thead:t("REASON"),key:"reason",hidden:!0,content:function(e){var t=e.ResponseStatus;return(0,P.default)(t,"reason")},className:z.default.reasoncol},{thead:t("RESOURCE_NAME_AND_TYPE"),key:"resources",hidden:!1,content:function(e){var t=e.ObjectRef,a=void 0===t?{}:t;return N.default.createElement(N.Fragment,null,N.default.createElement("div",{className:z.default.kind},a.Resource),N.default.createElement("div",{className:z.default.name},a.Name))},className:z.default.namecol},{thead:t("SUBRESOURCE"),key:"Subresource",hidden:!0,content:function(e){var t=e.ObjectRef;return(0,P.default)(t,"Subresource")},className:z.default.subresourcecol},{thead:t("OPERATOR"),key:"Operation Account",hidden:!1,content:function(e){var t=e.User;return(0,P.default)(t,"Username")},className:z.default.usernamecol},{thead:t("SOURCE_IP_ADDRESS"),key:"sourceIP",hidden:!0,content:function(e){return e.SourceIPs},className:z.default.messagecol}]}}),(0,k.default)(f.prototype,"refreshQuery",[x.action],Object.getOwnPropertyDescriptor(f.prototype,"refreshQuery"),f.prototype),h=(0,k.default)(f.prototype,"selectedDurationParameter",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.time,r=void 0===a?0:a,n=e.store.interval,l=e.props.searchInputState;l.durationAlias="",l.end=Math.ceil(r/1e3)+(0,B.getSecond)(n),l.start=Math.ceil(r/1e3),l.step=e.getNextStepLevel(n),e.fetchHistogram(),e.refreshQuery()}}}),v=(0,k.default)(f.prototype,"onTableScrollEnd",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.clientHeight,r=t.scrollHeight,n=t.scrollTop;if(Math.ceil(a+n)>=r){var l=e.store,u=l.from,o=l.size;l.total>u+o&&e.loadMoreLogs()}}}}),(0,k.default)(f.prototype,"loadMoreLogs",[x.action],Object.getOwnPropertyDescriptor(f.prototype,"loadMoreLogs"),f.prototype),(0,k.default)(f.prototype,"fetchQuery",[x.action],Object.getOwnPropertyDescriptor(f.prototype,"fetchQuery"),f.prototype),(0,k.default)(f.prototype,"fetchHistogram",[x.action],Object.getOwnPropertyDescriptor(f.prototype,"fetchHistogram"),f.prototype),E=(0,k.default)(f.prototype,"toggleHistogram",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.setState((function(e){return{showHistogram:!e.showHistogram}}))}}}),y=(0,k.default)(f.prototype,"togglePolling",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.state.polling;t?e.stopPolling():e.startPolling(),e.setState({polling:!t})}}}),g=(0,k.default)(f.prototype,"changeFrequency",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.setState({pollingFrequency:t}),e.state.polling&&(e.stopPolling(),e.startPolling())}}}),i=f))||i;a.default=J},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(9),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(3151)),p=n(r(3153));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=f.Tabs.TabPanel,v=function(e){(0,o.default)(r,e);var a=m(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).renderHeader=function(e){return i.default.createElement("div",{className:p.default.title},t(e))},e.renderEventMetadata=function(){var t=e.props.eventMetadata,a=void 0===t?[]:t;return e.renderMetadata(a)},e}return(0,u.default)(r,[{key:"renderMetadata",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){var a=Object.keys(t)[0];return i.default.createElement(d.default,{key:a,data:t,renderMetadata:e.renderMetadata})}))}},{key:"render",value:function(){return i.default.createElement(f.Tabs,{direction:"vertical",className:p.default.tabs},i.default.createElement(h,{label:i.default.createElement(f.Icon,{name:"resource",size:16}),name:"resource"},i.default.createElement("div",{className:p.default.content},this.renderHeader("METADATA"),this.renderEventMetadata())))}}]),r}(i.default.Component);a.default=v},function(e,t,a){"use strict";var r=a(19);a(12),a(10),a(6),a(8),a(13),a(9),a(4),a(18),a(11),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(32),a(10),a(6),a(27),a(29),a(446),a(33),a(16),a(8),a(13),a(9),a(4),a(18),a(43),a(11),a(7);var n=r(a(246)),l=r(a(31)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=a(189),p=r(a(3152));function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var E=function(e){(0,c.default)(a,e);var t=v(a);function a(e){var r;return(0,u.default)(this,a),(r=t.call(this,e)).state={data:e.data},r}return(0,o.default)(a,[{key:"onCollapsed",value:function(e){var t=h(h({},e),{},{collapsed:!e.collapsed});this.setState({data:t})}},{key:"render",value:function(){var e=this.state.data,t=Object.keys(e)[0];return"object"===(0,n.default)(e[t])&&null!=e[t]?f.default.createElement("div",{key:t,className:e.collapsed?p.default.close:"",style:{marginLeft:30*e.level}},f.default.createElement("div",{className:p.default.header,onClick:this.onCollapsed.bind(this,e)},f.default.createElement(d.Icon,{name:e.collapsed?"caret-right":"caret-down",size:16})," ",f.default.createElement("span",{className:p.default.title},t)," ",f.default.createElement("span",{className:p.default.count},Object.keys(e[t]).length||0," item")),this.props.renderMetadata(e[t])):f.default.createElement("div",{style:{marginLeft:e.level?30:0,display:"flex"},key:t},f.default.createElement("div",{className:p.default.text},"".concat(t,":"))," ",f.default.createElement("div",{className:p.default.value},"".concat(e[t])))}}]),a}(f.default.Component);t.default=E},function(e,t,a){e.exports={close:"_1rB-UpDTVUT7Tj3ErCWLpo",header:"f7FskCVZWpbbKK9MImJc9",title:"_1kqt_W0OCu9DbxD33SlkX-",count:"_24d4RSAJ0oKwEA74aMta2y",text:"_3OaQdAKM0R7RXwkPWTxEQP",value:"k4jAzjMhZd8umcSMejvVb"}},function(e,t,a){e.exports={tabs:"KKvcEADuIO6BDp__BjIEv",content:"_2srMJMQLn3PeTDKKxhADQj",title:"_3t84StKrRx3W7zbD2MJ6Gc",category:"_3QJ0jvrznD9x7zIIwI4New",normal:"_2ybdgxuyr7NteIgPikT0B",warning:"_2New8b8tNSWOWV3ovwC1Xo"}},function(e,t,a){e.exports={container:"_1LLV-6j1suy8IikTmy-cwl",searchBar:"_1wryW4dN7_ULJ0sN1XtJm1",searchInput:"_11WCqh1QFrt19Yyf6voLkO",select:"f94_5VyFkKE0ONNXc2apR",searchResult:"_27fN00EIeu5fTJP6JunHsx",toolbar:"_1noTiX34KNFgB5X-c2G734",frequencyOpts:"_2n0mCEH3w-NnOHuBajFz-",frequencyOptions:"_2duvbZPUKy3cvyIhPQ9dyN",chartContainer:"_1WzBTOPncvRnPYHMK0hYeN",recentSummary:"_16evX7F4VGN5FqxD6ARmIH",chart:"C98Lov6shKNVDhWxHWmST",mask:"_3zMAvxEKGyNGxkYsENGaAw",detail:"AM6K7BeUuX7AosbH06Ur_",visibleHeight:"_2iEbFwF0hIjYotC6-fklQH",table:"BII9Ztp2DVyUC9wUqSSwb",logItem:"Kxj325kWlhvTXLe3FP9r1",timecol:"LV51IOdWZ_PWzQTc9Uncv",Verbcol:"_2gOOdfNcPohLKtB3nnlPLD",statuscol:"_2s7c5gZwOgb7jcTcNqv79T",reasoncol:"RlTq96EZ4CRBJTfWUEYMX",kind:"_2sJ-n9LGXQZmGRQ0THc1lX",name:"yfCEePn_v7CEs7MsCtJwi",namecol:"_2BPEDinBWaqBwHwmwqzv1Y",subresourcecol:"_1QNb-F_VeBcPRsydvWthCY",namespacecol:"na558eS2eVwf8rJ1ahyIL",workspacecol:"_2RIQ9dHrDg7qIfk1JHAvIV",usernamecol:"_1IgkoyBBq2UXduYvqr0-Yy",body:"_2gCVwaX4qKXIKTA5UEyYnm",showHistogramBtn:"_3b_x2XDPjbDISooqYGps9s",exportBtn:"iQvfLyqh_P4_NB-zdMaD",pollingBtn:"RXdqpAESZnnwa2Kn_Vl35"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7),r(110);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(798)),f=n(r(3197)),d=n(r(3199)),p=n(r(3201)),m=n(r(68));function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E={"user.create":{on:function(e){var a,r=e.store,n=e.success,o=(0,c.default)(e,["store","success"]),d=i.default.open(v({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=3;break}return i.default.close(d),e.abrupt("return");case 3:return(0,m.default)(a,'metadata.annotations["iam.kubesphere.io/uninitialized"]',"true"),e.next=6,r.create(a);case 6:i.default.close(d),s.default.success({content:t("CREATE_SUCCESSFUL")}),n&&n();case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:f.default,store:r},o))}},"user.edit":{on:function(e){var a,r=e.store,n=e.detail,o=e.success,d=(0,c.default)(e,["store","detail","success"]),p=i.default.open(v({onOk:(a=(0,u.default)(l.default.mark((function e(a){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=3;break}return i.default.close(p),e.abrupt("return");case 3:return(0,m.default)(a,"metadata.resourceVersion",n.resourceVersion),e.next=6,r.update(n,a);case 6:i.default.close(p),s.default.success({content:t("UPDATE_SUCCESSFUL")}),o&&o();case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:f.default,detail:n,store:r},d))}},"user.setting":{on:function(e){var a,r=e.store,n=e.success,o=(0,c.default)(e,["store","success"]),f=i.default.open(v({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,d;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=3;break}return i.default.close(f),e.abrupt("return");case 3:if(u=a.currentPassword,o=a.password,a.rePassword,d=(0,c.default)(a,["currentPassword","password","rePassword"]),!u||!o){e.next=10;break}return e.next=7,r.modifyPassword({name:globals.user.username},{currentPassword:u,password:o});case 7:setTimeout((function(){location.href="/login"}),1e3),e.next=12;break;case 10:return e.next=12,r.update({name:globals.user.username},d);case 12:i.default.close(f),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 15:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:p.default,store:r},o))}},"user.modifypassword":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=i.default.open(v({onOk:function(e){e?a.modifyPassword(r,e).then((function(){i.default.close(u),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n()})):i.default.close(u)},modal:d.default,detail:r,store:a},l))}}};a.default=E},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(109),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u,o,c,s,i=n(r(317)),f=n(r(50)),d=n(r(31)),p=n(r(25)),m=n(r(28)),h=n(r(41)),v=n(r(42)),E=n(r(37)),y=n(r(45)),g=n(r(26)),b=l(r(0)),S=n(r(1)),_=r(17),O=r(243),C=r(189),T=n(r(798)),R=n(r(1006)),D=r(56),k=r(61),N=n(r(322)),I=n(r(3198));function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,d.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,E.default)(e);if(t){var n=(0,E.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,v.default)(this,a)}}var L=(0,O.observer)((s=c=function(e){(0,h.default)(r,e);var a=w(r);function r(){var e;(0,p.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).state={formTemplate:A({apiVersion:"iam.kubesphere.io/v1alpha2",kind:"User"},(0,g.default)(e.props,"detail._originData",{}))},e.globalRoleStore=new N.default("globalroles"),e.userNameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:r}).then((function(e){if(e.exist)return n({message:t("USERNAME_EXISTS"),field:a.field});n()}))},e.emailValidator=function(a,r,n){if(!r)return n();e.props.store.checkEmail(r).then((function(e){if(e.exist)return n({message:t("EMAIL_EXISTS"),field:a.field});n()}))},e.optionRenderer=function(e){return b.default.createElement("div",{className:I.default.option},b.default.createElement("div",null,e.item.name),b.default.createElement("p",null,e.item.description))},e}return(0,m.default)(r,[{key:"componentDidMount",value:function(){this.globalRoleStore.fetchList({limit:-1,sortBy:"createTime"})}},{key:"render",value:function(){var e=this.props,a=(e.store,e.detail),r=(0,f.default)(e,["store","detail"]),n=a?"EDIT_USER":"CREATE_USER",l=a?[{required:!0,message:t("USERNAME_EMPTY_DESC")}]:[{required:!0,message:t("USERNAME_EMPTY_DESC")},{pattern:k.PATTERN_USER_NAME,message:t("USERNAME_INVALID",{message:t("USERNAME_DESC")})},{validator:this.userNameValidator}],u=a?[{required:!0,message:t("EMAIL_EMPTY_DESC")}]:[{required:!0,message:t("EMAIL_EMPTY_DESC")},{type:"email",message:t("INVALID_EMAIL")},{validator:this.emailValidator}];return b.default.createElement(T.default.Form,(0,i.default)({title:t(n),icon:"human",width:691,data:this.state.formTemplate},r),b.default.createElement("input",{name:"username",className:"hidden-input",type:"text",disabled:!0}),b.default.createElement("input",{name:"password",className:"hidden-input",type:"password",disabled:!0}),b.default.createElement(C.Form.Item,{label:t("USERNAME"),desc:t("USERNAME_DESC"),rules:l},b.default.createElement(C.Input,{name:"metadata.name",autoComplete:"nope",disabled:!!a,autoFocus:!0,maxLength:32})),b.default.createElement(C.Form.Item,{label:t("EMAIL"),desc:t("EMAIL_DESC"),rules:u},b.default.createElement(C.Input,{name:"spec.email",placeholder:"user@example.com",autoComplete:"nope"})),b.default.createElement(C.Form.Item,{label:t("PLATFORM_ROLE"),desc:t("PLATFORM_ROLE_DESC")},b.default.createElement(C.Select,{name:"metadata.annotations['iam.kubesphere.io/globalrole']",optionRenderer:this.optionRenderer,options:this.globalRoles,placeholder:" "})),!a&&b.default.createElement(C.Form.Item,{className:I.default.password,label:t("PASSWORD"),desc:t("PASSWORD_DESC"),rules:[{required:!0,message:t("PASSWORD_EMPTY_DESC")},{pattern:k.PATTERN_PASSWORD,message:t("PASSWORD_INVALID_DESC")}]},b.default.createElement(R.default,{name:"spec.password",autoComplete:"nope",withStrength:!0})),b.default.createElement(C.Form.Item,{className:I.default.textarea,label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},b.default.createElement(C.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256,rows:"3"})))}},{key:"globalRoles",get:function(){return this.globalRoleStore.list.data.filter((function(e){return!(0,D.isSystemRole)(e.name)})).map((function(e){return{label:e.name,value:e.name,item:e}}))}}]),r}(b.Component),c.propTypes={store:S.default.object,detail:S.default.object,visible:S.default.bool,onOk:S.default.func,onCancel:S.default.func,isSubmitting:S.default.bool},c.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}},o=s,(0,y.default)(o.prototype,"globalRoles",[_.computed],Object.getOwnPropertyDescriptor(o.prototype,"globalRoles"),o.prototype),u=o))||u;a.default=L},function(e,t,a){e.exports={password:"_1ADG5zIrZxFGThHw8n2EmT",textarea:"_3AQG3DTgv4CDYCBILVvos",option:"iR3e_Ox7Wx4eRyBl51gWs"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(50)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(1)),h=r(189),v=l(r(798)),E=l(r(1006)),y=r(61),g=l(r(3200));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var S=function(e){(0,i.default)(r,e);var a=b(r);function r(){var e;(0,c.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).state={password:"",formData:{}},e.handlePassswordChange=function(t){e.setState({password:t})},e.passwordValidator=function(a,r,n){if(!r)return n();r!==e.state.password&&n({message:t("PASSWORD_NOT_SAME_DESC"),field:a.field}),n()},e}return(0,s.default)(r,[{key:"render",value:function(){var e=this.props,a=e.detail,r=(0,o.default)(e,["detail"]);return p.default.createElement(v.default.Form,(0,u.default)({title:t("CHANGE_PASSWORD"),icon:"pen",width:691,data:this.state.formData},r),p.default.createElement("input",{name:"username",className:"hidden-input",type:"text",disabled:!0}),p.default.createElement("input",{name:"password",className:"hidden-input",type:"password",disabled:!0}),p.default.createElement(h.Form.Item,{label:t("EMAIL")},p.default.createElement(h.Input,{disabled:!0,value:a.email})),p.default.createElement(h.Form.Item,{className:g.default.password,label:t("NEW_PASSWORD"),rules:[{required:!0,message:t("PASSWORD_EMPTY_DESC")},{pattern:y.PATTERN_PASSWORD,message:t("PASSWORD_DESC")}]},p.default.createElement(E.default,{name:"password",autoComplete:"new-password",onChange:this.handlePassswordChange,withStrength:!0})),p.default.createElement(h.Form.Item,{className:g.default.password,label:t("CONFIRM_PASSWORD"),rules:[{required:!0,message:t("CONFIRM_PASSWORD_TIP")},{validator:this.passwordValidator}]},p.default.createElement(E.default,{name:"rePassword",placeholder:" ",autoComplete:"new-password"})),p.default.createElement("div",{style:{height:200}}))}}]),r}(p.Component);a.default=S,S.propTypes={detail:m.default.object,visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func},S.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={password:"_1Y4vNVcj5FUe5828ELzjaG",textarea:"_3qpHbW3KqGgth2GS-KMzr1",option:"_1z2QQj33fVWgBm8KRBy7H0"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(50)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(26)),m=n(r(68)),h=n(r(201)),v=n(r(119)),E=n(r(67)),y=n(r(0)),g=n(r(5)),b=n(r(1)),S=r(17),_=r(189),O=n(r(798)),C=n(r(840)),T=n(r(323)),R=n(r(3202)),D=n(r(3207));function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var P=function(e){(0,i.default)(r,e);var a=I(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).registerUpdate=function(e,a){var r=t.state.updatedTabs;(0,h.default)(r,e)||t.setState({updatedTabs:N(N({},r),{},(0,o.default)({},e,a))})},t.handleChangeTab=function(e){var a=e.currentTarget.dataset.name;a&&t.setState({activeTab:a,subRoute:{}})},t.handleSaveChanges=function(e){return function(){var a=t.props.onOk,r=t["".concat(e,"FormRef")].current;r&&r.validate((function(){var n=r.getData();a(n),t.cancelUpdate(e)}))}},t.handleDiscardChanges=function(e){return function(){var a=t["".concat(e,"Ref")].current;a&&(a.resetData(),t.cancelUpdate(e))}},t.cancelUpdate=function(e){var a=N({},t.state.updatedTabs);delete a[e],t.setState({updatedTabs:a})},t.renderForm=function(e){var a=e.name,r=e.component,n=t.props.store,l=t.state.activeTab,u=r;if(!u)return null;var c="".concat(a,"Ref");t[c]||(t[c]=y.default.createRef());var s="".concat(a,"FormRef");return t[s]||(t[s]=y.default.createRef()),y.default.createElement("div",{key:a,className:(0,g.default)(D.default.form,(0,o.default)({},D.default.active,a===l))},y.default.createElement(u,{store:n,ref:t[c],formRef:t[s],formData:t.state.formData}))},t.state={formData:{},activeTab:(0,p.default)(t.tabs,"[0].name"),updatedTabs:{}},t.store=new T.default,t}return(0,s.default)(r,[{key:"getChildContext",value:function(){return{registerUpdate:this.registerUpdate}}}]),(0,s.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.store.fetchDetail({name:globals.user.username}).then((function(){var t=N({apiVersion:"iam.kubesphere.io/v1beta1",kind:"User"},(0,v.default)((0,S.toJS)(e.store.detail._originData)));(0,m.default)(t,"metadata.resourceVersion",e.store.detail.resourceVersion),e.setState({formData:t})}))}},{key:"renderTabs",value:function(){var e=this;return y.default.createElement("ul",{className:D.default.tabs},this.tabs.map((function(a){var r=a.icon,n=void 0===r?"appcenter":r,l=a.title,u=a.name,c=e.state,s=c.activeTab,i=c.updatedTabs,f=u===s,d=f?"light":"dark";return y.default.createElement("li",{onClick:e.handleChangeTab,key:l,"data-name":u,className:(0,g.default)((0,o.default)({},D.default.active,f))},y.default.createElement(_.Tooltip,{placement:"bottomLeft",content:(0,h.default)(i,u)?e.updateTip:""},y.default.createElement("span",{className:D.default.tooltipTrigger},y.default.createElement(_.Icon,{name:n,size:16,type:d}),(0,h.default)(i,u)&&y.default.createElement("span",{className:D.default.tipIcon}))),y.default.createElement("p",null,t(l)))})))}},{key:"renderFormComponents",value:function(){var e=this.state,t=e.activeTab,a=e.updatedTabs;return y.default.createElement("div",{className:D.default.formWrapper},this.tabs.map(this.renderForm),y.default.createElement("div",{className:(0,g.default)(D.default.operations,(0,o.default)({},D.default.active,(0,h.default)(a,t)))},y.default.createElement(C.default,{className:D.default.confirm,onOk:this.handleSaveChanges(t),onCancel:this.handleDiscardChanges(t)})))}},{key:"renderContent",value:function(){return y.default.createElement("div",{className:D.default.content},y.default.createElement("div",{className:D.default.forms},this.renderTabs(),this.renderFormComponents()))}},{key:"renderFooter",value:function(){var e=this.state.subRoute,a=void 0===e?{}:e,r=a.onCancel,n=a.onSave;return y.default.createElement("div",{className:D.default.footer},r&&y.default.createElement(_.Button,{onClick:this.handlePrev},t("PREVIOUS")),n&&y.default.createElement(_.Button,{type:"control",onClick:this.handleSubFormSave},t("OK")),(0,E.default)(a)&&y.default.createElement(_.Button,{onClick:this.props.onCancel},t("CLOSE")))}},{key:"render",value:function(){var e=this.props,a=(e.detail,e.onOk,(0,u.default)(e,["detail","onOk"]));return y.default.createElement(O.default,(0,l.default)({bodyClassName:D.default.body,title:t("USER_SETTINGS"),icon:"wrench",width:1162,hideFooter:!0},a),y.default.createElement("div",{className:D.default.main},this.renderContent(),this.renderFooter()))}},{key:"updateTip",get:function(){return y.default.createElement("div",{className:D.default.tip},y.default.createElement("h6",null,t("CONTENT_NOT_SAVED_TIPS")),y.default.createElement("p",null,t("SAVE_EDIT_HINTS")))}},{key:"tabs",get:function(){return R.default}}]),r}(y.default.Component);a.default=P,P.propTypes={visible:b.default.bool,onOk:b.default.func,onCancel:b.default.func},P.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},P.childContextTypes={registerUpdate:b.default.func}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(3203)),l=r(a(3205)),u=[{icon:"paper",name:"basicInfo",title:"BASIC_INFORMATION",component:n.default},{icon:"ssh",name:"passwordSetting",title:"PASSWORD_SETTINGS",component:l.default}];t.default=u},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(119)),m=r(56),h=n(r(203)),v=n(r(3204));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).resetData=function(){t.setState({formData:t.getInitialData()})},t.handleFormChange=function(e,a){t.context.registerUpdate(t.name,{name:e,value:a})},t.state={formData:t.getInitialData()},t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){e.formData!==this.props.formData&&this.setState({formData:this.getInitialData()})}},{key:"getInitialData",value:function(){return(0,p.default)(this.props.formData)}},{key:"render",value:function(){var e=this.props.formRef;return i.default.createElement("div",{className:v.default.wrapper},i.default.createElement("div",{className:"h4"},t("BASIC_INFORMATION")),i.default.createElement(d.Form,{ref:e,data:this.state.formData,onChange:this.handleFormChange},i.default.createElement(d.Columns,null,i.default.createElement(d.Column,null,i.default.createElement(d.Form.Item,{label:t("USERNAME")},i.default.createElement(d.Input,{name:"metadata.name",placeholder:"username",disabled:!0})),i.default.createElement(d.Form.Item,{label:t("EMAIL"),desc:t("USER_SETTING_EMAIL_DESC")},i.default.createElement(d.Input,{name:"spec.email",placeholder:"user@example.com"})),globals.config.supportLangs&&i.default.createElement(d.Form.Item,{label:t("LANGUAGE")},i.default.createElement(d.Select,{name:"spec.lang",options:this.languageOptions,defaultValue:(0,h.default)("lang")||(0,m.getBrowserLang)()}))))))}},{key:"name",get:function(){return"basicInfo"}},{key:"languageOptions",get:function(){return globals.config.showAllLangs?globals.config.supportLangs:globals.config.supportLangs.filter((function(e){return e.recommend}))}}]),r}(i.default.Component);a.default=y,y.contextTypes={registerUpdate:f.default.func}},function(e,t,a){e.exports={wrapper:"KH3XnMu-MyTWhxyHf4gKd",upload:"XPPHp2BX0rE0skRKK08bd"}},function(e,a,r){"use strict";r(16);var n=r(19);r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(1006)),m=r(61),h=n(r(3206));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var E=function(e){(0,o.default)(r,e);var a=v(r);function r(e){var n;return(0,l.default)(this,r),(n=a.call(this,e)).resetData=function(){n.setState({formData:n.getInitialData()})},n.handlePassswordChange=function(e){n.setState({password:e})},n.passwordValidator=function(e,a,r){if(!a)return r();a!==n.state.password&&r({message:t("PASSWORD_NOT_SAME_DESC"),field:e.field}),r()},n.handleFormChange=function(e,t){n.context.registerUpdate(n.name,{name:e,value:t})},n.state={password:"",formData:n.getInitialData()},n}return(0,u.default)(r,[{key:"getInitialData",value:function(){return{}}},{key:"render",value:function(){var e=this.props.formRef;return i.default.createElement("div",{className:h.default.wrapper},i.default.createElement("div",{className:"h4"},t("PASSWORD_SETTINGS")),i.default.createElement(d.Form,{data:this.state.formData,ref:e,onChange:this.handleFormChange},i.default.createElement("input",{name:"password",className:"hidden-input",type:"password",disabled:!0}),i.default.createElement(d.Form.Item,{className:h.default.password,label:t("CURRENT_PASSWORD"),desc:t("ENTER_CURRENT_PASSWORD_DESC"),rules:[{required:!0,message:t("ENTER_CURRENT_PASSWORD_TIP")}]},i.default.createElement(p.default,{name:"currentPassword",placeholder:" ",autoComplete:"cur-password"})),i.default.createElement(d.Alert,{className:h.default.alert,type:"warning",message:t("PASSWORD_DESC")}),i.default.createElement(d.Form.Item,{className:h.default.password,label:t("NEW_PASSWORD"),rules:[{required:!0,message:t("PASSWORD_EMPTY_DESC")},{pattern:m.PATTERN_PASSWORD,message:t("PASSWORD_DESC")}]},i.default.createElement(p.default,{name:"password",placeholder:" ",autoComplete:"new-password",onChange:this.handlePassswordChange,tipClassName:h.default.dropdown,withStrength:!0})),i.default.createElement(d.Form.Item,{className:h.default.password,label:t("CONFIRM_PASSWORD"),rules:[{required:!0,message:t("CONFIRM_PASSWORD_TIP")},{validator:this.passwordValidator}]},i.default.createElement(p.default,{name:"rePassword",placeholder:" ",autoComplete:"new-password"}))))}},{key:"name",get:function(){return"passwordSetting"}}]),r}(i.default.Component);a.default=E,E.contextTypes={registerUpdate:f.default.func}},function(e,t,a){e.exports={wrapper:"_2f4Qwu-aMyuY2ayX60i3ow",alert:"-_vzO0gm8FRdolTnAgsKg",dropdown:"_1TOazrxPrE_VC7-rCUL3hs"}},function(e,t,a){e.exports={body:"_2uy1Nvc6heNC1CQwLvuQ2W",content:"_1lIeNHjQF9epWT-t_pShYu",forms:"_1EYYubFoXjSqfCjzgX9Q50",tabs:"_2VGusla4E1VhutBTSGrvSM",active:"_1MraCQa1kAyWnXL8dYc2-Y",tip:"_16cTW_hbIG4oYAeKmcdeA0",tooltipTrigger:"W04a-7w5uJhmQLBSzFoHC",tipIcon:"NaXnqKjzZHomE5MS--Al6",updateIcon:"_2uuOmNVwdkIagfgwWbkjW3",formWrapper:"_11NMns_UUFIN1rWN6bM5fc",operations:"_2kvFauDLN_uSqSa4uDFXj0",form:"_3ADJ1Bq3FvjzSuEDV1io3m",footer:"_1UfFR3uKyIYBgEQbDxFr8D"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(30),r(139),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(20),r(27),r(141),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(7);var u=l(r(38));r(35);var o=l(r(39)),c=l(r(58)),s=l(r(31)),i=l(r(50)),f=l(r(26)),d=l(r(67)),p=l(r(68)),m=l(r(196)),h=l(r(191)),v=l(r(798)),E=r(17),y=l(r(819)),g=l(r(3209)),b=l(r(3210)),S=l(r(3212)),_=l(r(1515)),O=l(r(3218)),C=l(r(978)),T=l(r(1177)),R=r(61),D=l(r(438)),k=l(r(864)),N=n(r(3226)),I=l(r(3230)),P=l(r(1488));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L={"volume.create":{on:function(e){var a=e.fromSnapshot,r=e.store,n=e.cluster,l=e.namespace,d=e.module,E=e.isFederated,g=e.extendformTemplate,b=e.success,S=(0,i.default)(e,["fromSnapshot","store","cluster","namespace","module","isFederated","extendformTemplate","success"]),O=R.MODULE_KIND_MAP[d],C=(0,s.default)({},O,w(w({},D.default.volumes({namespace:l})),g));E&&Object.keys(C).forEach((function(e){C[e]=D.default.federated({data:C[e],clusters:S.projectDetail.clusters.map((function(e){return e.name})),kind:e})}));var T=(0,c.default)(N.default);E&&T.push({title:"CLUSTER_DIFF",icon:"blue-green-deployment",component:_.default,required:!0});var I,P=v.default.open(w({onOk:(I=(0,o.default)(u.default.mark((function e(a){var o,c,s,i;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(0,f.default)(a,O)){e.next=3;break}return e.abrupt("return");case 3:return(c={cluster:n,namespace:l}).namespace=c.namespace||(0,f.default)(o,"metadata.namespace"),(s=(0,f.default)(o,'metadata.annotations["storage.kubesphere.io/mountOptions"]'))&&(i=JSON.stringify(s.split(",")),(0,p.default)(o,'metadata.annotations["storage.kubesphere.io/mount-options"]',i),(0,m.default)(o,'metadata.annotations["storage.kubesphere.io/mountOptions"]')),e.next=9,r.create(o,c);case 9:v.default.close(P),h.default.success({content:t("CREATE_SUCCESSFUL")}),b&&b(),k.default.delete("".concat(d,"_create_form"));case 13:case"end":return e.stop()}}),e)}))),function(e){return I.apply(this,arguments)}),module:d,cluster:n,namespace:l,name:O,title:t("CREATE_PERSISTENT_VOLUME_CLAIM"),formTemplate:C,isFederated:E,steps:a?N.APPLY_SNAPSHOT_FORM_STEPS:T,modal:y.default,store:r},S))}},"volume.clone":{on:function(e){var a,r=e.store,n=e.detail,l=(0,i.default)(e,["store","detail"]),c=v.default.open(w({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.cloneVolume(w(w({},a),{},{detail:n}));case 2:v.default.close(c),h.default.success({content:t("CREATE_SUCCESSFUL")});case 4:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),title:t("CLONE_VOLUME"),modal:g.default,store:r},l))}},"volume.create.snapshot":{on:function(e){return(0,o.default)(u.default.mark((function a(){var r,n,l,c,s,d,p;return u.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.store,n=e.detail,l=e.provisioner,c=(0,i.default)(e,["store","detail","provisioner"]),s=null!=l?l:(0,f.default)(n,"annotations['volume.beta.kubernetes.io/storage-provisioner']","-"),a.next=4,r.getSnapshotType({cluster:c.cluster});case 4:d=[],r.snapshotType.items.forEach((function(e){e.driver===s&&d.push({label:e.metadata.name,value:e.metadata.name})})),p=v.default.open(w({onOk:function(){var e=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.createSnapshot(w(w({},a),{},{detail:n}));case 2:v.default.close(p),h.default.success({content:t("CREATE_SUCCESSFUL")});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),title:t("CREATE_SNAPSHOT"),modal:b.default,store:r,options:d},c));case 7:case"end":return a.stop()}}),a)})))()}},"create.snapshot":{on:function(e){var a,r=e.store,n=e.cluster,l=e.namespace,c=e.success,s=(0,i.default)(e,["store","cluster","namespace","success"]),f=v.default.open(w({onOk:(a=(0,o.default)(u.default.mark((function e(a){var l,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=a.namespace,o=(0,i.default)(a,["namespace"]),e.next=3,r.createSnapshot(w(w({},o),{},{cluster:n,namespace:l}));case 3:v.default.close(f),h.default.success({content:t("CREATE_SUCCESSFUL")}),c&&c();case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),title:t("CREATE_SNAPSHOT"),modal:b.default,store:r,cluster:n,namespace:l,volumeSelect:!0},s))}},"volume.expand":{on:function(e){var a,r=e.store,n=e.detail,l=(0,i.default)(e,["store","detail"]),c=v.default.open(w({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.patch(n||r.detail,a);case 2:v.default.close(c),h.default.success({content:t("UPDATE_SUCCESSFUL")});case 4:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),modal:S.default,store:r},l))}},"volume.template.edit":{on:function(e){var t=e.store,a=e.detail,r=e.success,n=e.module,l=e.isFederated,u=e.namespace,o=e.extendformTemplate,c=(0,i.default)(e,["store","detail","success","module","isFederated","namespace","extendformTemplate"]),p=R.MODULE_KIND_MAP[n],m=(0,s.default)({},p,w(w({},D.default.volumes({namespace:u})),o));l&&Object.keys(m).forEach((function(e){m[e]=D.default.federated({data:m[e],clusters:c.projectDetail.clusters.map((function(e){return e.name})),kind:e})}));var h=v.default.open(w(w({onOk:function(e){var n=(0,f.default)(e,"spec.template.spec.customMode",{});(0,d.default)(n)||delete e.spec.template.spec.customMode,t.update(a,e).then((function(){v.default.close(h),r&&r()}))},store:t,detail:(0,E.toJS)(a._originData),modal:O.default},c),{},{formTemplate:m,isFederated:l}))}},"volume.snapshot.yaml.edit":{on:function(e){var a,r=e.store,n=e.detail,l=e.success,c=e.namespace,s=e.cluster,f=(0,i.default)(e,["store","detail","success","namespace","cluster"]),d=v.default.open(w({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.update(w({namespace:c,cluster:s},r.detail),a);case 2:h.default.success({content:t("UPDATE_SUCCESSFUL")}),v.default.close(d),l&&l();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,modal:C.default,yaml:n},f))}},"volume.snapshotContent.baseInfo.edit":{on:function(e){var a,r=e.store,n=e.detail,l=e.cluster,c=e.namespace,s=e.success,f=(0,i.default)(e,["store","detail","cluster","namespace","success"]),d=v.default.open(w({onOk:(a=(0,o.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.patch(w(w({},n),{},{cluster:l,namespace:c}),a);case 2:h.default.success({content:t("UPDATE_SUCCESSFUL")}),v.default.close(d),s&&s();case 5:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),store:r,detail:n,modal:T.default},f))}},"snapshotClasses.create":{on:function(e){var a,r=e.store,n=e.module,l=e.name,f=e.detail,d=e.cluster,p=e.success,m=(0,i.default)(e,["store","module","name","detail","cluster","success"]),E=R.MODULE_KIND_MAP[n],g=(0,c.default)(I.default),b=(0,s.default)({},E,w({},D.default.volumesnapshotclass())),S=v.default.open(w({onOk:(a=(0,o.default)(u.default.mark((function e(a){var n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a[E],e.next=3,r.create(n,{cluster:d});case 3:v.default.close(S),h.default.success({content:t("CREATE_SUCCESSFUL")}),p&&p();case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),module:n,name:l,store:r,detail:f,formTemplate:b,steps:g,modal:y.default,cluster:d},m))}},"volume.autoresizer":{on:function(e){var a,r=e.store,n=e.cluster,l=e.detail,c=e.success,s=(0,i.default)(e,["store","cluster","detail","success"]),f=v.default.open(w({onOk:(a=(0,o.default)(u.default.mark((function e(a){var n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l._originData,(0,p.default)(n,"metadata.annotations",w(w({},n.metadata.annotations),a)),e.next=4,r.patch(l,n);case 4:return e.next=6,r.fetchDetail({name:l.name,cluster:l.cluster,namespace:l.namespace});case 6:h.default.success({content:t("UPDATE_SUCCESSFUL")}),v.default.close(f),c&&c();case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),cluster:n,store:r,formData:l._originData,modal:P.default},s))}}};a.default=L},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(61),p=r(189),m=n(r(798));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=e.onOk,u=e.title;return i.default.createElement(m.default.Form,{icon:"pen",width:691,title:u,onOk:l,onCancel:n,visible:a,isSubmitting:r},i.default.createElement(p.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:d.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("LONG_NAME_DESC")})}],desc:t("LONG_NAME_DESC")},i.default.createElement(p.Input,{name:"name",maxLength:253})))}}]),r}(i.default.Component);a.default=v,v.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},v.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var l=n(r(38)),u=n(r(31));r(35);var o,c,s,i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=n(r(0)),E=n(r(1)),y=r(61),g=r(189),b=n(r(798)),S=n(r(451)),_=n(r(453)),O=n(r(504)),C=r(17),T=r(243),R=n(r(26)),D=n(r(76)),k=n(r(3211));function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var A=(0,T.observer)((s=c=function(e){(0,p.default)(n,e);var a,r=P(n);function n(){var e;(0,f.default)(this,n);for(var a=arguments.length,u=new Array(a),o=0;o<a;o++)u[o]=arguments[o];return(e=r.call.apply(r,[this].concat(u))).volumeStore=new S.default,e.storageclass=new _.default,e.snapShotClassStore=new O.default,e.form=v.default.createRef(),e.testRef=v.default.createRef(),e.state={pagination:{page:0,total:0,limit:10},selectedVolume:"",volumeInfo:"",formData:{},snapShotClass:[],isLoading:!1,storageClassBan:!1,allowSnapshot:!0},e.fetchList=(0,i.default)(l.default.mark((function t(){var a,r,n=arguments;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=n.length>0&&void 0!==n[0]?n[0]:{},r=e.state.pagination,e.setState({isLoading:!0,pagination:I(I({},r),{},{page:r.page+1})},(function(){var t=e.state.pagination,r=t.page,n=t.limit,l=e.props,u=I(I({namespace:l.namespace,cluster:l.cluster},a),{},{limit:n*r,page:1,more:!1,sortBy:"createTime"});e.volumeStore.fetchList(u).then((function(){var t=e.volumeStore.list.total;e.setState({pagination:I(I({},e.state.pagination),{},{total:t}),isLoading:!1})}))}));case 3:case"end":return t.stop()}}),t)}))),e.volumeChange=function(t){e.setState({selectedVolume:t},(function(){e.saveVolumeInfo()}))},e.volumeValidator=function(a,r,n){var l=e.state,u=l.allowSnapshot,o=l.volumeInfo;!u&&(0,D.default)(o)&&n({message:t("STORAGECLASS_NOT_ALLOW_CREATE_SNAPSHOT"),field:a.field}),n()},e.optionRenderer=function(a){return v.default.createElement(v.default.Fragment,null,v.default.createElement("div",{className:k.default.option},a.isFedManaged?v.default.createElement("img",{className:k.default.indicator,src:"/extensions-static/ks-console-embed/dist/v3dist/assets/cluster.svg"}):v.default.createElement(g.Icon,{type:"light",name:"storage"}),a.label," (",a.namespace,")"),a.isFedManaged&&v.default.createElement(g.Tooltip,{content:e.props.tipMessage||t("FEDPROJECT_RESOURCE_TIP")},v.default.createElement(g.Icon,{className:k.default.tip,name:"question"})))},e.handleOk=function(){var t,a=e.props.onOk,r=e.state,n=r.allowSnapshot,l=r.selectedVolume;e.form.current.validator((function(){if(n){var r=e.form.current.props.data;""!==l&&(t=(0,C.toJS)(e.volumeStore.list.data).filter((function(e){return e.name===l}))[0].namespace),a(I(I({},r),{},{namespace:t}))}}))},e}return(0,d.default)(n,[{key:"componentDidMount",value:function(){this.props.volumeSelect&&(this.fetchList(),this.getSnapShotClassList())}},{key:"getSnapShotClassList",value:function(){var e=this.props,t={namespace:e.namespace,cluster:e.cluster,limit:-1};this.snapShotClassStore.fetchList(t)}},{key:"saveVolumeInfo",value:function(){var e=this,t=this.state.selectedVolume;if(t){var a=(0,C.toJS)(this.volumeStore.list.data).filter((function(e){return e.name===t}))[0];a&&this.setState({volumeInfo:a},(function(){e.getStorageClassInfo()}))}}},{key:"getSnapShotClass",value:function(e){if(e){var t=(0,C.toJS)(this.snapShotClassStore.list.data),a=[];t.forEach((function(t){t.driver===e&&a.push({label:t.name,value:t.name})})),this.setState({snapShotClass:a})}}},{key:"getStorageClassInfo",value:(a=(0,i.default)(l.default.mark((function e(){var t,a,r,n,u,o,c,s=this;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.cluster,r=t.namespace,n=this.state.volumeInfo,u=n.storageClassName,e.prev=3,e.next=6,this.storageclass.fetchDetail({cluster:a,namespace:r,name:u});case 6:o=(0,R.default)((0,C.toJS)(this.storageclass).detail.annotations,"storageclass.kubesphere.io/allow-snapshot","false"),this.getSnapShotClass(null===(c=this.storageclass.detail)||void 0===c?void 0:c.provisioner),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),o="false";case 13:this.setState({allowSnapshot:JSON.parse(o)},(function(){s.testRef.current.validate({sourceName:s.state.selectedVolume})}));case 14:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(){return a.apply(this,arguments)})},{key:"renderVolumeSelect",value:function(){var e=this.state,a=e.pagination,r=e.isLoading;return v.default.createElement(g.Form.Item,{ref:this.testRef,label:t("PERSISTENT_VOLUME_CLAIM"),rules:[{required:!0,message:t("PVC_NOT_SELECT")},{validator:this.volumeValidator}],desc:t("SELECT_A_VOLUME_DESC")},v.default.createElement(g.Select,{searchable:!0,name:"sourceName",className:k.default.input,options:this.volumeList,pagination:a,onFetch:this.fetchList,onChange:this.volumeChange,isLoading:r,optionRenderer:this.optionRenderer,clearable:!0}))}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=e.title,u=e.options,o=e.volumeSelect,c=this.state,s=c.snapShotClass,i=c.formData;return v.default.createElement(b.default,{icon:"pen",width:600,title:l,onOk:this.handleOk,onCancel:n,visible:a,isSubmitting:r},v.default.createElement(g.Form,{data:i,ref:this.form},o&&this.renderVolumeSelect(),v.default.createElement(g.Form.Item,{label:t("NAME"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:y.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("LONG_NAME_DESC")})}],desc:t("LONG_NAME_DESC")},v.default.createElement(g.Input,{name:"name",maxLength:253,className:k.default.input})),v.default.createElement(g.Form.Item,{label:t("VOLUME_SNAPSHOT_CLASS"),rules:[{required:!0,message:t("SNAPSHOT_EMPTY_TIP")}],desc:t("SELECT_VOLUME_SNAPSHOT_CLASS_DESC")},v.default.createElement(g.Select,{name:"type",options:o?s:u,placeholder:" ",className:k.default.input}))))}},{key:"volumeList",get:function(){return(0,C.toJS)(this.volumeStore.list.data).map((function(e){return{value:e.name,label:e.name,disabled:!e.inUse||e.isFedManaged,isFedManaged:e.isFedManaged,namespace:e.namespace}}))}}]),n}(v.default.Component),c.propTypes={detail:E.default.object,visible:E.default.bool,onOk:E.default.func,onCancel:E.default.func,isSubmitting:E.default.bool,snapshotOption:E.default.array,volumeSelect:E.default.bool},c.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1,snapshotOption:[],volumeSelect:!1},o=s))||o;a.default=A},function(e,t,a){e.exports={input:"zvTsfyLRc9lqKCZ7OH12O",option:"_3FKGkuuhvdnSIGOarex_36",tip:"_3L7C3cYavlloj_j_uwkS9I"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(87),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(87),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var u=l(r(31)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(985)),m=l(r(1)),h=r(189),v=l(r(798)),E=l(r(894)),y=l(r(3213));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var _=function(e){(0,s.default)(r,e);var a=S(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"getMarks",value:function(){var e=this.props.max;return(0,p.default)(5).reduce((function(t,a){var r=e*a/4,n=0===r?"0":"".concat(Math.floor(r),"Gi");return b(b({},t),{},(0,u.default)({},r,n))}),{})}},{key:"render",value:function(){var e=this.props,a=e.title,r=e.visible,n=e.onOk,l=e.okText,u=e.onCancel,o=e.detail;return d.default.createElement(v.default.Form,{title:t(a),visible:r,icon:"scaling",data:o,okText:t(l),onCancel:u,onOk:n},this.renderInput())}},{key:"renderAlert",value:function(){return d.default.createElement(h.Alert,{className:y.default.alert,type:"warning",title:t("EXPAND_VOLUME"),icon:"exclamation",message:t("VOLUME_EXPAND_TIP")})}},{key:"renderInput",value:function(){var e=this.props,a=e.max,r=e.min,n=e.unit,l=this.getMarks();return d.default.createElement(h.Form.Item,{label:t("VOLUME_CAPACITY")},d.default.createElement(E.default,{name:"spec.resources.requests.storage",max:a,min:r,marks:l,unit:n,withInput:!0,onChange:this.handleChange}))}}]),r}(d.Component);a.default=_,_.propTypes={value:m.default.oneOfType([m.default.string,m.default.number]),detail:m.default.object,max:m.default.number,min:m.default.number,visible:m.default.bool,title:m.default.string,okText:m.default.string},_.defaultProps={detail:{},min:0,max:1024,unit:"Gi",title:"EXPAND_VOLUME",okText:"OK"}},function(e,t,a){e.exports={alert:"_27aGi1qudoX_elTsZw4M-y"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(44),r(6),r(51),r(9),r(4),r(18),r(30),r(11),r(71),r(79),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(44),r(6),r(27),r(51),r(29),r(9),r(4),r(18),r(43),r(30),r(11),r(71),r(79),r(7);var u=l(r(31)),o=l(r(58)),c=l(r(25)),s=l(r(28)),i=l(r(41)),f=l(r(42)),d=l(r(37)),p=n(r(0)),m=l(r(26)),h=l(r(68)),v=l(r(67)),E=l(r(119)),y=l(r(850)),g=l(r(5)),b=l(r(3215)),S=l(r(996)),_=l(r(3217));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var C=function(e){(0,i.default)(r,e);var a=O(r);function r(){var e;(0,c.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).state={formData:e.getFormData(),isEdit:!1},e.showEdit=function(){e.setState({isEdit:!0}),e.props.onSelect(e.props.cluster)},e.hideEdit=function(){e.setState({isEdit:!1})},e.handleSubmit=function(t){var a=e.props,r=a.cluster,n=a.formTemplate,l=[];Object.keys(t.spec).forEach((function(e){var a="spec.".concat(e),r=(0,m.default)(t,a);(0,m.default)(n,"spec.template.".concat(a))!==r&&l.push({path:"/".concat(a.replace(/\./g,"/")),value:r})}));var u=(0,m.default)(n,"spec.overrides",[]),c=u.find((function(e){return e.clusterName===r}));c?c.clusterOverrides=(0,y.default)([].concat(l,(0,o.default)(c.clusterOverrides||[])),"path"):u.push({clusterName:r,clusterOverrides:l}),(0,h.default)(n,"spec.overrides",u),e.setState({formData:e.getFormData(),isEdit:!1})},e}return(0,s.default)(r,[{key:"getFormData",value:function(){var e=this.props,t=e.cluster,a=e.formTemplate,r=(0,m.default)(a,"spec.overrides",[]).find((function(e){return e.clusterName===t}))||{},n={spec:(0,E.default)((0,m.default)(a,"spec.template.spec"))};return r&&!(0,v.default)(r.clusterOverrides)&&r.clusterOverrides.forEach((function(e){if(e.path.startsWith("/spec")){var t=e.path.slice(1).replace(/\//g,".");(0,h.default)(n,t,e.value)}})),n}},{key:"render",value:function(){var e=this.props,a=e.cluster,r=e.namespace,n=e.selected,l=e.editModalTitle,o=e.title,c=e.onChange,s=this.state,i=s.formData,f=s.isEdit;return p.default.createElement("div",{className:(0,g.default)(_.default.wrapper,(0,u.default)({},_.default.selected,n))},p.default.createElement(b.default,{title:t("STORAGE_CLASS_VALUE",{value:(0,m.default)(i,"spec.storageClassName")}),formData:i,isEdit:f,showEdit:this.showEdit,hideEdit:this.hideEdit,onOk:this.handleSubmit,onChange:c},p.default.createElement(S.default,{cluster:a,namespace:r,editModalTitle:l,tabTitle:o})))}}]),r}(p.Component);a.default=C},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=r(189),p=l(r(840)),m=l(r(3216));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(r,e);var a=h(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).formRef=f.default.createRef(),e.handleSubmit=function(){var t=e.props,a=t.onOk,r=t.onChange,n=e.formRef.current;n&&n.validate((function(){a(n.getData()),r&&r()}))},e.handleCancel=function(){e.props.hideEdit()},e.handleOpen=function(){e.props.showEdit()},e}return(0,o.default)(r,[{key:"renderContent",value:function(){var e=this.props,t=e.formData,a=e.children;return f.default.createElement("div",{className:m.default.form},f.default.createElement(d.Form,{ref:this.formRef,type:"inner",data:t},f.default.createElement("div",{className:m.default.formContent},a)),f.default.createElement(p.default,{className:m.default.confirm,onOk:this.handleSubmit,onCancel:this.handleCancel}))}},{key:"render",value:function(){var e=this.props,a=e.title,r=e.selected,n=e.isEdit;return f.default.createElement(d.Dropdown,{visible:n,placement:"bottom",closeAfterClick:!1,onOpen:this.handleOpen,content:this.renderContent(),modifiers:this.modifiers,always:n},f.default.createElement("div",null,a,r&&f.default.createElement("span",{className:m.default.modify},f.default.createElement("span",null,t("EDIT")),f.default.createElement(d.Icon,{type:"light",size:20,name:"chevron-down"}))))}},{key:"modifiers",get:function(){return{computeStyle:{gpuAcceleration:!1}}}}]),r}(f.Component);a.default=v},function(e,t,a){e.exports={form:"msLppgLb31XNV2hAROzCF",formContent:"_2xXYl-4VecOZE86XX4THRo",modify:"vDTqlA_zC32lqD74tLyOO",confirm:"_32-qEsVwZwtGn6Ascvmi8G"}},function(e,t,a){e.exports={wrapper:"TPiC3uwJ6U_CLbzP1ZfsI",selected:"_2UTVKEKjjbtfJVJTiP3sww"}},function(e,t,a){"use strict";a(16);var r=a(19);a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(50)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=r(a(1)),p=r(a(1008)),m=r(a(3219));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(a,e);var t=h(a);function a(){return(0,u.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.module,a=(0,l.default)(e,["module"]);return f.default.createElement(p.default,(0,n.default)({title:"EDIT_SETTINGS",icon:"storage",module:t,forms:this.forms},a))}},{key:"forms",get:function(){return m.default[this.props.module]}}]),a}(f.default.Component);t.default=v,v.propTypes={module:d.default.string},v.defaultProps={module:"deployments"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(56),l=r(a(1515)),u=r(a(3220)),o={deployments:[{icon:"storage",name:"volumeSettings",title:"STORAGE_SETTINGS",component:u.default},{icon:"blue-green-deployment",name:"diffSettings",title:"CLUSTER_DIFF",component:l.default}],statefulsets:[{icon:"storage",name:"volumeSettings",title:"STORAGE_SETTINGS",component:u.default},{icon:"blue-green-deployment",name:"diffSettings",title:"CLUSTER_DIFF",component:(0,n.withProps)(l.default,{withService:!0})}],daemonsets:[{icon:"storage",name:"volumeSettings",title:"STORAGE_SETTINGS",component:u.default},{icon:"blue-green-deployment",name:"diffSettings",title:"CLUSTER_DIFF",component:(0,n.withProps)(l.default,{withService:!0})}]};t.default=o},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=r(189),m=n(r(827)),h=n(r(996)),v=n(r(1516)),E=n(r(1517));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=[{icon:"snapshot",value:!0,get label(){return t("CREATE_VOLUME_BY_SNAPSHOT")},get description(){return t("SELECT_SNAPSHOT_TO_CREATE_VOLUME")}},{icon:"database",value:!1,get label(){return t("CREATE_VOLUME_BY_STORAGE_CLASS")},get description(){return t("SELECT_STORAGE_CLASS_CREATE_VOLUME")}}],b=function(e){(0,c.default)(r,e);var a=y(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.isFederated,n=e.cluster,u=e.formProps,o=e.isEdit,c=this.state.fromSnapshot;return f.default.createElement(p.Form,(0,l.default)({data:this.fedFormTemplate,ref:a},u),!r&&f.default.createElement(p.Form.Item,{label:t("CREATION_METHOD")},f.default.createElement(m.default,{value:c,options:this.createTypeOption,onChange:this.handleChange})),c?f.default.createElement(v.default,{namespace:(0,d.default)(this.formTemplate,"metadata.namespace"),cluster:n}):f.default.createElement(h.default,{cluster:n,isFederated:r,isEdit:o}))}},{key:"createTypeOption",get:function(){var e=g;return globals.app.hasKSModule("storage-utils")||e.shift(),e}}]),r}(E.default);a.default=b},function(e,t,a){e.exports={snapshot:"Q_j-P1zbmXBVWMfs9s-An",selected:"_3rYCc2IQL6MTwzE1TSkA9J",snapshotContainer:"_2aQDxEL3MZKJw-6JxlVL2L",snapshots:"_3sCkMrQKrGRc8hr3259-Ra"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(24),r(9),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=l(r(317));r(20),r(24),r(9),r(321);var o=r(189),c=l(r(894)),s=l(r(26)),i=l(r(68)),f=l(r(196)),d=n(r(0)),p=r(61),m=l(r(3223)),h=function(e){var a=e.fedFormTemplate;(0,d.useEffect)((function(){(0,i.default)(a,'metadata.annotations["storage.kubesphere.io/nfs-static-provision"]',"true"),(0,i.default)(a,"spec.accessModes",["ReadWriteOnce"]),(0,i.default)(a,"spec.volumeMode","Filesystem"),(0,i.default)(a,"spec.storageClassName",""),(0,f.default)(a,"spec.dataSource"),(0,f.default)(a,"spec.template")}),[]);var r=Object.keys(p.ACCESS_MODES),n=d.default.useMemo((function(){return r.map((function(e){return{value:e,label:e}}))}),[r]);return d.default.createElement("div",{className:m.default.wrapper},d.default.createElement(o.Columns,null,d.default.createElement(o.Column,null,d.default.createElement(o.Form.Item,{label:t("NFS_NAS"),rules:[{required:!0,message:t("PARAM_REQUIRED")},{pattern:p.PATTERN_DOMAIN_OR_IP,message:t("INVALID_DOMAIN_OR_IP")}]},d.default.createElement(o.Input,{name:'metadata.annotations["storage.kubesphere.io/nfs-server"]'}))),d.default.createElement(o.Column,null,d.default.createElement(o.Form.Item,{label:t("NFS_PATH"),rules:[{required:!0,message:t("PARAM_REQUIRED")},{pattern:p.PATTERN_ABSOLUTE_PATH,message:t("INVALID_ABSOLUTE_PATH")}]},d.default.createElement(o.Input,{name:'metadata.annotations["storage.kubesphere.io/nfs-path"]'})))),d.default.createElement(o.Columns,null,d.default.createElement(o.Column,null,d.default.createElement(o.Form.Item,{label:t("ACCESS_MODE"),rules:[{required:!0,message:t("PARAM_REQUIRED")}],desc:t("ACCESS_MODES_DESC")},d.default.createElement(o.Select,{name:"spec.accessModes",options:n,defaultValue:["ReadWriteOnce"],multi:!0}))),d.default.createElement(o.Column,null,d.default.createElement(o.Form.Item,{label:t("RECLAIM_POLICY")},d.default.createElement(o.Select,{name:'metadata.annotations["storage.kubesphere.io/reclaim-policy"]',options:[{label:"Retain",value:"Retain"},{label:"Delete",value:"Delete"}],defaultValue:"Delete"})))),d.default.createElement(o.Columns,null,d.default.createElement(o.Column,null,d.default.createElement(o.Form.Item,{label:t("READ_ONLY")},d.default.createElement(o.Select,{defaultValue:"false",name:'metadata.annotations["storage.kubesphere.io/nfs-readonly"]',options:[{label:t("TRUE"),value:"true"},{label:t("FALSE"),value:"false"}]}))),d.default.createElement(o.Column,null,d.default.createElement(o.Form.Item,{label:t("MOUNT_OPTIONS"),desc:t("MOUNT_OPTIONS_DES")},d.default.createElement(o.Input,{name:'metadata.annotations["storage.kubesphere.io/mountOptions"]'})))),d.default.createElement("div",{className:m.default.slider},d.default.createElement(o.Form.Item,{className:m.default.slider,label:t("VOLUME_CAPACITY"),rules:[{validator:function(e,a,r){return parseInt(a,10)<=0?r({message:t("VOLUME_SIZE_TIP"),field:e.field}):r()}}]},d.default.createElement(c.default,(0,u.default)({name:"spec.resources.requests.storage"},function(){var e={min:0,max:2048,defaultValue:"10Gi",step:1,unit:"Gi"},t=Number((0,s.default)({},"parameters.minSize")),a=Number((0,s.default)({},"parameters.maxSize")),r=Number((0,s.default)({},"parameters.stepSize"));isNaN(t)||(e.min=t),isNaN(a)||(e.max=a),isNaN(r)||(e.step=r);for(var n=(e.max/e.step-e.min/e.step)/4,l={},u=0;u<4;u++){var o=Math.floor(n*u)*e.step+e.min;l[o]=0===o?"0":"".concat(o,"Gi")}return l[e.max]="".concat(e.max,"Gi"),e.marks=l,e}(),{withInput:!0})))))};a.default=h},function(e,t,a){e.exports={wrapper:"fp1SVAM4qftSbszvWnfaN",slider:"_2aruenJGhstmmXImuaZzDw"}},function(e,t,a){"use strict";var r=a(162),n=a(19);a(12),a(10),a(44),a(6),a(20),a(14),a(8),a(13),a(9),a(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(12),a(10),a(44),a(6),a(20),a(27),a(14),a(33),a(16),a(8),a(13),a(9),a(4),a(21),a(7);var l=n(a(317)),u=n(a(38)),o=n(a(31));a(35);var c=n(a(39)),s=n(a(97)),i=n(a(50)),f=a(189),d=a(243),p=r(a(0)),m=n(a(467)),h=n(a(244)),v=a(17);function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g=(0,d.observer)((function(e){var t=e.onChange,a=e.cluster,r=(0,i.default)(e,["onChange","cluster"]),n=(0,d.useLocalStore)((function(){return new m.default})),o=(0,p.useState)([]),E=(0,s.default)(o,2),g=E[0],b=E[1],S=function(){var e=(0,c.default)(u.default.mark((function e(){var t,r,l=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},e.next=3,n.fetchList(y(y({},t),{},{cluster:a,status:"available"}));case 3:r=n.list.data.map((function(e){return{label:e.name,value:e.name}})),b(r);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,p.useEffect)((function(){S()}),[]);var _=n.list;return p.default.createElement(f.Select,(0,l.default)({pagination:(0,h.default)(_,["page","limit","total"]),isLoading:_.isLoading,onChange:function(e){if(e){var a=n.list.data.find((function(t){return t.name===e}));t(e,(0,v.toJS)(a))}else t(e)},options:g,onFetch:S,searchable:!0,clearable:!0},r))}));t.default=g},function(e,t,a){e.exports={wrapper:"_2a9sRw3e8FcMiSbR4y1l_2",action:"_3DAwICPafejRhgveWMIef7"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.APPLY_SNAPSHOT_FORM_STEPS=t.default=void 0;var n=r(a(911)),l=r(a(1517)),u=r(a(3227)),o=r(a(3229)),c=[{title:"BASIC_INFORMATION",icon:"cdn",component:n.default,required:!0},{title:"STORAGE_SETTINGS",icon:"storage",component:l.default,required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:u.default,required:!0}];t.default=c;var s=[{title:"BASIC_INFORMATION",icon:"cdn",component:n.default,required:!0},{title:"STORAGE_SETTINGS",icon:"storage",component:o.default,required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:u.default,required:!0}];t.APPLY_SNAPSHOT_FORM_STEPS=s},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=r(61),p=r(189),m=n(r(3228));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.store,r=e.formRef;return i.default.createElement(p.Form,{data:this.fedFormTemplate,ref:r},i.default.createElement(p.Form.Group,{label:t("ADD_METADATA"),desc:t("VOLUME_ADD_METADATA_DESC"),keepDataWhenUnCheck:!0,checkable:!0},i.default.createElement(m.default,{store:a,cluster:this.cluster,namespace:this.namespace,formTemplate:this.fedFormTemplate})))}},{key:"cluster",get:function(){return this.props.cluster}},{key:"namespace",get:function(){return(0,f.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,f.default)(t,d.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,f.default)(this.formTemplate,"spec.template"):this.formTemplate}}]),r}(i.default.Component);a.default=v},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(829));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var m=function(e){(0,o.default)(r,e);var a=p(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){return i.default.createElement(i.default.Fragment,null,i.default.createElement(f.Form.Item,{label:t("LABEL_PL")},i.default.createElement(d.default,{name:"metadata.labels",addText:t("ADD")})),i.default.createElement(f.Form.Item,{label:t("ANNOTATION_PL")},i.default.createElement(d.default,{name:"metadata.annotations",addText:t("ADD")})))}}]),r}(i.default.Component);a.default=m},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(51),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(51),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=r(61),p=r(189);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=["ReadWriteOnce","ReadOnlyMany","ReadWriteMany"],v=function(e){(0,o.default)(r,e);var a=m(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props.formRef,a=h.map((function(e){return{value:e,label:e}})),r="ReadWriteOnce"in h?["ReadWriteOnce"]:h.slice(0,1);return i.default.createElement(p.Form,{data:this.formTemplate,ref:e},i.default.createElement(p.Form.Item,{label:t("ACCESS_MODE_TCAP"),rules:[{required:!0}]},i.default.createElement(p.Select,{name:"spec.accessModes",options:a,defaultValue:r,multi:!0})))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,f.default)(t,d.MODULE_KIND_MAP[a],t)}}]),r}(i.default.Component);a.default=v},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1489)),l=r(a(3231)),u=[{title:"BASIC_INFORMATION",component:n.default,required:!0},{title:"SNAPSHOT_CLASS_SETTINGS",component:l.default,required:!0}];t.default=u},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(26)),p=n(r(253)),m=r(189),h=r(61),v=n(r(453)),E=r(17);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var g=(0,r(243).observer)(l=function(e){(0,c.default)(r,e);var a=y(r);function r(){var e;(0,u.default)(this,r);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=a.call.apply(a,[this].concat(n))).storageClass=new v.default,e}return(0,o.default)(r,[{key:"componentDidMount",value:function(){var e=this.props.cluster;this.storageClass.fetchList({cluster:e,limit:-1})}},{key:"render",value:function(){var e=this.props.formRef;return f.default.createElement("div",null,f.default.createElement(m.Form,{data:this.formTemplate,ref:e},f.default.createElement(m.Columns,null,f.default.createElement(m.Column,null,f.default.createElement(m.Form.Item,{label:t("PROVISIONER"),desc:t("SNAPSHOT_CLASS_PROVISIONER_DESC"),rules:[{required:!0,message:t("SNAPSHOT_CLASS_PROVISIONER_EMPTY_DESC")}]},f.default.createElement(m.Select,{name:"driver",options:this.provisionerOption}))),f.default.createElement(m.Column,null,f.default.createElement(m.Form.Item,{label:t("DELETION_POLICY")},f.default.createElement(m.Select,{name:"deletionPolicy",defaultValue:"Delete",options:this.options}))))))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,h.MODULE_KIND_MAP[a],t)}},{key:"options",get:function(){return[{label:"Delete",value:"Delete"},{label:"Retain",value:"Retain"}]}},{key:"provisionerOption",get:function(){var e=(0,E.toJS)(this.storageClass.list.data).map((function(e){return e.provisioner}));return(0,p.default)(e).map((function(e){return{label:e,value:e}}))}}]),r}(f.default.Component))||l;a.default=g},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(27),r(33),r(16),r(8),r(13),r(9),r(4),r(7);var l=n(r(31)),u=n(r(50)),o=n(r(191)),c=n(r(798)),s=n(r(67)),i=n(r(3233)),f=n(r(822));function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m={"whizard.storage.delete":{on:function(e){var a=e.store,r=(e.detail,e.success),n=(0,u.default)(e,["store","detail","success"]),l=function(){c.default.close(i),o.default.success({content:t("DISABLE_SUCCESSFUL")}),r&&r()},i=c.default.open(p({onOk:function(){(0,s.default)(a.storage.data)?l():a.deleteStorage().then((function(){l()}))},store:a,modal:f.default,title:t("DISABLE_STORAGE"),desc:t("DISABLE_STORAGE_DESC"),type:"STORAGE"},n))}},"whizard.create":{on:function(e){var a=e.store,r=e.success,n=(0,u.default)(e,["store","success"]),l=c.default.open(p({onOk:function(e){a.updateConfigs(e).then((function(){c.default.close(l),o.default.success({content:t("UPDATE_SUCCESSFUL")}),r&&r()}))},store:a,modal:i.default,icon:"cogwheel",title:t("COMPONENT_PARAMETER_CONFIG"),type:"STORAGE"},n))}}};a.default=m},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(10),r(6),r(20),r(87),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(20),r(27),r(87),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var u=n(r(38));r(35);var o,c,s,i=n(r(39)),f=n(r(31)),d=n(r(25)),p=n(r(28)),m=n(r(41)),h=n(r(42)),v=n(r(37)),E=l(r(0)),y=r(243),g=n(r(26)),b=n(r(201)),S=n(r(67)),_=n(r(204)),O=r(17),C=n(r(1)),T=n(r(5)),R=r(189),D=n(r(798)),k=n(r(840)),N=n(r(438)),I=n(r(3234)),P=n(r(3251));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,f.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var M=(0,y.observer)((s=c=function(e){(0,m.default)(n,e);var a,r=L(n);function n(e){var t;return(0,d.default)(this,n),(t=r.call(this,e)).setError=function(e){t.setState({error:e})},t.handleSubFormSave=function(e){t.state.error||t["ref".concat(e)].current&&t["ref".concat(e)].current.handleSubmit((function(){t.cancelUpdate(e)}))},t.handleDiscardChanges=function(e){t.handleSubFormCancel(e),t.cancelUpdate(e)},t.cancelUpdate=function(e){var a=w({},t.state.updatedTabs);delete a[e],t.setState({updatedTabs:a})},t.handleSubFormCancel=function(e){t["ref".concat(e)].current&&t["ref".concat(e)].current.resetData()},t.registerUpdate=function(e,a){var r=t.state.updatedTabs;t.setState({updatedTabs:w(w({},r),{},(0,f.default)({},e,a))})},t.handleCancel=function(){t.props.onCancel()},t.handleOk=(0,i.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.props.onOk(t.state.formTemplate);case 1:case"end":return e.stop()}}),e)}))),t.handleChangeTab=function(e){var a=e.currentTarget.dataset.name;a&&t.setState({activeTab:a,error:!1})},t.onSave=function(e,a){t.setState({formTemplate:a.reduce((function(t,a){return(0,_.default)(t,(0,f.default)({},a,(0,g.default)(e,a,{})))}),w({},t.state.formTemplate))})},t.renderTabs=function(){var e=t.state,a=e.activeTab,r=e.updatedTabs;return E.default.createElement("ul",{className:P.default.tabs},t.tabs.map((function(e){var n=e.icon,l=void 0===n?"appcenter":n,u=e.title,o=e.name,c=o===a,s=c?"light":"dark";return E.default.createElement("li",{onClick:t.handleChangeTab,key:u,"data-name":o,className:(0,T.default)((0,f.default)({},P.default.active,c))},E.default.createElement(R.Tooltip,{placement:"bottomLeft",content:(0,b.default)(r,o)?t.updateTip:""},E.default.createElement("span",{className:P.default.tooltipTrigger},E.default.createElement(R.Icon,{name:l,size:20,type:s}),(0,b.default)(r,o)&&E.default.createElement("span",{className:P.default.tipIcon}))),E.default.createElement("p",null,u))})))},t.renderContent=function(){var e=t.state,a=e.activeTab,r=e.formTemplate,n=e.updatedTabs,l=t.tabs.filter((function(e){return e.name===a}))[0];return(0,S.default)(r)||!l?null:(t["ref".concat(a)]=(0,E.createRef)(),(0,E.createElement)(l.component,{updatedData:(0,g.default)(n,a,null),formTemplate:r,onSave:t.onSave,cancelUpdate:t.cancelUpdate,store:t.store,ref:t["ref".concat(a)],rootStore:t.props.rootStore}))},t.state={activeTab:"dataAccess",error:!1,formTemplate:{},updatedTabs:{}},t}return(0,p.default)(n,[{key:"getChildContext",value:function(){return{registerUpdate:this.registerUpdate,setError:this.setError}}}]),(0,p.default)(n,[{key:"componentDidMount",value:function(){this.fetchConfigs()}},{key:"fetchConfigs",value:(a=(0,i.default)(u.default.mark((function e(){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.store.fetchConfigs();case 2:this.setState({formTemplate:(0,_.default)({},N.default.whizard(),(0,O.toJS)(this.store.configs.data))});case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this,a=this.props.visible,r=this.state,n=r.activeTab,l=r.updatedTabs,u=this.store.configs.isLoading;return E.default.createElement(D.default,{bodyClassName:P.default.body,width:1162,title:t("COMPONENT_PARAMETER_CONFIG"),icon:"cogwheel",visible:a,onCancel:this.handleCancel,hideFooter:!0},E.default.createElement(R.Loading,{spinning:u},E.default.createElement("div",{className:P.default.wrapper},this.renderTabs(),E.default.createElement("div",{className:P.default.content},E.default.createElement("div",{className:P.default.main},this.renderContent()),E.default.createElement(k.default,{className:(0,T.default)(P.default.confirm,(0,f.default)({},P.default.confirmActive,(0,b.default)(l,n))),onOk:function(){return e.handleSubFormSave(n)},onCancel:function(){return e.handleDiscardChanges(n)}})))),E.default.createElement("div",{className:P.default.formFooter},E.default.createElement(R.Button,{type:"default",onClick:this.handleCancel,"data-test":"modal-cancel"},t("CANCEL")),E.default.createElement(R.Button,{type:"control",htmlType:"submit",loading:this.store.isSubmitting,disabled:!(0,S.default)(l),onClick:this.handleOk,"data-test":"modal-ok"},t("OK"))))}},{key:"updateTip",get:function(){return E.default.createElement("div",{className:P.default.tip},E.default.createElement("h6",null,t("CONTENT_NOT_SAVED_TIPS")),E.default.createElement("p",null,t("SAVE_EDIT_HINTS")))}},{key:"tabs",get:function(){return I.default}},{key:"store",get:function(){return this.props.store}}]),n}(E.Component),c.propTypes={store:C.default.object,rootStore:C.default.object,title:C.default.string,visible:C.default.bool,onOk:C.default.func,onCancel:C.default.func,isSubmitting:C.default.bool},c.childContextTypes={registerUpdate:C.default.func,setError:C.default.func},o=s))||o;a.default=M},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(3235)),u=n(r(3239)),o=n(r(3242)),c=n(r(3250)),s=[{title:t("DATA_ACCESS"),name:"dataAccess",icon:"object-storage-duotone",component:l.default},{title:t("DATA_QUERY"),name:"dataQuery",icon:"magnifier",component:u.default},{title:t("LONG_TERM_STORAGE"),name:"storage",icon:"storage",component:o.default},{title:t("RULE_CALCULATION"),name:"ruler",icon:"computing",component:c.default}];a.default=s},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var u,o,c,s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=l(r(0)),h=r(243),v=n(r(1)),E=r(189),y=n(r(119)),g=n(r(3236)),b=n(r(3237)),S=n(r(3238));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var O=E.Tabs.TabPanel,C=(0,h.observer)((c=o=function(e){(0,f.default)(r,e);var a=_(r);function r(e){var t;(0,s.default)(this,r),(t=a.call(this,e)).handleFormChange=function(){var e=t.state.formTemplate;(0,t.context.registerUpdate)(t.name,e)},t.handleSubmit=function(e){var a=t.props.onSave,r=t.state.formTemplate;t.formRef.current&&t.formRef.current.validate((function(){a(r,["gateway","ingester","router"]),e&&e()}))},t.resetData=function(){t.setState({formTemplate:(0,y.default)(t.props.formTemplate)})};var n=t.props,l=n.updatedData,u=n.formTemplate,o=l||u;return t.state={formTemplate:(0,y.default)(o)},t.formRef=(0,m.createRef)(),t}return(0,i.default)(r,[{key:"name",get:function(){return"dataAccess"}}]),(0,i.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.updatedData,r=t.formTemplate,n=a||r;e.formTemplate===r&&e.updatedData===a||this.setState({formTemplate:(0,y.default)(n)})}},{key:"render",value:function(){var e=this.state.formTemplate;return m.default.createElement(E.Form,{onChange:this.handleFormChange,data:e,ref:this.formRef},m.default.createElement(E.Tabs,{type:"button"},this.tabs.map((function(t){var a=t.label,r=t.value,n=t.Component;return m.default.createElement(O,{label:a,name:r,key:r},m.default.createElement(n,{formTemplate:e}))}))))}},{key:"tabs",get:function(){return[{label:t("GATEWAY_SETTINGS"),value:"gateway",Component:g.default},{label:t("DATA_ROUTER"),value:"router",Component:b.default},{label:t("LOCAL_STORAGE"),value:"ingester",Component:S.default}]}}]),r}(m.default.Component),o.contextTypes={registerUpdate:v.default.func,setError:v.default.func},u=c))||u;a.default=C},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(26)),v=r(243),E=r(1),y=r(189),g=n(r(805)),b=n(r(843));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,v.observer)((o=u=function(e){(0,f.default)(r,e);var a=S(r);function r(){return(0,s.default)(this,r),a.apply(this,arguments)}return(0,i.default)(r,[{key:"render",value:function(){return m.default.createElement(y.Form.Group,null,m.default.createElement(y.Columns,null,m.default.createElement(y.Column,null,m.default.createElement(y.Form.Item,{label:t("COMPONENT_REPLICA_COUNT"),desc:t("REPLICA_DESC",{default:2,resource:t("GATEWAY_COMPONENT_LOW")})},m.default.createElement(g.default,{name:"gateway.replicas",integer:!0,min:0,defaultValue:2,controls:!0}))),m.default.createElement(y.Column,null)),m.default.createElement(y.Columns,null,m.default.createElement(y.Column,null,m.default.createElement(y.Form.Item,{label:t("CONTAINER_QUOTA")},m.default.createElement(b.default,(0,c.default)({name:"gateway.resources"},this.resourceLimitProps))))))}},{key:"resourceLimitProps",get:function(){var e=this,t=this.props.formTemplate;return{memoryProps:{unit:"Gi"},defaultValue:{limits:{cpu:(0,h.default)(t,'gateway.resources["limits.cpu"]'),memory:(0,h.default)(t,'gateway.resources["limits.memory"]')},requests:{cpu:(0,h.default)(t,'gateway.resources["requests.cpu"]'),memory:(0,h.default)(t,'gateway.resources["requests.memory"]')}},onError:function(t){e.context.setError(!!t)}}}}]),r}(m.default.Component),u.contextTypes={setError:E.PropTypes.func},l=o))||l;a.default=_},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(20),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(26)),v=r(243),E=r(1),y=r(189),g=n(r(805)),b=n(r(843));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,v.observer)((o=u=function(e){(0,f.default)(r,e);var a=S(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).replicasValidator=function(a,r,n){return r>(0,h.default)(e.props.formTemplate,"ingester.replicas")?n({message:t("LOCAL_STORAGE_ERROR_MESSAGE")}):n()},e}return(0,i.default)(r,[{key:"render",value:function(){return m.default.createElement(y.Form.Group,null,m.default.createElement(y.Columns,null,m.default.createElement(y.Column,null,m.default.createElement(y.Form.Item,{label:t("DATA_RETENTION_REPLICA_COUNT"),desc:t("REPLICA_DESC",{resource:t("DATA_RETENTION_LOW"),default:1}),rules:[{validator:this.replicasValidator}]},m.default.createElement(y.Select,{name:"router.replicationFactor",options:this.replicationFactorOpts,defaultValue:1}))),m.default.createElement(y.Column,null,m.default.createElement(y.Form.Item,{label:t("COMPONENT_REPLICA_COUNT"),desc:t("REPLICA_DESC",{resource:t("ROUTER_COMPONENT_LOW"),default:2})},m.default.createElement(g.default,{name:"router.replicas",integer:!0,min:0,defaultValue:2,controls:!0})))),m.default.createElement(y.Columns,null,m.default.createElement(y.Column,null,m.default.createElement(y.Form.Item,{label:t("CONTAINER_QUOTA")},m.default.createElement(b.default,(0,c.default)({name:"router.resources"},this.resourceLimitProps))))))}},{key:"resourceLimitProps",get:function(){var e=this,t=this.props.formTemplate;return{memoryProps:{unit:"Gi"},defaultValue:{limits:{cpu:(0,h.default)(t,'router.resources["limits.cpu"]'),memory:(0,h.default)(t,'router.resources["limits.memory"]')},requests:{cpu:(0,h.default)(t,'router.resources["requests.cpu"]'),memory:(0,h.default)(t,'router.resources["requests.memory"]')}},onError:function(t){e.context.setError(!!t)}}}},{key:"replicationFactorOpts",get:function(){return[1,2,3].map((function(e){return{label:e,value:e}}))}}]),r}(m.default.Component),u.contextTypes={setError:E.PropTypes.func},l=o))||l;a.default=_},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(26)),v=r(243),E=r(1),y=r(189),g=n(r(805)),b=n(r(843));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,v.observer)((o=u=function(e){(0,f.default)(r,e);var a=S(r);function r(){var e;(0,s.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).replicasValidator=function(a,r,n){return r<(0,h.default)(e.props.formTemplate,"router.replicationFactor")?n({message:t("LOCAL_STORAGE_ERROR_MESSAGE")}):n()},e}return(0,i.default)(r,[{key:"render",value:function(){return m.default.createElement(y.Form.Group,null,m.default.createElement(y.Columns,null,m.default.createElement(y.Column,null,m.default.createElement(y.Form.Item,{label:t("LOCAL_STORAGE_TIME"),desc:t("LOCAL_STORAGE_TIME_DESC")},m.default.createElement(g.default,{name:"ingester.localTsdbRetention",min:3,unit:"d",integer:!0,defaultValue:7}))),m.default.createElement(y.Column,null,m.default.createElement(y.Form.Item,{label:t("COMPONENT_REPLICA_COUNT"),desc:t("REPLICA_DESC",{resource:t("LOCAL_STORAGE_LOW"),default:2}),rules:[{validator:this.replicasValidator}]},m.default.createElement(g.default,{name:"ingester.replicas",integer:!0,min:0,defaultValue:2,controls:!0})))),m.default.createElement(y.Columns,null,m.default.createElement(y.Column,null,m.default.createElement(y.Form.Item,{label:t("CONTAINER_QUOTA")},m.default.createElement(b.default,(0,c.default)({name:"ingester.resources"},this.resourceLimitProps))))))}},{key:"resourceLimitProps",get:function(){var e=this,t=this.props.formTemplate;return{memoryProps:{unit:"Gi"},defaultValue:{limits:{cpu:(0,h.default)(t,'ingester.resources["limits.cpu"]'),memory:(0,h.default)(t,'ingester.resources["limits.memory"]')},requests:{cpu:(0,h.default)(t,'ingester.resources["requests.cpu"]'),memory:(0,h.default)(t,'ingester.resources["requests.memory"]')}},onError:function(t){e.context.setError(!!t)}}}}]),r}(m.default.Component),u.contextTypes={setError:E.PropTypes.func},l=o))||l;a.default=_},function(e,a,r){"use strict";r(16);var n=r(19),l=r(162);r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var u,o,c,s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=l(r(0)),h=r(243),v=n(r(1)),E=r(189),y=n(r(119)),g=n(r(3240)),b=n(r(3241));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=E.Tabs.TabPanel,O=(0,h.observer)((c=o=function(e){(0,f.default)(r,e);var a=S(r);function r(e){var t;(0,s.default)(this,r),(t=a.call(this,e)).handleFormChange=function(){var e=t.state.formTemplate;(0,t.context.registerUpdate)(t.name,e)},t.handleSubmit=function(e){var a=t.props.onSave,r=t.state.formTemplate;t.formRef.current&&t.formRef.current.validate((function(){a(r,["query","queryFrontend"]),e&&e()}))},t.resetData=function(){t.setState({formTemplate:(0,y.default)(t.props.formTemplate)})};var n=t.props,l=n.updatedData,u=n.formTemplate;return t.state={formTemplate:(0,y.default)(l||u)},t.formRef=(0,m.createRef)(),t}return(0,i.default)(r,[{key:"name",get:function(){return"dataQuery"}}]),(0,i.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.updatedData,r=t.formTemplate;e.formTemplate===r&&e.updatedData===a||this.setState({formTemplate:(0,y.default)(a||r)})}},{key:"render",value:function(){var e=this.state.formTemplate;return m.default.createElement(E.Form,{onChange:this.handleFormChange,data:e,ref:this.formRef},m.default.createElement(E.Tabs,{type:"button"},this.tabs.map((function(t){var a=t.label,r=t.value,n=t.Component;return m.default.createElement(_,{label:a,name:r,key:r},m.default.createElement(n,{formTemplate:e}))}))))}},{key:"tabs",get:function(){return[{label:t("BASIC_SETTING"),value:"basic",Component:g.default},{label:t("CACHE_SETTING"),value:"cache",Component:b.default}]}}]),r}(m.default.Component),o.contextTypes={registerUpdate:v.default.func,setError:v.default.func},u=c))||u;a.default=O},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(243),v=r(1),E=n(r(26)),y=n(r(805)),g=n(r(843)),b=r(189);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,h.observer)((o=u=function(e){(0,f.default)(r,e);var a=S(r);function r(){return(0,s.default)(this,r),a.apply(this,arguments)}return(0,i.default)(r,[{key:"render",value:function(){return m.default.createElement(b.Form.Group,null,m.default.createElement(b.Columns,null,m.default.createElement(b.Column,null,m.default.createElement(b.Form.Item,{label:t("COMPONENT_REPLICA_COUNT"),desc:t("REPLICA_DESC",{resource:t("QUERY_COMPONENT_LOW"),default:2})},m.default.createElement(y.default,{name:"query.replicas",integer:!0,min:0,defaultValue:2,controls:!0}))),m.default.createElement(b.Column,null)),m.default.createElement(b.Columns,null,m.default.createElement(b.Column,null,m.default.createElement(b.Form.Item,{label:t("CONTAINER_QUOTA")},m.default.createElement(g.default,(0,c.default)({name:"query.resources"},this.resourceLimitProps))))))}},{key:"resourceLimitProps",get:function(){var e=this,t=this.props.formTemplate;return{memoryProps:{unit:"Gi"},defaultValue:{limits:{cpu:(0,E.default)(t,'query.resources["limits.cpu"]'),memory:(0,E.default)(t,'query.resources["limits.memory"]')},requests:{cpu:(0,E.default)(t,'query.resources["requests.cpu"]'),memory:(0,E.default)(t,'query.resources["requests.memory"]')}},onError:function(t){e.context.setError(!!t)}}}}]),r}(m.default.Component),u.contextTypes={setError:v.PropTypes.func},l=o))||l;a.default=_},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(243),v=r(1),E=n(r(26)),y=n(r(805)),g=n(r(843)),b=r(189);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,h.observer)((o=u=function(e){(0,f.default)(r,e);var a=S(r);function r(){return(0,s.default)(this,r),a.apply(this,arguments)}return(0,i.default)(r,[{key:"render",value:function(){return m.default.createElement(b.Form.Group,null,m.default.createElement(b.Columns,null,m.default.createElement(b.Column,null,m.default.createElement(b.Form.Item,{label:t("COMPONENT_REPLICA_COUNT"),desc:t("REPLICA_DESC",{resource:t("CACHE_COMPONENT_LOW"),default:2})},m.default.createElement(y.default,{name:"queryFrontend.replicas",integer:!0,min:0,defaultValue:2,controls:!0}))),m.default.createElement(b.Column,null)),m.default.createElement(b.Columns,null,m.default.createElement(b.Column,null,m.default.createElement(b.Form.Item,{label:t("CONTAINER_QUOTA")},m.default.createElement(g.default,(0,c.default)({name:"queryFrontend.resources"},this.resourceLimitProps))))))}},{key:"resourceLimitProps",get:function(){var e=this,t=this.props.formTemplate;return{memoryProps:{unit:"Gi"},defaultValue:{limits:{cpu:(0,E.default)(t,'queryFrontend.resources["limits.cpu"]'),memory:(0,E.default)(t,'queryFrontend.resources["limits.memory"]')},requests:{cpu:(0,E.default)(t,'queryFrontend.resources["requests.cpu"]'),memory:(0,E.default)(t,'queryFrontend.resources["requests.memory"]')}},onError:function(t){e.context.setError(!!t)}}}}]),r}(m.default.Component),u.contextTypes={setError:v.PropTypes.func},l=o))||l;a.default=_},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(10),r(6),r(87),r(14),r(8),r(13),r(9),r(4),r(21),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(87),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(7);var u=n(r(38));r(35);var o,c,s,i=n(r(39)),f=n(r(31)),d=n(r(25)),p=n(r(28)),m=n(r(41)),h=n(r(42)),v=n(r(37)),E=l(r(0)),y=r(243),g=n(r(1)),b=n(r(119)),S=n(r(64)),_=n(r(67)),O=n(r(811)),C=r(189),T=n(r(800)),R=n(r(858)),D=n(r(861)),k=r(804),N=r(17),I=n(r(438)),P=n(r(3243)),A=n(r(3245)),w=n(r(3246)),L=n(r(3247)),M=n(r(3249));function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){(0,f.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var n=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var F=C.Tabs.TabPanel,V=(0,k.trigger)(o=(0,y.observer)((s=c=function(e){(0,m.default)(n,e);var a,r=U(n);function n(e){var t;(0,d.default)(this,n),(t=r.call(this,e)).getFormDataFromCode=function(e){var a=t.props.code2formParse;return(void 0===a?function(e){return e}:a)((0,S.default)(e)?e.reduce((function(e,t){return j(j({},e),t)}),{}):e)},t.handleModeChange=function(){var e=t.props.form2codeParse,a=void 0===e?function(e){return e}:e;t.setState((function(e){var r=e.isCodeMode,n=e.storageFormTemplate,l={storageFormTemplate:a(n),isCodeMode:!r};return r&&(l.storageFormTemplate=t.getFormDataFromCode(t.getData())),l}))},t.handleFormChange=function(){var e=t.state,a=e.formTemplate,r=e.storageFormTemplate,n=e.enabledStorage;(0,t.context.registerUpdate)(t.name,{enabledStorage:n,formTemplate:a,storageFormTemplate:r})},t.handleStorageChange=function(){var e=t.state,a=e.formTemplate,r=e.storageFormTemplate,n=e.enabledStorage,l=t.context.registerUpdate;t.setState({hasObjectSet:!1}),l(t.name,{enabledStorage:n,formTemplate:a,storageFormTemplate:r})},t.verifyStorage=function(){var e=(0,i.default)(u.default.mark((function e(a){var r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.store,e.abrupt("return",r.verifyStorage(a));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.handleStorageSubmit=function(){var e=(0,i.default)(u.default.mark((function e(a){var r,n,l,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state.isCodeMode,n=t.props.store,l=!(0,_.default)(t.storageData),!r){e.next=7;break}e.t0=t.getFormDataFromCode(t.getData()),e.next=10;break;case 7:return e.next=9,t.getFormData();case 9:e.t0=e.sent;case 10:return o=e.t0,e.next=13,t.verifyStorage(o);case 13:if(!l){e.next=18;break}return e.next=16,n.updateStorage(o);case 16:e.next=20;break;case 18:return e.next=20,n.createStorage(o);case 20:t.setState({hasObjectSet:!0}),a();case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.handleSubmit=function(e){var a=t.props.onSave,r=t.state,n=r.formTemplate;"objectStorage"===r.type?t.handleStorageSubmit(e):t.formRef.current&&t.formRef.current.validate((function(){a(n,["store","compactor"]),e()}))},t.handleTabChange=function(e){return t.setState({type:e})},t.resetData=function(){var e=t.props.formTemplate,a=(0,b.default)(t.storageData);t.setState({formTemplate:(0,b.default)(e),storageFormTemplate:(0,_.default)(a)?(0,b.default)(I.default[t.name]()):a,hasObjectSet:!(0,_.default)(a)})},t.handleStorageEnabledChange=function(e){var a=t.props,r=a.store,n=a.cancelUpdate;e||t.trigger("whizard.storage.delete",{store:t.props.store,success:function(){r.storage.data={},t.resetData(),n(t.name),t.setState({enabledStorage:e})}})},t.handleEnabledStorage=function(){var e=t.state,a=e.formTemplate,r=e.storageFormTemplate,n=e.enabledStorage;(0,t.context.registerUpdate)(t.name,{enabledStorage:n,formTemplate:a,storageFormTemplate:r}),t.setState(j(j({},t.state),{},{enabledStorage:!0}))};var a=t.props,l=a.updatedData,o=a.formTemplate,c=l||{},s=c.formTemplate,f=c.storageFormTemplate,p=c.enabledStorage,m=f||t.storageData,h=s||o;return t.state={type:"objectStorage",isCodeMode:!1,enabledStorage:p||!(0,_.default)(m),hasObjectSet:(0,O.default)(f,t.storageData),formTemplate:(0,b.default)(h),storageFormTemplate:(0,b.default)(m)},t.formRef=(0,E.createRef)(),t.storageFormRef=(0,E.createRef)(),t.editor=(0,E.createRef)(),t}return(0,p.default)(n,[{key:"name",get:function(){return"storage"}},{key:"storageData",get:function(){return(0,N.toJS)(this.props.store.storage.data)}}]),(0,p.default)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.updatedData,r=t.formTemplate,n=this.state.storageFormTemplate,l=a||{},u=l.formTemplate,o=l.storageFormTemplate;e.formTemplate===r&&e.updatedData===a||this.setState({formTemplate:(0,b.default)(u||r),storageFormTemplate:o?(0,b.default)(o):n})}},{key:"componentDidMount",value:function(){this.fetchStorage()}},{key:"getData",value:function(){return this.editor.current.getData()}},{key:"fetchStorage",value:(a=(0,i.default)(u.default.mark((function e(){var t,a,r,n,l,o,c;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.updatedData,r=t.store,l=(n=a||{}).storageFormTemplate,o=n.enabledStorage,!l&&!o){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,r.fetchStorage();case 6:c=(0,b.default)(this.storageData),this.setState(j(j({},this.state),{},{enabledStorage:!(0,_.default)(c),hasObjectSet:!(0,_.default)(c),storageFormTemplate:(0,_.default)(c)?(0,b.default)(I.default[this.name]()):c}));case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getFormData",value:function(){var e=this;return new Promise((function(t){e.storageFormRef.current&&e.storageFormRef.current.validate((function(){t(e.storageFormRef.current.getData())}))}))}},{key:"renderForms",value:function(){var e=this.state.storageFormTemplate;return E.default.createElement(C.Form,{data:e,ref:this.storageFormRef,onChange:this.handleStorageChange},E.default.createElement(L.default,null))}},{key:"renderCodeEditor",value:function(){var e=this.state.storageFormTemplate;return E.default.createElement(D.default,{ref:this.editor,value:{formTemplate:e},onChange:this.handleStorageChange})}},{key:"renderOperations",value:function(){var e=this.state,a=e.isCodeMode;return"objectStorage"!==e.type?null:E.default.createElement(R.default,{className:M.default.yamlSwitch,text:t("EDIT_YAML"),onChange:this.handleModeChange,checked:a})}},{key:"render",value:function(){var e=this.state,a=e.enabledStorage,r=e.type,n=e.isCodeMode,l=e.formTemplate,u=e.hasObjectSet,o=this.props.store;return a?E.default.createElement(E.default.Fragment,null,E.default.createElement("div",{className:M.default.wrapper},E.default.createElement("div",{className:M.default.textWrapper},E.default.createElement(T.default,{className:M.default.text,icon:function(){return E.default.createElement(C.Icon,{name:"storage",size:40,style:{marginRight:"12px"}})},title:t("LONG_TERM_STORAGE"),description:t("LONG_TERM_STORAGE_TIPS")}),E.default.createElement(R.default,{className:M.default.switch,text:a?t("ENABLED"):t("DISABLED"),checked:a,onChange:this.handleStorageEnabledChange}))),E.default.createElement("div",{className:M.default.form},E.default.createElement(C.Tabs,{type:"button",value:r,onChange:this.handleTabChange},E.default.createElement(F,{label:t("OBJECT_STORAGE"),name:"objectStorage"},n?this.renderCodeEditor():this.renderForms()),E.default.createElement(F,{label:u?t("STORE_GATEWAY"):E.default.createElement(C.Tooltip,{className:M.default.tooltip,content:t("OBJECT_STORAGE_TIPS"),placement:"top"},E.default.createElement("span",null,t("STORE_GATEWAY"))),name:"store",disabled:!u},E.default.createElement(C.Form,{ref:this.formRef,data:l,onChange:this.handleFormChange},E.default.createElement(w.default,{formTemplate:l}))),E.default.createElement(F,{label:u?t("COMPRESSION_DOWNSAMPLING"):E.default.createElement(C.Tooltip,{className:M.default.tooltip,content:t("OBJECT_STORAGE_TIPS"),placement:"top"},E.default.createElement("span",null,t("COMPRESSION_DOWNSAMPLING"))),disabled:!u,name:"compactor"},E.default.createElement(C.Form,{ref:this.formRef,data:l,onChange:this.handleFormChange},E.default.createElement(A.default,{formTemplate:l})))),this.renderOperations())):E.default.createElement(C.Loading,{spinning:o.storage.isLoading},E.default.createElement(P.default,{handleEnabledStorage:this.handleEnabledStorage}))}}]),n}(E.default.Component),c.contextTypes={registerUpdate:g.default.func,setError:g.default.func},o=s))||o)||o;a.default=V},function(e,a,r){"use strict";r(16);var n=r(19);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=n(r(0)),u=r(189),o=n(r(801)),c=n(r(3244)),s=function(e){var a=e.handleEnabledStorage;return l.default.createElement(o.default,{className:"margin-t12 margin-b12"},l.default.createElement("div",{className:c.default.empty},l.default.createElement("div",{className:c.default.icon},l.default.createElement(u.Icon,{name:"loadbalancer",size:48})),l.default.createElement("div",{className:c.default.text},l.default.createElement("div",null,t("STORAGE_NOT_ENABLED")),l.default.createElement("p",null,t("STORAGE_ENABLE_GATEWAY_DESC"))),l.default.createElement(u.Button,{type:"control",onClick:a},t("ON"))))};a.default=s},function(e,t,a){e.exports={empty:"_1KuEIP87-KKKXfPMrdGslD",icon:"_1jT-9TQc8N822zZ45lFYKG",text:"_1f0xp4mnQb8j9cp3VYC7Ln"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=n(r(26)),v=r(243),E=r(1),y=n(r(805)),g=n(r(843)),b=r(189);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var _=(0,v.observer)((o=u=function(e){(0,f.default)(r,e);var a=S(r);function r(){return(0,s.default)(this,r),a.apply(this,arguments)}return(0,i.default)(r,[{key:"render",value:function(){return m.default.createElement(b.Form.Group,null,m.default.createElement(b.Columns,null,m.default.createElement(b.Column,null,m.default.createElement(b.Form.Item,{label:t("RETENTION_RAW"),desc:t("RETENTION_RAW_DESC")},m.default.createElement(y.default,{name:"compactor.retention.retentionRaw",unit:"d",integer:!0,min:0,defaultValue:60}))),m.default.createElement(b.Column,null,m.default.createElement(b.Form.Item,{label:t("RETENTION_FIVE_MIN"),desc:t("RETENTION_FIVE_MIN_DESC")},m.default.createElement(y.default,{name:"compactor.retention.retention5m",unit:"d",integer:!0,min:0,defaultValue:180})))),m.default.createElement(b.Columns,null,m.default.createElement(b.Column,null,m.default.createElement(b.Form.Item,{label:t("RETENTION_ONE_HOUR"),desc:t("RETENTION_ONE_HOUR_DESC")},m.default.createElement(y.default,{name:"compactor.retention.retention1h",unit:"d",integer:!0,min:0,defaultValue:360})))),m.default.createElement(b.Columns,null,m.default.createElement(b.Column,null,m.default.createElement(b.Form.Item,{label:t("CONTAINER_QUOTA")},m.default.createElement(g.default,(0,c.default)({name:"compactor.resources"},this.resourceLimitProps))))))}},{key:"resourceLimitProps",get:function(){var e=this,t=this.props.formTemplate;return{memoryProps:{unit:"Gi"},defaultValue:{limits:{cpu:(0,h.default)(t,'compactor.resources["limits.cpu"]'),memory:(0,h.default)(t,'compactor.resources["limits.memory"]')},requests:{cpu:(0,h.default)(t,'compactor.resources["requests.cpu"]'),memory:(0,h.default)(t,'compactor.resources["requests.memory"]')}},onError:function(t){e.context.setError(!!t)}}}}]),r}(m.default.Component),u.contextTypes={setError:E.PropTypes.func},l=o))||l;a.default=_},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(317)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(243),v=r(1),E=n(r(26)),y=n(r(843)),g=r(189);function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var S=(0,h.observer)((o=u=function(e){(0,f.default)(r,e);var a=b(r);function r(){return(0,s.default)(this,r),a.apply(this,arguments)}return(0,i.default)(r,[{key:"render",value:function(){return m.default.createElement(g.Form.Group,null,m.default.createElement(g.Columns,null,m.default.createElement(g.Column,null,m.default.createElement(g.Form.Item,{label:t("CONTAINER_QUOTA")},m.default.createElement(y.default,(0,c.default)({name:"store.resources"},this.resourceLimitProps))))))}},{key:"resourceLimitProps",get:function(){var e=this,t=this.props.formTemplate;return{memoryProps:{unit:"Gi"},defaultValue:{limits:{cpu:(0,E.default)(t,'store.resources["limits.cpu"]'),memory:(0,E.default)(t,'store.resources["limits.memory"]')},requests:{cpu:(0,E.default)(t,'store.resources["requests.cpu"]'),memory:(0,E.default)(t,'store.resources["requests.memory"]')}},onError:function(t){e.context.setError(!!t)}}}}]),r}(m.default.Component),u.contextTypes={setError:v.PropTypes.func},l=o))||l;a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(997)),p=n(r(829)),m=r(1),h=n(r(5)),v=n(r(3248));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).toggleAdvanced=function(){t.setState({showAdvanced:!t.state.showAdvanced})},t.handleError=function(e){t.context.setError(!!e)},t.state={showAdvanced:!1},t}return(0,u.default)(r,[{key:"render",value:function(){return i.default.createElement(f.Form.Group,null,i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("BUCKET"),desc:t("BUCKET_NAME_DESC"),rules:[{required:!0,message:t("BUCKET_NAME_EMPTY_TIP")}]},i.default.createElement(f.Input,{name:"bucket"}))),i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("REGION"),desc:t("REGION_DESC")},i.default.createElement(f.Input,{name:"region"})))),i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("ENDPOINT"),desc:t("ENDPOINT_DESC"),rules:[{required:!0,message:t("ENDPOINT_EMPTY_TIP")}]},i.default.createElement(f.Input,{name:"endpoint"}))),i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("ACCESS_KEY"),desc:t("ACCESS_KEY_DESC"),rules:[{required:!0,message:t("ACCESS_KEY_EMPTY_TIP")}]},i.default.createElement(f.Input,{name:"access_key"})))),i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("SECRET_KEY"),desc:t("SECRET_KEY_DESC"),rules:[{required:!0,message:t("SECRET_KEY_EMPTY_TIP")}]},i.default.createElement(f.Input,{name:"secret_key"})))),i.default.createElement("div",{className:v.default.advanced,onClick:this.toggleAdvanced},i.default.createElement("span",null,t("ADVANCED_SETTINGS")),i.default.createElement(f.Icon,{name:this.state.showAdvanced?"chevron-up":"chevron-down",size:"20"})),this.state.showAdvanced&&i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"margin-b12"},i.default.createElement("div",{className:v.default.content},i.default.createElement(f.Form.Item,null,i.default.createElement(d.default,{name:"insecure",title:t("HTTP_PROTOCOL"),description:t("HTTP_PROTOCOL_DESC")})))),i.default.createElement("div",{className:"margin-b12"},i.default.createElement(f.Form.Group,{label:t("ADD_STORAGE_CLASS"),desc:t("ADD_STORAGE_CLASS_DESC"),checkable:!0},i.default.createElement("div",{className:v.default.expandContent},i.default.createElement(f.Form.Item,{label:t("OBJECT_STORAGE_PARAMETERS")},i.default.createElement(p.default,{name:"put_user_metadata",addText:t("ADD"),onError:this.handleError}))))),i.default.createElement(f.Form.Group,{label:t("HTTP_CONFIGURATION"),desc:t("HTTP_CONFIGURATION_DESC"),checkable:!0},i.default.createElement("div",{className:v.default.expandContent},i.default.createElement("div",{className:"margin-b12"},i.default.createElement("div",{className:v.default.title},t("TLS_CERTIFICATE")),i.default.createElement("div",{className:v.default.content},i.default.createElement(f.Form.Item,null,i.default.createElement(d.default,{name:"http_config.insecure_skip_verify",title:t("TLS_CERTIFICATE_VERIFY"),description:t("TLS_CERTIFICATE_VERIFY_DESC")})))),i.default.createElement("div",null,i.default.createElement("div",{className:v.default.title},t("TLS_CONNECTION")),i.default.createElement("div",{className:(0,h.default)(v.default.content,"padding-12")},i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("CA_CERTIFICATE"),desc:t("CA_CERTIFICATE_DESC")},i.default.createElement(f.Input,{name:"http_config.tls_config.ca_file"}))),i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("CERT_CERTIFICATE"),desc:t("CERT_CERTIFICATE_DESC")},i.default.createElement(f.Input,{name:"http_config.tls_config.cert_file"})))),i.default.createElement(f.Columns,null,i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("KEY_FILE"),desc:t("KEY_FILE_DESC")},i.default.createElement(f.Input,{name:"http_config.tls_config.key_file"}))),i.default.createElement(f.Column,null,i.default.createElement(f.Form.Item,{label:t("SERVER_NAME"),desc:t("SERVER_NAME_DESC")},i.default.createElement(f.Input,{name:"http_config.tls_config.server_name"})))),i.default.createElement("div",{className:v.default.content},i.default.createElement(f.Form.Item,null,i.default.createElement(d.default,{name:"http_config.tls_config.insecure_skip_verify",title:t("SERVER_CERTIFICATE_VERFICATION"),description:t("SERVER_CERTIFICATE_VERFICATION_DESC")})))))))))}}]),r}(i.default.Component);a.default=y,y.contextTypes={setError:m.PropTypes.func}},function(e,t,a){e.exports={title:"xlrctHqAGoM3-7wqCWawl",content:"_16xmHwEuS7d71mxiRU9TNN",expandContent:"_2yoxiaDukOzg3T2rtX3viR",advanced:"_1SjsNWLnhAANRQ6yQGMh0S",checkable:"_1LzxCfNNo8Os7t3E83hijQ"}},function(e,t,a){e.exports={switch:"_3139AgLry0KT0AKnrNHwTY",yamlSwitch:"_1I3fsLusd2MeDsi_847tTM",wrapper:"_3v5DnglM2JGzVR-VTZfZQm",textWrapper:"_9_V5Fp0d6irvfeDFuTifE",text:"_1QuglDCimaTalkZt2SrU7L",form:"_1WkcONaZMAeyzaEnELOl_m"}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(18),r(43),r(11);var u=l(r(317)),o=l(r(25)),c=l(r(28)),s=l(r(41)),i=l(r(42)),f=l(r(37)),d=n(r(0)),p=l(r(843)),m=l(r(1)),h=r(189),v=l(r(119)),E=l(r(26));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var g=function(e){(0,s.default)(r,e);var a=y(r);function r(e){var t;(0,o.default)(this,r),(t=a.call(this,e)).handleFormChange=function(){var e=t.state.formTemplate;(0,t.context.registerUpdate)(t.name,e)},t.handleSubmit=function(e){var a=t.props.onSave,r=t.state.formTemplate;t.formRef.current&&t.formRef.current.validate((function(){a(r,["ruler"]),e&&e()}))},t.resetData=function(){t.setState({formTemplate:(0,v.default)(t.props.formTemplate)})};var n=t.props,l=n.updatedData,u=n.formTemplate;return t.state={formTemplate:(0,v.default)(l||u)},t.formRef=(0,d.createRef)(),t}return(0,c.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.updatedData,r=t.formTemplate;e.formTemplate===r&&e.updatedData===a||this.setState({formTemplate:(0,v.default)(a||r)})}},{key:"render",value:function(){return d.default.createElement(h.Form,{onChange:this.handleFormChange,data:this.state.formTemplate,ref:this.formRef},d.default.createElement(h.Form.Group,null,d.default.createElement(h.Form.Item,{label:t("CONTAINER_QUOTA")},d.default.createElement(p.default,(0,u.default)({name:"ruler.resources"},this.resourceLimitProps)))))}},{key:"name",get:function(){return"ruler"}},{key:"resourceLimitProps",get:function(){var e=this,t=this.state.formTemplate;return{memoryProps:{unit:"Gi"},defaultValue:{limits:{cpu:(0,E.default)(t,'ruler.resources["limits.cpu"]'),memory:(0,E.default)(t,'ruler.resources["limits.memory"]')},requests:{cpu:(0,E.default)(t,'ruler.resources["requests.cpu"]'),memory:(0,E.default)(t,'ruler.resources["requests.memory"]')}},onError:function(t){e.context.setError(!!t)}}}}]),r}(d.default.Component);a.default=g,g.contextTypes={registerUpdate:m.default.func,setError:m.default.func}},function(e,t,a){e.exports={body:"RDttHAMF2fro2rtZaH58l",wrapper:"_3euUglLYcVcJz8uhrpyhnZ",tabs:"p61-5CAC0HoCHoWjkbxnU",active:"_2Jz2sDF6YCMLekW5WbLApi",tip:"_1ZiYOI9tpyps-7SM1xUlC3",tooltipTrigger:"_11QxqKiBLxiuqt0cBEVbA4",tipIcon:"WMMuPo2sW-g8RqQ4SELLX",updateIcon:"_1fpvpxqpnchJ6cfOJTD_cn",content:"_3cOzqla_AvDSZAP_FrqMbT",main:"_4SBgKZ1OaxAr3QsBWtiFi",confirm:"_1lWSfda-M2WG_C7dsSA3oo",confirmActive:"_2XBZlke0tmO5RpKmbfOqQb",footer:"_2cLE_gXmH1U5DZ5kS1dOuV",formFooter:"_2qoB3osIu-rchZXVsllB8r"}},function(e,a,r){"use strict";var n=r(19);r(12),r(3),r(10),r(6),r(70),r(20),r(51),r(14),r(8),r(13),r(9),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(3),r(10),r(6),r(70),r(20),r(27),r(51),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(7);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(58)),i=n(r(26)),f=n(r(67)),d=n(r(140)),p=r(17),m=r(56),h=n(r(191)),v=n(r(798)),E=n(r(819)),y=n(r(3253)),g=n(r(3255)),b=n(r(3256)),S=n(r(3258)),_=n(r(3261)),O=n(r(1130)),C=n(r(3264)),T=r(61),R=n(r(438)),D=n(r(864)),k=n(r(1178)),N=n(r(1518)),I=n(r(1519)),P=n(r(3266)),A=n(r(3267)),w=n(r(540)),L=n(r(325)),M=r(364),x=n(r(3269));function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var F={deployments:[{title:"BASIC_INFORMATION",icon:"cdn",component:x.default,required:!0}].concat((0,s.default)(k.default.slice(1))),statefulsets:[{title:"BASIC_INFORMATION",icon:"cdn",component:(0,m.withProps)(x.default,{withService:!0}),required:!0}].concat((0,s.default)(N.default.slice(1))),daemonsets:[{title:"BASIC_INFORMATION",icon:"cdn",component:x.default,required:!0}].concat((0,s.default)(I.default.slice(1))),jobs:P.default,cronjobs:A.default},V={"workload.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,y=e.module,g=e.success,b=e.isFederated,S=e.renderScheduleTab,_=void 0!==S&&S,C=e.supportGpuSelect,k=void 0!==C&&C,N=(e.isAdmin,e.isProject),I=e.k8sVersion,P=void 0===I?"":I,A=(0,c.default)(e,["store","cluster","namespace","module","success","isFederated","renderScheduleTab","supportGpuSelect","isAdmin","isProject","k8sVersion"]),w=T.MODULE_KIND_MAP[y],L=(0,o.default)({},w,R.default[y]({namespace:n}));"cronjobs"===y&&(L[w].apiVersion=(0,M.isK8sVersionAbove)("v1.21.0",P)?"batch/v1":"batch/v1beta1");var x={};"statefulsets"===y&&(L.Service=R.default.services({namespace:n,selector:L[w].metadata.labels})),b&&(Object.keys(L).forEach((function(e){L[e]=R.default.federated({data:L[e],clusters:A.projectDetail.clusters.map((function(e){return e.name})),kind:e}),x=R.default.deploymentsSchedule({data:L[e],includeClusters:A.projectDetail.clusters.map((function(e){return e.name}))})})),a.setScheduleTemplate(x));var j=(0,s.default)(F[y]);b&&j.push({title:"CLUSTER_DIFF",icon:"blue-green-deployment",component:(0,m.withProps)(O.default,{withService:"statefulsets"===y})}),_&&a.ifRenderScheduleTab(_);var V=v.default.open(U(U({onOk:function(e){if(b&&("deployments"===y?(0,m.multiCluster_overrides_Dot)((0,i.default)(e,"Deployment.spec.overrides",[])):"statefulsets"===y&&(0,m.multiCluster_overrides_Dot)((0,i.default)(e,"StatefulSet.spec.overrides",[]))),"jobs"!==y||(0,i.default)(e,"Job.metadata.namespace")){var o=e=(0,d.default)(e,(0,T.OMIT_TOTAL_REPLICAS)(w));if(o){var c=(0,i.default)(o,"spec.template.spec.customMode",{});(0,f.default)(c)||delete o.spec.template.spec.customMode,w&&1===Object.keys(e).length&&e[w]&&(o=e[w]),a.create(o,{cluster:r,namespace:n},P).then((0,u.default)(l.default.mark((function e(){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.isScheduleDeployment||!_){e.next=7;break}return u=(0,p.toJS)(a.scheduleTemplate),e.next=5,a.scheduleCreate(u,{cluster:r,namespace:n});case 5:return e.next=7,a.switchSchedule(!1);case 7:v.default.close(V),h.default.success({content:t("CREATE_SUCCESSFUL")}),g&&g(),D.default.delete("".concat(y,"_create_form"));case 11:case"end":return e.stop()}}),e)}))))}}else h.default.error({content:t("PROJECT_NOT_SELECT_DESC")})},onCancel:function(){a.isScheduleDeployment&&_&&a.switchSchedule(!1)},steps:j,module:y,cluster:r,namespace:n,name:w,isFederated:b,formTemplate:L,modal:E.default,store:a,supportGpuSelect:k,isProject:N},A),{},{hideFooter:!0}))}},"workload.redeploy":{on:function(e){var a=e.store,r=e.detail,n=e.module,l=(e.success,(0,c.default)(e,["store","detail","module","success"])),u=T.MODULE_KIND_MAP[n],o=v.default.open(U({onOk:function(){a.patch(r,{spec:{template:{metadata:{annotations:{"kubesphere.io/restartedAt":new Date}}}}}).then((function(){v.default.close(o),h.default.success({content:t("RECREATE_SUCCESS_DESC")})}))},detail:r,type:u,modal:y.default,store:a},l))}},"workload.revision.rollback":{on:function(e){var t=e.store,a=e.detail,r=e.success,n=(0,c.default)(e,["store","detail","success"]),l=v.default.open(U({onOk:function(e){t.rollBack(U(U({},a),{},{module:t.module}),e).then((function(){v.default.close(l),r&&r()}))},detail:a,modal:g.default,store:t},n))}},"workload.hpa.edit":{on:function(e){var t=e.store,a=e.detail,r=e.success,n=e.k8sVersion,o=(0,c.default)(e,["store","detail","success","k8sVersion"]),s=new w.default,f=v.default.open(U({onOk:function(e,o){o?s.patch(a,e,n).then((function(){v.default.close(f),r&&r()})):s.create(e,a,n).then((0,u.default)(l.default.mark((function n(){return l.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return v.default.close(f),n.next=3,t.patch(a,{metadata:{annotations:{"kubesphere.io/relatedHPA":(0,i.default)(e,"metadata.name",a.name)}}});case 3:r&&r();case 4:case"end":return n.stop()}}),n)}))))},detail:a,store:s,modal:b.default},o))}},"workload.template.edit":{on:function(e){var t=e.store,a=e.detail,r=e.success,n=e.supportGpuSelect,l=void 0!==n&&n,u=e.hideVolumeSetting,o=void 0===u||u,s=e.showVolumeTemplate,d=void 0!==s&&s,m=(0,c.default)(e,["store","detail","success","supportGpuSelect","hideVolumeSetting","showVolumeTemplate"]),h=v.default.open(U({onOk:function(e){var n=(0,i.default)(e,"spec.template.spec.customMode",{});(0,f.default)(n)||delete e.spec.template.spec.customMode,t.update(a,e).then((function(){v.default.close(h),r&&r()}))},store:t,module:t.module,detail:(0,p.toJS)(a._originData),modal:S.default,supportGpuSelect:l,hideVolumeSetting:o,showVolumeTemplate:d},m))}},"workload.service.edit":{on:function(e){e.store;var t=e.detail,a=e.success,r=(0,c.default)(e,["store","detail","success"]),n=new L.default,l={type:"Headless(Selector)",name:(0,i.default)(t,"_originData.spec.serviceName",""),namespace:t.namespace,cluster:t.cluster},u=v.default.open(U({onOk:function(e){n.update(l,e).then((function(){v.default.close(u),a&&a()}))},detail:l,store:n,modal:_.default},r))}},"workload.delete":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=e.k8sVersion,u=(0,c.default)(e,["store","detail","success","k8sVersion"]),o=v.default.open(U({onOk:function(){v.default.close(o),h.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n()},store:a,modal:C.default,resource:r,k8sVersion:l},u))}},"workload.batch.delete":{on:function(e){var a=e.store,r=e.success,n=e.rowKey,l=void 0===n?"name":n,u=e.k8sVersion,o=(0,c.default)(e,["store","success","rowKey","k8sVersion"]),s=a.list,i=s.data,f=s.selectedRowKeys,d=i.filter((function(e){return f.includes(e[l])})),p=v.default.open(U({onOk:function(){v.default.close(p),h.default.success({content:t("DELETED_SUCCESSFULLY")}),r&&r()},modal:C.default,resource:d,k8sVersion:u,store:a},o))}}};a.default=V},function(e,a,r){"use strict";r(16);var n=r(19);r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(317)),u=n(r(50)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=n(r(1)),m=r(189),h=n(r(798)),v=n(r(3254));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var y=function(e){(0,s.default)(r,e);var a=E(r);function r(){return(0,o.default)(this,r),a.apply(this,arguments)}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.detail,r=e.type,n=(0,u.default)(e,["detail","type"]);return d.default.createElement(h.default,(0,l.default)({width:520,hideHeader:!0},n),d.default.createElement("div",{className:v.default.wrapper},d.default.createElement(m.Icon,{name:"question",size:40}),d.default.createElement("div",{className:v.default.text},d.default.createElement("div",null,t("RECREATE")),d.default.createElement("p",null,t("RECREATE_CONFIRM_DESC",{resource:a.name,type:t("".concat(r.toUpperCase(),"_LOW"))})))))}}]),r}(d.default.Component);a.default=y,y.propTypes={detail:p.default.object,visible:p.default.bool,onOk:p.default.func,onCancel:p.default.func,isSubmitting:p.default.bool},y.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,t,a){e.exports={wrapper:"_3gb5XWpq8vzH4mrGry7uxR",text:"_1YDX9cVd-P4aUdI_eBcLhl"}},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(44),r(6),r(20),r(14),r(24),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(24),r(33),r(16),r(8),r(13),r(9),r(4),r(321),r(18),r(43),r(11),r(7);var l,u,o,c=n(r(31)),s=n(r(25)),i=n(r(28)),f=n(r(41)),d=n(r(42)),p=n(r(37)),m=n(r(0)),h=r(17),v=r(243),E=n(r(1)),y=n(r(26)),g=n(r(445)),b=r(189),S=n(r(798)),_=r(249),O=n(r(1202));function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,d.default)(this,a)}}var D=(0,v.observer)((o=u=function(e){(0,f.default)(r,e);var a=R(r);function r(e){var t;return(0,s.default)(this,r),(t=a.call(this,e)).fetchData=function(e){t.revisionStore.fetchList(e)},t.getFormData=function(){return{name:t.props.detail.name,currentRevision:"#".concat(t.curRevision)}},t.getRevisionOps=function(){return(0,g.default)(t.revisions,(function(e){return parseInt(e.revision,10)})).map((function(e){var t=e.revision;return{label:"#".concat(t),value:Number(t)}})).filter((function(e){return e.value!==t.curRevision}))},t.handleOk=function(){var e=t.props,a=e.detail,r=e.store,n=e.onOk;if(t.form&&t.form.current){var l=t.form.current;l&&l.validate((function(){var e,u=l.getData(),o=t.revisions.find((function(e){return Number(e.revision)===u.revision}));e="deployments"===r.module?[{op:"replace",path:"/spec/template",value:(0,h.toJS)((0,y.default)(o,"spec.template"))},{op:"replace",path:"/metadata/annotations",value:a.annotations}]:{spec:{template:T({$patch:"replace"},(0,h.toJS)((0,y.default)(o,"spec.template")))}},n(e)}))}},t.revisionStore=new O.default(e.store.module),t.form=m.default.createRef(),t}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.props.visible&&this.fetchData(this.props.detail)}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=this.getFormData();return m.default.createElement(S.default.Form,{formRef:this.form,data:l,width:691,title:t("ROLL_BACK"),icon:"timed-task",onOk:this.handleOk,onCancel:r,visible:a,isSubmitting:n},m.default.createElement(b.Form.Item,{label:t("RESOURCE_NAME")},m.default.createElement(b.Input,{name:"name",disabled:!0})),m.default.createElement(b.Form.Item,{label:t("CURRENT_REVISION_RECORD")},m.default.createElement(b.Input,{name:"currentRevision",disabled:!0})),m.default.createElement(b.Form.Item,{label:t("TARGET_REVISION_RECORD"),rules:[{required:!0,message:t("TARGET_REVISION_EMPTY_DESC")}]},m.default.createElement(b.Select,{name:"revision",placeholder:" ",options:this.getRevisionOps()})))}},{key:"revisions",get:function(){var e=this.revisionStore.list,t=e.data;return e.isLoading?[]:t}},{key:"curRevision",get:function(){var e=this.props,t=e.store,a=e.detail;return(0,_.getCurrentRevision)(a,this.revisions,t.module)}}]),r}(m.default.Component),u.propTypes={visible:E.default.bool,detail:E.default.object,onOk:E.default.func,onCancel:E.default.func},u.defaultProps={visible:!1,detail:{},onOk:function(){},onCancel:function(){}},l=o))||l;a.default=D},function(e,a,r){"use strict";r(16);var n=r(19);r(44),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(44),r(29),r(14),r(4),r(18),r(43),r(11);var l,u,o,c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(17),h=r(243),v=n(r(1)),E=n(r(68)),y=n(r(204)),g=r(189),b=n(r(798)),S=n(r(805)),_=n(r(3257));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var C=(0,h.observer)((o=u=function(e){(0,i.default)(r,e);var a=O(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).fetchData=function(e){var a,r,n=e.detail,l=n.namespace,u=n.cluster,o=n.annotations,c={name:(void 0===o?{}:o)["kubesphere.io/relatedHPA"]||e.detail.name,cluster:u,namespace:l},s=null===(a=globals.clusterConfig)||void 0===a||null===(r=a[u])||void 0===r?void 0:r.k8sVersion;t.setState({loading:!0},(function(){t.store.checkName(c,"",s).then((function(e){t.isEdit=e.exist,e.exist?t.store.fetchDetail(c,s).then((function(){t.setState({loading:!1,formData:t.getFormData()})})):t.setState({loading:!1,formData:t.getFormData()})}))}))},t.getFormData=function(){var e,a,r,n,l,u,o,c,s,i,f,d,p,h,v,E,g,b,S,_,O,C,T=t.props.detail,R=T.name,D=T.namespace,k=T.uid,N=T.kind,I=(0,m.toJS)(t.store.detail),P=(null==I||null===(e=I._originData)||void 0===e||null===(a=e.spec)||void 0===a||null===(r=a.metrics)||void 0===r||null===(n=r.find((function(e){return"Resource"===e.type&&"cpu"===e.resource.name})))||void 0===n||null===(l=n.resource)||void 0===l||null===(u=l.target)||void 0===u?void 0:u.averageUtilization)||"",A=(null==I||null===(o=I._originData)||void 0===o||null===(c=o.spec)||void 0===c||null===(s=c.metrics)||void 0===s||null===(i=s.find((function(e){return"Resource"===e.type&&"memory"===e.resource.name})))||void 0===i||null===(f=i.resource)||void 0===f||null===(d=f.target)||void 0===d?void 0:d.averageValue)||"",w=(null==I||null===(p=I.status)||void 0===p||null===(h=p.currentMetrics)||void 0===h||null===(v=h.find((function(e){return"Resource"===e.type&&"cpu"===e.resource.name})))||void 0===v||null===(E=v.resource)||void 0===E||null===(g=E.current)||void 0===g?void 0:g.averageUtilization)||"",L=(null==I||null===(b=I.status)||void 0===b||null===(S=b.currentMetrics)||void 0===S||null===(_=S.find((function(e){return"Resource"===e.type&&"memory"===e.resource.name})))||void 0===_||null===(O=_.resource)||void 0===O||null===(C=O.current)||void 0===C?void 0:C.averageValue)||"";return(0,y.default)({},I._originData,{metadata:{name:R,namespace:D,annotations:{cpuCurrentUtilization:w,cpuTargetUtilization:P,memoryCurrentValue:L,memoryTargetValue:A},ownerReferences:[{apiVersion:"apps/v1",blockOwnerDeletion:!0,controller:!0,kind:N,name:R,uid:k}]},spec:{scaleTargetRef:{apiVersion:"apps/v1",kind:N,name:R}}})},t.handleOk=function(){var e=t.form.current;e&&e.validate((function(){var a=e.getData();t.isEdit&&(0,E.default)(a,"metadata.resourceVersion",null),t.props.onOk(a,t.isEdit)}))},t.form=p.default.createRef(),t.state={loading:!0,formData:void 0},t.store=e.store,t}return(0,s.default)(r,[{key:"componentDidMount",value:function(){this.fetchData(this.props)}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=this.store.isSubmitting,l=this.state,u=l.formData,o=l.loading;return p.default.createElement(b.default,{width:691,title:t("AUTOSCALING"),icon:"firewall",onOk:this.handleOk,onCancel:r,visible:a,isSubmitting:n},p.default.createElement(g.Loading,{spinning:o},p.default.createElement(g.Form,{data:u,ref:this.form},p.default.createElement(g.Alert,{className:_.default.alert,type:"info",message:t("CONFIGURE_AUTOSCALING_DESC")}),p.default.createElement(g.Form.Item,{label:t("RESOURCE_NAME"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")}]},p.default.createElement(g.Input,{name:"metadata.name",disabled:!0})),p.default.createElement(g.Form.Item,{label:t("TARGET_CPU_USAGE_UNIT"),desc:t("TARGET_CPU_USAGE_DESC")},p.default.createElement(S.default,{name:"metadata.annotations.cpuTargetUtilization",integer:!0,min:0,defaultValue:"",onChange:this.handleCPUChange})),p.default.createElement(g.Form.Item,{label:t("TARGET_MEMORY_USAGE_UNIT"),desc:t("TARGET_MEMORY_USAGE_DESC")},p.default.createElement(S.default,{name:"metadata.annotations.memoryTargetValue",integer:!0,unit:"Mi",min:0,defaultValue:"",onChange:this.handleMemoryChange})),p.default.createElement(g.Form.Item,{label:t("MINIMUM_REPLICAS"),desc:t("MINIMUM_REPLICAS_DESC")},p.default.createElement(S.default,{name:"spec.minReplicas",min:1,integer:!0,defaultValue:1})),p.default.createElement(g.Form.Item,{label:t("MAXIMUM_REPLICAS"),desc:t("MAXIMUM_REPLICAS_DESC")},p.default.createElement(S.default,{name:"spec.maxReplicas",min:1,integer:!0,defaultValue:1})))))}}]),r}(p.default.Component),u.propTypes={visible:v.default.bool,store:v.default.object,detail:v.default.object,onOk:v.default.func,onCancel:v.default.func},u.defaultProps={visible:!1,store:{},detail:{},onOk:function(){},onCancel:function(){}},l=o))||l;a.default=C},function(e,t,a){e.exports={alert:"_3edXUM4aRr_6Nn2mRSBgoq"}},function(e,t,a){"use strict";a(16);var r=a(19);a(10),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(10),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(50)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=r(a(1)),p=r(a(1008)),m=r(a(3259));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(a,e);var t=h(a);function a(){return(0,u.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.module,a=(0,l.default)(e,["module"]);return f.default.createElement(p.default,(0,n.default)({title:"EDIT_SETTINGS",icon:"storage",module:t,forms:this.forms},a))}},{key:"forms",get:function(){return m.default[this.props.module].filter((function(e){return!e.disabled}))}}]),a}(f.default.Component);t.default=v,v.propTypes={module:d.default.string},v.defaultProps={module:"deployments"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(1435)),l=r(a(3260)),u=r(a(1436)),o=r(a(1439)),c=r(a(1437)),s=r(a(1438)),i={deployments:[{icon:"dashboard",name:"updateStrategy",title:"UPDATE_STRATEGY",component:c.default},{icon:"container",name:"podTemplate",title:"CONTAINER_PL",component:u.default},{icon:"storage",name:"volumeSettings",title:"STORAGE",component:s.default},{icon:"group",name:"deploymentMode",title:"POD_SCHEDULING_RULES",component:n.default},{icon:"forbid-right-duotone",name:"podMode",title:"POD_GRACE_PERIOD",component:o.default},{icon:"eip-group",name:"ippools",title:"POD_IP_POOL",component:l.default,disabled:!globals.app.hasExtensionModuleAnnotation("network","network.kubesphere.io/enable-network-ippool")}],statefulsets:[{icon:"dashboard",name:"updateStrategy",title:"UPDATE_STRATEGY",component:c.default},{icon:"container",name:"podTemplate",title:"CONTAINER_PL",component:u.default},{icon:"forbid-right-duotone",name:"podMode",title:"POD_GRACE_PERIOD",component:o.default},{icon:"storage",name:"volumeSettings",title:"STORAGE",component:s.default},{icon:"group",name:"deploymentMode",title:"POD_SCHEDULING_RULES",component:n.default},{icon:"eip-group",name:"ippools",title:"POD_IP_POOL",component:l.default,disabled:!globals.app.hasExtensionModuleAnnotation("network","network.kubesphere.io/enable-network-ippool")}],daemonsets:[{icon:"dashboard",name:"updateStrategy",title:"UPDATE_STRATEGY",component:c.default},{icon:"container",name:"podTemplate",title:"POD_PL",component:u.default},{icon:"storage",name:"volumeSettings",title:"STORAGE",component:s.default},{icon:"forbid-right-duotone",name:"podMode",title:"POD_GRACE_PERIOD",component:o.default},{icon:"eip-group",name:"ippools",title:"POD_IP_POOL",component:l.default,disabled:!globals.app.hasExtensionModuleAnnotation("network","network.kubesphere.io/enable-network-ippool")}]};t.default=i},function(e,t,a){"use strict";a(16);var r=a(162),n=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(317)),u=a(189),o=n(a(1441)),c=r(a(0)),s=function(e){var t,a=e.formTemplate,r=e.formRef,n=e.formProps,s=e.module,i=e.cluster,f=e.namespace,d=e.rootStore;return c.createElement("div",{className:"margin-t12"},c.createElement(u.Form,(0,l.default)({data:a,ref:r},n),c.createElement(o.default,{formProps:n,data:a,module:s,cluster:i,namespace:f,replicas:null==a||null===(t=a.spec)||void 0===t?void 0:t.replicas,rootStore:d})))};t.default=s},function(e,a,r){"use strict";r(16);var n=r(19);r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(68)),m=r(61),h=n(r(325)),v=r(189),E=n(r(798)),y=n(r(3262));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var b=function(e){(0,o.default)(r,e);var a=g(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleOk=function(){var e=t.props.onOk,a=t.formRef.current;a&&a.validate((function(){var r=a.getData();(0,p.default)(r,"metadata.resourceVersion",t.store.detail.resourceVersion),e(r)}))},t.handleCancel=function(){(0,t.props.onCancel)()},t.formRef=i.default.createRef(),t.state={formTemplate:{}},t.store=e.store||new h.default,t.fetchData(e.detail),t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,r=t.detail;a&&a!==e.visible&&this.fetchData(r)}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.name&&t.namespace&&this.store.fetchDetail(t).then((function(){e.setState({formTemplate:(0,d.toJS)(e.store.detail._originData)})}))}},{key:"renderForm",value:function(){return i.default.createElement(y.default,{formRef:this.formRef,formTemplate:this.state.formTemplate})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.detail;return i.default.createElement(E.default,{width:1162,title:t("EDIT_SERVICE"),onOk:n.type!==m.SERVICE_TYPES.Unknown?this.handleOk:null,onCancel:this.handleCancel,okText:t("OK"),visible:a,isSubmitting:r},i.default.createElement(v.Loading,{spinning:this.store.isLoading},this.renderForm()))}}]),r}(i.default.Component);a.default=b,b.propTypes={visible:f.default.bool,detail:f.default.object,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},b.defaultProps={visible:!1,detail:{},onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";r(16);var n=r(19);r(20),r(9),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(9),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(26)),d=n(r(1154)),p=r(189),m=n(r(1e3)),h=n(r(827)),v=n(r(3263));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var y=function(e){(0,o.default)(r,e);var a=E(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"renderName",value:function(){return i.default.createElement(p.Form.Item,{label:t("NAME")},i.default.createElement(p.Input,{name:"metadata.name",disabled:!0}))}},{key:"renderSelectorLabels",value:function(){var e=(0,f.default)(this.props.formTemplate,"spec.selector",{});return i.default.createElement(p.Form.Item,{label:t("SELECTOR")},i.default.createElement("div",{className:v.default.selectors},Object.keys(e).map((function(t){return i.default.createElement(m.default,{key:t,name:t,value:e[t]})}))))}},{key:"renderTypeSelect",value:function(){return i.default.createElement(p.Form.Item,{label:t("INTERNAL_ACCESS_MODE")},i.default.createElement(h.default,{className:"margin-b12",value:this.state.serviceType,onChange:this.handleTypeChange,options:this.types,disabled:!0}))}},{key:"render",value:function(){var e=this.props.formRef;return i.default.createElement("div",{className:v.default.wrapper},i.default.createElement(p.Form,{data:this.formTemplate,ref:e},this.renderName(),this.renderTypeSelect(),this.renderSelectorLabels(),this.renderPorts()))}}]),r}(d.default);a.default=y},function(e,t,a){e.exports={card:"_1RshJt8HTq5HgEme5DfSMo",tabs:"wyrLrVtofUNlEaiwxIeFK",label:"QqDn4rm7cZu-6-D4Z5tTh",selectors:"_3_DdQN134r--ART1Vr6ZI9"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(14),r(4),r(21),r(18),r(11),r(73),r(46),r(7),r(40),r(110),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(10),r(6),r(70),r(36),r(66),r(20),r(27),r(29),r(14),r(4),r(21),r(18),r(43),r(11),r(73),r(46),r(7),r(40),r(110);var l=n(r(317)),u=n(r(50)),o=n(r(31)),c=n(r(58)),s=n(r(38));r(35);var i=n(r(39)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=r(189),E=n(r(5)),y=n(r(798)),g=n(r(844)),b=n(r(455)),S=n(r(26)),_=n(r(64)),O=n(r(67)),C=n(r(244)),T=n(r(850)),R=n(r(1)),D=n(r(0)),k=n(r(1203)),N=n(r(450)),I=n(r(325)),P=n(r(451)),A=r(56),w=r(61),L=n(r(3265));function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var x=function(e){(0,p.default)(n,e);var a,r=M(n);function n(e){var a;return(0,f.default)(this,n),(a=r.call(this,e)).stopPropagation=function(e){return e.stopPropagation()},a.handleOk=(0,i.default)(s.default.mark((function e(){var t,r,n,l,u,o,c,i,f,d,p,m,h,v,E;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,r=t.onOk,n=t.resource,l=t.k8sVersion,u=t.store,o=a.state,c=o.selectedRelatedResourceIds,i=o.relatedResources,f=o.scheduledProjectList,d=o.customScaling,p=[],i.forEach((function(e){c.includes(e.uid)&&("services"===e.module?p.push(a.serviceStore.delete(e)):"persistentvolumeclaims"===e.module&&p.push(a.volumeStore.delete(e)))})),m=[],d.forEach((function(e){m.push(a.hpaStore.delete((0,C.default)(e,"cluster","namespace","name"),l))})),e.next=8,Promise.all(m);case 8:return e.next=10,Promise.all(p);case 10:if(!(0,_.default)(n)){e.next=21;break}return h=n[0].namespace,v=n.map((function(e){return e.name})),E=v.filter((function(e){return f.includes(e)})),e.next=16,Promise.all(n.map((function(e){return u.delete(e,l)})));case 16:return e.next=18,Promise.all(E.map((function(e){return u.deleteSchedule({name:e,namespace:h})})));case 18:u.list.setSelectRowKeys([]),e.next=27;break;case 21:return e.next=23,u.delete(n,l);case 23:if(e.t0=f.includes(n.name),!e.t0){e.next=27;break}return e.next=27,u.deleteSchedule({name:n.name,namespace:n.namespace});case 27:r();case 28:case"end":return e.stop()}}),e)}))),a.handleItemClick=function(e){var t=e.currentTarget.dataset.uid;a.setState((function(e){var a=e.selectedRelatedResourceIds;return{selectedRelatedResourceIds:a.includes(t)?a.filter((function(e){return e!==t})):[].concat((0,c.default)(a),[t])}}))},a.handleSelectAll=function(){var e=a.state,t=e.relatedResources,r=e.selectedRelatedResourceIds;(0,O.default)(r)&&a.setState({selectedRelatedResourceIds:t.map((function(e){return e.uid}))})},a.renderContentItem=function(e){var r=a.state.selectedRelatedResourceIds;return D.default.createElement("div",{key:e.uid,"data-uid":e.uid,className:(0,E.default)(L.default.resource,(0,o.default)({},L.default.selected,r.includes(e.uid))),onClick:a.handleItemClick},D.default.createElement(v.Checkbox,{checked:r.includes(e.uid),onClick:a.stopPropagation}),D.default.createElement(v.Icon,{name:w.ICON_TYPES[e.module],size:20,type:r.includes(e.uid)?"light":"dark"}),D.default.createElement("span",{className:L.default.resourceName},e.name),D.default.createElement("span",{className:L.default.resourceType},t(w.MODULE_KIND_MAP[e.module])))},a.renderCustomScalingIterm=function(e){return D.default.createElement("div",{key:e.uid,"data-uid":e.uid,className:(0,E.default)(L.default.resource,L.default.selected,L.default.disabled,L.default.customScalingItem)},D.default.createElement("div",{className:L.default.disabled},D.default.createElement(v.Checkbox,{checked:!0}),D.default.createElement(v.Icon,{name:w.ICON_TYPES[e.module],size:20,type:"light"}),D.default.createElement("span",{className:L.default.resourceName},e.name),D.default.createElement("span",{className:L.default.resourceType},t(w.MODULE_KIND_MAP[e.module]))),D.default.createElement(v.Tooltip,{content:t("DELETE_CUSTOM_SCALING_WITH_WORKLOAD")},D.default.createElement(v.Icon,{name:"question",size:20,type:"light"})))},a.serviceStore=new I.default,a.volumeStore=new P.default,a.hpaStore=new k.default,e.isFederated&&(a.serviceStore=new N.default({module:a.serviceStore.module}),a.volumeStore=new N.default({module:a.volumeStore.module})),a.state={relatedResources:[],selectedRelatedResourceIds:[],enableConfirm:!1,timer:3,scheduledProjectList:[],customScaling:[]},a}return(0,d.default)(n,[{key:"componentDidMount",value:function(){this.props.visible&&(this.fetchRelatedResources(this.props.resource),this.startTimer())}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"startTimer",value:function(){var e=this;this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){e.setState((function(e){var t=e.timer;return{timer:Math.max(t-1,0),enableConfirm:t<=1}}),(function(){e.state.enableConfirm&&e.timer&&clearInterval(e.timer)}))}),1e3)}},{key:"fetchRelatedResources",value:(a=(0,i.default)(s.default.mark((function e(t){var a,r,n,l,u,o,c,i,f,d,p,m,h,v=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props.store,this.setState({isLoading:!0}),r=[],u=[],(0,_.default)(t)?(n=t[0].namespace,l=t[0].cluster,r=t.map((function(e){return e.selector||(0,S.default)(e,"resource.selector")}))):(n=t.namespace,l=t.cluster,r.push(t.selector||(0,S.default)(t,"resource.selector"))),o=[],!globals.app.hasKSModule("ks-autoscaling")){e.next=12;break}return c=[].concat(t),e.next=10,Promise.all(c.map((function(e){return v.hpaStore.fetchList({limit:-1,cluster:e.cluster,namespace:e.namespace,labelSelector:(0,A.joinSelector)({"autoscaling.kubeshpere.io/scale-target-kind":(0,S.default)(e,"._originData.kind"),"autoscaling.kubeshpere.io/scale-target-name":e.name})})})));case 10:i=e.sent,o=(0,b.default)(i).map((function(e){return(0,S.default)(e,"name")})).filter(Boolean).map((function(e){return{cluster:l,namespace:n,module:v.hpaStore.module,uid:e,name:e}}));case 12:return f=[],r.forEach((function(e){if(!(0,O.default)(e)){var t=(0,A.joinSelector)(e);f.push(v.volumeStore.fetchListByK8s({cluster:l,namespace:n,labelSelector:t}),v.serviceStore.fetchListByK8s({cluster:l,namespace:n,labelSelector:t}))}})),e.next=16,Promise.all(f);case 16:if(d=e.sent,"deployments"!==a.module){e.next=31;break}return e.next=20,null===(m=a.getAllScheduleProject)||void 0===m?void 0:m.call(a,{namespace:n});case 20:if(e.t1=p=e.sent,e.t0=null!==e.t1,!e.t0){e.next=24;break}e.t0=void 0!==p;case 24:if(!e.t0){e.next=28;break}e.t2=p,e.next=29;break;case 28:e.t2=[];case 29:h=e.t2,(0,O.default)(h)||(u=h.items.map((function(e){return e.metadata.name})));case 31:this.setState({relatedResources:(0,T.default)((0,b.default)(d),"uid"),isLoading:!1,scheduledProjectList:u,customScaling:o});case 32:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"renderContent",value:function(){var e=this.state,a=e.isLoading,r=e.relatedResources,n=e.selectedRelatedResourceIds,l=e.customScaling;return!1===a&&(0,O.default)(r)&&(0,O.default)(l)?D.default.createElement(g.default,{icon:"appcenter",className:L.default.empty,title:t("NO_RELATED_RESOURCE_FOUND"),desc:t("NO_WORKLOAD_RELATED_RESOURCE_DESC")}):D.default.createElement("div",{className:L.default.resources},!(0,O.default)(r)&&D.default.createElement("div",{className:L.default.resource},D.default.createElement(v.Checkbox,{checked:!(0,O.default)(n),onClick:this.handleSelectAll,indeterminate:!((0,O.default)(n)||r.length===n.length)}),D.default.createElement("span",{className:L.default.resourceName},t("SELECT_ALL"))),r.map(this.renderContentItem),l.map(this.renderCustomScalingIterm))}},{key:"render",value:function(){var e=this.state,a=e.enableConfirm,r=e.timer,n=this.props,o=n.resource,c=(n.onOk,n.onCancel),s=n.isSubmitting,i=(0,u.default)(n,["resource","onOk","onCancel","isSubmitting"]),f=(0,_.default)(o)&&1!==o.length?t("DELETE_MULTIPLE_WORKLOADS"):t("DELETE_WORKLOAD"),d=(0,_.default)(o)&&1!==o.length?t.html("DELETE_WORKLOAD_DESC_PL",{resource:o.map((function(e){return e.name})).join(", ")}):(0,_.default)(o)?t.html("DELETE_WORKLOAD_DESC_SI",{resource:o.map((function(e){return e.name})).join(", ")}):t.html("DELETE_WORKLOAD_DESC_SI",{resource:o.name});return D.default.createElement(y.default,(0,l.default)({width:520,icon:"question",title:f,description:d,closable:!1,headerClassName:L.default.modalHeader,bodyClassName:L.default.modalBody,hideFooter:!0},i),D.default.createElement("div",{className:L.default.body},this.renderContent()),D.default.createElement("div",{className:L.default.footer},D.default.createElement(v.Button,{onClick:c,"data-test":"modal-cancel"},t("CANCEL")),D.default.createElement(v.Button,{type:"danger",loading:s,disabled:!a||s,onClick:this.handleOk,"data-test":"modal-ok"},t("OK"),!a&&"(".concat(r,"s)"))))}}]),n}(D.default.Component);a.default=x,x.propTypes={resource:R.default.any,visible:R.default.bool,onOk:R.default.func,onCancel:R.default.func,isSubmitting:R.default.bool},x.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={modalHeader:"_3TWrkomcU0cg65Le73FSC6",modalBody:"GK12m4CmybdVZClmBgcjk",body:"c8zsi95wQs89Y_fT0jHjR",resources:"_2XklTVyP5zrvHq-zl-pnkT",resource:"_2gyGrCh2fmo6Zv7TuojvaX",disabled:"_2SEqTLcTIi2h_rw710xcav",customScalingItem:"_3oE7NfvRe5VeEk1YyhYtcE",selected:"_7hDVeAnevM4xDK8nX4AVT",resourceName:"_2w4PDjTp1CNVaUpPVohjMs",resourceType:"_2acsON3o1XJq_j-yeoQkCn",footer:"_3Cme0DKegaGUSuwkdW_EyZ",empty:"_3b_ipjHAWArqQ2Cbg-SOXT"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(56),l=r(a(911)),u=r(a(915)),o=r(a(963)),c=r(a(1520)),s=r(a(1521)),i=[{title:"BASIC_INFORMATION",icon:"cdn",component:(0,n.withProps)(l.default,{maxNameLength:63}),required:!0},{title:"STRATEGY_SETTINGS",icon:"job",component:c.default,required:!0},{title:"POD_SETTINGS",icon:"docker",component:s.default,required:!0},{title:"STORAGE_SETTINGS",icon:"storage",component:u.default,required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:o.default,required:!0}];t.default=i},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(56),l=r(a(3268)),u=r(a(1520)),o=r(a(1521)),c=r(a(915)),s=r(a(963)),i=[{title:"BASIC_INFORMATION",icon:"cdn",component:l.default,required:!0},{title:"STRATEGY_SETTINGS",icon:"cron-job",component:(0,n.withProps)(u.default,{prefix:"spec.jobTemplate.spec."}),required:!0},{title:"POD_SETTINGS",icon:"docker",component:(0,n.withProps)(o.default,{prefix:"spec.jobTemplate.spec.template."}),required:!0},{title:"STORAGE_SETTINGS",icon:"storage",component:(0,n.withProps)(c.default,{prefix:"spec.jobTemplate.spec.template."}),required:!0},{title:"ADVANCED_SETTINGS",icon:"slider",component:(0,n.withProps)(s.default,{prefix:"spec.jobTemplate.spec.template."}),required:!0}];t.default=i},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(51),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(51),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=r(189),f=n(r(805)),d=n(r(898)),p=n(r(899)),m=n(r(808)),h=n(r(26)),v=n(r(68)),E=n(r(0)),y=r(56),g=r(61);function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var S=function(e){(0,o.default)(r,e);var a=b(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,u=new Array(n),o=0;o<n;o++)u[o]=arguments[o];return(e=a.call.apply(a,[this].concat(u))).handleNameChange=(0,m.default)((function(t){var a=(0,h.default)(e.formTemplate,"metadata.labels",{});a.app=t.slice(0,63),(0,v.default)(e.formTemplate,"spec.jobTemplate.metadata.labels",a)}),200),e.nameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:r,namespace:e.namespace,cluster:e.props.cluster},"",e.k8sVersion).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e.getConcurrencyPolicyOptions=function(){return[{label:t("RUN_JOBS_CONCURRENTLY"),value:"Allow"},{label:t("SKIP_NEW_JOB"),value:"Forbid"},{label:t("SKIP_OLD_JOB"),value:"Replace"}]},e}return(0,u.default)(r,[{key:"getCronOptions",value:function(){return[{label:t("EVERY_HOUR"),value:"0 * * * *"},{label:t("EVERY_DAY"),value:"0 0 * * *"},{label:t("EVERY_WEEK"),value:"0 0 * * 0"},{label:t("EVERY_MONTH"),value:"0 0 1 * *"}]}},{key:"render",value:function(){var e=this.props.formRef,a=t.html("CRONJOB_CRON_DESC");return E.default.createElement(i.Form,{data:this.formTemplate,ref:e},E.default.createElement(i.Columns,null,E.default.createElement(i.Column,null,E.default.createElement(i.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:g.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("NAME_DESC")})},{validator:this.nameValidator}]},E.default.createElement(i.Input,{name:"metadata.name",onChange:this.handleNameChange,autoFocus:!0,maxLength:52}))),E.default.createElement(i.Column,null,E.default.createElement(i.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:g.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},E.default.createElement(i.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),E.default.createElement(i.Columns,{className:"is-multiline"},!this.props.namespace&&E.default.createElement(i.Column,{className:"is-6"},E.default.createElement(i.Form.Item,{label:t("PROJECT"),desc:t("PROJECT_DESC"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")}]},E.default.createElement(d.default,{name:"metadata.namespace",cluster:this.props.cluster,defaultValue:this.namespace}))),E.default.createElement(i.Column,{className:"is-6"},E.default.createElement(i.Form.Item,{label:t("SCHEDULE"),desc:(0,y.learnMoreTip)(a),rules:[{required:!0,message:t("ENTER_SCHEDULE_TIP")}]},E.default.createElement(i.Select,{name:"spec.schedule",options:this.getCronOptions(),searchable:!0,placeholder:" "}))),E.default.createElement(i.Column,{className:"is-6"},E.default.createElement(i.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},E.default.createElement(i.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))),E.default.createElement(p.default,null,E.default.createElement(i.Columns,{className:"margin-t8"},E.default.createElement(i.Column,null,E.default.createElement(i.Form.Item,{label:t("MAXIMUM_DELAY"),desc:t("MAXIMUM_DELAY_DESC")},E.default.createElement(f.default,{min:0,name:"spec.startingDeadlineSeconds",integer:!0})),E.default.createElement(i.Form.Item,{label:t("FAILED_JOBS_RETAINED"),desc:t("FAILED_JOBS_RETAINED_DESC")},E.default.createElement(f.default,{min:0,name:"spec.failedJobsHistoryLimit",integer:!0}))),E.default.createElement(i.Column,null,E.default.createElement(i.Form.Item,{label:t("SUCCESSFUL_JOBS_RETAINED"),desc:t("SUCCESSFUL_JOBS_RETAINED_DESC")},E.default.createElement(f.default,{min:0,name:"spec.successfulJobsHistoryLimit",integer:!0})),E.default.createElement(i.Form.Item,{label:t("CONCURRENCY_POLICY"),desc:t("CONCURRENCY_POLICY_DESC")},E.default.createElement(i.Select,{name:"spec.concurrencyPolicy",options:this.getConcurrencyPolicyOptions()}))))))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,h.default)(t,g.MODULE_KIND_MAP[a],t)}},{key:"namespace",get:function(){return(0,h.default)(this.formTemplate,"metadata.namespace")}},{key:"k8sVersion",get:function(){var e,t;return null===(e=globals.clusterConfig)||void 0===e||null===(t=e[this.props.cluster])||void 0===t?void 0:t.k8sVersion}}]),r}(E.default.Component);a.default=S},function(e,a,r){"use strict";r(16);var n=r(19);r(12),r(109),r(3),r(10),r(6),r(70),r(20),r(51),r(14),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(6),r(70),r(20),r(27),r(51),r(29),r(14),r(9),r(4),r(18),r(43),r(30),r(195),r(11),r(73),r(1013),r(7),r(1014),r(1015),r(1016);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(189),p=n(r(808)),m=n(r(26)),h=n(r(68)),v=n(r(140)),E=n(r(196)),y=r(243),g=r(56),b=r(61),S=n(r(898)),_=n(r(441)),O=n(r(477));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var T=(0,y.observer)(l=function(e){(0,c.default)(r,e);var a=C(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).projectStore=new _.default,e.workloadTemplateStore=new O.default,e.state={templates:[]},e.nameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:r,namespace:e.namespace,cluster:e.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e.handleNameChange=(0,p.default)((function(t){var a=e.props,r=a.module,n=a.isFederated,l=(0,m.default)(e.fedFormTemplate,"metadata.labels",{});b.APP_LABEL_MODULES.includes(r)&&(l.app=t.slice(0,63)),(0,g.updateLabels)(e.fedFormTemplate,r,l),n&&b.APP_LABEL_MODULES.includes(r)&&(0,h.default)(e.formTemplate,"metadata.labels.app",t.slice(0,63))}),200),e.handleTemplateChange=function(t){try{var a=JSON.parse(atob(t)),r={name:(0,m.default)(e.formTemplate,"metadata.name"),namespace:(0,m.default)(e.formTemplate,"metadata.namespace"),alias:(0,m.default)(e.formTemplate,'metadata.annotations["kubesphere.io/alias-name"]'),description:(0,m.default)(e.formTemplate,'metadata.annotations["kubesphere.io/description"]')};(0,h.default)(e.formTemplate,"metadata",a.metadata),(0,h.default)(e.formTemplate,"spec",a.spec),r.name&&(0,h.default)(e.formTemplate,"metadata.name",r.name),r.namespace&&(0,h.default)(e.formTemplate,"metadata.namespace",r.namespace),r.alias&&(0,h.default)(e.formTemplate,'metadata.annotations["kubesphere.io/alias-name"]',r.alias),r.description&&(0,h.default)(e.formTemplate,'metadata.annotations["kubesphere.io/description"]',r.description),e.props.withService&&e.updateService(a),e.forceUpdate()}catch(e){console.error("resolve template error:",e)}},e.updateService=function(t){var a=e.props,r=a.formTemplate;if(a.withService){var n=(0,m.default)(t,"spec.template.spec.containers",[]),l=[];n.forEach((function(e){e.ports&&e.ports.forEach((function(e){e.servicePort&&l.push({name:e.name,protocol:e.protocol,port:e.servicePort,targetPort:e.containerPort})}))}));var u=r.Service,o=e.props.isFederated?"spec.template.":"";(0,h.default)(u,"".concat(o,"spec.ports"),l);var c=(0,m.default)(t,"metadata.labels",{}),s=(0,m.default)(t,"spec.template.metadata.labels",{});(0,h.default)(u,"metadata.labels",c),(0,h.default)(u,"".concat(o,"spec.selector"),(0,v.default)(s,"version")),"statefulsets"===e.props.module?(0,h.default)(u,"".concat(o,"spec.clusterIP"),"None"):(0,E.default)(u,"".concat(o,"spec.clusterIP"))}},e.handleProjectChange=function(t){(0,h.default)(e.formTemplate,"metadata.namespace",t),e.forceUpdate()},e}return(0,o.default)(r,[{key:"componentDidMount",value:function(){var e=this;this.workloadTemplateStore.fetchList({namespace:this.namespace,cluster:this.cluster}).then((function(t){var a,r,n,l=null!==(a=null===(r=t.items)||void 0===r||null===(n=r.filter((function(t){return JSON.parse(atob(t.data.workloadTemplate))["workload-template-type"]===e.props.module})))||void 0===n?void 0:n.map((function(e){return{label:e.metadata.name,value:e.data.workloadTemplate}})))&&void 0!==a?a:[];e.setState({templates:l})})),this.props.withService&&this.initService(this.formTemplate)}},{key:"initService",value:function(){var e=(0,m.default)(this.formTemplate,"metadata.name"),t=(0,m.default)(this.props.formTemplate,"Service.metadata.name");e&&!t&&(t="".concat(e.slice(0,57),"-").concat((0,g.generateId)(4)),/^[a-z]/.test(t)||(t="s".concat(t)),(0,h.default)(this.props.formTemplate,"Service.metadata.name",t),(0,h.default)(this.props.formTemplate,'Service.metadata.annotations["kubesphere.io/alias-name"]',e),(0,h.default)(this.props.formTemplate,'Service.metadata.annotations["kubesphere.io/serviceType"]',"statefulservice"),(0,h.default)(this.fedFormTemplate,"spec.serviceName",t))}},{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.maxNameLength,n=void 0===r?253:r,l=253===n?t("LONG_NAME_DESC"):t("NAME_DESC");return f.default.createElement(d.Form,{data:this.formTemplate,ref:a},f.default.createElement(d.Columns,null,f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("NAME"),desc:l,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:b.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:l})}]},f.default.createElement(d.Input,{name:"metadata.name",onChange:this.handleNameChange,maxLength:n,autoFocus:!0}))),f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("workload.template"),desc:t("workload.template.select.desc")},f.default.createElement(d.Select,{name:"metadata.template",onChange:this.handleTemplateChange,options:this.state.templates})))),f.default.createElement(d.Columns,null,!this.props.namespace&&f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("PROJECT"),desc:t("SELECT_PROJECT_DESC"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")}]},f.default.createElement(S.default,{onChange:this.handleProjectChange,name:"metadata.namespace",cluster:this.props.cluster,defaultValue:this.namespace}))),f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:b.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},f.default.createElement(d.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),f.default.createElement(d.Columns,null,f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},f.default.createElement(d.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))))}},{key:"cluster",get:function(){return this.props.cluster}},{key:"namespace",get:function(){return(0,m.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,m.default)(t,b.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,m.default)(this.formTemplate,"spec.template"):this.formTemplate}}]),r}(f.default.Component))||l;a.default=T},,function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(14),r(8),r(13),r(9),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(141),r(14),r(120),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(1013),r(7),r(1014),r(1015),r(1016);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(58)),c=n(r(31)),s=n(r(50)),i=n(r(798)),f=n(r(191)),d=n(r(119)),p=n(r(26)),m=n(r(68)),h=n(r(3272)),v=r(17),E=n(r(3273)),y=n(r(3276)),g=n(r(819)),b=r(61),S=r(1524),_=n(r(864));function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var T=[{icon:"backup",name:"DEPLOYMENTS",value:"deployments"},{icon:"stateful-set",name:"STATEFULSETS",value:"statefulsets"},{icon:"stateful-set",name:"DAEMONSETS",value:"daemonsets"}],R={"workloadTemplate.create":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,l=(e.workspace,e.success),u=(0,s.default)(e,["store","cluster","namespace","workspace","success"]),o=i.default.open(C({onOk:function(e){var u={apiVersion:"v1",kind:"Secret",metadata:{name:e.metadata.name,namespace:null!=n?n:e.metadata.namespace},type:"workloadtemplate.kubesphere.io/workloadtemplate",stringData:{workloadTemplate:JSON.stringify(e)}};a.create(u,{cluster:r,namespace:n}).then((function(){i.default.close(o),f.default.success({content:t("CREATE_SUCCESSFUL")}),l&&l()}))},modal:E.default,TEMPLATE_OPTIONS:T,cluster:r,namespace:n},u))}},"workloadTemplate.edit":{on:function(e){var t=e.store,a=e.detail,r=e.success,n=e.namespace,l=e.supportGpuSelect,u=void 0!==l&&l,o=e.hideVolumeSetting,c=void 0===o||o,f=e.showVolumeTemplate,d=void 0!==f&&f,m=(0,s.default)(e,["store","detail","success","namespace","supportGpuSelect","hideVolumeSetting","showVolumeTemplate"]),h={};try{var v=(0,p.default)(a._originData,"data.workloadTemplate","");h=v?JSON.parse(atob(v)):{}}catch(e){return void console.error("Failed to parse workload template:",e)}var E=i.default.open(C({onOk:function(e){var l={apiVersion:"v1",kind:"Secret",metadata:{name:e.metadata.name,namespace:n},type:"workloadtemplate.kubesphere.io/workloadtemplate",stringData:{workloadTemplate:JSON.stringify(e)}};t.update(l,{namespace:n,resourceName:e.metadata.name,cluster:a.cluster}).then((function(){i.default.close(E),r&&r()}))},isEdit:!0,store:t,module:t.module,detail:h,TEMPLATE_OPTIONS:T,modal:y.default,supportGpuSelect:u,hideVolumeSetting:c,showVolumeTemplate:d},m))}},"workloadTemplate.createWorkload":{on:function(e){var a=e.store,r=e.cluster,n=e.namespace,d=e.success,p=e.k8sVersion,h=void 0===p?"":p,E=e.renderScheduleTab,y=void 0!==E&&E,O=(0,s.default)(e,["store","cluster","namespace","success","k8sVersion","renderScheduleTab"]),R=O.v3StoreParams,D=b.MODULE_KIND_MAP[R],k=(0,o.default)(S.CREATE_WORKLOAD_TEMPLATE_FORM_STEPS[R]),N=O.formTemplate;(0,m.default)(N,"metadata.templateName",N.metadata.name),(0,m.default)(N,"metadata.name","");var I=(0,c.default)({},D,N);y&&a.ifRenderScheduleTab(y);var P=i.default.open(C({onOk:function(e){a.create(e,{cluster:r,namespace:n},h).then((0,u.default)(l.default.mark((function e(){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.isScheduleDeployment||!y){e.next=7;break}return u=(0,v.toJS)(a.scheduleTemplate),e.next=5,a.scheduleCreate(u,{cluster:r,namespace:n});case 5:return e.next=7,a.switchSchedule(!1);case 7:i.default.close(P),f.default.success({content:t("CREATE_SUCCESSFUL")}),d&&d(),_.default.delete("".concat(R,"_create_form"));case 11:case"end":return e.stop()}}),e)}))))},onCancel:function(){i.default.close(P)},name:D,steps:k,module:R,cluster:r,namespace:n,store:a,formTemplate:I,TEMPLATE_OPTIONS:T,modal:g.default,createByTemplate:!0,hideFooter:!0},O))}},"workloadTemplate.generate":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=e.cluster,u=e.namespace,o=(0,s.default)(e,["store","detail","success","cluster","namespace"]);(0,m.default)(r,'_originData["workload-template-type"]',o.module);var c=i.default.open(C({onOk:function(e){var r=(0,d.default)(e),o=(0,p.default)(r,"metadata.templateName");(0,m.default)(r,"metadata.name",o),delete r.metadata.templateName;var s={apiVersion:"v1",kind:"Secret",metadata:{name:e.metadata.templateName,namespace:e.metadata.namespace},type:"workloadtemplate.kubesphere.io/workloadtemplate",stringData:{workloadTemplate:JSON.stringify(r)}};a.create(s,{cluster:l,namespace:u}).then((function(){i.default.close(c),f.default.success({content:t("CREATE_SUCCESSFUL")}),n&&n()}))},detail:r,store:a,TEMPLATE_OPTIONS:T,modal:h.default},o))}}};a.default=R},function(e,a,r){"use strict";r(16);var n=r(19);r(10),r(20),r(14),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(10),r(20),r(29),r(14),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(17),p=n(r(831)),m=r(189),h=n(r(798)),v=r(61),E=n(r(898));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var g=function(e){(0,o.default)(r,e);var a=y(r);function r(e){var t;return(0,l.default)(this,r),(t=a.call(this,e)).handleOk=function(e){var a=t.props,r=a.onOk,n=a.store,l=a.detail,u=n.list,o=(0,d.toJS)(u.selectedRowKeys),c=o?o.filter((function(e){return e!==l.uid})):"";r(e),o&&u.setSelectRowKeys(c)},t.state={formData:(0,p.default)((0,d.toJS)(e.detail._originData||e.detail))},t}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({formData:(0,p.default)((0,d.toJS)(this.props.detail._originData||this.props.detail))})}},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.isSubmitting,n=e.onCancel,l=e.hideAlias,u=e.TEMPLATE_OPTIONS,o=this.state.formData;return i.default.createElement(h.default.Form,{data:o,width:691,title:t("workload.template.generate"),onOk:this.handleOk,okText:t("OK"),onCancel:n,visible:a,isSubmitting:r},i.default.createElement(m.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:v.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:t("NAME_DESC")})}]},i.default.createElement(m.Input,{name:"metadata.templateName"})),i.default.createElement(m.Form.Item,{label:t("TYPE")},i.default.createElement(m.Select,{name:"workload-template-type",disabled:!0,options:u.map((function(e){return{label:t(e.name),value:e.value}}))})),i.default.createElement(m.Form.Item,{label:t("PROJECT"),desc:t("SELECT_PROJECT_DESC"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")},{validator:this.projectValidator}]},i.default.createElement(E.default,{name:"metadata.namespace",cluster:this.props.cluster,defaultValue:this.namespace})),!l&&i.default.createElement(m.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:v.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},i.default.createElement(m.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),i.default.createElement(m.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},i.default.createElement(m.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))}}]),r}(i.default.Component);a.default=g,g.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},g.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},function(e,a,r){"use strict";var n=r(19);r(12),r(109),r(3),r(10),r(44),r(6),r(20),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(109),r(32),r(3),r(10),r(44),r(6),r(20),r(27),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(317)),u=n(r(58)),o=n(r(31)),c=n(r(25)),s=n(r(28)),i=n(r(41)),f=n(r(42)),d=n(r(37)),p=n(r(0)),m=r(189),h=n(r(798)),v=n(r(819)),E=n(r(477)),y=n(r(1524)),g=n(r(438)),b=r(902),S=n(r(3275));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,f.default)(this,a)}}var T=function(e){(0,i.default)(r,e);var a=C(r);function r(e){var t;return(0,c.default)(this,r),(t=a.call(this,e)).handleTypeSelect=function(e){t.setState({type:e.currentTarget.dataset.value})},t.workloadTemplateStore=new E.default,t.state={type:"",groups:[{name:"workload.template.create.group.title",description:"workload.template.create.group.desc",options:e.TEMPLATE_OPTIONS}]},t}return(0,s.default)(r,[{key:"componentDidUpdate",value:function(e){var t=this.props.visible;this.props.visible||t===e.visible||this.setState({type:""})}},{key:"renderHeader",value:function(){return p.default.createElement("div",{className:S.default.header},p.default.createElement("div",{className:"h4 margin-b12"},t("workload.template.create")),p.default.createElement("p",null,t("workload.template.create.desc")),p.default.createElement("img",{src:"/extensions-static/ks-console-embed/dist/v3dist/assets/create-service.svg",alt:""}))}},{key:"renderGroups",value:function(){var e=this;return p.default.createElement("div",{className:S.default.groups},this.state.groups.map((function(a){return p.default.createElement("div",{key:a.name,className:S.default.group},p.default.createElement("div",{className:S.default.title},p.default.createElement("div",null,t(a.name)),p.default.createElement("p",null,t(a.description))),p.default.createElement("ul",null,a.options&&a.options.map((function(r){return p.default.createElement("li",{key:r.value||r,"data-value":r.value||r,"data-type":a.type,onClick:e.handleTypeSelect},p.default.createElement("div",null,p.default.createElement(m.Icon,{name:r.icon||(0,b.getLanguageIcon)(r,"radio"),size:48})),p.default.createElement("div",null,t(r.name||r.toUpperCase())))}))))})))}},{key:"renderSubModal",value:function(e){var a=this.props,r=a.visible,n=a.onOk,o=a.onCancel,c=a.cluster,s=a.namespace,i=a.isFederated,f=a.projectDetail,d=a.isSubmitting,m=a.workspace,h=a.supportNodeGroupSelect,E={width:960,store:this.workloadTemplateStore,visible:r,cluster:c,namespace:s,isFederated:i,projectDetail:f,isSubmitting:d,workspace:m,supportNodeGroupSelect:h,onOk:n,onCancel:o},b=this.props.TEMPLATE_OPTIONS.find((function(t){return t.value===e})),S=b.name,_=b.value,C=O(O({},g.default[_]({namespace:s})),{},{"workload-template-type":e});return p.default.createElement(v.default,(0,l.default)({},E,{module:_,name:"".concat(t(S)).concat(t("TEMPLATE")),steps:(0,u.default)(y.default[e]),formTemplate:C}))}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,r=this.state.type;return r?this.renderSubModal(r):p.default.createElement(h.default,{bodyClassName:S.default.body,width:960,visible:t,onCancel:a,hideHeader:!0},this.renderHeader(),this.renderGroups())}}]),r}(p.default.Component);a.default=T},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(70),r(20),r(51),r(14),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(20),r(51),r(29),r(14),r(4),r(18),r(43),r(11),r(73);var l,u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=r(189),p=n(r(808)),m=n(r(26)),h=n(r(68)),v=r(243),E=r(56),y=r(61),g=n(r(898)),b=n(r(441));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var _=(0,v.observer)(l=function(e){(0,c.default)(r,e);var a=S(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=a.call.apply(a,[this].concat(l))).projectStore=new b.default,e.nameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:r,namespace:e.namespace,cluster:e.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e.projectValidator=function(e,t,a){a()},e.handleNameChange=(0,p.default)((function(t){var a=e.props,r=a.module,n=a.isFederated,l=(0,m.default)(e.fedFormTemplate,"metadata.labels",{});y.APP_LABEL_MODULES.includes(r)&&(l.app=t.slice(0,63)),(0,E.updateLabels)(e.fedFormTemplate,r,l),n&&y.APP_LABEL_MODULES.includes(r)&&(0,h.default)(e.formTemplate,"metadata.labels.app",t.slice(0,63))}),200),e}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.maxNameLength,n=void 0===r?253:r,l=e.TEMPLATE_OPTIONS,u=253===n?t("LONG_NAME_DESC"):t("NAME_DESC");return f.default.createElement(d.Form,{data:this.formTemplate,ref:a},f.default.createElement(d.Columns,null,f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("NAME"),desc:u,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:y.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:u})}]},f.default.createElement(d.Input,{name:"metadata.name",onChange:this.handleNameChange,maxLength:n,autoFocus:!0}))),f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("workload.template")},f.default.createElement(d.Select,{disabled:!0,name:"metadata.templateName"})))),f.default.createElement(d.Columns,null,f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("TYPE"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:y.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},f.default.createElement(d.Select,{name:"workload-template-type",disabled:!0,options:l.map((function(e){return{label:t(e.name),value:e.value}}))}))),!this.props.namespace&&f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("PROJECT"),desc:t("SELECT_PROJECT_DESC"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")},{validator:this.projectValidator}]},f.default.createElement(g.default,{name:"metadata.namespace",cluster:this.props.cluster,defaultValue:this.namespace})))),f.default.createElement(d.Columns,null,f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:y.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},f.default.createElement(d.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63}))),f.default.createElement(d.Column,null,f.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},f.default.createElement(d.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))))}},{key:"cluster",get:function(){return this.props.cluster}},{key:"namespace",get:function(){return(0,m.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,m.default)(t,y.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,m.default)(this.formTemplate,"spec.template"):this.formTemplate}}]),r}(f.default.Component))||l;a.default=_},function(e,t,a){e.exports={body:"_3wwKcd0_M1Ov4zPA1k5uSk",header:"_2SKpaQo-6uXmQqNZ6lp287",groups:"_16-14RQa5VBQcEFD3UIp8h",group:"_2umuKY-_EfMPn4f0zdS5AD",title:"_1H3clfzRU8e5IMmzCcbmvI"}},function(e,t,a){"use strict";a(16);var r=a(19);a(10),a(4),a(18),a(11),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(32),a(10),a(29),a(4),a(18),a(43),a(11);var n=r(a(317)),l=r(a(50)),u=r(a(25)),o=r(a(28)),c=r(a(41)),s=r(a(42)),i=r(a(37)),f=r(a(0)),d=r(a(1)),p=r(a(1008)),m=r(a(3277));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,c.default)(a,e);var t=h(a);function a(){return(0,u.default)(this,a),t.apply(this,arguments)}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.module,a=(0,l.default)(e,["module"]);return f.default.createElement(p.default,(0,n.default)({title:"EDIT_SETTINGS",icon:"storage",module:t,forms:this.forms},a))}},{key:"forms",get:function(){return m.default[this.props.module].filter((function(e){return!e.disabled}))}}]),a}(f.default.Component);t.default=v,v.propTypes={module:d.default.string},v.defaultProps={module:"deployments"}},function(e,t,a){"use strict";a(16);var r=a(19);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(3278)),l=r(a(900)),u=r(a(915)),o=r(a(963)),c=a(56),s={deployments:[{title:"BASIC_INFORMATION",name:"baseInfo",icon:"cdn",component:(0,c.withProps)(n.default,{withEditCheck:!0})},{title:"POD_SETTINGS",name:"podSettings",icon:"docker",component:(0,c.withProps)(l.default,{withEditCheck:!0})},{title:"STORAGE_SETTINGS",name:"volumeSettings",icon:"storage",component:(0,c.withProps)(u.default,{withEditCheck:!0})},{title:"ADVANCED_SETTINGS",name:"advanceSettings",icon:"slider",component:(0,c.withProps)(o.default,{withEditCheck:!0})}],statefulsets:[{title:"BASIC_INFORMATION",name:"baseInfo",icon:"cdn",component:(0,c.withProps)(n.default,{withEditCheck:!0})},{title:"POD_SETTINGS",name:"podSettings",icon:"docker",component:(0,c.withProps)(l.default,{withService:!0,withEditCheck:!0})},{title:"STORAGE_SETTINGS",name:"volumeSettings",icon:"storage",component:(0,c.withProps)(u.default,{withEditCheck:!0})},{title:"ADVANCED_SETTINGS",name:"advanceSettings",icon:"slider",component:(0,c.withProps)(o.default,{withEditCheck:!0})}],daemonsets:[{title:"BASIC_INFORMATION",name:"baseInfo",icon:"cdn",component:(0,c.withProps)(n.default,{withEditCheck:!0})},{title:"POD_SETTINGS",name:"podSettings",icon:"docker",component:(0,c.withProps)(l.default,{withEditCheck:!0})},{title:"STORAGE_SETTINGS",name:"volumeSettings",icon:"storage",component:(0,c.withProps)(u.default,{withEditCheck:!0})},{title:"ADVANCED_SETTINGS",name:"advanceSettings",icon:"slider",component:(0,c.withProps)(o.default,{withEditCheck:!0})}]};t.default=s},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(70),r(20),r(51),r(14),r(4),r(18),r(11),r(73),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(70),r(20),r(51),r(29),r(14),r(4),r(18),r(43),r(11),r(73);var l,u=n(r(317)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=n(r(0)),p=r(189),m=n(r(808)),h=n(r(26)),v=n(r(68)),E=r(243),y=r(56),g=r(61),b=n(r(898)),S=n(r(441));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var O=(0,E.observer)(l=function(e){(0,s.default)(r,e);var a=_(r);function r(){var e;(0,o.default)(this,r);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(e=a.call.apply(a,[this].concat(l))).projectStore=new S.default,e.nameValidator=function(a,r,n){if(!r)return n();e.props.store.checkName({name:r,namespace:e.namespace,cluster:e.cluster}).then((function(e){if(e.exist)return n({message:t("NAME_EXIST_DESC"),field:a.field});n()}))},e.projectValidator=function(e,t,a){a()},e.handleNameChange=(0,m.default)((function(t){var a=e.props,r=a.module,n=a.isFederated,l=(0,h.default)(e.fedFormTemplate,"metadata.labels",{});g.APP_LABEL_MODULES.includes(r)&&(l.app=t.slice(0,63)),(0,y.updateLabels)(e.fedFormTemplate,r,l),n&&g.APP_LABEL_MODULES.includes(r)&&(0,v.default)(e.formTemplate,"metadata.labels.app",t.slice(0,63))}),200),e}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.maxNameLength,n=void 0===r?253:r,l=e.withEditCheck,o=e.formProps,c=e.isEdit,s=e.TEMPLATE_OPTIONS,i=253===n?t("LONG_NAME_DESC"):t("NAME_DESC");return d.default.createElement(p.Form,(0,u.default)({data:this.formTemplate,ref:a},l?o:{}),d.default.createElement(p.Columns,null,d.default.createElement(p.Column,null,d.default.createElement(p.Form.Item,{label:t("NAME"),desc:i,rules:[{required:!0,message:t("NAME_EMPTY_DESC")},{pattern:g.PATTERN_NAME,message:t("INVALID_NAME_DESC",{message:i})}]},d.default.createElement(p.Input,{disabled:c,name:"metadata.name",onChange:this.handleNameChange,maxLength:n,autoFocus:!0}))),d.default.createElement(p.Column,null,d.default.createElement(p.Form.Item,{label:t("TYPE"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:g.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},d.default.createElement(p.Select,{name:"workload-template-type",disabled:c,options:s.map((function(e){return{label:t(e.name),value:e.value}}))})))),d.default.createElement(p.Columns,null,!this.props.namespace&&d.default.createElement(p.Column,null,d.default.createElement(p.Form.Item,{label:t("PROJECT"),desc:t("SELECT_PROJECT_DESC"),rules:[{required:!0,message:t("PROJECT_NOT_SELECT_DESC")},{validator:this.projectValidator}]},d.default.createElement(b.default,{disabled:c,name:"metadata.namespace",cluster:this.props.cluster,defaultValue:this.namespace}))),d.default.createElement(p.Column,null,d.default.createElement(p.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:g.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},d.default.createElement(p.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})))),d.default.createElement(p.Columns,null,d.default.createElement(p.Column,null,d.default.createElement(p.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},d.default.createElement(p.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256})))))}},{key:"cluster",get:function(){return this.props.cluster}},{key:"namespace",get:function(){return(0,h.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,h.default)(t,g.MODULE_KIND_MAP[a],t)}},{key:"fedFormTemplate",get:function(){return this.props.isFederated?(0,h.default)(this.formTemplate,"spec.template"):this.formTemplate}}]),r}(d.default.Component))||l;a.default=O},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(70),r(36),r(66),r(20),r(14),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(10),r(6),r(70),r(36),r(66),r(20),r(27),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(73),r(46),r(7),r(40);var l=n(r(38));r(35);var u=n(r(39)),o=n(r(31)),c=n(r(50)),s=n(r(191)),i=n(r(798)),f=n(r(26)),d=n(r(457)),p=n(r(67)),m=n(r(68)),h=n(r(140)),v=n(r(3280)),E=n(r(3290)),y=n(r(3292)),g=r(56),b=n(r(888));function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O={"workspace.create":{on:function(e){var a=e.store,r=e.success,n=(0,c.default)(e,["store","success"]),l=i.default.open(_({onOk:function(e){if(e){(0,f.default)(globals,"ksConfig.springcloud",!1)&&(0,m.default)(e,'metadata.labels["springcloud.kubesphere.io/enabled"]',"true");var n=(0,f.default)(e,"clusterType"),u=(0,f.default)(e,"spec.placement.clusters.[0].name");"edge"===n&&u&&((0,m.default)(e,["metadata","labels","cluster-role.kubesphere.io/edge"],u),(0,m.default)(e,["spec","template","metadata","labels","cluster-role.kubesphere.io/edge"],u)),a.create((0,h.default)(e,"clusterType")).then((function(){i.default.close(l),s.default.success({content:t("CREATE_SUCCESSFUL")}),r&&r()}))}else i.default.close(l)},modal:v.default,store:a},n))}},"workspace.quota.edit":{on:function(e){e.store;var a,r=e.detail,n=e.success,o=(0,c.default)(e,["store","detail","success"]),m=new b.default,h=i.default.open(_({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u,o,c,v,E;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={name:r.name,workspace:r.name,cluster:r.cluster},o=(0,f.default)(a,"spec",{}),c=(0,f.default)(a,"storageLimit",{}),e.next=5,m.checkName(u);case 5:if(v=e.sent,(0,g.quota_limits_requests_Dot)(o),E={apiVersion:"quota.kubesphere.io/v1alpha2",kind:"ResourceQuota",metadata:_(_({},u),{},{name:r.name}),spec:{quota:{hard:_(_({},(0,d.default)(o,p.default)),c)}}},!v.exist){e.next=13;break}return e.next=11,m.update(u,E);case 11:e.next=15;break;case 13:return e.next=15,m.create(E,u);case 15:i.default.close(h),s.default.success({content:t("UPDATE_SUCCESSFUL")}),n&&n();case 18:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),detail:r,store:m,modal:E.default},o))}},"workspace.delete":{on:function(e){var a=e.store,r=e.detail,n=e.success,l=(0,c.default)(e,["store","detail","success"]),u=i.default.open(_({onOk:function(e){a.delete(r,e).then((function(){i.default.close(u),s.default.success({content:t("DELETED_SUCCESSFULLY")}),n&&n()}))},store:a,modal:y.default,resource:r.name},l))}},"workspace.batch.delete":{on:function(e){var a,r=e.store,n=e.success,o=e.rowKey,f=(0,c.default)(e,["store","success","rowKey"]),d=r.list,p=d.data,m=d.selectedRowKeys,h=p.filter((function(e){return m.includes(e[o])})).map((function(e){return e.name})),v=i.default.open(_({onOk:(a=(0,u.default)(l.default.mark((function e(a){var u;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=[],p.forEach((function(e){h.includes(e.name)&&u.push(r.delete(e,a))})),e.next=4,Promise.all(u);case 4:i.default.close(v),s.default.success({content:t("DELETED_SUCCESSFULLY")}),r.setSelectRowKeys([]),n&&n();case 8:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),resource:h.join(", "),modal:y.default,store:r},f))}}};a.default=O},function(e,a,r){"use strict";var n=r(19);r(12),r(10),r(6),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(27),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l=n(r(31)),u=n(r(25)),o=n(r(28)),c=n(r(41)),s=n(r(42)),i=n(r(37)),f=n(r(0)),d=n(r(119)),p=n(r(1)),m=r(189),h=n(r(191)),v=n(r(798)),E=n(r(438)),y=n(r(3281)),g=n(r(3283)),b=n(r(3285)),S=n(r(3289));function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var C=function(e){(0,c.default)(r,e);var a=O(r);function r(e){var n;return(0,u.default)(this,r),(n=a.call(this,e)).handleOk=function(){n.emptyCluster?h.default.info(t("CLUSTER_FIELD_EMPTY")):n.props.onOk(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n.state.formTemplate))},n.handlePrev=function(){n.setState((function(e){var t=e.currentStep;return{currentStep:Math.max(0,t-1)}}))},n.handleNext=function(){var e=n.formRef.current;e&&e.validate((function(){n.setState((function(e){var t=e.currentStep;return{currentStep:Math.min(n.steps.length-1,t+1)}}))}))},n.state={currentStep:0,formTemplate:(0,d.default)(E.default.workspaces())},n.formRef=f.default.createRef(),n}return(0,o.default)(r,[{key:"renderForm",value:function(){var e=this.props,t=e.store,a=e.form,r=this.state,n=r.formTemplate,l=r.currentStep,u=this.steps[l],o=u.component,c={store:t,formTemplate:n,defaultClusterType:a.defaultClusterType};return u.isForm?c.formRef=this.formRef:c.ref=this.formRef,f.default.createElement("div",{className:S.default.formWrapper},f.default.createElement("div",{className:S.default.wrapper},f.default.createElement("div",{className:S.default.form},f.default.createElement(o,c))))}},{key:"renderHeader",value:function(){var e=this.props,t=e.title,a=e.onCancel,r=this.state.currentStep;return f.default.createElement("div",{className:S.default.header},f.default.createElement("div",{className:S.default.title},f.default.createElement(m.Icon,{name:"close",size:20,clickable:!0,onClick:a}),f.default.createElement("span",null),f.default.createElement(m.Icon,{name:"enterprise",size:20}),f.default.createElement("span",null,t)),f.default.createElement("div",{className:S.default.wrapper},this.steps.length>1&&f.default.createElement(y.default,{steps:this.steps,current:r})),f.default.createElement("div",{className:S.default.headerBottom}))}},{key:"renderFooter",value:function(){var e=this.props,a=e.onCancel,r=e.isSubmitting,n=this.state.currentStep,l=this.steps.length-1;return f.default.createElement("div",{className:S.default.footer},f.default.createElement("div",{className:S.default.wrapper},f.default.createElement("div",{className:"text-right"},f.default.createElement(m.Button,{onClick:a},t("CANCEL")),n>0&&f.default.createElement(m.Button,{type:"control",onClick:this.handlePrev},t("PREVIOUS")),n<l?f.default.createElement(m.Button,{type:"control",onClick:this.handleNext},t("NEXT")):f.default.createElement(m.Button,{type:"control",onClick:this.handleOk,loading:r},t("CREATE")))))}},{key:"render",value:function(){var e=this.props.visible;return f.default.createElement(v.default,{className:S.default.modal,bodyClassName:S.default.body,visible:e,hideHeader:!0,hideFooter:!0,fullScreen:!0},this.renderHeader(),this.renderForm(),this.renderFooter())}},{key:"steps",get:function(){return globals.app.isMultiCluster?[{title:"BASIC_INFORMATION",component:g.default,required:!0,isForm:!0},{title:"CLUSTER_SETTINGS",component:b.default,required:!0}]:[{title:"BASIC_INFORMATION",component:g.default,required:!0,isForm:!0}]}},{key:"emptyCluster",get:function(){var e=this.state.formTemplate;return!(e&&e.spec&&e.spec.placement&&e.spec.placement.clusters)}}]),r}(f.default.Component);a.default=C,C.propTypes={visible:p.default.bool,title:p.default.string.isRequired,form:p.default.shape({defaultClusterType:p.default.string}),namespace:p.default.string,sampleApp:p.default.string,onOk:p.default.func,onCancel:p.default.func},C.defaultProps={visible:!1,form:{defaultClusterType:""},onOk:function(){},onCancel:function(){}}},function(e,a,r){"use strict";r(16);var n=r(162),l=r(19);r(20),r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(20),r(29),r(4),r(18),r(43),r(11);var u=l(r(25)),o=l(r(28)),c=l(r(41)),s=l(r(42)),i=l(r(37)),f=n(r(0)),d=r(189),p=l(r(3282));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,i.default)(e);if(t){var n=(0,i.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,s.default)(this,a)}}var h=function(e){(0,c.default)(r,e);var a=m(r);function r(){return(0,u.default)(this,r),a.apply(this,arguments)}return(0,o.default)(r,[{key:"render",value:function(){var e=this.props,a=e.steps,r=e.current;return f.default.createElement("div",{className:p.default.wrapper},a.map((function(e,a){return f.default.createElement("div",{key:e.title},r>=a?f.default.createElement(d.Icon,{name:"success",type:"coloured",size:12}):f.default.createElement(d.Icon,{name:"dot",type:"light",size:12}),f.default.createElement("span",null,t(e.title)))})))}}]),r}(f.Component);a.default=h},function(e,t,a){e.exports={wrapper:"_2dFP1gLucRGN5yjrJBJ0Wr"}},function(e,a,r){"use strict";var n=r(19);r(12),r(192),r(10),r(6),r(20),r(8),r(13),r(9),r(4),r(18),r(11),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(192),r(10),r(6),r(20),r(27),r(860),r(29),r(33),r(16),r(8),r(13),r(9),r(4),r(18),r(43),r(11),r(7);var l,u=n(r(31)),o=n(r(25)),c=n(r(28)),s=n(r(41)),i=n(r(42)),f=n(r(37)),d=r(189),p=n(r(244)),m=r(243),h=n(r(0)),v=n(r(323)),E=r(61),y=n(r(3284));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,i.default)(this,a)}}var S=(0,m.observer)(l=function(e){(0,s.default)(r,e);var a=b(r);function r(e){var n;return(0,o.default)(this,r),(n=a.call(this,e)).fetchUsers=function(e){return n.userStore.fetchList(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e))},n.nameValidator=function(e,a,r){return a?"workspaces"===a?r({message:t("INVALID_WORKSPACE_NAME"),field:e.field}):void n.props.store.checkName({name:a}).then((function(a){if(a.exist)return r({message:t("WORKSPACE_NAME_EXISTS_DESC"),field:e.field});r()})):r()},n.userStore=new v.default,n.fetchUsers(),n}return(0,c.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=e.defaultClusterType;return h.default.createElement("div",{className:y.default.wrapper},h.default.createElement("div",{className:y.default.step},h.default.createElement("div",null,t("BASIC_INFORMATION")),h.default.createElement("p",null,t("WORKSPACE_CREATE_DESC"))),h.default.createElement(d.Form,{data:r,ref:a},h.default.createElement(d.Form.Item,{className:y.default.hide,label:t("CLUSTER"),desc:t("WORKSPACE_CLUSTER_DESC")},h.default.createElement(d.Select,{name:"clusterType",defaultValue:n,options:this.clusterTypeOptions,disabled:!0})),h.default.createElement(d.Form.Item,{label:t("NAME"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("WORKSPACE_NAME_EMPTY_DESC")},{pattern:E.PATTERN_NAME,message:t("INVALID_NAME_DESC")},{validator:this.nameValidator}]},h.default.createElement(d.Input,{name:"metadata.name",autoFocus:!0,maxLength:63})),h.default.createElement(d.Form.Item,{label:t("ALIAS"),desc:t("ALIAS_NAME_DESC"),rules:[{pattern:E.PATTERN_ALIAS_NAME,message:t("INVALID_ALIAS_NAME_DESC")}]},h.default.createElement(d.Input,{name:"metadata.annotations['kubesphere.io/alias-name']",maxLength:63})),h.default.createElement(d.Form.Item,{label:t("ADMINISTRATOR")},h.default.createElement(d.Select,{name:"spec.template.spec.manager",options:this.users,pagination:(0,p.default)(this.userStore.list,["page","limit","total"]),isLoading:this.userStore.list.isLoading,onFetch:this.fetchUsers,defaultValue:globals.user.username,onChange:this.handleChange,searchable:!0})),h.default.createElement(d.Form.Item,{label:t("DESCRIPTION"),desc:t("DESCRIPTION_DESC")},h.default.createElement(d.TextArea,{name:"metadata.annotations['kubesphere.io/description']",maxLength:256,rows:"3"}))))}},{key:"users",get:function(){var e=globals.user.username,t=this.userStore.list.data.map((function(e){return{label:e.username,value:e.username}}));return t.every((function(t){return t.value!==e}))&&t.unshift({label:e,value:e}),t}},{key:"clusterTypeOptions",get:function(){return[{label:t("KS_CLUSTER"),value:"ks"}]}}]),r}(h.default.Component))||l;a.default=S},function(e,t,a){e.exports={wrapper:"_1YWQK0YmICh6VF7xYh7F8S",step:"KZcJHL5-wOFRBPuOY-K3S",upload:"_1xozz9MRPzwnFpHQOlyHi4",hide:"G90ob4x_x0cPWQtpwXn0A"}},function(e,a,r){"use strict";r(16);var n=r(19);r(4),r(18),r(11),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=r(189),d=n(r(3286)),p=n(r(3288));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var h=function(e){(0,o.default)(r,e);var a=m(r);function r(){return(0,l.default)(this,r),a.apply(this,arguments)}return(0,u.default)(r,[{key:"render",value:function(){var e=this.props,a=e.formRef,r=e.formTemplate,n=t("KS_CLUSTER");return i.default.createElement("div",{className:p.default.wrapper},i.default.createElement("div",{className:p.default.step},i.default.createElement("div",null,t("CLUSTER_SETTINGS")),i.default.createElement("p",null,t("SELECT_CLUSTERS_DESC",{type:n}))),i.default.createElement(f.Form,{data:r,ref:a},i.default.createElement(f.Form.Item,{label:t("AVAILABLE_CLUSTERS",{type:n})},i.default.createElement(d.default,{name:"spec.placement.clusters"}))))}}]),r}(i.default.Component);a.default=h},function(e,a,r){"use strict";var n=r(19),l=r(162);r(12),r(3),r(10),r(44),r(6),r(70),r(66),r(20),r(98),r(14),r(8),r(13),r(9),r(4),r(18),r(11),r(73),r(7),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(3),r(10),r(44),r(6),r(70),r(66),r(20),r(27),r(98),r(29),r(14),r(33),r(16),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(73),r(7);var u=n(r(38));r(35);var o,c=n(r(39)),s=n(r(58)),i=n(r(31)),f=n(r(25)),d=n(r(28)),p=n(r(41)),m=n(r(42)),h=n(r(37)),v=l(r(0)),E=n(r(5)),y=n(r(67)),g=n(r(140)),b=n(r(982)),S=r(17),_=r(243),O=r(189),C=n(r(846)),T=n(r(448)),R=n(r(1048)),D=n(r(800)),k=r(905),N=n(r(946)),I=n(r(1049)),P=n(r(3287));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var M=(0,_.observer)(o=function(e){(0,p.default)(n,e);var a,r=L(n);function n(){var e;(0,f.default)(this,n);for(var t=arguments.length,a=new Array(t),l=0;l<t;l++)a[l]=arguments[l];return(e=r.call.apply(r,[this].concat(a))).clusterStore=new T.default,e.tagsStore=new N.default,e.state={showTip:!1,hostClusters:[],filters:{}},e.getParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=e.group,r=e.tags,n=void 0===r?[]:r;return a&&(a="cluster.kubesphere.io/group=".concat(a)),n=n.map((function(e){return"label.cluster.kubesphere.io/".concat(e)})),w(w({},(0,g.default)(e,"group","tags","__index")),{},{labelSelector:[a].concat((0,s.default)(n),[t]).filter(Boolean).join(",")})},e.handleClick=function(t){var a,r=e.props,n=r.value,l=void 0===n?[]:n,u=r.onChange,o=t.currentTarget.dataset.cluster;a=l.some((function(e){return e.name===o}))?l.filter((function(e){return e.name!==o})):[].concat((0,s.default)(l),[{name:o}]),e.setState({showTip:a.some((function(t){return e.state.hostClusters.includes(t.name)}))}),u(a)},e.handleCheckboxClick=function(e){return e.stopPropagation()},e.clearFilter=function(){e.setState({filters:{}}),e.fetchData()},e.handleReset=function(){var t=e.state.filters;e.fetchData(t)},e.sortClusters=function(e){var t=e.filter((function(e){return e&&e.isHost})),a=e.filter((function(e){return e&&!e.isHost}));return[].concat((0,s.default)(t),(0,s.default)(a))},e}return(0,d.default)(n,[{key:"componentDidMount",value:function(){this.fetchData(),this.tagsStore.fetchGroupList()}},{key:"fetchData",value:(a=(0,c.default)(u.default.mark((function e(){var t,a,r=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},a="!cluster-role.kubesphere.io/edge",!globals.app.hasPermission({module:"clusters",action:"manage"})){e.next=7;break}return e.next=5,this.clusterStore.fetchList(w({limit:-1},this.getParams(t,a)));case 5:e.next=9;break;case 7:return e.next=9,this.clusterStore.fetchGrantedList(w({limit:-1},this.getParams(t,a)));case 9:this.setState({hostClusters:this.clusterStore.list.data.filter((function(e){return e.isHost})).map((function(e){return e.name}))});case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this,a=this.props,r=a.value,n=void 0===r?[]:r,l=a.noTip,u=void 0!==l&&l,o=this.state.filters,c=(0,S.toJS)(this.clusterStore.list),s=c.data,f=c.isLoading;if((0,y.default)(s)&&(0,y.default)(o)&&!f)return v.default.createElement(O.Alert,{type:"warning",message:t("NO_CLUSTER_AVAILABLE_DESC",{type:t("KS_CLUSTER")})});var d=(0,b.default)(this.sortClusters(s),(function(e){return globals.app.hasClusterModule(e.name,"whizard-monitoring")}));return v.default.createElement("div",{className:P.default.wrapper},this.state.showTip&&!u&&v.default.createElement(O.Alert,{className:"margin-b12",type:"warning",message:t("SELECT_HOST_CLUSTER_WARNING")}),v.default.createElement("div",null,v.default.createElement("div",{className:"margin-b12"},v.default.createElement(R.default,{placeholder:t("SEARCH_BY_NAME"),columns:this.columns,onChange:function(t){e.setState({filters:t}),e.fetchData(t)},filters:this.state.filters}))),d.map((function(a){var r;return v.default.createElement("div",{key:a.name,className:(0,E.default)(P.default.item,(0,i.default)({},P.default.disabled,!globals.app.isMultiCluster)),"data-cluster":a.name,onClick:globals.app.isMultiCluster?e.handleClick:null},v.default.createElement(O.Checkbox,{checked:n.some((function(e){return e.name===a.name})),disabled:!globals.app.isMultiCluster,onClick:e.handleCheckboxClick}),v.default.createElement(C.default,{className:P.default.cluster,cluster:a,noTip:!0}),v.default.createElement(D.default,{title:v.default.createElement(k.ClusterTagGroup,{data:(null!==(r=a.tags)&&void 0!==r?r:[]).map((function(t){return(e.tagsStore.tags||[]).find((function(e){return t.name===e.name}))})).filter(Boolean),empty:"-"}),description:t("TAG_PL")}))})),f&&v.default.createElement(O.Loading,{size:"large",className:P.default.loading}),(0,y.default)(s)&&v.default.createElement(I.default,{icon:"exclamation",title:t("NO_MATCHING_RESULT_FOUND"),desc:null,action:v.default.createElement("p",null,t("YOU_CAN_TRY_TO"),v.default.createElement("span",{className:P.default.action,onClick:this.handleReset,"data-test":"table-empty-refresh"},t("REFRESH_DATA")),t("OR"),v.default.createElement("span",{className:P.default.action,onClick:this.clearFilter,"data-test":"table-empty-clear-filter"},t("CLEAR_SEARCH_CONDITIONS")))}))}},{key:"columns",get:function(){var e,a;return[{dataIndex:"name",title:t("NAME"),search:!0},{dataIndex:"alias",title:t("ALIAS"),search:!0},{dataIndex:"group",title:t("TYPE"),search:!0,filters:(null!==(e=this.tagsStore.group)&&void 0!==e?e:[]).map((function(e){return{text:e,value:e}})),renderSearch:function(e){return v.default.createElement("div",{className:"flex"},v.default.createElement("div",{className:(0,E.default)(P.default.clusterGroupTag,(0,i.default)({},P.default[e.key],!0))},t("ENV_".concat(e.label.toUpperCase()))),e.label)}},{dataIndex:"tags",title:t("TAG_PL"),filters:(null!==(a=this.tagsStore.tags)&&void 0!==a?a:[]).map((function(e){return{text:"".concat(e.label,":").concat(e.value),value:e.name}})),search:!0,multi:!0,renderSearch:function(e){return v.default.createElement("div",null,e.label)}}]}}]),n}(v.Component))||o;a.default=M},function(e,t,a){e.exports={wrapper:"_1FhVvljOspycHsfzDrmHds",item:"_3uwdOWJxem3W_jqv6BAFu0",disabled:"sjn_zdlBrahI74WoV5omc",cluster:"_2s530jxSq442V0tK0dIkX-",action:"_30jbBaVzPyFFq_kLZenMJb",loading:"_2AViFhQ9LVdDjo1TbCma_n",clusterGroupTag:"_2tthhYeEaldV9GRAYCBRGE",production:"_3yIRf79JJMwAIiDuiJ-pCJ",development:"_3tNJGwW0JIy457E7wJg2vi",testing:"ITsFiOT5f8SuWqLf3dqin",demo:"rCDJ6PUxymw3W-b5WZ8KP",radios:"_3s7U5MUfODfm6UTxJ8Gkak"}},function(e,t,a){e.exports={wrapper:"R1Nn-MWwPOaptPi1tXzA6",step:"_2V9cABkYkEUjC4bpDz2wdo",upload:"_2-sPfwB-LHg4P9mpA3WhAJ"}},function(e,t,a){e.exports={modal:"ydx1TCDzXWsap7ThoXdoN",body:"_38XL2I39TDuD1GVvoZW0LQ",wrapper:"_3XK3SFG_epD4pRJnzaf6o3",header:"_1Gu0OlXBfqMPX3Jx1OqhI1",headerBottom:"_3yGJCycuKnmGI8GEnF1HDl",title:"_1fvkT6ZxavCZQF95V0OIAV",steps:"_2QTdt6PzkIwGCb1f8zjB_4",formWrapper:"-HzNn2kxNzffyKGd7DRFU",footer:"_2G9tgA343D1vegacgEoqAc"}},function(e,a,r){"use strict";var n=r(162),l=r(19);r(12),r(10),r(6),r(70),r(36),r(14),r(24),r(193),r(99),r(8),r(13),r(9),r(4),r(18),r(30),r(11),r(328),r(73),r(46),r(139),r(7),r(40),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(12),r(32),r(10),r(6),r(70),r(36),r(27),r(29),r(14),r(24),r(193),r(33),r(16),r(99),r(8),r(13),r(9),r(4),r(21),r(18),r(43),r(11),r(328),r(73),r(46),r(469),r(470),r(471),r(472),r(473),r(474),r(475),r(7),r(40);var u=l(r(38));r(35);var o=l(r(39)),c=l(r(97)),s=l(r(58)),i=l(r(31)),f=l(r(25)),d=l(r(28)),p=l(r(41)),m=l(r(42)),h=l(r(37)),v=l(r(0)),E=l(r(1)),y=r(17),g=l(r(26)),b=l(r(68)),S=l(r(1473)),_=l(r(457)),O=l(r(140)),C=r(189),T=l(r(798)),R=l(r(843)),D=r(56),k=l(r(888)),N=l(r(453)),I=n(r(1192)),P=l(r(3291));function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,h.default)(e);if(t){var n=(0,h.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,m.default)(this,a)}}var M=function(e){(0,p.default)(n,e);var a,r=L(n);function n(e){var t;return(0,f.default)(this,n),(t=r.call(this,e)).getWorkspaceSpec=function(){var e=t.state.spec,a=e["requests.storage"],r=e.persistentvolumeclaims,n=(0,D.memoryFormat)(a,"Gi");return{storage:isNaN(n)?1/0:n,persistentvolumeclaims:""===r?1/0:Number(r)}},t.omitKey=["requests.storage","persistentvolumeclaims"],t.countTotalRelatedResource=function(){var e=t.state.spec,a=w({},(0,O.default)(e,t.omitKey)),r={totalStorage:0,totalVolumeClaims:0,addedItems:[]},n=new Set;return Object.keys(a).forEach((function(e){if(e.includes("requests.storage")){n.add(e.split(".storageclass.storage.k8s.io/requests.storage")[0]);var t=(0,D.memoryFormat)(a[e],"Gi");isNaN(t)||(r.totalStorage+=t)}if(e.includes("persistentvolumeclaims")){n.add(e.split(".storageclass.storage.k8s.io/persistentvolumeclaims")[0]);var l=a[e],u=Number(l);""===l||isNaN(u)||(r.totalVolumeClaims+=u)}})),r.addedItems=(0,s.default)(n.values()),r},t.validInputStorage=function(){var e=t.getWorkspaceSpec(),a=e.storage,r=e.persistentvolumeclaims,n=t.countTotalRelatedResource(),l=n.totalStorage,u=n.totalVolumeClaims,o=!1;(a<l||0===a&&0===l)&&(o=!0),(r<u||0===r&&0===u)&&(o=!0),t.setState({disableSave:o,totalStorageError:a<l,totalVolumeClaimsError:r<u})},t.setRelateSourceResult=function(){var e=t.countTotalRelatedResource(),a=e.totalStorage,r=e.totalVolumeClaims,n=e.addedItems;t.setState({currentRelatedStorageTotal:a,currentRelatedVolumeClaimsTotal:r,addedItems:n})},t.handleOnChange=function(e){var a=e.actionType,r=e.data,n=e.originName,l=w({},t.state.spec);switch(a){case"delete":Object.keys(r).forEach((function(e){delete l[e]})),t.setState({spec:w({},l)},(function(){t.setRelateSourceResult()}));break;case"edit":delete l["".concat(n,".storageclass.storage.k8s.io/persistentvolumeclaims")],delete l["".concat(n,".storageclass.storage.k8s.io/requests.storage")],t.setState({spec:w(w({},l),r)},(function(){t.validInputStorage(),t.setRelateSourceResult()}));break;default:t.setState({spec:w(w({},t.state.spec),r)},(function(){t.validInputStorage(),t.setRelateSourceResult()}))}},t.handleOk=function(){var e=t.props.onOk,a=w({},t.state.spec);Object.entries(a).forEach((function(e){var t=(0,c.default)(e,2),r=t[0],n=t[1];"InfinityGi"!==n&&""!==n||delete a[r]}));var r=w({},(0,g.default)(t.state.formTemplate,"spec.quota.hard",{})),n=["persistentvolumeclaims","requests.storage"],l=(0,_.default)(r,(function(e,t){return t.includes(n[0])||t.includes(n[1])}));e({name:t.state.formTemplate.name,spec:w({},l),storageLimit:w({},a)})},t.form=v.default.createRef(),t.store=new k.default,t.state={formTemplate:{},error:"",allStorageClass:[],spec:{},availableQuota:{storage:void 0,persistentvolumeclaims:void 0},disableSave:!1,currentRelatedStorageTotal:0,currentRelatedVolumeClaimsTotal:0,totalStorageError:!1,totalVolumeClaimsError:!1,addedItems:[]},t.storageStore=new N.default,t}return(0,d.default)(n,[{key:"componentDidMount",value:function(){this.props.detail&&this.props.detail.name&&this.fetchData(this.props.detail)}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,r=t.detail;a&&a!==e.visible&&r&&r.name&&this.fetchData(r)}},{key:"fetchData",value:(a=(0,o.default)(u.default.mark((function e(){var t,a,r,n,l,o,c,i,f,d,p,m=this,h=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.length>0&&void 0!==h[0]?h[0]:{},a={storage:1/0,persistentvolumeclaims:1/0},e.next=4,this.storageStore.fetchList({cluster:t.cluster});case 4:return r=e.sent,e.next=7,this.store.fetchDetail({name:t.name,workspace:t.name,cluster:t.cluster});case 7:n=(0,y.toJS)(this.store.detail),l=(0,g.default)(n,"status.total.used",{}),o=(0,g.default)(n,"spec.quota.hard",{}),c=(0,g.default)(o,["requests.storage"],null),i=(0,g.default)(o,"persistentvolumeclaims",null),f=(0,g.default)(l,"persistentvolumeclaims","0"),d=(0,g.default)(l,["requests.storage"],"0Gi"),c&&(c=(0,D.memoryFormat)(c,"Gi"),d=(0,D.memoryFormat)(d,"Gi"),a.storage=(0,S.default)(c,d)),i&&(a.persistentvolumeclaims=(0,S.default)(Number(i),Number(f))),p={"requests.storage":c?"".concat(c,"Gi"):"InfinityGi",persistentvolumeclaims:i||""},Object.keys(o).forEach((function(e){(e.includes(I.STORAGE_CLASS_STORAGE)||e.includes(I.STORAGE_CLASS_VOLUME_CLAIMS))&&(p[e]=o[e])})),this.setState({formTemplate:(0,y.toJS)(this.store.detail),spec:p,allStorageClass:(0,s.default)(r),availableQuota:w({},a)},(function(){m.setRelateSourceResult()}));case 19:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,a=e.visible,r=e.onCancel,n=e.isSubmitting,l=this.state,u=l.error,o=l.spec,c=l.allStorageClass,s=l.availableQuota,i=l.disableSave,f=l.currentRelatedStorageTotal,d=l.currentRelatedVolumeClaimsTotal,p=l.totalStorageError,m=l.totalVolumeClaimsError,h=l.addedItems;return v.default.createElement(T.default.Form,{width:960,title:t("EDIT_WORKSPACE_QUOTAS"),icon:"pen",data:this.state.formTemplate,onOk:this.handleOk,onCancel:r,visible:a,isSubmitting:n,disableOk:!!u||i},v.default.createElement("div",{className:P.default.body,id:"viewBox"},v.default.createElement(C.Form.Item,null,v.default.createElement(R.default,this.resourceLimitProps)),v.default.createElement(C.Form.Item,null,v.default.createElement(I.default,{quota:o,isWorkspace:!0,availableQuota:s,allStorageClass:c,onChange:this.handleOnChange,renderOutOfLimitTip:p||m,totalStorageError:p,totalVolumeClaimsError:m,currentRelatedStorageTotal:f,currentRelatedVolumeClaimsTotal:d,addedItems:h}))))}},{key:"resourceLimitProps",get:function(){var e=this,a=this.state.formTemplate;return{cpuProps:{marks:[{value:0,label:t("NO_REQUEST"),weight:4},{value:1,label:1,weight:4},{value:2,label:2,weight:2},{value:3,label:3,weight:2},{value:4,label:4},{value:5,label:5},{value:6,label:6},{value:7,label:7},{value:8,label:8},{value:1/0,label:t("NO_LIMIT")}]},memoryProps:{marks:[{value:0,label:t("NO_REQUEST"),weight:4},{value:2,label:2,weight:4},{value:4,label:4,weight:2},{value:6,label:6,weight:2},{value:8,label:8},{value:10,label:10},{value:12,label:12},{value:14,label:14},{value:16,label:16},{value:1/0,label:t("NO_LIMIT")}],unit:"Gi",valueFormatter:function(e){return e>0&&e<1?e.toFixed(2):e>1&&e!==1/0?e.toFixed(1):e}},defaultValue:{limits:{cpu:(0,g.default)(a,'spec.quota.hard["limits.cpu"]'),memory:(0,g.default)(a,'spec.quota.hard["limits.memory"]')},requests:{cpu:(0,g.default)(a,'spec.quota.hard["requests.cpu"]'),memory:(0,g.default)(a,'spec.quota.hard["requests.memory"]')}},onChange:function(e){(0,b.default)(a,'spec.quota.hard["limits.cpu"]',(0,g.default)(e,"limits.cpu",null)),(0,b.default)(a,'spec.quota.hard["limits.memory"]',(0,g.default)(e,"limits.memory",null)),(0,b.default)(a,'spec.quota.hard["requests.cpu"]',(0,g.default)(e,"requests.cpu",null)),(0,b.default)(a,'spec.quota.hard["requests.memory"]',(0,g.default)(e,"requests.memory",null))},onError:function(t){e.setState({error:t})}}}}]),n}(v.default.Component);a.default=M,M.propTypes={detail:E.default.object,visible:E.default.bool,onOk:E.default.func,onCancel:E.default.func,isSubmitting:E.default.bool},M.defaultProps={visible:!1,isSubmitting:!1,detail:{},onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={body:"_3gx-epim1LPGcKH75fP9Qu",quotaItem:"_3WPJPpKpsaYoGbWbJfWdgZ",label:"_1Gv6t_kWjdKJhsCfZ6sKDp"}},function(e,a,r){"use strict";r(16);var n=r(19);r(3),r(4),r(18),r(30),r(11),r(139),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r(32),r(3),r(29),r(4),r(18),r(43),r(11);var l=n(r(25)),u=n(r(28)),o=n(r(41)),c=n(r(42)),s=n(r(37)),i=n(r(0)),f=n(r(1)),d=r(189),p=n(r(798)),m=n(r(3293));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,s.default)(e);if(t){var n=(0,s.default)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,o.default)(r,e);var a=h(r);function r(){var e;(0,l.default)(this,r);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=a.call.apply(a,[this].concat(n))).state={confirm:"",checked:!1},e.handleInputChange=function(t){e.setState({confirm:t.target.value})},e.handleDeleteCheckboxChange=function(t){e.setState({checked:t})},e.handleOk=function(){e.state.checked?e.props.onOk():e.props.onOk({kind:"DeleteOptions",apiVersion:"v1",propagationPolicy:"Orphan"})},e}return(0,u.default)(r,[{key:"componentDidUpdate",value:function(e){this.props.visible&&this.props.visible!==e.visible&&this.setState({confirm:""})}},{key:"render",value:function(){var e=this.props,a=e.type,r=e.resource,n=e.visible,l=e.onCancel,u=e.title,o=e.desc,c=e.isSubmitting,s=a||void 0,f=a?"".concat(a,"_LOW"):void 0,h=a?"".concat(a,"_PL"):void 0,v=o||(r&&a?1===r.split(", ").length?t.html("DELETE_RESOURCE_TYPE_DESC_SI",{type:t(f),resource:r}):t.html("DELETE_RESOURCE_TYPE_DESC_PL",{type:t(f),resource:r}):t.html("DELETE_DESC"));return i.default.createElement(p.default,{width:504,bodyClassName:m.default.modalBody,visible:n,isSubmitting:c,onCancel:l,hideHeader:!0,hideFooter:!0},i.default.createElement("div",{className:m.default.body},i.default.createElement("div",{className:"h5"},i.default.createElement(d.Icon,{name:"close",type:"light",className:m.default.closeIcon}),u||(r&&a?1===r.split(", ").length?t("DELETE_TITLE_SI",{type:t(s)}):t("DELETE_TITLE_PL",{type:t(h)}):t("DELETE"))),i.default.createElement("div",{className:m.default.content},i.default.createElement("p",null,v),r&&i.default.createElement(d.Input,{name:"confirm",value:this.state.confirm,onChange:this.handleInputChange,placeholder:r,autoFocus:!0}),i.default.createElement(d.Checkbox,{onChange:this.handleDeleteCheckboxChange,checked:this.state.checked},t("DELETE_WORKSPACE_PROJECTS_DESC")))),i.default.createElement("div",{className:m.default.footer},i.default.createElement(d.Button,{onClick:l,"data-test":"modal-cancel"},t("CANCEL")),i.default.createElement(d.Button,{type:"danger",loading:c,disabled:c||!!r&&this.state.confirm!==r,onClick:this.handleOk,"data-test":"modal-ok"},t("OK"))))}}]),r}(i.default.Component);a.default=v,v.propTypes={type:f.default.string,resource:f.default.string,visible:f.default.bool,title:f.default.oneOfType([f.default.string,f.default.node]),desc:f.default.oneOfType([f.default.string,f.default.node]),onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},v.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},function(e,t,a){e.exports={modalBody:"LMLXNreroioTPzZNBqI9P",body:"_11Lplgt-TPvmkVmIdHTC4F",content:"ydfzqfBYg_v0MAgK_cnl7",closeIcon:"_3jLtp35AZVNm24GTz4bZ76",footer:"UfSyRU5mQyye1fWDUyy8n"}}])]);